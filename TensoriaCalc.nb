(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[   2282430,      47106]
NotebookOptionsPosition[   2239729,      46346]
NotebookOutlinePosition[   2240298,      46366]
CellTagsIndexPosition[   2240255,      46363]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["TensoriaCalc", "Title",
 CellChangeTimes->{{3.533882220173852*^9, 
  3.5338822591895204`*^9}},ExpressionUUID->"709c6e72-b6d5-4da7-834f-\
6a8e8ec43703"],

Cell[CellGroupData[{

Cell["TensoriaCalc: Introduction", "Section",
 CellChangeTimes->{{3.520627025921875*^9, 3.520627035578125*^9}, {
  3.521757617359375*^9, 
  3.52175762040625*^9}},ExpressionUUID->"72bd2be0-e491-4259-abdd-\
f5d0d6c720f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "==="}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Copyright", " ", "Wei"}], "-", 
    RowBox[{"Hao", " ", "Chen", " ", "and", " ", "Yi"}], "-", 
    RowBox[{"Zen", " ", "Chu"}]}], "          ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "==="}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "One", " ", "main", " ", "goal", " ", "of", " ", "this", " ", "software", 
    " ", "is", " ", "the"}], "          ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"computation", " ", "of", " ", "Christoffel", " ", "symbols"}], 
    ",", " ", "Riemann", ","}], "   ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Ricci", " ", "tensor", " ", "and", " ", "scalar"}], ",", " ", 
    RowBox[{
     RowBox[{"etc", ".", " ", "given"}], " ", "a", " ", "specific"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"metric", ".", " ", "We"}], " ", "are", " ", "working", " ", 
    "within", " ", "a", " ", "Riemannian"}], "     ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"geometry", " ", 
    RowBox[{"frameowork", ".", " ", "Explicit"}], " ", "tensorial"}], 
   "        ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"calculations", " ", "will", " ", "increasingly", " ", "be", " ", 
    RowBox[{"supported", "."}]}], "   ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
     "===", "===", "==="}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Please", " ", "feel", " ", "free", " ", "to", " ", "use", " ", 
    RowBox[{"and", "/", "or"}], " ", "modify", " ", "this"}], "     ", "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "code", " ", "for", " ", "the", " ", "purposes", " ", "of", " ", 
    "scientific", " ", "research"}], "   ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "but", " ", "do", " ", "not", " ", "use", " ", "it", " ", "for", " ", 
    "commerical", " ", "purposes"}], "      ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"without", " ", "our", " ", 
    RowBox[{"permission", "."}]}], "                        ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Please", " ", "cite", " ", "the", " ", "URL", " ", "below", " ", "in", 
    " ", "your", " ", "publications"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "if", " ", "you", " ", "do", " ", "use", " ", "this", " ", "code", " ", 
    "for", " ", "your", " ", 
    RowBox[{"research", "."}]}], "     ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Feel", " ", "free", " ", "to", " ", "send", " ", "comments", " ", "to", 
    " ", 
    RowBox[{"yizen", " ", "[", "dot", "]"}], " ", "chu"}], "  ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"[", "at", "]"}], " ", 
    RowBox[{"gmail", " ", "[", "dot", "]"}], " ", 
    RowBox[{"com", "."}]}], "                          ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"This", " ", "software"}], ",", " ", 
    RowBox[{"a", " ", 
     RowBox[{"user", "'"}], "s", " ", "guide"}], ",", " ", 
    RowBox[{"and", " ", "future"}]}], "      ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"updates", "/", "revisions"}], " ", "should", " ", "be", " ", 
    "available", " ", "at"}], "       ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"http", ":"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{"www", ".", "stargazing", ".", "net"}], "/", "yizen"}], "/", 
     RowBox[{"Tensoria", ".", "html"}]}]}], "  ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
      "===", "===", "===", "==="}], "="}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"While", " ", "developing", " ", "this", " ", "code"}], ",", " ", 
    RowBox[{"I", " ", "have", " ", "taken"}]}], "       ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "inspiration", " ", "from", " ", "the", " ", "following", " ", "three", 
    " ", 
    RowBox[{"software", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"FeynCalc", " ", "@", " ", 
     RowBox[{"http", ":"}]}], "//", 
    RowBox[{
     RowBox[{"www", ".", "feyncalc", ".", "org"}], "/"}]}], "            ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"grt", " ", "@", " ", 
     RowBox[{"http", ":"}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"www", ".", "vaudrevange", ".", "com"}], "/", "pascal"}], "/", 
      "grt"}], "/"}]}], "   ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"xAct", " ", "@", " ", 
     RowBox[{"http", ":"}]}], "//", 
    RowBox[{
     RowBox[{"www", ".", "xact", ".", "es"}], "/"}]}], 
   "                     ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
      "===", "===", "===", "==="}], "="}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Please", " ", "refer", " ", "to", " ", "the", " ", 
    RowBox[{"TensoriaCalc", ".", "nb"}], " ", "file", " ", "for"}], "   ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "the", " ", "definitions", " ", "of", " ", "the", " ", "geometric", " ", 
    "objects"}], "       ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"computed", " ", "by", " ", "this", " ", 
    RowBox[{"package", ".", " ", 
     RowBox[{"(", 
      RowBox[{"It", " ", "is", " ", "difficult", " ", "to"}], "  "}]}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{" ", 
    RowBox[{"type", " ", "the", " ", "definitions", " ", "in", " ", 
     RowBox[{"text", "."}]}], ")"}], "                 ", "*)"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.52062706340625*^9, {3.520627119109375*^9, 3.520627468984375*^9}, {
   3.5206275175625*^9, 3.520627645890625*^9}, {3.520627685671875*^9, 
   3.52062771053125*^9}, {3.520871722765625*^9, 3.5208718686875*^9}, {
   3.520871910671875*^9, 3.520872034078125*^9}, {3.5211465243125*^9, 
   3.521146592921875*^9}, {3.52169831134375*^9, 3.52169842040625*^9}, {
   3.521757643875*^9, 3.52175766646875*^9}, {3.533851610091141*^9, 
   3.5338517032134724`*^9}, {3.5338517361105185`*^9, 3.533851746077533*^9}, {
   3.5338517820915833`*^9, 3.5338517925207987`*^9}, {3.533851847610076*^9, 
   3.533851870463108*^9}, {3.5338519006333513`*^9, 3.533851943159811*^9}, {
   3.5338519863398733`*^9, 3.5338521403542914`*^9}, {3.5468009779741535`*^9, 
   3.5468011006215687`*^9}, {3.6065160615379653`*^9, 
   3.6065160654535723`*^9}, {3.6065161067468443`*^9, 
   3.6065161765413675`*^9}, {3.9753197552811213`*^9, 
   3.9753197882794533`*^9}, {3.9753198212919397`*^9, 
   3.975319970760633*^9}},ExpressionUUID->"4a86c268-2418-4e54-8890-\
ea254b3bdcf4"]
}, Closed]],

Cell[CellGroupData[{

Cell["Geometric Objects: Definitions", "Section",
 CellChangeTimes->{{3.5350195756681585`*^9, 3.5350196069462137`*^9}, {
  3.5350196610003085`*^9, 
  3.535019662731911*^9}},ExpressionUUID->"11b59f65-da1a-4f8a-811c-\
2386e77bf6d4"],

Cell["\<\
Here, for the user\[CloseCurlyQuote]s reference, we define the geometric \
objects computed by TensoriaCalc. We employ Einstein\[CloseCurlyQuote]s \
summation convention, i.e., repeated indices are summed over.\
\>", "Text",
 CellChangeTimes->{{3.5350196118914223`*^9, 3.5350197821811123`*^9}, {
   3.5350198288407946`*^9, 3.5350199051561284`*^9}, {3.5350199458722*^9, 
   3.5350202136466703`*^9}, {3.535020275687979*^9, 3.5350202911788063`*^9}, {
   3.6294802198721633`*^9, 3.6294802599322195`*^9}, 3.6297452222417955`*^9, {
   3.6297637400879903`*^9, 3.629763773988669*^9}, {3.669510421728854*^9, 
   3.669510421966855*^9}, {3.669510461866974*^9, 3.669510592446375*^9}, {
   3.6695106395947247`*^9, 3.669510715058041*^9}, {3.6695109141611967`*^9, 
   3.6695109512433167`*^9}, {3.6695109977669773`*^9, 
   3.6695110209773045`*^9}, {3.669511147382535*^9, 3.6695112454851446`*^9}, {
   3.669511283536313*^9, 3.669511286083459*^9}, 3.6695114276765556`*^9, {
   3.6695115649214044`*^9, 3.6695115681235876`*^9}, 3.669514452115941*^9, {
   3.66953130511903*^9, 3.669531309003252*^9}, {3.6696725129174223`*^9, 
   3.6696725200894337`*^9}, {3.669927613887076*^9, 
   3.6699276164378805`*^9}},ExpressionUUID->"b5e6e792-1bbe-4285-ac5a-\
39d229eddab4"],

Cell[TextData[{
 "Our Christoffel symbols are: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     SuperscriptBox["\[CapitalGamma]", "\[Alpha]"], "\[Mu]\[Nu]"], 
    "\[Congruent]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}], 
     RowBox[{
      SuperscriptBox["g", "\[Alpha]\[Lambda]"], "(", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[PartialD]", "\[Mu]"], 
        SubscriptBox["g", "\[Nu]\[Lambda]"]}], "+", 
       RowBox[{
        SubscriptBox["\[PartialD]", "\[Nu]"], 
        SubscriptBox["g", "\[Mu]\[Lambda]"]}], "-", 
       RowBox[{
        SubscriptBox["\[PartialD]", "\[Lambda]"], 
        SubscriptBox["g", "\[Mu]\[Nu]"]}]}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"3a7cb0e4-d7b3-4646-aedf-ef1e1e84cd46"],
 ". Because \[CapitalGamma] is not a tensor, we do not allow for raising and \
lowering of indices."
}], "Text",
 CellChangeTimes->{{3.5350196118914223`*^9, 3.5350197821811123`*^9}, {
   3.5350198288407946`*^9, 3.5350199051561284`*^9}, {3.5350199458722*^9, 
   3.5350202136466703`*^9}, {3.535020275687979*^9, 3.5350202911788063`*^9}, {
   3.6294802198721633`*^9, 3.6294802599322195`*^9}, 3.6297452222417955`*^9, {
   3.6297637400879903`*^9, 3.629763773988669*^9}, {3.669510421728854*^9, 
   3.669510421966855*^9}, {3.669510461866974*^9, 3.669510592446375*^9}, {
   3.6695106395947247`*^9, 3.669510715058041*^9}, {3.6695109141611967`*^9, 
   3.6695109512433167`*^9}, {3.6695109977669773`*^9, 
   3.6695110209773045`*^9}, {3.669511147382535*^9, 3.6695112454851446`*^9}, {
   3.669511283536313*^9, 3.669511286083459*^9}, 3.6695114276765556`*^9, {
   3.6695115649214044`*^9, 3.6695115681235876`*^9}, {3.669514452115941*^9, 
   3.6695144825510445`*^9}},ExpressionUUID->"52f9b741-3e82-4d6f-a1d4-\
e25e37d937a2"],

Cell[TextData[{
 "Our Riemann curvature tensor is: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     SuperscriptBox["R", "\[Alpha]"], "\[Beta]\[Mu]\[Nu]"], "\[Congruent]", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[PartialD]", "\[Mu]"], 
      SubscriptBox[
       SuperscriptBox["\[CapitalGamma]", "\[Alpha]"], "\[Nu]\[Beta]"]}], "-", 
     RowBox[{
      SubscriptBox["\[PartialD]", "\[Nu]"], 
      SubscriptBox[
       SuperscriptBox["\[CapitalGamma]", "\[Alpha]"], "\[Mu]\[Beta]"]}], "+", 
     RowBox[{
      SubscriptBox[
       SuperscriptBox["\[CapitalGamma]", "\[Alpha]"], "\[Sigma]\[Mu]"], 
      SubscriptBox[
       SuperscriptBox["\[CapitalGamma]", "\[Sigma]"], "\[Nu]\[Beta]"]}], "-", 
     RowBox[{
      SubscriptBox[
       SuperscriptBox["\[CapitalGamma]", "\[Alpha]"], "\[Sigma]\[Nu]"], 
      SubscriptBox[
       SuperscriptBox["\[CapitalGamma]", "\[Sigma]"], "\[Mu]\[Beta]"]}]}]}], 
   TraditionalForm]],ExpressionUUID->"c37d5b0a-a5ef-46e3-a5c7-2861dd12710e"],
 ". The Weyl tensor ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    SuperscriptBox["C", "\[Alpha]"], "\[Beta]\[Mu]\[Nu]"], TraditionalForm]],
  ExpressionUUID->"77323ca7-7da4-4842-8483-fc4ac1843b06"],
 " is the traceless part of the Riemann tensor."
}], "Text",
 CellChangeTimes->{{3.5350196118914223`*^9, 3.5350197821811123`*^9}, {
   3.5350198288407946`*^9, 3.5350199051561284`*^9}, {3.5350199458722*^9, 
   3.5350202136466703`*^9}, {3.535020275687979*^9, 3.5350202911788063`*^9}, {
   3.6294802198721633`*^9, 3.6294802599322195`*^9}, 3.6297452222417955`*^9, {
   3.6297637400879903`*^9, 3.629763773988669*^9}, {3.669510421728854*^9, 
   3.669510421966855*^9}, {3.669510461866974*^9, 3.669510592446375*^9}, {
   3.6695106395947247`*^9, 3.669510715058041*^9}, {3.6695109141611967`*^9, 
   3.6695109512433167`*^9}, {3.6695109977669773`*^9, 
   3.6695110209773045`*^9}, {3.669511147382535*^9, 3.6695112454851446`*^9}, {
   3.669511283536313*^9, 3.669511286083459*^9}, 3.6695114276765556`*^9, {
   3.6695115649214044`*^9, 3.6695115681235876`*^9}, {3.669514452115941*^9, 
   3.6695144873400545`*^9}},ExpressionUUID->"d40af7e2-9a26-4ca2-9ae2-\
e53c5384a21b"],

Cell[TextData[{
 "The Ricci tensor is: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["R", "\[Beta]\[Nu]"], "\[Congruent]", 
    SubscriptBox[
     SuperscriptBox["R", "\[Alpha]"], "\[Beta]\[Alpha]\[Nu]"]}], 
   TraditionalForm]],ExpressionUUID->"2b04f9f8-56c4-495d-90fb-a70044476e1e"],
 "."
}], "Text",
 CellChangeTimes->{{3.5350196118914223`*^9, 3.5350197821811123`*^9}, {
   3.5350198288407946`*^9, 3.5350199051561284`*^9}, {3.5350199458722*^9, 
   3.5350202136466703`*^9}, {3.535020275687979*^9, 3.5350202911788063`*^9}, {
   3.6294802198721633`*^9, 3.6294802599322195`*^9}, 3.6297452222417955`*^9, {
   3.6297637400879903`*^9, 3.629763773988669*^9}, {3.669510421728854*^9, 
   3.669510421966855*^9}, {3.669510461866974*^9, 3.669510592446375*^9}, {
   3.6695106395947247`*^9, 3.669510715058041*^9}, {3.6695109141611967`*^9, 
   3.6695109512433167`*^9}, {3.6695109977669773`*^9, 
   3.6695110209773045`*^9}, {3.669511147382535*^9, 3.6695112454851446`*^9}, {
   3.669511283536313*^9, 3.669511286083459*^9}, 3.6695114276765556`*^9, {
   3.6695115649214044`*^9, 3.6695115681235876`*^9}, {3.669514452115941*^9, 
   3.6695144890570574`*^9}},ExpressionUUID->"3845de80-1110-454b-9540-\
2e8519c9c9ac"],

Cell[TextData[{
 "The Ricci scalar is: ",
 Cell[BoxData[
  FormBox[
   RowBox[{"R", "\[Congruent]", 
    RowBox[{
     SuperscriptBox["g", "\[Alpha]\[Beta]"], 
     SubscriptBox["R", "\[Alpha]\[Beta]"]}]}], TraditionalForm]],
  ExpressionUUID->"df250c09-a1fd-4af9-aad4-1ecdcd7a0922"],
 "."
}], "Text",
 CellChangeTimes->{{3.5350196118914223`*^9, 3.5350197821811123`*^9}, {
   3.5350198288407946`*^9, 3.5350199051561284`*^9}, {3.5350199458722*^9, 
   3.5350202136466703`*^9}, {3.535020275687979*^9, 3.5350202911788063`*^9}, {
   3.6294802198721633`*^9, 3.6294802599322195`*^9}, 3.6297452222417955`*^9, {
   3.6297637400879903`*^9, 3.629763773988669*^9}, {3.669510421728854*^9, 
   3.669510421966855*^9}, {3.669510461866974*^9, 3.669510592446375*^9}, {
   3.6695106395947247`*^9, 3.669510715058041*^9}, {3.6695109141611967`*^9, 
   3.6695109512433167`*^9}, {3.6695109977669773`*^9, 
   3.6695110209773045`*^9}, {3.669511147382535*^9, 3.6695112454851446`*^9}, {
   3.669511283536313*^9, 3.669511286083459*^9}, 3.6695114276765556`*^9, {
   3.6695115649214044`*^9, 3.6695115681235876`*^9}, {3.669514452115941*^9, 
   3.669514491868061*^9}},ExpressionUUID->"3c317f83-94d9-4d7a-886f-\
7a5d71c56178"],

Cell[TextData[{
 "The Einstein tensor is: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["G", "\[Beta]\[Nu]"], "\[Congruent]", 
    RowBox[{
     SubscriptBox["R", "\[Beta]\[Nu]"], " ", "-", " ", 
     SubscriptBox["g", "\[Beta]\[Nu]"]}]}], TraditionalForm]],ExpressionUUID->
  "ed7ae0c4-5d9c-4939-9b1c-00c63c82c675"],
 StyleBox["R",
  FontSlant->"Italic"],
 "/2."
}], "Text",
 CellChangeTimes->{{3.5350196118914223`*^9, 3.5350197821811123`*^9}, {
   3.5350198288407946`*^9, 3.5350199051561284`*^9}, {3.5350199458722*^9, 
   3.5350202136466703`*^9}, {3.535020275687979*^9, 3.5350202911788063`*^9}, {
   3.6294802198721633`*^9, 3.6294802599322195`*^9}, 3.6297452222417955`*^9, {
   3.6297637400879903`*^9, 3.629763773988669*^9}, {3.669510421728854*^9, 
   3.669510421966855*^9}, {3.669510461866974*^9, 3.669510592446375*^9}, {
   3.6695106395947247`*^9, 3.669510715058041*^9}, {3.6695109141611967`*^9, 
   3.6695109512433167`*^9}, {3.6695109977669773`*^9, 
   3.6695110209773045`*^9}, {3.669511147382535*^9, 3.6695112454851446`*^9}, {
   3.669511283536313*^9, 3.669511286083459*^9}, 3.6695114276765556`*^9, {
   3.6695115649214044`*^9, 3.6695115681235876`*^9}, {3.669514452115941*^9, 
   3.6695144980730734`*^9}},ExpressionUUID->"aca41777-70a2-483b-a840-\
5989459e0b69"],

Cell[TextData[{
 "The generally covariant Levi-Civita tensor, in ",
 Cell[BoxData[
  FormBox["d", TraditionalForm]],ExpressionUUID->
  "0cd55a00-899a-49aa-b716-626fac56770b"],
 " space(time) dimensions, is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[Epsilon]", "~"], 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "1"], "..."}], 
      SubscriptBox["\[Mu]", "d"]}]], "=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"|", 
        RowBox[{"det", " ", 
         SubscriptBox["g", "\[Alpha]\[Beta]"]}], "|"}], ")"}], 
      RowBox[{"1", "/", "2"}]], 
     SubscriptBox["\[Epsilon]", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Mu]", "1"], "..."}], 
       SubscriptBox["\[Mu]", "d"]}]]}]}], TraditionalForm]],ExpressionUUID->
  "8f639a88-6be8-4bc4-99b1-9ee1a98368e4"],
 ", where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Epsilon]", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", "1"], "..."}], 
     SubscriptBox["\[Mu]", "d"]}]], TraditionalForm]],ExpressionUUID->
  "650310e7-d659-42da-964e-961805452ce3"],
 " is the Levi-Civita symbol, which in turn returns the sign of the \
permutation that brings {",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Mu]", 
     RowBox[{"1", ",", "...", ","}]], 
    SubscriptBox["\[Mu]", "d"]}], TraditionalForm]],ExpressionUUID->
  "d5d902f3-4482-40aa-b43b-fe84fdf41a3c"],
 "} into {0,1,2,3,..., d-1} (or into {",
 Cell[BoxData[
  FormBox[
   SubscriptBox["s", "i"], TraditionalForm]],ExpressionUUID->
  "ae50e6a4-9716-4470-b107-b3b18220675c"],
 "+1,",
 Cell[BoxData[
  FormBox[
   SubscriptBox["s", "i"], TraditionalForm]],ExpressionUUID->
  "6eb0ed40-e294-4a5c-9419-8a3e2e1bbfab"],
 "+2,",
 Cell[BoxData[
  FormBox[
   SubscriptBox["s", "i"], TraditionalForm]],ExpressionUUID->
  "233cd570-137f-406f-9467-1fef04a23bb4"],
 "+3,...,",
 Cell[BoxData[
  FormBox[
   SubscriptBox["s", "i"], TraditionalForm]],ExpressionUUID->
  "1daeca29-9fa2-4536-9346-d2aec61d7f15"],
 "+d}, for some integer ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["s", "i"], TraditionalForm]],ExpressionUUID->
  "18972dfd-4a18-4603-9440-3f60f11e42f5"],
 ") and is zero otherwise. In flat spacetime, this means we adhere to the \
covention that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[Epsilon]", "~"], 
     RowBox[{
      RowBox[{
       RowBox[{"0123", "..."}], "d"}], "-", "1"}]], " ", "=", "1"}], 
   TraditionalForm]],ExpressionUUID->"a20de96d-04e6-4b8d-b4be-d3e915352479"],
 " regardless of the signature of the metric. Note: ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " has a built-in LeviCivitaTensor that appears to implement what we would \
call the Levi-Civita tensor in ",
 Cell[BoxData[
  FormBox["d", TraditionalForm]],ExpressionUUID->
  "d35442b9-228f-4de6-9a8f-e9d46674ca91"],
 "-dimensional flat Euclidean space in Cartesian coordinates."
}], "Text",
 CellChangeTimes->{{3.5350196118914223`*^9, 3.5350197821811123`*^9}, {
   3.5350198288407946`*^9, 3.5350199051561284`*^9}, {3.5350199458722*^9, 
   3.5350202136466703`*^9}, {3.535020275687979*^9, 3.5350202911788063`*^9}, {
   3.6294802198721633`*^9, 3.6294802599322195`*^9}, 3.6297452222417955`*^9, {
   3.6297637400879903`*^9, 3.629763773988669*^9}, {3.669510421728854*^9, 
   3.669510421966855*^9}, {3.669510461866974*^9, 3.669510592446375*^9}, {
   3.6695106395947247`*^9, 3.669510715058041*^9}, {3.6695109141611967`*^9, 
   3.6695109512433167`*^9}, {3.6695109977669773`*^9, 
   3.6695110209773045`*^9}, {3.669511147382535*^9, 3.6695112454851446`*^9}, {
   3.669511283536313*^9, 3.669511286083459*^9}, 3.6695114276765556`*^9, {
   3.6695115649214044`*^9, 3.6695115681235876`*^9}, {3.669514452115941*^9, 
   3.66951449596507*^9}, {3.6695145618272038`*^9, 3.669514633497367*^9}, {
   3.6695146790024643`*^9, 3.6695146950585165`*^9}, {3.669517998168993*^9, 
   3.669518003503298*^9}, {3.671291620423515*^9, 3.6712916305055327`*^9}, {
   3.673104031705573*^9, 3.673104211485856*^9}, {3.6733339781765485`*^9, 
   3.673333978386552*^9}, {3.673334009914536*^9, 
   3.6733340542052164`*^9}},ExpressionUUID->"7946fbdc-2cbb-47bc-99b7-\
414d0ab90ab3"],

Cell[TextData[{
 "The Hodge dual (aka Hodge star operation), in ",
 Cell[BoxData[
  FormBox["d", TraditionalForm]],ExpressionUUID->
  "1c212502-a4a0-4fe3-b2ea-01e3003e8b38"],
 " space(time) dimensions, of a fully antisymmetric tensor ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["A", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", "1"], "..."}], 
     SubscriptBox["\[Mu]", "n"]}]], TraditionalForm]],ExpressionUUID->
  "70a31a59-e0c3-475c-9cd9-b3df002e1c65"],
 " (where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", " ", "\[LessEqual]", " ", "d"}], TraditionalForm]],
  ExpressionUUID->"8c4cd4a0-8aa0-483f-ba11-7a1203f05b76"],
 "), is defined as, for e.g., \n\t\t\[FivePointedStar]",
 Cell[BoxData[
  FormBox[
   SubscriptBox["A", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", "1"], "..."}], 
     SubscriptBox["\[Mu]", 
      RowBox[{"d", "-", "n"}]]}]], TraditionalForm]],ExpressionUUID->
  "3ff986f9-ec58-4f0a-b3c0-6ce56128acbd"],
 "\[Congruent]",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"1", "/", 
     RowBox[{"n", "!"}]}], ")"}], TraditionalForm]],ExpressionUUID->
  "e61a1b56-f562-4464-86d6-5f9518ce3449"],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["\[Epsilon]", "~"], 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["\[Mu]", "1"], "..."}], 
       SubscriptBox["\[Mu]", 
        RowBox[{"d", "-", "n"}]], 
       SubscriptBox["\[Nu]", "1"]}], "..."}], 
     SubscriptBox["\[Nu]", "n"]}]], TraditionalForm]],ExpressionUUID->
  "eb7246f4-11be-4f58-b974-64dadb0a6fdf"],
 Cell[BoxData[
  FormBox[
   SuperscriptBox["A", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Nu]", "1"], "..."}], 
     SubscriptBox["\[Nu]", "n"]}]], TraditionalForm]],ExpressionUUID->
  "0a4549f2-6a03-4a58-8b25-98b4bceb64c9"],
 "."
}], "Text",
 CellChangeTimes->{{3.5350196118914223`*^9, 3.5350197821811123`*^9}, {
   3.5350198288407946`*^9, 3.5350199051561284`*^9}, {3.5350199458722*^9, 
   3.5350202136466703`*^9}, {3.535020275687979*^9, 3.5350202911788063`*^9}, {
   3.6294802198721633`*^9, 3.6294802599322195`*^9}, 3.6297452222417955`*^9, {
   3.6297637400879903`*^9, 3.629763773988669*^9}, {3.669510421728854*^9, 
   3.669510421966855*^9}, {3.669510461866974*^9, 3.669510592446375*^9}, {
   3.6695106395947247`*^9, 3.669510715058041*^9}, {3.6695109141611967`*^9, 
   3.6695109512433167`*^9}, {3.6695109977669773`*^9, 
   3.6695110209773045`*^9}, {3.669511147382535*^9, 3.6695112454851446`*^9}, {
   3.669511283536313*^9, 3.669511286083459*^9}, 3.6695114276765556`*^9, {
   3.6695115649214044`*^9, 3.6695115681235876`*^9}, {3.669514452115941*^9, 
   3.66951449596507*^9}, {3.6695145618272038`*^9, 3.669514633497367*^9}, {
   3.6695146790024643`*^9, 3.6695146950585165`*^9}, {3.669517998168993*^9, 
   3.669518003503298*^9}, {3.6695314283929696`*^9, 3.669531579967232*^9}, {
   3.6698311448221784`*^9, 3.6698311567028*^9}, {3.671291644345358*^9, 
   3.671291685577632*^9}, {3.671317143006171*^9, 3.6713171695815797`*^9}, {
   3.67333412672133*^9, 
   3.6733341280513506`*^9}},ExpressionUUID->"0031cf5e-9a66-49e2-9ae7-\
82aa2adb0af9"]
}, Closed]],

Cell[CellGroupData[{

Cell["Public", "Section",
 CellChangeTimes->{{3.520303343484375*^9, 
  3.520303350734375*^9}},ExpressionUUID->"dbe7ad7a-92fe-41a0-9f5c-\
966a781ff5c3"],

Cell[CellGroupData[{

Cell["Begin", "Subsection",
 CellChangeTimes->{{3.6726814635444818`*^9, 
  3.6726814724714994`*^9}},ExpressionUUID->"7ed4bb07-bc17-40f3-a1d3-\
169195392a1b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BeginPackage", "[", "\"\<TensoriaCalc`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Upper", " ", "indices", " ", "are", " ", "denoted", " ", "by"}], 
    ",", " ", 
    RowBox[{
     RowBox[{"e", ".", "g", ".", " ", 
      SuperscriptBox["\[Mu]", "-"], ".", " ", "Lower"}], " ", "indices", " ", 
     "are", " ", "denoted", " ", "by"}], ",", " ", 
    RowBox[{"e", ".", "g", ".", " ", 
     SubscriptBox["\[Mu]", "-"]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "notation", " ", "is", " ", "the", " ", "same", " ", "as", 
    " ", 
    RowBox[{"Pascal", "'"}], "s", " ", "gtr"}], " ", "*)"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.518287025359375*^9, 3.518287083796875*^9}, {
   3.518287204515625*^9, 3.518287246046875*^9}, {3.518288154015625*^9, 
   3.518288179625*^9}, {3.5196834121875*^9, 3.519683417953125*^9}, {
   3.519689356625*^9, 3.519689356921875*^9}, {3.51976580715625*^9, 
   3.519765810671875*^9}, {3.519963432453125*^9, 3.519963433953125*^9}, 
   3.520125837828125*^9, {3.5201289498125*^9, 3.5201289504375*^9}, 
   3.520219859578125*^9, 3.5202268538125*^9, {3.52027377246875*^9, 
   3.520273831296875*^9}, {3.5202738760625*^9, 3.52027388446875*^9}, {
   3.5202739371875*^9, 3.5202741019375*^9}, {3.52027416353125*^9, 
   3.520274167671875*^9}, 3.520274919453125*^9, {3.52027495775*^9, 
   3.52027500990625*^9}, {3.520275109328125*^9, 3.52027513640625*^9}, {
   3.520275352625*^9, 3.520275353015625*^9}, {3.52027552415625*^9, 
   3.5202755711875*^9}, 3.520275790296875*^9, {3.5202759311875*^9, 
   3.520275948625*^9}, {3.520276746125*^9, 3.5202767880625*^9}, {
   3.52027692378125*^9, 3.52027700428125*^9}, {3.520277061046875*^9, 
   3.520277097125*^9}, {3.520277138046875*^9, 3.520277203125*^9}, {
   3.52027851596875*^9, 3.520278524*^9}, {3.52027856384375*^9, 
   3.520278653328125*^9}, 3.5202787563125*^9, {3.520279456296875*^9, 
   3.5202794635625*^9}, {3.520279561640625*^9, 3.520279567359375*^9}, {
   3.52028006315625*^9, 3.520280068671875*^9}, {3.5202804206875*^9, 
   3.520280495234375*^9}, 3.520281272765625*^9, {3.52028149878125*^9, 
   3.5202815018125*^9}, {3.520281674421875*^9, 3.5202816786875*^9}, {
   3.520281727390625*^9, 3.520281730375*^9}, 3.52028190265625*^9, {
   3.52028213190625*^9, 3.520282169640625*^9}, {3.520282364859375*^9, 
   3.520282395859375*^9}, {3.520282483109375*^9, 3.520282499046875*^9}, {
   3.52028567246875*^9, 3.520285695984375*^9}, {3.5202857606875*^9, 
   3.520285762578125*^9}, {3.520285792890625*^9, 3.520285807109375*^9}, {
   3.5202858616875*^9, 3.52028586721875*^9}, {3.520286964859375*^9, 
   3.520286985015625*^9}, {3.52028713909375*^9, 3.520287168453125*^9}, {
   3.52030002590625*^9, 3.520300043171875*^9}, {3.520300760625*^9, 
   3.520300806765625*^9}, {3.52030106778125*^9, 3.520301101625*^9}, {
   3.520301143203125*^9, 3.520301143921875*^9}, {3.520301203140625*^9, 
   3.520301219734375*^9}, {3.520301382671875*^9, 3.520301408375*^9}, {
   3.5203015531875*^9, 3.520301561859375*^9}, {3.52030160309375*^9, 
   3.52030162021875*^9}, {3.520301674546875*^9, 3.520301675078125*^9}, 
   3.520301885265625*^9, {3.52030235646875*^9, 3.5203024485*^9}, {
   3.52030252584375*^9, 3.520302587984375*^9}, {3.520302792015625*^9, 
   3.520302959515625*^9}, {3.520303101875*^9, 3.520303107296875*^9}, {
   3.520303238609375*^9, 3.52030324271875*^9}, 3.520303299859375*^9, {
   3.520303549375*^9, 3.52030358071875*^9}, {3.5203507715625*^9, 
   3.520350858640625*^9}, {3.520350918515625*^9, 3.520350918796875*^9}, {
   3.5203511166875*^9, 3.520351136140625*^9}, {3.520356764953125*^9, 
   3.520356884515625*^9}, {3.520371762125*^9, 3.5203718918125*^9}, {
   3.520378815359375*^9, 3.520378856375*^9}, {3.52037895428125*^9, 
   3.520378970015625*^9}, {3.5204389959375*^9, 3.52043945671875*^9}, {
   3.520439536453125*^9, 3.52043953984375*^9}, 3.520439581921875*^9, {
   3.520439654296875*^9, 3.520439710359375*^9}, {3.520439880765625*^9, 
   3.520439884828125*^9}, {3.520439970515625*^9, 3.52044004490625*^9}, {
   3.52044311690625*^9, 3.520443213734375*^9}, {3.520465048609375*^9, 
   3.5204650511875*^9}, {3.520626553671875*^9, 3.52062658471875*^9}, {
   3.52062668471875*^9, 3.52062670090625*^9}, {3.520626757234375*^9, 
   3.520626799984375*^9}, {3.520626907484375*^9, 3.52062701828125*^9}, {
   3.52069946446875*^9, 3.5206994743125*^9}, {3.520699970546875*^9, 
   3.52069998275*^9}, {3.520815631453125*^9, 3.520815642671875*^9}, {
   3.52087815671875*^9, 3.5208781575625*^9}, {3.52087819059375*^9, 
   3.520878191671875*^9}, {3.520878244578125*^9, 3.520878249421875*^9}, {
   3.520899545265625*^9, 3.520899552515625*^9}, {3.520956048171875*^9, 
   3.520956049203125*^9}, 3.520957443984375*^9, {3.521140458546875*^9, 
   3.52114045903125*^9}, {3.521146843921875*^9, 3.5211468451875*^9}, {
   3.521226495468966*^9, 3.5212267343908415`*^9}, {3.5212272990470915`*^9, 
   3.521227301906466*^9}, {3.521234889484375*^9, 3.52123490115625*^9}, 
   3.5212349964375*^9, 3.521235089015625*^9, 3.521235880828125*^9, 
   3.521236001265625*^9, 3.52123740409375*^9, 3.521237684734375*^9, 
   3.52123825221875*^9, 3.521247508625*^9, 3.52124811696875*^9, 
   3.521248740078125*^9, {3.521251276515625*^9, 3.5212512769375*^9}, {
   3.521252125328125*^9, 3.521252129109375*^9}, {3.52125512903125*^9, 
   3.52125513334375*^9}, {3.52134227965625*^9, 3.521342302765625*^9}, {
   3.521350247328125*^9, 3.5213502586875*^9}, {3.521479285640625*^9, 
   3.521479481234375*^9}, {3.521510402328125*^9, 3.52151042*^9}, {
   3.52151067996875*^9, 3.521510685546875*^9}, {3.521510730328125*^9, 
   3.521510739578125*^9}, {3.521510958453125*^9, 3.521510961984375*^9}, {
   3.521571634296875*^9, 3.521571802671875*^9}, {3.521572707796875*^9, 
   3.521572848953125*^9}, {3.52166992121875*^9, 3.521670375828125*^9}, {
   3.521671400609375*^9, 3.521671468921875*^9}, {3.52167190478125*^9, 
   3.521671956046875*^9}, {3.521672654796875*^9, 3.521672663921875*^9}, {
   3.52167419490625*^9, 3.521674311921875*^9}, {3.521674723703125*^9, 
   3.52167473009375*^9}, {3.521698277296875*^9, 3.521698278296875*^9}, {
   3.52170295315625*^9, 3.521703048328125*^9}, {3.521734163609375*^9, 
   3.521734164296875*^9}, {3.5217404766875*^9, 3.521740477390625*^9}, {
   3.521757871828125*^9, 3.52175808225*^9}, {3.52175824334375*^9, 
   3.521758489984375*^9}, {3.5217585360625*^9, 3.52175861346875*^9}, {
   3.5217598483125*^9, 3.521759928390625*^9}, {3.52175996796875*^9, 
   3.52176025784375*^9}, {3.521760292078125*^9, 3.52176030628125*^9}, {
   3.5217651831875*^9, 3.521765221421875*^9}, {3.52176535990625*^9, 
   3.52176541146875*^9}, {3.52178529415625*^9, 3.521785357515625*^9}, {
   3.521787816203125*^9, 3.5217878181875*^9}, {3.521910257296875*^9, 
   3.521910279484375*^9}, {3.521910354734375*^9, 3.52191037071875*^9}, {
   3.521953189171875*^9, 3.5219535383125*^9}, {3.5219541266875*^9, 
   3.521954167859375*^9}, {3.522528068484375*^9, 3.52252807225*^9}, {
   3.533879884589926*^9, 3.5338799579256544`*^9}, {3.5391957298212233`*^9, 
   3.539195980472576*^9}, {3.5391960243210382`*^9, 3.5391960252110395`*^9}, {
   3.5394613785048385`*^9, 3.5394614644453897`*^9}, {3.539551377786018*^9, 
   3.5395513832616277`*^9}, {3.5395518179563913`*^9, 3.539551821497597*^9}, {
   3.5395518826029043`*^9, 3.539551883024105*^9}, {3.539552087680865*^9, 
   3.5395520916276717`*^9}, {3.5396160218156214`*^9, 
   3.5396160594740877`*^9}, {3.539616108785774*^9, 3.5396164138287096`*^9}, {
   3.5760901684770727`*^9, 3.576090494096444*^9}, {3.576090533470914*^9, 
   3.5760905336737137`*^9}, {3.576093700198476*^9, 3.5760938477747345`*^9}, {
   3.5766864493342285`*^9, 3.5766870372680607`*^9}, {3.5766870775317316`*^9, 
   3.576687119012204*^9}, {3.5837901145639615`*^9, 3.5837902223701277`*^9}, {
   3.606329333933484*^9, 3.606329375050616*^9}, {3.6064202232098227`*^9, 
   3.6064202685464163`*^9}, {3.6064204122876377`*^9, 3.606420456448163*^9}, {
   3.606491800762127*^9, 3.606491850775815*^9}, {3.606492069990939*^9, 
   3.606492143879165*^9}, {3.6064921763380213`*^9, 3.6064922572346487`*^9}, {
   3.6064923297627974`*^9, 3.6064923299818096`*^9}, {3.606492370603133*^9, 
   3.606492371219168*^9}, {3.6064961691193953`*^9, 3.6064961915836806`*^9}, {
   3.6064975285121484`*^9, 3.606497546217161*^9}, {3.6065035977871275`*^9, 
   3.606503646715926*^9}, {3.6065063001198483`*^9, 3.606506471837719*^9}, {
   3.606513240603368*^9, 3.6065132547171745`*^9}, {3.60651331827781*^9, 
   3.606513466271275*^9}, {3.6065743279396286`*^9, 3.6065743313716345`*^9}, {
   3.6065760454249916`*^9, 3.60657607740182*^9}, {3.6096134581867433`*^9, 
   3.6096134860795927`*^9}, {3.6096142872189994`*^9, 3.609614335438684*^9}, {
   3.6294774407514944`*^9, 3.6294774906015644`*^9}, {3.62947757779919*^9, 
   3.629477783009477*^9}, {3.629477825719537*^9, 3.6294778347395496`*^9}, {
   3.6294778894696264`*^9, 3.62947797075974*^9}, {3.6294780589298635`*^9, 
   3.6294780596998644`*^9}, {3.629478098129918*^9, 3.6294782395501165`*^9}, {
   3.6294782867201824`*^9, 3.6294783055702085`*^9}, {3.629478455970419*^9, 
   3.6294784946804733`*^9}, {3.6294785317405252`*^9, 
   3.6294785570705605`*^9}, {3.6294803157822976`*^9, 3.629480339682331*^9}, {
   3.6296556131724815`*^9, 3.629655647025541*^9}, {3.629655677321794*^9, 
   3.6296556859360094`*^9}, {3.629697278543481*^9, 3.6296973521750107`*^9}, {
   3.6296977113732457`*^9, 3.629697784256974*^9}, {3.6297631878993664`*^9, 
   3.629763353830789*^9}, {3.629763719443343*^9, 3.6297637226415515`*^9}, {
   3.6297637935867133`*^9, 3.6297638430924325`*^9}, {3.629908800590377*^9, 
   3.629908989442511*^9}, {3.6299090230303698`*^9, 3.6299090238727713`*^9}, {
   3.6299332867334347`*^9, 3.6299332984178553`*^9}, {3.629933337870325*^9, 
   3.6299333851852083`*^9}, {3.6299334939797993`*^9, 
   3.6299334981932344`*^9}, {3.6299337870972757`*^9, 3.629933817049328*^9}, {
   3.6299338759082317`*^9, 3.629933878092235*^9}, {3.629933931892765*^9, 
   3.6299339794572487`*^9}, {3.629934090482643*^9, 3.6299342367017*^9}, {
   3.629934623053544*^9, 3.6299346362843685`*^9}, {3.62993551990188*^9, 
   3.6299355229457855`*^9}, {3.629936340077901*^9, 3.629936349224618*^9}, {
   3.6299365172409315`*^9, 3.62993652603285*^9}, {3.630202947315394*^9, 
   3.630203367556756*^9}, {3.630203751880745*^9, 3.6302037621786633`*^9}, {
   3.6302037989592285`*^9, 3.6302038071511436`*^9}, {3.630203839939402*^9, 
   3.630203890589692*^9}, {3.6303300061366024`*^9, 3.6303300318160715`*^9}, {
   3.6313350528542*^9, 3.631335053316707*^9}, {3.6318275349354877`*^9, 
   3.631827553040766*^9}, {3.6318275856262665`*^9, 3.6318277499787908`*^9}, {
   3.6318277829867973`*^9, 3.6318277990995455`*^9}, {3.6336504306760654`*^9, 
   3.6336506572885036`*^9}, {3.6336506942095747`*^9, 3.633650742872664*^9}, {
   3.6695307810349817`*^9, 3.6695309718614273`*^9}, {3.669579900852109*^9, 
   3.669579987992093*^9}, {3.669593927721108*^9, 3.6695940267987747`*^9}, {
   3.669839259742984*^9, 3.6698393341535196`*^9}, {3.6698394017679768`*^9, 
   3.669839442740054*^9}, {3.6698395022010007`*^9, 3.669839584901169*^9}, {
   3.6698396272036543`*^9, 3.669839679443956*^9}, {3.6710431072367277`*^9, 
   3.671043118297151*^9}, {3.6710431498888187`*^9, 3.671043153553627*^9}, 
   3.671900525243921*^9, {3.6726814112425685`*^9, 3.672681415516377*^9}, {
   3.6731530927290735`*^9, 
   3.673153096775305*^9}},ExpressionUUID->"0dedec9e-166b-4c5a-b98a-\
9db1ff6a4b12"]
}, Closed]],

Cell[CellGroupData[{

Cell["?Usage", "Subsection",
 CellChangeTimes->{{3.6726814180283823`*^9, 
  3.6726814263264027`*^9}},ExpressionUUID->"f76f3345-7733-46f5-8d18-\
88418300407b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Tensor", "::", "usage"}], "=", 
   "\"\<Tensor is a generic Head of tensorial objects in TensoriaCalc, whose \
Fullform takes the following expression:\n\
Tensor[Indices\[Rule]{\!\(\*StyleBox[\"\[Mu]\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"\[Nu]\",FontSlant->\"\
Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"...\"\
,FontSlant->\"Italic\"]\)},StartIndex\[Rule]\!\(\*StyleBox[\"si\",FontSlant->\
\"Italic\"]\)_Integer,Coordinates\[Rule]\!\(\*StyleBox[\"coords\",FontSlant->\
\"Italic\"]\)_List,TensorComponents\[Rule]\!\(\*StyleBox[\"matrix\",FontSlant-\
>\"Italic\"]\),TensorName\[Rule]\!\(\*StyleBox[\"tn\",FontSlant->\"Italic\"]\)\
,TensorType\[Rule]\!\(\*StyleBox[\"tt\",FontSlant->\"Italic\"]\),\
TooltipDisplay\[Rule]Null,TooltipStyle\[Rule]{},TensorOperator\[Rule]\!\(\*\
StyleBox[\"op\",FontSlant->\"Italic\"]\),TensorAssumption\[Rule]\!\(\*\
StyleBox[\"ta\",FontSlant->\"Italic\"]\)_List,ChristoffelComponents\[Rule]\!\(\
\*StyleBox[\"ChrisRules\",FontSlant->\"Italic\"]\),MetricDeterminant\[Rule]\!\
\(\*StyleBox[\"Detg\",FontSlant->\"Italic\"]\),RiemannComponents\[Rule]\!\(\*\
StyleBox[\"RiemRules\",FontSlant->\"Italic\"]\),RicciComponents\[Rule]\!\(\*\
StyleBox[\"RicRules\",FontSlant->\"Italic\"]\),RicciScalarInvariant\[Rule]\!\(\
\*StyleBox[\"RRules\",FontSlant->\"Italic\"]\),TensorSymmetry\[Rule]\!\(\*\
StyleBox[\"ts\",FontSlant->\"Italic\"]\), \
FlatMetric\[Rule]\!\(\*StyleBox[\"fm\",FontSlant->\"Italic\"]\),\
OrthonormalFrameField\[Rule]\!\(\*StyleBox[\"onffuser\",FontSlant->\"Italic\"]\
\)_,InverseOrthonormalFrameField\[Rule]\!\(\*StyleBox[\"invonffuser\",\
FontSlant->\"Italic\"]\),OrthonormalFrameFieldOperator\[Rule]\!\(\*StyleBox[\"\
onffop\",FontSlant->\"Italic\"]\)].\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.975117658716895*^9, 3.975117660247757*^9}, {
  3.975117728288694*^9, 3.9751179666062098`*^9}, {3.975118098529759*^9, 
  3.975118124140418*^9}, {3.975156474262364*^9, 3.975156475648069*^9}, {
  3.975156517455245*^9, 3.975156574581036*^9}, {3.975156605803433*^9, 
  3.9751566158839407`*^9}, {3.9751567118637533`*^9, 3.9751567304116583`*^9}, {
  3.975157007335998*^9, 3.975157035120501*^9}, {3.97521821931452*^9, 
  3.975218219318818*^9}, {3.9752187690195436`*^9, 3.97521877372961*^9}, {
  3.975230209922373*^9, 3.975230362776567*^9}, {3.9752304376158943`*^9, 
  3.97523044496769*^9}, {3.975294124167603*^9, 3.9752942017547913`*^9}, {
  3.9752944065500946`*^9, 
  3.9752944344394608`*^9}},ExpressionUUID->"42d0c3d6-83d0-4ed8-b571-\
eeae7a9aa57a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Indices", "::", "usage"}], "=", 
  "\"\<(I) Indices\[Rule]{\!\(\*StyleBox[\"\[Mu]\",FontSlant->\"Italic\"]\),\!\
\(\*StyleBox[\"\[Nu]\",FontSlant->\"Italic\"]\),\!\(\*StyleBox[\"...\",\
FontSlant->\"Italic\"]\)} is one of the mandatory properties of Tensor. An \
upper index carries a superscript \[OpenCurlyQuote]-\[OpenCurlyQuote] (for \
example, \!\(TraditionalForm\`\*SuperscriptBox[\(\[Alpha]\), \
\(-\)]\)=SuperMinus[\[Alpha]]) and a lower index a subscript \
\[OpenCurlyQuote]-\[OpenCurlyQuote]. (for example, \!\(\*SubscriptBox[\(\
\[Alpha]\), \(-\)]\)=SubMinus[\[Alpha]]). \n(II) \
Indices[\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\)_Tensor] takes in a \
Tensor \!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\) and returns a List of \
the indices in it. \n(III) \
Indices[\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\)_Tensor,\!\(\*StyleBox[\"\
idx\",FontSlant->\"Italic\"]\)_List] returns Tensor \
\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\) with \
Indices\[Rule]{\!\(\*StyleBox[\"\[Mu]\",FontSlant->\"Italic\"]\),\!\(\*\
StyleBox[\"\[Nu]\",FontSlant->\"Italic\"]\),\!\(\*StyleBox[\"...\",FontSlant->\
\"Italic\"]\)} replaced by \
Indices\[Rule]\!\(\*StyleBox[\"idx\",FontSlant->\"Italic\"]\)_List.\>\""}]], \
"Input",
 InitializationCell->True,
 CellChangeTimes->{{3.975126012469359*^9, 3.9751260244300547`*^9}, 
   3.97512893315637*^9, {3.975129073053381*^9, 3.975129229182715*^9}, 
   3.975129456523703*^9, {3.9751295240929317`*^9, 3.975129538173564*^9}, {
   3.975129591688077*^9, 3.97512959625933*^9}, {3.975129630139634*^9, 
   3.975129744536406*^9}, {3.9751298194471292`*^9, 3.975129881283609*^9}, {
   3.975130030439126*^9, 3.975130065446478*^9}, {3.975130139642344*^9, 
   3.975130140864449*^9}, {3.975218219336458*^9, 3.975218219340768*^9}, {
   3.975218758433799*^9, 3.9752187624520903`*^9}, {3.975230512159885*^9, 
   3.9752305167821836`*^9}, {3.975230600023416*^9, 3.975230818283888*^9}, {
   3.975294209220605*^9, 3.9752942213166018`*^9}, {3.9752944740786476`*^9, 
   3.975294484750154*^9}},ExpressionUUID->"b40a0713-3592-4853-9208-\
6d00d7b73530"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"StartIndex", "::", "usage"}], "=", 
   "\"\<(I) StartIndex\[Rule]\!\(\*StyleBox[\(\*StyleBox[\"si\",FontSlant->\"\
Italic\"]_Integer\)]\) is one of the properties of Tensor that tells \
TensoriaCalc which Integer to start counting the coordinates from. For \
example, spacetime coordinates usually have StartIndex\[Rule]0 whereas purely \
spatial coordinates usually have StartIndex\[Rule]1. \n(II) \
StartIndex[\!\(\*StyleBox[\(\*StyleBox[\"t\",FontSlant->\"Italic\"]_Tensor\)]\
\)] returns the right hand side of \
StartIndex\[Rule]\!\(\*StyleBox[\(\*StyleBox[\"si\",FontSlant->\"Italic\"]_\
Integer\)]\) in the Tensor \!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\). \n\
(III) StartIndex[\!\(\*StyleBox[\(\*StyleBox[\"t\",FontSlant->\"Italic\"]_\
Tensor\)]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)si_Integer] returns \
Tensor \!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\) with StartIndex\[Rule]\!\
\(\*StyleBox[\(\*StyleBox[\"si\",FontSlant->\"Italic\"]_Interger\)]\) \
replaced by \
StartIndex\[Rule]\!\(\*StyleBox[\(\*StyleBox[\"si\",FontSlant->\"Italic\"]_\
Integer\)]\).\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9751300906819572`*^9, 3.9751302392850113`*^9}, {
  3.9751302788496113`*^9, 3.975130280097896*^9}, {3.9751304435815363`*^9, 
  3.975130467496175*^9}, {3.9752182193508*^9, 3.975218219357274*^9}, {
  3.975218737504149*^9, 3.975218740590748*^9}, {3.975230862986025*^9, 
  3.975230871385854*^9}, {3.975230972248767*^9, 3.97523098496812*^9}, {
  3.975294225986497*^9, 3.975294234298357*^9}, {3.9752945075763283`*^9, 
  3.9752945110467834`*^9}},ExpressionUUID->"c7014130-e88a-4e8d-a9c5-\
c807732fe8bf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TensorType", "::", "usage"}], "=", 
   "\"\<(I) TensorType\[Rule]\!\(\*StyleBox[\"tt\",FontSlant->\"Italic\"]\) \
is one of the properties of Tensor. It specifies the type of Tensor. A list \
of TensorType's in TensoriaCalc can be found in the manual.\n(II) TensorType[\
\!\(\*StyleBox[\(\*StyleBox[\"t\",FontSlant->\"Italic\"]_Tensor\)]\)] returns \
the right hand side of \
TensorType\[Rule]\!\(\*StyleBox[\"tt\",FontSlant->\"Italic\"]\) in the Tensor \
\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\). \n(III) \
TensorType[\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\)_Tensor,\!\(\*\
StyleBox[\"newtt\",FontSlant->\"Italic\"]\)] returns Tensor \
\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\) with \
TensorType\[Rule]\!\(\*StyleBox[\"oldtt\",FontSlant->\"Italic\"]\) replaced \
by TensorType\[Rule]\!\(\*StyleBox[\"newtt\",FontSlant->\"Italic\"]\).\>\""}],
   ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9751302836163816`*^9, 3.975130284766695*^9}, {
  3.97513033598316*^9, 3.97513033686906*^9}, {3.9751308698417463`*^9, 
  3.975130913690111*^9}, {3.9751310632293577`*^9, 3.975131112883185*^9}, {
  3.975132062180318*^9, 3.9751320650377617`*^9}, {3.975194172887952*^9, 
  3.975194220684313*^9}, {3.9752182193681707`*^9, 3.975218219372704*^9}, {
  3.9752187318122797`*^9, 3.975218735298208*^9}, {3.975231038606867*^9, 
  3.9752310855255623`*^9}, {3.9752942379784718`*^9, 
  3.975294268115095*^9}},ExpressionUUID->"b78a933e-6ae1-40ea-aff5-\
6de096c33f1e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TensorComponents", "::", "usage"}], "=", 
   "\"\<(I)TensorComponents\[Rule]\!\(\*StyleBox[\"tc\",FontSlant->\"Italic\"]\
\) is one of the properties of Tensor. It defines the components for a given \
Tensor through \!\(\*StyleBox[\"tc\",FontSlant->\"Italic\"]\). \n(II) \
TensorComponents[\!\(\*StyleBox[\(\*StyleBox[\"t\",FontSlant->\"Italic\"]_\
Tensor\)]\)] returns the right hand side of \
TensorComponents\[Rule]\!\(\*StyleBox[\"tc\",FontSlant->\"Italic\"]\).\>\""}],
   ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.975132625168597*^9, 3.975132625642008*^9}, {
   3.9751326599129257`*^9, 3.975132661073805*^9}, {3.9751326979282*^9, 
   3.9751327665190363`*^9}, {3.975132819196933*^9, 3.975132853231789*^9}, 
   3.975132886694495*^9, {3.975156137981366*^9, 3.9751561389415617`*^9}, {
   3.9751942305685787`*^9, 3.9751943266115913`*^9}, {3.97521821938197*^9, 
   3.975218219386455*^9}, {3.9752187203696947`*^9, 3.975218723887203*^9}, {
   3.975294559122419*^9, 
   3.9752945596269693`*^9}},ExpressionUUID->"1c611d97-7d17-4cdc-b131-\
9a6288d5833a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TensorName", "::", "usage"}], "=", 
  "\"\<(I) TensorName\[Rule]\!\(\*StyleBox[\"tn\",FontSlant->\"Italic\"]\) is \
one of the properties of Tensor. It specifies the name of a Tensor.\n(II) \
TensorName[\!\(\*StyleBox[\(\*StyleBox[\"t\",FontSlant->\"Italic\"]_Tensor\)]\
\)] returns the right hand side of \
TensorName\[Rule]\!\(\*StyleBox[\"tn\",FontSlant->\"Italic\"]\) in \
\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\) Tensor.\n(III) \
TensorName[\!\(\*StyleBox[\(\*StyleBox[\"t\",FontSlant->\"Italic\"]_Tensor\)]\
\),\!\(\*StyleBox[\"newtn\",FontSlant->\"Italic\"]\)] returns Tensor \
\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\) with \
TensorName\[Rule]\!\(\*StyleBox[\"oldtn\",FontSlant->\"Italic\"]\) replaced \
by TensorName\[Rule]\!\(\*StyleBox[\"newtn\",FontSlant->\"Italic\"]\).\>\""}]]\
, "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9751562425747633`*^9, 3.975156305916203*^9}, {
   3.975156353491846*^9, 3.975156451830324*^9}, {3.975194114219268*^9, 
   3.975194126220058*^9}, 3.975194192069461*^9, {3.975218219397541*^9, 
   3.97521821940193*^9}, {3.975218714285995*^9, 3.9752187172077513`*^9}, {
   3.975231252635364*^9, 3.975231266242444*^9}, {3.9752947573724957`*^9, 
   3.9752947710355215`*^9}},ExpressionUUID->"e61adb44-b485-482a-85ee-\
859a06d0d263"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TensorAssumption", "::", "usage"}], "=", 
   "\"\<(I) TensorAssumptions\[Rule]{} is one of the properties of a Tensor \
that helps to define the assumptions to Simplify or FullSimplify the whole \
Tensor. \n(II) TensorAssumption[\!\(\*StyleBox[\(\*StyleBox[\"t\",FontSlant->\
\"Italic\"]_Tensor\)]\)] returns the right hand side of the Rule \
TensorAssumption\[Rule]\!\(\*StyleBox[\(\*StyleBox[\"ta\",FontSlant->\"Italic\
\"]_List\)]\) in the \!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\) Tensor.\n\
(III) TensorAssumption[\!\(\*StyleBox[\(\*StyleBox[\"t\",FontSlant->\"Italic\"\
]_Tensor\)]\), \
\!\(\*StyleBox[\(\*StyleBox[\"newta\",FontSlant->\"Italic\"]_List\)]\)] \
returns Tensor \!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\) with \
TensorAssumption\[Rule]\!\(\*StyleBox[\(\*StyleBox[\"oldtn\",FontSlant->\"\
Italic\"]_\)]\) replaced by \
TensorAssumption\[Rule]\!\(\*StyleBox[\"newta\",FontSlant->\"Italic\"]\)_List.\
\>\""}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"TensorOperator", "::", "usage"}], "=", 
  "\"\<(I) TensorOperator\[Rule]\!\(\*StyleBox[\"op\",FontSlant->\"Italic\"]\)\
 is one of the properties of a Tensor, where \
\!\(\*StyleBox[\"op\",FontSlant->\"Italic\"]\) is an operator applied to the \
whole Tensor.\n(II) \
TensorOperator[\!\(\*StyleBox[\(\*StyleBox[\"t\",FontSlant->\"Italic\"]_\
Tensor\)]\)] returns the right hand side of \
TensorOperator\[Rule]\!\(\*StyleBox[\"op\",FontSlant->\"Italic\"]\) in \
\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\) Tensor.\n(III) \
TensorOperator[\!\(\*StyleBox[\(\*StyleBox[\"t\",FontSlant->\"Italic\"]_\
Tensor\)]\),\!\(\*StyleBox[\"newop\",FontSlant->\"Italic\"]\)] returns Tensor \
\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\) with \
TensorOperator\[Rule]\!\(\*StyleBox[\"oldop\",FontSlant->\"Italic\"]\) \
replaced by TensorOperator\[Rule]\!\(\*StyleBox[\"newop\",FontSlant->\"Italic\
\"]\).\>\""}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQnVl3vINp3lvHe5dPdoLokCfzp4Fovagjc0D0EYWP
u0H0k5ybe0G01r87N0B0Uvm0myD6TvfW0wJAOvhcxRkQnd4jdQlE8y37fRVE
52UrcwkC6aX7//OCaIbQuQogWkvaQhFEH/F5YwWijWxPOYHoicG/qkC0xqOj
NSDadW5tB4hWcI3qB9GXX7ypFgLSPRGGnSD6nKHXRBCtpZMFpsWWzNkJol/p
RxwG0fIKooUiQLqK42wliHZ56T8RRG+tOT8FRCdNfTETRG/L/DobRJskHd4P
oqeHTTgKor1Mc1sVgPSeSAg9//PkAyD6+MSph0C0kkXUUzUgXWPk/xJEtymf
fQ+iF1xc+BtEMx6reuEKpC12vX0DogH4Srpp
  "],ExpressionUUID->"a1630335-eb56-437e-bf77-65a37d63cdb7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TooltipDisplay", "::", "usage"}], "=", 
  "\"\<\nTooltipDisplay\n(I) \
TooltipDisplay\[Rule]\!\(\*StyleBox[\"td\",FontSlant->\"Italic\"]\) is one of \
the properties of a Tensor, where ttd provides the contents of the display \
box that appears when the mouse hovers over the output. TooltipTyle is used \
to format these contents, see below.\n(II) \
TooltipDisplay[\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\)_Tensor] returns \
the right hand side of TooltipDisplay\[Rule]ttd in \
\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\) Tensor.\n(III) \
TooltipDisplay[\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\)_Tensor,\!\(\*\
StyleBox[\"newtd\",FontSlant->\"Italic\"]\)] returns Tensor \
\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\) with its \
TooltipDisplay\[Rule]\!\(\*StyleBox[\"oldtd\",FontSlant->\"Italic\"]\) \
replaced by TooltipDisplay\[Rule]\!\(\*StyleBox[\"newtd\",FontSlant->\"Italic\
\"]\).\nTooltipStyle\n(I) \
TooltipStyle\[Rule]\!\(\*StyleBox[\"ts\",FontSlant->\"Italic\"]\)_List is one \
of the properties of a Tensor which helps to format the display box that \
appears when the mouse hovers over the output.\n(II) \
TooltipStyle[\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\)_Tensor] returns \
the right hand side of the Rule TooltipStyle\[Rule]{tts} in \
\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\) Tensor.\n(III) \
TooltipStyle[\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\)_Tensor,\!\(\*\
StyleBox[\"newts\",FontSlant->\"Italic\"]\)] returns the Tensor \
\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \",FontSlant->\
\"Italic\"]\)with its TooltipStyle\[Rule]\!\(\*StyleBox[\"oldts\",FontSlant->\
\"Italic\"]\) replaced with \
TootipStyle\[Rule]\!\(\*StyleBox[\"newts\",FontSlant->\"Italic\"]\).\>\""}]], \
"Input",
 InitializationCell->True,
 CellChangeTimes->{{3.975194377155862*^9, 3.975194427900496*^9}, {
   3.975194519025331*^9, 3.9751945546051493`*^9}, {3.975194962279364*^9, 
   3.975195000018711*^9}, {3.975197610764662*^9, 3.975197642700062*^9}, {
   3.975197899716425*^9, 3.975198066114777*^9}, {3.9751981515203457`*^9, 
   3.975198296021867*^9}, {3.975213826204118*^9, 3.9752138269169273`*^9}, {
   3.9752182194298697`*^9, 3.9752182194341803`*^9}, {3.975218655542829*^9, 
   3.975218668680872*^9}, {3.975231534743956*^9, 3.975231617261918*^9}, {
   3.9752316764153223`*^9, 3.975231892657695*^9}, {3.9752948312453117`*^9, 
   3.97529488589468*^9}, 
   3.97529853705266*^9},ExpressionUUID->"23d37f33-7829-4197-b68d-\
f0ed30f5728b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ToExpressionForm", "::", "usage"}], "=", 
   "\"\<ToExpressionForm[t_Tensor] returns the tensor t as a superposition of \
basis partial derivatives and 1-forms for the rank-1 case, and a \
superposition of their tensor products for the higher rank case. If t is \
fully symmetric, the tensor product will be dropped. If t is fully \
anti-symmetric, then instead of tensor products, the basis wedge products of \
the basis 1-forms or partial derivatives would be used.\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.975035482024014*^9, 3.975035624079767*^9}, {
   3.9750356605348597`*^9, 3.97503588770557*^9}, {3.975036417150548*^9, 
   3.975036632255157*^9}, {3.9750366783687677`*^9, 3.975036813654606*^9}, {
   3.9751217717497487`*^9, 3.9751218202894487`*^9}, 3.9751218768059416`*^9, {
   3.975121918771369*^9, 3.9751219969272985`*^9}, {3.975122050877498*^9, 
   3.975122135573656*^9}, {3.9751277841248255`*^9, 
   3.975127791662386*^9}},ExpressionUUID->"61e2e38d-63a0-4d43-9f67-\
95f7c3e0b293"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ToTensorComponents", "::", "usage"}], "=", 
   "\"\<ToTensorComponents[stuff,Coordinates\[Rule]coord_List] takes in the \
tensorial expression stuff \[LongDash] a superposition of basis 1-forms and \
partial derivatives or of their TensorProduct/Wedge's \[LongDash] and returns \
their components in the form of a List or List of List's. The argument \
Coordinates\[Rule]coord, from which the basis 1-forms and partial derivstives \
are derived, is mandatory.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9750368285597067`*^9, 3.9750368285618677`*^9}, {
   3.975036947998556*^9, 3.975037013797619*^9}, {3.975037046493966*^9, 
   3.975037195263352*^9}, 3.9751222097112727`*^9, 3.975122296052309*^9, {
   3.975122451909124*^9, 3.9751225093882504`*^9}, {3.9751225768010683`*^9, 
   3.975122771929976*^9}, {3.9752119226204386`*^9, 
   3.9752119287243023`*^9}},ExpressionUUID->"f4973c5f-0ced-4b36-80e2-\
ef43e998cd09"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"WedgeExpand", "::", "usage"}], "=", 
   "\"\<WedgeExpand[tw] takes in the the tensorial expression tw \[LongDash] \
a superposition of Wedge's of basis 1-forms (or, partial derivatives) \
\[LongDash] and returns the same expression but with each Wedge expanded into \
the corresponding anti-symmetric superposition of TensorProduct's.\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.975037247163159*^9, 3.975037296183736*^9}, {
  3.9750373915813828`*^9, 3.975037615013124*^9}, {3.9751230728602777`*^9, 
  3.9751231088668795`*^9}, {3.975123279723501*^9, 3.9751232994530993`*^9}, {
  3.9751233866052876`*^9, 3.9751234900894537`*^9}, {3.975123573646931*^9, 
  3.9751236192113533`*^9}, {3.975123699532179*^9, 3.9751237175285015`*^9}, {
  3.975127866959947*^9, 3.9751279752364764`*^9}, {3.9752119483343773`*^9, 
  3.975211962392758*^9}, {3.9753005617959375`*^9, 3.9753005647562704`*^9}, {
  3.975301465836632*^9, 
  3.975301466750095*^9}},ExpressionUUID->"99d1e8b4-5f33-4d8f-9633-\
cf2d83fd2152"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Metric", "::", "usage"}], "=", 
   "\"\<(I) Metric[\!\(\*StyleBox[\"\[Mu]\",FontSlant->\"Italic\"]\),\!\(\*\
StyleBox[\"\[Nu]\",FontSlant->\"Italic\"]\),\!\(\*StyleBox[\"M\",FontSlant->\"\
Italic\"]\),Coordinates\[Rule]{},TensorName\[Rule]\\\"g\\\",StartIndex\[Rule]\
0,MetricOperator\[Rule]Simplify,ChristoffelOperator\[Rule]Simplify,\
RiemannOperator\[Rule]Simplify,RicciOperator\[Rule]Simplify,\
RicciScalarOperator\[Rule]Simplify,TooltipStyle\[Rule]{}, TooltipDisplay\
\[Rule]Null,TensorOperator\[Rule]Simplify,TensorAssumption\[Rule]{}] returns \
a metric or inverse metric Tensor object. If \
\!\(\*StyleBox[\"\[Mu]\",FontSlant->\"Italic\"]\) and \
\!\(\*StyleBox[\"\[Nu]\",FontSlant->\"Italic\"]\) are SubMinus indices \
\[LongDash] i.e., it is a metric \[LongDash] \!\(\*StyleBox[\"M\",FontSlant->\
\"Italic\"]\) should be entered as a square matrix representing the metric \
components or a superposition of quadratic 1-forms. If \!\(\*StyleBox[\"\[Mu]\
\",FontSlant->\"Italic\"]\) and \
\!\(\*StyleBox[\"\[Nu]\",FontSlant->\"Italic\"]\) are SuperMinus indices \
\[LongDash] i.e., it is an inverse metric \[LongDash] \
\!\(\*StyleBox[\"M\",FontSlant->\"Italic\"]\) should be entered as a square \
matrix representing the inverse metric components or a superposition of \
quadratic 1-vectors. The coordinates are specified through the List coords in \
Coordinates\[Rule]coords. The optional \
TensorName\[Rule]\!\(\*StyleBox[\"tn\",FontSlant->\"Italic\"]\) means the \
metric's name is \!\(\*StyleBox[\"tn\",FontSlant->\"Italic\"]\), with default \
tn = \\\"g\\\". The optional StartIndex tells TensoriaCalc when to begin \
counting indices, with default value is 0. The optional ChristoffelOperator, \
RiemannOperator, etc. specify operators that will be applied to the \
components of the Christoffel symbols, Riemann Tensor etc. \n(II) Metric[\!\(\
\*StyleBox[\"\[Mu]\",FontSlant->\"Italic\"]\),\!\(\*StyleBox[\"\[Nu]\",\
FontSlant->\"Italic\"]\),\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\)_Tensor]\
 takes in the metric Tensor \!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\) \
(TensorType\[Rule]\\\"Metric\\\"), and returns the same Tensor object with \
TensorComponents representing the metric if \
\!\(\*StyleBox[\"\[Mu]\",FontSlant->\"Italic\"]\), \
\!\(\*StyleBox[\"\[Nu]\",FontSlant->\"Italic\"]\) are both SubMinus, the \
inverse metric if \!\(\*StyleBox[\"\[Mu]\",FontSlant->\"Italic\"]\), \
\!\(\*StyleBox[\"\[Nu]\",FontSlant->\"Italic\"]\) are both SuperMinus, or the \
identity matrix if one index is SubMinus and one is SuperMinus.\n(III) \
Metric[\!\(\*StyleBox[\"\[Mu]\",FontSlant->\"Italic\"]\),\!\(\*StyleBox[\"\
\[Nu]\",FontSlant->\"Italic\"]\),\!\(\*StyleBox[\"M\",FontSlant->\"Italic\"]\)\
,Coordinates\[Rule]{},TensorName\[Rule]\\\"g\\\",StartIndex\[Rule]0,\
MetricOperator\[Rule]Simplify,ChristoffelOperator\[Rule]Simplify,\
RiemannOperator\[Rule]Simplify,RicciOperator\[Rule]Simplify,\
RicciScalarOperator\[Rule]Simplify,TooltipStyle\[Rule]{},TooltipDisplay\[Rule]\
Null,FlatMetric\[Rule]Null,OrthonormalFrameField\[Rule]Null,\
InverseOrthonormalFrameField\[Rule]Null,OrthonormalFrameFieldOperator\[Rule]\
Simplify,OrthonormalFrameFieldIndices\[Rule]Null,TensorOperator\[Rule]\
Simplify, TensorAssumption\[Rule]{}] returns the same (inverse) metric Tensor \
as in (I), with the addition of its orthonormal frame fields and its inverse. \
See OrthonormalFrameField's usage for more details.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.973660640984314*^9, {3.973660696821705*^9, 3.9736608478528557`*^9}, {
   3.9736700283150597`*^9, 3.973670076593287*^9}, {3.9736701275180492`*^9, 
   3.973670435647547*^9}, {3.973670866772998*^9, 3.973670893052876*^9}, {
   3.973670959925215*^9, 3.973671052700018*^9}, {3.9736710922855463`*^9, 
   3.97367119822587*^9}, {3.973671276303969*^9, 3.9736713174928503`*^9}, {
   3.973671709430903*^9, 3.9736718744431753`*^9}, {3.973673211595579*^9, 
   3.97367322070008*^9}, {3.973673313054076*^9, 3.9736733363745327`*^9}, {
   3.974849608269289*^9, 3.974849611889346*^9}, {3.9748501698264523`*^9, 
   3.974850234930021*^9}, {3.9748506160902834`*^9, 3.974850621256668*^9}, {
   3.97503320160305*^9, 3.9750332332495527`*^9}, {3.975033274623773*^9, 
   3.975033275658785*^9}, {3.97520964023993*^9, 3.9752096805651407`*^9}, {
   3.9752097300128527`*^9, 3.9752097445475683`*^9}, {3.975209791076254*^9, 
   3.9752099260101547`*^9}, {3.9752100094884043`*^9, 
   3.9752100827518187`*^9}, {3.975210114991489*^9, 3.975210171710074*^9}, {
   3.975210221206628*^9, 3.9752102413579206`*^9}, {3.975210312229175*^9, 
   3.975210450386466*^9}, {3.9752182276666965`*^9, 3.975218228264952*^9}, {
   3.9752182631039934`*^9, 3.975218267154022*^9}, 3.975218305836689*^9, {
   3.9752185411769667`*^9, 3.9752187781133547`*^9}, {3.975218808991951*^9, 
   3.9752188440569396`*^9}, {3.975218884132561*^9, 3.9752189411652284`*^9}, {
   3.975219003998452*^9, 3.9752190560571976`*^9}, {3.9752190866337795`*^9, 
   3.975219190872115*^9}, {3.9752192351602173`*^9, 3.9752195453008432`*^9}, {
   3.97529860961274*^9, 3.975298609993944*^9}, {3.975298680944169*^9, 
   3.975298690151328*^9}, {3.975299006558352*^9, 
   3.9752990192940197`*^9}},ExpressionUUID->"8f2f2a22-d55b-4c6b-99a3-\
4096e166fff9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NonMetricTensor", "::", "usage"}], "=", 
   "\"\<(I) NonMetricTensor[\!\(\*StyleBox[\(\*StyleBox[\"\[Mu]\",FontSlant->\
\"Italic\"]_List\)]\),stuff,tn,Coordinates\[Rule]{},TensorType\[Rule]Null,\
StartIndex\[Rule]0,TooltipStyle\[Rule]{},TooltipDisplay\[Rule]Null,\
TensorOperator\[Rule]Simplify,TensorAssumption\[Rule]{}] returns a Tensor \
object with Indices\[Rule]\!\(\*StyleBox[\"\[Mu]\",FontSlant->\"Italic\"]\), \
TensorComponents corresponding to stuff, TensorName\[Rule]\!\(\*StyleBox[\"tn\
\",FontSlant->\"Italic\"]\), \
Coordinates\[Rule]\!\(\*StyleBox[\"coords\",FontSlant->\"Italic\"]\); as well \
as the optional TensorType\[Rule]\!\(\*StyleBox[\"tt\",FontSlant->\"Italic\"]\
\), StartIndex\[Rule]\!\(\*StyleBox[\"si\",FontSlant->\"Italic\"]\), \
TooltipStyle\[Rule]\!\(\*StyleBox[\"ts\",FontSlant->\"Italic\"]\), \
TooltipDisplay\[Rule]\!\(\*StyleBox[\"td\",FontSlant->\"Italic\"]\), \
TensorOperator\[Rule]\!\(\*StyleBox[\"op\",FontSlant->\"Italic\"]\), and \
TensorAssumption\[Rule]\!\(\*StyleBox[\"ta\",FontSlant->\"Italic\"]\). 1. \
There are two main ways to enter the TensorComponents stuff. It can be \
entered directly as a List, SparseArray, or SymmetrizedArray. It can also be \
entered as a superposition of (the TensorProduct or TensorWedge of) basis \
1-forms and partial derivatives; which TensoriaCalc will then convert into a \
List (or List of List's). 2. TensorType defines the type of Tensor. 3. \
TooltipDisplay and TooltipStyle formats the display box that appears when the \
mouse hovers over the output. 4. \
StartIndex\[Rule]\!\(\*StyleBox[\"si\",FontSlant->\"Italic\"]\) tells \
TensoriaCalc when to begin counting indices; in particular, the first \
coordinate starts at \!\(\*StyleBox[\"si\",FontSlant->\"Italic\"]\), whose \
default value is 0. 5. The TensorOperator \
\!\(\*StyleBox[\"op\",FontSlant->\"Italic\"]\) is applied to the whole Tensor \
object. 6. TensorAssumptions allows the user to store assumptions regarding \
the coordinates and parameters occurring within the given geometry.\n(II) \
NonMetricTensor[{},\!\(\*StyleBox[\"\[CurlyPhi]\",FontSlant->\"Italic\"]\),\!\
\(\*StyleBox[\"tn\",FontSlant->\"Italic\"]\),Coordinates\[Rule]{},TensorType\
\[Rule]Null,StartIndex\[Rule]0,TooltipStyle\[Rule]{},TooltipDisplay\[Rule]\
Null,TensorOperator\[Rule]Simplify,TensorAssumption\[Rule]{}] returns scalar \
(i.e., rank-0) Tensor object containing a scalar field \!\(\*StyleBox[\"\
\[CurlyPhi]\",FontSlant->\"Italic\"]\) (a regular expression), with \
TensorName\[Rule]\!\(\*StyleBox[\"tn\",FontSlant->\"Italic\"]\) and \
Coordinates\[Rule]coords. TensorType, TooltipDisplay, TooltipStyle, \
TensorAssumptions, TensorOperator, and StartIndex are optional arguments, \
with default values as shown.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.975035079507856*^9, 3.9750350830812225`*^9}, {
   3.975035119950742*^9, 3.9750354853668756`*^9}, {3.975035542828601*^9, 
   3.9750356325997667`*^9}, {3.975035962061743*^9, 3.975036259088417*^9}, {
   3.9750363250394197`*^9, 3.975036462101016*^9}, {3.975037686495096*^9, 
   3.9750377265654736`*^9}, {3.9750380907283864`*^9, 
   3.9750382478623886`*^9}, {3.975038299495841*^9, 3.975038343665594*^9}, 
   3.97503850970687*^9, {3.975045544073867*^9, 3.975045562318222*^9}, {
   3.9750462680842175`*^9, 3.975046380076146*^9}, {3.9750464217155423`*^9, 
   3.9750465903875847`*^9}, {3.9750466259971848`*^9, 3.9750468786181717`*^9}, 
   3.975090105614932*^9, {3.97509073571033*^9, 3.975090887879325*^9}, {
   3.975090929887087*^9, 3.975091043546781*^9}, {3.9750924295503693`*^9, 
   3.975092464620116*^9}, {3.9751246809482927`*^9, 3.975124683274111*^9}, {
   3.975210512511724*^9, 3.975210557317791*^9}, {3.975210602806445*^9, 
   3.9752106741565247`*^9}, {3.975210763235623*^9, 3.975210805531746*^9}, {
   3.975210859851739*^9, 3.9752109152323513`*^9}, {3.975210969543378*^9, 
   3.975210985793377*^9}, {3.975211017887644*^9, 3.975211066347631*^9}, {
   3.975219745481247*^9, 3.975219746533256*^9}, {3.975219815230879*^9, 
   3.975219816130814*^9}, {3.9752198535215983`*^9, 3.9752198899018073`*^9}, {
   3.975219931715464*^9, 3.975219975705449*^9}, {3.9752200106238704`*^9, 
   3.9752200345743656`*^9}, {3.9752201380324583`*^9, 3.975220286172371*^9}, {
   3.97522038666945*^9, 3.9752204602624683`*^9}, 3.975220559894143*^9, {
   3.9752208634676723`*^9, 3.9752209126494894`*^9}, 3.9752209824154963`*^9, {
   3.9752987254966125`*^9, 3.9752987924011974`*^9}, {3.9752988393952923`*^9, 
   3.975298862123367*^9}, {3.975299120872721*^9, 
   3.9752991298083553`*^9}},ExpressionUUID->"067b4ae3-404a-4447-9983-\
542c7d844370"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Christoffel", "::", "usage"}], "=", 
   "\"\<Christoffel[\!\(\*StyleBox[\(\*StyleBox[\"\[Mu]\",FontSlant->\"Italic\
\"]_SuperMinus\)]\),\!\(\*StyleBox[\(\*StyleBox[\"\[Alpha]\",FontSlant->\"\
Italic\"]_SubMinus\)]\),\!\(\*StyleBox[\(\*StyleBox[\"\[Beta]\",FontSlant->\"\
Italic\"]_SubMinus\)]\),\!\(\*StyleBox[\(\*StyleBox[\"m\",FontSlant->\"Italic\
\"]_Tensor\)]\),TooltipStyle\[Rule]{},TooltipDisplay\[Rule]TensorComponents] \
extracts the Christoffel symbols stored in the metric Tensor\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\" \",FontSlant->\"Italic\"]\)(TensorType must be \\\"Metric\\\") \
and returns them as a single Tensor object.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.975046901569336*^9, 3.975046909656106*^9}, {
   3.9750469526555443`*^9, 3.9750471518554926`*^9}, {3.9750471889632387`*^9, 
   3.9750471970356936`*^9}, {3.975104900869006*^9, 3.9751049016306086`*^9}, {
   3.9751049396194153`*^9, 3.9751049401678753`*^9}, {3.975211120994481*^9, 
   3.975211281223781*^9}, {3.975211399727888*^9, 3.975211452102235*^9}, {
   3.9752219528863983`*^9, 3.975221953745389*^9}, 3.9752220001072893`*^9, {
   3.9752988954279213`*^9, 3.9752988964200354`*^9}, {3.9752989385807953`*^9, 
   3.9752989392200556`*^9}},ExpressionUUID->"c5e43064-88c2-42be-adc2-\
ae5569cbd4aa"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Riemann", "::", "usage"}], "=", 
   "\"\<Riemann[\!\(\*StyleBox[\"\[Mu]\",FontSlant->\"Italic\"]\),\!\(\*\
StyleBox[\"\[Nu]\",FontSlant->\"Italic\"]\),\!\(\*StyleBox[\"\[Alpha]\",\
FontSlant->\"Italic\"]\),\!\(\*StyleBox[\"\[Beta]\",FontSlant->\"Italic\"]\),\
\!\(\*StyleBox[\(\*StyleBox[\"m\",FontSlant->\"Italic\"]_Tensor\)]\),\
TooltipStyle\[Rule]{},TooltipDisplay\[Rule]Null] extracts the Riemann tensor \
components stored in the metric Tensor \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\) (TensorType must be \
\\\"Metric\\\") and returns them as a single Tensor object with \
Indices\[Rule]{\!\(\*StyleBox[\"\[Mu]\",FontSlant->\"Italic\"]\),\!\(\*\
StyleBox[\"\[Nu]\",FontSlant->\"Italic\"]\),\!\(\*StyleBox[\"\[Alpha]\",\
FontSlant->\"Italic\"]\),\!\(\*StyleBox[\"\[Beta]\",FontSlant->\"Italic\"]\)}.\
\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.97504740047484*^9, 3.9750474064293256`*^9}, {
  3.975048097006445*^9, 3.975048229200184*^9}, {3.9750484854047656`*^9, 
  3.9750485099345446`*^9}, {3.975048584000545*^9, 3.975048585335013*^9}, {
  3.9751049565849824`*^9, 3.975104971855117*^9}, {3.975211296608832*^9, 
  3.975211395471649*^9}, {3.9752211613726287`*^9, 3.97522116797073*^9}, {
  3.975298915932417*^9, 3.975298918508469*^9}, {3.9752989646363597`*^9, 
  3.9752989649838123`*^9}},ExpressionUUID->"bc81be56-59cb-488c-a22c-\
0475f41bf8ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Ricci", "::", "usage"}], "=", 
   "\"\<Ricci[\!\(\*StyleBox[\"\[Mu]\",FontSlant->\"Italic\"]\),\!\(\*\
StyleBox[\"\[Nu]\",FontSlant->\"Italic\"]\),\!\(\*StyleBox[\(\*StyleBox[\"m\",\
FontSlant->\"Italic\"]_Tensor\)]\),TooltipStyle\[Rule]{},TooltipDisplay\[Rule]\
Null] extracts the Ricci tensor components stored in the metric Tensor \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\) (TensorType must be \
\\\"Metric\\\") and returns them as a single Tensor object with \
Indices\[Rule]{\[Mu],\[Nu]}.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.975048462451659*^9, 3.9750484693427963`*^9}, {
   3.9750485419737372`*^9, 3.9750485760426726`*^9}, 3.975093481089357*^9, {
   3.975104979572037*^9, 3.975104989336991*^9}, {3.9752211996216793`*^9, 
   3.975221200880243*^9}, 3.975298927834258*^9, {3.9752989614933405`*^9, 
   3.975298962213998*^9}},ExpressionUUID->"a43f5be7-603a-4f89-8c90-\
1cb2c77e1e1e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RicciScalar", "::", "usage"}], "=", 
   "\"\<(I) RicciScalar[\!\(\*StyleBox[\(\*StyleBox[\"m\",FontSlant->\"Italic\
\"]_Tensor\)]\)] extracts the Ricci scalar stored in the metric Tensor \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\) (TensorType must be \
\\\"Metric\\\") and returns it as a regular expression.\n[Beta version](II) \
RicciScalar[\!\(\*StyleBox[\(\*StyleBox[\"m\",FontSlant->\"Italic\"]_Tensor\)]\
\),Tensor] extracts the Ricci scalar stored in the metric Tensor \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\) (TensorType must be \
\\\"Metric\\\") and returns it as a Tensor object with Indices\[Rule]{}, \
TensorName\[Rule]\\\"R\\\"; and Coordinates, StartIndex, TooltipStyle, \
TooltipDisplay, TensorAssumption, and TensorOperator inherited from the input \
metric Tensor \!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\).\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.975048969898049*^9, 3.9750489732168856`*^9}, {
   3.975049030284469*^9, 3.97504903736128*^9}, {3.975049986165956*^9, 
   3.9750500741777306`*^9}, {3.9750501079258823`*^9, 3.9750501619352884`*^9}, 
   3.97509330251507*^9, {3.975211463887097*^9, 3.9752114749892673`*^9}, {
   3.9752221077013984`*^9, 3.975222108350879*^9}, {3.975298982215195*^9, 
   3.975298990732557*^9}},ExpressionUUID->"5eca1cb2-376c-48e6-8346-\
2c85be288df7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Weyl", "::", "usage"}], "=", 
   "\"\<Weyl[\!\(\*StyleBox[\"\[Mu]\",FontSlant->\"Italic\"]\),\!\(\*StyleBox[\
\"\[Nu]\",FontSlant->\"Italic\"]\),\!\(\*StyleBox[\"\[Alpha]\",FontSlant->\"\
Italic\"]\),\!\(\*StyleBox[\"\[Beta]\",FontSlant->\"Italic\"]\),\!\(\*\
StyleBox[\(\*StyleBox[\"m\",FontSlant->\"Italic\"]_Tensor\)]\),WeylOperator\
\[Rule]Simplify,TooltipStyle\[Rule]{},TooltipDisplay\[Rule]Null] extracts the \
Weyl tensor components from the metric Tensor \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\) and returns them as a Tensor \
object. The optional \
WeylOperator\[Rule]\!\(\*StyleBox[\"op\",FontSlant->\"Italic\"]\), with \
default \!\(\*StyleBox[\"op\",FontSlant->\"Italic\"]\) = Simplify, means \!\(\
\*StyleBox[\"op\",FontSlant->\"Italic\"]\) will be applied to the Weyl \
components.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9750934483858814`*^9, 3.975093461842308*^9}, {
   3.9750934959496017`*^9, 3.9750935204173574`*^9}, {3.9750947551563573`*^9, 
   3.9750947766945543`*^9}, {3.9750953896891766`*^9, 3.975095400268152*^9}, {
   3.975095924449456*^9, 3.975095979372205*^9}, {3.9750960468216257`*^9, 
   3.9750960969767046`*^9}, {3.975105039123007*^9, 3.9751050595551777`*^9}, {
   3.975211496053999*^9, 3.9752115611806707`*^9}, 3.9752222762020826`*^9, {
   3.97522230747921*^9, 3.9752223091301055`*^9}, 3.9752223448584843`*^9, {
   3.9752990623666654`*^9, 
   3.975299087926708*^9}},ExpressionUUID->"023ab37d-5207-460b-b05c-\
1b3b69a8454a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Einstein", "::", "usage"}], "=", 
   "\"\<Einstein[\!\(\*StyleBox[\"\[Nu]\",FontSlant->\"Italic\"]\),\!\(\*\
StyleBox[\"\[Beta]\",FontSlant->\"Italic\"]\),\!\(\*StyleBox[\(\*StyleBox[\"m\
\",FontSlant->\"Italic\"]_Tensor\)]\),EinsteinOperator\[Rule]Simplify,\
TooltipStyle\[Rule]{},TooltipDisplay\[Rule]Null] extracts the components of \
the Einstein tensor \!\(\*SubscriptBox[\(G\), \
\(\[Alpha]\[Beta]\)]\)=\!\(\*SubscriptBox[\(R\), \(\[Alpha]\[Beta]\)]\)-(1/2)\
\!\(\*SubscriptBox[\(g\), \(\[Alpha]\[Beta]\)]\)R (\!\(\*SubscriptBox[\(R\), \
\(\[Alpha]\[Beta]\)]\), \!\(\*SubscriptBox[\(g\), \(\[Alpha]\[Beta]\)]\), and \
R are respectively the Ricci tensor, metric, and Ricci scalar) from the \
metric Tensor m, and returns them as a Tensor object. The optional \
EinsteinOperator\[Rule]\!\(\*StyleBox[\"op\",FontSlant->\"Italic\"]\), with \
default \!\(\*StyleBox[\"op\",FontSlant->\"Italic\"]\) = Simplify, means \!\(\
\*StyleBox[\"op\",FontSlant->\"Italic\"]\) will be applied to the Einstein \
components.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.975096776873933*^9, 3.975096876887124*^9}, {
  3.975097193422609*^9, 3.975097226395916*^9}, {3.9750975297008533`*^9, 
  3.9750975809560285`*^9}, {3.975097625899138*^9, 3.9750976873447466`*^9}, {
  3.9750982184992857`*^9, 3.975098259444001*^9}, {3.9751050938418837`*^9, 
  3.975105146293313*^9}, {3.975211594757001*^9, 3.975211611468527*^9}, {
  3.975222366860058*^9, 3.975222376917057*^9}, {3.9752990833639936`*^9, 
  3.9752990841570168`*^9}, {3.975299151144052*^9, 
  3.975299151569249*^9}},ExpressionUUID->"34a3a216-9387-453e-bb7f-\
b4cd67c69c97"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Determinant", "::", "usage"}], "=", 
   "\"\<(I) Determinant[\!\(\*StyleBox[\(\*StyleBox[\"m\",FontSlant->\"Italic\
\"]_Tensor\)]\)] returns the determinant of the metric \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\) (TensorType must be \
\\\"Metric\\\") as a regular expression.\n[Beta version](II) Determinant[\!\(\
\*StyleBox[\(\*StyleBox[\"m\",FontSlant->\"Italic\"]_Tensor\)]\),Tensor] \
returns the determinant of the metric \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\) (TensorType must be \
\\\"Metric\\\") as a Tensor object, with Indices\[Rule]{} and TensorName\
\[Rule]|TensorName[\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\)]|. \
Coordinates, StartIndex, TooltipDisplay, TooltipStyle, TensorAssumption, \
TensorOperator will be inherited from \
\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\).\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9750983715603333`*^9, 3.9750983731739836`*^9}, {
   3.9750987028589935`*^9, 3.975098730248246*^9}, {3.9750988024193544`*^9, 
   3.9750988814818926`*^9}, {3.975098913801241*^9, 3.975099082571498*^9}, {
   3.97509912417872*^9, 3.9750991528406477`*^9}, {3.9751051705617204`*^9, 
   3.9751052251643534`*^9}, {3.975211686835528*^9, 3.975211694531139*^9}, {
   3.975222390859007*^9, 3.975222391586884*^9}, 3.9752224454367065`*^9, {
   3.9752991681586943`*^9, 
   3.975299184134071*^9}},ExpressionUUID->"c06c2222-e069-48d0-bb78-\
38f1382ecf26"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"OrthonormalFrameField", "::", "usage"}], "=", 
   "\"\<OrthonormalFrameField serves three roles. 1. OrthonormalFrameField \
can be used to calculate and append (inverse) orthonormal frame fields to a \
pre-defined metric tensor. 2. OrthonormalFrameField applied to a metric \
extracts its (inverse) orthonormal frame fields. 3. OrthonormalFrameField\
\[Rule]onff and InverseOrthonormalFrameField\[Rule]invonff occurring within a \
metric Tensor (TensorType\[Rule]\\\"Metric\\\") stores its orthonormal frame \
field components in onff and invonff. \n(I.1) \
OrthonormalFrameField[m_Tensor,OrthonormalFrameFieldOperator\[Rule]Simplify, \
OrthonormalFrameField\[Rule]onff,InverseOrthonormalFrameField\[Rule]invonff,\
OrthonormalFrameFieldIndices\[Rule]onffidx_List,FlatMetric\[Rule]fm_List,\
OutputForm\[Rule]Metric] takes in a diagonal Metric Tensor m without \
OrthonormalFrameField nor InverseOrthonormalFrameField specified, and \
\[LongDash] if the default OutputForm\[Rule]Metric is chosen \[LongDash] \
returns the same metric but now endowed with \
OrthonormalFrameField\[Rule]onff, InverseOrthonormalFrameField\[Rule]invonff, \
and FlatMetric\[Rule]fm. If OutputForm\[Rule]All is chosen instead, the \
output will be {onff,invonff,m}, where the onff and invonff are now in Tensor \
form and also stored in m. The user input fm must be a (flat) List containing \
the diagonal components of the associated flat space(time) metric, so that \
the orthonormal frame field component \!\(\*SubscriptBox[SuperscriptBox[\(\
\[CurlyEpsilon]\), OverscriptBox[\(a\), \(^\)]], \(b\)]\) may be computed as \
Kronecker[d,c]\[Cross]Power[fm\[LeftDoubleBracket]d-si,d-si\
\[RightDoubleBracket] Metric[d,d,m],1/2], where si is the StartIndex. The \
optional OrthonormalFrameFieldIndices\[Rule]onffidx, where onffidx must match \
the pattern {OverHat[_Symbol],_Symbol}, specifies the respective indices to \
appear on the orthonormal frame fields Tensor objects \
\!\(\*SubscriptBox[SuperscriptBox[\(\[CurlyEpsilon]\), OverscriptBox[\(a\), \
\(^\)]], \(b\)]\) and \!\(\*SuperscriptBox[SubscriptBox[\(\[CurlyEpsilon]\), \
OverscriptBox[\(a\), \(^\)]], \(b\)]\).\n(I.2) \
OrthonormalFrameField[m_Tensor,OrthonormalFrameFieldOperator\[Rule]Simplify, \
OrthonormalFrameField\[Rule]onff,InverseOrthonormalFrameField\[Rule]invonff,\
OrthonormalFrameFieldIndices\[Rule]onffidx_List,FlatMetric\[Rule]fm_List,\
OutputForm\[Rule]Metric] takes an arbitrary Metric Tensor m with \
\!\(\*StyleBox[\"either\",FontSlant->\"Italic\"]\) OrthonormalFrameField or \
InverseOrthonormalFrameField specified (but not both) and \[LongDash] if the \
default OutputForm\[Rule]Metric is chosen \[LongDash] returns the same metric \
but now endowed with OrthonormalFrameField\[Rule]onff, \
InverseOrthonormalFrameField\[Rule]invonff, and FlatMetric\[Rule]fm. If \
OutputForm\[Rule]All is chosen instead, the output will be {onff,invonff,m}, \
where the onff and invonff are now in Tensor form and also stored in m. The \
user input fm must be a (flat) List containing the diagonal components of the \
associated flat space(time) metric.  The optional \
OrthonormalFrameFieldIndices\[Rule]onffidx, where onffidx must match the \
pattern {OverHat[_Symbol],_Symbol}, specifies the respective indices to \
appear on the orthonormal frame fields Tensor objects \
\!\(\*SubscriptBox[SuperscriptBox[\(\[CurlyEpsilon]\), OverscriptBox[\(a\), \
\(^\)]], \(b\)]\) and \!\(\*SuperscriptBox[SubscriptBox[\(\[CurlyEpsilon]\), \
OverscriptBox[\(a\), \(^\)]], \(b\)]\).\n(I.3) \
OrthonormalFrameField[m_Tensor,OrthonormalFrameFieldOperator\[Rule]Simplify, \
OrthonormalFrameField\[Rule]onff,InverseOrthonormalFrameField\[Rule]invonff,\
OrthonormalFrameFieldIndices\[Rule]onffidx_List,FlatMetric\[Rule]fm_List,\
OutputForm\[Rule]Metric] takes an arbitrary Metric Tensor m with \
\!\(\*StyleBox[\"both\",FontSlant->\"Italic\"]\) OrthonormalFrameField or \
InverseOrthonormalFrameField specified and \[LongDash] if the default \
OutputForm\[Rule]Metric is chosen \[LongDash] returns the same metric but now \
endowed with OrthonormalFrameField\[Rule]onff, InverseOrthonormalFrameField\
\[Rule]invonff, and FlatMetric\[Rule]fm. If OutputForm\[Rule]All is chosen \
instead, the output will be {onff,invonff,m}, where the onff and invonff are \
now in Tensor form and also stored in m. The user input fm must be a (flat) \
List containing the diagonal components of the associated flat space(time) \
metric. The optional OrthonormalFrameFieldIndices\[Rule]onffidx, where \
onffidx must match the pattern {OverHat[_Symbol],_Symbol}, specifies the \
respective indices to appear on the orthonormal frame fields Tensor objects \
\!\(\*SubscriptBox[SuperscriptBox[\(\[CurlyEpsilon]\), OverscriptBox[\(a\), \
\(^\)]], \(b\)]\) and \!\(\*SuperscriptBox[SubscriptBox[\(\[CurlyEpsilon]\), \
OverscriptBox[\(a\), \(^\)]], \(b\)]\).\n(I.4) \
OrthonormalFrameField[m_Tensor,eigens_List,odr_List,\
OrthonormalFrameFieldOperator\[Rule]Simplify, \
OrthonormalFrameField\[Rule]onff,InverseOrthonormalFrameField\[Rule]invonff,\
OrthonormalFrameFieldIndices\[Rule]onffidx_List,FlatMetric\[Rule]fm_List,\
OutputForm\[Rule]Metric] takes in a generic Metric Tensor m without \
OrthonormalFrameField nor InverseOrthonormalFrameField specified, computes \
them, and \[LongDash] if the default OutputForm\[Rule]Metric is chosen \
\[LongDash] returns m with OrthonormalFrameField\[Rule]onff, \
InverseOrthonormalFrameField\[Rule]invonff and FlatMetric\[Rule]fm_List \
stored inside. If OutputForm\[Rule]All is chosen instead, the output will be \
{onff,invonff,m}, where the onff and invonff are now in Tensor form and also \
stored in m. Here, the eigens must be Eigensystem[m] and odr is the order in \
which the former's eigenvector/value components need to be arranged. The user \
input fm must be a diagonal matrix, and is meant to represent the associated \
flat space(time) geometry. The optional \
OrthonormalFrameFieldIndices\[Rule]onffidx, where onffidx must match the \
pattern {OverHat[_Symbol],_Symbol}, specifies the respective indices to \
appear on the orthonormal frame fields Tensor objects \
\!\(\*SubscriptBox[SuperscriptBox[\(\[CurlyEpsilon]\), OverscriptBox[\(a\), \
\(^\)]], \(b\)]\) and \!\(\*SuperscriptBox[SubscriptBox[\(\[CurlyEpsilon]\), \
OverscriptBox[\(a\), \(^\)]], \(b\)]\).\n(II.1) \
OrthonormalFrameField[OverHat[a],b,m_Tensor] extracts the \
(Inverse)OrthonormalFrameField Tensor \!\(\*SubscriptBox[SuperscriptBox[\(\
\[CurlyEpsilon]\), OverscriptBox[\(a\), \(^\)]], \(b\)]\), \
\!\(\*SubscriptBox[SubscriptBox[\(\[CurlyEpsilon]\), OverscriptBox[\(a\), \(^\
\)]], \(b\)]\), \!\(\*SuperscriptBox[SubscriptBox[\(\[CurlyEpsilon]\), \
OverscriptBox[\(a\), \(^\)]], \(b\)]\) or \!\(\*SuperscriptBox[\(\
\[CurlyEpsilon]\), \(\*OverscriptBox[\(a\), \(^\)] b\)]\)  from the metric \
Tensor m and returns it as a Tensor object.\n(II.2) \
OrthonormalFrameField[m_Tensor] extract the OrthonormalFrameField Tensor from \
Metric Tensor m, and returns the pair of Tensor objects \
{\!\(\*SubscriptBox[SuperscriptBox[\(\[CurlyEpsilon]\), OverscriptBox[\(a\), \
\(^\)]], \(b\)]\), \!\(\*SuperscriptBox[SubscriptBox[\(\[CurlyEpsilon]\), \
OverscriptBox[\(a\), \(^\)]], \(b\)]\)}.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9750273980439463`*^9, 3.9750273980451813`*^9}, {
   3.975028569949842*^9, 3.975028581830971*^9}, {3.975028794245554*^9, 
   3.975029073801445*^9}, {3.9750291605648746`*^9, 3.975029248207605*^9}, {
   3.97502934853915*^9, 3.975029732331931*^9}, {3.975029821238043*^9, 
   3.975030271702276*^9}, {3.975030302156996*^9, 3.975030356250091*^9}, 
   3.975030391380012*^9, {3.975030442645851*^9, 3.975030624270101*^9}, {
   3.975031108788294*^9, 3.975031129749366*^9}, {3.975031220118162*^9, 
   3.9750312981690207`*^9}, {3.975031371644228*^9, 3.975031420616603*^9}, {
   3.975031493963998*^9, 3.975031778637517*^9}, {3.975031808921077*^9, 
   3.975031826717551*^9}, {3.9750320880024977`*^9, 3.975032116679717*^9}, {
   3.975032150578279*^9, 3.975032368174439*^9}, {3.975032411832416*^9, 
   3.975032413092675*^9}, 3.975032567876687*^9, {3.975033967717206*^9, 
   3.975034011045014*^9}, {3.975118540281087*^9, 3.9751185412413306`*^9}, {
   3.9751189574155717`*^9, 3.9751190865702095`*^9}, {3.9751191352255354`*^9, 
   3.975119148835137*^9}, {3.975119310462859*^9, 3.975119603656803*^9}, {
   3.975120331901018*^9, 3.9751203500856056`*^9}, 3.9751206211850514`*^9, {
   3.9751216167804794`*^9, 3.9751216174715242`*^9}, {3.975178671395578*^9, 
   3.975178743711522*^9}, {3.975178928890276*^9, 3.9751789641407366`*^9}, {
   3.975179722297864*^9, 3.975179839877936*^9}, {3.975180078706583*^9, 
   3.9751801270227346`*^9}, {3.9751803967322807`*^9, 3.975180416263583*^9}, {
   3.9751804675266438`*^9, 3.975180479115858*^9}, {3.975180544001872*^9, 
   3.9751805666873293`*^9}, {3.975180653008628*^9, 3.9751807433010387`*^9}, {
   3.9751813178428397`*^9, 3.975181377788683*^9}, {3.9751815329071703`*^9, 
   3.9751815596688275`*^9}, {3.9751816435452185`*^9, 
   3.9751816607476835`*^9}, {3.9751820207008953`*^9, 
   3.9751820271490726`*^9}, {3.9751820679172945`*^9, 
   3.9751820774236283`*^9}, {3.9751839629360375`*^9, 3.9751839791549034`*^9}, 
   3.9751840287302895`*^9, {3.975184093535446*^9, 3.9751840960069656`*^9}, {
   3.975184566122465*^9, 3.9751845958856297`*^9}, {3.975184777102065*^9, 
   3.975184785440056*^9}, 3.975185104679572*^9, {3.9751861480461063`*^9, 
   3.9751862310022955`*^9}, {3.9751862833818893`*^9, 3.975186291392838*^9}, {
   3.9751864329451375`*^9, 3.9751864943307886`*^9}, {3.975186580219606*^9, 
   3.975186609181031*^9}, {3.9751866673484416`*^9, 3.9751866978594933`*^9}, {
   3.975186734008185*^9, 3.9751867710077543`*^9}, {3.975186850223236*^9, 
   3.9751868532987127`*^9}, {3.975186883432375*^9, 3.975187237951049*^9}, {
   3.9751872729584017`*^9, 3.9751872968854074`*^9}, {3.9751876971832924`*^9, 
   3.9751878898502836`*^9}, {3.9751879272749834`*^9, 3.975187998595645*^9}, {
   3.9751880862992315`*^9, 3.975188221278228*^9}, {3.975188275760309*^9, 
   3.9751883076854043`*^9}, {3.975188386408538*^9, 3.975188425907957*^9}, {
   3.9751886043097773`*^9, 3.9751886242836685`*^9}, {3.9751886587532177`*^9, 
   3.9751887411048136`*^9}, {3.9751887769607444`*^9, 
   3.9751888132140303`*^9}, {3.975188861108553*^9, 3.9751888928677764`*^9}, {
   3.975188933466957*^9, 3.9751889580968103`*^9}, {3.9751889887258587`*^9, 
   3.9751891494472637`*^9}, {3.975189572425298*^9, 3.97518961679056*^9}, {
   3.9751896868434877`*^9, 3.975189717173072*^9}, {3.9751897809909754`*^9, 
   3.975189846643205*^9}, {3.975189921870902*^9, 3.975189962531974*^9}, {
   3.9751900391344624`*^9, 3.975190050717804*^9}, {3.975190087884267*^9, 
   3.975190092606534*^9}, {3.9751901234919305`*^9, 3.975190207482699*^9}, {
   3.9751902780476584`*^9, 3.975190309751793*^9}, {3.975190399804711*^9, 
   3.9751904371230745`*^9}, {3.9752270834883356`*^9, 3.975227088613691*^9}, {
   3.9752271303170652`*^9, 3.9752271338249707`*^9}, 3.975227171506835*^9, {
   3.9753004083486786`*^9, 3.975300413044918*^9}, {3.9753004491011806`*^9, 
   3.9753004879580517`*^9}, 
   3.9753014724143853`*^9},ExpressionUUID->"0e8f11ce-62f8-4efa-b4de-\
340b617ea5dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"InverseOrthonormalFrameField", "::", "usage"}], "=", 
   "\"\<InverseOrthonormalFrameField\[Rule]invoff is an optional argument of \
Tensor objects with TensorType\\\"Metric\\\", where invoff are the components \
of the inverse orthonormal frame fields of the given metric. For more \
details, refer to OrthonormalFrameField's usage.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9750329557751427`*^9, 3.97503296284306*^9}, {
  3.975033004001549*^9, 3.975033119351714*^9}, {3.9750509387300215`*^9, 
  3.975050966930324*^9}, {3.975051014716136*^9, 3.975051016836592*^9}, {
  3.9752104006533003`*^9, 3.9752106622550898`*^9}, {3.9752107048913727`*^9, 
  3.975210705351117*^9}},ExpressionUUID->"f0a36b46-81e0-43bc-a011-\
40f49c873ade"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FlatMetric", "::", "usage"}], "=", 
   "\"\<FlatMetric is the key toggle to trigger OrthonormalFrameField related \
calculations. By endowing a metric Tensor with the optional \
FlatMetric\[Rule]fm, its (inverse) orthonormal frame fields would be computed \
and stored. The fm must be a (flat) List containing the diagonal components \
of the associated flat space(time) metric \[LongDash] and FlatMetric\[Rule]fm \
itself can be fed to a metric Tensor by both the Metric and \
OrthonormalFrameField Functions.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.975033124512981*^9, 3.9750332428990993`*^9}, {
   3.9750333068151083`*^9, 3.975033325718081*^9}, {3.975033383472155*^9, 
   3.975033430850298*^9}, {3.975210761794024*^9, 3.975211101514822*^9}, {
   3.9752118533812246`*^9, 3.9752118545710115`*^9}, 3.9752269785536385`*^9, {
   3.975227095956318*^9, 
   3.9752270961930466`*^9}},ExpressionUUID->"0840cd01-4067-445d-a265-\
dc7287d0d89e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"OrthonormalFrameFieldOperator", "::", "usage"}], "=", 
   "\"\<OrthonormalFrameFieldOperator\[Rule]op is an optional argument of \
both Metric and OrthonormalFrameField Functions. The op is applied to the \
results of an OrthonormalFrameField calculation, with default op = \
Simplify.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9750334530182056`*^9, 3.975033535829112*^9}, {
   3.975035184670864*^9, 3.975035234448434*^9}, 3.975035297971129*^9, {
   3.9752111297742724`*^9, 3.9752112581618185`*^9}, {3.9753006825731993`*^9, 
   3.9753006828976245`*^9}},ExpressionUUID->"64c2eeb9-e345-439e-b10c-\
8cf833fae536"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"OrthonormalFrameFieldOperator", "::", "usage"}], "=", 
   "\"\<OrthonormalFrameFieldOperator\[Rule]op is an optional argument of \
both Metric and OrthonormalFrameField Functions. The op is applied to the \
results of an OrthonormalFrameField calculation, with default op = \
Simplify.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9750334530182056`*^9, 3.975033535829112*^9}, {
   3.975035184670864*^9, 3.975035234448434*^9}, 3.975035297971129*^9, {
   3.9752111297742724`*^9, 3.9752112581618185`*^9}, {3.975300667429696*^9, 
   3.9753006677780495`*^9}},ExpressionUUID->"1d6e7d87-02ad-4212-848a-\
75cc83be4bf9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"OrthonormalFrameFieldIndices", "::", "usage"}], "=", 
   "\"\<OrthonormalFrameFieldIndices\[Rule]{OverHat[\[Alpha]],\[Beta]}, where \
\[Alpha] and \[Beta] are indices \
\!\(\*StyleBox[\"without\",FontSlant->\"Italic\"]\) the SubMinus nor \
SuperMinus Head's, is an optional argument of both Metric and \
OrthonormalFrameField functions specifying the indices on the orthonormal \
frame fields and its inverse; namely, \!\(\*SubscriptBox[SuperscriptBox[\(\
\[CurlyEpsilon]\), OverscriptBox[\(\[Alpha]\), \(^\)]], \(\[Beta]\)]\) and \!\
\(\*SuperscriptBox[SubscriptBox[\(\[CurlyEpsilon]\), OverscriptBox[\(\[Alpha]\
\), \(^\)]], \(\[Beta]\)]\).\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.975033893626071*^9, 3.9750339301700068`*^9}, 
   3.975034031809565*^9, {3.975211335040696*^9, 3.975211420122517*^9}, {
   3.975211470273612*^9, 3.975211594278029*^9}, {3.9753006875505395`*^9, 
   3.9753006940220966`*^9}},ExpressionUUID->"0a2c0e8a-7274-4d91-ad48-\
95a70181b78e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"OrthonormalFrameFieldQ", "::", "usage"}], "=", 
   "\"\<OrthonormalFrameFieldQ[m_Tensor, OutputForm\[Rule]BooleanQ] takes in \
a Metric Tensor m with FlatMetric \!\(\*SubscriptBox[\(\[Eta]\), \(ab\)]\), \
OrthonormalFrameField \!\(\*SubscriptBox[SuperscriptBox[\(\[CurlyEpsilon]\), \
OverscriptBox[\(a\), \(^\)]], \(c\)]\), InverseOrthonormalFrameField \
\!\(\*SubscriptBox[SuperscriptBox[\(\[CurlyEpsilon]\), OverscriptBox[\(b\), \
\(^\)]], \(d\)]\) and OrthonormalFrameFieldOperator\[Rule]onffop stored \
inside, and verifies if \
\!\(\*SubscriptBox[SuperscriptBox[\(\[CurlyEpsilon]\), OverscriptBox[\(a\), \
\(^\)]], \(c\)]\) and \!\(\*SubscriptBox[SuperscriptBox[\(\[CurlyEpsilon]\), \
OverscriptBox[\(b\), \(^\)]], \(d\)]\)'s defining relations \
\!\(\*SubscriptBox[\(g\), \(cd\)]\)=\!\(\*SubscriptBox[SuperscriptBox[\(\
\[CurlyEpsilon]\), OverscriptBox[\(a\), \(^\)]], \
\(c\)]\)\!\(TraditionalForm\`\*SubscriptBox[\(\[Eta]\), \
\(ab\)]\)\!\(\*SubscriptBox[SuperscriptBox[\(\[CurlyEpsilon]\), \
OverscriptBox[\(b\), \(^\)]], \(d\)]\) and \!\(\*SubscriptBox[\(\[Eta]\), \
\(cd\)]\)=\!\(\*SuperscriptBox[SubscriptBox[\(\[CurlyEpsilon]\), \
OverscriptBox[\(c\), \(^\)]], \(a\)]\)\!\(TraditionalForm\`\*SubscriptBox[\(g\
\), \(ab\)]\)\!\(\*SuperscriptBox[SubscriptBox[\(\[CurlyEpsilon]\), \
OverscriptBox[\(d\), \(^\)]], \(b\)]\) are satisfied. With the default value \
of the OptionValue OutputForm\[Rule]BooleanQ, it outputs True if both \
equations are True; otherwise, it outputs False. If OutputForm\[Rule]List is \
specified, it displays {\!\(\*SubscriptBox[\(g\), \
\(cd\)]\)==\!\(\*SubscriptBox[SuperscriptBox[\(\[CurlyEpsilon]\), \
OverscriptBox[\(a\), \(^\)]], \(c\)]\)\!\(TraditionalForm\`\*SubscriptBox[\(\
\[Eta]\), \(ab\)]\)\!\(\*SubscriptBox[SuperscriptBox[\(\[CurlyEpsilon]\), \
OverscriptBox[\(b\), \(^\)]], \(d\)]\), \!\(\*SubscriptBox[\(\[Eta]\), \
\(cd\)]\)==\!\(\*SuperscriptBox[SubscriptBox[\(\[CurlyEpsilon]\), \
OverscriptBox[\(c\), \(^\)]], \(a\)]\)\!\(TraditionalForm\`\*SubscriptBox[\(g\
\), \(ab\)]\)\!\(\*SuperscriptBox[SubscriptBox[\(\[CurlyEpsilon]\), \
OverscriptBox[\(d\), \(^\)]], \(b\)]\)}.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.975032402510906*^9, 3.9750324195651913`*^9}, {
  3.975032517511526*^9, 3.975032926403523*^9}, {3.9752099930512667`*^9, 
  3.975210202117813*^9}, {3.9752117637413583`*^9, 3.9752117651134787`*^9}, {
  3.9753005273101945`*^9, 
  3.9753005517181273`*^9}},ExpressionUUID->"0ec3d3d0-2fd9-421d-89c3-\
7cfd69f3e8be"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TensorsProduct", "::", "usage"}], "=", 
   "\"\<(I) TensorsProduct[Times[t1_Tensor,t2_Tensor,...]] \[LongDash] not to \
be confused with Mathematica's own TensorProduct \[LongDash] returns a single \
Tensor object with TensorComponents corresponding to \
Times[t1_Tensor,t2_Tensor,...]. All other attributes of the output Tensor are \
inherited from the one of the Tensor's in the sequence. Note that if there is \
a pair of up-down repeated indices, with the two indices occurring on \
different Tensors, tensor contraction will be triggered automatically. \
Additionally, if two Tensor objects do not share the same coordinate system, \
they will \!\(\*StyleBox[\"not\",FontSlant->\"Italic\"]\) be combined into \
the same Tensor object by TensorsProduct.\n(II) \
TensorsProduct[{t1_Tensor,t2_Tensor,...}] returns the same result as in (I), \
with TensorComponents given by t1\[TensorProduct]t2\[TensorProduct]...; i.e., \
in the precise order given by {t1,t2,...}.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.975118357471055*^9, 3.9751184450890217`*^9}, {
   3.9751185876676397`*^9, 3.9751190233258305`*^9}, {3.9751192644270134`*^9, 
   3.975119352405797*^9}, {3.9751195920038037`*^9, 3.9751196683963966`*^9}, {
   3.975119800288966*^9, 3.9751198056159825`*^9}, {3.975144524237975*^9, 
   3.975144783485262*^9}, {3.9751451097641106`*^9, 3.9751451377340145`*^9}, 
   3.975145222467703*^9, {3.9751463858045797`*^9, 3.9751463900162325`*^9}, {
   3.9751464859530315`*^9, 3.9751466037986135`*^9}, {3.975208857031374*^9, 
   3.975208909095708*^9}, {3.975208951495015*^9, 3.975209022845888*^9}, {
   3.9752091146051598`*^9, 3.975209167907197*^9}, {3.975213502059482*^9, 
   3.9752135060454664`*^9}, {3.9752135571142464`*^9, 
   3.9752135607067723`*^9}, {3.9752136167811327`*^9, 3.975213617556739*^9}, {
   3.9752141721051807`*^9, 3.9752141742344127`*^9}, {3.975214241004426*^9, 
   3.975214246977006*^9}, {3.975214381354582*^9, 3.9752144039633865`*^9}, {
   3.975214465694738*^9, 3.975214467268859*^9}, {3.975214836185499*^9, 
   3.975214940294194*^9}, {3.975216432530905*^9, 3.9752164751512766`*^9}, {
   3.975216532883683*^9, 3.9752165330790167`*^9}, {3.975216853113637*^9, 
   3.9752169162583723`*^9}, 3.9752169559173355`*^9, {3.9752170101095963`*^9, 
   3.9752170474978848`*^9}},ExpressionUUID->"229a5457-dea8-4823-a61b-\
55e5d9daf7ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ContractTensors", "::", "usage"}], "=", 
   "\"\<(I) ContractTensors[Times[t1_Tensor,t2_Tensor,...]] will contract \
together tensors with repeated indices and return them as a single Tensor \
object, with the attributes of the output Tensor inherited from one of the \
Tensor's. \n(II) ContractTensors[{t1_Tensor,t2_Tensor,...}] returns the same \
result as (I), but the tensors are multiplied in the precise order specified \
by {t1,t2,...}.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.975119370381735*^9, 3.97511946512824*^9}, {
   3.9751194974810257`*^9, 3.975119580674817*^9}, {3.9751198135038815`*^9, 
   3.975119814496169*^9}, 3.975141638108677*^9, {3.975145905774579*^9, 
   3.9751460930772514`*^9}, {3.975146149941519*^9, 3.9751462125217104`*^9}, {
   3.975146246607277*^9, 3.9751462605228405`*^9}, {3.975146614988476*^9, 
   3.975146615671311*^9}, 3.975209038796479*^9, {3.975213710110553*^9, 
   3.975213929943536*^9}, {3.9752171358175993`*^9, 3.975217136346199*^9}, {
   3.9752172985478334`*^9, 3.9752173212725105`*^9}, 3.975217389324374*^9, {
   3.97521748504825*^9, 3.975217536008107*^9}, {3.9752176055858555`*^9, 
   3.9752176068167543`*^9}, {3.975300817184352*^9, 
   3.9753008175698795`*^9}},ExpressionUUID->"dfb70237-bf73-4b86-b8a3-\
b2dcac71e9d2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SwapIndices", "::", "usage"}], "=", 
   "\"\<SwapIndices[t_Tensor,idx_List] takes in a rank-n Tensor t returns \
\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\), with its un-UnderBarred \
indices (say, \!\(TraditionalForm\`\*SubscriptBox[\(i\), \(1\)]\) ... \
\!\(TraditionalForm\`\*SubscriptBox[\(i\), \(n\)]\)) re-arranged into \
\!\(\*StyleBox[\"idx\",FontSlant->\"Italic\"]\) (say, \
\!\(TraditionalForm\`\*SubscriptBox[\(j\), \(1\)]\) ... \!\(TraditionalForm\`\
\*SubscriptBox[\(j\), \(n\)]\)), where the latter is a permutation of the \
former indices set, i.e., all the members of j should comes from i \
non-repeatedly; with its TensorComponents re-arranged accordingly. When \
specifying \!\(\*StyleBox[\"idx\",FontSlant->\"Italic\"]\), do not include \
the UnderBarred (i.e., inert) Indices of \
\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\).\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.975099718681471*^9, 3.975099736183646*^9}, {
  3.975099954116619*^9, 3.97510001485501*^9}, {3.975100838390197*^9, 
  3.97510085482768*^9}, {3.975212220603994*^9, 3.9752122577390823`*^9}, {
  3.975212314892408*^9, 3.9752124587035522`*^9}, {3.9752124887774467`*^9, 
  3.97521251511143*^9}},ExpressionUUID->"507b535c-1a57-44bc-a30b-\
3616952e27e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MoveIndices", "::", "usage"}], "=", 
   "\"\<(I) MoveIndices[t_Tensor,idx_List,m_Tensor] returns the Tensor \
\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\) with its indices moved \
\[LongDash] using the Metric Tensor m (TensorType must be \\\"Metric\\\") \
\[LongDash] into the configuration of indices position or basis given by \!\(\
\*StyleBox[\"idx\",FontSlant->\"Italic\"]\) List; and its TensorComponents \
accordingly contracted into m, m's inverse, and/or the orthonormal frame \
fields. The output indices \!\(\*StyleBox[\"idx\",FontSlant->\"Italic\"]\) \
can contain both coordinate basis and OverHat (orthonormal basis) ones. If \
idx does contain orthonormal indices, m needs to contain calculated \
OrthonormalFrameField and InverseOrthonormalFrameField.\n(II) \
MoveIndices[t_Tensor,OrthonormalBasis,m_Tensor] returns the Tensor t but \
converts all its indices into orthonormal ones by contracting its \
TensorComponents with the metric m's orthonormal frame fields and their \
inverses. The positions of t's indices are retained.\n(III) \
MoveIndices[t_Tensor,CoordinateBasis,m_Tensor] converts all its indices into \
coordinate ones by contracting its TensorComponents with the metric m's \
orthonormal frame fields and their inverses. The positions of t's indices are \
retained.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.975116266640026*^9, {3.9751165456143923`*^9, 3.97511656445337*^9}, {
   3.9751166060062294`*^9, 3.9751166659438047`*^9}, {3.9751166965927553`*^9, 
   3.9751167000556135`*^9}, {3.975116737898551*^9, 3.975116958422855*^9}, 
   3.975143574454605*^9, {3.975143679997466*^9, 3.9751438390871897`*^9}, {
   3.97514392216135*^9, 3.97514392394472*^9}, {3.9751439629248548`*^9, 
   3.9751440496270046`*^9}, {3.9751441110360146`*^9, 3.975144145984875*^9}, {
   3.9751875007849894`*^9, 
   3.9751875330375333`*^9}},ExpressionUUID->"68d5cf28-e9dd-48b3-a43a-\
1105c26c88fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RaiseAllIndices", "::", "usage"}], "=", 
   "\"\<RaiseAllIndices[t_Tensor,m_Tensor] returns the Tensor \!\(\*StyleBox[\
\"t\",FontSlant->\"Italic\"]\) with all its indices raised using the Metric \
Tensor \!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\) (TensorType must be \
\\\"Metric\\\").\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.975101307778654*^9, 3.975101309349495*^9}, {
  3.9751014226505194`*^9, 3.975101461007936*^9}, {3.9752127076359777`*^9, 
  3.975212712770534*^9}, {3.9752224894818306`*^9, 
  3.9752224950819464`*^9}},ExpressionUUID->"b85fe9cb-0096-4514-8d52-\
7f2b229d9c29"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LowerAllIndices", "::", "usage"}], "=", 
   "\"\<LowerAllIndices[t_Tensor,m_Tensor] returns the Tensor \!\(\*StyleBox[\
\"t\",FontSlant->\"Italic\"]\) with all its indices lowered using the Metric \
Tensor \!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\) (TensorType must be \
\\\"Metric\\\").\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9751014727182193`*^9, 3.975101485076586*^9}, 
   3.975212741874946*^9, {3.9752225037314386`*^9, 
   3.975222508151229*^9}},ExpressionUUID->"2380f246-888e-442c-b815-\
96c97e42aa5b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"UniqueIndices", "::", "usage"}], "=", 
   "\"\<UniqueIndices[t_Tensor] returns the Tensor \
\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\) with all its indices replaced \
with Unique ones.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.975101622354076*^9, 3.9751016331040316`*^9}, {
  3.9751053723786964`*^9, 
  3.975105373617318*^9}},ExpressionUUID->"bd449ed4-c0e3-4575-947e-\
332ffa5120a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SymmetrizeIndices", "::", "usage"}], "=", 
   "\"\<(I) SymmetrizeIndices[idx_List,t_Tensor,SymmetrizeIndicesOperator\
\[Rule](#&)] returns the Tensor \!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\) \
with its indices \!\(\*StyleBox[\"idx\",FontSlant->\"Italic\"]\) symmetrized; \
i.e., with its TensorComponents symmetrized accordingly. Every index in \
\!\(\*StyleBox[\"idx\",FontSlant->\"Italic\"]\) must be an index from Tensor \
\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\). The optional \
SymmetrizeIndicesOperator\[Rule]op means op will be applied to the output \
TensorComponents, with the default op = #& being an 'identity' operator.\n\
(II) SymmetrizeIndices[t_Tensor,SymmetrizeIndicesOperator\[Rule](#&)] returns \
the Tensor \!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\) with its Indices and \
TensorComponents fully symmetrized.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.975101657894751*^9, 3.97510170983683*^9}, {
  3.975101766864802*^9, 3.9751017673248115`*^9}, {3.9751019511503897`*^9, 
  3.9751020516173677`*^9}, {3.9751021288918486`*^9, 3.9751021685303774`*^9}, {
  3.97510220008572*^9, 3.975102412779696*^9}, {3.9751054248127356`*^9, 
  3.975105426949997*^9}},ExpressionUUID->"ba217347-a720-4ea0-abe4-\
2eb284663546"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AntiSymmetrizeIndices", "::", "usage"}], "=", 
   "\"\<(I) AntiSymmetrizeIndices[idx_List,t_Tensor,\
AntiSymmetrizeIndicesOperator\[Rule](#&)] returns Tensor \
\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\) with its indices idx \
anti-symmetrized; i.e., with its TensorComponents anti-symmetrized \
accordingly. Every index in \!\(\*StyleBox[\"idx\",FontSlant->\"Italic\"]\) \
must be an index from Tensor \!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\). \
The optional AntiSymmetrizeIndicesOperator\[Rule]op means op will be applied \
to the output TensorComponents, with the default op = #& being an 'identity' \
operator.\n(II) AntiSymmetrizeIndices[t_Tensor,AntiSymmetrizeIndicesOperator\
\[Rule](#&)] returns \!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\) with its \
Indices and TensorComponents fully anti-symmetrized.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9751024348832054`*^9, 3.9751024363636045`*^9}, {
  3.9751026087167487`*^9, 3.9751027975006766`*^9}, {3.975105438949955*^9, 
  3.9751054736839457`*^9}},ExpressionUUID->"3b489c48-2bc1-48f1-bdbf-\
e21c47b19721"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PartialD", "::", "usage"}], "=", 
   "\"\<(I) PartialD[\[Mu],t,m_Tensor] returns a Tensor object with \
TensorComponents corresponding to \!\(TraditionalForm\`\*SubscriptBox[\(\
\[PartialD]\), \(\[Mu]\)]\)t or \!\(TraditionalForm\`\*SuperscriptBox[\(g\), \
\(\[Mu]\[Nu]\)] \*SubscriptBox[\(\[PartialD]\), \(\[Nu]\)]\)t, where t can be \
either a regular expression or a Tensor object. Here, \
\!\(\*SuperscriptBox[\(g\), \(\[Mu]\[Nu]\)]\) is the inverse metric \
associated with the metric Tensor \!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\
\) (TensorType must be \\\"Metric\\\"). The \
\!\(\*SubscriptBox[\(\[PartialD]\), \(\[Mu]\)]\) is the derivative with \
respect to the \[Mu]-th coordinate of the geometry m.\n(II) \
PartialD[\!\(\*SubscriptBox[\(\[Mu]\), \(-\)]\),t_Tensor] (shortcut \
\!\(\*SubscriptBox[\(\[PartialD]\), \(TraditionalForm\`\*SubscriptBox[\(\[Mu]\
\), \(-\)]\)]\)t or D[t_Tensor,\!\(TraditionalForm\`\*SubscriptBox[\(\[Mu]\), \
\(-\)]\)]) returns the same result as in (I) but \[Mu] can only be a lower \
index because the geometry is not provided.\n(III) \
PartialD[\!\(\*SubscriptBox[\(\[Mu]\), \
\(-\)]\),t,Coordinates\[Rule]coord_List] returns a Tensor object with \
TensorComponents corresponding to \!\(TraditionalForm\`\*SubscriptBox[\(\
\[PartialD]\), \(\[Mu]\)]\)t or \!\(TraditionalForm\`\*SuperscriptBox[\(g\), \
\(\[Mu]\[Nu]\)] \*SubscriptBox[\(\[PartialD]\), \(\[Nu]\)]\)t, where t can be \
either a regular expression or a Tensor object, where \!\(\*SubscriptBox[\(\
\[PartialD]\), \(\[Mu]\)]\) is the derivative with respect to the \[Mu]-th \
coordinate of coord.\n(IV) PartialD[t_Tensor,z] returns a Tensor object with \
TensorComponents \!\(TraditionalForm\`\*SubscriptBox[\(\[PartialD]\), \
\(z\)]\)t.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9751122978977847`*^9, 3.9751122995293584`*^9}, 
   3.9751126486498156`*^9, {3.9751131548779526`*^9, 3.975113159125807*^9}, {
   3.9751132053824744`*^9, 3.975113257048185*^9}, {3.9751134394766417`*^9, 
   3.9751134872859697`*^9}, {3.9751141467654667`*^9, 3.975114319874195*^9}, {
   3.9751143577787876`*^9, 3.97511446958972*^9}, {3.9751147341789846`*^9, 
   3.9751147833409567`*^9}, {3.9751148332375584`*^9, 3.975115002337179*^9}, {
   3.9751412424900503`*^9, 3.9751412730379205`*^9}, {3.9751413243182564`*^9, 
   3.9751413818727946`*^9}, {3.975141416880123*^9, 3.9751414655612226`*^9}, 
   3.9751415052991233`*^9, {3.9751415546007133`*^9, 3.9751416051310134`*^9}, {
   3.97514198883832*^9, 3.9751420521604333`*^9}, {3.9751421300186625`*^9, 
   3.975142164944268*^9}, {3.9751423153224506`*^9, 3.9751423283202467`*^9}, {
   3.9751424871361523`*^9, 3.9751425435958643`*^9}, {3.975143128881179*^9, 
   3.9751431385168943`*^9}, {3.97514318483237*^9, 3.9751432129391966`*^9}, {
   3.975207982750477*^9, 3.9752080486851683`*^9}, {3.9752081600445843`*^9, 
   3.975208186748712*^9}, {3.97520822116429*^9, 3.975208326922057*^9}, {
   3.9752083799532433`*^9, 3.9752083849850893`*^9}, {3.975223871294781*^9, 
   3.9752239052584543`*^9}, {3.9752239398515487`*^9, 3.975223961527093*^9}, {
   3.9752241711170588`*^9, 3.9752242088680067`*^9}, {3.9752242871132326`*^9, 
   3.9752243049144306`*^9}, {3.975224335899288*^9, 3.9752243750754967`*^9}, 
   3.975224462588417*^9, 3.9752245656882257`*^9, {3.9752330411924887`*^9, 
   3.975233126943326*^9}, {3.975233367754497*^9, 
   3.975233409374892*^9}},ExpressionUUID->"c9640564-d128-4a36-8e86-\
37f94584b9a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CovariantD", "::", "usage"}], "=", 
   "\"\<CovariantD[\[Mu],t_Tensor,m_Tensor] returns a Tensor object with \
TensorComponents consisting of the components of \
\!\(\*SubscriptBox[\(\[Del]\), \(\[Mu]\)]\)t (or \
\!\(\*SuperscriptBox[\(\[Del]\), \(\[Mu]\)]\)t), where \[Del] is the \
metric-compatible covariant derivative with respect to the metric m.\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9751155512294874`*^9, 3.9751156451229067`*^9}, {
   3.9751157086421704`*^9, 3.9751158378125896`*^9}, {3.975115892853815*^9, 
   3.9751159734718695`*^9}, 3.975142640908932*^9, {3.9751432265823784`*^9, 
   3.9751433499460735`*^9}, {3.9751434655592594`*^9, 3.975143564110444*^9}, {
   3.975208401167481*^9, 3.9752084181896353`*^9}, 3.975224659637822*^9, {
   3.975224715962647*^9, 
   3.975224717320614*^9}},ExpressionUUID->"646a151a-246a-4a32-9655-\
2b4db73ce7ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CovariantBox", "::", "usage"}], "=", 
   "\"\<CovariantBox[S,m_Tensor] returns \!\(\*SubscriptBox[\(\[Del]\), \(\
\[Mu]\)]\)\!\(\*SuperscriptBox[\(\[Del]\), \(\[Mu]\)]\) applied to S, where \
\!\(\*SubscriptBox[\(\[Del]\), \(\[Mu]\)]\)\!\(\*SuperscriptBox[\(\[Del]\), \
\(\[Mu]\)]\) is the the covariant 'Laplacian' with respect to the metric \!\(\
\*StyleBox[\"m\",FontSlant->\"Italic\"]\) (TensorType must be Metric). If S \
is a regular expression, the output will be a regular expression. If S is a \
Tensor object, the output will be a Tensor object.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9751032545164547`*^9, 3.9751032559127436`*^9}, {
   3.9751032872604733`*^9, 3.9751033677478085`*^9}, {3.9751034196573443`*^9, 
   3.9751035025456686`*^9}, {3.9751036018969717`*^9, 
   3.9751036412815695`*^9}, {3.975105656562003*^9, 3.9751056575293617`*^9}, {
   3.975213224659041*^9, 3.975213230498785*^9}, 3.975222529584839*^9, 
   3.975222608531623*^9},ExpressionUUID->"1f143eb3-1932-4858-a024-\
7f694e0272b8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GradientSquared", "::", "usage"}], "=", 
   "\"\<GradientSquared[S,m_Tensor] takes in a regular expression S and \
returns the regular expression \!\(\*SuperscriptBox[\(g\), \
\(\[Mu]\[Nu]\)]\)\!\(\*SubscriptBox[\(\[PartialD]\), \
\(\[Mu]\)]\)S\!\(\*SubscriptBox[\(\[PartialD]\), \(\[Nu]\)]\)S, where \
\!\(\*SuperscriptBox[\(g\), \(\[Mu]\[Nu]\)]\) is the inverse metric \
associated with the metric \!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\) \
(TensorType must be Metric).\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.975103517615204*^9, 3.975103645804901*^9}, {
   3.9752132529305887`*^9, 3.975213314946869*^9}, {3.975222650217905*^9, 
   3.9752226581172647`*^9}, 
   3.9752230313363667`*^9},ExpressionUUID->"0ed6c819-4642-46d1-8bea-\
23048380868c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"InteriorProduct", "::", "usage"}], "=", 
   "\"\<(I) InteriorProduct[X_Tensor,\[Omega]_Tensor] (shortcut \
\!\(\*SubscriptBox[\(\[Iota]\), \(X\)]\)[\[Omega]], \[Iota]=\\\\[Iota]) \
contracts an n-vector \!\(\*SuperscriptBox[\(X\), \(\(\*SubscriptBox[\(\
\[Alpha]\), \(1\)] ... \) \*SubscriptBox[\(\[Alpha]\), \(n\)]\)]\) with an \
m-form \!\(TraditionalForm\`\*SubscriptBox[\(TraditionalForm\`\[Omega]\), \
\(\(\*SubscriptBox[\(\[Alpha]\), \(1\)] ... \) \*SubscriptBox[\(\[Alpha]\), \
\(m\)]\)]\) and returns it as a Tensor object. Specifically, if \
1\[LessEqual]n\[LessEqual]m. the result is (1/n!)\!\(\*SuperscriptBox[\(X\), \
\(\(\*SubscriptBox[\(\[Alpha]\), \(1\)] ... \) \*SubscriptBox[\(\[Alpha]\), \
\(n\)]\)]\)\!\(\*SubscriptBox[\(TraditionalForm\`\[Omega]\), \
\(\(\(\*SubscriptBox[\(\[Alpha]\), \(1\)] ... \) \*SubscriptBox[\(\[Alpha]\), \
\(n\)]\\\ \*SubscriptBox[\(\[Alpha]\), \(n + 1\)] ... \) \*SubscriptBox[\(\
\[Alpha]\), \(m\)]\)]\); if 1\[LessEqual]m\[LessEqual]n, the result is (1/m!)\
\!\(\*SuperscriptBox[\(X\), \(\(\(\*SubscriptBox[\(\[Alpha]\), \(1\)] ... \) \
\*SubscriptBox[\(\[Alpha]\), \(m\)]\\\ \*SubscriptBox[\(\[Alpha]\), \(m + \
1\)] ... \) \*SubscriptBox[\(\[Alpha]\), \
\(n\)]\)]\)\!\(\*SubscriptBox[\(TraditionalForm\`\[Omega]\), \
\(\(\*SubscriptBox[\(\[Alpha]\), \(1\)] ... \) \*SubscriptBox[\(\[Alpha]\), \
\(m\)]\)]\). If n=m, the output will be a scalar expression form.\n[Beta \
version](II) InteriorProduct[X_Tensor,\[Omega]_Tensor,Tensor] returns the \
same result of (I). Except when n=m, the output will be a scalar \
Tensor.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.975117148699054*^9, 3.975117155626911*^9}, {
  3.975117252141304*^9, 3.975117436985279*^9}, {3.9751175543563547`*^9, 
  3.975117560364214*^9}, {3.975117664855262*^9, 3.975117810433628*^9}, {
  3.975117907908534*^9, 3.975117927804682*^9}, {3.975117970302201*^9, 
  3.97511797480632*^9}, {3.9751180101536713`*^9, 3.9751180205665474`*^9}, {
  3.9751441857050343`*^9, 3.975144199276826*^9}, {3.975190461561185*^9, 
  3.9751905256668777`*^9}, {3.975208621694089*^9, 3.975208694419282*^9}, {
  3.97520875768083*^9, 3.975208801807084*^9}, {3.9752247661897216`*^9, 
  3.9752247806854153`*^9}, {3.975224830273099*^9, 3.9752248514025497`*^9}, {
  3.975224889000451*^9, 3.9752250589530096`*^9}, {3.97522513837368*^9, 
  3.975225144930739*^9}, {3.97522519618296*^9, 
  3.9752252581724215`*^9}},ExpressionUUID->"e8b3e8dc-3aff-4e77-ac82-\
a4cb6a7fe313"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExteriorD", "::", "usage"}], "=", 
   "\"\<(I) ExteriorD[\!\(TraditionalForm\`\*SubscriptBox[\(\[Mu]\), \
\(-\)]\),T_Tensor] (shortcut \!\(\*SubscriptBox[\(\[DifferentialD]\), \
SubscriptBox[\(\[Mu]\), \(-\)]]\)T) computes the exterior derivative \
\[DifferentialD]T of the n-form T and returns the result as a Tensor object. \
Specifically, (\[DifferentialD]T\!\(\*SubscriptBox[\()\), \(\(\[Mu]\\\ \
\*SubscriptBox[\(\[Nu]\), \(1\)]\\\  ... \)\\\ \*SubscriptBox[\(\[Nu]\), \
\(n\)]\)]\)=(1/n!)\!\(\*SubscriptBox[\(\[PartialD]\), \
\([\[Mu]\)]\)\!\(\*SubscriptBox[\(T\), \(\(\(\*SubscriptBox[\(\[Nu]\), \(1\)]\
\\\  ... \)\\\ \*SubscriptBox[\(\[Nu]\), \(n\)]\)\(]\)\)]\).\n(II) ExteriorD[\
\!\(TraditionalForm\`{\*SubscriptBox[\(\[Mu]\), \(-\)], \
\*SubscriptBox[\(\[Mu]1\), \(-\)], \(\(...\) \*SubscriptBox[\(\[Mu]n\), \
\(-\)]\)}\),T_Tensor] (shortcut \!\(\*SubscriptBox[\(\[DifferentialD]\), \
\(TraditionalForm\`{\*SubscriptBox[\(\[Mu]\), \(-\)], \*SubscriptBox[\(\[Mu]1\
\), \(-\)], \(\(...\) \*SubscriptBox[\(\[Mu]n\), \(-\)]\)}\)]\)T) returns the \
same output as (I), except users may now specify the output Indices through \
\!\(TraditionalForm\`{\*SubscriptBox[\(\[Mu]\), \(-\)], \
\*SubscriptBox[\(\[Mu]1\), \(-\)], \(\(...\) \*SubscriptBox[\(\[Mu]n\), \
\(-\)]\)}\). The Length of the first argument should be n+1 if T is a n-form.\
\n(III) ExteriorD[\!\(TraditionalForm\`\[Mu]\),T_Tensor,m_Tensor] returns the \
same \[DifferentialD]T result as in (I), except the index \[Mu] and the \
Indices of T can now take arbitrary positions \[LongDash] they would be moved \
accordingly using the metric Tensor m.\n(IV) ExteriorD[\!\(TraditionalForm\`{\
\[Mu], \[Mu]1, \(\(...\) \(\[Mu]n\)\)}\),T_Tensor,m_Tensor] returns the same \
\[DifferentialD]T result as in (III) but the user may now specify the output \
Indices through {\[Mu],\[Mu]1,...\[Mu]n}. The Length of the first argument \
should be n+1 if T is a n-form.\n(V) ExteriorD[T_Tensor] (shortcut \
\[DifferentialD]T) returns the same output as in (I), except the extra index \
corresponding to the exterior derivative is automatically generated as a \
Unique one.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9751021771653996`*^9, 3.975102194251278*^9}, {
  3.9751022247270117`*^9, 3.975102392038769*^9}, {3.975102424135253*^9, 
  3.975102513289898*^9}, {3.9751026164210715`*^9, 3.9751027435834665`*^9}, {
  3.9751031128976717`*^9, 3.975103416655284*^9}, {3.9751035086651063`*^9, 
  3.9751036002518454`*^9}, {3.975103744614066*^9, 3.975103744830552*^9}, {
  3.9751037884860373`*^9, 3.9751038277262697`*^9}, {3.975103936779892*^9, 
  3.975103942845744*^9}, {3.9751237511854177`*^9, 3.975124099406462*^9}, {
  3.9751241969626403`*^9, 3.9751242273559823`*^9}, {3.9751243428984523`*^9, 
  3.975124387876093*^9}, {3.975124439306096*^9, 3.9751244460851903`*^9}, {
  3.975124610317463*^9, 3.9751246134936*^9}, {3.9751246441692467`*^9, 
  3.9751247739021683`*^9}, {3.975128016809165*^9, 3.975128017180577*^9}, {
  3.975128053128435*^9, 
  3.975128087905342*^9}},ExpressionUUID->"0d7fceef-7e87-4daa-b1f6-\
075e35f63f9b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PotentialForm", "::", "usage"}], "=", 
   "\"\<(I) PotentialForm[\[Alpha]_Tensor,TensorName\[Rule]\\\"\[Beta]\\\",\
StartingPoint\[Rule]{0,...,0},IntegrationVariable\[Rule]Unique[\[Lambda]1], \
TooltipDisplay\[Rule]Null] assumes the exterior derivative of the n-form \
Tensor \[Alpha] is zero (\[DifferentialD]\[Alpha]=0), returns the n-1 form \
\[Beta] such that \[Alpha] = \[DifferentialD]\[Beta]. Specifically, \
\!\(\*SubscriptBox[\(\[Beta]\), \(\(\*SubscriptBox[\(\[Mu]\), \(2\)] \
\*SubscriptBox[\(\[Mu]\), \(3\)] ... \) \*SubscriptBox[\(\[Mu]\), \
\(n\)]\)]\)[x] = \!\(\*SuperscriptBox[SubscriptBox[\(\[Integral]\), \(0\)], \
\(1\)]\)\!\(\*SuperscriptBox[\(\[Lambda]\), \((n - 1)\)]\) \
(x-\!\(\*SubscriptBox[\(x\), \(0\)]\)\!\(\*SuperscriptBox[\()\), \(l\)]\)\!\(\
\*SubscriptBox[\(\[Alpha]\), \(\(\*SubscriptBox[\(l\[Mu]\), \(2\)] \
\*SubscriptBox[\(\[Mu]\), \(3\)] ... \) \*SubscriptBox[\(\[Mu]\), \
\(n\)]\)]\)[\!\(\*SubscriptBox[\(x\), \
\(0\)]\)+\[Lambda](x-\!\(\*SubscriptBox[\(x\), \(0\)]\))]\[DifferentialD]\
\[Lambda], and if the optional StartingPoint\[Rule]x0 is not provided by the \
user, the default x0={0,...,0} will be used instead. If Integrate cannot be \
carried out explicitly, user can input the integration variable \[Lambda]; \
and if \[Lambda] is not specified, a Unique \[Lambda] will be generated. The \
default value for TensorName\[Rule]nm is nm=\\\"\[Beta]\\\". If n>1, the \
output \[Beta] will be a Tensor Object. If n=1, the output \[Beta] will be a \
regular expression.\n[Beta version] (II) \
PotentialForm[\[Alpha]_Tensor,Tensor,TensorName\[Rule]\\\"\[Beta]\\\",\
StartingPoint\[Rule]sp,IntegrationVariable\[Rule]\[Lambda], TooltipDisplay\
\[Rule]Null]. By inserting Tensor as the second argument, The output will be \
the same as PotentialForm[\[Alpha]_Tensor, TensorName\[Rule]\\\"\[Beta]\\\", \
StartingPoint\[Rule]sp, IntegrationVariable\[Rule]\[Lambda], TooltipDisplay\
\[Rule]Null] for n>1. For n=1, the output will be a scalar Tensor object \
instead.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQ/eNq6KWDc986qqyZDabrSkPvgugetrLXIPro56b3
INpf6egHEF0p9MbqEJC+Mv2xLYiueNzsDKKDDu/2AtE8cSdWgegbR95sANGt
cUn7QPTpG1svgOjY6lOPQPT7ee6sh4G0k/gTThA91ZXJHkSrNM50AdF9iqEB
IPpfsnnaMSB9Li4CQu9cJfcWSM84WygPoq1kZx18B1Iv4H0TRJcor3oCoote
T/8JoueaF/0F0RFndv8D0c9cmZjfg8z92s4GouW3HeAD0X8dfhiD6Okth8xB
dPobTScQbTXtv47nvLeODz5m6YFoAN0GtNc=
  "],ExpressionUUID->"63b9a895-8a41-47b8-825f-0ee81f8cd5f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StartingPoint", "::", "usage"}], "=", 
  "\"\<StartingPoint\[Rule]x0 is an optional argument of PotentialForm, with \
x0 specifying the starting point of integration in the solution of \[Beta], \
whose exterior derivative yields the user input n-form \[Alpha] (namely, \
\[Alpha]=\[DifferentialD]\[Beta]). If StartingPoint is not specified, by \
default it is {0,0,...,0}.\>\""}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.97503356114121*^9, 3.975033714186222*^9}, {
  3.975117343209261*^9, 3.9751174191299267`*^9}, {3.975117549172894*^9, 
  3.9751175848702145`*^9}},ExpressionUUID->"d37cb297-b3fe-479f-a8c2-\
f2b98819466c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"IntegrationVariable", "::", "usage"}], "=", 
   "\"\<IntegrationVariable\[Rule]\[Lambda] is an optional argument of \
PotentialForm. If the Integrate in PotentialForm cannot be carried out \
explicitly, \[Lambda] will be used as the integration variable; if \[Lambda] \
is not specified, Unique[\[Lambda]1] will be used.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.9750335616138773`*^9, {3.9750337230871887`*^9, 3.975033728274992*^9}, {
   3.975033809854239*^9, 3.975033851646891*^9}, {3.9751176071944532`*^9, 
   3.9751176215514708`*^9}, {3.9751182235029745`*^9, 
   3.9751182338049493`*^9}, {3.975118271997193*^9, 3.975118280158376*^9}, {
   3.9751183797070065`*^9, 3.975118437805228*^9}, 3.9753004974103317`*^9, {
   3.9753015010212617`*^9, 
   3.975301504198064*^9}},ExpressionUUID->"52bd8780-f5ff-4262-bb88-\
6f96280bd999"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LeviCivita", "::", "usage"}], "=", 
   "\"\<LeviCivita[\[Nu]1,\[Nu]2,...,\[Nu]d,MetricT_Tensor] returns the \
Tensor associated with the Levi-Civita pseudo-tensor of the metric Tensor \
MetricT (in \!\(\*StyleBox[\"d\",FontSlant->\"Italic\"]\) dimensions), with \
Indices\[Rule]{\[Nu]1,...,\[Nu]d}. (Note that Mathematica has an in-built \
LeviCivitaTensor, but it is really the LeviCivita here implemented for flat \
(Euclidean) space.) If {\[Nu]1,\[Nu]2,...,\[Nu]d} are all lower indices, the \
Levi-Civita pseudo-tensor is \!\(\*SubscriptBox[OverscriptBox[\(\[Epsilon]\), \
\(~\)], \(\(\[Nu]1\\\ \[Nu]2\\\  ... \)\\\ \[Nu]d\)]\) = \
\!\(\*SqrtBox[\(\(|\)\(g\)\(|\)\)]\)\!\(\*SubscriptBox[\(\[Epsilon]\), \(\(\
\[Nu]1\\\ \[Nu]2\\\  ... \)\\\ \[Nu]d\)]\), with \!\(\*SubscriptBox[\(\
\[Epsilon]\), \(\(si\\\ si + 1\\\  ... \)\\\ si + d\)]\) = 1 and si is the \
StartIndex. Note that the Indices {\[Nu]1,\[Nu]2,...,\[Nu]d} can otherwise be \
in arbitrary positions.\nLeviCivita[\[Nu]1,\[Nu]2,...,\[Nu]d,m_Tensor,Minus] \
declares the same output Tensor with \
LeviCivita[\[Nu]1,\[Nu]2,...,\[Nu]d,MetricT_Tensor] but up to a minus sign, \
by defining \!\(\*SubscriptBox[\(\[Epsilon]\), \(\(si\\\ si + 1\\\  ... \)\\\ \
si + d\)]\) = -1, where si is the StartIndex.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.975012243344818*^9, 3.9750122507123146`*^9}, {
   3.97501230831955*^9, 3.9750123517127743`*^9}, {3.975012472562438*^9, 
   3.9750125555399027`*^9}, {3.9750126979592676`*^9, 3.975012722920381*^9}, {
   3.975012764039734*^9, 3.9750129185000377`*^9}, {3.975108531172825*^9, 
   3.9751086271434464`*^9}, {3.975109351702873*^9, 3.97510936587726*^9}, {
   3.9751094186496983`*^9, 3.975109420457915*^9}, {3.975110193224802*^9, 
   3.9751102846797714`*^9}, {3.975110583474881*^9, 3.975110595864211*^9}, {
   3.9751106777623477`*^9, 3.9751107091190042`*^9}, {3.975110764088479*^9, 
   3.975110831634035*^9}, 3.975111985268386*^9, {3.9751120183655157`*^9, 
   3.975112062485237*^9}},ExpressionUUID->"224ed80f-ee46-439f-ad03-\
1a87568d4127"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CovariantHodgeDual", "::", "usage"}], "=", 
   "\"\<(I) CovariantHodgeDual[\[Mu]I___,\[Tau]_Tensor,m_Tensor] returns the \
generally covariant Hodge dual of the Tensor \[Tau] using the Metric Tensor \
m. Note that Mathematica has an in-built HodgeDual, but it is really the \
Hodge dual (aka Hodge star operator) in flat (Euclidean) space. Now, the \
covariant Hodge dual (aka Hodge star operation), in \!\(TraditionalForm\`d\) \
space(time) dimensions, of an n-form \
\!\(TraditionalForm\`\*SubscriptBox[\(A\), \(\(\*SubscriptBox[\(\[Mu]\), \
\(1\)] ... \) \*SubscriptBox[\(\[Mu]\), \(n\)]\)]\) (where 0 \[LessEqual] \
\!\(TraditionalForm\`n\\\  \[LessEqual] \\\ d\)), is defined as (\
\[FivePointedStar]\!\(TraditionalForm\`\*SubscriptBox[\(\(A\)\()\)\), \
\(\(\*SubscriptBox[\(\[Mu]\), \(1\)] ... \) \*SubscriptBox[\(\[Mu]\), \(d - n\
\)]\)]\)\[Congruent]\!\(TraditionalForm\`\((1/\(n!\))\)\)\!\(TraditionalForm\`\
\*SubscriptBox[OverscriptBox[\(\[Epsilon]\), \(~\)], \(\(\(\*SubscriptBox[\(\
\[Mu]\), \(1\)] ... \) \*SubscriptBox[\(\[Mu]\), \(d - n\)] \*SubscriptBox[\(\
\[Nu]\), \(1\)] ... \) \*SubscriptBox[\(\[Nu]\), \
\(n\)]\)]\)\!\(TraditionalForm\`\*SuperscriptBox[\(A\), \(\(\*SubscriptBox[\(\
\[Nu]\), \(1\)] ... \) \*SubscriptBox[\(\[Nu]\), \(n\)]\)]\)., where the \!\(\
\*OverscriptBox[\(\[Epsilon]\), \(~\)]\) is the Levi-Civita pseudo-tensor \
with respect to the metric m. Note that the Length of \[Mu]I must be equal to \
d-n.\n(II) CovariantHodgeDual[\[Mu]I___,f_,m_Tensor] takes in a regular \
expression f and returns the Tensor object corresponding to \
\!\(TraditionalForm\`\*SubscriptBox[OverscriptBox[\(\[Epsilon]\), \(~\)], \
\(\(\*SubscriptBox[\(\[Mu]\), \(1\)] ... \) \*SubscriptBox[\(\[Mu]\), \
\(d\)]\)]\)\!\(TraditionalForm\`f\). Note that the Length of \[Mu]I must be \
equal to d.\n[Beta version] (III) CovariantHodgeDual[\[Tau]_Tensor,m_Tensor, \
Tensor] extraly enters Tensor as the fourth argument, as a toggle to make the \
output a scalar Tensor.\n(IV) CovariantHodgeDual[\[Tau]_Tensor,m_Tensor] \
takes in a rank-n Tensor \[Tau] in d dimension. It automatically generates a \
Sequence of Unique Indices \[Mu]I___ with Length d-n and trigger \
CovariantHodgeDual[\[Mu]I,\[Tau],m]. Only if \[Tau] is an n-form, with all \
Indices downstairs, then the output will be an (d-n)-vector, with all Indices \
upstairs. Otherwise, if input is a n-vector or a rank-n Tensor with mixed \
Indices position. The output will be a (d-n)-form Tensor, with all Indices \
downstairs.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.974952659754884*^9, {3.9749529921641774`*^9, 3.9749530090498557`*^9}, {
   3.9749534577070055`*^9, 3.9749535134767685`*^9}, {3.974953555998661*^9, 
   3.9749535766315575`*^9}, {3.9749537885858793`*^9, 3.974953995504489*^9}, {
   3.974954092703817*^9, 3.974954094742832*^9}, {3.9749542055295677`*^9, 
   3.974954281026953*^9}, {3.9749549861052155`*^9, 3.9749549914245787`*^9}, {
   3.9749550277065663`*^9, 3.974955282622796*^9}, 3.974955365160939*^9, {
   3.974955397840806*^9, 3.9749554479294853`*^9}, 3.9750507934470673`*^9, {
   3.9750560499928427`*^9, 3.975056076702368*^9}, {3.975111849984289*^9, 
   3.9751118845608764`*^9}, {3.975112204416627*^9, 3.975112205823823*^9}, 
   3.9751124634465585`*^9, {3.9751125467602377`*^9, 3.9751125929551287`*^9}, {
   3.975112708852503*^9, 
   3.9751127102677383`*^9}},ExpressionUUID->"455cfd03-014a-47bc-9408-\
ae8711ad6cd7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FullyAntiSymmetricTensorQ", "::", "usage"}], "=", 
   "\"\<FullyAntiSymmetricTensorQ[t_Tensor] takes in an N-form or N-vector \
Tensor t and verifies if it is fully anti-symmetric. If the TensorComponents \
of t is fully anti-symmetric and if N is greater than 1, \
FullyAntiSymmetricTensorQ returns True; otherwise, it returns False. Note: \
this means scalars, 1-forms and (rank-1) vectors will return False.\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9749526560521774`*^9, 3.974952900744113*^9}, 
   3.9750560371743183`*^9},ExpressionUUID->"4031b515-9073-4a56-bd96-\
deed34e9b659"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LieD", "::", "usage"}], "=", 
    "\"\<(I) LieD[\[Xi]_Tensor,t_Tensor,Indices\[Rule]Null,\
LieDerivativeOperator\[Rule]Simplify,TooltipStyle\[Rule]{},TooltipDisplay\
\[Rule]Null] returns the Lie derivative of the Tensor m with respect to the \
rank-1 Tensor (vector) \!\(\*SuperscriptBox[\(\[Xi]\), \(\[Mu]\)]\). If t is \
with TensorType \\\"Metric\\\", then its Lie derivative is \
\!\(\*SubscriptBox[\(\[Sterling]\), \(\[Xi]\)]\)\!\(\*SubscriptBox[\(g\), \(\
\[Mu]\[Nu]\)]\) = \!\(\*SuperscriptBox[\(\[Xi]\), \
\(\[Sigma]\)]\)\!\(\*SubscriptBox[\(\[PartialD]\), \
\(\[Sigma]\)]\)\!\(\*SubscriptBox[\(g\), \
\(\[Mu]\[Nu]\)]\)+\!\(\*SubscriptBox[\(\[PartialD]\), \
\(\[Mu]\)]\)\!\(\*SuperscriptBox[\(\[Xi]\), \
\(\[Sigma]\)]\)\!\(\*SubscriptBox[\(g\), \
\(\[Nu]\[Sigma]\)]\)+\!\(\*SubscriptBox[\(\[PartialD]\), \
\(\[Nu]\)]\)\!\(\*SuperscriptBox[\(\[Xi]\), \
\(\[Sigma]\)]\)\!\(\*SubscriptBox[\(g\), \(\[Mu]\[Sigma]\)]\). If t is a \
general tensor \!\(\*SubscriptBox[SuperscriptBox[\(T\), \(\(\*SubscriptBox[\(\
\[Mu]\), \(1\)] ... \) \*SubscriptBox[\(\[Mu]\), \(N\)]\)], \
\(\(\*SubscriptBox[\(\[Nu]\), \(1\)] ... \) \*SubscriptBox[\(\[Nu]\), \
\(M\)]\)]\), then its Lie derivative is \!\(\*SubscriptBox[\(\[Sterling]\), \
\(\[Xi]\)]\)\!\(\*SubscriptBox[SuperscriptBox[\(T\), \(\(\*SubscriptBox[\(\
\[Mu]\), \(1\)] ... \) \*SubscriptBox[\(\[Mu]\), \(N\)]\)], \
\(\(\*SubscriptBox[\(\[Nu]\), \(1\)] ... \) \*SubscriptBox[\(\[Nu]\), \
\(M\)]\)]\)=\!\(\*SuperscriptBox[\(\[Xi]\), \
\(\[Sigma]\)]\)\!\(\*SubscriptBox[\(\[PartialD]\), \
\(\[Sigma]\)]\)\!\(\*SubscriptBox[SuperscriptBox[\(T\), \(\(\*SubscriptBox[\(\
\[Mu]\), \(1\)] ... \) \*SubscriptBox[\(\[Mu]\), \(N\)]\)], \
\(\(\*SubscriptBox[\(\[Nu]\), \(1\)] ... \) \*SubscriptBox[\(\[Nu]\), \
\(M\)]\)]\)-\!\(\*SubscriptBox[SuperscriptBox[\(T\), \(\(\[Sigma]\\\ \
\*SubscriptBox[\(\[Mu]\), \(2\)] ... \) \*SubscriptBox[\(\[Mu]\), \(N\)]\)], \
\(\(\*SubscriptBox[\(\[Nu]\), \(1\)] ... \) \*SubscriptBox[\(\[Nu]\), \
\(M\)]\)]\)\!\(\*SubscriptBox[\(\[PartialD]\), \
\(\[Sigma]\)]\)\!\(\*SuperscriptBox[\(\[Xi]\), SubscriptBox[\(\[Mu]\), \
\(1\)]]\)-...-\!\(\*SubscriptBox[SuperscriptBox[\(T\), \(\(\\\ \
\)\(\(\*SubscriptBox[\(\[Mu]\), \(1\)] \*SubscriptBox[\(\[Mu]\), \(2\)] ... \
\) \[Sigma]\)\)], \(\(\*SubscriptBox[\(\[Nu]\), \(1\)] ... \) \*SubscriptBox[\
\(\[Nu]\), \(M\)]\)]\)\!\(\*SubscriptBox[\(\[PartialD]\), \(\[Sigma]\)]\)\!\(\
\*SuperscriptBox[\(\[Xi]\), SubscriptBox[\(\[Mu]\), \
\(N\)]]\)+\!\(\*SubscriptBox[SuperscriptBox[\(T\), \(\(\*SubscriptBox[\(\[Mu]\
\), \(1\)] ... \) \*SubscriptBox[\(\[Mu]\), \(N\)]\)], \(\(\[Sigma]\\\ \
\*SubscriptBox[\(\[Nu]\), \(2\)] ... \) \*SubscriptBox[\(\[Nu]\), \(M\)]\)]\)\
\!\(\*SubscriptBox[\(\[PartialD]\), SubscriptBox[\(\[Nu]\), \
\(1\)]]\)\!\(\*SuperscriptBox[\(\[Xi]\), \
\(\[Sigma]\)]\)+...+\!\(\*SubscriptBox[SuperscriptBox[\(T\), \
\(\(\*SubscriptBox[\(\[Mu]\), \(1\)] ... \) \*SubscriptBox[\(\[Mu]\), \
\(N\)]\)], \(\(\*SubscriptBox[\(\[Nu]\), \(1\)] ... \) \
\[Sigma]\)]\)\!\(\*SubscriptBox[\(\[PartialD]\), SubscriptBox[\(\[Nu]\), \
\(N\)]]\)\!\(\*SuperscriptBox[\(\[Xi]\), \(\[Sigma]\)]\); The \
LieDerivativeOperator\[Rule]op is an optional rule, with the default op = \
Simplify. If left un-specified, the optional Indices, TooltipStyle, and \
TooltipDisplay would be inherited from t.\n(II) LieD[\[Xi]_Tensor,f] returns \
the Lie derivative of the regular expression f with respect to \[Xi]; namely, \
\!\(\*SuperscriptBox[\(\[Xi]\), \(\[Sigma]\)]\)\!\(\*SubscriptBox[\(\
\[PartialD]\), \(\[Sigma]\)]\)f (as a regular expression, not a Tensor \
object).\n(III) \!\(\*SubscriptBox[\(\[Sterling]\), \(\[Xi]\)]\)t \
(\[Sterling]=\\\\[Sterling]) is a shortcut to trigger any LieD pattern; for \
example, \!\(\*SubscriptBox[\(\[Sterling]\), \(\[Xi]\)]\)f will return \
\!\(\*SuperscriptBox[\(\[Xi]\), \(\[Sigma]\)]\)\!\(\*SubscriptBox[\(\
\[PartialD]\), \(\[Sigma]\)]\)f in (II).\>\""}], ";"}], " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.974950958234913*^9, 3.9749509791303606`*^9}, {
  3.9749510717247753`*^9, 3.9749510990692377`*^9}, {3.9749511350297904`*^9, 
  3.9749511407180862`*^9}, {3.974951194439829*^9, 3.9749512216316953`*^9}, {
  3.9749513279059753`*^9, 3.974951452156417*^9}, {3.9749515625823994`*^9, 
  3.9749516855685406`*^9}, {3.9749517336835175`*^9, 3.9749517641944532`*^9}, {
  3.9749520215374117`*^9, 3.9749520336871004`*^9}, {3.9749521233650455`*^9, 
  3.974952127138362*^9}, {3.97495216250636*^9, 3.974952226843362*^9}, {
  3.974952257596593*^9, 3.9749522981092787`*^9}, {3.9749523385339236`*^9, 
  3.974952557146617*^9}, {3.974953033611043*^9, 3.9749530344349747`*^9}, {
  3.97505600579064*^9, 3.975056016452942*^9}, {3.9751125318710766`*^9, 
  3.9751125362405276`*^9}, {3.9751130435551834`*^9, 3.975113044403186*^9}, {
  3.975182252625555*^9, 
  3.9751822723399687`*^9}},ExpressionUUID->"448e6bc9-fb5e-4fd1-a813-\
f14f1058c3da"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LieBracket", "::", "usage"}], "=", 
   "\"\<LieBracket[\[Xi]1_Tensor,\[Xi]2_Tensor,LieDerivativeOperator\[Rule]\
Simplify,LieBracketOperator\[Rule]Simplify,TooltipStyle\[Rule]{},\
TooltipDisplay\[Rule]Null,Indices\[Rule]idx_List] computes the Lie bracket [\
\[Xi]1, \[Xi]2\!\(\*SuperscriptBox[\(]\), \
\(\[Alpha]\)]\)=(\!\(\*SubscriptBox[\(\[Sterling]\), \
\(\[Xi]1\)]\)\[Xi]2\!\(\*SuperscriptBox[\()\), \(\[Alpha]\)]\) of the vectors \
\[Xi]1 and \[Xi]2 and return the result as a Tensor object. The optional \
LieDerivativeOperator\[Rule]op1 and LieBracketOperator\[Rule]op2, with \
default values op1 = op2 = Simplify, means either op1 or op2 are applied to \
the Lie bracket components. If both are specified, LieBracketOperator has \
higher priority.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.975034112424286*^9, 3.975034119381132*^9}, 
   3.975034812909379*^9, {3.975034924128237*^9, 3.975035166909753*^9}, {
   3.9751109394816875`*^9, 3.9751109547687435`*^9}, {3.975111959503312*^9, 
   3.975111960053858*^9}, {3.9751120750458593`*^9, 3.975112152436721*^9}, {
   3.9751122189639697`*^9, 
   3.9751122806840496`*^9}},ExpressionUUID->"67921f9a-7f06-48b7-9eac-\
077f438a26a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LieBracketOperator", "::", "usage"}], "=", 
   "\"\<LieBracketOperator is an OptionValue of LieBracket. It serves as an \
Operator during the LieBracket calculation. Its default value is \
Simplify.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.97503526241848*^9, 
  3.975035290810628*^9}},ExpressionUUID->"9a1393bd-be22-4d14-a0f1-\
08fbefe3d9b5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"JacobianComponents", "::", "usage"}], "=", 
   "\"\<(I) JacobianComponents[{x1\[Rule]f1[x1,x2,x3,...,xd], \
x2\[Rule]f2[x1,x2,x3,...,xd], x3\[Rule]f3[x1,x2,x3,...,xd], \
...,xd\[Rule]fd[x1,x2,x3,...,xd]}] returns the d\[Cross]d Jacobian matrix \
\[PartialD]fi/\[PartialD]xj as a List of List's, where i is the row and j is \
the column number.\n(II) \
JacobianComponents[{x1\[Rule]f1[\[Xi]1,\[Xi]2,\[Xi]3,...,\[Xi]D], \
x2\[Rule]f2[\[Xi]1,\[Xi]2,\[Xi]3,...,\[Xi]D], \
x3\[Rule]f3[\[Xi]1,\[Xi]2,\[Xi]3,...,\[Xi]D], ...,xd\[Rule]fd[\[Xi]1,\[Xi]2,\
\[Xi]3,...,\[Xi]D]}, {\[Xi]1,\[Xi]2,\[Xi]3, ...,\[Xi]D}] returns the \
d\[Cross]D Jacobian matrix \[PartialD]fi/\[PartialD]\[Xi]j as a List of \
List's, where 1\[LessEqual]i\[LessEqual]d is the row number and \
1\[LessEqual]j\[LessEqual]D\[LessEqual]d is the column number. The main \
difference between (I) and (II) is that (II) allows for new coordinates on \
the right hand side of the transformation rules.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.974880282004303*^9, 3.9748803397327957`*^9}, {
   3.9748804150073977`*^9, 3.974880442567998*^9}, {3.974880473768836*^9, 
   3.974880500961488*^9}, {3.9748810640966134`*^9, 3.9748812077238436`*^9}, {
   3.974881237924861*^9, 3.9748813377674227`*^9}, {3.9748813777988763`*^9, 
   3.974881492027593*^9}, {3.9748818950947227`*^9, 3.9748819573120136`*^9}, {
   3.9749321072176447`*^9, 3.9749321776022406`*^9}, 3.975053562215888*^9, 
   3.975055968349498*^9},ExpressionUUID->"b57c0340-aff2-4768-8d21-\
0d5228b7dcf3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CoordinateTransformation", "::", "usage"}], "=", 
   "\"\<(I.1) CoordinateTransformation[{x1\[Rule]f1[x1,x2,x3,...,xd], x2\
\[Rule]f2[x1,x2,x3,...,xd],x3\[Rule]f3[x1,x2,x3,...,xd], \
...,xd\[Rule]fd[x1,x2,x3,...,xd]}] returns a List of the input coordinate \
transformations together with the transformation Rule's of both the 1-forms \
(i.e., infinitesimal displacements) and partial derivatives: \
Union[{x1\[Rule]f1[x1,x2,x3,...,xd],x2\[Rule]f2[x1,x2,x3,...,xd],x3\[Rule]f3[\
x1,x2,x3,...,xd],...,xd\[Rule]fd[x1,x2,x3,...,xd]},{\[DifferentialD]x1\[Rule](\
\[PartialD]f1/\[PartialD]x1)\[DifferentialD]x1+(\[PartialD]f1/\[PartialD]x2)\
\[DifferentialD]x2+ ...+(\[PartialD]f1/\[PartialD]xd)\[DifferentialD]xd,\
\[DifferentialD]x2\[Rule](\[PartialD]f2/\[PartialD]x1)\[DifferentialD]x1+(\
\[PartialD]f2/\[PartialD]x2)\[DifferentialD]x2+...+(\[PartialD]f2/\[PartialD]\
xd)\[DifferentialD]xd,...,\[DifferentialD]xd\[Rule](\[PartialD]fd/\[PartialD]\
x1)\[DifferentialD]x1+(\[PartialD]fd/\[PartialD]x2)\[DifferentialD]x2+...+(\
\[PartialD]fd/\[PartialD]xd)\[DifferentialD]xd},{Del[x1]\[Rule](\[PartialD]x1/\
\[PartialD]f1)Del[x1]+(\[PartialD]x2/\[PartialD]f1)Del[x2]+...+(\[PartialD]xd/\
\[PartialD]f1)Del[xd],Del[x2]\[Rule](\[PartialD]x1/\[PartialD]f2)Del[x1]+(\
\[PartialD]x2/\[PartialD]f2)Del[x2]+ \
...+(\[PartialD]xd/\[PartialD]f2)Del[xd], ...,Del[xd]\[Rule](\[PartialD]x1/\
\[PartialD]fd)Del[x1]+(\[PartialD]x2/\[PartialD]fd)Del[x2]+ \
...+(\[PartialD]xd/\[PartialD]fd)Del[xd]}].\n(I.2) \
CoordinateTransformation[{x1\[Rule]f1[\[Xi]1,\[Xi]2,\[Xi]3,...,\[Xi]D],x2\
\[Rule]f2[\[Xi]1,\[Xi]2,\[Xi]3,...,\[Xi]D],x3\[Rule]f3[\[Xi]1,\[Xi]2,\[Xi]3,..\
.,\[Xi]D], ...,xd\[Rule]fd[\[Xi]1,\[Xi]2,\[Xi]3,...,\[Xi]D]},{\[Xi]1,\[Xi]2,\
\[Xi]3,...,\[Xi]D}] returns a List of the input coordinate transformations \
together with the transformation Rule's of both the 1-forms (i.e., \
infinitesimal displacements) and \[LongDash] if and only if d=D (i.e., same \
number of input and output coordinates) \[LongDash] partial derivatives. That \
is, for D<d, the output is \
Union[{x1\[Rule]f1[\[Xi]1,\[Xi]2,\[Xi]3,...,\[Xi]D],x2\[Rule]f2[\[Xi]1,\[Xi]2,\
\[Xi]3,...,\[Xi]D],x3\[Rule]f3[\[Xi]1,\[Xi]2,\[Xi]3,...,\[Xi]D],...,xd\[Rule]\
fd[\[Xi]1,\[Xi]2,\[Xi]3,...,\[Xi]D]},{\[DifferentialD]x1\[Rule](\[PartialD]f1/\
\[PartialD]\[Xi]1)\[DifferentialD]\[Xi]1+(\[PartialD]f1/\[PartialD]\[Xi]2)\
\[DifferentialD]\[Xi]2+...+(\[PartialD]f1/\[PartialD]\[Xi]D)\[DifferentialD]\
\[Xi]D,\[DifferentialD]x2\[Rule](\[PartialD]f2/\[PartialD]\[Xi]1)\
\[DifferentialD]\[Xi]1+(\[PartialD]f2/\[PartialD]\[Xi]2)\[DifferentialD]\[Xi]\
2+...+(\[PartialD]f2/\[PartialD]\[Xi]D)\[DifferentialD]\[Xi]D, ...,\
\[DifferentialD]xd\[Rule](\[PartialD]fd/\[PartialD]\[Xi]1)\[DifferentialD]\
\[Xi]1+(\[PartialD]fd/\[PartialD]\[Xi]2)\[DifferentialD]\[Xi]2+...+(\
\[PartialD]fd/\[PartialD]\[Xi]D)\[DifferentialD]\[Xi]}]; while for D=d, the \
output is Union[{x1\[Rule]f1[\[Xi]1,\[Xi]2,\[Xi]3,...,\[Xi]D],x2\[Rule]f2[\
\[Xi]1,\[Xi]2,\[Xi]3,...,\[Xi]D],x3\[Rule]f3[\[Xi]1,\[Xi]2,\[Xi]3,...,\[Xi]D],\
...,xd\[Rule]fd[\[Xi]1,\[Xi]2,\[Xi]3,...,\[Xi]D]},{\[DifferentialD]x1\[Rule](\
\[PartialD]f1/\[PartialD]\[Xi]1)\[DifferentialD]\[Xi]1+(\[PartialD]f1/\
\[PartialD]\[Xi]2)\[DifferentialD]\[Xi]2+...+(\[PartialD]f1/\[PartialD]\[Xi]D)\
\[DifferentialD]\[Xi]D,\[DifferentialD]x2\[Rule](\[PartialD]f2/\[PartialD]\
\[Xi]1)\[DifferentialD]\[Xi]1+(\[PartialD]f2/\[PartialD]\[Xi]2)\
\[DifferentialD]\[Xi]2+...+(\[PartialD]f2/\[PartialD]\[Xi]D)\[DifferentialD]\
\[Xi]D, ...,\[DifferentialD]xd\[Rule](\[PartialD]fd/\[PartialD]\[Xi]1)\
\[DifferentialD]\[Xi]1+(\[PartialD]fd/\[PartialD]\[Xi]2)\[DifferentialD]\[Xi]\
2+...+(\[PartialD]fd/\[PartialD]\[Xi]D)\[DifferentialD]\[Xi]D},{Del[x1]\[Rule]\
(\[PartialD]\[Xi]1/\[PartialD]f1)Del[\[Xi]1]+(\[PartialD]\[Xi]2/\[PartialD]f1)\
Del[\[Xi]2]+ ...+(\[PartialD]\[Xi]D/\[PartialD]f1)Del[\[Xi]D], \
Del[x2]\[Rule](\[PartialD]\[Xi]1/\[PartialD]f2)Del[\[Xi]1]+(\[PartialD]\[Xi]2/\
\[PartialD]f2)Del[\[Xi]2]+ \
...+(\[PartialD]\[Xi]D/\[PartialD]f2)Del[\[Xi]D],..., Del[xd]\[Rule](\
\[PartialD]\[Xi]1/\[PartialD]fd)Del[\[Xi]1]+(\[PartialD]\[Xi]2/\[PartialD]fd)\
Del[\[Xi]2]+ ...+(\[PartialD]\[Xi]D/\[PartialD]fd)Del[\[Xi]D]}]. The main \
difference between (I.1) and (I.2) is that (I.2) allows for new coordinates \
on the right hand side of the transformation rules.\n(II) \
CoordinateTransformation[mt_Tensor, \
{x1\[Rule]f1[x1,x2,x3,...,xd],x2\[Rule]f2[x1,x2,x3,...,xd], \
x3\[Rule]f3[x1,x2,x3,...,xd],...,xd\[Rule]fd[x1,x2,x3,...,xd]},Indices\[Rule]{\
},TensorName\[Rule]tn,StartIndex\[Rule]si,TooltipStyle\[Rule]{},\
TooltipDisplay\[Rule]Null,CoordinateTransformationOperator\[Rule]op,\
MetricOperator\[Rule]Simplify,ChristoffelOperator\[Rule]Simplify,\
RiemannOperator\[Rule]Simplify,RicciOperator\[Rule]Simplify, \
RicciScalarOperator\[Rule]Simplify] or CoordinateTransformation[mt_Tensor, \
{x1\[Rule]f1[\[Xi]1,\[Xi]2,\[Xi]3,...,\[Xi]D], \
x2\[Rule]f2[\[Xi]1,\[Xi]2,\[Xi]3,...,\[Xi]D], \
x3\[Rule]f3[\[Xi]1,\[Xi]2,\[Xi]3,...,\[Xi]D], ...,xd\[Rule]fd[\[Xi]1,\[Xi]2,\
\[Xi]3,...,\[Xi]D]}, {\[Xi]1,\[Xi]2,\[Xi]3, ...,\[Xi]D}, Indices\[Rule]{}, \
TensorName\[Rule]tn, StartIndex\[Rule]si, TooltipStyle\[Rule]{}, \
TooltipDisplay\[Rule]Null, CoordinateTransformationOperator\[Rule]op, \
MetricOperator\[Rule]Simplify, ChristoffelOperator\[Rule]Simplify, \
RiemannOperator\[Rule]Simplify,RicciOperator\[Rule]Simplify, \
RicciScalarOperator\[Rule]Simplify], where mt is a Tensor of TensorType \
\\\"Metric\\\", returns mt coordinate-transformed according to the specified \
rules. Note that the index names and placement (i.e., down-down or up-up) are \
preserved, if the optional Indices are not specified. If the optional Indices \
are specified, they would be moved accordingly. The geometry-related \
MetricOperator, ChristoffelOperator, etc. have the same meaning as in Metric. \
The optional CoordinateTransformationOperator\[Rule]CTop, with default CTop = \
Simplify, means CTop will be applied to the objects occuring within mt \
whenever these geometrical objects related operators are set as Simplify. If \
a particular operator and CoordinateTransformationOperator are both not \
Simplify, the former will be applied. The optional StartIndex\[Rule]si has a \
default given by that in mt. Note that the ordering of the new coordinates \
implied by {\[Xi]1,\[Xi]2,\[Xi]3,...,\[Xi]D} is significant.\n(III) \
CoordinateTransformation[t_Tensor,{x1\[Rule]f1[x1,x2,x3,...,xd],x2\[Rule]f2[\
x1,x2,x3,...,xd],x3\[Rule]f3[x1,x2,x3,...,xd],...,xd\[Rule]fd[x1,x2,x3,...,xd]\
},Indices\[Rule]{},TensorName\[Rule]tn,StartIndex\[Rule]si,TooltipStyle\[Rule]\
{},TooltipDisplay\[Rule]Null,CoordinateTransformationOperator\[Rule]op] or \
CoordinateTransformation[t_Tensor,{x1\[Rule]f1[\[Xi]1,\[Xi]2,\[Xi]3,...,\[Xi]\
d],x2\[Rule]f2[\[Xi]1,\[Xi]2,\[Xi]3,...,\[Xi]d],x3\[Rule]f3[\[Xi]1,\[Xi]2,\
\[Xi]3,...,\[Xi]d],...,xd\[Rule]fd[\[Xi]1,\[Xi]2,\[Xi]3,...,\[Xi]d]},{\[Xi]1,\
\[Xi]2,\[Xi]3, ...,\[Xi]d},Indices\[Rule]{},TensorName\[Rule]tn,StartIndex\
\[Rule]si,TooltipStyle\[Rule]{},TooltipDisplay\[Rule]Null,\
CoordinateTransformationOperator\[Rule]op], where t is a Tensor object that \
is neither Metric nor Christoffel, returns t coordinate-transformed according \
to the specified rules. Note that the index names and placements are \
preserved, if the optional Indices are not specified. If the optional Indices \
are specified, they would then be moved accordingly. The default value of the \
optional StartIndex\[Rule]si is given by that in t. The \
CoordinateTransformationOperator\[Rule]CTop is optional, with the default \
CTop = Simplify. The ordering of the new coordinates implied by \
{\[Xi]1,\[Xi]2,\[Xi]3,...,\[Xi]d} is significant; and the new coordinate \
system must have the same dimension as the old one. OverHat Indices, i.e., \
indices in the orthonormal basis, will not be transformed. \n(IV) \
CoordinateTransformation[t_Tensor,{x1\[Rule]f1[\[Xi]1,\[Xi]2,\[Xi]3,...,\[Xi]\
D],x2\[Rule]f2[\[Xi]1,\[Xi]2,\[Xi]3,...,\[Xi]D],x3\[Rule]f3[\[Xi]1,\[Xi]2,\
\[Xi]3,...,\[Xi]D],...,xd\[Rule]fd[\[Xi]1,\[Xi]2,\[Xi]3,...,\[Xi]D]},{\[Xi]1,\
\[Xi]2,\[Xi]3,...,\[Xi]D},mt_Tensor,Indices\[Rule]{},TensorName\[Rule]tn, \
StartIndex\[Rule]si,TooltipStyle\[Rule]{},TooltipDisplay\[Rule]Null,\
CoordinateTransformationOperator\[Rule]op], where D<d, t is a Tensor object \
that is neither a Metric nor a Christoffel, returns the 'induced' Tensor t \
coordinate-transformed according to the specified rules. In contrast to the \
above same-dimension transformations, here a d-dimensional 'ambient space' \
metric Tensor mt is required. Note that the index names and placements are \
preserved, if the optional Indices is not specified. If the optional Indices \
are specified, the indices would be moved accordingly. StartIndex\[Rule]si is \
optional, with default given by that in t. The \
CoordinateTransformationOperator\[Rule]CTop is optional, with the default \
CTop = Simplify. The ordering of the new coordinates implied by \
{\[Xi]1,\[Xi]2,\[Xi]3, ...,\[Xi]d} is significant. OverHat Indices, i.e., \
indices in the orthonormal basis, will not be transformed.\n(V) \
CoordinateTransformation[t_Tensor,{x1\[Rule]f1[\[Xi]1,\[Xi]2,\[Xi]3,...,\[Xi]\
D],x2\[Rule]f2[\[Xi]1,\[Xi]2,\[Xi]3,...,\[Xi]D],x3\[Rule]f3[\[Xi]1,\[Xi]2,\
\[Xi]3,...,\[Xi]D],...,xd\[Rule]fd[\[Xi]1,\[Xi]2,\[Xi]3,...,\[Xi]D]},{\[Xi]1,\
\[Xi]2,\[Xi]3,...,\[Xi]D},Indices\[Rule]{},TensorName\[Rule]tn, StartIndex\
\[Rule]si,TooltipStyle\[Rule]{},TooltipDisplay\[Rule]Null,\
CoordinateTransformationOperator\[Rule]op], where D<d, but t has only \
downstairs Indices, returns t coordinate-transformed according to the \
specified rules \[LongDash] i.e., the 'ambient space' the mt in (IV) is not \
required. The optional Indices\[Rule]idx cannot contain any upper indices.\n\
(VI) CoordinateTransformation[chr_Tensor,{x1\[Rule]f1[x1,x2,x3,...,xd],x2\
\[Rule]f2[x1,x2,x3,...,xd],x3\[Rule]f3[x1,x2,x3,...,xd],...,xd\[Rule]fd[x1,x2,\
x3,...,xd]},Indices\[Rule]{},TensorName\[Rule]tn,StartIndex\[Rule]si,\
TooltipStyle\[Rule]{},TooltipDisplay\[Rule]Null,\
CoordinateTransformationOperator\[Rule]op] or \
CoordinateTransformation[t_Tensor,{x1\[Rule]f1[\[Xi]1,\[Xi]2,\[Xi]3,...,\[Xi]\
d],x2\[Rule]f2[\[Xi]1,\[Xi]2,\[Xi]3,...,\[Xi]d],x3\[Rule]f3[\[Xi]1,\[Xi]2,\
\[Xi]3,...,\[Xi]d],...,xd\[Rule]fd[\[Xi]1,\[Xi]2,\[Xi]3,...,\[Xi]d]},{\[Xi]1,\
\[Xi]2,\[Xi]3, ...,\[Xi]d},Indices\[Rule]{},TensorName\[Rule]tn,StartIndex\
\[Rule]si, \
TooltipStyle\[Rule]{},TooltipDisplay\[Rule]Null,\
CoordinateTransformationOperator\[Rule]op], where chr is a Tensor with \
TensorType\[Rule]Chistoffel, returns the same chr except \
coordinate-transformed according to the specified rules. Note that the index \
names and placements are preserved. Even if the optional Indices are \
specified, note that changing their positions is not allowed. The \
CoordinateTransformationOperator\[Rule]CTop is optional, with the default \
CTop = Simplify. The optional StartIndex\[Rule]si has default given by that \
in chr. The ordering of the new coordinates implied by {\[Xi]1,\[Xi]2,\[Xi]3, \
...,\[Xi]d} is significant; and the old versus new coordinate systems must \
have same dimension.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.974880196449377*^9, 3.9748802003857327`*^9}, {
   3.9748815186283054`*^9, 3.9748815742933445`*^9}, {3.974881625871663*^9, 
   3.9748817037612*^9}, {3.974881962616108*^9, 3.9748819631992264`*^9}, {
   3.974932769919468*^9, 3.9749327753760924`*^9}, {3.9749439059062195`*^9, 
   3.974943908273101*^9}, {3.974943947772689*^9, 3.9749439639001985`*^9}, {
   3.974943998307079*^9, 3.974944048764693*^9}, {3.974944499356695*^9, 
   3.974944610383915*^9}, {3.9749447246312976`*^9, 3.9749447815871162`*^9}, {
   3.9749448497963285`*^9, 3.9749449173894*^9}, {3.9749449879908895`*^9, 
   3.9749450439191656`*^9}, {3.9749450860501127`*^9, 3.974945271628579*^9}, {
   3.974945304597679*^9, 3.974945357622567*^9}, {3.974945392514576*^9, 
   3.9749457112855563`*^9}, {3.9749457983200455`*^9, 
   3.9749458024963484`*^9}, {3.974945872064788*^9, 3.9749461478150787`*^9}, {
   3.974948831154673*^9, 3.974948852380014*^9}, {3.97494889281222*^9, 
   3.974948909820115*^9}, {3.9749489403971143`*^9, 3.974948974941521*^9}, {
   3.97494916940831*^9, 3.9749491739935513`*^9}, {3.9749492090987053`*^9, 
   3.9749492265862207`*^9}, {3.974949277652175*^9, 3.974949323956649*^9}, {
   3.974949388895096*^9, 3.9749494641186004`*^9}, {3.974949656147008*^9, 
   3.9749496577467003`*^9}, {3.9749511842325845`*^9, 3.974951189857029*^9}, 
   3.9751334459552584`*^9, {3.975133483806534*^9, 3.9751335688079624`*^9}, 
   3.9751336537846217`*^9, {3.9751337556514287`*^9, 3.975133760983218*^9}, {
   3.975133792972084*^9, 3.975133956365531*^9}, {3.975139895738222*^9, 
   3.975139969447381*^9}, {3.975140530367076*^9, 3.975140593752714*^9}, {
   3.975140674575713*^9, 
   3.9751407063975296`*^9}},ExpressionUUID->"b3712acc-7a6d-40de-8432-\
710d215bf4d2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ZeroTensor", "::", "usage"}], "=", 
   "\"\<ZeroTensor[indices_List,Coordinates\[Rule]coord_List, \
TensorName->\\\"0\\\", StartIndex\[Rule]0, TooltipDisplay\[Rule]Null, \
TensorType\[Rule]Null,TooltipStyle\[Rule]{}, TensorOperator\[Rule] \
Simplify,TensorAssumption\[Rule]{}] returns a rank-Length[indices] and \
Length[coord]-dimensional zero Tensor object. The default TensorName is \\\"0\
\\\".\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9748796307957835`*^9, 3.9748798237023544`*^9}, 
   3.975055943588925*^9, 
   3.97511272942681*^9},ExpressionUUID->"111bfaca-956c-4c90-8e15-\
1caab075c592"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ZeroTensorQOperator", "::", "usage"}], "=", 
   "\"\<ZeroTensorQOperator\[Rule]op is an optional argument of ZeroTensorQ, \
where the default op is Simplify.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9748795023977385`*^9, 3.974879570695174*^9}, 
   3.97505346294803*^9, 
   3.9750558822814956`*^9},ExpressionUUID->"de50d459-dd78-4233-a785-\
4ab7ce3f4702"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TensorEquations", "::", "usage"}], "=", 
   "\"\<(I) TensorEquations[LHSt,RHSt,OutputForm\[Rule]List] returns some \
form of the tensor equation LHSt==RHSt. If OutputForm \[Rule] List is \
specified (the default setting), the output would be {idx_List,eqns}. The idx \
is the List of free indices of LHSt, assumed to be the same as those of RHSt; \
whereas eqns will be the Table generated from LHSt==RHSt by running over \
their free indices in the order specified by idx. If OutputForm \[Rule] \
Tensor is chosen, a Tensor object would be returned, with its \
TensorComponents given by the same Table generated by the OutputForm \[Rule] \
List option above. If OutputForm \[Rule] Flatten is chosen, the output would \
be Flatten and DeleteDuplicates applied to the same Table generated by the \
OutputForm \[Rule] List option above. If OutputForm \[Rule] BooleanQ is \
chosen, the output will be True if LHSt==RHSt is True for every component; \
otherwise the output will be False.\n(II) TensorEquations[t,0] generates a \
List of the tensor equation t==0, with Flatten and DeleteDuplicates applied.\n\
(III) TensorEquations[LHSt==RHSt] is equivalent to \
TensorEquations[LHSt,RHSt].\n(IV) TensorEquations[{LHSt==RHSt,..}] is \
equivalent to {TensorEquations[LHSt==RHSt],..}\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9748606875355883`*^9, 3.9748606910144196`*^9}, {
   3.9748607873782816`*^9, 3.974860817666959*^9}, {3.9748609220497055`*^9, 
   3.9748609632416334`*^9}, {3.974861000716748*^9, 3.974861005107586*^9}, 
   3.974861119501976*^9, 3.974861251247048*^9, {3.974862067335081*^9, 
   3.9748620806449995`*^9}, {3.974862231631638*^9, 3.9748622338573666`*^9}, {
   3.974862264764515*^9, 3.97486228118114*^9}, {3.974862332158334*^9, 
   3.9748625567069206`*^9}, {3.9748628528041897`*^9, 
   3.9748631827085743`*^9}, {3.974863347719589*^9, 3.9748634542038193`*^9}, {
   3.974863486980358*^9, 3.974863617920293*^9}, 3.9748637254248176`*^9, {
   3.975111757093133*^9, 3.975111760589383*^9}, {3.975112502742917*^9, 
   3.975112516319067*^9}, {3.975134035528425*^9, 3.9751340877079773`*^9}, {
   3.97513412517873*^9, 
   3.9751341652294536`*^9}},ExpressionUUID->"7a57b0f5-562f-41b5-bf95-\
5c3ebd4316ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TensorDivision", "::", "usage"}], "=", 
   "\"\<TensorDivision[LHSt,RHSt,TensorDivisionOperator\[Rule]Simplify] \
returns a Tensor or a regular scalar expression, whose components are the \
result of dividing LHSt by RHSt component-by-component, followed by acting \
op. The default option for the TensorDivisionOperator is Simplify. If the \
ratio of all the nonzero TensorComponents of LHSt to the those of RHSt is the \
same factor \[Kappa], this \[Kappa] is returned as output instead.\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.974860182176004*^9, 3.9748602008591948`*^9}, {
   3.974860235763755*^9, 3.974860285434897*^9}, {3.9748603247562094`*^9, 
   3.9748606567033024`*^9}, {3.97486075470535*^9, 3.974860758889854*^9}, 
   3.974860814736798*^9, 3.97505574643036*^9, {3.975055780030565*^9, 
   3.975055787606496*^9}, {3.9751117470043287`*^9, 3.975111751484802*^9}, {
   3.9751125056947184`*^9, 
   3.9751125069904933`*^9}},ExpressionUUID->"2937d2e2-e7e4-47be-8020-\
021a038c8f99"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GeodesicSystem", "::", "usage"}], "=", 
   "\"\<GeodesicSystem[\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"]\)_Tensor,\
AffineParameter\[Rule]Unique[\[Lambda]1],NonAffineParameter\[Rule]Unique[t1]] \
returns the affine parameter Lagrangian (1/2)\!\(\*SubscriptBox[\(g\), \
\(\[Mu]\[Nu]\)]\)[z[\!\(\*StyleBox[\"\[Lambda]\",FontSlant->\"Italic\"]\)]](\!\
\(\*SuperscriptBox[\(dz\), \
\(\[Mu]\)]\)/d\!\(\*StyleBox[\"\[Lambda]\",FontSlant->\"Italic\"]\))(\!\(\*\
SuperscriptBox[\(dz\), \(\[Nu]\)]\)/d\!\(\*StyleBox[\"\[Lambda]\",FontSlant->\
\"Italic\"]\)) for geodesic motion, with optional \
AffineParameter\[Rule]\!\(\*StyleBox[\"\[Lambda]\",FontSlant->\"Italic\"]\), \
the non-affine parameter Lagrangian (\!\(\*SubscriptBox[\(g\), \
\(\[Mu]\[Nu]\)]\)[z[\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\)]](\!\(\*\
SuperscriptBox[\(dz\), \(\[Mu]\)]\)/d\!\(\*StyleBox[\"t\",FontSlant->\"Italic\
\"]\))(\!\(\*SuperscriptBox[\(dz\), \
\(\[Nu]\)]\)/d\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\))\!\(\*\
SuperscriptBox[\()\), \(1/2\)]\) for geodesic motion, with optional \
NonAffineParameter\[Rule]\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\",\",FontSlant->\"Italic\"]\) and the geodesic equations in both \
affine and non-affine parameter forms.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GeodesicLagrangians", "::", "usage"}], "=", 
   "\"\<GeodesicLagrangians[m_Tensor,AffineParameter\[Rule]Unique[\[Lambda]1],\
NonAffineParameter\[Rule]Unique[t1]] returns the affine parameter Lagrangian \
(1/2)\!\(\*SubscriptBox[\(g\), \(\[Mu]\[Nu]\)]\)[z[\!\(\*StyleBox[\"\[Lambda]\
\",FontSlant->\"Italic\"]\)]](\!\(\*SuperscriptBox[\(dz\), \(\[Mu]\)]\)/d\!\(\
\*StyleBox[\"\[Lambda]\",FontSlant->\"Italic\"]\))(\!\(\*SuperscriptBox[\(dz\)\
, \(\[Nu]\)]\)/d\!\(\*StyleBox[\"\[Lambda]\",FontSlant->\"Italic\"]\)) for \
geodesic motion, with optional AffineParameter\[Rule]\!\(\*StyleBox[\"\
\[Lambda]\",FontSlant->\"Italic\"]\), and the non-affine parameter Lagrangian \
(\!\(\*SubscriptBox[\(g\), \
\(\[Mu]\[Nu]\)]\)[z[\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\)]](\!\(\*\
SuperscriptBox[\(dz\), \(\[Mu]\)]\)/d\!\(\*StyleBox[\"t\",FontSlant->\"Italic\
\"]\))(\!\(\*SuperscriptBox[\(dz\), \
\(\[Nu]\)]\)/d\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\))\!\(\*\
SuperscriptBox[\()\), \(1/2\)]\) for geodesic motion, with optional \
NonAffineParameter\[Rule]\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\). It \
does what GeodesicSystem does, but does not output the geodesic equations \
themselves.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GeodesicHamiltonianDynamics", "::", "usage"}], "=", 
   "\"\<GeodesicHamiltonianDynamics[\!\(\*StyleBox[\"m\",FontSlant->\"Italic\"\
]\)_Tensor,{\!\(\*StyleBox[\"z1\",FontSlant->\"Italic\"]\)\[Rule]\!\(\*\
StyleBox[\"p1\",FontSlant->\"Italic\"]\),\!\(\*StyleBox[\"z2\",FontSlant->\"\
Italic\"]\)\[Rule]\!\(\*StyleBox[\"p2\",FontSlant->\"Italic\"]\),...},\!\(\*\
StyleBox[\"\[Lambda]\",FontSlant->\"Italic\"]\)] returns the affine parameter \
Hamiltonian (1/2)\!\(\*SuperscriptBox[\(g\), \
\(\[Mu]\[Nu]\)]\)[z[\!\(\*StyleBox[\"\[Lambda]\",FontSlant->\"Italic\"]\)]]\!\
\(\*SubscriptBox[\(p\), \(\[Mu]\)]\)[\!\(\*StyleBox[\"\[Lambda]\",FontSlant->\
\"Italic\"]\)]\!\(\*SubscriptBox[\(p\), \(\[Nu]\)]\)[\!\(\*StyleBox[\"\
\[Lambda]\",FontSlant->\"Italic\"]\)] \n\tand the geodesic equations \
{\!\(\*SuperscriptBox[\(dz\), \
\(\[Mu]\)]\)/d\!\(\*StyleBox[\"\[Lambda]\",FontSlant->\"Italic\"]\)==\!\(\*\
SuperscriptBox[\(g\), \(\[Mu]\[Nu]\)]\)\!\(\*SubscriptBox[\(p\), \
\(\[Nu]\)]\),\!\(\*SubscriptBox[\(dp\), \
\(\[Mu]\)]\)=-\[PartialD]H/\[PartialD]\!\(\*SuperscriptBox[\(z\), \
\(\[Mu]\)]\)}.\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.975156141727098*^9, {3.975218219491756*^9, 3.9752182194988947`*^9}, {
   3.9752950138649282`*^9, 3.9752950431294975`*^9}, {3.9752951539243617`*^9, 
   3.9752951559105034`*^9}, {3.9752953472076244`*^9, 3.97529540861709*^9}, {
   3.9752954714724293`*^9, 3.9752954841223755`*^9}, {3.9752955290270195`*^9, 
   3.9752955314192753`*^9}, {3.975295576371837*^9, 3.9752955795799427`*^9}, {
   3.975298391264996*^9, 
   3.975298400871274*^9}},ExpressionUUID->"957ac35e-2eba-4845-b2b1-\
8ba2dd541a0e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GeodesicSystemVariationalMethods", "::", "usage"}], "=", 
   "\"\<GeodesicSystemVariationalMethods[\!\(\*StyleBox[\(\*StyleBox[\"m\",\
FontSlant->\"Italic\"]_Tensor\)]\),AffineParameter\[Rule]Unique[\[Lambda]1],\
NonAffineParameter\[Rule]Unique[t1]] returns the affine parameter Lagrangian \
(1/2)\!\(\*SubscriptBox[\(g\), \(\[Mu]\[Nu]\)]\)[z[\!\(\*StyleBox[\"\[Lambda]\
\",FontSlant->\"Italic\"]\)]](\!\(\*SuperscriptBox[\(dz\), \(\[Mu]\)]\)/d\!\(\
\*StyleBox[\"\[Lambda]\",FontSlant->\"Italic\"]\))(\!\(\*SuperscriptBox[\(dz\)\
, \(\[Nu]\)]\)/d\!\(\*StyleBox[\"\[Lambda]\",FontSlant->\"Italic\"]\)) for \
geodesic motion, with optional AffineParameter\[Rule]\!\(\*StyleBox[\"\
\[Lambda]\",FontSlant->\"Italic\"]\), the non-affine parameter Lagrangian (\!\
\(\*SubscriptBox[\(g\), \
\(\[Mu]\[Nu]\)]\)[z[\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\)]](\!\(\*\
SuperscriptBox[\(dz\), \(\[Mu]\)]\)/d\!\(\*StyleBox[\"t\",FontSlant->\"Italic\
\"]\))(\!\(\*SuperscriptBox[\(dz\), \
\(\[Nu]\)]\)/d\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\))\!\(\*\
SuperscriptBox[\()\), \(1/2\)]\) for geodesic motion, with optional \
NonAffineParameter\[Rule]\!\(\*StyleBox[\"t\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\",\",FontSlant->\"Italic\"]\) and the geodesic equations in both \
affine and non-affine parameter forms.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.975231997135213*^9, 3.975232008088984*^9}, 
   3.97529505382491*^9, 3.9752951598054805`*^9, 3.975295592972455*^9, 
   3.97529564642892*^9, {3.975298383745584*^9, 
   3.975298403690172*^9}},ExpressionUUID->"41882db0-52ed-4004-9324-\
89af7c73a8f0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SphericalHarmonicYTensor", "::", "usage"}], "=", 
   "\"\<(I) SphericalHarmonicYTensor[l,m,\[Theta]_Symbol,\[Phi]_Symbol,\
TooltipStyle\[Rule]{},TooltipDisplay\[Rule]Null] returns a scalar Tensor with \
TensorComponents given by SphericalHarmonicY[l, m, \[Theta], \[Phi]], where \
the angular coordinates {\[Theta],\[Phi]} parametrize the 2-sphere geometry (\
\[DifferentialD]\[ScriptL]\!\(\*SuperscriptBox[\()\), \(2\)]\)=(\
\[DifferentialD]\[Theta]\!\(\*SuperscriptBox[\()\), \(2\)]\)+Sin[\[Theta]\!\(\
\*SuperscriptBox[\(]\), \
\(2\)]\)(\[DifferentialD]\[Phi]\!\(\*SuperscriptBox[\()\), \(2\)]\).\n(II) \
SphericalHarmonicYTensor[l,m,g_Tensor]), TooltipStyle\[Rule]{}, \
TooltipDisplay\[Rule]Null] returns the same scalar Tensor as in (I), except \
the coordinates are extracted from Metric Tensor g.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9748547512092686`*^9, 3.974854822778702*^9}, {
   3.9748581707783737`*^9, 3.9748582027785006`*^9}, {3.974859953127553*^9, 
   3.9748599767438736`*^9}, {3.9748600146883802`*^9, 
   3.9748600375007615`*^9}, {3.974860189876087*^9, 3.9748601911331987`*^9}, {
   3.975052851670681*^9, 3.975052877769229*^9}, 3.975055710605831*^9, {
   3.9751117371806183`*^9, 3.9751117381007757`*^9}, {3.9751124717338305`*^9, 
   3.975112483310085*^9}},ExpressionUUID->"1b58d4ed-f645-4f87-8e1f-\
9c7629135de1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"VectorSphericalHarmonic", "::", "usage"}], "=", 
   "\"\<(I) VectorSphericalHarmonic[a, l, m, \[Theta]_Symbol, \[Phi]_Symbol, \
VectorType,Normalize\[Rule]True,TooltipStyle\[Rule]{},TooltipDisplay\[Rule]\
Null] returns a rank-1 Tensor with TensorComponents given by the vector \
spherical harmonics \!\(\*SubscriptBox[\(\[Del]\), \
\(a\)]\)\!\(\*SuperscriptBox[SubscriptBox[\(Y\), \(\[ScriptL]\)], \(m\)]\)[\
\[Theta],\[Phi]] (\\\"Gradient\\\") or \!\(\*SuperscriptBox[OverscriptBox[\(\
\[Epsilon]\), \(~\)], \(a\\\ b\)]\)\!\(\*SubscriptBox[\(\[Del]\), \
\(b\)]\)\!\(\*SuperscriptBox[SubscriptBox[\(Y\), \(\[ScriptL]\)], \(m\)]\)[\
\[Theta],\[Phi]] (\\\"Curl\\\"), where \
\!\(\*SuperscriptBox[SubscriptBox[\(Y\), \(\[ScriptL]\)], \(m\)]\)[\[Theta],\
\[Phi]] = SphericalHarmonicY[l, m, \[Theta], \[Phi]]. The normalized versions \
are \!\(\*SubscriptBox[\(\[Del]\), \(a\)]\)\!\(\*SuperscriptBox[SubscriptBox[\
\(Y\), \(\[ScriptL]\)], \(m\)]\)[\[Theta],\[Phi]]/(\[ScriptL](\[ScriptL]+1)\!\
\(\*SuperscriptBox[\()\), \(1/2\)]\) and \
\!\(\*SuperscriptBox[OverscriptBox[\(\[Epsilon]\), \(~\)], \(a\\\ \
b\)]\)\!\(\*SubscriptBox[\(\[Del]\), \
\(b\)]\)\!\(\*SuperscriptBox[SubscriptBox[\(Y\), \(\[ScriptL]\)], \(m\)]\)[\
\[Theta],\[Phi]]/(\[ScriptL](\[ScriptL]+1)\!\(\*SuperscriptBox[\()\), \
\(1/2\)]\). The angular coordinates {\[Theta],\[Phi]} parametrize the \
2-sphere geometry (\[DifferentialD]\[ScriptL]\!\(\*SuperscriptBox[\()\), \
\(2\)]\)=(\[DifferentialD]\[Theta]\!\(\*SuperscriptBox[\()\), \(2\)]\)+Sin[\
\[Theta]\!\(\*SuperscriptBox[\(]\), \
\(2\)]\)(\[DifferentialD]\[Phi]\!\(\*SuperscriptBox[\()\), \(2\)]\). The \
output index a can be a SuperMinus or SubMinus. The two types of vector \
harmonics are specified with VectorType\[Rule]\\\"Gradient\\\" or VectorType\
\[Rule]\\\"Curl\\\". The optional argument Normalize\[Rule]True (which is the \
default) would indicate the TensorComponents must be normalized whereas \
Normalize\[Rule]False would return the un-normalized ones without the (\
\[ScriptL](\[ScriptL]+1)\!\(\*SuperscriptBox[\()\), \(\(-1\)/2\)]\) factor.\n\
(II) VectorSphericalHarmonic[a, l, m, g_Tensor, VectorType, \
Normalize\[Rule]True, TooltipStyle\[Rule]{}, TooltipDisplay\[Rule]Null] \
returns the same rank-1 Tensor as in (I), except its coordinates are \
extracted from Metric Tensor g.\n\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9748504862292566`*^9, 3.9748504993253655`*^9}, {
   3.9748505492793283`*^9, 3.9748505524550123`*^9}, 3.974850820645955*^9, {
   3.9748513085393696`*^9, 3.974851315394866*^9}, {3.9748513633727927`*^9, 
   3.9748516771969776`*^9}, {3.9748527319746943`*^9, 3.974852903934149*^9}, {
   3.974852955001652*^9, 3.974852969220704*^9}, {3.97485402034564*^9, 
   3.974854146670866*^9}, {3.9748545352035236`*^9, 3.9748545739300795`*^9}, 
   3.9748548565188494`*^9, {3.9748548902999873`*^9, 3.974854986232583*^9}, {
   3.9748551570655494`*^9, 3.974855167745719*^9}, {3.974858617806862*^9, 
   3.974858681218119*^9}, 3.97486098951083*^9, {3.974861513892232*^9, 
   3.974861523050708*^9}, {3.974861988231221*^9, 3.974862023628497*^9}, {
   3.9748620995263696`*^9, 3.9748621132675476`*^9}, {3.974862318126664*^9, 
   3.9748623242545557`*^9}, {3.9751117258686943`*^9, 
   3.9751117326600323`*^9}, {3.9751124866385913`*^9, 
   3.9751124921188498`*^9}, {3.975133368418997*^9, 
   3.9751334211749916`*^9}},ExpressionUUID->"a405104b-c473-4f43-bfa7-\
591bd1f8388b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ElectromagneticStressEnergyTensor", "::", "usage"}], "=", 
   "\"\<ElectromagneticStressEnergyTensor[\[Mu],\[Nu],F_Tensor,m_Tensor,\
MetricSignature\[Rule]\\\"MostlyMinus\\\"] takes in the metric Tensor m (its \
TensorType must be Metric) and a Faraday Tensor F. It returns the stress\
\[Dash]energy tensor \!\(\*SubscriptBox[\(T\), \(\[Mu]\[Nu]\)]\) = \
\[Sigma]g(-\!\(\*SuperscriptBox[SubscriptBox[\(F\), \(\[Mu]\)], \(\[Sigma]\)]\
\)\!\(\*SubscriptBox[\(F\), \(\[Nu]\[Sigma]\)]\) + (1/4) \
\!\(\*SubscriptBox[\(g\), \(\[Mu]\[Nu]\)]\) \!\(\*SubscriptBox[\(F\), \(\
\[Sigma]\[Rho]\)]\)\!\(\*SuperscriptBox[\(F\), \(\[Sigma]\[Rho]\)]\)), where \
\[Sigma]g = +1 for the MostlyMinus signature and \[Sigma]g = -1 for \
MostlyPlus. The input indices \[Mu] and \[Nu] can be in any position; i.e., \
their Head can be either SuperMinus or SubMinus. MetricSignature \[Rule] \
op_String specifies whether the user is employing the \\\"MostlyMinus\\\" or \
\\\"MostlyPlus\\\" metric signature. In (1+1) spacetime dimensions \
\\\"MostlyMinus\\\" means \!\(\*SubscriptBox[\(\[Eta]\), \(\[Mu]\[Nu]\)]\) \
\[Congruent] diag[1,-1] and \\\"MostlyPlus\\\" means \!\(\*SubscriptBox[\(\
\[Eta]\), \(\[Mu]\[Nu]\)]\) \[Congruent] diag[-1,1]. The default is \
\\\"MostlyMinus\\\".\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9748490320321813`*^9, 3.9748490320321813`*^9}, {
   3.97484907157538*^9, 3.974849092423726*^9}, {3.9748498315473995`*^9, 
   3.9748499599591026`*^9}, {3.9748500205933704`*^9, 
   3.9748500423223624`*^9}, {3.9748503648180246`*^9, 3.9748504067218432`*^9}, 
   3.9748505000461082`*^9, {3.97485070185975*^9, 3.974850739419187*^9}, {
   3.974851719085878*^9, 3.9748517293994217`*^9}, {3.9748546005754805`*^9, 
   3.9748546050828347`*^9}, {3.97486195684083*^9, 3.9748619816258745`*^9}, {
   3.974943677484498*^9, 3.9749438240713844`*^9}, {3.9749444273714275`*^9, 
   3.974944434613722*^9}, {3.9749488061523085`*^9, 3.9749488087451086`*^9}, {
   3.974950738292079*^9, 3.974950747663299*^9}, {3.974952634419239*^9, 
   3.9749526376749597`*^9}, {3.975052237026988*^9, 3.9750522927609806`*^9}, {
   3.97511171851626*^9, 3.97511171944469*^9}, {3.9751124953262663`*^9, 
   3.975112498359216*^9}},ExpressionUUID->"83f8cf4f-a300-45b9-9830-\
72367cc67ba2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MetricDeterminant", "::", "usage"}], "=", 
   "\"\<MetricDeterminant is an Option within a Tensor of type Metric whose \
OptionValue is the determinant of the metric in use.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RiemannComponents", "::", "usage"}], "=", 
   "\"\<RiemannComponents refer to the components of the Riemann curvature \
tensor.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RicciComponents", "::", "usage"}], "=", 
   "\"\<RicciComponents refer to the components of the Ricci curvature \
tensor.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RicciScalarInvariant", "::", "usage"}], "=", 
   "\"\<RicciScalarCurvature is the Option occuring within a Tensor of Metric \
type, whose OptionValue gives the rule referring to the Ricci scalar.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ChristoffelComponents", "::", "usage"}], "=", 
   "\"\<ChristoffelComponents refer to the components of the Christoffel \
symbols.\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.975301591611801*^9, 
  3.9753015922555437`*^9}},ExpressionUUID->"db7578b6-a8c5-485c-b9ab-\
1907dc1e69f8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OrthonormalBasis", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CoordinateBasis", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"cdb86cd7-1de2-4545-8916-8bb35d9720cb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OperatorProductRule", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TensorComponentsManipulation", "::", "usage"}], "=", "\"\<\>\""}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtractFunction", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EndowFunction", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OperatorDistribute", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.975301674744943*^9, 3.9753018027567534`*^9, {3.975301858547921*^9, 
   3.9753018588649783`*^9}, {3.9753019772122936`*^9, 
   3.9753020189303617`*^9}},ExpressionUUID->"09b74f41-63f5-4078-a354-\
e9df547a82f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"4", "D", " ", "Ideal", " ", "MHD", " ", "Functions"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"MHDSystem", "::", "usage"}], "=", 
     "\"\<MHDSystem[{\[CapitalPhi]1_,\[CapitalPhi]2_,\[CapitalPhi]3_}, \
\[Rho]0_Function, m_Tensor, MetricSignature \[Rule] s_String, MHDOperator \
\[Rule] op] returns an object, with Head MHDSystem, that stores all relevant \
information described by the 3 scalar fields {\[CapitalPhi]1,\[CapitalPhi]2,\
\[CapitalPhi]3} and the plasma energy density (pure function) \[Rho]0. Note \
that MetricSignature and MHDOperator are optional; s = \\\"MostlyMinus\\\" \
tells TensoriaCalc the user employs \!\(\*SubscriptBox[\(\[Eta]\), \(\[Mu]\
\[Nu]\)]\) = diag[1,-1,...,-1] and s = \\\"MostlyPlus\\\" tells TensoriaCalc \
the user employs \!\(\*SubscriptBox[\(\[Eta]\), \(\[Mu]\[Nu]\)]\) = \
diag[-1,+1,...,+1]; the default values are s = \\\"MostlyMinus\\\" and op = \
Simplify.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDScalar", "::", "usage"}], "=", 
     "\"\<(\!\(\*StyleBox[\"I\",FontColor->RGBColor[0, 0, 1]]\)) \
MHDScalar[1,mm_MHDSystem], MHDScalar[2,mm_MHDSystem], and \
MHDScalar[3,mm_MHDSystem] returns, respectively, the 1st, 2nd, and 3rd \
fundamental scalar fields of the MHDSystem mm. \
(\!\(\*StyleBox[\"II\",FontColor->RGBColor[0, 0, 1]]\)) \
MHDScalar[\[Mu]T_,1,mm_MHDSystem], MHDScalar[\[Mu]T_,2,mm_MHDSystem], and \
MHDScalar[\[Mu]T_,3,mm_MHDSystem] returns, respectively, the Tensor object \
describing \[Del]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(1\)]\), \[Del]\!\(\
\*SuperscriptBox[\(\[CapitalPhi]\), \(2\)]\), and \[Del]\!\(\*SuperscriptBox[\
\(\[CapitalPhi]\), \(3\)]\), with index \[Mu]T.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHD3Form", "::", "usage"}], "=", 
     "\"\<MHD3Form[\[Mu]T_,\[Nu]T_,\[Gamma]T_,mm_MHDSystem] returns the \
Tensor built from the 3 fundamental scalars \
\!\(\*StyleBox[OverscriptBox[StyleBox[\"n\",FontSlant->\"Italic\"], \
\"~\"],FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \",FontSlant->\"Italic\"]\)\
\[Congruent] \[DifferentialD]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(1\)]\) \
\[Wedge] \[DifferentialD]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(2\)]\) \
\[Wedge] \[DifferentialD]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(3\)]\), of \
the MHDSystem mm, with indices {\[Mu]T,\[Nu]T,\[Gamma]T}.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDPlasmaCurrent", "::", "usage"}], "=", 
     "\"\<MHDPlasmaCurrent[\[Mu]T_,mm_MHDSystem] returns the plasma current \
Tensor \!\(\*StyleBox[\"n\",FontSlant->\"Italic\"]\), of the MHDSystem mm, \
with indices {\[Mu]T}. Note that \
\!\(\*StyleBox[\"n\",FontSlant->\"Italic\"]\) is the Hodge dual of the 3-form \
built from the 3 fundamental MHD scalars, namely \
\[DifferentialD]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(1\)]\) \[Wedge] \
\[DifferentialD]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(2\)]\) \[Wedge] \
\[DifferentialD]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(3\)]\).\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDMaxwell", "::", "usage"}], "=", 
     "\"\<MHDMaxwell[\[Mu]T_,\[Nu]T_,mm_MHDSystem] returns the Maxwell Tensor \
\!\(\*StyleBox[\"F\",FontSlant->\"Italic\"]\), of the MHDSystem mm, with \
indices {\[Mu]T,\[Nu]T}.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDMaxwellCurrent", "::", "usage"}], "=", 
     "\"\<MHDMaxwellCurrent[\[Mu]T_,mm_MHDSystem] returns the electromagnetic \
(Maxwell) current \!\(\*StyleBox[\"J\",FontSlant->\"Italic\"]\) = div \
\!\(\*StyleBox[\"F\",FontSlant->\"Italic\"]\), of the MHDSystem mm, with \
index {\[Mu]T}.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDRank2P", "::", "usage"}], "=", 
     "\"\<MHDRank2P[\[Mu]T_,\[Nu]T_,mm_MHDSystem] returns the rank-2 Tensor \
object \!\(\*StyleBox[\"P\",FontSlant->\"Italic\"]\), of the MHDSystem mm, \
with indices {\[Mu]T,\[Nu]T}. This \
\!\(\*StyleBox[\"P\",FontSlant->\"Italic\"]\) occurs on the right hand side \
of the 3 MHD PDEs.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDMetric", "::", "usage"}], "=", 
     "\"\<MHDMetric[\[Mu]T_, \[Nu]T_, mm_MHDSystem] returns the Metric Tensor \
object describing the background spacetime geometry of the MHDSystem in mm, \
with indices {\[Mu]T, \[Nu]T}.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"...", " ", "MHDSystem", " ", "arguments"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDScalarFunction1", "::", "usage"}], "=", 
     "\"\<MHDScalarFunction1 \[Rule] \!\(\*SuperscriptBox[\(\[CapitalPhi]\), \
\(1\)]\) is one of the arguments of an MHDSystem object. It describes the 1st \
fundamental scalar of the MHDSstem.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDScalarFunction2", "::", "usage"}], "=", 
     "\"\<MHDScalarFunction2 \[Rule] \!\(\*SuperscriptBox[\(\[CapitalPhi]\), \
\(2\)]\) is one of the arguments of an MHDSystem object. It describes the 2nd \
fundamental scalar of the MHDSstem.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDScalarFunction3", "::", "usage"}], "=", 
     "\"\<MHDScalarFunction3 \[Rule] \!\(\*SuperscriptBox[\(\[CapitalPhi]\), \
\(3\)]\) is one of the arguments of an MHDSystem object. It describes the 3rd \
fundamental scalar of the MHDSstem.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHD1FormTensor1", "::", "usage"}], "=", 
     "\"\<MHD1FormTensor1 \[Rule] \
\[Del]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(1\)]\) is one of the \
arguements of an MHDSystem object. It describes the gradient of the 1st \
fundamental scalar of the MHDSstem.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHD1FormTensor2", "::", "usage"}], "=", 
     "\"\<MHD1FormTensor2 \[Rule] \
\[Del]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(2\)]\) is one of the \
arguements of an MHDSystem object. It describes the gradient of the 2nd \
fundamental scalar of the MHDSstem.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHD1FormTensor3", "::", "usage"}], "=", 
     "\"\<MHD1FormTensor3 \[Rule] \
\[Del]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(3\)]\) is one of the \
arguements of an MHDSystem object. It describes the gradient of the 3rd \
fundamental scalar of the MHDSstem.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHD3FormTensor", "::", "usage"}], "=", 
     "\"\<MHD3FormTensor \[Rule] \
\[Del]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \
\(1\)]\)\[Wedge]\[Del]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \
\(2\)]\)\[Wedge]\[Del]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(3\)]\) is one \
of the arguments of an MHDSystem object. It describes the 3-form \
\[DifferentialD]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(1\)]\)\[Wedge]\
\[DifferentialD]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(2\)]\)\[Wedge]\
\[DifferentialD]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(3\)]\), where \
\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(I = 1, 2, 3\)]\) are the 3 \
fundamental scalars of the MHDSystem.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDMaxwellTensor", "::", "usage"}], "=", 
     "\"\<MHDMaxwellTensor \[Rule] \[Del]\!\(\*SuperscriptBox[\(\[CapitalPhi]\
\), \(1\)]\)\[Wedge]\[Del]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(2\)]\) is \
one of the arguments of an MHDSystem object. It describes the 2-form Maxwell \
Tensor \!\(\*StyleBox[\"F\",FontSlant->\"Italic\"]\) = \
\[DifferentialD]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(1\)]\)\[Wedge]\
\[DifferentialD]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(2\)]\), where \
\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(I = 1, 2\)]\) are the first 2 \
fundamental scalars of the MHDSystem.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDPlasmaCurrentTensor", "::", "usage"}], "=", 
     "\"\<MHDPlasmaCurrentTensor \[Rule] \
\[FivePointedStar](\[DifferentialD]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \
\(1\)]\) \[Wedge] \[DifferentialD]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(2\
\)]\) \[Wedge] \[DifferentialD]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(3\)]\
\)) is one of the arguments of an MHDSystem object. It describes the \
(identically conserved) plasma current Tensor, which in index notation reads \
\!\(\*SuperscriptBox[StyleBox[\"n\",FontSlant->\"Italic\"], \"\[Mu]\"]\) \
\[Congruent] \!\(\*SuperscriptBox[OverscriptBox[\(\[Epsilon]\), \(~\)], \(\
\[Mu]\\\ \[Alpha]\[Beta]\[Gamma]\)]\) \!\(\*SubscriptBox[\(\[Del]\), \(\
\[Alpha]\)]\)\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \
\(1\)]\)\!\(\*SubscriptBox[\(\[Del]\), \(\[Beta]\)]\)\!\(\*SuperscriptBox[\(\
\[CapitalPhi]\), \(2\)]\)\!\(\*SubscriptBox[\(\[Del]\), \
\(\[Gamma]\)]\)\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(3\)]\), where \
\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(I = 1, 2, 3\)]\) are the 3 \
fundamental scalars of the MHDSystem.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDRank2PTensor", "::", "usage"}], "=", 
     "\"\<MHDRank2PTensor \[Rule] \
\!\(TraditionalForm\`\*SuperscriptBox[\(P\), \(\[Alpha]\[Beta]\)]\) is one of \
the arguments of an MHDSystem object. It describes the Tensor object \
\!\(\*SuperscriptBox[StyleBox[\"P\",FontSlant->\"Italic\"], \"\[Alpha]\[Beta]\
\"]\) \[Congruent] \!\(\*SubscriptBox[\(\[Del]\), \
\(\[Sigma]\)]\)(\!\(\*SubscriptBox[\(\[Rho]\), \(0\)]\) \!\(\*SuperscriptBox[\
\(\[Del]\), \([\[Sigma]\)]\)\!\(\*SubscriptBox[\(\[CapitalPhi]\), \(1\)]\) \!\
\(\*SuperscriptBox[\(\[Del]\), \(\[Alpha]\)]\)\!\(\*SubscriptBox[\(\
\[CapitalPhi]\), \(2\)]\) \!\(\*SuperscriptBox[\(\[Del]\), \(\(\[Beta]\)\(]\)\
\)]\)\!\(\*SubscriptBox[\(\[CapitalPhi]\), \(3\)]\)), which occurs on the \
right-hand-sides of the 3 PDEs governing the MHDSystem.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDMaxwellCurrentTensor", "::", "usage"}], "=", 
     "\"\<MHDMaxwellCurrentTensor \[Rule] \
\!\(TraditionalForm\`\*SuperscriptBox[\(J\), \(\[Alpha]\)]\) is one of the \
arguments of an MHDSystem object. It describes the Tensor object \
\!\(\*SuperscriptBox[StyleBox[\"J\",FontSlant->\"Italic\"], \"\[Alpha]\"]\) \
\[Congruent] \!\(\*SubscriptBox[\(\[Del]\), \
\(\[Sigma]\)]\)\!\(\*SuperscriptBox[StyleBox[\"F\",FontSlant->\"Italic\"], \"\
\[Sigma]\[Alpha]\"]\), \
\!\(\*StyleBox[\"i\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\".\",FontSlant->\
\"Italic\"]\)\!\(\*StyleBox[\"e\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\".\"\
,FontSlant->\"Italic\"]\), the electromagnetic current.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDEquationsList", "::", "usage"}], "=", 
     "\"\<MHDEquationsList \[Rule] {{lhs1,rhs1},{lhs2,rhs2},{0,rhs3}} is one \
of the arguments of an MHDSystem object. The lhs1 == rhs1, lhs2 == rhs2, and \
0 == rhs3 form the 3 fundamental PDEs of the MHDSystem.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDEquations", "::", "usage"}], "=", 
     "\"\<MHDEquations[mm_MHDSystem] returns a List of the 3 fundamental \
partial differential equations of the MHDSystem mm.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDMaxwellStressTensor", "::", "usage"}], "=", 
     "\"\<MHDMaxwellStressTensor \[Rule] \
\!\(\*StyleBox[\"T\",FontSlant->\"Italic\"]\)[EM\!\(\*SubscriptBox[\(]\), \(\
\[Mu]\[Nu]\)]\) is one of the arguments of an MHDSystem object. It contains \
the rank-2 Tensor object describing electromagnetic \
energy-momentum-shear-stress of the MHDSystem.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDPlasmaStressTensor", "::", "usage"}], "=", 
     "\"\<MHDPlasmaStressTensor \[Rule] \
\!\(\*StyleBox[\"T\",FontSlant->\"Italic\"]\)[Plasma\!\(\*SubscriptBox[\(]\), \
\(\[Mu]\[Nu]\)]\) is one of the arguments of an MHDSystem object. It contains \
the rank-2 Tensor object describing plasma energy-momentum-shear-stress of \
the MHDSystem.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDTotalStressTensor", "::", "usage"}], "=", 
     "\"\<MHDTotalStressTensor \[Rule] \
\!\(\*StyleBox[\"T\",FontSlant->\"Italic\"]\)[Total\!\(\*SubscriptBox[\(]\), \
\(\[Mu]\[Nu]\)]\) is one of the arguments of an MHDSystem object. It contains \
the rank-2 Tensor object describing the total plasma + Maxwell photon \
energy-momentum-shear-stress of the MHDSystem.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDLagrangianDensity", "::", "usage"}], "=", 
     "\"\<MHDLagrangianDensity \[Rule] L is one of the arguments of a \
MHDSystem object, where L is the Lagrangian density of the MHDSystem\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDPlasmaEnergyDensityOperator", "::", "usage"}], "=", 
     "\"\<MHDPlasmaEnergyDensityOperator \[Rule] \
\!\(\*StyleBox[\"op\",FontSlant->\"Italic\"]\) is one of the arguments of a \
MHDSystem object, where \!\(\*StyleBox[\"op\",FontSlant->\"Italic\"]\) \
provides the function describing the energy density of the plasma.\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDPlasmaEnergyDensity", "::", "usage"}], "=", 
     "\"\<MHDPlasmaEnergyDensity[mm_MHDSystem] returns the plasma energy \
density function of the MHDSystem mm.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDLagrangian", "::", "usage"}], "=", 
     "\"\<MHDLagrangian[mm_MHDSystem] returns the (coordinate scalar) \
Lagrangian density of the MHDSystem mm.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDEnergyMomentumShearStress", "::", "usage"}], "=", 
     "\"\<MHDEnergyMomentumShearStress[\[Mu]T_,\[Nu]T_,ss_String,mm_MHDSystem]\
, for ss = Maxwell, returns the rank-2 Tensor object describing \
electromagnetic energy-momentum-shear-stress of the MHDSystem mm. \
MHDEnergyMomentumShearStress[\[Mu]T_,\[Nu]T_,ss_String,mm_MHDSystem], for ss \
= Plasma, returns the rank-2 Tensor object describing plasma \
energy-momentum-shear-stress of the MHDSystem mm. \
MHDEnergyMomentumShearStress[\[Mu]T_,\[Nu]T_,ss_String,mm_MHDSystem], for ss \
= Total, returns the rank-2 Tensor object describing the total plasma + \
Maxwell photon energy-momentum-shear-stress of the MHDSystem mm.\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDMetricTensor", "::", "usage"}], "=", 
     "\"\<MHDMetricTensor \[Rule] \
\!\(\*SubscriptBox[StyleBox[\"g\",FontSlant->\"Italic\"], \"\[Mu]\[Nu]\"]\) \
is one of the arguments of an MHDSystem object. It contains the rank-2 Tensor \
object describing background spacetime geometry of the MHDSystem.\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDOperator", "::", "usage"}], "=", 
     "\"\<MHDOperator \[Rule] op is an optional argument when entering a \
MHDSystem. Default value for op is Simplify.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MetricSignature", "::", "usage"}], "=", 
     "\"\<MetricSignature \[Rule] op_String specifies whether the user is \
employing the `MostlyMinus' or `MostlyPlus' metric signature; in (1+1) \
spacetime dimensions `MostlyMinus' means \!\(\*SubscriptBox[\(\[Eta]\), \(\
\[Mu]\[Nu]\)]\) \[Congruent] diag[1,-1] and `MostlyPlus' means \
\!\(\*SubscriptBox[\(\[Eta]\), \(\[Mu]\[Nu]\)]\) \[Congruent] diag[-1,1]. \
MetricSignature occurs, for e.g., as an Optional argument in MHDSystem. \
Whenever relevant, the default is `MostlyMinus'.\>\""}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.518287025359375*^9, 3.518287083796875*^9}, {
   3.518287204515625*^9, 3.518287246046875*^9}, {3.518288154015625*^9, 
   3.518288179625*^9}, {3.5196834121875*^9, 3.519683417953125*^9}, {
   3.519689356625*^9, 3.519689356921875*^9}, {3.51976580715625*^9, 
   3.519765810671875*^9}, {3.519963432453125*^9, 3.519963433953125*^9}, 
   3.520125837828125*^9, {3.5201289498125*^9, 3.5201289504375*^9}, 
   3.520219859578125*^9, 3.5202268538125*^9, {3.52027377246875*^9, 
   3.520273831296875*^9}, {3.5202738760625*^9, 3.52027388446875*^9}, {
   3.5202739371875*^9, 3.5202741019375*^9}, {3.52027416353125*^9, 
   3.520274167671875*^9}, 3.520274919453125*^9, {3.52027495775*^9, 
   3.52027500990625*^9}, {3.520275109328125*^9, 3.52027513640625*^9}, {
   3.520275352625*^9, 3.520275353015625*^9}, {3.52027552415625*^9, 
   3.5202755711875*^9}, 3.520275790296875*^9, {3.5202759311875*^9, 
   3.520275948625*^9}, {3.520276746125*^9, 3.5202767880625*^9}, {
   3.52027692378125*^9, 3.52027700428125*^9}, {3.520277061046875*^9, 
   3.520277097125*^9}, {3.520277138046875*^9, 3.520277203125*^9}, {
   3.52027851596875*^9, 3.520278524*^9}, {3.52027856384375*^9, 
   3.520278653328125*^9}, 3.5202787563125*^9, {3.520279456296875*^9, 
   3.5202794635625*^9}, {3.520279561640625*^9, 3.520279567359375*^9}, {
   3.52028006315625*^9, 3.520280068671875*^9}, {3.5202804206875*^9, 
   3.520280495234375*^9}, 3.520281272765625*^9, {3.52028149878125*^9, 
   3.5202815018125*^9}, {3.520281674421875*^9, 3.5202816786875*^9}, {
   3.520281727390625*^9, 3.520281730375*^9}, 3.52028190265625*^9, {
   3.52028213190625*^9, 3.520282169640625*^9}, {3.520282364859375*^9, 
   3.520282395859375*^9}, {3.520282483109375*^9, 3.520282499046875*^9}, {
   3.52028567246875*^9, 3.520285695984375*^9}, {3.5202857606875*^9, 
   3.520285762578125*^9}, {3.520285792890625*^9, 3.520285807109375*^9}, {
   3.5202858616875*^9, 3.52028586721875*^9}, {3.520286964859375*^9, 
   3.520286985015625*^9}, {3.52028713909375*^9, 3.520287168453125*^9}, {
   3.52030002590625*^9, 3.520300043171875*^9}, {3.520300760625*^9, 
   3.520300806765625*^9}, {3.52030106778125*^9, 3.520301101625*^9}, {
   3.520301143203125*^9, 3.520301143921875*^9}, {3.520301203140625*^9, 
   3.520301219734375*^9}, {3.520301382671875*^9, 3.520301408375*^9}, {
   3.5203015531875*^9, 3.520301561859375*^9}, {3.52030160309375*^9, 
   3.52030162021875*^9}, {3.520301674546875*^9, 3.520301675078125*^9}, 
   3.520301885265625*^9, {3.52030235646875*^9, 3.5203024485*^9}, {
   3.52030252584375*^9, 3.520302587984375*^9}, {3.520302792015625*^9, 
   3.520302959515625*^9}, {3.520303101875*^9, 3.520303107296875*^9}, {
   3.520303238609375*^9, 3.52030324271875*^9}, 3.520303299859375*^9, {
   3.520303549375*^9, 3.52030358071875*^9}, {3.5203507715625*^9, 
   3.520350858640625*^9}, {3.520350918515625*^9, 3.520350918796875*^9}, {
   3.5203511166875*^9, 3.520351136140625*^9}, {3.520356764953125*^9, 
   3.520356884515625*^9}, {3.520371762125*^9, 3.5203718918125*^9}, {
   3.520378815359375*^9, 3.520378856375*^9}, {3.52037895428125*^9, 
   3.520378970015625*^9}, {3.5204389959375*^9, 3.52043945671875*^9}, {
   3.520439536453125*^9, 3.52043953984375*^9}, 3.520439581921875*^9, {
   3.520439654296875*^9, 3.520439710359375*^9}, {3.520439880765625*^9, 
   3.520439884828125*^9}, {3.520439970515625*^9, 3.52044004490625*^9}, {
   3.52044311690625*^9, 3.520443213734375*^9}, {3.520465048609375*^9, 
   3.5204650511875*^9}, {3.520626553671875*^9, 3.52062658471875*^9}, {
   3.52062668471875*^9, 3.52062670090625*^9}, {3.520626757234375*^9, 
   3.520626799984375*^9}, {3.520626907484375*^9, 3.52062701828125*^9}, {
   3.52069946446875*^9, 3.5206994743125*^9}, {3.520699970546875*^9, 
   3.52069998275*^9}, {3.520815631453125*^9, 3.520815642671875*^9}, {
   3.52087815671875*^9, 3.5208781575625*^9}, {3.52087819059375*^9, 
   3.520878191671875*^9}, {3.520878244578125*^9, 3.520878249421875*^9}, {
   3.520899545265625*^9, 3.520899552515625*^9}, {3.520956048171875*^9, 
   3.520956049203125*^9}, 3.520957443984375*^9, {3.521140458546875*^9, 
   3.52114045903125*^9}, {3.521146843921875*^9, 3.5211468451875*^9}, {
   3.521226495468966*^9, 3.5212267343908415`*^9}, {3.5212272990470915`*^9, 
   3.521227301906466*^9}, {3.521234889484375*^9, 3.52123490115625*^9}, 
   3.5212349964375*^9, 3.521235089015625*^9, 3.521235880828125*^9, 
   3.521236001265625*^9, 3.52123740409375*^9, 3.521237684734375*^9, 
   3.52123825221875*^9, 3.521247508625*^9, 3.52124811696875*^9, 
   3.521248740078125*^9, {3.521251276515625*^9, 3.5212512769375*^9}, {
   3.521252125328125*^9, 3.521252129109375*^9}, {3.52125512903125*^9, 
   3.52125513334375*^9}, {3.52134227965625*^9, 3.521342302765625*^9}, {
   3.521350247328125*^9, 3.5213502586875*^9}, {3.521479285640625*^9, 
   3.521479481234375*^9}, {3.521510402328125*^9, 3.52151042*^9}, {
   3.52151067996875*^9, 3.521510685546875*^9}, {3.521510730328125*^9, 
   3.521510739578125*^9}, {3.521510958453125*^9, 3.521510961984375*^9}, {
   3.521571634296875*^9, 3.521571802671875*^9}, {3.521572707796875*^9, 
   3.521572848953125*^9}, {3.52166992121875*^9, 3.521670375828125*^9}, {
   3.521671400609375*^9, 3.521671468921875*^9}, {3.52167190478125*^9, 
   3.521671956046875*^9}, {3.521672654796875*^9, 3.521672663921875*^9}, {
   3.52167419490625*^9, 3.521674311921875*^9}, {3.521674723703125*^9, 
   3.52167473009375*^9}, {3.521698277296875*^9, 3.521698278296875*^9}, {
   3.52170295315625*^9, 3.521703048328125*^9}, {3.521734163609375*^9, 
   3.521734164296875*^9}, {3.5217404766875*^9, 3.521740477390625*^9}, {
   3.521757871828125*^9, 3.52175808225*^9}, {3.52175824334375*^9, 
   3.521758489984375*^9}, {3.5217585360625*^9, 3.52175861346875*^9}, {
   3.5217598483125*^9, 3.521759928390625*^9}, {3.52175996796875*^9, 
   3.52176025784375*^9}, {3.521760292078125*^9, 3.52176030628125*^9}, {
   3.5217651831875*^9, 3.521765221421875*^9}, {3.52176535990625*^9, 
   3.52176541146875*^9}, {3.52178529415625*^9, 3.521785357515625*^9}, {
   3.521787816203125*^9, 3.5217878181875*^9}, {3.521910257296875*^9, 
   3.521910279484375*^9}, {3.521910354734375*^9, 3.52191037071875*^9}, {
   3.521953189171875*^9, 3.5219535383125*^9}, {3.5219541266875*^9, 
   3.521954167859375*^9}, {3.522528068484375*^9, 3.52252807225*^9}, {
   3.533879884589926*^9, 3.5338799579256544`*^9}, {3.5391957298212233`*^9, 
   3.539195980472576*^9}, {3.5391960243210382`*^9, 3.5391960252110395`*^9}, {
   3.5394613785048385`*^9, 3.5394614644453897`*^9}, {3.539551377786018*^9, 
   3.5395513832616277`*^9}, {3.5395518179563913`*^9, 3.539551821497597*^9}, {
   3.5395518826029043`*^9, 3.539551883024105*^9}, {3.539552087680865*^9, 
   3.5395520916276717`*^9}, {3.5396160218156214`*^9, 
   3.5396160594740877`*^9}, {3.539616108785774*^9, 3.5396164138287096`*^9}, {
   3.5760901684770727`*^9, 3.576090494096444*^9}, {3.576090533470914*^9, 
   3.5760905336737137`*^9}, {3.576093700198476*^9, 3.5760938477747345`*^9}, {
   3.5766864493342285`*^9, 3.5766870372680607`*^9}, {3.5766870775317316`*^9, 
   3.576687119012204*^9}, {3.5837901145639615`*^9, 3.5837902223701277`*^9}, {
   3.606329333933484*^9, 3.606329375050616*^9}, {3.6064202232098227`*^9, 
   3.6064202685464163`*^9}, {3.6064204122876377`*^9, 3.606420456448163*^9}, {
   3.606491800762127*^9, 3.606491850775815*^9}, {3.606492069990939*^9, 
   3.606492143879165*^9}, {3.6064921763380213`*^9, 3.6064922572346487`*^9}, {
   3.6064923297627974`*^9, 3.6064923299818096`*^9}, {3.606492370603133*^9, 
   3.606492371219168*^9}, {3.6064961691193953`*^9, 3.6064961915836806`*^9}, {
   3.6064975285121484`*^9, 3.606497546217161*^9}, {3.6065035977871275`*^9, 
   3.606503646715926*^9}, {3.6065063001198483`*^9, 3.606506471837719*^9}, {
   3.606513240603368*^9, 3.6065132547171745`*^9}, {3.60651331827781*^9, 
   3.606513466271275*^9}, {3.6065743279396286`*^9, 3.6065743313716345`*^9}, {
   3.6065760454249916`*^9, 3.60657607740182*^9}, {3.6096134581867433`*^9, 
   3.6096134860795927`*^9}, {3.6096142872189994`*^9, 3.609614335438684*^9}, {
   3.6294774407514944`*^9, 3.6294774906015644`*^9}, {3.62947757779919*^9, 
   3.629477783009477*^9}, {3.629477825719537*^9, 3.6294778347395496`*^9}, {
   3.6294778894696264`*^9, 3.62947797075974*^9}, {3.6294780589298635`*^9, 
   3.6294780596998644`*^9}, {3.629478098129918*^9, 3.6294782395501165`*^9}, {
   3.6294782867201824`*^9, 3.6294783055702085`*^9}, {3.629478455970419*^9, 
   3.6294784946804733`*^9}, {3.6294785317405252`*^9, 
   3.6294785570705605`*^9}, {3.6294803157822976`*^9, 3.629480339682331*^9}, {
   3.6296556131724815`*^9, 3.629655647025541*^9}, {3.629655677321794*^9, 
   3.6296556859360094`*^9}, {3.629697278543481*^9, 3.6296973521750107`*^9}, {
   3.6296977113732457`*^9, 3.629697784256974*^9}, {3.6297631878993664`*^9, 
   3.629763353830789*^9}, {3.629763719443343*^9, 3.6297637226415515`*^9}, {
   3.6297637935867133`*^9, 3.6297638430924325`*^9}, {3.629908800590377*^9, 
   3.629908989442511*^9}, {3.6299090230303698`*^9, 3.6299090238727713`*^9}, {
   3.6299332867334347`*^9, 3.6299332984178553`*^9}, {3.629933337870325*^9, 
   3.6299333851852083`*^9}, {3.6299334939797993`*^9, 
   3.6299334981932344`*^9}, {3.6299337870972757`*^9, 3.629933817049328*^9}, {
   3.6299338759082317`*^9, 3.629933878092235*^9}, {3.629933931892765*^9, 
   3.6299339794572487`*^9}, {3.629934090482643*^9, 3.6299342367017*^9}, {
   3.629934623053544*^9, 3.6299346362843685`*^9}, {3.62993551990188*^9, 
   3.6299355229457855`*^9}, {3.629936340077901*^9, 3.629936349224618*^9}, {
   3.6299365172409315`*^9, 3.62993652603285*^9}, {3.630202947315394*^9, 
   3.630203367556756*^9}, {3.630203751880745*^9, 3.6302037621786633`*^9}, {
   3.6302037989592285`*^9, 3.6302038071511436`*^9}, {3.630203839939402*^9, 
   3.630203890589692*^9}, {3.6303300061366024`*^9, 3.6303300318160715`*^9}, {
   3.6313350528542*^9, 3.631335053316707*^9}, {3.6318275349354877`*^9, 
   3.631827553040766*^9}, {3.6318275856262665`*^9, 3.6318277499787908`*^9}, {
   3.6318277829867973`*^9, 3.6318277990995455`*^9}, {3.6336504306760654`*^9, 
   3.6336506572885036`*^9}, {3.6336506942095747`*^9, 3.633650742872664*^9}, {
   3.6695307810349817`*^9, 3.6695309718614273`*^9}, {3.669579900852109*^9, 
   3.669579987992093*^9}, {3.669593927721108*^9, 3.6695940267987747`*^9}, {
   3.669839259742984*^9, 3.6698393341535196`*^9}, {3.6698394017679768`*^9, 
   3.669839442740054*^9}, {3.6698395022010007`*^9, 3.669839584901169*^9}, {
   3.6698396272036543`*^9, 3.669839679443956*^9}, {3.6710431072367277`*^9, 
   3.671043118297151*^9}, {3.6710431498888187`*^9, 3.671043153553627*^9}, {
   3.671321209835158*^9, 3.6713212146263666`*^9}, {3.671321251505637*^9, 
   3.671321267605068*^9}, {3.6713213047075367`*^9, 3.6713215167665663`*^9}, {
   3.67132164255451*^9, 3.6713217972267942`*^9}, {3.671324219085931*^9, 
   3.6713242492063932`*^9}, {3.6713245181605263`*^9, 3.671324907624008*^9}, 
   3.671324939489498*^9, {3.671324991380295*^9, 3.6713253089556723`*^9}, {
   3.6713756135009017`*^9, 3.671375619057911*^9}, {3.6713785591619196`*^9, 
   3.6713785667319326`*^9}, {3.671378646154108*^9, 3.6713788076174326`*^9}, {
   3.671378838491488*^9, 3.6713788518695097`*^9}, {3.671379084930932*^9, 
   3.6713790858209333`*^9}, {3.671379127187009*^9, 3.6713792554652414`*^9}, {
   3.671379400923545*^9, 3.671379402155547*^9}, {3.671379932400988*^9, 
   3.6713800306761847`*^9}, {3.671380107286331*^9, 3.6713801909664917`*^9}, {
   3.6713802493786097`*^9, 3.671380250020611*^9}, {3.6713802836856785`*^9, 
   3.671380435580968*^9}, {3.671381462198265*^9, 3.671381596326538*^9}, {
   3.67138164114962*^9, 3.6713816915217047`*^9}, {3.6713817605058403`*^9, 
   3.6713817849498806`*^9}, {3.671381903904108*^9, 3.6713820498723845`*^9}, {
   3.671382330526928*^9, 3.671382455238199*^9}, {3.6713825475284204`*^9, 
   3.6713826901516657`*^9}, {3.6713827624247932`*^9, 3.671383287472781*^9}, {
   3.671383341952903*^9, 3.6713833426729035`*^9}, {3.671383465932156*^9, 
   3.6713834773151765`*^9}, {3.67138354438433*^9, 3.6713835486193385`*^9}, {
   3.6713835842934113`*^9, 3.6713838031758127`*^9}, {3.671383862480932*^9, 
   3.671384083316369*^9}, {3.6713841377440667`*^9, 3.6713842081652355`*^9}, {
   3.671384259494336*^9, 3.6713844022626233`*^9}, {3.671384453169711*^9, 
   3.6713844534697113`*^9}, {3.671685508951892*^9, 3.6716855171737137`*^9}, {
   3.6716855944723024`*^9, 3.6716856076637316`*^9}, {3.6716859391195593`*^9, 
   3.671686029694344*^9}, {3.671686382552693*^9, 3.671686383114294*^9}, {
   3.6717413407126837`*^9, 3.6717413443696995`*^9}, {3.6717414699141855`*^9, 
   3.6717414933582783`*^9}, {3.671758957994608*^9, 3.6717590364786587`*^9}, {
   3.671759288102297*^9, 3.671759350393615*^9}, {3.671759449814612*^9, 
   3.6717594847880793`*^9}, {3.6717597123332214`*^9, 
   3.6717597125747213`*^9}, {3.6717662550993176`*^9, 
   3.6717662561153193`*^9}, {3.671900578618348*^9, 3.6719006029244456`*^9}, {
   3.671911219158656*^9, 3.6719112271593733`*^9}, 3.6719732047373495`*^9, {
   3.6719859092022495`*^9, 3.671986059131355*^9}, {3.671986122724991*^9, 
   3.67198613678242*^9}, {3.671986226162913*^9, 3.671986300093571*^9}, {
   3.671994909516223*^9, 3.671994950447564*^9}, {3.671995257586131*^9, 
   3.6719952821565366`*^9}, {3.671995344374095*^9, 3.6719955035461993`*^9}, {
   3.6719972832379923`*^9, 3.671997339695221*^9}, {3.6719973848798056`*^9, 
   3.6719973912091675`*^9}, {3.6719974739639006`*^9, 
   3.6719975101499705`*^9}, {3.6720242671119475`*^9, 3.6720242730820394`*^9}, 
   3.672024456267353*^9, {3.6720580038770237`*^9, 3.672058075185619*^9}, {
   3.6720598884924736`*^9, 3.672059956831023*^9}, {3.6720794284600215`*^9, 
   3.6720794308881607`*^9}, {3.6720794711324625`*^9, 3.672079647027523*^9}, {
   3.6720796791583605`*^9, 3.6720797274791245`*^9}, {3.6720797713856363`*^9, 
   3.6720799372391224`*^9}, {3.672157549715098*^9, 3.6721576173486366`*^9}, {
   3.672258204506383*^9, 3.6722582329910126`*^9}, {3.672260823929206*^9, 
   3.67226082663136*^9}, {3.672260859656249*^9, 3.672260880600447*^9}, {
   3.859455408615982*^9, 3.8594554500962706`*^9}, {3.8596007670529175`*^9, 
   3.859600767396989*^9}, {3.9749497795238047`*^9, 3.9749498370776243`*^9}, {
   3.974950092330571*^9, 3.974950111946562*^9}, {3.97495019366197*^9, 
   3.9749502164515643`*^9}, {3.974950326664037*^9, 3.9749503454873734`*^9}, {
   3.974950568694736*^9, 3.9749505873565993`*^9}, {3.974950631141804*^9, 
   3.974950631302135*^9}},ExpressionUUID->"bbc7e8be-9ed8-46b0-a763-\
805cc6e60749"]
}, Closed]],

Cell[CellGroupData[{

Cell["Attributes/Options/Mathematica Packages", "Subsection",
 CellChangeTimes->{{3.672681438275632*^9, 3.672681448704054*^9}, {
  3.71811586794244*^9, 
  3.7181158764039145`*^9}},ExpressionUUID->"ad34d706-e6c9-4ec1-a4a2-\
11f9f325835b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Tensor", " ", 
    RowBox[{"properties", "/", "options"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"Tensor", ",", "Orderless"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"MHDSystem", ",", "Orderless"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"SetAttributes", "[", 
      RowBox[{"TensorPlus", ",", "Orderless"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SetAttributes", "[", 
      RowBox[{"TensorPlusName", ",", "Orderless"}], "]"}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "Metric", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Coordinates", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{
       "TensorName", "\[Rule]", 
        "\"\<\!\(\*StyleBox[\"g\",FontSlant->\"Italic\"]\)\>\""}], ",", 
       RowBox[{"StartIndex", "\[Rule]", "0"}], ",", 
       RowBox[{"MetricOperator", "\[Rule]", "Simplify"}], ",", 
       RowBox[{"ChristoffelOperator", "\[Rule]", "Simplify"}], ",", 
       RowBox[{"RiemannOperator", "\[Rule]", "Simplify"}], ",", 
       RowBox[{"RicciOperator", "\[Rule]", "Simplify"}], ",", 
       RowBox[{"RicciScalarOperator", "\[Rule]", "Simplify"}], ",", 
       RowBox[{"TooltipStyle", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"TooltipDisplay", "\[Rule]", "Null"}], ",", 
       RowBox[{"FlatMetric", "\[Rule]", "Null"}], ",", 
       RowBox[{"OrthonormalFrameField", "\[Rule]", "Null"}], ",", 
       RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "Null"}], ",", 
       RowBox[{"OrthonormalFrameFieldOperator", "\[Rule]", "Simplify"}], ",", 
       RowBox[{"OrthonormalFrameFieldIndices", "\[Rule]", "Null"}], ",", 
       RowBox[{"TensorOperator", "\[Rule]", "Simplify"}], ",", 
       RowBox[{"TensorAssumption", "\[Rule]", " ", 
        RowBox[{"{", "}"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "Christoffel", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TooltipStyle", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"TooltipDisplay", "\[Rule]", "TensorComponents"}]}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "Riemann", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TooltipStyle", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"TooltipDisplay", "\[Rule]", "Null"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "Ricci", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TooltipStyle", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"TooltipDisplay", "\[Rule]", "Null"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "Einstein", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"EinsteinOperator", "\[Rule]", "Simplify"}], ",", 
       RowBox[{"TooltipStyle", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"TooltipDisplay", "\[Rule]", "Null"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "Weyl", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"WeylOperator", "\[Rule]", "Simplify"}], ",", 
       RowBox[{"TooltipStyle", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"TooltipDisplay", "\[Rule]", "Null"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "OrthonormalFrameField", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"OrthonormalFrameFieldOperator", "\[Rule]", "Simplify"}], ",", 
       RowBox[{"OrthonormalFrameField", "\[Rule]", "Null"}], ",", 
       RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "Null"}], ",", 
       RowBox[{"OrthonormalFrameFieldIndices", "\[Rule]", "Null"}], ",", 
       RowBox[{"FlatMetric", "\[Rule]", "Null"}], ",", 
       RowBox[{"OutputForm", "->", "Metric"}]}], "}"}]}], ";", 
    RowBox[{
     RowBox[{"Options", "[", "NonMetricTensor", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Coordinates", "->", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"StartIndex", "\[Rule]", "0"}], ",", 
       RowBox[{"TooltipDisplay", "\[Rule]", "Null"}], ",", 
       RowBox[{"TensorType", "\[Rule]", "Null"}], ",", 
       RowBox[{"TooltipStyle", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"TensorOperator", "\[Rule]", " ", "Simplify"}], ",", 
       RowBox[{"TensorAssumption", "\[Rule]", " ", 
        RowBox[{"{", "}"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "MHDSystem", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MHDOperator", "\[Rule]", "Simplify"}], ",", 
       RowBox[{"MetricSignature", "\[Rule]", "\"\<MostlyMinus\>\""}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "GeodesicSystem", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"AffineParameter", "\[Rule]", 
        RowBox[{"Unique", "[", "\[Lambda]1", "]"}]}], ",", 
       RowBox[{"NonAffineParameter", "\[Rule]", 
        RowBox[{"Unique", "[", "t1", "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "GeodesicSystemVariationalMethods", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"AffineParameter", "\[Rule]", 
        RowBox[{"Unique", "[", "\[Lambda]1", "]"}]}], ",", 
       RowBox[{"NonAffineParameter", "\[Rule]", 
        RowBox[{"Unique", "[", "t1", "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "GeodesicLagrangians", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"AffineParameter", "\[Rule]", 
        RowBox[{"Unique", "[", "\[Lambda]1", "]"}]}], ",", 
       RowBox[{"NonAffineParameter", "\[Rule]", 
        RowBox[{"Unique", "[", "t1", "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "CoordinateTransformation", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"CoordinateTransformationOperator", "\[Rule]", "Simplify"}], 
       ",", 
       RowBox[{
       "StartIndex", "\[Rule]", "\[Alpha]\[Beta]\[Gamma]\[Theta]\[Phi]"}], 
       ",", 
       RowBox[{"Indices", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"TensorName", "\[Rule]", "1234"}], ",", 
       RowBox[{"TooltipStyle", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"TooltipDisplay", "\[Rule]", "Null"}], ",", 
       RowBox[{"MetricOperator", "\[Rule]", "Simplify"}], ",", 
       RowBox[{"ChristoffelOperator", "\[Rule]", "Simplify"}], ",", 
       RowBox[{"RiemannOperator", "\[Rule]", "Simplify"}], ",", 
       RowBox[{"RicciOperator", "\[Rule]", "Simplify"}], ",", 
       RowBox[{"RicciScalarOperator", "\[Rule]", "Simplify"}]}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "LieD", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"LieDerivativeOperator", "\[Rule]", "Simplify"}], ",", 
       RowBox[{"TooltipStyle", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"TooltipDisplay", "\[Rule]", "Null"}], ",", 
       RowBox[{"Indices", "\[Rule]", "Null"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "LieBracket", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"LieDerivativeOperator", "\[Rule]", "Simplify"}], ",", 
       RowBox[{"LieBracketOperator", "\[Rule]", "Simplify"}], ",", 
       RowBox[{"TooltipStyle", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"TooltipDisplay", "\[Rule]", "Null"}], ",", 
       RowBox[{"Indices", "\[Rule]", "Null"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "SphericalHarmonicYTensor", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TooltipStyle", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"TooltipDisplay", "\[Rule]", "Null"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "VectorSphericalHarmonic", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Normalize", "\[Rule]", " ", "True"}], ",", 
       RowBox[{"TooltipStyle", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"TooltipDisplay", "\[Rule]", "Null"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "SymmetrizeIndices", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"SymmetrizeIndicesOperator", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{"#", "&"}], ")"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "AntiSymmetrizeIndices", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"AntiSymmetrizeIndicesOperator", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{"#", "&"}], ")"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "ZeroTensor", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Coordinates", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"TensorName", "->", "\"\<0\>\""}], ",", 
       RowBox[{"StartIndex", "\[Rule]", "0"}], ",", 
       RowBox[{"TooltipDisplay", "\[Rule]", "Null"}], ",", 
       RowBox[{"TensorType", "\[Rule]", "Null"}], ",", 
       RowBox[{"TooltipStyle", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"TensorOperator", "\[Rule]", " ", "Simplify"}], ",", 
       RowBox[{"TensorAssumption", "\[Rule]", " ", 
        RowBox[{"{", "}"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "ZeroTensorQ", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"ZeroTensorQOperator", "\[Rule]", " ", "Simplify"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "TensorDivision", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"TensorDivisionOperator", "\[Rule]", " ", "Simplify"}], "}"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "PotentialForm", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "TensorName", "\[Rule]", 
        "\"\<\!\(\*StyleBox[\"\[Beta]\",FontSlant->\"Italic\"]\)\>\""}], ",", 
       RowBox[{"StartingPoint", "->", "Null"}], ",", 
       RowBox[{"IntegrationVariable", "->", 
        RowBox[{"Unique", "[", "\[Lambda]1", "]"}]}], ",", 
       RowBox[{"TooltipDisplay", "->", "Null"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"MMA", " ", "Packages"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Needs", "[", "\"\<VariationalMethods`\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "ToTensorComponents", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"Coordinates", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "ElectromagneticStressEnergyTensor", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"MetricSignature", "\[Rule]", "\"\<MostlyMinus\>\""}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "OrthonormalFrameFieldQ", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"OutputForm", "->", "BooleanQ"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "TensorEquations", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"OutputForm", "->", "List"}], "}"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.518287025359375*^9, 3.518287083796875*^9}, {
   3.518287204515625*^9, 3.518287246046875*^9}, {3.518288154015625*^9, 
   3.518288179625*^9}, {3.5196834121875*^9, 3.519683417953125*^9}, {
   3.519689356625*^9, 3.519689356921875*^9}, {3.51976580715625*^9, 
   3.519765810671875*^9}, {3.519963432453125*^9, 3.519963433953125*^9}, 
   3.520125837828125*^9, {3.5201289498125*^9, 3.5201289504375*^9}, 
   3.520219859578125*^9, 3.5202268538125*^9, {3.52027377246875*^9, 
   3.520273831296875*^9}, {3.5202738760625*^9, 3.52027388446875*^9}, {
   3.5202739371875*^9, 3.5202741019375*^9}, {3.52027416353125*^9, 
   3.520274167671875*^9}, 3.520274919453125*^9, {3.52027495775*^9, 
   3.52027500990625*^9}, {3.520275109328125*^9, 3.52027513640625*^9}, {
   3.520275352625*^9, 3.520275353015625*^9}, {3.52027552415625*^9, 
   3.5202755711875*^9}, 3.520275790296875*^9, {3.5202759311875*^9, 
   3.520275948625*^9}, {3.520276746125*^9, 3.5202767880625*^9}, {
   3.52027692378125*^9, 3.52027700428125*^9}, {3.520277061046875*^9, 
   3.520277097125*^9}, {3.520277138046875*^9, 3.520277203125*^9}, {
   3.52027851596875*^9, 3.520278524*^9}, {3.52027856384375*^9, 
   3.520278653328125*^9}, 3.5202787563125*^9, {3.520279456296875*^9, 
   3.5202794635625*^9}, {3.520279561640625*^9, 3.520279567359375*^9}, {
   3.52028006315625*^9, 3.520280068671875*^9}, {3.5202804206875*^9, 
   3.520280495234375*^9}, 3.520281272765625*^9, {3.52028149878125*^9, 
   3.5202815018125*^9}, {3.520281674421875*^9, 3.5202816786875*^9}, {
   3.520281727390625*^9, 3.520281730375*^9}, 3.52028190265625*^9, {
   3.52028213190625*^9, 3.520282169640625*^9}, {3.520282364859375*^9, 
   3.520282395859375*^9}, {3.520282483109375*^9, 3.520282499046875*^9}, {
   3.52028567246875*^9, 3.520285695984375*^9}, {3.5202857606875*^9, 
   3.520285762578125*^9}, {3.520285792890625*^9, 3.520285807109375*^9}, {
   3.5202858616875*^9, 3.52028586721875*^9}, {3.520286964859375*^9, 
   3.520286985015625*^9}, {3.52028713909375*^9, 3.520287168453125*^9}, {
   3.52030002590625*^9, 3.520300043171875*^9}, {3.520300760625*^9, 
   3.520300806765625*^9}, {3.52030106778125*^9, 3.520301101625*^9}, {
   3.520301143203125*^9, 3.520301143921875*^9}, {3.520301203140625*^9, 
   3.520301219734375*^9}, {3.520301382671875*^9, 3.520301408375*^9}, {
   3.5203015531875*^9, 3.520301561859375*^9}, {3.52030160309375*^9, 
   3.52030162021875*^9}, {3.520301674546875*^9, 3.520301675078125*^9}, 
   3.520301885265625*^9, {3.52030235646875*^9, 3.5203024485*^9}, {
   3.52030252584375*^9, 3.520302587984375*^9}, {3.520302792015625*^9, 
   3.520302959515625*^9}, {3.520303101875*^9, 3.520303107296875*^9}, {
   3.520303238609375*^9, 3.52030324271875*^9}, 3.520303299859375*^9, {
   3.520303549375*^9, 3.52030358071875*^9}, {3.5203507715625*^9, 
   3.520350858640625*^9}, {3.520350918515625*^9, 3.520350918796875*^9}, {
   3.5203511166875*^9, 3.520351136140625*^9}, {3.520356764953125*^9, 
   3.520356884515625*^9}, {3.520371762125*^9, 3.5203718918125*^9}, {
   3.520378815359375*^9, 3.520378856375*^9}, {3.52037895428125*^9, 
   3.520378970015625*^9}, {3.5204389959375*^9, 3.52043945671875*^9}, {
   3.520439536453125*^9, 3.52043953984375*^9}, 3.520439581921875*^9, {
   3.520439654296875*^9, 3.520439710359375*^9}, {3.520439880765625*^9, 
   3.520439884828125*^9}, {3.520439970515625*^9, 3.52044004490625*^9}, {
   3.52044311690625*^9, 3.520443213734375*^9}, {3.520465048609375*^9, 
   3.5204650511875*^9}, {3.520626553671875*^9, 3.52062658471875*^9}, {
   3.52062668471875*^9, 3.52062670090625*^9}, {3.520626757234375*^9, 
   3.520626799984375*^9}, {3.520626907484375*^9, 3.52062701828125*^9}, {
   3.52069946446875*^9, 3.5206994743125*^9}, {3.520699970546875*^9, 
   3.52069998275*^9}, {3.520815631453125*^9, 3.520815642671875*^9}, {
   3.52087815671875*^9, 3.5208781575625*^9}, {3.52087819059375*^9, 
   3.520878191671875*^9}, {3.520878244578125*^9, 3.520878249421875*^9}, {
   3.520899545265625*^9, 3.520899552515625*^9}, {3.520956048171875*^9, 
   3.520956049203125*^9}, 3.520957443984375*^9, {3.521140458546875*^9, 
   3.52114045903125*^9}, {3.521146843921875*^9, 3.5211468451875*^9}, {
   3.521226495468966*^9, 3.5212267343908415`*^9}, {3.5212272990470915`*^9, 
   3.521227301906466*^9}, {3.521234889484375*^9, 3.52123490115625*^9}, 
   3.5212349964375*^9, 3.521235089015625*^9, 3.521235880828125*^9, 
   3.521236001265625*^9, 3.52123740409375*^9, 3.521237684734375*^9, 
   3.52123825221875*^9, 3.521247508625*^9, 3.52124811696875*^9, 
   3.521248740078125*^9, {3.521251276515625*^9, 3.5212512769375*^9}, {
   3.521252125328125*^9, 3.521252129109375*^9}, {3.52125512903125*^9, 
   3.52125513334375*^9}, {3.52134227965625*^9, 3.521342302765625*^9}, {
   3.521350247328125*^9, 3.5213502586875*^9}, {3.521479285640625*^9, 
   3.521479481234375*^9}, {3.521510402328125*^9, 3.52151042*^9}, {
   3.52151067996875*^9, 3.521510685546875*^9}, {3.521510730328125*^9, 
   3.521510739578125*^9}, {3.521510958453125*^9, 3.521510961984375*^9}, {
   3.521571634296875*^9, 3.521571802671875*^9}, {3.521572707796875*^9, 
   3.521572848953125*^9}, {3.52166992121875*^9, 3.521670375828125*^9}, {
   3.521671400609375*^9, 3.521671468921875*^9}, {3.52167190478125*^9, 
   3.521671956046875*^9}, {3.521672654796875*^9, 3.521672663921875*^9}, {
   3.52167419490625*^9, 3.521674311921875*^9}, {3.521674723703125*^9, 
   3.52167473009375*^9}, {3.521698277296875*^9, 3.521698278296875*^9}, {
   3.52170295315625*^9, 3.521703048328125*^9}, {3.521734163609375*^9, 
   3.521734164296875*^9}, {3.5217404766875*^9, 3.521740477390625*^9}, {
   3.521757871828125*^9, 3.52175808225*^9}, {3.52175824334375*^9, 
   3.521758489984375*^9}, {3.5217585360625*^9, 3.52175861346875*^9}, {
   3.5217598483125*^9, 3.521759928390625*^9}, {3.52175996796875*^9, 
   3.52176025784375*^9}, {3.521760292078125*^9, 3.52176030628125*^9}, {
   3.5217651831875*^9, 3.521765221421875*^9}, {3.52176535990625*^9, 
   3.52176541146875*^9}, {3.52178529415625*^9, 3.521785357515625*^9}, {
   3.521787816203125*^9, 3.5217878181875*^9}, {3.521910257296875*^9, 
   3.521910279484375*^9}, {3.521910354734375*^9, 3.52191037071875*^9}, {
   3.521953189171875*^9, 3.5219535383125*^9}, {3.5219541266875*^9, 
   3.521954167859375*^9}, {3.522528068484375*^9, 3.52252807225*^9}, {
   3.533879884589926*^9, 3.5338799579256544`*^9}, {3.5391957298212233`*^9, 
   3.539195980472576*^9}, {3.5391960243210382`*^9, 3.5391960252110395`*^9}, {
   3.5394613785048385`*^9, 3.5394614644453897`*^9}, {3.539551377786018*^9, 
   3.5395513832616277`*^9}, {3.5395518179563913`*^9, 3.539551821497597*^9}, {
   3.5395518826029043`*^9, 3.539551883024105*^9}, {3.539552087680865*^9, 
   3.5395520916276717`*^9}, {3.5396160218156214`*^9, 
   3.5396160594740877`*^9}, {3.539616108785774*^9, 3.5396164138287096`*^9}, {
   3.5760901684770727`*^9, 3.576090494096444*^9}, {3.576090533470914*^9, 
   3.5760905336737137`*^9}, {3.576093700198476*^9, 3.5760938477747345`*^9}, {
   3.5766864493342285`*^9, 3.5766870372680607`*^9}, {3.5766870775317316`*^9, 
   3.576687119012204*^9}, {3.5837901145639615`*^9, 3.5837902223701277`*^9}, {
   3.606329333933484*^9, 3.606329375050616*^9}, {3.6064202232098227`*^9, 
   3.6064202685464163`*^9}, {3.6064204122876377`*^9, 3.606420456448163*^9}, {
   3.606491800762127*^9, 3.606491850775815*^9}, {3.606492069990939*^9, 
   3.606492143879165*^9}, {3.6064921763380213`*^9, 3.6064922572346487`*^9}, {
   3.6064923297627974`*^9, 3.6064923299818096`*^9}, {3.606492370603133*^9, 
   3.606492371219168*^9}, {3.6064961691193953`*^9, 3.6064961915836806`*^9}, {
   3.6064975285121484`*^9, 3.606497546217161*^9}, {3.6065035977871275`*^9, 
   3.606503646715926*^9}, {3.6065063001198483`*^9, 3.606506471837719*^9}, {
   3.606513240603368*^9, 3.6065132547171745`*^9}, {3.60651331827781*^9, 
   3.606513466271275*^9}, {3.6065743279396286`*^9, 3.6065743313716345`*^9}, {
   3.6065760454249916`*^9, 3.60657607740182*^9}, {3.6096134581867433`*^9, 
   3.6096134860795927`*^9}, {3.6096142872189994`*^9, 3.609614335438684*^9}, {
   3.6294774407514944`*^9, 3.6294774906015644`*^9}, {3.62947757779919*^9, 
   3.629477783009477*^9}, {3.629477825719537*^9, 3.6294778347395496`*^9}, {
   3.6294778894696264`*^9, 3.62947797075974*^9}, {3.6294780589298635`*^9, 
   3.6294780596998644`*^9}, {3.629478098129918*^9, 3.6294782395501165`*^9}, {
   3.6294782867201824`*^9, 3.6294783055702085`*^9}, {3.629478455970419*^9, 
   3.6294784946804733`*^9}, {3.6294785317405252`*^9, 
   3.6294785570705605`*^9}, {3.6294803157822976`*^9, 3.629480339682331*^9}, {
   3.6296556131724815`*^9, 3.629655647025541*^9}, {3.629655677321794*^9, 
   3.6296556859360094`*^9}, {3.629697278543481*^9, 3.6296973521750107`*^9}, {
   3.6296977113732457`*^9, 3.629697784256974*^9}, {3.6297631878993664`*^9, 
   3.629763353830789*^9}, {3.629763719443343*^9, 3.6297637226415515`*^9}, {
   3.6297637935867133`*^9, 3.6297638430924325`*^9}, {3.629908800590377*^9, 
   3.629908989442511*^9}, {3.6299090230303698`*^9, 3.6299090238727713`*^9}, {
   3.6299332867334347`*^9, 3.6299332984178553`*^9}, {3.629933337870325*^9, 
   3.6299333851852083`*^9}, {3.6299334939797993`*^9, 
   3.6299334981932344`*^9}, {3.6299337870972757`*^9, 3.629933817049328*^9}, {
   3.6299338759082317`*^9, 3.629933878092235*^9}, {3.629933931892765*^9, 
   3.6299339794572487`*^9}, {3.629934090482643*^9, 3.6299342367017*^9}, {
   3.629934623053544*^9, 3.6299346362843685`*^9}, {3.62993551990188*^9, 
   3.6299355229457855`*^9}, {3.629936340077901*^9, 3.629936349224618*^9}, {
   3.6299365172409315`*^9, 3.62993652603285*^9}, {3.630202947315394*^9, 
   3.630203367556756*^9}, {3.630203751880745*^9, 3.6302037621786633`*^9}, {
   3.6302037989592285`*^9, 3.6302038071511436`*^9}, {3.630203839939402*^9, 
   3.630203890589692*^9}, {3.6303300061366024`*^9, 3.6303300318160715`*^9}, {
   3.6313350528542*^9, 3.631335053316707*^9}, {3.6318275349354877`*^9, 
   3.631827553040766*^9}, {3.6318275856262665`*^9, 3.6318277499787908`*^9}, {
   3.6318277829867973`*^9, 3.6318277990995455`*^9}, {3.6336504306760654`*^9, 
   3.6336506572885036`*^9}, {3.6336506942095747`*^9, 3.633650742872664*^9}, {
   3.6695307810349817`*^9, 3.6695309718614273`*^9}, {3.669579900852109*^9, 
   3.669579987992093*^9}, {3.669593927721108*^9, 3.6695940267987747`*^9}, {
   3.669839259742984*^9, 3.6698393341535196`*^9}, {3.6698394017679768`*^9, 
   3.669839442740054*^9}, {3.6698395022010007`*^9, 3.669839584901169*^9}, {
   3.6698396272036543`*^9, 3.669839679443956*^9}, {3.6710431072367277`*^9, 
   3.671043118297151*^9}, {3.6710431498888187`*^9, 3.671043153553627*^9}, {
   3.671321209835158*^9, 3.6713212146263666`*^9}, {3.671321251505637*^9, 
   3.671321267605068*^9}, {3.6713213047075367`*^9, 3.6713215167665663`*^9}, {
   3.67132164255451*^9, 3.6713217972267942`*^9}, {3.671324219085931*^9, 
   3.6713242492063932`*^9}, {3.6713245181605263`*^9, 3.671324907624008*^9}, 
   3.671324939489498*^9, {3.671324991380295*^9, 3.6713253089556723`*^9}, {
   3.6713756135009017`*^9, 3.671375619057911*^9}, {3.6713785591619196`*^9, 
   3.6713785667319326`*^9}, {3.671378646154108*^9, 3.6713788076174326`*^9}, {
   3.671378838491488*^9, 3.6713788518695097`*^9}, {3.671379084930932*^9, 
   3.6713790858209333`*^9}, {3.671379127187009*^9, 3.6713792554652414`*^9}, {
   3.671379400923545*^9, 3.671379402155547*^9}, {3.671379932400988*^9, 
   3.6713800306761847`*^9}, {3.671380107286331*^9, 3.6713801909664917`*^9}, {
   3.6713802493786097`*^9, 3.671380250020611*^9}, {3.6713802836856785`*^9, 
   3.671380435580968*^9}, {3.671381462198265*^9, 3.671381596326538*^9}, {
   3.67138164114962*^9, 3.6713816915217047`*^9}, {3.6713817605058403`*^9, 
   3.6713817849498806`*^9}, {3.671381903904108*^9, 3.6713820498723845`*^9}, {
   3.671382330526928*^9, 3.671382455238199*^9}, {3.6713825475284204`*^9, 
   3.6713826901516657`*^9}, {3.6713827624247932`*^9, 3.671383287472781*^9}, {
   3.671383341952903*^9, 3.6713833426729035`*^9}, {3.671383465932156*^9, 
   3.6713834773151765`*^9}, {3.67138354438433*^9, 3.6713835486193385`*^9}, {
   3.6713835842934113`*^9, 3.6713838031758127`*^9}, {3.671383862480932*^9, 
   3.671384083316369*^9}, {3.6713841377440667`*^9, 3.6713842081652355`*^9}, {
   3.671384259494336*^9, 3.6713844022626233`*^9}, {3.671384453169711*^9, 
   3.6713844534697113`*^9}, {3.671685508951892*^9, 3.6716855171737137`*^9}, {
   3.6716855944723024`*^9, 3.6716856076637316`*^9}, {3.6716859391195593`*^9, 
   3.671686029694344*^9}, {3.671686382552693*^9, 3.671686383114294*^9}, {
   3.6717413407126837`*^9, 3.6717413443696995`*^9}, {3.6717414699141855`*^9, 
   3.6717414933582783`*^9}, {3.671758957994608*^9, 3.6717590364786587`*^9}, {
   3.671759288102297*^9, 3.671759350393615*^9}, {3.671759449814612*^9, 
   3.6717594847880793`*^9}, {3.6717597123332214`*^9, 
   3.6717597125747213`*^9}, {3.6717662550993176`*^9, 
   3.6717662561153193`*^9}, {3.671900578618348*^9, 3.6719006029244456`*^9}, {
   3.671911219158656*^9, 3.6719112271593733`*^9}, {3.6719732047373495`*^9, 
   3.6719732346119165`*^9}, {3.671995939819153*^9, 3.6719959692038336`*^9}, {
   3.6722324308385067`*^9, 3.672232432223528*^9}, {3.672232569303133*^9, 
   3.672232572420681*^9}, {3.7181157560094833`*^9, 3.71811575841288*^9}, {
   3.718115844428811*^9, 3.718115864426034*^9}, {3.7181167933141174`*^9, 
   3.7181168116070356`*^9}, {3.7181170257554364`*^9, 3.718117039062437*^9}, {
   3.7181170961555586`*^9, 3.7181171211734743`*^9}, {3.7181171936859355`*^9, 
   3.7181171958699427`*^9}, {3.7181172338467407`*^9, 
   3.7181172390306425`*^9}, {3.7181681299598155`*^9, 3.718168131758211*^9}, {
   3.7188730687248526`*^9, 3.7188730949039564`*^9}, {3.7188741572225513`*^9, 
   3.7188741657783065`*^9}, {3.7277847699803953`*^9, 3.7277848065097*^9}, {
   3.781003023198018*^9, 3.7810030235061936`*^9}, {3.7810053974795904`*^9, 
   3.7810053982555656`*^9}, {3.791378142378893*^9, 3.79137818122291*^9}, {
   3.8135320645573673`*^9, 3.8135320921455812`*^9}, {3.8135321504995637`*^9, 
   3.81353216517237*^9}, {3.827402803841505*^9, 3.827402830986506*^9}, {
   3.82740336161316*^9, 3.8274033709911184`*^9}, {3.8284102154268746`*^9, 
   3.828410237114087*^9}, {3.8284104093400855`*^9, 3.828410409445087*^9}, 
   3.829429371295764*^9, {3.829434082092366*^9, 3.8294341099600954`*^9}, {
   3.8303414108486323`*^9, 3.830341411843004*^9}, {3.8314399777494774`*^9, 
   3.831439978389352*^9}, {3.831677861439806*^9, 3.8316778674846497`*^9}, 
   3.8316779064507275`*^9, {3.8341795749993267`*^9, 3.834179603278328*^9}, {
   3.836476047095024*^9, 3.8364760475777674`*^9}, {3.838183480014862*^9, 
   3.838183480524811*^9}, {3.838185190645543*^9, 3.8381852474840517`*^9}, {
   3.8392944784803658`*^9, 3.839294491920397*^9}, {3.839295934562344*^9, 
   3.839295959324132*^9}, 3.8407642074910684`*^9, 3.8424027143268814`*^9, 
   3.842403126463729*^9, {3.843083629245039*^9, 3.8430836306061897`*^9}, {
   3.843083780668081*^9, 3.843083800594717*^9}, 3.8430838494114237`*^9, {
   3.8439529838744183`*^9, 3.8439529843587875`*^9}, {3.8477933711176815`*^9, 
   3.847793449080078*^9}, {3.8478361809076033`*^9, 3.847836205011715*^9}, {
   3.847838023514019*^9, 3.847838089737734*^9}, {3.847838423356592*^9, 
   3.8478384884747944`*^9}, {3.847846761343003*^9, 3.8478467871501265`*^9}, {
   3.847846822848173*^9, 3.847846845743091*^9}, {3.8478469372787867`*^9, 
   3.8478469662859483`*^9}, 3.8479656495691447`*^9, {3.8540779921374187`*^9, 
   3.854078023217332*^9}, 3.8540780536770935`*^9, {3.854079105572745*^9, 
   3.854079107168346*^9}, 3.8540797340128565`*^9, 3.8540819066255045`*^9, {
   3.8541585288325443`*^9, 3.8541585459082236`*^9}, 3.854158763837405*^9, {
   3.8594544786104035`*^9, 3.859454484034376*^9}, {3.8594548034330683`*^9, 
   3.8594548226893473`*^9}, {3.859455191721946*^9, 3.8594552192749624`*^9}, {
   3.8594559412494965`*^9, 3.859455944978319*^9}, {3.8594622985089865`*^9, 
   3.8594623070421057`*^9}, {3.8594643176741376`*^9, 
   3.8594643583559628`*^9}, {3.859464436819172*^9, 3.8594644371616907`*^9}, 
   3.8595025444506474`*^9, {3.859507514793906*^9, 3.8595075210340347`*^9}, {
   3.859507586694316*^9, 3.859507592414768*^9}, {3.8595123478607044`*^9, 
   3.859512358096125*^9}, 3.8596008312989244`*^9, 3.860671183954074*^9, {
   3.8611397658410015`*^9, 3.861139766161374*^9}, {3.861144358911488*^9, 
   3.8611443666816826`*^9}, {3.8611444657515326`*^9, 
   3.8611444661115932`*^9}, {3.8613321464734373`*^9, 3.8613321584010954`*^9}, 
   3.8625409920435157`*^9, 3.8657220040987463`*^9, {3.8667178694717054`*^9, 
   3.86671793412029*^9}, {3.867313669629397*^9, 3.867313678259658*^9}, {
   3.873420047206176*^9, 3.873420049187497*^9}, {3.8750943741005344`*^9, 
   3.8750944411844597`*^9}, {3.8847704900019555`*^9, 3.884770516344298*^9}, {
   3.884771523316414*^9, 3.8847715321154785`*^9}, {3.8847715732632475`*^9, 
   3.88477159990942*^9}, {3.8847727177085032`*^9, 3.8847727440036807`*^9}, {
   3.885375448199168*^9, 3.885375448794793*^9}, {3.885382694200553*^9, 
   3.8853827056085205`*^9}, {3.885422755083685*^9, 3.8854227917193413`*^9}, {
   3.8865697257520494`*^9, 3.88656973210915*^9}, {3.8865697631409874`*^9, 
   3.886569826515701*^9}, {3.88657070498269*^9, 3.886570725482691*^9}, {
   3.88673471013857*^9, 3.886734730930822*^9}, {3.886738228674123*^9, 
   3.886738406465705*^9}, 3.8867400912902613`*^9, {3.887112096796203*^9, 
   3.8871121140007734`*^9}, {3.889052409668887*^9, 3.8890524527003555`*^9}, {
   3.890181833690528*^9, 3.8901818673836265`*^9}, {3.8901899618764563`*^9, 
   3.8901899674696894`*^9}, {3.8915730985639453`*^9, 3.891573098973691*^9}, {
   3.8915734065666995`*^9, 3.891573408291646*^9}, {3.891574012321288*^9, 
   3.891574014824758*^9}, 3.8915740513632116`*^9, 3.891579741883506*^9, 
   3.8915801783582296`*^9, 3.8915871526433063`*^9, {3.893153485880587*^9, 
   3.893153506266393*^9}, 3.8947759518829365`*^9, {3.8947763291669407`*^9, 
   3.894776340033222*^9}, {3.8955450682755203`*^9, 3.8955450932365265`*^9}, 
   3.895549065613738*^9, {3.8987253764800773`*^9, 3.8987253776141005`*^9}, {
   3.955680711173623*^9, 3.955680711174163*^9}, {3.956199042418846*^9, 
   3.956199042421667*^9}, {3.959934042237623*^9, 3.959934053043009*^9}, {
   3.967162646417083*^9, 3.967162656864685*^9}, {3.967777451544225*^9, 
   3.9677774515517807`*^9}, 3.970693629901286*^9, 3.97088646429998*^9, {
   3.9708868038054953`*^9, 3.970886837090034*^9}, 3.971052948161791*^9, 
   3.971085631649205*^9, 3.971087532036826*^9, 3.9712299672446337`*^9, 
   3.971747537146933*^9, {3.971753110855022*^9, 3.971753111241509*^9}, {
   3.971753210867416*^9, 3.971753211050297*^9}, 3.9723771103331842`*^9, 
   3.972466463038907*^9, 3.972543442796031*^9, {3.973220944475625*^9, 
   3.973220946897623*^9}, {3.9732214004371758`*^9, 3.9732214381236134`*^9}, 
   3.973221532829224*^9, 3.973633954511105*^9, {3.9736340929336967`*^9, 
   3.973634096788336*^9}, {3.973634231166697*^9, 3.973634232622283*^9}, 
   3.973720943581778*^9, {3.9737653451502666`*^9, 3.973765345152321*^9}, {
   3.973765491876967*^9, 3.973765491878704*^9}, {3.973765545934382*^9, 
   3.9737655642047462`*^9}, {3.9749497795368195`*^9, 3.974949779538828*^9}, {
   3.975296607536933*^9, 3.9752966161919117`*^9}, {3.9752975097228856`*^9, 
   3.975297532858571*^9}, {3.97529818528074*^9, 3.9752982030942783`*^9}, {
   3.975298339242752*^9, 3.975298352978732*^9}, {3.975305841642291*^9, 
   3.975306100414658*^9}, {3.975306191614855*^9, 
   3.975306191990252*^9}},ExpressionUUID->"51d6a053-8ea8-4cc2-8ca7-\
ea9976cc4174"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Start Private here", "Section",
 CellChangeTimes->{{3.52030335396875*^9, 3.52030336065625*^9}, {
  3.520440577734375*^9, 
  3.52044059371875*^9}},ExpressionUUID->"72db2963-df8b-47c5-afb6-\
fc5119094b1d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.518287025359375*^9, 3.518287083796875*^9}, {
   3.518287204515625*^9, 3.518287246046875*^9}, {3.518288154015625*^9, 
   3.518288179625*^9}, {3.5196834121875*^9, 3.519683417953125*^9}, {
   3.519689356625*^9, 3.519689356921875*^9}, {3.51976580715625*^9, 
   3.519765810671875*^9}, {3.519963432453125*^9, 3.519963433953125*^9}, 
   3.520125837828125*^9, {3.5201289498125*^9, 3.5201289504375*^9}, 
   3.520219859578125*^9, 3.5202268538125*^9, {3.52027377246875*^9, 
   3.520273831296875*^9}, {3.5202738760625*^9, 3.52027388446875*^9}, {
   3.5202739371875*^9, 3.5202741019375*^9}, {3.52027416353125*^9, 
   3.520274167671875*^9}, 3.520274919453125*^9, {3.52027495775*^9, 
   3.52027500990625*^9}, {3.520275109328125*^9, 3.52027513640625*^9}, {
   3.520275352625*^9, 3.520275353015625*^9}, {3.52027552415625*^9, 
   3.5202755711875*^9}, 3.520275790296875*^9, {3.5202759311875*^9, 
   3.520275948625*^9}, {3.520276746125*^9, 3.5202767880625*^9}, {
   3.52027692378125*^9, 3.52027700428125*^9}, {3.520277061046875*^9, 
   3.520277097125*^9}, {3.520277138046875*^9, 3.520277203125*^9}, {
   3.52027851596875*^9, 3.520278524*^9}, {3.52027856384375*^9, 
   3.520278653328125*^9}, 3.5202787563125*^9, {3.520279456296875*^9, 
   3.5202794635625*^9}, {3.520279561640625*^9, 3.520279567359375*^9}, {
   3.52028006315625*^9, 3.520280068671875*^9}, {3.5202804206875*^9, 
   3.520280495234375*^9}, 3.520281272765625*^9, {3.52028149878125*^9, 
   3.5202815018125*^9}, {3.520281674421875*^9, 3.5202816786875*^9}, {
   3.520281727390625*^9, 3.520281730375*^9}, 3.52028190265625*^9, {
   3.52028213190625*^9, 3.520282169640625*^9}, {3.520282364859375*^9, 
   3.520282395859375*^9}, {3.520282483109375*^9, 3.520282499046875*^9}, {
   3.52028567246875*^9, 3.520285695984375*^9}, {3.5202857606875*^9, 
   3.520285762578125*^9}, {3.520285792890625*^9, 3.520285807109375*^9}, {
   3.5202858616875*^9, 3.52028586721875*^9}, {3.520286964859375*^9, 
   3.520286985015625*^9}, {3.52028713909375*^9, 3.520287168453125*^9}, {
   3.52030002590625*^9, 3.520300043171875*^9}, {3.520300760625*^9, 
   3.520300806765625*^9}, {3.52030106778125*^9, 3.520301101625*^9}, {
   3.520301143203125*^9, 3.520301143921875*^9}, {3.520301203140625*^9, 
   3.520301219734375*^9}, {3.520301382671875*^9, 3.520301408375*^9}, {
   3.5203015531875*^9, 3.520301561859375*^9}, {3.52030160309375*^9, 
   3.52030162021875*^9}, {3.520301674546875*^9, 3.520301675078125*^9}, 
   3.520301885265625*^9, {3.52030235646875*^9, 3.5203024485*^9}, {
   3.52030252584375*^9, 3.520302587984375*^9}, {3.520302792015625*^9, 
   3.520302959515625*^9}, {3.520303101875*^9, 3.520303107296875*^9}, {
   3.520303238609375*^9, 3.52030324271875*^9}, {3.520303299859375*^9, 
   3.52030330771875*^9}},ExpressionUUID->"918b4003-dc65-445a-bb4c-\
a29a22fcd1b5"]
}, Closed]],

Cell[CellGroupData[{

Cell["Internal Programming Tools", "Section",
 CellChangeTimes->{{3.520303364296875*^9, 
  3.52030337496875*^9}},ExpressionUUID->"a50d09e8-2ca3-4c82-8198-\
485591f2ec8e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "check", " ", "if", " ", "\[Mu]", " ", "is", " ", "an", " ", "index"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TestIndices", "[", "\[Mu]_", "]"}], ":=", 
     RowBox[{"MatchQ", "[", 
      RowBox[{"\[Mu]", ",", 
       RowBox[{
        RowBox[{"SuperMinus", "[", "_Integer", "]"}], "|", 
        RowBox[{"SuperMinus", "[", "_Symbol", "]"}], "|", 
        RowBox[{"SubMinus", "[", "_Integer", "]"}], "|", 
        RowBox[{"SubMinus", "[", "_Symbol", "]"}], "|", 
        RowBox[{"SuperMinus", "[", 
         RowBox[{"OverHat", "[", "_Integer", "]"}], "]"}], "|", 
        RowBox[{"SuperMinus", "[", 
         RowBox[{"OverHat", "[", "_Symbol", "]"}], "]"}], "|", 
        RowBox[{"SubMinus", "[", 
         RowBox[{"OverHat", "[", "_Integer", "]"}], "]"}], "|", 
        RowBox[{"SubMinus", "[", 
         RowBox[{"OverHat", "[", "_Symbol", "]"}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Sgn", "[", 
       SuperscriptBox["\[Mu]", "-"], "]"}], " ", "gives"}], " ", "+", 
     RowBox[{"1", " ", "and", " ", 
      RowBox[{"Sgn", "[", 
       SubscriptBox["\[Mu]", "-"], "]"}], " ", "gives"}], " ", "-", 
     RowBox[{
     "1", " ", "provided", " ", "they", " ", "are", " ", "actual", " ", 
      RowBox[{"indices", " ", "--"}], " ", "as", " ", "defined", " ", "by", 
      " ", "TestIndices", " ", "above"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Sgn", "[", "\[Mu]_", "]"}], ":=", 
     RowBox[{
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"upper", " ", "index"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{"\[Mu]", ",", 
          RowBox[{"SuperMinus", "[", "_", "]"}]}], "]"}], ",", "1", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"lower", " ", "index"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"MatchQ", "[", 
         RowBox[{"\[Mu]", ",", 
          RowBox[{"SubMinus", "[", "_", "]"}]}], "]"}], ",", 
        RowBox[{"-", "1"}]}], "\[IndentingNewLine]", "]"}], "/;", 
      RowBox[{"TestIndices", "[", "\[Mu]", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"IndexNumber", "[", 
      SuperscriptBox["\[Mu]", "-"], "]"}], " ", "or", " ", 
     RowBox[{"IndexNumber", "[", 
      SubscriptBox["\[Mu]", "-"], "]"}], " ", "returns", " ", "\[Mu]", " ", 
     "provided", " ", "they", " ", "are", " ", "actual", " ", 
     RowBox[{"indices", " ", "--"}], " ", "as", " ", "defined", " ", "by", 
     " ", "TestIndices", " ", "above"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"IndexNumber", "[", "\[Mu]_", "]"}], ":=", 
     RowBox[{
      RowBox[{"\[Mu]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
       "/;", 
      RowBox[{"TestIndices", "[", "\[Mu]", "]"}]}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"For", " ", "any", " ", "\[Mu]"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"UpOrDown", "[", 
       SuperscriptBox["\[Mu]", "-"], "]"}], " ", "returns", " ", 
      RowBox[{"Column", "[", 
       RowBox[{"{", 
        RowBox[{"\[Mu]", ",", "Null"}], "}"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"i", ".", "e", ".", " ", "upper"}], " ", "index"}]}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"UpOrDown", "[", 
       SubscriptBox["\[Mu]", "-"], "]"}], " ", "returns", " ", 
      RowBox[{"Column", "[", 
       RowBox[{"{", 
        RowBox[{"Null", ",", "\[Mu]"}], "}"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"i", ".", "e", ".", " ", "lower"}], " ", "index"}]}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"UpOrDown", "[", "\[Mu]_", "]"}], ":=", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"lower", " ", "index"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"\[Mu]", ",", 
         RowBox[{"SubMinus", "[", "_", "]"}]}], "]"}], ",", 
       RowBox[{"Column", "[", 
        RowBox[{"{", 
         RowBox[{"Null", ",", 
          RowBox[{
          "\[Mu]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "}"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"upper", " ", "index"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"MatchQ", "[", 
        RowBox[{"\[Mu]", ",", 
         RowBox[{"SuperMinus", "[", "_", "]"}]}], "]"}], ",", 
       RowBox[{"Column", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "\[Mu]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          ",", "Null"}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"ReplaceIndex", "[", 
      RowBox[{"\[Nu]", ",", 
       SubscriptBox["\[Mu]", "-"]}], "]"}], " ", "returns", " ", 
     SubscriptBox["\[Nu]", "-"], " ", "and", " ", 
     RowBox[{"ReplaceIndex", "[", 
      RowBox[{"\[Nu]", ",", 
       SuperscriptBox["\[Mu]", "-"]}], "]"}], " ", "returns", " ", 
     SuperscriptBox["\[Nu]", "-"], " ", "provided", " ", 
     RowBox[{"(", "I", ")"}], " ", "\[Nu]", " ", "is", " ", "either", " ", 
     "Integer", " ", "or", " ", "Symbol", " ", "and", " ", 
     RowBox[{"(", "II", ")"}], " ", "the", " ", 
     RowBox[{"\[Mu]", "'"}], "s", " ", "are", " ", "actual", " ", 
     RowBox[{"indices", " ", "--"}], " ", "as", " ", "defined", " ", "by", 
     " ", "TestIndices", " ", "above"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Here", " ", "we", " ", 
      RowBox[{"don", "'"}], "t", " ", "need", " ", "to", " ", "specify", " ", 
      "SuperMinus", " ", 
      RowBox[{"(", "up", ")"}], " ", "or", " ", "SubMinus", " ", 
      RowBox[{"(", "down", ")"}], " ", "on", " ", "\[Nu]"}], ";", " ", 
     RowBox[{
     "next", " ", "we", " ", "will", " ", "treat", " ", "the", " ", "case", 
      " ", "where", " ", "\[Nu]", " ", "is", " ", "also", " ", "an", " ", 
      "true", " ", "index"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ReplaceIndex", "[", 
      RowBox[{
       RowBox[{"\[Nu]_", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Head", "[", "\[Nu]", "]"}], "===", "Symbol"}], ")"}], "||", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Head", "[", "\[Nu]", "]"}], "===", "Integer"}], ")"}]}], 
         ")"}]}], ",", 
       RowBox[{"\[Mu]_", "/;", 
        RowBox[{"TestIndices", "[", "\[Mu]", "]"}]}]}], "]"}], ":=", 
     RowBox[{"\[Nu]", "//", 
      RowBox[{
      "\[Mu]", "\[LeftDoubleBracket]", "0", "\[RightDoubleBracket]"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"ReplaceIndex", "[", 
      RowBox[{"\[Nu]", ",", "\[Mu]"}], "]"}], " ", "takes", " ", "in", " ", 
     "index", " ", "\[Mu]", " ", "and", " ", "index", " ", "\[Nu]", " ", 
     "and", " ", "returns", " ", "index", " ", "\[Nu]", " ", "but", " ", 
     "inheriting", " ", "the", " ", 
     RowBox[{"position", " ", "--"}], " ", "SuperMinus", " ", "or", " ", 
     RowBox[{"SubMinus", " ", "--"}], " ", "of", " ", "\[Mu]"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Note", ":", " ", 
     RowBox[{
     "This", " ", "takes", " ", "care", " ", "of", " ", "OverHat", " ", 
      "indices"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ReplaceIndex", "[", 
      RowBox[{
       RowBox[{"\[Nu]_", "/;", 
        RowBox[{"TestIndices", "[", "\[Nu]", "]"}]}], ",", 
       RowBox[{"\[Mu]_", "/;", 
        RowBox[{"TestIndices", "[", "\[Mu]", "]"}]}]}], "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
       "\[Nu]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "//", 
       RowBox[{
       "\[Mu]", "\[LeftDoubleBracket]", "0", "\[RightDoubleBracket]"}]}], 
      ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"NumericIndex", "[", 
       RowBox[{"\[Mu]I", ",", "cooo", ",", "st"}], "]"}], " ", "returns", " ", 
      SuperscriptBox["#", "-"], " ", "or", " ", 
      SubscriptBox["#", "-"], " ", "given", " ", "coordinates", " ", "cooo", 
      " ", "and", " ", "StartIndex", " ", "st"}], ",", " ", 
     RowBox[{
     "where", " ", "#", " ", "is", " ", "the", " ", "appropriate", " ", 
      "index", " ", "number"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "if", " ", "the", " ", "\[Mu]I", " ", "is", " ", "just", " ", "a", " ", 
      "Symbol", " ", 
      RowBox[{"w", "/", "o"}], " ", "any", " ", "other", " ", "meaning"}], 
     ",", " ", 
     RowBox[{"it", " ", "will", " ", "be", " ", "returned", " ", "as", " ", 
      RowBox[{"is", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "if", " ", "\[Mu]I", " ", "is", " ", "an", " ", "OverHat", " ", "index", 
     " ", "it", " ", "will", " ", "be", " ", "returned", " ", "as", " ", 
     RowBox[{"is", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestOverHatIndex", "[", "\[Mu]I_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{
         "\[Mu]I", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}], "===", "OverHat"}], ")"}], "&&", 
      RowBox[{"(", 
       RowBox[{"TestIndices", "[", "\[Mu]I", "]"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NumericIndex", "[", 
     RowBox[{
      RowBox[{"\[Mu]I_", "/;", 
       RowBox[{"TestIndices", "[", "\[Mu]I", "]"}]}], ",", "cooo_List", ",", 
      "st_Integer"}], "]"}], ":=", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{"TestOverHatIndex", "[", "\[Mu]I", "]"}], ",", "\[Mu]I", ",", 
      "True", ",", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"if", " ", 
         RowBox[{"it", "'"}], "s", " ", "already", " ", "an", " ", "Integer", 
         " ", "then", " ", "just", " ", "return", " ", "itself"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", 
          RowBox[{
          "\[Mu]I", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "]"}], "===", "Integer"}], ",", "\[Mu]I", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "if", " ", "it", " ", "is", " ", "one", " ", "of", " ", "the", " ", 
          "coordinates", " ", "return", " ", "the", " ", "Position"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Intersection", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\[Mu]I", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "}"}], ",", "cooo"}], "]"}], "===", 
         RowBox[{"{", 
          RowBox[{
          "\[Mu]I", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ReplaceIndex", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Flatten", "[", 
               RowBox[{"Position", "[", 
                RowBox[{"cooo", ",", 
                 RowBox[{
                 "\[Mu]I", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "]"}], "]"}], ")"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "-", "1",
             "+", "st"}], ")"}], ",", "\[Mu]I"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "if", " ", "neither", " ", "then", " ", "just", " ", "return", " ", 
          "original", " ", "stuff"}], " ", "*)"}], "\[IndentingNewLine]", 
        "True", ",", "\[Mu]I"}], "\[IndentingNewLine]", "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"RaiseLower", "[", 
      RowBox[{"\[Mu]", ",", "\[Nu]", ",", "\[Tau]"}], "]"}], " ", "gives", 
     " ", "KroneckerDelta", " ", "if", " ", "\[Mu]", " ", "and", " ", "\[Nu]",
      " ", "have", " ", "the", " ", "same", " ", "Sgn", " ", "and", " ", 
     "otherwise", " ", 
     RowBox[{"g", "^", 
      RowBox[{"{", "\[Mu]\[Nu]", "}"}]}], " ", "or", " ", "g_", 
     RowBox[{"{", "\[Mu]\[Nu]", "}"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "right", " ", "index", " ", "\[Nu]", " ", "is", " ", "the", " ", "index", 
     " ", "on", " ", "the", " ", "Tensor"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "left", " ", "index", " ", "\[Mu]", " ", "is", " ", "what", " ", "we", 
     " ", "want"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "if", " ", "they", " ", "are", " ", "both", " ", "upper", " ", "or", " ",
       "lower"}], ",", " ", 
     RowBox[{
     "then", " ", "we", " ", "need", " ", "to", " ", "return", " ", 
      "\[Delta]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"if", " ", "ud"}], ",", " ", 
     RowBox[{"then", " ", "return", " ", 
      RowBox[{"g", "^", 
       RowBox[{"{", 
        RowBox[{"-", "1"}], "}"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"if", " ", "du"}], ",", " ", 
     RowBox[{"then", " ", "return", " ", "g"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"RaiseLower", "[", 
       RowBox[{
        RowBox[{"\[Mu]_", "/;", 
         RowBox[{"TestIndices", "[", "\[Mu]", "]"}]}], ",", 
        RowBox[{"\[Nu]_", "/;", 
         RowBox[{"TestIndices", "[", "\[Nu]", "]"}]}], ",", "\[Tau]_Tensor"}],
        "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TensorTypeNoPart", "[", "\[Tau]", "]"}], "===", 
          RowBox[{"{", "\"\<Metric\>\"", "}"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"IndicesNoPart", "[", "\[Tau]", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"SuperMinus", "[", "_", "]"}], ",", 
              RowBox[{"SuperMinus", "[", "_", "]"}]}], "}"}]}], "]"}], "||", 
          RowBox[{"MatchQ", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"IndicesNoPart", "[", "\[Tau]", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"SubMinus", "[", "_", "]"}], ",", 
              RowBox[{"SubMinus", "[", "_", "]"}]}], "}"}]}], "]"}]}], 
         ")"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"si", ",", "MetricM"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"si", "=", 
         RowBox[{"StartIndex", "[", "\[Tau]", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"read", " ", "in", " ", "the", " ", "metric"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"MetricM", "=", 
         RowBox[{"TensorComponents", "[", "\[Tau]", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"same", " ", "sign"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Sgn", "[", "\[Mu]", "]"}], 
            RowBox[{"Sgn", "[", "\[Nu]", "]"}]}], "===", "1"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"KroneckerDelta", "[", 
           RowBox[{
            RowBox[{"IndexNumber", "[", "\[Mu]", "]"}], ",", 
            RowBox[{"IndexNumber", "[", "\[Nu]", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"\[Mu]", " ", "positive"}], ",", " ", 
            RowBox[{"\[Nu]", " ", "negative"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"g", "^", 
            RowBox[{"{", 
             RowBox[{"\[Mu]", " ", "\[Nu]"}], "}"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"extract", " ", "inverse", " ", "metric"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Sgn", "[", "\[Mu]", "]"}], "===", "1"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Sgn", "[", "\[Nu]", "]"}], "===", 
             RowBox[{"-", "1"}]}], ")"}]}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{"inverse", " ", "metric"}], " ", "*)"}], 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"IndicesNoPart", "[", "\[Tau]", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"SuperMinus", "[", "_", "]"}], ",", 
                 RowBox[{"SuperMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ",",
              "\[IndentingNewLine]", "\t\t", "MetricM", ",", 
             "\[IndentingNewLine]", "\t\t", 
             RowBox[{"(*", " ", "metric", " ", "*)"}], "\[IndentingNewLine]", 
             "\t\t", 
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"IndicesNoPart", "[", "\[Tau]", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"SubMinus", "[", "_", "]"}], ",", 
                 RowBox[{"SubMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ",", 
             "\[IndentingNewLine]", "\t\t", 
             RowBox[{"Inverse", "[", "MetricM", "]"}]}], 
            "\[IndentingNewLine]", "\t", "]"}], "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{
             RowBox[{"IndexNumber", "[", "\[Mu]", "]"}], "-", "si", "+", 
             "1"}], ",", 
            RowBox[{
             RowBox[{"IndexNumber", "[", "\[Nu]", "]"}], "-", "si", "+", 
             "1"}]}], "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"\[Mu]", " ", "negative"}], ",", " ", 
            RowBox[{"\[Nu]", " ", "positive"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"g_", 
            RowBox[{"{", 
             RowBox[{"\[Mu]", " ", "\[Nu]"}], "}"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"extract", " ", "metric"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Sgn", "[", "\[Mu]", "]"}], "\[Equal]", 
             RowBox[{"-", "1"}]}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Sgn", "[", "\[Nu]", "]"}], "\[Equal]", "1"}], ")"}]}], 
          ",", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{"inverse", " ", "metric"}], " ", "*)"}], 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"IndicesNoPart", "[", "\[Tau]", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"SuperMinus", "[", "_", "]"}], ",", 
                 RowBox[{"SuperMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ",",
              "\[IndentingNewLine]", "\t\t", 
             RowBox[{"Inverse", "[", "MetricM", "]"}], ",", 
             "\[IndentingNewLine]", "\t\t", 
             RowBox[{"(*", " ", "metric", " ", "*)"}], "\[IndentingNewLine]", 
             "\t\t", 
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"IndicesNoPart", "[", "\[Tau]", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"SubMinus", "[", "_", "]"}], ",", 
                 RowBox[{"SubMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ",", 
             "\[IndentingNewLine]", "\t\t", "MetricM"}], 
            "\[IndentingNewLine]", "\t", "]"}], "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{
             RowBox[{"IndexNumber", "[", "\[Mu]", "]"}], "-", "si", "+", 
             "1"}], ",", 
            RowBox[{
             RowBox[{"IndexNumber", "[", "\[Nu]", "]"}], "-", "si", "+", 
             "1"}]}], "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "TestQuadratic", " ", "checks", " ", "that", " ", "the", " ", "metric", 
     " ", "expression"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "is", " ", "quadratic", " ", "in", " ", "the", " ", "differentials", " ", 
     "of", " ", "the", " ", "coordinates"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "`1`", " ", "here", " ", "refers", " ", "to", " ", "the", " ", "first", 
     " ", "argument", " ", "of", " ", "the", " ", "command", " ", "invoking", 
     " ", "this", " ", "error", " ", "message"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestQuadratic", "::", "TestQuadraticFalse"}], "=", 
     "\"\<The expression form of metric `1` isn't quadratic or consistent \
with metric's indices.\>\""}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestQuadratic", "[", 
      RowBox[{"ss_", ",", "cc_List", ",", 
       RowBox[{"judge_Integer", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"judge", "===", "1"}], ")"}], "||", 
          RowBox[{"(", 
           RowBox[{"judge", "===", 
            RowBox[{"-", "1"}]}], ")"}]}], ")"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "dx", ",", "delx", ",", "newss", ",", "\[Epsilon]", ",", 
         "\[Epsilon]2", ",", "out"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"introduce", " ", "power", " ", "counting", " ", "rule"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dx", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[DifferentialD]", "#"}], "\[Rule]", 
              RowBox[{"\[Epsilon]", " ", 
               RowBox[{"\[DifferentialD]", "#"}]}]}], ")"}], "&"}], " ", "/@",
            "cc"}], ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"delx", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Del]", "#"}], "\[Rule]", 
              RowBox[{"\[Epsilon]2", " ", 
               RowBox[{"\[Del]", "#"}]}]}], ")"}], "&"}], " ", "/@", "cc"}], 
          ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"newss", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"ss", "/.", "dx"}], ")"}], "/.", "delx"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"judge", "===", 
            RowBox[{"-", "1"}]}], ")"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"out", "=", 
            RowBox[{"FullSimplify", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{"newss", ",", "\[Epsilon]"}], "]"}], "/", 
               RowBox[{"(", 
                RowBox[{"ss", " ", "\[Epsilon]"}], ")"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Epsilon]", ">", "0"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"out", "===", "2"}], ")"}], ",", "True", ",", 
             RowBox[{
              RowBox[{"Message", "[", 
               RowBox[{
                RowBox[{"TestQuadratic", "::", "TestQuadraticFalse"}], ",", 
                "ss"}], "]"}], ";", "False"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(", 
           RowBox[{"judge", "===", 
            RowBox[{"+", "1"}]}], ")"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"out", "=", 
            RowBox[{"FullSimplify", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{"newss", ",", "\[Epsilon]2"}], "]"}], "/", 
               RowBox[{"(", 
                RowBox[{"ss", " ", "\[Epsilon]2"}], ")"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Epsilon]2", ">", "0"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"out", "===", "2"}], ")"}], ",", "True", ",", 
             RowBox[{
              RowBox[{"Message", "[", 
               RowBox[{
                RowBox[{"TestQuadratic", "::", "TestQuadraticFalse"}], ",", 
                "ss"}], "]"}], ";", "False"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestMetricTensor", "::", "TestMetricTensorFalse"}], "=", 
     "\"\<The tensor `1` isn't a metric tensor.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestMetricTensor", "[", "m_Tensor", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "tt", "}"}], ",", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TensorTypeNoPart", "[", "m", "]"}], "===", 
           RowBox[{"{", "\"\<Metric\>\"", "}"}]}], ")"}], ",", "True", ",", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"TestMetricTensor", "::", "TestMetricTensorFalse"}], ",", 
            "m"}], "]"}], ";", "False"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "CollectRepeatedIndices", " ", "takes", " ", "in", " ", "two", " ", "or", 
     " ", "more", " ", "Lists", " ", "of", " ", "Indices", " ", "and", " ", 
     "returns", " ", "all", " ", "repeated", " ", "ones"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CollectRepeatedIndices", "[", "ll__List", "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Union", "[", 
         RowBox[{"TestIndices", "/@", 
          RowBox[{"Join", "[", "ll", "]"}]}], "]"}], "===", 
        RowBox[{"{", "True", "}"}]}], ")"}]}], ":=", 
     RowBox[{"Cases", "[", 
      RowBox[{
       RowBox[{"Split", "[", 
        RowBox[{"Sort", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "&"}], "/@", 
           RowBox[{"Join", "[", "ll", "]"}]}], ")"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ss_Symbol", ",", "ss_Symbol"}], "}"}], "\[Rule]", "ss"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "NotAbstractIndex", " ", "takes", " ", "in", " ", "an", " ", "index", 
      " ", "\[Mu]"}], ",", " ", 
     RowBox[{"a", " ", "List", " ", "of", " ", "coordinates", " ", "cooo"}], 
     ",", " ", 
     RowBox[{"and", " ", "start", " ", "index", " ", "si"}], ",", " ", 
     RowBox[{
     "and", " ", "returns", " ", "True", " ", "if", " ", "the", " ", "index", 
      " ", "is", " ", "not", " ", "abstract", " ", "and", " ", "False", " ", 
      "otherwise"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Note", ":", " ", 
     RowBox[{
     "start", " ", "index", " ", "is", " ", "needed", " ", "because", " ", 
      "sometimes", " ", "the", " ", "Index", " ", "is", " ", "given", " ", 
      "as", " ", "an", " ", 
      SuperscriptBox["Integer", "-"], " ", "or", " ", 
      SubscriptBox["Integer", "-"]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "The", " ", "index", " ", "can", " ", "be", " ", "UnderBarred", " ", "or",
      " ", "not"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NotAbstractIndex", "::", "NotAbstractIndexOutOfRange"}], "=", 
     "\"\<The specified index `1` is out of range.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NotAbstractIndex", "[", 
      RowBox[{"\[Mu]_", ",", "cooo_List", ",", "si_Integer"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"TestOverHatIndex", "[", "\[Mu]", "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestIndices", "[", "\[Mu]", "]"}], "&&", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Head", "[", 
                RowBox[{"\[Mu]", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], "===",
                "Integer"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Intersection", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"NumericIndex", "[", 
                    RowBox[{"\[Mu]", ",", "cooo", ",", "si"}], "]"}], 
                   "\[LeftDoubleBracket]", 
                   RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "}"}], 
                 ",", 
                 RowBox[{"Range", "[", 
                  RowBox[{"si", ",", 
                   RowBox[{
                    RowBox[{"Length", "[", "cooo", "]"}], "+", "si", "-", 
                    "1"}]}], "]"}]}], "]"}], "=!=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"NumericIndex", "[", 
                  RowBox[{"\[Mu]", ",", "cooo", ",", "si"}], "]"}], 
                 "\[LeftDoubleBracket]", 
                 RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "}"}]}], 
              ")"}]}], ",", 
            RowBox[{
             RowBox[{"Message", "[", 
              RowBox[{
               RowBox[{
               "NotAbstractIndex", "::", "NotAbstractIndexOutOfRange"}], ",", 
               "\[Mu]"}], "]"}], ";", "False"}], ",", "True"}], "]"}]}], 
         ")"}], "&&", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"\[Mu]", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], "=!=",
             "Integer"}], ")"}], ",", "False", ",", "True"}], "]"}]}], ",", 
       "True", ",", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"TestIndices", "[", "\[Mu]", "]"}], "&&", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Head", "[", 
               RowBox[{
               "\[Mu]", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "]"}], "===", "Integer"}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Intersection", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"NumericIndex", "[", 
                   RowBox[{"\[Mu]", ",", "cooo", ",", "si"}], "]"}], 
                  "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 "}"}], ",", 
                RowBox[{"Range", "[", 
                 RowBox[{"si", ",", 
                  RowBox[{
                   RowBox[{"Length", "[", "cooo", "]"}], "+", "si", "-", 
                   "1"}]}], "]"}]}], "]"}], "=!=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"NumericIndex", "[", 
                 RowBox[{"\[Mu]", ",", "cooo", ",", "si"}], "]"}], 
                "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "}"}]}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"Message", "[", 
             RowBox[{
              RowBox[{
              "NotAbstractIndex", "::", "NotAbstractIndexOutOfRange"}], ",", 
              "\[Mu]"}], "]"}], ";", "False"}], ",", "True"}], "]"}], "&&", 
         RowBox[{"(", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Intersection", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"NumericIndex", "[", 
                 RowBox[{"\[Mu]", ",", "cooo", ",", "si"}], "]"}], 
                "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "}"}],
               ",", 
              RowBox[{"Range", "[", 
               RowBox[{"si", ",", 
                RowBox[{
                 RowBox[{"Length", "[", "cooo", "]"}], "+", "si", "-", 
                 "1"}]}], "]"}]}], "]"}], "===", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"NumericIndex", "[", 
               RowBox[{"\[Mu]", ",", "cooo", ",", "si"}], "]"}], 
              "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "}"}]}],
            ")"}], ")"}]}], ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "TestScalarTensor", " ", "reads", " ", "in", " ", "a", " ", "Tensor", " ",
      "and", " ", "determines", " ", "whether", " ", "it", " ", "is", " ", 
     "a", " ", "scalar", " ", "by", " ", "checking"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"(", "1", ")"}], " ", "If", " ", "Indices", " ", "are", " ", 
     "empty", " ", 
     RowBox[{"{", "}"}], " ", 
     RowBox[{"(", "2", ")"}], " ", "if", " ", "all", " ", "Indices", " ", 
     "are", " ", "UnderBarred"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "returns", " ", "True", " ", "if", " ", "Tensor", " ", "is", " ", 
     "scalar", " ", "and", " ", "False", " ", "otherwise"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestScalarTensor", "[", "t_Tensor", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Indices", "[", "t", "]"}], "===", 
        RowBox[{"{", "}"}]}], ")"}], "||", 
      RowBox[{"MatchQ", "[", 
       RowBox[{
        RowBox[{"Indices", "[", "t", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"SuperMinus", "|", "SubMinus"}], ")"}], "[", 
           RowBox[{"UnderBar", "[", "_", "]"}], "]"}], ".."}], "}"}]}], 
       "]"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestScalarTensor", "[", 
      RowBox[{"t_", "/;", 
       RowBox[{"TestExpressionForm", "[", "t", "]"}]}], "]"}], ":=", 
     "False"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestScalarTensor", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"t_Times", "|", "t_Plus"}], ")"}], "/;", 
       RowBox[{"!", 
        RowBox[{"TestExpressionForm", "[", "t", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"Cases", "[", 
           RowBox[{"t", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Indices", "\[Rule]", " ", "idx_"}], ")"}], "\[Rule]", 
             " ", "idx"}], ",", "Infinity"}], "]"}], "]"}], "===", 
         RowBox[{"{", "}"}]}], ")"}], ",", "True", ",", "True", ",", 
       "False"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestTensorTensor", "[", "t_", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"TestExpressionForm", "[", "t", "]"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"TestScalarTensor", "[", "t", "]"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"RemoveUnderBarredIndices", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"(", "t", ")"}], "}"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Indices", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{"idx_", "/;", 
                   RowBox[{"(", 
                    RowBox[{"idx", "=!=", 
                    RowBox[{"{", "}"}]}], ")"}]}], ")"}]}], ")"}], "\[Rule]", 
               " ", "idx"}], " ", ")"}], ",", "Infinity"}], "]"}], "]"}], 
          "]"}], "=!=", 
         RowBox[{"{", "}"}]}], ")"}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestSingleTensorTensor", "[", "t_", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Head", "[", "t", "]"}], "===", "Tensor"}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"TestExpressionForm", "[", "t", "]"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"TestScalarTensor", "[", "t", "]"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"RemoveUnderBarredIndices", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"(", "t", ")"}], "}"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Indices", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{"idx_", "/;", 
                   RowBox[{"(", 
                    RowBox[{"idx", "=!=", 
                    RowBox[{"{", "}"}]}], ")"}]}], ")"}]}], ")"}], "\[Rule]", 
               " ", "idx"}], " ", ")"}], ",", "Infinity"}], "]"}], "]"}], 
          "]"}], "=!=", 
         RowBox[{"{", "}"}]}], ")"}]}], ")"}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "RemoveUnderBarredIndices", " ", "remove", " ", "all", " ", "UnderBarred",
      " ", "Indices"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RemoveUnderBarredIndices", "[", "\[Mu]T_List", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xx1", ",", "xx2"}], "}"}], ",", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{"\[Mu]T", ",", 
         RowBox[{
          RowBox[{"SuperMinus", "[", 
           RowBox[{"UnderBar", "[", "xx1_", "]"}], "]"}], "|", 
          RowBox[{"SubMinus", "[", 
           RowBox[{"UnderBar", "[", "xx2_", "]"}], "]"}]}]}], "]"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RemoveUnderBarredIndices", "[", "t_Tensor", "]"}], ":=", 
     RowBox[{"Indices", "[", 
      RowBox[{"t", ",", 
       RowBox[{"RemoveUnderBarredIndices", "[", 
        RowBox[{"Indices", "[", "t", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "RemoveRepeatedUnderBarredIndices", " ", "remove", " ", "all", " ", 
     "repeated", " ", "UnderBarred", " ", "Indices"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RemoveRepeatedUnderBarredIndices", "[", "\[Mu]T_List", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Mu]", ",", "i1", ",", "i2", ",", "i3"}], "}"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Mu]T", "//.", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i1___", ",", 
             RowBox[{"SuperMinus", "[", 
              RowBox[{"UnderBar", "[", "\[Mu]_", "]"}], "]"}], ",", "i2___", 
             ",", 
             RowBox[{"SubMinus", "[", 
              RowBox[{"UnderBar", "[", "\[Mu]_", "]"}], "]"}], ",", "i3___"}],
             "}"}], "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"i1", ",", "i2", ",", "i3"}], "}"}]}]}], ")"}], "//.", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i1___", ",", 
           RowBox[{"SubMinus", "[", 
            RowBox[{"UnderBar", "[", "\[Mu]_", "]"}], "]"}], ",", "i2___", 
           ",", 
           RowBox[{"SuperMinus", "[", 
            RowBox[{"UnderBar", "[", "\[Mu]_", "]"}], "]"}], ",", "i3___"}], 
          "}"}], "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"i1", ",", "i2", ",", "i3"}], "}"}]}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RemoveRepeatedUnderBarredIndices", "[", "t_Tensor", "]"}], ":=", 
     RowBox[{"Indices", "[", 
      RowBox[{"t", ",", 
       RowBox[{"RemoveRepeatedUnderBarredIndices", "[", 
        RowBox[{"Indices", "[", "t", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "NestedDel", " ", "takes", " ", "in", " ", "an", " ", "express", " ", 
     "of", " ", "the", " ", "form", " ", 
     RowBox[{"Del", "[", 
      RowBox[{"...", 
       RowBox[{"Del", "[", "stuff", "]"}]}], "]"}], " ", "and", " ", 
     "returns", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"#", " ", "of", " ", "Dels"}], ",", " ", "stuff"}], "}"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "By", " ", "stuff", " ", "we", " ", "simply", " ", "mean", " ", "the", 
      " ", "remainder", " ", "after", " ", "the", " ", "outer", " ", "most", 
      " ", 
      RowBox[{"Del", "'"}], "s", " ", "are", " ", "peeled", " ", "away"}], 
     ";", " ", 
     RowBox[{"there", " ", "could", " ", "still", " ", "be", " ", 
      RowBox[{"Del", "'"}], "s", " ", "hidden", " ", "in", " ", "output"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NestedDel", "[", "dd_Del", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"stuff", ",", "idx"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"stuff", "=", "dd"}], ";", 
        RowBox[{"idx", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "stuff", "]"}], "===", "Del"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"strip", " ", "off", " ", "outer", " ", "most", " ", 
            RowBox[{"Del", "'"}], "s"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"stuff", "=", 
            RowBox[{
            "stuff", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
            ";", 
           RowBox[{"idx", "=", 
            RowBox[{"idx", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"idx", ",", "stuff"}], "}"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "FormatTensorName", " ", "formats", " ", "the", " ", "TensorName", " ", 
     "of", " ", "a", " ", "Tensor", " ", "object"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FormatTensorName", "[", "name_", "]"}], ":=", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"Head", "[", "name", "]"}], ",", 
         RowBox[{"(", 
          RowBox[{"(*", " ", 
           RowBox[{"If", " ", "it", " ", "is", " ", "a", " ", 
            RowBox[{
             RowBox[{"TensorProduct", "/", "CovariantD"}], "/", "Times"}], 
            " ", "we", " ", "put", " ", "a", " ", "parenthesis", " ", 
            "around", " ", "it"}], " ", "*)"}], 
          RowBox[{"TensorProduct", "|", "Del", "|", "Times", "|", "Row"}], 
          ")"}]}], "]"}], ",", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"{", "name", "}"}], "]"}], ",", "\[IndentingNewLine]", "True",
        ",", "name"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"You", " ", "can", " ", "input", " ", "as", " ", "a", " ", 
     StyleBox["Tensor",
      FontColor->RGBColor[1, 0, 1]], " ", "or", " ", 
     StyleBox["list",
      FontColor->RGBColor[1, 0, 1]], " ", 
     RowBox[{
      RowBox[{"(", "Coordinates", ")"}], ".", " ", "The"}], " ", "output", 
     " ", "will", " ", "be", " ", "the", " ", "rank", " ", "of", " ", 
     RowBox[{"tensor", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RankNumber", "[", "t_Tensor", "]"}], ":=", 
     RowBox[{"Length", "[", 
      RowBox[{"RemoveUnderBarredIndices", "[", 
       RowBox[{"Indices", "[", "t", "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RankNumber", "[", "\[Mu]_List", "]"}], ":=", 
     RowBox[{"Length", "[", 
      RowBox[{"RemoveUnderBarredIndices", "[", "\[Mu]", "]"}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RankNumber", "[", 
      RowBox[{"expr_", "/;", 
       RowBox[{"TestExpressionForm", "[", "expr", "]"}]}], "]"}], ":=", "0"}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CoordinatesDimension", "[", "t_Tensor", "]"}], ":=", 
     RowBox[{"Length", "[", 
      RowBox[{"Coordinates", "[", "t", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ComponentRankNumber", "[", "t_Tensor", "]"}], "/;", 
      RowBox[{"!", 
       RowBox[{"TestExpressionForm", "[", 
        RowBox[{"TensorComponents", "[", "t", "]"}], "]"}]}]}], ":=", 
     RowBox[{"Length", "[", 
      RowBox[{"Dimensions", "[", 
       RowBox[{"TensorComponents", "[", "t", "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ComponentRankNumber", "[", "t_Tensor", "]"}], "/;", 
      RowBox[{"TestExpressionForm", "[", 
       RowBox[{"TensorComponents", "[", "t", "]"}], "]"}]}], ":=", "0"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ComponentRankNumber", "[", "\[Mu]_List", "]"}], ":=", 
     RowBox[{"Length", "[", 
      RowBox[{"Dimensions", "[", "\[Mu]", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ComponentRankNumber", "[", 
      RowBox[{"\[Mu]_", "/;", 
       RowBox[{"TestExpressionForm", "[", "\[Mu]", "]"}]}], "]"}], ":=", 
     "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestMoveOnlyOneType", "[", 
      RowBox[{"tt_Tensor", ",", "idx_List"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"list", "=", 
          RowBox[{"{", "}"}]}], ",", "i", ",", "ttidx"}], "}"}], ",", 
       RowBox[{
        RowBox[{"ttidx", "=", 
         RowBox[{"RemoveUnderBarredIndices", "[", 
          RowBox[{"Indices", "[", "tt", "]"}], "]"}]}], ";", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", 
              RowBox[{
              "idx", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              "]"}], "=!=", 
             RowBox[{"Head", "[", 
              RowBox[{
              "ttidx", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
               "]"}]}], ",", 
            RowBox[{"list", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"list", ",", 
               RowBox[{"Head", "[", 
                RowBox[{"idx", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}], 
              "]"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"Dimensions", "[", "idx", "]"}]}]}], "}"}]}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"Dimensions", "[", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Union", "[", "list", "]"}], "/.", 
             RowBox[{"{", 
              RowBox[{"Integer", "\[Rule]", " ", "Nothing"}], "}"}]}], ")"}], 
           "]"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", "0", "}"}], "|", 
            RowBox[{"{", "1", "}"}]}], ")"}]}], "]"}]}]}], "]"}]}], ";"}], 
   StyleBox["\[IndentingNewLine]",
    FontColor->RGBColor[0.6, 0.4, 0.2]], 
   StyleBox["\[IndentingNewLine]",
    FontColor->RGBColor[0.6, 0.4, 0.2]], 
   RowBox[{
    RowBox[{"OverHatSgn", "[", "\[Mu]_", "]"}], ":=", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Head", "[", 
          RowBox[{
          "\[Mu]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "]"}], ")"}], "===", "Symbol"}], ")"}], ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Head", "[", 
          RowBox[{
          "\[Mu]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "]"}], ")"}], "===", "OverHat"}], ")"}], ",", "1", ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Head", "[", 
          RowBox[{
          "\[Mu]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "]"}], ")"}], "===", "Integer"}], ")"}], ",", 
      RowBox[{"-", "1"}]}], "]"}]}], 
   StyleBox["\[IndentingNewLine]",
    FontColor->RGBColor[0.6, 0.4, 0.2]], 
   RowBox[{
    RowBox[{
     RowBox[{"NonZeroTensorComponents", "[", 
      RowBox[{
      "name_", ",", "\[IndentingNewLine]", "\[Mu]T_List", ",", 
       "\[IndentingNewLine]", 
       StyleBox["ttM_", "Code"], 
       StyleBox[",", "Code"], 
       StyleBox["\[IndentingNewLine]", "Code"], 
       StyleBox["coords_List", "Code"]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"collist", "=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"rank", "=", 
          RowBox[{"RankNumber", "[", "\[Mu]T", "]"}]}], ",", 
         RowBox[{"dim", "=", 
          RowBox[{"Length", "[", "coords", "]"}]}], ",", "symboltemp", ",", 
         RowBox[{"symbollist", "=", 
          RowBox[{"{", "}"}]}], ",", "range", ",", "replacementlist", ",", 
         "newdisp"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Prepare", " ", "the", " ", "lhs", " ", 
         RowBox[{"(", 
          StyleBox[
           RowBox[{"column", " ", "list"}],
           FontColor->RGBColor[1, 0, 1]], ")"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", 
         StyleBox["\[IndentingNewLine]", "Code"], 
         StyleBox[
          RowBox[{
           RowBox[{"collist", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"collist", ",", 
              RowBox[{"UpOrDown", "[", 
               RowBox[{
               "\[Mu]T", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "]"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "rank"}], "}"}]}], "Code"], 
         StyleBox["]", "Code"]}], 
        StyleBox[";", "Code"], 
        StyleBox["\n", "Code"], 
        StyleBox[
         RowBox[{"(*", 
          RowBox[{"First", " ", 
           RowBox[{"step", ".", " ", 
            RowBox[{"Haven", "'"}]}], "t", " ", "specified", " ", "any", " ", 
           RowBox[{"index", "."}]}], "*)"}], "Code"], 
        StyleBox["\n", "Code"], 
        StyleBox[
         RowBox[{"newdisp", "=", 
          RowBox[{"{", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Row", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"FormatTensorName", "[", "name", "]"}], ",", 
                RowBox[{"Sequence", "@@", "collist"}]}], "}"}], "]"}], 
             "\[Rule]", "ttM"}], ")"}], "}"}]}], "Code"], 
        StyleBox[";", "Code"], 
        StyleBox["\n", "Code"], 
        RowBox[{"(*", 
         StyleBox[
          RowBox[{
           RowBox[{"2", "nd"}], ",", " ", 
           RowBox[{"3", "rd", " ", "steps"}], ",", " ", 
           RowBox[{"and", " ", "so", " ", 
            RowBox[{"on", ".", " ", "Start"}], " ", "to", " ", "specified", 
            " ", "from", " ", "first", " ", "index", " ", "until", " ", 
            "every", " ", "index", " ", "is", " ", 
            RowBox[{"specified", "."}]}]}], "Code"], "*)"}], 
        StyleBox["\n", "Code"], 
        StyleBox[
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"newdisp", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{"newdisp", ",", 
                RowBox[{
                 RowBox[{"Rule", "[", 
                  RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", " ", 
                 RowBox[{"Rule", "[", 
                  RowBox[{
                   RowBox[{"a", "/.", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "\[Mu]T", "\[LeftDoubleBracket]", "idxnumber", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[Rule]", 
                    RowBox[{
                    "coords", "\[LeftDoubleBracket]", "coordnumber", 
                    "\[RightDoubleBracket]"}]}], ")"}]}], ",", 
                   RowBox[{
                   "b", "\[LeftDoubleBracket]", "coordnumber", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ",", "Infinity"}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"coordnumber", ",", "1", ",", "dim"}], "}"}]}], 
             "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"idxnumber", ",", "1", ",", "rank"}], "}"}]}], "]"}], 
         "Code"], 
        StyleBox[";", "Code"], 
        StyleBox["\n", "Code"], 
        RowBox[{"(*", 
         StyleBox[
          RowBox[{
           RowBox[{"Select", " ", "non"}], "-", 
           RowBox[{"zero", " ", 
            RowBox[{"comp", "."}]}]}], "Code"], "*)"}], 
        StyleBox["\n", "Code"], 
        RowBox[{
         StyleBox["Select", "Code"], 
         StyleBox["[", "Code"], 
         RowBox[{
          StyleBox[
           RowBox[{"newdisp", "//", "Flatten"}], "Code"], 
          StyleBox[",", "Code"], 
          RowBox[{
           RowBox[{
            StyleBox["(", "Code"], 
            RowBox[{
             RowBox[{
              RowBox[{
               StyleBox["Flatten", "Code"], 
               StyleBox["[", "Code"], 
               RowBox[{
                StyleBox["Cases", "Code"], 
                StyleBox["[", "Code"], 
                RowBox[{
                 StyleBox[
                  RowBox[{"{", "#", "}"}], "Code"], 
                 StyleBox[",", "Code"], 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Row", "[", "__", "]"}], "\[Rule]", "cc_"}], 
                   ")"}], "\[Rule]", "cc"}]}], "]"}], 
               StyleBox["]", "Code"]}], 
              StyleBox["\[LeftDoubleBracket]", "Code"], 
              StyleBox["1", "Code"], 
              StyleBox["\[RightDoubleBracket]", "Code"]}], 
             StyleBox["=!=", "Code"], 
             StyleBox["0", "Code"]}], 
            StyleBox[")", "Code"]}], 
           StyleBox["&", "Code"]}]}], 
         StyleBox["]", "Code"]}]}]}], 
      StyleBox["\n", "Code"], 
      StyleBox["]", "Code"]}]}], 
    StyleBox[";", "Code"]}], "\[IndentingNewLine]", 
   StyleBox["\n", "Code"], 
   RowBox[{
    RowBox[{
     RowBox[{"TestDifferentialForm", "::", "AntiSymmetricOrVectorOrScalar"}], 
     "=", "\"\<The argument `1` might not have anti-symmetric \
TensorComponent, or it is not 1-form nor scalar.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"TestDifferentialForm", "::", "TestIndicesFalse"}], "=", 
      "\"\<The argument `1` does not have indices in correct format.\>\""}], 
     ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestDifferentialForm", "::", "AllLowerIndicesFalse"}], "=", 
     "\"\<The argument `1` does not have all lower indices.\>\""}], ";"}], 
   StyleBox["\n", "Code"], 
   StyleBox["\n", "Code"], 
   RowBox[{
    RowBox[{"TestDifferentialForm", "[", "t_Tensor", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"check", " ", "t", 
            StyleBox[" ",
             FontColor->RGBColor[1, 0.5, 0.5]], "is", " ", "a", " ", 
            StyleBox["fully",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["anti",
             FontColor->RGBColor[1, 0, 1]]}], 
           StyleBox["-",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[
            RowBox[{"symm", " ", "tensor"}],
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"TensorSymmetry", "[", "t", "]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "===", 
            RowBox[{"Antisymmetric", "[", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", 
               RowBox[{"RemoveUnderBarredIndices", "[", 
                RowBox[{"Indices", "[", "t", "]"}], "]"}], "]"}], "]"}], 
             "]"}]}], ")"}], "||", 
          RowBox[{"(*", 
           RowBox[{"Or", " ", "t", " ", "should", " ", "be", " ", "a", " ", 
            StyleBox["scalar",
             FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
          RowBox[{"(", 
           RowBox[{"TestScalarTensor", "[", "t", "]"}], ")"}], "||", 
          RowBox[{"(*", 
           RowBox[{"Or", " ", "t", " ", "should", " ", "be", " ", "a", " ", 
            StyleBox["vector",
             FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"RankNumber", "[", "t", "]"}], "===", "1"}], ")"}]}], 
         ")"}], ",", "True", ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{
           "TestDifferentialForm", "::", "AntiSymmetricOrVectorOrScalar"}], 
           ",", "t"}], "]"}], ";", "False"}]}], "]"}], "&&", 
      RowBox[{"(*", 
       RowBox[{
        StyleBox["Check",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["indices",
         FontColor->RGBColor[1, 0, 1]], " ", "in", " ", "t", " ", "are", " ", 
        "OK", " ", "or", " ", 
        StyleBox["no",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["index",
         FontColor->RGBColor[1, 0, 1]], " ", 
        RowBox[{
         RowBox[{"(", "scalar", ")"}], "."}]}], "*)"}], 
      RowBox[{"(*", 
       RowBox[{"If", "["}], "*)"}], 
      RowBox[{"MatchQ", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Union", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"TestIndices", "[", "#", "]"}], "&"}], "/@", 
           RowBox[{"RemoveUnderBarredIndices", "[", 
            RowBox[{"Indices", "[", "t", "]"}], "]"}]}], "]"}], ")"}], ",", 
        RowBox[{
         RowBox[{"{", "True", "}"}], "|", 
         RowBox[{"{", "}"}]}]}], "]"}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{",", "True", ",", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"TestDifferentialForm", "::", "TestIndicesFalse"}], ",", 
            "t"}], "]"}], ";", "False"}]}], "]"}], "*)"}], "&&", 
      RowBox[{"(*", 
       RowBox[{"All", " ", "of", " ", "them", " ", "should", " ", "be", " ", 
        StyleBox["lower",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["indices",
         FontColor->RGBColor[1, 0, 1]], " ", "or", " ", 
        StyleBox["no",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        RowBox[{
         StyleBox["index",
          FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Union", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
             RowBox[{"RemoveUnderBarredIndices", "[", 
              RowBox[{"Indices", "[", "t", "]"}], "]"}]}], "]"}], ")"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"-", "1"}], "}"}], "|", 
           RowBox[{"{", "}"}]}]}], "]"}], ",", "True", ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"TestDifferentialForm", "::", "AllLowerIndicesFalse"}], 
           ",", "t"}], "]"}], ";", "False"}]}], "]"}]}], ")"}]}], 
   StyleBox["\n", "Code"], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TestDifferentialForm", "[", 
     RowBox[{"t_Tensor", ",", 
      RowBox[{"m_Tensor", "/;", 
       RowBox[{"TestMetricTensor", "[", "m", "]"}]}]}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"check", " ", "t", 
            StyleBox[" ",
             FontColor->RGBColor[1, 0.5, 0.5]], "is", " ", "a", " ", 
            StyleBox["fully",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["anti",
             FontColor->RGBColor[1, 0, 1]]}], 
           StyleBox["-",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[
            RowBox[{"symm", " ", "tensor"}],
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"TensorSymmetry", "[", 
              RowBox[{"LowerAllIndices", "[", 
               RowBox[{"t", ",", "m"}], "]"}], "]"}], "\[LeftDoubleBracket]", 
             "1", "\[RightDoubleBracket]"}], "===", 
            RowBox[{"Antisymmetric", "[", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", 
               RowBox[{"RemoveUnderBarredIndices", "[", 
                RowBox[{"Indices", "[", "t", "]"}], "]"}], "]"}], "]"}], 
             "]"}]}], ")"}], "||", 
          RowBox[{"(*", 
           RowBox[{"Or", " ", "t", " ", "should", " ", "be", " ", "a", " ", 
            StyleBox["scalar",
             FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
          RowBox[{"(", 
           RowBox[{"TestScalarTensor", "[", "t", "]"}], ")"}], "||", 
          RowBox[{"(*", 
           RowBox[{"Or", " ", "t", " ", "should", " ", "be", " ", "a", " ", 
            StyleBox["vector",
             FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"RankNumber", "[", "t", "]"}], "===", "1"}], ")"}]}], 
         ")"}], ",", "True", ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{
           "TestDifferentialForm", "::", "AntiSymmetricOrVectorOrScalar"}], 
           ",", "t"}], "]"}], ";", "False"}]}], "]"}], "&&", 
      RowBox[{"(*", 
       RowBox[{
        StyleBox["Check",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["indices",
         FontColor->RGBColor[1, 0, 1]], " ", "in", " ", "t", " ", "are", " ", 
        "OK", " ", "or", " ", 
        StyleBox["no",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["index",
         FontColor->RGBColor[1, 0, 1]], " ", 
        RowBox[{
         RowBox[{"(", "scalar", ")"}], "."}]}], "*)"}], 
      RowBox[{"(*", 
       RowBox[{"If", "["}], "*)"}], 
      RowBox[{"MatchQ", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Union", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"TestIndices", "[", "#", "]"}], "&"}], "/@", 
           RowBox[{"RemoveUnderBarredIndices", "[", 
            RowBox[{"Indices", "[", "t", "]"}], "]"}]}], "]"}], ")"}], ",", 
        RowBox[{
         RowBox[{"{", "True", "}"}], "|", 
         RowBox[{"{", "}"}]}]}], "]"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{",", "True", ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"TestDifferentialForm", "::", "TestIndicesFalse"}], ",", 
           "t"}], "]"}], ";", "False"}]}], "]"}], "*)"}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Shouldn", "'"}], "t", " ", "check", " ", "all", " ", "of", 
       " ", "them", " ", "be", " ", 
       StyleBox["lower",
        FontColor->RGBColor[1, 0, 1]], 
       StyleBox[" ",
        FontColor->RGBColor[1, 0, 1]], 
       StyleBox["indices",
        FontColor->RGBColor[1, 0, 1]], " ", "or", " ", 
       StyleBox["no",
        FontColor->RGBColor[1, 0, 1]], 
       StyleBox[" ",
        FontColor->RGBColor[1, 0, 1]], 
       RowBox[{
        StyleBox["index",
         FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "TestDifferentialVector", "::", "AntiSymmetricOrVectorOrScalar"}], "=", 
     "\"\<The argument `1` might not have anti-symmetric TensorComponent, or \
it is not a vector nor scalar.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"TestDifferentialVector", "::", "TestIndicesFalse"}], "=", 
      "\"\<The argument `1` does not have indices in correct format.\>\""}], 
     ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestDifferentialVector", "::", "AllUpperIndicesFalse"}], "=", 
     "\"\<The argument `1` does not have all upper indices.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   StyleBox["\n", "Code"], 
   RowBox[{
    RowBox[{"TestDifferentialVector", "[", "t_Tensor", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"check", " ", "t", 
            StyleBox[" ",
             FontColor->RGBColor[1, 0.5, 0.5]], "is", " ", "a", " ", 
            StyleBox["fully",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["anti",
             FontColor->RGBColor[1, 0, 1]]}], 
           StyleBox["-",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[
            RowBox[{"symm", " ", "tensor"}],
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"TensorSymmetry", "[", "t", "]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "===", 
            RowBox[{"Antisymmetric", "[", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", 
               RowBox[{"RemoveUnderBarredIndices", "[", 
                RowBox[{"Indices", "[", "t", "]"}], "]"}], "]"}], "]"}], 
             "]"}]}], ")"}], "||", 
          RowBox[{"(*", 
           RowBox[{"Or", " ", "t", " ", "should", " ", "be", " ", "a", " ", 
            StyleBox["scalar",
             FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
          RowBox[{"(", 
           RowBox[{"TestScalarTensor", "[", "t", "]"}], ")"}], "||", 
          RowBox[{"(*", 
           RowBox[{"Or", " ", "t", " ", "should", " ", "be", " ", "a", " ", 
            StyleBox["vector",
             FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"RankNumber", "[", "t", "]"}], "===", "1"}], ")"}]}], 
         ")"}], ",", "True", ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{
           "TestDifferentialVector", "::", "AntiSymmetricOrVectorOrScalar"}], 
           ",", "t"}], "]"}], ";", "False"}]}], "]"}], "&&", 
      RowBox[{"(*", 
       RowBox[{
        StyleBox["Check",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["indices",
         FontColor->RGBColor[1, 0, 1]], " ", "in", " ", "t", " ", "are", " ", 
        "OK", " ", "or", " ", 
        StyleBox["no",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["index",
         FontColor->RGBColor[1, 0, 1]], " ", 
        RowBox[{
         RowBox[{"(", "scalar", ")"}], "."}]}], "*)"}], 
      RowBox[{"(*", 
       RowBox[{"If", "["}], "*)"}], 
      RowBox[{"MatchQ", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Union", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"TestIndices", "[", "#", "]"}], "&"}], "/@", 
           RowBox[{"RemoveUnderBarredIndices", "[", 
            RowBox[{"Indices", "[", "t", "]"}], "]"}]}], "]"}], ")"}], ",", 
        RowBox[{
         RowBox[{"{", "True", "}"}], "|", 
         RowBox[{"{", "}"}]}]}], "]"}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{",", "True", ",", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"TestDifferentialVector", "::", "TestIndicesFalse"}], ",",
             "t"}], "]"}], ";", "False"}]}], "]"}], "*)"}], "&&", 
      RowBox[{"(*", 
       RowBox[{"All", " ", "of", " ", "them", " ", "should", " ", "be", " ", 
        StyleBox["upper",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["indices",
         FontColor->RGBColor[1, 0, 1]], " ", "or", " ", 
        StyleBox["no",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        RowBox[{
         StyleBox["index",
          FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Union", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
             RowBox[{"RemoveUnderBarredIndices", "[", 
              RowBox[{"Indices", "[", "t", "]"}], "]"}]}], "]"}], ")"}], ",", 
          RowBox[{
           RowBox[{"{", "1", "}"}], "|", 
           RowBox[{"{", "}"}]}]}], "]"}], ",", "True", ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"TestDifferentialVector", "::", "AllUpperIndicesFalse"}], 
           ",", "t"}], "]"}], ";", "False"}]}], "]"}]}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TestDifferentialVector", "[", 
     RowBox[{"t_Tensor", ",", 
      RowBox[{"m_Tensor", "/;", 
       RowBox[{"TestMetricTensor", "[", "m", "]"}]}]}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"check", " ", "t", 
            StyleBox[" ",
             FontColor->RGBColor[1, 0.5, 0.5]], "is", " ", "a", " ", 
            StyleBox["fully",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["anti",
             FontColor->RGBColor[1, 0, 1]]}], 
           StyleBox["-",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[
            RowBox[{"symm", " ", "tensor"}],
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"TensorSymmetry", "[", 
              RowBox[{"RaiseAllIndices", "[", 
               RowBox[{"t", ",", "m"}], "]"}], "]"}], "\[LeftDoubleBracket]", 
             "1", "\[RightDoubleBracket]"}], "===", 
            RowBox[{"Antisymmetric", "[", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", 
               RowBox[{"RemoveUnderBarredIndices", "[", 
                RowBox[{"Indices", "[", "t", "]"}], "]"}], "]"}], "]"}], 
             "]"}]}], ")"}], "||", 
          RowBox[{"(*", 
           RowBox[{"Or", " ", "t", " ", "should", " ", "be", " ", "a", " ", 
            StyleBox["scalar",
             FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
          RowBox[{"(", 
           RowBox[{"TestScalarTensor", "[", "t", "]"}], ")"}], "||", 
          RowBox[{"(*", 
           RowBox[{"Or", " ", "t", " ", "should", " ", "be", " ", "a", " ", 
            StyleBox["vector",
             FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"RankNumber", "[", "t", "]"}], "===", "1"}], ")"}]}], 
         ")"}], ",", "True", ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{
           "TestDifferentialVector", "::", "AntiSymmetricOrVectorOrScalar"}], 
           ",", "t"}], "]"}], ";", "False"}]}], "]"}], "&&", 
      RowBox[{"(*", 
       RowBox[{
        StyleBox["Check",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["indices",
         FontColor->RGBColor[1, 0, 1]], " ", "in", " ", "t", " ", "are", " ", 
        "OK", " ", "or", " ", 
        StyleBox["no",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["index",
         FontColor->RGBColor[1, 0, 1]], " ", 
        RowBox[{
         RowBox[{"(", "scalar", ")"}], "."}]}], "*)"}], 
      RowBox[{"(*", 
       RowBox[{"If", "["}], "*)"}], 
      RowBox[{"MatchQ", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Union", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"TestIndices", "[", "#", "]"}], "&"}], "/@", 
           RowBox[{"RemoveUnderBarredIndices", "[", 
            RowBox[{"Indices", "[", "t", "]"}], "]"}]}], "]"}], ")"}], ",", 
        RowBox[{
         RowBox[{"{", "True", "}"}], "|", 
         RowBox[{"{", "}"}]}]}], "]"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{",", "True", ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"TestDifferentialVector", "::", "TestIndicesFalse"}], ",", 
           "t"}], "]"}], ";", "False"}]}], "]"}], "*)"}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Shouldn", "'"}], "t", " ", "check", " ", "all", " ", "of", 
       " ", "them", " ", "be", " ", 
       StyleBox["upper",
        FontColor->RGBColor[1, 0, 1]], 
       StyleBox[" ",
        FontColor->RGBColor[1, 0, 1]], 
       StyleBox["indices",
        FontColor->RGBColor[1, 0, 1]], " ", "or", " ", 
       StyleBox["no",
        FontColor->RGBColor[1, 0, 1]], 
       StyleBox[" ",
        FontColor->RGBColor[1, 0, 1]], 
       RowBox[{
        StyleBox["index",
         FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], ")"}]}], 
   StyleBox["\n", "Code"], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FullyAntiSymmetricTensorQ", "[", 
     RowBox[{"t_Tensor", ",", 
      RowBox[{"m_Tensor", "/;", 
       RowBox[{"TestMetricTensor", "[", "m", "]"}]}]}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"check", " ", "t", 
          StyleBox[" ",
           FontColor->RGBColor[1, 0.5, 0.5]], "is", " ", "a", " ", 
          StyleBox["fully",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["anti",
           FontColor->RGBColor[1, 0, 1]]}], 
         StyleBox["-",
          FontColor->RGBColor[1, 0, 1]], 
         StyleBox[
          RowBox[{"symm", " ", "tensor"}],
          FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"TensorSymmetry", "[", 
            RowBox[{"LowerAllIndices", "[", 
             RowBox[{"t", ",", "m"}], "]"}], "]"}], "\[LeftDoubleBracket]", 
           "1", "\[RightDoubleBracket]"}], "===", 
          RowBox[{"Antisymmetric", "[", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", 
             RowBox[{"RemoveUnderBarredIndices", "[", 
              RowBox[{"Indices", "[", "t", "]"}], "]"}], "]"}], "]"}], 
           "]"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RankNumber", "[", "t", "]"}], ">", "1"}], ")"}]}], ")"}], "&&", 
      RowBox[{"(*", 
       RowBox[{
        StyleBox["Check",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["indices",
         FontColor->RGBColor[1, 0, 1]], " ", "in", " ", "t", " ", "are", " ", 
        RowBox[{"OK", "."}]}], "*)"}], 
      RowBox[{"MatchQ", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Union", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"TestIndices", "[", "#", "]"}], "&"}], "/@", 
           RowBox[{"RemoveUnderBarredIndices", "[", 
            RowBox[{"Indices", "[", "t", "]"}], "]"}]}], "]"}], ")"}], ",", 
        RowBox[{"{", "True", "}"}]}], "]"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Shouldn", "'"}], "t", " ", "check", " ", "all", " ", "of", 
       " ", "them", " ", "be", " ", 
       StyleBox["upper",
        FontColor->RGBColor[1, 0, 1]], 
       StyleBox[" ",
        FontColor->RGBColor[1, 0, 1]], 
       StyleBox["indices",
        FontColor->RGBColor[1, 0, 1]], 
       StyleBox[" ",
        FontColor->RGBColor[1, 0, 1]], "or", " ", 
       StyleBox["lower",
        FontColor->RGBColor[1, 0, 1]], 
       StyleBox[" ",
        FontColor->RGBColor[1, 0, 1]], 
       RowBox[{
        StyleBox["indices",
         FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TestExpressionForm", "[", "stuff_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Union", "[", 
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"{", "stuff", "}"}], ",", 
           RowBox[{"Tensor", "[", "xx___", "]"}], ",", "\[Infinity]"}], "]"}],
          "]"}], "===", 
        RowBox[{"{", "}"}]}], ")"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Head", "[", "stuff", "]"}], "=!=", "List"}], ")"}]}], 
     ")"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestOneVector", "::", "TestOneVectorFalse"}], "=", 
     "\"\<The argument `1` isn't a 1-vector tensor.\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestOneVector", "[", "\[Xi]_Tensor", "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"Indices", "[", "\[Xi]", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"SuperMinus", "[", "_", "]"}], "}"}]}], "]"}], ")"}], ",", 
       "True", ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"TestOneVector", "::", "TestOneVectorFalse"}], ",", 
          "\[Xi]"}], "]"}], ";", "False"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"WedgeExpand", "[", "tw_TensorWedge", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "dlist", ",", "Permutelist", ",", "sgnlist", ",", "lgth", ",", 
         "result", ",", "ii"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dlist", "=", 
         RowBox[{"tw", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"TensorWedge", "[", "xxx___", "]"}], "\[Rule]", " ", 
            RowBox[{"{", "xxx", "}"}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Permutelist", "=", 
         RowBox[{"Permutations", "[", "dlist", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sgnlist", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Signature", "[", "#", "]"}], "&"}], "/@", 
          "Permutelist"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"lgth", "=", 
         RowBox[{"Length", "[", "Permutelist", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"result", "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"Plus", ",", 
           RowBox[{
            RowBox[{
            "sgnlist", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "sgnlist", "\[LeftDoubleBracket]", "ii", 
                "\[RightDoubleBracket]"}], " ", 
               RowBox[{"TensorProduct", "[", 
                RowBox[{"Sequence", "@@", 
                 RowBox[{
                 "Permutelist", "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "1", ",", "lgth"}], "}"}]}], "]"}]}]}], 
          "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestSymmetricTensorExpressionForm", "[", "stuff_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "texpand", ",", "\[Epsilon]", ",", "a", ",", "\[Epsilon]downpower", 
         ",", "\[Epsilon]uppower"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"texpand", "=", 
         RowBox[{"stuff", "//", "Expand"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "texpand", "}"}], ",", 
                RowBox[{"TensorProduct", "[", 
                 RowBox[{
                  RowBox[{"\[DifferentialD]", "_"}], ",", "__"}], "]"}], ",", 
                "Infinity"}], "]"}], "=!=", 
              RowBox[{"{", "}"}]}], ")"}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "texpand", "}"}], ",", 
                RowBox[{"TensorProduct", "[", 
                 RowBox[{
                  RowBox[{"\[Del]", "_"}], ",", "__"}], "]"}], ",", 
                "Infinity"}], "]"}], "=!=", 
              RowBox[{"{", "}"}]}], ")"}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "texpand", "}"}], ",", 
                RowBox[{"TensorWedge", "[", 
                 RowBox[{
                  RowBox[{"\[DifferentialD]", "_"}], ",", "__"}], "]"}], ",", 
                "Infinity"}], "]"}], "=!=", 
              RowBox[{"{", "}"}]}], ")"}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "texpand", "}"}], ",", 
                RowBox[{"TensorWedge", "[", 
                 RowBox[{
                  RowBox[{"\[Del]", "_"}], ",", "__"}], "]"}], ",", 
                "Infinity"}], "]"}], "=!=", 
              RowBox[{"{", "}"}]}], ")"}]}], ")"}], ",", "False", ",", "True",
           ",", 
          RowBox[{
           RowBox[{"\[Epsilon]downpower", "=", 
            RowBox[{
             FractionBox[
              RowBox[{"texpand", "/.", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[Del]", "a_"}], ")"}], "->", 
                RowBox[{"(", 
                 RowBox[{"\[Epsilon]", 
                  RowBox[{"\[Del]", "a"}]}], ")"}]}]}], "texpand"], "//", 
             "Simplify"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"\[Epsilon]uppower", "=", 
            RowBox[{
             FractionBox[
              RowBox[{"texpand", "/.", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[DifferentialD]", "a_"}], ")"}], "->", 
                RowBox[{"(", 
                 RowBox[{"\[Epsilon]", 
                  RowBox[{"\[DifferentialD]", "a"}]}], ")"}]}]}], "texpand"], 
             "//", "Simplify"}]}], ";", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Epsilon]uppower", "===", "1"}], ")"}], "&&", 
              RowBox[{"MatchQ", "[", 
               RowBox[{"\[Epsilon]downpower", ",", 
                RowBox[{"Power", "[", 
                 RowBox[{"\[Epsilon]", ",", "_"}], "]"}]}], "]"}]}], ",", 
             "True", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Epsilon]downpower", "===", "1"}], ")"}], "&&", 
              RowBox[{"MatchQ", "[", 
               RowBox[{"\[Epsilon]uppower", ",", 
                RowBox[{"Power", "[", 
                 RowBox[{"\[Epsilon]", ",", "_"}], "]"}]}], "]"}]}], ",", 
             "True", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Epsilon]uppower", "===", "1"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"\[Epsilon]downpower", "===", "\[Epsilon]"}], ")"}]}], 
             ",", "True", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Epsilon]downpower", "===", "1"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"\[Epsilon]uppower", "===", "\[Epsilon]"}], ")"}]}], 
             ",", "True", ",", "True", ",", "False"}], "]"}]}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BasisSgn", "[", "stuff_", "]"}], ":=", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"stuff", ",", 
         RowBox[{"\[DifferentialD]", "_"}]}], "]"}], ",", 
       RowBox[{"-", "1"}], ",", 
       RowBox[{"MatchQ", "[", 
        RowBox[{"stuff", ",", 
         RowBox[{"\[Del]", "_"}]}], "]"}], ",", "1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestFormVectorIndices", "[", "t_Tensor", "]"}], ":=", 
     RowBox[{"MatchQ", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Union", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
          RowBox[{"RemoveUnderBarredIndices", "[", 
           RowBox[{"Indices", "[", "t", "]"}], "]"}]}], "]"}], ")"}], ",", 
       RowBox[{
        RowBox[{"{", "1", "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}], "|", 
        RowBox[{"{", "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestFormVectorIndices", "[", "indices_List", "]"}], ":=", 
     RowBox[{"MatchQ", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Union", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
          RowBox[{"RemoveUnderBarredIndices", "[", "indices", "]"}]}], "]"}], 
        ")"}], ",", 
       RowBox[{
        RowBox[{"{", "1", "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}], "|", 
        RowBox[{"{", "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IsThereInertTensor", "::", "RepeatedIndices"}], "=", 
     "\"\<The index `1` is repeated at the same position.\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IsThereInertTensor", "[", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"t_Times", "|", "t_List"}], "/;", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"t", "=!=", 
           RowBox[{"{", "}"}]}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"t", ",", "_Tensor", ",", "Infinity"}], "]"}], "=!=", 
           RowBox[{"{", "}"}]}], ")"}]}], ")"}]}], ")"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "tList", ",", "allInidces", ",", "FlattenAllInidces", ",", "tl", ",", 
        "idxl", ",", "i", ",", "j", ",", "IsItInert", ",", "allInidcesTemp"}],
        "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tList", "=", 
        RowBox[{"(", 
         RowBox[{"Apply", "[", 
          RowBox[{"List", ",", "t"}], "]"}], ")"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"allInidces", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"RemoveUnderBarredIndices", "[", "#", "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Indices", "[", "#", "]"}], "&"}], "/@", "tList"}], 
          ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"FlattenAllInidces", "=", 
        RowBox[{"Flatten", "[", "allInidces", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tl", "=", 
        RowBox[{"Length", "[", "allInidces", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"idxl", "=", 
        RowBox[{"Length", "[", "FlattenAllInidces", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"IsItInert", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "idxl"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"i", "=!=", "j"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"FlattenAllInidces", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], "===", 
               RowBox[{"FlattenAllInidces", "\[LeftDoubleBracket]", 
                RowBox[{"j", ",", "1"}], "\[RightDoubleBracket]"}]}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Sgn", "[", 
                  RowBox[{
                  "FlattenAllInidces", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], "]"}], 
                 RowBox[{"Sgn", "[", 
                  RowBox[{
                  "FlattenAllInidces", "\[LeftDoubleBracket]", "j", 
                   "\[RightDoubleBracket]"}], "]"}]}], ")"}], "===", 
               RowBox[{"-", "1"}]}], ")"}]}], ")"}], ",", 
           RowBox[{"IsItInert", "=", 
            RowBox[{"ReplacePart", "[", 
             RowBox[{"IsItInert", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"i", "->", "1"}], ",", 
                RowBox[{"j", "->", "1"}]}], "}"}]}], "]"}]}], ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"i", "=!=", "j"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"FlattenAllInidces", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], "===", 
               RowBox[{"FlattenAllInidces", "\[LeftDoubleBracket]", 
                RowBox[{"j", ",", "1"}], "\[RightDoubleBracket]"}]}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Sgn", "[", 
                  RowBox[{
                  "FlattenAllInidces", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], "]"}], 
                 RowBox[{"Sgn", "[", 
                  RowBox[{
                  "FlattenAllInidces", "\[LeftDoubleBracket]", "j", 
                   "\[RightDoubleBracket]"}], "]"}]}], ")"}], "===", "1"}], 
              ")"}]}], ")"}], ",", 
           RowBox[{
            RowBox[{"Message", "[", 
             RowBox[{
              RowBox[{"IsThereInertTensor", "::", "RepeatedIndices"}], ",", 
              RowBox[{
              "FlattenAllInidces", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}]}], "]"}], ";"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "idxl"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "i", ",", "idxl"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"allInidcesTemp", "=", "allInidces"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"allInidcesTemp", "=", 
          RowBox[{"ReplacePart", "[", 
           RowBox[{"allInidcesTemp", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"allInidces", ",", 
                RowBox[{
                "FlattenAllInidces", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}], "]"}], "\[LeftDoubleBracket]", 
              "1", "\[RightDoubleBracket]"}], "->", 
             RowBox[{
             "IsItInert", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "idxl"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ZeroTensorQ", "[", "#", "]"}], "&"}], "/@", 
        "allInidcesTemp"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TestTensorsProduct", "[", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"t_Times", "|", "t_List"}], "/;", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"t", "=!=", 
           RowBox[{"{", "}"}]}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"t", ",", "_Tensor", ",", "Infinity"}], "]"}], "=!=", 
           RowBox[{"{", "}"}]}], ")"}]}], ")"}]}], ")"}], "]"}], ":=", 
    RowBox[{"(*", " ", 
     RowBox[{"check", " ", "tensor", " ", "product"}], " ", "*)"}], 
    RowBox[{"(*", " ", 
     RowBox[{"everybody", " ", "is", " ", "a", " ", "Tensor"}], " ", "*)"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Union", "[", 
        RowBox[{"Head", "/@", 
         RowBox[{"(", 
          RowBox[{"Apply", "[", 
           RowBox[{"List", ",", "t"}], "]"}], ")"}]}], "]"}], "===", 
       RowBox[{"{", "Tensor", "}"}]}], ")"}], "&&", 
     RowBox[{"(*", " ", 
      RowBox[{
      "all", " ", "coordinate", " ", "systems", " ", "are", " ", "the", " ", 
       "same"}], " ", "*)"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"Union", "[", 
         RowBox[{"Coordinates", "/@", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"List", ",", "t"}], "]"}], ",", 
            RowBox[{"Tensor", "[", "___", "]"}]}], "]"}]}], "]"}], "]"}], "===",
        "1"}], ")"}], "&&", 
     RowBox[{"(*", 
      RowBox[{
      "All", " ", "scalar", " ", "Tensors", " ", "have", " ", "already", " ", 
       "been", " ", "factored", " ", 
       RowBox[{"out", "."}]}], "*)"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Apply", "[", 
           RowBox[{"List", ",", "t"}], "]"}], ")"}], ",", 
         RowBox[{"(", 
          RowBox[{"st_", "/;", 
           RowBox[{"TestScalarTensor", "[", "st", "]"}]}], ")"}], ",", 
         RowBox[{"{", "1", "}"}]}], "]"}], "===", 
       RowBox[{"{", "}"}]}], ")"}], "&&", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"Apply", "[", 
         RowBox[{"List", ",", "t"}], "]"}], "]"}], "=!=", "1"}], ")"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RepeatedIndices", "[", "IndicesList_List", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "FlattenAllInidces", ",", "GatherFlattenAllIndices", ",", 
         "RepeatedPairs"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"FlattenAllInidces", "=", 
         RowBox[{"RemoveUnderBarredIndices", "[", 
          RowBox[{"Flatten", "[", "IndicesList", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"GatherFlattenAllIndices", "=", 
         RowBox[{"Gather", "[", 
          RowBox[{"FlattenAllInidces", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "===", 
              RowBox[{
              "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             ")"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"RepeatedPairs", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"GatherFlattenAllIndices", ",", 
           RowBox[{
            RowBox[{"{", "xxx___", "}"}], "/;", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"{", "xxx", "}"}], "]"}], "<", "2"}]}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ExtractTheFirstTensor", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
       "t_Tensor", "|", "t_Times", "|", "t_Plus", "|", 
        "t_NonCommutativeMultiply"}], ")"}], "/;", 
      RowBox[{"(", 
       RowBox[{"!", 
        RowBox[{"TestExpressionForm", "[", "t", "]"}]}], ")"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{
       RowBox[{"{", "t", "}"}], ",", "_Tensor", ",", "Infinity"}], "]"}], 
     "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.518287025359375*^9, 3.518287083796875*^9}, {
   3.518287204515625*^9, 3.518287246046875*^9}, {3.518288154015625*^9, 
   3.518288179625*^9}, {3.5196834121875*^9, 3.519683417953125*^9}, {
   3.519689356625*^9, 3.519689356921875*^9}, {3.51976580715625*^9, 
   3.519765810671875*^9}, {3.519963432453125*^9, 3.519963433953125*^9}, 
   3.520125837828125*^9, {3.5201289498125*^9, 3.5201289504375*^9}, 
   3.520219859578125*^9, 3.5202268538125*^9, {3.52027377246875*^9, 
   3.520273831296875*^9}, {3.5202738760625*^9, 3.52027388446875*^9}, {
   3.5202739371875*^9, 3.5202741019375*^9}, {3.52027416353125*^9, 
   3.520274167671875*^9}, 3.520274919453125*^9, {3.52027495775*^9, 
   3.52027500990625*^9}, {3.520275109328125*^9, 3.52027513640625*^9}, {
   3.520275352625*^9, 3.520275353015625*^9}, {3.52027552415625*^9, 
   3.5202755711875*^9}, 3.520275790296875*^9, {3.5202759311875*^9, 
   3.520275948625*^9}, {3.520276746125*^9, 3.5202767880625*^9}, {
   3.52027692378125*^9, 3.52027700428125*^9}, {3.520277061046875*^9, 
   3.520277097125*^9}, {3.520277138046875*^9, 3.520277203125*^9}, {
   3.52027851596875*^9, 3.520278524*^9}, {3.52027856384375*^9, 
   3.520278653328125*^9}, 3.5202787563125*^9, {3.520279456296875*^9, 
   3.5202794635625*^9}, {3.520279561640625*^9, 3.520279567359375*^9}, {
   3.52028006315625*^9, 3.520280068671875*^9}, {3.5202804206875*^9, 
   3.520280495234375*^9}, 3.520281272765625*^9, {3.52028149878125*^9, 
   3.5202815018125*^9}, {3.520281674421875*^9, 3.5202816786875*^9}, {
   3.520281727390625*^9, 3.520281730375*^9}, 3.52028190265625*^9, {
   3.52028213190625*^9, 3.520282169640625*^9}, {3.520282364859375*^9, 
   3.520282395859375*^9}, {3.520282483109375*^9, 3.520282499046875*^9}, {
   3.52028567246875*^9, 3.520285695984375*^9}, {3.5202857606875*^9, 
   3.520285762578125*^9}, {3.520285792890625*^9, 3.520285807109375*^9}, {
   3.5202858616875*^9, 3.52028586721875*^9}, {3.520286964859375*^9, 
   3.520286985015625*^9}, {3.52028713909375*^9, 3.520287168453125*^9}, {
   3.52030002590625*^9, 3.520300043171875*^9}, {3.520300760625*^9, 
   3.520300806765625*^9}, {3.52030106778125*^9, 3.520301101625*^9}, {
   3.520301143203125*^9, 3.520301143921875*^9}, {3.520301203140625*^9, 
   3.520301219734375*^9}, {3.520301382671875*^9, 3.520301408375*^9}, {
   3.5203015531875*^9, 3.520301561859375*^9}, {3.52030160309375*^9, 
   3.52030162021875*^9}, {3.520301674546875*^9, 3.520301675078125*^9}, 
   3.520301885265625*^9, {3.52030235646875*^9, 3.5203024485*^9}, {
   3.52030252584375*^9, 3.520302587984375*^9}, {3.520302792015625*^9, 
   3.520302959515625*^9}, {3.520303101875*^9, 3.520303107296875*^9}, {
   3.520303238609375*^9, 3.52030324271875*^9}, {3.520303299859375*^9, 
   3.520303312609375*^9}, {3.520303594359375*^9, 3.520303669640625*^9}, {
   3.5203528833125*^9, 3.520352917421875*^9}, {3.520353025234375*^9, 
   3.520353134734375*^9}, {3.520353222796875*^9, 3.5203532285*^9}, {
   3.52035363684375*^9, 3.520353648234375*^9}, {3.520371983265625*^9, 
   3.520372009390625*^9}, {3.520372040765625*^9, 3.52037204234375*^9}, {
   3.520373601546875*^9, 3.520373608875*^9}, {3.520373681375*^9, 
   3.5203737725*^9}, {3.520373843515625*^9, 3.520373915828125*^9}, {
   3.520373971703125*^9, 3.520373974734375*^9}, {3.520374036796875*^9, 
   3.5203740864375*^9}, {3.52037473459375*^9, 3.520374758609375*^9}, {
   3.520441968*^9, 3.52044199165625*^9}, {3.5206279314375*^9, 
   3.520627934484375*^9}, {3.52062800871875*^9, 3.52062819365625*^9}, {
   3.52062825025*^9, 3.520628296015625*^9}, {3.5206410005625*^9, 
   3.520641013765625*^9}, {3.5206411729375*^9, 3.52064128375*^9}, {
   3.52064131609375*^9, 3.52064148315625*^9}, {3.5206415455625*^9, 
   3.520641554234375*^9}, {3.52064166375*^9, 3.520641666484375*^9}, {
   3.520641888671875*^9, 3.520641901203125*^9}, {3.520643750953125*^9, 
   3.520643854203125*^9}, {3.52064414540625*^9, 3.5206441485625*^9}, {
   3.520650588828125*^9, 3.52065066803125*^9}, {3.520650699578125*^9, 
   3.52065070521875*^9}, {3.520657060390625*^9, 3.5206570636875*^9}, {
   3.52065709878125*^9, 3.52065723459375*^9}, {3.520657442828125*^9, 
   3.520657443921875*^9}, {3.520657605*^9, 3.5206576095*^9}, {
   3.5206577215625*^9, 3.5206578865625*^9}, {3.520657936875*^9, 
   3.520657960859375*^9}, {3.520658036734375*^9, 3.5206581076875*^9}, 
   3.520658205453125*^9, 3.520658245359375*^9, {3.52065828290625*^9, 
   3.52065836640625*^9}, {3.5206584366875*^9, 3.520658510921875*^9}, {
   3.5206585434375*^9, 3.520658677875*^9}, {3.5206849995625*^9, 
   3.52068500203125*^9}, {3.5206850610625*^9, 3.520685062015625*^9}, {
   3.52068513365625*^9, 3.520685276078125*^9}, {3.520685386484375*^9, 
   3.52068563803125*^9}, {3.520685701375*^9, 3.52068576859375*^9}, {
   3.520687484890625*^9, 3.520687580171875*^9}, {3.52068766728125*^9, 
   3.520687689109375*^9}, 3.52068774225*^9, {3.5206877878125*^9, 
   3.52068786134375*^9}, {3.52068790584375*^9, 3.520687915390625*^9}, {
   3.5206879975625*^9, 3.520688096875*^9}, {3.520702059078125*^9, 
   3.520702403609375*^9}, {3.520702713390625*^9, 3.520702747234375*^9}, {
   3.520702857859375*^9, 3.520702863328125*^9}, {3.5207029781875*^9, 
   3.520703030609375*^9}, {3.520703064421875*^9, 3.520703065890625*^9}, {
   3.520703096765625*^9, 3.5207033071875*^9}, {3.520703396*^9, 
   3.520703496265625*^9}, {3.520705289734375*^9, 3.52070539884375*^9}, {
   3.52070557734375*^9, 3.52070574284375*^9}, {3.520705938328125*^9, 
   3.520705978765625*^9}, {3.520811559984375*^9, 3.520811568390625*^9}, {
   3.520860663984375*^9, 3.520860664375*^9}, {3.520860738359375*^9, 
   3.520860773515625*^9}, {3.520860885328125*^9, 3.520860893125*^9}, {
   3.520872225390625*^9, 3.5208722583125*^9}, {3.52087290084375*^9, 
   3.5208729056875*^9}, {3.520956090890625*^9, 3.520956092171875*^9}, {
   3.520986249875*^9, 3.520986379078125*^9}, {3.520986447203125*^9, 
   3.520986511609375*^9}, {3.52098665503125*^9, 3.5209867026875*^9}, {
   3.520986747078125*^9, 3.520986794875*^9}, {3.52098682703125*^9, 
   3.520986831875*^9}, {3.520987106375*^9, 3.5209872254375*^9}, {
   3.52098728625*^9, 3.52098763690625*^9}, {3.5209876713125*^9, 
   3.520987794484375*^9}, {3.520987831546875*^9, 3.520987898*^9}, {
   3.520987945890625*^9, 3.520987964328125*^9}, {3.5209880521875*^9, 
   3.5209880994375*^9}, {3.52098813075*^9, 3.52098827196875*^9}, {
   3.52098851540625*^9, 3.52098855515625*^9}, {3.52098863653125*^9, 
   3.520988643375*^9}, {3.52098869140625*^9, 3.52098877403125*^9}, {
   3.520988813328125*^9, 3.52098886578125*^9}, {3.5210407265625*^9, 
   3.521040744171875*^9}, {3.521040775625*^9, 3.52104084321875*^9}, {
   3.5210411816875*^9, 3.5210412101875*^9}, {3.52114569015625*^9, 
   3.52114572809375*^9}, {3.521217707265625*^9, 3.521217715671875*^9}, {
   3.521217927546875*^9, 3.521217963875*^9}, {3.521218474890625*^9, 
   3.521218528921875*^9}, {3.5212393095625*^9, 3.521239364875*^9}, {
   3.52123995678125*^9, 3.5212399609375*^9}, {3.521240055671875*^9, 
   3.521240055765625*^9}, {3.521240374234375*^9, 3.521240394703125*^9}, {
   3.52124044365625*^9, 3.52124044465625*^9}, {3.5212405005625*^9, 
   3.521240612515625*^9}, {3.521240755859375*^9, 3.5212408193125*^9}, {
   3.52124087103125*^9, 3.521240905484375*^9}, {3.521241041015625*^9, 
   3.521241097203125*^9}, {3.521241211390625*^9, 3.5212412188125*^9}, 
   3.521241782671875*^9, {3.521242110109375*^9, 3.52124215696875*^9}, {
   3.52124224990625*^9, 3.521242265953125*^9}, {3.521242839421875*^9, 
   3.5212428400625*^9}, {3.521242967421875*^9, 3.521243059640625*^9}, {
   3.521249340421875*^9, 3.521249342140625*^9}, {3.521670656109375*^9, 
   3.52167066703125*^9}, {3.5216734070625*^9, 3.5216734075625*^9}, {
   3.521735025390625*^9, 3.5217351415625*^9}, {3.521736713984375*^9, 
   3.521736714734375*^9}, {3.5217368119375*^9, 3.52173681659375*^9}, {
   3.521736866890625*^9, 3.52173692971875*^9}, {3.521736968203125*^9, 
   3.521737056765625*^9}, {3.521737100265625*^9, 3.52173711903125*^9}, {
   3.52174049478125*^9, 3.521740497515625*^9}, {3.52174100984375*^9, 
   3.521741096328125*^9}, {3.52174246353125*^9, 3.521742495734375*^9}, {
   3.521742742734375*^9, 3.521742875125*^9}, {3.5217464444375*^9, 
   3.521746470625*^9}, {3.52174654271875*^9, 3.521746545015625*^9}, {
   3.52174664240625*^9, 3.52174671003125*^9}, {3.521759207234375*^9, 
   3.521759209796875*^9}, 3.52175925890625*^9, {3.521759304109375*^9, 
   3.521759373078125*^9}, {3.521759445015625*^9, 3.52175954609375*^9}, {
   3.5217604933125*^9, 3.521760600265625*^9}, {3.521760738890625*^9, 
   3.52176074121875*^9}, {3.521786067171875*^9, 3.5217860934375*^9}, {
   3.5219184780625*^9, 3.52191848340625*^9}, {3.521953055046875*^9, 
   3.521953164109375*^9}, {3.52195483903125*^9, 3.521954839609375*^9}, {
   3.5324517659523525`*^9, 3.5324517661551533`*^9}, {3.5395491603981233`*^9, 
   3.5395494300913973`*^9}, {3.539549480229885*^9, 3.5395496299277477`*^9}, {
   3.5395496774922314`*^9, 3.5395497327163286`*^9}, {3.5395513304243345`*^9, 
   3.5395513329359393`*^9}, {3.5395517069153957`*^9, 
   3.5395517093802004`*^9}, {3.5395522120130835`*^9, 
   3.5395522158350897`*^9}, {3.539657249160885*^9, 3.539657249379285*^9}, {
   3.539657530777224*^9, 3.539657683320675*^9}, {3.539657748474284*^9, 
   3.5396578519577208`*^9}, {3.5396578829327927`*^9, 3.539658064724435*^9}, {
   3.5396580988419847`*^9, 3.5396581265820236`*^9}, {3.5396582225813313`*^9, 
   3.5396582969720464`*^9}, {3.5396583348323174`*^9, 3.539658416714452*^9}, {
   3.5396585143905983`*^9, 3.5396585146155987`*^9}, {3.594235766551963*^9, 
   3.5942357667519665`*^9}, {3.5942359148992424`*^9, 
   3.5942359306479845`*^9}, {3.594235985232823*^9, 3.594236066719575*^9}, {
   3.606163049208482*^9, 3.6061630597229004`*^9}, {3.606334715022857*^9, 
   3.606334725084875*^9}, {3.6063347683281507`*^9, 3.606334771276556*^9}, {
   3.606334862817517*^9, 3.606334866265123*^9}, {3.606335898643736*^9, 
   3.606335944055416*^9}, {3.6063360059875245`*^9, 3.6063360129919367`*^9}, {
   3.6063362373926587`*^9, 3.606336362099575*^9}, {3.6063364379287395`*^9, 
   3.6063365192564893`*^9}, {3.606447642770243*^9, 3.6064476438033023`*^9}, {
   3.6064930994988236`*^9, 3.6064931030390263`*^9}, {3.6064948043393345`*^9, 
   3.6064948811087255`*^9}, {3.6064954274349737`*^9, 
   3.6064954335883255`*^9}, {3.6064983162402563`*^9, 3.606498320577064*^9}, 
   3.6064985034717855`*^9, {3.606498554031474*^9, 3.6064985726735067`*^9}, {
   3.6295676201967974`*^9, 3.629567620648599*^9}, {3.629680185017112*^9, 
   3.6296802769560914`*^9}, {3.629680633349614*^9, 3.6296806793637075`*^9}, {
   3.6296807111641808`*^9, 3.629680838737239*^9}, {3.629681034690623*^9, 
   3.6296810520196543`*^9}, {3.6296812822770367`*^9, 3.629681286586645*^9}, {
   3.6296828131213646`*^9, 3.62968282186638*^9}, {3.629683469356697*^9, 
   3.6296835401938224`*^9}, {3.6296838985768557`*^9, 
   3.6296839126178803`*^9}, {3.6296847597020826`*^9, 3.629684933130988*^9}, {
   3.629684969833253*^9, 3.629685071093432*^9}, {3.629692378579189*^9, 
   3.629692529049019*^9}, {3.6296945310987587`*^9, 3.6296945862344627`*^9}, {
   3.6296946321551456`*^9, 3.629694659963399*^9}, {3.629694698707673*^9, 
   3.6296947003310757`*^9}, {3.6297032996087093`*^9, 3.629703465099947*^9}, 
   3.6297035072604094`*^9, {3.629703582225516*^9, 3.629703615624566*^9}, {
   3.6297037732778482`*^9, 3.6297037993748865`*^9}, {3.6297038394719453`*^9, 
   3.6297038411119475`*^9}, {3.6297040065635414`*^9, 
   3.6297040144635525`*^9}, {3.6297040769726453`*^9, 
   3.6297042157658424`*^9}, {3.629704281039935*^9, 3.6297043809580774`*^9}, {
   3.6297048388965054`*^9, 3.6297049164104424`*^9}, {3.6297049658705297`*^9, 
   3.6297049721849413`*^9}, {3.6297280006762824`*^9, 
   3.6297280992754774`*^9}, {3.629728422368769*^9, 3.6297284608957133`*^9}, {
   3.62972858008243*^9, 3.6297286148020597`*^9}, {3.62972867285105*^9, 
   3.6297287468368196`*^9}, {3.6297287911061335`*^9, 
   3.6297287914805336`*^9}, {3.629728981739934*^9, 3.629729013080001*^9}, {
   3.629729062765713*^9, 3.629729082045554*^9}, {3.629826197355792*^9, 
   3.6298262211296344`*^9}, {3.6298263619470034`*^9, 
   3.6298263686862154`*^9}, {3.629826626602665*^9, 3.6298266268366656`*^9}, {
   3.629865613702647*^9, 3.6298656859936457`*^9}, {3.6299294843132706`*^9, 
   3.6299295426011763`*^9}, {3.6697705135537825`*^9, 
   3.6697705493158283`*^9}, {3.6697706062800865`*^9, 3.6697706435802193`*^9}, 
   3.6697706876937428`*^9, {3.6697707712615223`*^9, 3.669770771949562*^9}, {
   3.6697708834759407`*^9, 3.6697708847950163`*^9}, {3.6698270303643155`*^9, 
   3.669827047409546*^9}, {3.672074736338648*^9, 3.6720749366671057`*^9}, {
   3.672082677115674*^9, 3.672082755709381*^9}, {3.826233712688684*^9, 
   3.8262337129721055`*^9}, {3.826233746528405*^9, 3.826233808032279*^9}, {
   3.8273795911151886`*^9, 3.8273796265839396`*^9}, {3.8273798613853607`*^9, 
   3.827379864088481*^9}, {3.8273829817444267`*^9, 3.8273829846924286`*^9}, {
   3.8274024792484355`*^9, 3.827402479956436*^9}, {3.837489538162016*^9, 
   3.837489600662038*^9}, {3.837489707474516*^9, 3.837489737365162*^9}, {
   3.8374897799901657`*^9, 3.8374897842870164`*^9}, {3.837490114162035*^9, 
   3.8374901690057898`*^9}, {3.8374902465066023`*^9, 3.8374902565690827`*^9}, 
   3.837490402615963*^9, {3.8374943905756917`*^9, 3.837494391685067*^9}, {
   3.837497281293601*^9, 3.8374973132947206`*^9}, {3.837497344763449*^9, 
   3.8374973984050045`*^9}, {3.837497743764369*^9, 3.8374977737174788`*^9}, {
   3.8375004667848983`*^9, 3.8375004766286497`*^9}, {3.8375005434880466`*^9, 
   3.8375007012388*^9}, {3.837500766207569*^9, 3.837500774645044*^9}, {
   3.83750083130132*^9, 3.837500834004443*^9}, {3.8375016902478547`*^9, 
   3.8375017014998245`*^9}, {3.83764294835192*^9, 3.837642965670882*^9}, {
   3.8381866345054016`*^9, 3.8381866835929146`*^9}, {3.83818680619582*^9, 
   3.8381869018457375`*^9}, {3.838186988778064*^9, 3.8381872814159007`*^9}, {
   3.838187312675513*^9, 3.8381874712183313`*^9}, {3.838193326754201*^9, 
   3.8381933295624046`*^9}, {3.8447768897264223`*^9, 3.8447769065710335`*^9}, 
   3.844809821679516*^9, 3.844809857897566*^9, {3.844813331778761*^9, 
   3.8448133319857635`*^9}, 3.8448135057552977`*^9, {3.8448138208287325`*^9, 
   3.844813825523732*^9}, {3.8448138641547337`*^9, 3.844813873954732*^9}, {
   3.8448957042424493`*^9, 3.844895705049954*^9}, {3.844902795528102*^9, 
   3.8449027959738283`*^9}, {3.8449433269288645`*^9, 3.8449433272436647`*^9}, 
   3.8449442994474154`*^9, 3.85254528705027*^9, {3.853221145046345*^9, 
   3.853221147646541*^9}, 3.853221298925313*^9, {3.853221481284031*^9, 
   3.853221482393796*^9}, 3.853222456626564*^9, {3.853286346551244*^9, 
   3.85328637663585*^9}, {3.858822474648003*^9, 3.858822486520647*^9}, {
   3.8588228045541835`*^9, 3.858822807593304*^9}, {3.8588228423133273`*^9, 
   3.8588228657458057`*^9}, 3.858823734523964*^9, {3.859457669360976*^9, 
   3.8594577249839745`*^9}, {3.8594578772999773`*^9, 
   3.8594578878339753`*^9}, {3.859459195350464*^9, 3.859459196210469*^9}, {
   3.8595103647586727`*^9, 3.859510419729851*^9}, {3.860099854137153*^9, 
   3.8600998635227714`*^9}, {3.861278495401449*^9, 3.861278496759264*^9}, {
   3.861280690146099*^9, 3.8612806960760436`*^9}, {3.861323440707077*^9, 
   3.861323453629053*^9}, {3.861702799489361*^9, 3.8617028059274726`*^9}, {
   3.861702851573842*^9, 3.861702861402455*^9}, {3.861749447510594*^9, 
   3.8617494567605095`*^9}, {3.86174951548767*^9, 3.861749518210271*^9}, {
   3.867319078220358*^9, 3.867319108790619*^9}, {3.867319192349622*^9, 
   3.8673192504796686`*^9}, {3.867328137199361*^9, 3.867328141559555*^9}, {
   3.8673284801608205`*^9, 3.867328501371873*^9}, {3.867328761414651*^9, 
   3.8673287766082864`*^9}, {3.867374055491091*^9, 3.8673740633872795`*^9}, {
   3.867374101462019*^9, 3.86737410520658*^9}, {3.8685196358008175`*^9, 
   3.8685196480175605`*^9}, {3.8685694653559933`*^9, 
   3.8685696431546087`*^9}, {3.8691004197825994`*^9, 3.869100422711796*^9}, {
   3.869100480102472*^9, 3.8691005624953446`*^9}, 3.8691007784609137`*^9, {
   3.871609781993772*^9, 3.871609805137319*^9}, {3.8716099893833127`*^9, 
   3.8716099909814568`*^9}, {3.871610266571615*^9, 3.8716103126649632`*^9}, 
   3.87161035631427*^9, {3.8716103935139885`*^9, 3.871610404510747*^9}, {
   3.871610434647501*^9, 3.871610453634239*^9}, {3.8716105052126474`*^9, 
   3.871610578548798*^9}, {3.8720448402653103`*^9, 3.8720448765413046`*^9}, {
   3.8720449754073057`*^9, 3.8720449773573055`*^9}, {3.872050407231696*^9, 
   3.872050430252696*^9}, {3.875241872379497*^9, 3.875241884664296*^9}, {
   3.875242044992626*^9, 3.875242065477417*^9}, {3.8752421041757083`*^9, 
   3.8752421567105064`*^9}, {3.8752423545373926`*^9, 3.875242409116314*^9}, {
   3.875242485271899*^9, 3.8752424854281864`*^9}, {3.875747306621274*^9, 
   3.875747351218406*^9}, {3.875747412372419*^9, 3.875747421787624*^9}, {
   3.875747566373525*^9, 3.8757475679563236`*^9}, {3.875748188799568*^9, 
   3.8757482882576504`*^9}, {3.875748328593083*^9, 3.875748389163454*^9}, {
   3.8757525778296647`*^9, 3.8757525917738867`*^9}, {3.876537910017207*^9, 
   3.876537984246462*^9}, {3.876538841552869*^9, 3.876538924151589*^9}, {
   3.8765408310496645`*^9, 3.8765408531651335`*^9}, {3.877048604078147*^9, 
   3.8770486182139072`*^9}, {3.8781806024532485`*^9, 3.878180605990083*^9}, {
   3.878181460491768*^9, 3.878181466395237*^9}, {3.8860367378252277`*^9, 
   3.886036769373989*^9}, {3.8861110572850494`*^9, 3.8861110586152315`*^9}, {
   3.8861112237242017`*^9, 3.8861112397554617`*^9}, {3.886111462711011*^9, 
   3.886111462865919*^9}, {3.886911333879192*^9, 3.8869114164184275`*^9}, {
   3.8869115168304515`*^9, 3.886911517015341*^9}, {3.8869115771443834`*^9, 
   3.886911577339301*^9}, {3.887118464629903*^9, 3.8871185659520597`*^9}, {
   3.8893275028059998`*^9, 3.8893275076665907`*^9}, {3.8893275591362*^9, 
   3.8893275602538233`*^9}, {3.8896015792575617`*^9, 3.889601610572567*^9}, {
   3.889601651354558*^9, 3.889601658982568*^9}, {3.889601706660567*^9, 
   3.8896017213445635`*^9}, {3.889606008728564*^9, 3.8896060316615644`*^9}, {
   3.8896060641245637`*^9, 3.8896060741975594`*^9}, {3.889606105230564*^9, 
   3.8896061396975713`*^9}, {3.8901894676948986`*^9, 
   3.8901894774156446`*^9}, {3.8901926545882063`*^9, 3.890192701868833*^9}, {
   3.891403784075463*^9, 3.8914038092830195`*^9}, 3.8914039729237556`*^9, {
   3.8914057520704284`*^9, 3.8914057780991063`*^9}, {3.8914058110779476`*^9, 
   3.8914058710452957`*^9}, {3.891406699443428*^9, 3.8914068447766*^9}, {
   3.891513291611006*^9, 3.8915133186689367`*^9}, 3.891513825013546*^9, {
   3.8915141593504143`*^9, 3.891514175643307*^9}, {3.891514614036959*^9, 
   3.891514626895515*^9}, {3.8915146609406214`*^9, 3.891514663069034*^9}, {
   3.8915148682529144`*^9, 3.8915148736944265`*^9}, 3.8915150488210125`*^9, 
   3.891515100253293*^9, {3.891515626583662*^9, 3.8915156437915535`*^9}, {
   3.8915156894719*^9, 3.8915157343096676`*^9}, {3.891515956507392*^9, 
   3.891515966538716*^9}, {3.8915160041708794`*^9, 3.8915160043317776`*^9}, {
   3.8915185185007153`*^9, 3.891518524692953*^9}, {3.8915193401295013`*^9, 
   3.891519343456766*^9}, {3.8915685181095343`*^9, 3.8915685193677654`*^9}, {
   3.8915687173167152`*^9, 3.891568857677004*^9}, {3.8915688883292603`*^9, 
   3.8915688937849255`*^9}, {3.8915721228489428`*^9, 
   3.8915721266905937`*^9}, {3.8915721568001823`*^9, 3.891572192745199*^9}, {
   3.8915722460080476`*^9, 3.8915722832398434`*^9}, {3.891572314364813*^9, 
   3.891572326349484*^9}, 3.8920068655997515`*^9, 3.8920069575264406`*^9, {
   3.8920070336818047`*^9, 3.892007055580203*^9}, {3.892013714916459*^9, 
   3.8920137635255327`*^9}, {3.8920796360630183`*^9, 
   3.8920800398370066`*^9}, {3.8920800714965487`*^9, 
   3.8920800771990376`*^9}, {3.8920807568676786`*^9, 
   3.8920807604901605`*^9}, {3.8920809007300034`*^9, 3.892080900862454*^9}, 
   3.8920809384051456`*^9, 3.8920811631800413`*^9, 3.892859751781663*^9, {
   3.8932891237727985`*^9, 3.8932891238897653`*^9}, {3.8932891910286007`*^9, 
   3.8932892327958193`*^9}, {3.894072166536578*^9, 3.894072230726001*^9}, {
   3.8940723537610283`*^9, 3.89407236240666*^9}, 3.8940730272368402`*^9, {
   3.8943450662116814`*^9, 3.89434507853652*^9}, 3.894345312340747*^9, {
   3.8943461640687923`*^9, 3.8943461645990295`*^9}, 3.894346314147188*^9, {
   3.89434884130538*^9, 3.8943488517202196`*^9}, {3.8947748686205235`*^9, 
   3.894774893566926*^9}, {3.89477596172167*^9, 3.894775987397379*^9}, {
   3.894889539787701*^9, 3.8948895778049755`*^9}, {3.8948917327640095`*^9, 
   3.8948917437749877`*^9}, {3.894891956286368*^9, 3.894891958452483*^9}, 
   3.894936303660626*^9, {3.8949363743476477`*^9, 3.894936374531536*^9}, {
   3.8949366963337717`*^9, 3.894936698821799*^9}, 3.894937372559208*^9, {
   3.8950727118765*^9, 3.895072721204378*^9}, 3.895542983530056*^9, 
   3.89554314230307*^9, {3.895553903218855*^9, 3.8955539507071753`*^9}, {
   3.895554773115775*^9, 3.895554779843066*^9}, {3.895554859137924*^9, 
   3.895554859287339*^9}, {3.895555019130292*^9, 3.8955550275299015`*^9}, {
   3.8955551719798512`*^9, 3.8955551749979105`*^9}, {3.8955553393614388`*^9, 
   3.8955553418772044`*^9}, {3.895555421517836*^9, 3.8955555172916403`*^9}, {
   3.895555634958105*^9, 3.8955556368564315`*^9}, {3.8955557161585093`*^9, 
   3.8955557171561604`*^9}, {3.895555769963516*^9, 3.8955557933300533`*^9}, {
   3.895555837964419*^9, 3.8955558424818373`*^9}, 3.8955559714238663`*^9, {
   3.8955560193670197`*^9, 3.8955560194609623`*^9}, {3.8955560900689507`*^9, 
   3.895556090103936*^9}, {3.8985445159994154`*^9, 3.8985445295350947`*^9}, {
   3.898544768630147*^9, 3.898544770783824*^9}, {3.898544845876978*^9, 
   3.8985448459819126`*^9}, {3.951435687129704*^9, 3.951435687970985*^9}, {
   3.953346094544518*^9, 3.953346107061071*^9}, {3.9556824816774807`*^9, 
   3.9556824817023573`*^9}, {3.956193300260743*^9, 3.956193334263279*^9}, {
   3.9561978532916737`*^9, 3.9561978544264393`*^9}, {3.956198213415729*^9, 
   3.956198257150058*^9}, {3.957860960327827*^9, 3.957860962191977*^9}, {
   3.9586956087429857`*^9, 3.958695611470018*^9}, 3.959740158904894*^9, {
   3.9597406749586573`*^9, 3.959740686373345*^9}, {3.959740778361972*^9, 
   3.9597407785272703`*^9}, {3.9597408676450577`*^9, 
   3.9597409436429253`*^9}, {3.959741039837954*^9, 3.959741049421091*^9}, {
   3.95974112021597*^9, 3.959741183836213*^9}, {3.959741254846162*^9, 
   3.959741293861402*^9}, {3.9597415561447573`*^9, 3.9597415795689993`*^9}, 
   3.959741621140835*^9, {3.959741676586298*^9, 3.95974167685183*^9}, {
   3.959741722072824*^9, 3.959741725804297*^9}, {3.959741794216058*^9, 
   3.9597418094768047`*^9}, {3.959741854257229*^9, 3.959741864079122*^9}, 
   3.959742837446514*^9, {3.9598180924831676`*^9, 3.959818092484089*^9}, {
   3.959818233538062*^9, 3.959818251824253*^9}, {3.95993079517163*^9, 
   3.9599308208584213`*^9}, 3.959930991805484*^9, {3.9599325671917458`*^9, 
   3.959932617440741*^9}, 3.9599329784876537`*^9, {3.9599330124271173`*^9, 
   3.959933036549676*^9}, {3.959933891582822*^9, 3.9599339068391848`*^9}, {
   3.9599347439225197`*^9, 3.9599347634018097`*^9}, {3.959935087016955*^9, 
   3.9599351033406*^9}, 3.959935179540215*^9, {3.959935645546524*^9, 
   3.959935659114482*^9}, {3.959935720273478*^9, 3.959935741463636*^9}, {
   3.960454193577656*^9, 3.9604542141337223`*^9}, 3.9604542880434637`*^9, {
   3.9605119064254837`*^9, 3.960511906476753*^9}, {3.9645436965061293`*^9, 
   3.964543713065526*^9}, {3.964543746922634*^9, 3.964543781607724*^9}, {
   3.964544277688055*^9, 3.9645443233949437`*^9}, {3.9645444150208025`*^9, 
   3.964544515499013*^9}, {3.964999166445142*^9, 3.9649992482251053`*^9}, {
   3.9649993349375668`*^9, 3.9649993485095415`*^9}, {3.964999746986768*^9, 
   3.964999775697269*^9}, {3.9650047277544117`*^9, 3.965004736904372*^9}, {
   3.965005065547468*^9, 3.9650050704178944`*^9}, {3.9650052499421496`*^9, 
   3.9650052516206455`*^9}, {3.965005294815542*^9, 3.9650052950257025`*^9}, {
   3.9650096372402697`*^9, 3.9650096382002335`*^9}, {3.965010754944163*^9, 
   3.965010799799668*^9}, {3.965015617333426*^9, 3.965015704760558*^9}, {
   3.965019562148677*^9, 3.965019592307849*^9}, {3.9656149415601397`*^9, 
   3.965614944159192*^9}, {3.965614991650632*^9, 3.9656150271770573`*^9}, {
   3.9656150637792754`*^9, 3.96561509136119*^9}, {3.9656151639755516`*^9, 
   3.965615175154128*^9}, {3.9656154273513527`*^9, 3.965615442434966*^9}, {
   3.9656155955178757`*^9, 3.965615628891315*^9}, {3.965615678003316*^9, 
   3.9656156868772993`*^9}, {3.965615736338723*^9, 3.9656157421987457`*^9}, {
   3.96561580970616*^9, 3.965615818041795*^9}, {3.965615849131153*^9, 
   3.9656158914486933`*^9}, {3.965616191682284*^9, 3.9656162648174887`*^9}, {
   3.9656163108033094`*^9, 3.9656163233959303`*^9}, {3.965616557241619*^9, 
   3.9656165837803907`*^9}, {3.9656173462746425`*^9, 
   3.9656173519925876`*^9}, {3.965694137236744*^9, 3.9656941544404125`*^9}, 
   3.9656964266457386`*^9, {3.965697307175145*^9, 3.9656973078956304`*^9}, {
   3.9656973540966234`*^9, 3.9656974010857534`*^9}, {3.9656986475861564`*^9, 
   3.9656986985408545`*^9}, {3.9656987360708666`*^9, 
   3.9656987441607566`*^9}, {3.965698819128131*^9, 3.9656988348786974`*^9}, {
   3.9656989596758943`*^9, 3.965698960516522*^9}, {3.966394340724614*^9, 
   3.966394376969349*^9}, {3.966394609171338*^9, 3.966394629417343*^9}, {
   3.9671929449493647`*^9, 3.9671929778204403`*^9}, {3.9677774515760307`*^9, 
   3.967777451593813*^9}, {3.967795537056355*^9, 3.9677955444123087`*^9}, {
   3.967797063167994*^9, 3.967797132026815*^9}, {3.967797173325507*^9, 
   3.967797207660359*^9}, {3.968816044817009*^9, 3.968816044855361*^9}, 
   3.968890800472035*^9, 3.969268765994499*^9, 3.969268863611999*^9, {
   3.969268914211975*^9, 3.9692689160768213`*^9}, {3.9692709390763474`*^9, 
   3.969270943346981*^9}, 3.969274543705103*^9, {3.969275924722334*^9, 
   3.969275945298534*^9}, 3.9692760469308863`*^9, 3.969276396553422*^9, {
   3.9694078904426394`*^9, 3.969407902452942*^9}, {3.969408979654887*^9, 
   3.9694089989027033`*^9}, 3.969409195492996*^9, {3.970885072070965*^9, 
   3.970885073326098*^9}, {3.971060193513085*^9, 3.971060225283437*^9}, {
   3.971060645510723*^9, 3.971060670718364*^9}, {3.97108150869063*^9, 
   3.971081535205134*^9}, 3.971083790570856*^9, 3.971142003851305*^9, {
   3.971310397942829*^9, 3.971310400130398*^9}, {3.9725478190701427`*^9, 
   3.972547832551551*^9}, {3.973765519685541*^9, 3.973765545956012*^9}, {
   3.975293115779182*^9, 3.97529311748138*^9}, {3.975301737380973*^9, 
   3.975301739222477*^9}, {3.975307322001874*^9, 3.975307322887088*^9}, {
   3.975307361009404*^9, 3.9753075340482473`*^9}, {3.97530756408475*^9, 
   3.975307734759781*^9}, {3.975307770602796*^9, 
   3.975307856021707*^9}},ExpressionUUID->"488ddccd-bdb8-411d-9891-\
a43103f14aba"]
}, Closed]],

Cell[CellGroupData[{

Cell["Library of Functions", "Section",
 CellChangeTimes->{{3.5203033786875*^9, 3.520303387109375*^9}, {
  3.7916001768949437`*^9, 
  3.7916001819092584`*^9}},ExpressionUUID->"0394dae6-59c8-4959-bedf-\
167b042a8955"],

Cell[CellGroupData[{

Cell["Tensor is the central object", "Subsection",
 CellChangeTimes->{{3.520303402640625*^9, 3.520303409640625*^9}, {
   3.520303686546875*^9, 3.52030371015625*^9}, 3.5213944835*^9, {
   3.5217854575625*^9, 3.521785460828125*^9}, {3.5338529240499988`*^9, 
   3.5338529272400036`*^9}, 
   3.5760884657172747`*^9},ExpressionUUID->"f58072ca-30c6-4a05-b9e6-\
4325729d624a"],

Cell[CellGroupData[{

Cell["Tensor arguments (Reference only, no code)", "Subsubsection",
 CellChangeTimes->{{3.6063967822099867`*^9, 3.6063968013307805`*^9}, {
  3.6063968396278687`*^9, 3.606396846808979*^9}, {3.6063975362315702`*^9, 
  3.6063975388376102`*^9}, {3.6698379480379486`*^9, 3.6698379651247807`*^9}, {
  3.6719079737919607`*^9, 
  3.671907974041561*^9}},ExpressionUUID->"347f41c0-125f-4615-8eab-\
91074a82f150"],

Cell["\<\
The most general Tensor object contains the following arguments

Tensor[
\t TensorType \[Rule] _,
\tTensorName \[Rule] _,
\tIndices \[Rule]{___},
\tTooltipDisplay \[Rule]_,
\tTooltipStyle \[Rule]_,
\tStartIndex\[Rule]si_Integer,
\tCoordinates\[Rule]{coords__},
\tTensorComponents\[Rule]matrix_,
\tChristoffelComponents\[Rule]ChrisRules_,
\tMetricDeterminant\[Rule]Detg_,
\tRiemannComponents\[Rule]RiemRules_,
\tRicciComponents\[Rule]RicRules_,
\tRicciScalarInvariant\[Rule]RRules_,
\tTensorSymmetry\[Rule]tsdisplay_,
\tFlatMetric\[Rule]fm_,
\tOrthonormalFrameField\[Rule]onffuser_,
\tInverseOrthonormalFrameField\[Rule]invonffuser_,
\tOrthonormalFrameFieldOperator\[Rule]onffop_,
\tTensorOperator\[Rule]#&,
\tTensorAssumption\[Rule]{TA_}
]\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{
  3.52062706340625*^9, {3.520627119109375*^9, 3.520627468984375*^9}, {
   3.5206275175625*^9, 3.520627645890625*^9}, {3.520627685671875*^9, 
   3.52062771053125*^9}, {3.520871722765625*^9, 3.5208718686875*^9}, {
   3.520871910671875*^9, 3.520872034078125*^9}, {3.5211465243125*^9, 
   3.521146592921875*^9}, {3.52169831134375*^9, 3.52169842040625*^9}, {
   3.521757643875*^9, 3.52175766646875*^9}, {3.533851610091141*^9, 
   3.5338517032134724`*^9}, {3.5338517361105185`*^9, 3.533851746077533*^9}, {
   3.5338517820915833`*^9, 3.5338517925207987`*^9}, {3.533851847610076*^9, 
   3.533851870463108*^9}, {3.5338519006333513`*^9, 3.533851943159811*^9}, {
   3.5338519863398733`*^9, 3.5338521403542914`*^9}, {3.5468009779741535`*^9, 
   3.5468011006215687`*^9}, {3.606085122492715*^9, 3.6060853016949644`*^9}, {
   3.6060859133179474`*^9, 3.606085916498129*^9}, {3.6061492735689363`*^9, 
   3.606149296602254*^9}, 3.606397519540814*^9, 3.629916429023525*^9, {
   3.847244257730279*^9, 3.8472442954109335`*^9}, {3.847244335067897*^9, 
   3.8472444168119583`*^9}, {3.8478536294293175`*^9, 
   3.8478536455474596`*^9}, {3.847965569065133*^9, 3.8479655838672867`*^9}, {
   3.8613232982289467`*^9, 3.8613233362820063`*^9}, {3.861323369629843*^9, 
   3.861323405496088*^9}, {3.8872470886921525`*^9, 3.887247129167467*^9}, 
   3.899114208633295*^9, 3.956199042431635*^9, 3.9677774515995665`*^9, {
   3.971053413936112*^9, 3.9710534144789886`*^9}, {3.975308354256296*^9, 
   3.975308382501849*^9}},ExpressionUUID->"716b76f7-1c47-4ae9-82fd-\
d41c62af3adf"]
}, Closed]],

Cell[CellGroupData[{

Cell["TensorType (Reference only, no code)", "Subsubsection",
 CellChangeTimes->{{3.6063967822099867`*^9, 3.6063968013307805`*^9}, {
  3.6063968396278687`*^9, 3.606396846808979*^9}, {3.6063975362315702`*^9, 
  3.6063975388376102`*^9}, {3.6698379480379486`*^9, 3.6698379651247807`*^9}, {
  3.6719079737919607`*^9, 3.671907974041561*^9}, {3.837838959782662*^9, 
  3.8378389663491554`*^9}},ExpressionUUID->"aae06da9-a5bf-477a-96de-\
902d8c8b5643"],

Cell["\<\
Null (Default value for NonMetricTensor)
\[OpenCurlyDoubleQuote]Metric\[CloseCurlyDoubleQuote]
\[OpenCurlyDoubleQuote]ChristoffelSymbols\[CloseCurlyDoubleQuote]
MHDSystem:
\[OpenCurlyDoubleQuote]Gradient\[CloseCurlyDoubleQuote]
\[OpenCurlyDoubleQuote]Maxwell\[CloseCurlyDoubleQuote]
\[OpenCurlyDoubleQuote]MHDMaxwell\[CloseCurlyDoubleQuote]
\[OpenCurlyDoubleQuote]3-Form\[CloseCurlyDoubleQuote]
\[OpenCurlyDoubleQuote]2-Form\[CloseCurlyDoubleQuote]
\[OpenCurlyDoubleQuote]MHDPlasma\[CloseCurlyDoubleQuote]
\[OpenCurlyDoubleQuote]MHDMaxwellPlasma\[CloseCurlyDoubleQuote]
\[OpenCurlyDoubleQuote]MaxwellCurrent\[CloseCurlyDoubleQuote]
\[OpenCurlyDoubleQuote]Faraday\[CloseCurlyDoubleQuote]\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{
  3.52062706340625*^9, {3.520627119109375*^9, 3.520627468984375*^9}, {
   3.5206275175625*^9, 3.520627645890625*^9}, {3.520627685671875*^9, 
   3.52062771053125*^9}, {3.520871722765625*^9, 3.5208718686875*^9}, {
   3.520871910671875*^9, 3.520872034078125*^9}, {3.5211465243125*^9, 
   3.521146592921875*^9}, {3.52169831134375*^9, 3.52169842040625*^9}, {
   3.521757643875*^9, 3.52175766646875*^9}, {3.533851610091141*^9, 
   3.5338517032134724`*^9}, {3.5338517361105185`*^9, 3.533851746077533*^9}, {
   3.5338517820915833`*^9, 3.5338517925207987`*^9}, {3.533851847610076*^9, 
   3.533851870463108*^9}, {3.5338519006333513`*^9, 3.533851943159811*^9}, {
   3.5338519863398733`*^9, 3.5338521403542914`*^9}, {3.5468009779741535`*^9, 
   3.5468011006215687`*^9}, {3.606085122492715*^9, 3.6060853016949644`*^9}, {
   3.6060859133179474`*^9, 3.606085916498129*^9}, {3.6061492735689363`*^9, 
   3.606149296602254*^9}, 3.606397519540814*^9, 3.629916429023525*^9, {
   3.8378389721195645`*^9, 3.8378390546689687`*^9}, {3.837839088777255*^9, 
   3.837839102753378*^9}, {3.8378394513540354`*^9, 3.837839452419655*^9}, {
   3.8378395321632004`*^9, 3.837839532379404*^9}, {3.8378406005332117`*^9, 
   3.8378406007494135`*^9}, {3.8378406777798877`*^9, 
   3.8378407402101974`*^9}, {3.837840824670477*^9, 3.8378408493262377`*^9}, {
   3.8378408901534643`*^9, 3.8378410023324246`*^9}, {3.8478331489380193`*^9, 
   3.8478331493371954`*^9}, {3.8478333480185733`*^9, 
   3.8478333484615726`*^9}, {3.895546122608015*^9, 3.8955461274002714`*^9}, {
   3.8991146823111343`*^9, 3.8991147034312716`*^9}, 3.97376534516042*^9, {
   3.9752937135472274`*^9, 3.975293714313915*^9}, {3.9753083438155117`*^9, 
   3.975308346154786*^9}},ExpressionUUID->"fc9f0a89-a684-46e6-a8c0-\
f326a0c35007"]
}, Closed]],

Cell[CellGroupData[{

Cell["Metric", "Subsubsection",
 CellChangeTimes->{{3.861141688680252*^9, 
  3.861141691869981*^9}},ExpressionUUID->"40e9b7b5-f29e-4b42-a7e9-\
fa207ff66c33"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   StyleBox["Metric",
    FontColor->RGBColor[0.5, 0, 0.5]], 
   StyleBox[" ",
    FontColor->GrayLevel[0.5]], 
   StyleBox["*)",
    FontColor->GrayLevel[0.5]]}], 
  StyleBox["\[IndentingNewLine]",
   FontColor->GrayLevel[0.5]], 
  RowBox[{
   StyleBox["(*",
    FontColor->GrayLevel[0.5]], 
   StyleBox[" ",
    FontColor->GrayLevel[0.5]], 
   StyleBox[
    RowBox[{
    "this", " ", "is", " ", "how", " ", "we", " ", "are", " ", "going", " ", 
     "to", " ", "input", " ", "a", " ", "metric", " ", "and", " ", "compute", 
     " ", "geometric", " ", "objects"}],
    FontColor->RGBColor[0, 0, 1]], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"TensorType", "\[Rule]", "\"\<Metric\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TensorName", "\[Rule]", "name_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"StartIndex", "\[Rule]", 
         RowBox[{"si_Integer", "/;", 
          RowBox[{"si", "\[GreaterEqual]", "0"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Indices", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Mu]T_", "/;", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"TestIndices", "[", "\[Mu]T", "]"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Head", "[", 
                 RowBox[{
                 "\[Mu]T", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "]"}], "===", "Symbol"}], 
               ")"}]}], ")"}]}], ",", 
           RowBox[{"\[Nu]T_", "/;", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"TestIndices", "[", "\[Nu]T", "]"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Head", "[", 
                 RowBox[{
                 "\[Nu]T", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "]"}], "===", "Symbol"}], 
               ")"}]}], ")"}]}]}], "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Coordinates", "\[Rule]", 
         RowBox[{"coords_List", "/;", 
          RowBox[{"MatchQ", "[", 
           RowBox[{
            RowBox[{"Dimensions", "[", "coords", "]"}], ",", 
            RowBox[{"{", "_Integer", "}"}]}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TensorComponents", "\[Rule]", 
         RowBox[{"matrix_", "/;", 
          RowBox[{"MatchQ", "[", 
           RowBox[{
            RowBox[{"Dimensions", "[", "matrix", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"nn_", ",", "nn_"}], "}"}]}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ChristoffelOperator", "\[Rule]", "ChrisOp_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"RiemannOperator", "\[Rule]", "RiemannOp_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"RicciOperator", "\[Rule]", "RicciOp_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"RicciScalarOperator", "\[Rule]", "RicciSOp_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TooltipDisplay", "\[Rule]", "ttdisplay_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TooltipStyle", "\[Rule]", "ttstyle_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"FlatMetric", "\[Rule]", "fm_"}], ",", "\[IndentingNewLine]", 
        RowBox[{"OrthonormalFrameField", "\[Rule]", "onffuser_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "invonffuser_"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"OrthonormalFrameFieldOperator", "\[Rule]", "onffop_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"OrthonormalFrameFieldIndices", "\[Rule]", "onffidx_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TensorAssumption", "\[Rule]", "TA_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TensorOperator", "\[Rule]", " ", "Top_"}]}], 
       "\[IndentingNewLine]", "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"SubMinus", "[", "_", "]"}], ",", 
            RowBox[{"SubMinus", "[", "_", "]"}]}], "}"}]}], "]"}], "||", 
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"SuperMinus", "[", "_", "]"}], ",", 
            RowBox[{"SuperMinus", "[", "_", "]"}]}], "}"}]}], "]"}]}], 
       ")"}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "Detg", ",", "MetricT", ",", "MetricM", ",", "Ch", ",", "RiemannP", 
         ",", "Riemann", ",", "RicciT", ",", "RicciS", ",", "Metric", ",", 
         "MetricInv", ",", "\[IndentingNewLine]", "\t", "\[Alpha]", ",", 
         "\[Beta]", ",", "\[Mu]", ",", "\[Nu]", ",", "d", ",", "\[Lambda]", 
         ",", "\[Sigma]", ",", "coord", ",", "gInv", ",", 
         "\[IndentingNewLine]", "\t", "RiemannRules", ",", "RicciTensorRules",
          ",", "RicciScalarRule", ",", "ChristoffelRules"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"\"\<load\>\"", " ", "the", " ", "metric"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MetricM", "=", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"lower", " ", "indices"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"SubMinus", "[", "_", "]"}], ",", 
               RowBox[{"SubMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", "matrix", ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"upper", " ", "indices"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"SuperMinus", "[", "_", "]"}], ",", 
               RowBox[{"SuperMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Inverse", "[", "matrix", "]"}]}], "\[IndentingNewLine]", 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"d", "=", 
         RowBox[{"Length", "[", "coords", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"for", " ", "internal", " ", "computation", " ", "here"}], 
          ",", " ", 
          RowBox[{
           RowBox[{"we", " ", "set", " ", "StartIndex"}], " ", "\[Rule]", " ",
            "0"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"coord", "[", "\[Alpha]_", "]"}], ":=", 
         RowBox[{"coords", "\[LeftDoubleBracket]", 
          RowBox[{"\[Alpha]", "+", "1"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "tools", " ", "to", " ", "compute", " ", "tensor", " ", 
          "components"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Detg", "=", 
         RowBox[{"Simplify", "[", 
          RowBox[{"Det", "[", "MetricM", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Metric", "[", 
          RowBox[{"\[Mu]_", ",", "\[Nu]_"}], "]"}], ":=", 
         RowBox[{"MetricM", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"\[Mu]", "+", "1"}], ",", 
           RowBox[{"\[Nu]", "+", "1"}]}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"MetricInv", "[", 
          RowBox[{"\[Mu]_", ",", "\[Nu]_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{"Inverse", "[", "MetricM", "]"}], "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"\[Mu]", "+", "1"}], ",", 
           RowBox[{"\[Nu]", "+", "1"}]}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Ch", "[", 
          RowBox[{"\[Mu]_", ",", "\[Alpha]_", ",", "\[Beta]_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "2"}], ")"}], 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"MetricInv", "[", 
              RowBox[{"\[Mu]", ",", "\[Lambda]"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"Metric", "[", 
                  RowBox[{"\[Beta]", ",", "\[Lambda]"}], "]"}], ",", 
                 RowBox[{"coord", "[", "\[Alpha]", "]"}]}], "]"}], "+", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"Metric", "[", 
                  RowBox[{"\[Alpha]", ",", "\[Lambda]"}], "]"}], ",", 
                 RowBox[{"coord", "[", "\[Beta]", "]"}]}], "]"}], "-", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"Metric", "[", 
                  RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], ",", 
                 RowBox[{"coord", "[", "\[Lambda]", "]"}]}], "]"}]}], ")"}]}],
             ",", 
            RowBox[{"{", 
             RowBox[{"\[Lambda]", ",", "0", ",", 
              RowBox[{"d", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"RiemannP", "[", 
          RowBox[{
          "\[Alpha]_", ",", "\[Beta]_", ",", "\[Mu]_", ",", "\[Nu]_"}], "]"}],
          ":=", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"Ch", "[", 
             RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Nu]"}], "]"}], ",", 
            RowBox[{"coord", "[", "\[Mu]", "]"}]}], "]"}], "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Ch", "[", 
              RowBox[{"\[Alpha]", ",", "\[Mu]", ",", "\[Sigma]"}], "]"}], 
             RowBox[{"Ch", "[", 
              RowBox[{"\[Sigma]", ",", "\[Beta]", ",", "\[Nu]"}], "]"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"\[Sigma]", ",", "0", ",", 
              RowBox[{"d", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Riemann", "[", 
          RowBox[{
          "\[Alpha]_", ",", "\[Beta]_", ",", "\[Mu]_", ",", "\[Nu]_"}], "]"}],
          ":=", 
         RowBox[{
          RowBox[{"RiemannP", "[", 
           RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Mu]", ",", "\[Nu]"}], 
           "]"}], "-", 
          RowBox[{"RiemannP", "[", 
           RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Nu]", ",", "\[Mu]"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"RicciT", "[", 
          RowBox[{"\[Beta]_", ",", "\[Nu]_"}], "]"}], ":=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Riemann", "[", 
            RowBox[{"\[Mu]", ",", "\[Beta]", ",", "\[Mu]", ",", "\[Nu]"}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Mu]", ",", "0", ",", 
             RowBox[{"d", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
        RowBox[{"RicciS", ":=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"MetricInv", "[", 
             RowBox[{"\[Beta]", ",", "\[Nu]"}], "]"}], 
            RowBox[{"RicciT", "[", 
             RowBox[{"\[Beta]", ",", "\[Nu]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Beta]", ",", "0", ",", 
             RowBox[{"d", "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Nu]", ",", "0", ",", 
             RowBox[{"d", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "start", " ", "from", " ", "the", " ", "empty", " ", "List"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"RiemannRules", "=", 
         RowBox[{"{", "}"}]}], ";", 
        RowBox[{"RicciTensorRules", "=", 
         RowBox[{"{", "}"}]}], ";", 
        RowBox[{"ChristoffelRules", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "\"\<Do\>\"", " ", "the", " ", "computation", " ", "and", " ", 
          "save", " ", "as", " ", "rules"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Metric", "[", 
            RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}], "=", 
           RowBox[{"Metric", "[", 
            RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Mu]", ",", "0", ",", 
            RowBox[{"d", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Nu]", ",", "0", ",", 
            RowBox[{"d", "-", "1"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MetricInv", "[", 
            RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}], "=", 
           RowBox[{"MetricInv", "[", 
            RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Mu]", ",", "0", ",", 
            RowBox[{"d", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Nu]", ",", "0", ",", 
            RowBox[{"d", "-", "1"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Ch", "[", 
             RowBox[{"\[Mu]", ",", "\[Alpha]", ",", "\[Beta]"}], "]"}], "=", 
            RowBox[{"ChrisOp", "[", 
             RowBox[{"Ch", "[", 
              RowBox[{"\[Mu]", ",", "\[Alpha]", ",", "\[Beta]"}], "]"}], 
             "]"}]}], ";", 
           RowBox[{"ChristoffelRules", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"ChristoffelRules", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"ChristoffelComponents", "[", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"si", "+", "\[Mu]"}], ")"}], "-"], ",", 
                  SubscriptBox[
                   RowBox[{"(", 
                    RowBox[{"si", "+", "\[Alpha]"}], ")"}], "-"], ",", 
                  SubscriptBox[
                   RowBox[{"(", 
                    RowBox[{"si", "+", "\[Beta]"}], ")"}], "-"]}], "]"}], 
                "\[Rule]", 
                RowBox[{"Ch", "[", 
                 RowBox[{"\[Mu]", ",", "\[Alpha]", ",", "\[Beta]"}], "]"}]}], 
               "}"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"\[Mu]", ",", "0", ",", 
            RowBox[{"d", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]", ",", "0", ",", 
            RowBox[{"d", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Beta]", ",", "0", ",", 
            RowBox[{"d", "-", "1"}]}], "}"}]}], "]"}], ";", "\n", "\t", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Riemann", "[", 
             RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Mu]", ",", "\[Nu]"}],
              "]"}], "=", 
            RowBox[{"RiemannOp", "[", 
             RowBox[{"Riemann", "[", 
              RowBox[{
              "\[Alpha]", ",", "\[Beta]", ",", "\[Mu]", ",", "\[Nu]"}], "]"}],
              "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"RiemannRules", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"RiemannRules", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"RiemannComponents", "[", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"si", "+", "\[Alpha]"}], ")"}], "-"], ",", 
                  SubscriptBox[
                   RowBox[{"(", 
                    RowBox[{"si", "+", "\[Beta]"}], ")"}], "-"], ",", 
                  SubscriptBox[
                   RowBox[{"(", 
                    RowBox[{"si", "+", "\[Mu]"}], ")"}], "-"], ",", 
                  SubscriptBox[
                   RowBox[{"(", 
                    RowBox[{"si", "+", "\[Nu]"}], ")"}], "-"]}], "]"}], 
                "\[Rule]", 
                RowBox[{"Riemann", "[", 
                 RowBox[{
                 "\[Alpha]", ",", "\[Beta]", ",", "\[Mu]", ",", "\[Nu]"}], 
                 "]"}]}], "}"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"\[Mu]", ",", "0", ",", 
            RowBox[{"d", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Nu]", ",", "0", ",", 
            RowBox[{"d", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]", ",", "0", ",", 
            RowBox[{"d", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Beta]", ",", "0", ",", 
            RowBox[{"d", "-", "1"}]}], "}"}]}], "]"}], ";", "\n", "\t", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"RicciT", "[", 
             RowBox[{"\[Beta]", ",", "\[Nu]"}], "]"}], "=", 
            RowBox[{"RicciOp", "[", 
             RowBox[{"RicciT", "[", 
              RowBox[{"\[Beta]", ",", "\[Nu]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"RicciTensorRules", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"RicciTensorRules", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"RicciComponents", "[", 
                 RowBox[{
                  SubscriptBox[
                   RowBox[{"(", 
                    RowBox[{"si", "+", "\[Beta]"}], ")"}], "-"], ",", 
                  SubscriptBox[
                   RowBox[{"(", 
                    RowBox[{"si", "+", "\[Nu]"}], ")"}], "-"]}], "]"}], 
                "\[Rule]", 
                RowBox[{"RicciT", "[", 
                 RowBox[{"\[Beta]", ",", "\[Nu]"}], "]"}]}], "}"}]}], 
             "]"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"\[Beta]", ",", "0", ",", 
            RowBox[{"d", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Nu]", ",", "0", ",", 
            RowBox[{"d", "-", "1"}]}], "}"}]}], "]"}], ";", "\n", "\t", 
        RowBox[{"RicciS", "=", 
         RowBox[{"RicciSOp", "[", "RicciS", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"RicciScalarRule", "=", 
         RowBox[{"{", 
          RowBox[{"RicciScalar", "\[Rule]", "RicciS"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TensorType", "\[Rule]", "\"\<Metric\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TensorName", "\[Rule]", "name"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Coordinates", "\[Rule]", "coords"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", "matrix"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"MetricDeterminant", "\[Rule]", "Detg"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ChristoffelComponents", "\[Rule]", 
           RowBox[{"Flatten", "[", "ChristoffelRules", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"RiemannComponents", "\[Rule]", 
           RowBox[{"Flatten", "[", "RiemannRules", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"RicciComponents", "\[Rule]", 
           RowBox[{"Flatten", "[", "RicciTensorRules", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"RicciScalarInvariant", "\[Rule]", 
           RowBox[{"Flatten", "[", "RicciScalarRule", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TooltipDisplay", "\[Rule]", "ttdisplay"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TooltipStyle", "\[Rule]", "ttstyle"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"FlatMetric", "\[Rule]", "fm"}], ",", "\[IndentingNewLine]", 
          RowBox[{"OrthonormalFrameField", "\[Rule]", "onffuser"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "invonffuser"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"OrthonormalFrameFieldOperator", "\[Rule]", "onffop"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"OrthonormalFrameFieldIndices", "\[Rule]", "onffidx"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"TensorAssumption", "\[Rule]", "TA"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TensorOperator", "\[Rule]", " ", "Top"}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    StyleBox[
     RowBox[{"Metric", ":", " ", 
      RowBox[{
      "If", " ", "one", " ", "up", " ", "and", " ", "one", " ", "down", " ", 
       "index", " ", "TensorName", " ", "is", " ", "changed", " ", "to", " ", 
       "\[Delta]"}]}],
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox[" ",
     FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "this", " ", "is", " ", "also", " ", "good", " ", "reminder", " ", "that",
      " ", "going", " ", "to", " ", "one", " ", "up", " ", "one", " ", "down",
      " ", "indices", " ", "throws", " ", "away", " ", "info", " ", "on", " ",
      "the", " ", "metric", " ", "itself"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
      RowBox[{"xx___", ",", "\[IndentingNewLine]", 
       RowBox[{"TensorType", "\[Rule]", "\"\<Metric\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Indices", "\[Rule]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i1_", ",", "i2_"}], "}"}], "/;", 
         RowBox[{"(", 
          RowBox[{"(*", " ", 
           RowBox[{"one", " ", "up", " ", "and", " ", "one", " ", "down"}], 
           " ", "*)"}], 
          RowBox[{
           RowBox[{
            RowBox[{"Sgn", "[", "i1", "]"}], 
            RowBox[{"Sgn", "[", "i2", "]"}]}], "===", 
           RowBox[{"-", "1"}]}], ")"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"TensorName", "\[Rule]", 
        RowBox[{"name_", "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
            "name", "=!=", 
             "\"\<\!\(\*StyleBox[\"\[Delta]\",FontSlant->\"Italic\"]\)\>\""}],
             ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"name", "=!=", "\"\<\[Delta]\>\""}], ")"}]}], ")"}]}]}]}],
       "\[IndentingNewLine]", "]"}], ":=", 
     RowBox[{"Tensor", "[", 
      RowBox[{"xx", ",", 
       RowBox[{"TensorType", "\[Rule]", "\"\<Metric\>\""}], ",", 
       RowBox[{"Indices", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"i1", ",", "i2"}], "}"}]}], ",", 
       RowBox[{"TensorName", "\[Rule]", "\"\<\[Delta]\>\""}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.518287025359375*^9, 3.518287083796875*^9}, {
   3.518287204515625*^9, 3.518287246046875*^9}, {3.518288154015625*^9, 
   3.518288179625*^9}, {3.5196834121875*^9, 3.519683417953125*^9}, {
   3.519689356625*^9, 3.519689356921875*^9}, {3.51976580715625*^9, 
   3.519765810671875*^9}, {3.519963432453125*^9, 3.519963433953125*^9}, 
   3.520125837828125*^9, {3.5201289498125*^9, 3.5201289504375*^9}, 
   3.520219859578125*^9, 3.5202268538125*^9, {3.52027377246875*^9, 
   3.520273831296875*^9}, {3.5202738760625*^9, 3.52027388446875*^9}, {
   3.5202739371875*^9, 3.5202741019375*^9}, {3.52027416353125*^9, 
   3.520274167671875*^9}, 3.520274919453125*^9, {3.52027495775*^9, 
   3.52027500990625*^9}, {3.520275109328125*^9, 3.52027513640625*^9}, {
   3.520275352625*^9, 3.520275353015625*^9}, {3.52027552415625*^9, 
   3.5202755711875*^9}, 3.520275790296875*^9, {3.5202759311875*^9, 
   3.520275948625*^9}, {3.520276746125*^9, 3.5202767880625*^9}, {
   3.52027692378125*^9, 3.52027700428125*^9}, {3.520277061046875*^9, 
   3.520277097125*^9}, {3.520277138046875*^9, 3.520277203125*^9}, {
   3.52027851596875*^9, 3.520278524*^9}, {3.52027856384375*^9, 
   3.520278653328125*^9}, 3.5202787563125*^9, {3.520279456296875*^9, 
   3.5202794635625*^9}, {3.520279561640625*^9, 3.520279567359375*^9}, {
   3.52028006315625*^9, 3.520280068671875*^9}, {3.5202804206875*^9, 
   3.520280495234375*^9}, 3.520281272765625*^9, {3.52028149878125*^9, 
   3.5202815018125*^9}, {3.520281674421875*^9, 3.5202816786875*^9}, {
   3.520281727390625*^9, 3.520281730375*^9}, 3.52028190265625*^9, {
   3.52028213190625*^9, 3.520282169640625*^9}, {3.520282364859375*^9, 
   3.520282395859375*^9}, {3.520282483109375*^9, 3.520282499046875*^9}, {
   3.52028567246875*^9, 3.520285695984375*^9}, {3.5202857606875*^9, 
   3.520285762578125*^9}, {3.520285792890625*^9, 3.520285807109375*^9}, {
   3.5202858616875*^9, 3.52028586721875*^9}, {3.520286964859375*^9, 
   3.520286985015625*^9}, {3.52028713909375*^9, 3.520287168453125*^9}, {
   3.52030002590625*^9, 3.520300043171875*^9}, {3.520300760625*^9, 
   3.520300806765625*^9}, {3.52030106778125*^9, 3.520301101625*^9}, {
   3.520301143203125*^9, 3.520301143921875*^9}, {3.520301203140625*^9, 
   3.520301219734375*^9}, {3.520301382671875*^9, 3.520301408375*^9}, {
   3.5203015531875*^9, 3.520301561859375*^9}, {3.52030160309375*^9, 
   3.52030162021875*^9}, {3.520301674546875*^9, 3.520301675078125*^9}, 
   3.520301885265625*^9, {3.52030235646875*^9, 3.5203024485*^9}, {
   3.52030252584375*^9, 3.520302587984375*^9}, {3.520302792015625*^9, 
   3.520302959515625*^9}, {3.520303101875*^9, 3.520303107296875*^9}, {
   3.520303238609375*^9, 3.52030324271875*^9}, {3.520303299859375*^9, 
   3.520303323609375*^9}, 3.5203034191875*^9, {3.5203509418125*^9, 
   3.520350955265625*^9}, {3.520374181640625*^9, 3.52037419353125*^9}, {
   3.52037428890625*^9, 3.52037429225*^9}, {3.520374390359375*^9, 
   3.520374391046875*^9}, {3.52037449153125*^9, 3.520374508859375*^9}, {
   3.520374542359375*^9, 3.520374562515625*^9}, {3.520374665328125*^9, 
   3.520374666125*^9}, {3.520374798734375*^9, 3.5203748170625*^9}, {
   3.520442091734375*^9, 3.520442103078125*^9}, {3.520442156859375*^9, 
   3.520442237609375*^9}, {3.520442932203125*^9, 3.520442946328125*^9}, 
   3.5204430529375*^9, {3.520449654171875*^9, 3.520449741703125*^9}, {
   3.520461701390625*^9, 3.52046171115625*^9}, {3.520461829296875*^9, 
   3.5204618643125*^9}, {3.52046189925*^9, 3.5204619086875*^9}, {
   3.520462190671875*^9, 3.520462199265625*^9}, {3.520462248390625*^9, 
   3.520462255953125*^9}, {3.52046263196875*^9, 3.520462676203125*^9}, {
   3.520462781609375*^9, 3.520462783296875*^9}, {3.52046295721875*^9, 
   3.52046300696875*^9}, {3.520463069578125*^9, 3.520463097359375*^9}, {
   3.52046330721875*^9, 3.520463328234375*^9}, {3.520463500234375*^9, 
   3.520463506578125*^9}, {3.5204635759375*^9, 3.52046357878125*^9}, {
   3.520463627625*^9, 3.520463634921875*^9}, {3.52046371734375*^9, 
   3.520463719828125*^9}, {3.520463799875*^9, 3.52046387153125*^9}, {
   3.5204646916875*^9, 3.520464736625*^9}, {3.52069951259375*^9, 
   3.520699699609375*^9}, {3.520699992109375*^9, 3.52069999440625*^9}, {
   3.520811957234375*^9, 3.520812132578125*^9}, {3.52081218434375*^9, 
   3.520812365828125*^9}, {3.520812564921875*^9, 3.520812569625*^9}, {
   3.5208126603125*^9, 3.520812664359375*^9}, {3.5208127515*^9, 
   3.52081275875*^9}, {3.520812849*^9, 3.520812859109375*^9}, {
   3.520812903453125*^9, 3.5208130645*^9}, {3.520813114734375*^9, 
   3.520813119109375*^9}, {3.52081316215625*^9, 3.52081316665625*^9}, {
   3.5208133298125*^9, 3.520813333390625*^9}, {3.5208135518125*^9, 
   3.520813616953125*^9}, {3.520814478625*^9, 3.520814517421875*^9}, {
   3.520814555859375*^9, 3.520814613671875*^9}, {3.5208146563125*^9, 
   3.520814722828125*^9}, {3.52081482359375*^9, 3.520814830421875*^9}, {
   3.52087296378125*^9, 3.520873035734375*^9}, {3.52087306871875*^9, 
   3.520873075875*^9}, {3.520873179546875*^9, 3.5208732265625*^9}, {
   3.52087327746875*^9, 3.520873296546875*^9}, {3.52087335853125*^9, 
   3.520873361484375*^9}, {3.520873428328125*^9, 3.520873439921875*^9}, {
   3.520873528796875*^9, 3.520873596453125*^9}, {3.520874029125*^9, 
   3.520874058125*^9}, {3.52087876996875*^9, 3.520878774265625*^9}, {
   3.520879095359375*^9, 3.520879096078125*^9}, {3.520881848546875*^9, 
   3.520882124296875*^9}, {3.5208821583125*^9, 3.5208822268125*^9}, {
   3.520882285359375*^9, 3.520882299640625*^9}, {3.52088233096875*^9, 
   3.520882332296875*^9}, {3.52088237009375*^9, 3.5208825624375*^9}, {
   3.520882741546875*^9, 3.5208828856875*^9}, {3.520884240671875*^9, 
   3.520884241375*^9}, {3.520885397109375*^9, 3.520885515015625*^9}, {
   3.52088556446875*^9, 3.5208858435625*^9}, {3.520885898484375*^9, 
   3.520885974234375*^9}, {3.520898025796875*^9, 3.520898078625*^9}, {
   3.520898132015625*^9, 3.520898159171875*^9}, {3.520898268171875*^9, 
   3.520898439453125*^9}, {3.520898471875*^9, 3.52089847509375*^9}, {
   3.5208987905625*^9, 3.520898791046875*^9}, 3.520957046015625*^9, {
   3.5209570961875*^9, 3.520957131078125*^9}, {3.52107807721875*^9, 
   3.521078188765625*^9}, {3.5210782819375*^9, 3.521078383796875*^9}, {
   3.521137026140625*^9, 3.521137068953125*^9}, {3.521142246921875*^9, 
   3.52114265653125*^9}, {3.52114442525*^9, 3.521144472171875*^9}, {
   3.521144505640625*^9, 3.52114451575*^9}, {3.52114454646875*^9, 
   3.5211445929375*^9}, {3.52121984296875*^9, 3.5212198994375*^9}, {
   3.521220739*^9, 3.52122090625*^9}, {3.521221086375*^9, 
   3.5212210973125*^9}, {3.521221169703125*^9, 3.521221170109375*^9}, {
   3.521241296640625*^9, 3.52124132271875*^9}, {3.521241364609375*^9, 
   3.521241377921875*^9}, {3.521241761265625*^9, 3.521241789875*^9}, {
   3.52125020228125*^9, 3.5212503195*^9}, {3.521250367578125*^9, 
   3.52125043315625*^9}, {3.521348381171875*^9, 3.521348591296875*^9}, {
   3.5213486974375*^9, 3.52134881896875*^9}, {3.52134888690625*^9, 
   3.521348973890625*^9}, 3.5213493814375*^9, 3.521349424265625*^9, {
   3.521349591765625*^9, 3.52134976540625*^9}, {3.521349909984375*^9, 
   3.52134995234375*^9}, {3.5213501821875*^9, 3.521350185953125*^9}, {
   3.5213504943125*^9, 3.521350511640625*^9}, {3.5213506120625*^9, 
   3.521350633390625*^9}, {3.52135068425*^9, 3.521350712765625*^9}, {
   3.521351003671875*^9, 3.521351010375*^9}, {3.52135113328125*^9, 
   3.52135113853125*^9}, {3.521351225125*^9, 3.521351264515625*^9}, {
   3.521353769546875*^9, 3.52135380609375*^9}, {3.52135391003125*^9, 
   3.5213539324375*^9}, {3.52138689021875*^9, 3.521386896859375*^9}, {
   3.5213915893125*^9, 3.52139181034375*^9}, {3.52139186425*^9, 
   3.521391942109375*^9}, {3.521391976125*^9, 3.521391991109375*^9}, {
   3.521392049890625*^9, 3.52139216490625*^9}, {3.52139221046875*^9, 
   3.521392215734375*^9}, {3.52139226215625*^9, 3.5213922816875*^9}, {
   3.5213923241875*^9, 3.52139238159375*^9}, {3.521392606671875*^9, 
   3.5213926106875*^9}, {3.521392646546875*^9, 3.521392830515625*^9}, {
   3.521392927671875*^9, 3.521392945734375*^9}, {3.521393239734375*^9, 
   3.521393253125*^9}, {3.52139330940625*^9, 3.52139332665625*^9}, {
   3.52139486253125*^9, 3.52139486378125*^9}, {3.521395281328125*^9, 
   3.521395287609375*^9}, {3.52139612678125*^9, 3.521396148546875*^9}, {
   3.521396433484375*^9, 3.52139647615625*^9}, {3.521396513796875*^9, 
   3.521396530703125*^9}, {3.521396718125*^9, 3.521396718453125*^9}, {
   3.521398676140625*^9, 3.52139875478125*^9}, {3.52139878946875*^9, 
   3.52139882240625*^9}, {3.521399017640625*^9, 3.521399148484375*^9}, {
   3.521399182484375*^9, 3.521399183546875*^9}, {3.521399244109375*^9, 
   3.5213993385*^9}, {3.5213995170625*^9, 3.521399783703125*^9}, {
   3.52139984184375*^9, 3.521399940109375*^9}, {3.521400227171875*^9, 
   3.521400233828125*^9}, {3.521400279890625*^9, 3.5214002875625*^9}, {
   3.521400370515625*^9, 3.521400373984375*^9}, {3.521400410140625*^9, 
   3.521400412890625*^9}, {3.521401423609375*^9, 3.52140142775*^9}, {
   3.5214015165625*^9, 3.52140151815625*^9}, {3.521401780921875*^9, 
   3.521401883765625*^9}, {3.52140193640625*^9, 3.521401969265625*^9}, {
   3.52140201503125*^9, 3.52140202003125*^9}, {3.521402455625*^9, 
   3.5214025640625*^9}, {3.52140260134375*^9, 3.52140261928125*^9}, {
   3.521402734453125*^9, 3.521402863140625*^9}, {3.52141532615625*^9, 
   3.5214153873125*^9}, {3.5214156420625*^9, 3.52141570696875*^9}, {
   3.521442583140625*^9, 3.521442620640625*^9}, {3.521442651796875*^9, 
   3.521442666296875*^9}, {3.5214427025*^9, 3.521442792484375*^9}, {
   3.52144286128125*^9, 3.52144296165625*^9}, {3.521443004765625*^9, 
   3.5214430215625*^9}, {3.52144312996875*^9, 3.521443237265625*^9}, {
   3.521443272421875*^9, 3.52144328728125*^9}, {3.521471452890625*^9, 
   3.521471462828125*^9}, {3.521472116640625*^9, 3.52147218709375*^9}, {
   3.521472280796875*^9, 3.52147230184375*^9}, {3.521472418421875*^9, 
   3.521472429140625*^9}, {3.521472511109375*^9, 3.521472519234375*^9}, {
   3.521472551109375*^9, 3.521472579375*^9}, {3.52164943446875*^9, 
   3.521649441140625*^9}, {3.52164978603125*^9, 3.521649794796875*^9}, {
   3.521653219375*^9, 3.521653224921875*^9}, {3.52165329765625*^9, 
   3.5216533165625*^9}, {3.52165483128125*^9, 3.521654835875*^9}, {
   3.5216555458125*^9, 3.5216555685*^9}, {3.52166988665625*^9, 
   3.52166989046875*^9}, {3.521670768421875*^9, 3.52167081534375*^9}, {
   3.521670849203125*^9, 3.521670860421875*^9}, {3.521670891625*^9, 
   3.5216709856875*^9}, {3.521671147125*^9, 3.52167118725*^9}, {
   3.5216712428125*^9, 3.521671386015625*^9}, {3.52167158846875*^9, 
   3.5216716393125*^9}, {3.52167168784375*^9, 3.52167170453125*^9}, {
   3.521671767953125*^9, 3.521671800890625*^9}, {3.52167184703125*^9, 
   3.52167188040625*^9}, {3.5216719656875*^9, 3.5216720203125*^9}, {
   3.521672086421875*^9, 3.521672149015625*^9}, {3.521672195671875*^9, 
   3.5216722440625*^9}, {3.521672320125*^9, 3.52167243040625*^9}, {
   3.521672468421875*^9, 3.521672645609375*^9}, 3.521672796265625*^9, {
   3.5216729164375*^9, 3.52167311040625*^9}, {3.521673143375*^9, 
   3.52167317259375*^9}, {3.521673209484375*^9, 3.521673232453125*^9}, {
   3.521673284078125*^9, 3.52167331528125*^9}, {3.52167336734375*^9, 
   3.521673388625*^9}, {3.5216751101875*^9, 3.52167523325*^9}, {
   3.5216758554375*^9, 3.52167588446875*^9}, {3.521676011109375*^9, 
   3.521676031296875*^9}, {3.521676083265625*^9, 3.52167608490625*^9}, {
   3.52167614078125*^9, 3.521676144140625*^9}, {3.521676218859375*^9, 
   3.521676219984375*^9}, {3.521676257140625*^9, 3.521676342625*^9}, {
   3.521676404546875*^9, 3.52167643903125*^9}, {3.52167657284375*^9, 
   3.521676714046875*^9}, {3.521676750734375*^9, 3.521676871203125*^9}, {
   3.521677046671875*^9, 3.521677063546875*^9}, {3.5216771815625*^9, 
   3.52167723953125*^9}, {3.52167732425*^9, 3.52167734403125*^9}, {
   3.521677383*^9, 3.521677383875*^9}, {3.521677432109375*^9, 
   3.521677540125*^9}, {3.52167758334375*^9, 3.521677617234375*^9}, {
   3.521677668*^9, 3.521677671203125*^9}, {3.52167772715625*^9, 
   3.521677757234375*^9}, {3.521677788*^9, 3.52167782253125*^9}, {
   3.521677906875*^9, 3.521677914546875*^9}, {3.521677984171875*^9, 
   3.5216780049375*^9}, {3.521678053546875*^9, 3.521678053734375*^9}, {
   3.5216998578125*^9, 3.52169988396875*^9}, {3.521699914484375*^9, 
   3.521699973359375*^9}, {3.521700012703125*^9, 3.52170021290625*^9}, {
   3.521700272359375*^9, 3.521700381625*^9}, {3.52170041990625*^9, 
   3.52170087975*^9}, {3.52170095365625*^9, 3.5217009635*^9}, {
   3.52170103315625*^9, 3.52170115653125*^9}, {3.521701254953125*^9, 
   3.521701351890625*^9}, {3.5217013993125*^9, 3.521701438234375*^9}, {
   3.521701516515625*^9, 3.52170153925*^9}, {3.521701892234375*^9, 
   3.52170189378125*^9}, {3.521702314984375*^9, 3.521702329390625*^9}, {
   3.52173341071875*^9, 3.521733630953125*^9}, {3.52173367478125*^9, 
   3.52173375459375*^9}, {3.521733804375*^9, 3.521733833953125*^9}, {
   3.521741591*^9, 3.52174163671875*^9}, {3.521741705890625*^9, 
   3.521741768546875*^9}, {3.52174187984375*^9, 3.52174188003125*^9}, {
   3.521742036875*^9, 3.52174203709375*^9}, {3.521745152640625*^9, 
   3.521745164734375*^9}, {3.521745200890625*^9, 3.521745255765625*^9}, {
   3.521745324890625*^9, 3.52174536284375*^9}, {3.521745446203125*^9, 
   3.52174547321875*^9}, {3.521745506265625*^9, 3.521745513234375*^9}, {
   3.52174554921875*^9, 3.52174556996875*^9}, {3.5217456041875*^9, 
   3.521745606546875*^9}, {3.521745796859375*^9, 3.521745798109375*^9}, {
   3.521746119421875*^9, 3.521746202171875*^9}, {3.521746247578125*^9, 
   3.5217462608125*^9}, {3.521746322625*^9, 3.521746349625*^9}, {
   3.52175678640625*^9, 3.521756816921875*^9}, {3.521757001703125*^9, 
   3.521757017046875*^9}, {3.5217610119375*^9, 3.52176102221875*^9}, {
   3.5217647861875*^9, 3.521764807984375*^9}, {3.521764873484375*^9, 
   3.521764892078125*^9}, {3.52176496665625*^9, 3.521764992953125*^9}, {
   3.521765145359375*^9, 3.52176515403125*^9}, {3.52176547803125*^9, 
   3.521765486640625*^9}, {3.521784419484375*^9, 3.52178441959375*^9}, {
   3.521784735171875*^9, 3.521784739125*^9}, {3.521784803*^9, 
   3.521784832328125*^9}, {3.5217852330625*^9, 3.521785233265625*^9}, {
   3.521788073828125*^9, 3.521788104875*^9}, {3.52179265278125*^9, 
   3.521792721640625*^9}, {3.521792757875*^9, 3.521792783609375*^9}, {
   3.52179304334375*^9, 3.521793217125*^9}, {3.521793247703125*^9, 
   3.52179326671875*^9}, {3.521867759015625*^9, 3.521867794828125*^9}, {
   3.521903765703125*^9, 3.52190378259375*^9}, {3.521910287625*^9, 
   3.5219103075625*^9}, {3.52191037603125*^9, 3.521910410796875*^9}, {
   3.52191902275*^9, 3.521919058921875*^9}, {3.52191974478125*^9, 
   3.5219197580625*^9}, {3.5219389993125*^9, 3.521939153*^9}, {
   3.52194930271875*^9, 3.52194932571875*^9}, {3.52194942278125*^9, 
   3.5219494263125*^9}, {3.521950287453125*^9, 3.52195029703125*^9}, {
   3.521953722984375*^9, 3.52195380025*^9}, {3.52195433934375*^9, 
   3.521954407375*^9}, {3.5219544496875*^9, 3.52195451690625*^9}, {
   3.5219546679375*^9, 3.52195468209375*^9}, {3.5219548593125*^9, 
   3.521954863546875*^9}, {3.52195602975*^9, 3.521956063796875*^9}, {
   3.52195629140625*^9, 3.521956357828125*^9}, {3.521956396453125*^9, 
   3.5219564374375*^9}, {3.5338712661975746`*^9, 3.533871361323346*^9}, {
   3.5338813382784786`*^9, 3.5338813663273277`*^9}, {3.5338815867333527`*^9, 
   3.53388159891597*^9}, {3.5338816780572996`*^9, 3.533881853354808*^9}, {
   3.533881894133279*^9, 3.5338820548759613`*^9}, {3.53388210515485*^9, 
   3.5338821573837414`*^9}, {3.5338824795243073`*^9, 3.533882480304309*^9}, {
   3.5338826190353527`*^9, 3.5338826220773573`*^9}, {3.533882797000465*^9, 
   3.5338828884946256`*^9}, 3.533882972625573*^9, {3.5338830165708504`*^9, 
   3.533883031609277*^9}, {3.533883077816558*^9, 3.5338830803125625`*^9}, {
   3.5338831964547663`*^9, 3.533883212085994*^9}, {3.5338832641276855`*^9, 
   3.533883270461296*^9}, {3.5338833237977905`*^9, 3.5338833905035076`*^9}, {
   3.5338834292071753`*^9, 3.5338834566632233`*^9}, {3.5338835023089037`*^9, 
   3.5338835056785097`*^9}, {3.5338835727118273`*^9, 
   3.5338835994502745`*^9}, {3.5338836545651712`*^9, 
   3.5338836686519957`*^9}, {3.533883732097307*^9, 3.533883735388913*^9}, {
   3.5338838282402763`*^9, 3.533883831469482*^9}, {3.5338838790807657`*^9, 
   3.5338839318556585`*^9}, {3.5338841950601697`*^9, 
   3.5338842006611776`*^9}, {3.533884289183502*^9, 3.533884385586038*^9}, {
   3.5338844540299344`*^9, 3.5338846658554325`*^9}, {3.533896646054044*^9, 
   3.5338967398621426`*^9}, {3.533896822025326*^9, 3.5338968359964437`*^9}, {
   3.53389691032167*^9, 3.5338969105856824`*^9}, {3.5338971233903627`*^9, 
   3.5338971363541813`*^9}, {3.533897219401898*^9, 3.5338972354505205`*^9}, {
   3.5338972707361703`*^9, 3.5338972749661765`*^9}, {3.5338978585023127`*^9, 
   3.533897865536066*^9}, {3.5338979217961693`*^9, 3.533898000278984*^9}, {
   3.5338980623234015`*^9, 3.533898066186492*^9}, {3.533898144347541*^9, 
   3.5338981535560675`*^9}, {3.533898233983821*^9, 3.5338982373649206`*^9}, {
   3.5339312966250153`*^9, 3.533931296985016*^9}, {3.5339314506542325`*^9, 
   3.5339314570856414`*^9}, {3.533931664934333*^9, 3.5339316768215537`*^9}, {
   3.5857213419283295`*^9, 3.58572134252113*^9}, {3.5857215487846923`*^9, 
   3.585721549174693*^9}, {3.585721605319192*^9, 3.5857216509180717`*^9}, {
   3.5857216896061397`*^9, 3.585721690448541*^9}, {3.58572175242745*^9, 
   3.5857217649074717`*^9}, {3.5857221603837667`*^9, 3.585722165188575*^9}, {
   3.5857222535315304`*^9, 3.5857222644515495`*^9}, {3.5857227752120466`*^9, 
   3.5857228235877314`*^9}, {3.585722986264817*^9, 3.5857230354673033`*^9}, {
   3.585723093686606*^9, 3.585723122203456*^9}, {3.585723169643139*^9, 
   3.585723171733543*^9}, {3.5857232526664853`*^9, 3.58572327258772*^9}, {
   3.606335159966839*^9, 3.606335198046506*^9}, {3.6063352330685673`*^9, 
   3.606335262131418*^9}, {3.6063353403967557`*^9, 3.6063353699744077`*^9}, {
   3.6063355019506392`*^9, 3.6063355100002537`*^9}, {3.6063358322344193`*^9, 
   3.6063358372576284`*^9}, {3.6066738883426533`*^9, 3.606673983512097*^9}, {
   3.6066740559482403`*^9, 3.6066740635486746`*^9}, {3.6066743363332767`*^9, 
   3.606674360126638*^9}, {3.6066746414127264`*^9, 3.6066746456029663`*^9}, {
   3.6066746864413023`*^9, 3.6066746935107064`*^9}, {3.606764163770528*^9, 
   3.6067641878257694`*^9}, {3.6067646447193723`*^9, 
   3.6067646954194613`*^9}, {3.6067650160780244`*^9, 
   3.6067650464980783`*^9}, {3.629562191862056*^9, 3.6295622179565096`*^9}, {
   3.6295624903759656`*^9, 3.6295625052137947`*^9}, {3.629562566755515*^9, 
   3.6295625671621156`*^9}, {3.629563111218094*^9, 3.6295631194739094`*^9}, {
   3.6295678441846895`*^9, 3.6295678567385135`*^9}, {3.6295769150568147`*^9, 
   3.629576939323668*^9}, 3.6295791738516903`*^9, 3.6295792209418187`*^9, {
   3.629581267714156*^9, 3.6295812912406006`*^9}, {3.629581325784066*^9, 
   3.629581340671893*^9}, {3.6295814029374175`*^9, 3.629581429304266*^9}, {
   3.6295818560362825`*^9, 3.629581856332683*^9}, {3.6295819110649934`*^9, 
   3.6295819150988007`*^9}, 3.62958195994705*^9, {3.6295827367218447`*^9, 
   3.6295827372990456`*^9}, {3.629582811380183*^9, 3.6295830005573826`*^9}, {
   3.6295922773693624`*^9, 3.6295923269242268`*^9}, {3.629592361069789*^9, 
   3.629592363895294*^9}, {3.6295923947624507`*^9, 3.6295924368449287`*^9}, {
   3.629592556257448*^9, 3.6295925866629047`*^9}, {3.6295926742687674`*^9, 
   3.6295926896873956`*^9}, {3.629592857642812*^9, 3.6295928635884237`*^9}, {
   3.6296008298157945`*^9, 3.629600857037795*^9}, {3.6296010760041723`*^9, 
   3.6296011709187737`*^9}, {3.6296012604938602`*^9, 
   3.6296013158603663`*^9}, {3.629601566485784*^9, 3.6296017289910207`*^9}, {
   3.629601965126772*^9, 3.629602009106655*^9}, {3.629602234491691*^9, 
   3.62960233417128*^9}, {3.6296025406568675`*^9, 3.629602545034876*^9}, {
   3.629602605592389*^9, 3.6296026720725155`*^9}, {3.629602819991993*^9, 
   3.629602824448001*^9}, {3.629605598839726*^9, 3.629605607327141*^9}, {
   3.6296058220871186`*^9, 3.62960582882633*^9}, {3.6296063832065477`*^9, 
   3.629606402387883*^9}, {3.629606538604329*^9, 3.6296066163905716`*^9}, {
   3.629606677993684*^9, 3.629606687579601*^9}, {3.6296068047490234`*^9, 
   3.629606830226368*^9}, 3.6296068624429245`*^9, {3.6296068979092875`*^9, 
   3.6296069681300106`*^9}, {3.629609076756136*^9, 3.6296091040088844`*^9}, {
   3.6296099141079187`*^9, 3.6296099316810493`*^9}, {3.6296100423732443`*^9, 
   3.629610095608038*^9}, {3.6296101382529125`*^9, 3.6296102324377785`*^9}, {
   3.629610465776189*^9, 3.6296105719830756`*^9}, {3.6296106080628395`*^9, 
   3.6296106195756593`*^9}, {3.629610656929625*^9, 3.629610732269657*^9}, {
   3.629610770130324*^9, 3.629610865268092*^9}, {3.629610900164753*^9, 
   3.6296109467227354`*^9}, {3.62961103488599*^9, 3.629611035478791*^9}, {
   3.62961131996777*^9, 3.629611351764426*^9}, {3.6296113965317063`*^9, 
   3.629611407320126*^9}, {3.629611650866873*^9, 3.629611658370486*^9}, {
   3.629611693028248*^9, 3.629611725211104*^9}, {3.629660344681587*^9, 
   3.629660396816783*^9}, {3.629662054116185*^9, 3.629662109498183*^9}, {
   3.629662485797946*^9, 3.629662506233982*^9}, {3.6296627377648115`*^9, 
   3.629662875565055*^9}, {3.629663059835583*^9, 3.6296630605400844`*^9}, {
   3.629663213456155*^9, 3.6296632447274103`*^9}, {3.62966339066107*^9, 
   3.629663505423672*^9}, {3.629663629963293*^9, 3.62966374139069*^9}, 
   3.6296637790073557`*^9, {3.6296639427647448`*^9, 3.62966405344954*^9}, {
   3.629664258753003*^9, 3.6296642835833473`*^9}, {3.629664357640478*^9, 
   3.629664406652266*^9}, {3.6296644497627425`*^9, 3.6296644754010878`*^9}, {
   3.6296645845515814`*^9, 3.629664754351282*^9}, {3.6296648207714*^9, 
   3.6296648719226904`*^9}, {3.6296649072767525`*^9, 3.629665007539429*^9}, {
   3.629665128176044*^9, 3.629665131155649*^9}, {3.629665198002467*^9, 
   3.629665208579286*^9}, {3.629665989873558*^9, 3.6296660606365824`*^9}, {
   3.629666240755704*^9, 3.629666248087716*^9}, {3.629680463417473*^9, 
   3.629680463611674*^9}, {3.6296839559917583`*^9, 3.629684004376444*^9}, {
   3.629684359598235*^9, 3.6296844225402164`*^9}, {3.629697473161625*^9, 
   3.6296975310175266`*^9}, {3.6296984575100627`*^9, 
   3.6296984799167023`*^9}, {3.629698536527603*^9, 3.6296985539120336`*^9}, {
   3.6297029070413284`*^9, 3.629702918063344*^9}, {3.629702984562439*^9, 
   3.629702988605445*^9}, {3.6297038644319816`*^9, 3.629703884097009*^9}, 
   3.6297039422184496`*^9, {3.629704987754769*^9, 3.6297050664593077`*^9}, {
   3.6297051249286375`*^9, 3.6297051564516935`*^9}, {3.6297051944125605`*^9, 
   3.6297052523000636`*^9}, {3.6297052825731173`*^9, 
   3.6297053031671534`*^9}, {3.629705388300189*^9, 3.62970538895539*^9}, {
   3.62972916921355*^9, 3.6297291763503666`*^9}, {3.6297292561692886`*^9, 
   3.629729263599902*^9}, {3.629761051728472*^9, 3.629761065720507*^9}, {
   3.629829049363864*^9, 3.629829080818822*^9}, {3.629832420822437*^9, 
   3.629832422351239*^9}, {3.629833134540451*^9, 3.629833156760482*^9}, {
   3.629841550046672*^9, 3.62984155467428*^9}, {3.6298419857146883`*^9, 
   3.6298419986509113`*^9}, {3.629842327687729*^9, 3.6298423483446655`*^9}, {
   3.6298424340556164`*^9, 3.6298424347651176`*^9}, {3.629857562453469*^9, 
   3.6298575752992034`*^9}, {3.6298617363544903`*^9, 3.629861743498315*^9}, {
   3.629861792832088*^9, 3.629861797965208*^9}, {3.6298621478116827`*^9, 
   3.6298621703399477`*^9}, {3.629862224692195*^9, 3.6298622386228337`*^9}, {
   3.629934024806528*^9, 3.6299340705926085`*^9}, {3.629935785029563*^9, 
   3.6299358234439325`*^9}, {3.630093833832834*^9, 3.630093925755106*^9}, {
   3.6303312112935457`*^9, 3.6303312550516224`*^9}, {3.6303358993921537`*^9, 
   3.6303359226755953`*^9}, {3.6306356399709835`*^9, 
   3.6306356458927946`*^9}, {3.630636068179586*^9, 3.6306361110125637`*^9}, {
   3.6306361560057445`*^9, 3.630636184065894*^9}, {3.630636235447586*^9, 
   3.630636267952746*^9}, {3.63063630275181*^9, 3.6306363664175234`*^9}, {
   3.6306364437215614`*^9, 3.6306365062241726`*^9}, {3.630636538221331*^9, 
   3.630636557862567*^9}, {3.630636607219159*^9, 3.6306366182246785`*^9}, {
   3.6306367049124327`*^9, 3.6306367069872365`*^9}, {3.6306367739863553`*^9, 
   3.6306368265585485`*^9}, {3.6306368669329214`*^9, 
   3.6306368850077534`*^9}, {3.6306369704707117`*^9, 
   3.6306369715340137`*^9}, {3.6306370050048733`*^9, 3.6306370121403866`*^9}, 
   3.6306370476386495`*^9, {3.6306371345330048`*^9, 3.6306371389166126`*^9}, {
   3.6306372376894894`*^9, 3.6306372761020594`*^9}, {3.6306374107348022`*^9, 
   3.6306374177860146`*^9}, {3.6306374703665094`*^9, 
   3.6306376025850487`*^9}, {3.6306376480269303`*^9, 
   3.6306376569389467`*^9}, {3.630637688572405*^9, 3.6306377047228336`*^9}, {
   3.630638005103675*^9, 3.63063803012432*^9}, {3.630638132477803*^9, 
   3.6306381742124786`*^9}, {3.630638443344762*^9, 3.6306384548725824`*^9}, {
   3.630693969338559*^9, 3.6306940821519747`*^9}, {3.630694494199352*^9, 
   3.6306945206800165`*^9}, {3.63069542859525*^9, 3.6306954292512627`*^9}, {
   3.630695677045081*^9, 3.6306957023971386`*^9}, {3.63069573859525*^9, 
   3.6306958461515474`*^9}, {3.6306960563359995`*^9, 3.630696315629788*^9}, {
   3.630696895134617*^9, 3.6306969769772644`*^9}, {3.6306970092793493`*^9, 
   3.630697023245936*^9}, {3.6306970610093985`*^9, 3.6306971134507113`*^9}, {
   3.63069721480139*^9, 3.6306972323263006`*^9}, {3.671909193986844*^9, 
   3.671909243404647*^9}, {3.8314389647190886`*^9, 3.8314389695190797`*^9}, {
   3.8381876185176935`*^9, 3.8381876483954706`*^9}, {3.838188300545725*^9, 
   3.83818832283567*^9}, {3.8381883598456235`*^9, 3.83818836003572*^9}, {
   3.8478338190759087`*^9, 3.8478338615757675`*^9}, {3.847837673865692*^9, 
   3.847837710807616*^9}, {3.84783786346992*^9, 3.8478378789087687`*^9}, {
   3.8478379621019382`*^9, 3.84783796230793*^9}, {3.8594556010909963`*^9, 
   3.8594556270319986`*^9}, {3.8594556912480097`*^9, 
   3.8594557104970093`*^9}, {3.8594561480244203`*^9, 
   3.8594562822380867`*^9}, {3.8594588522664633`*^9, 
   3.8594589674004693`*^9}, {3.859459212905465*^9, 3.8594592274004707`*^9}, {
   3.85945927091247*^9, 3.8594593400334635`*^9}, {3.8594593798404655`*^9, 
   3.8594594355004625`*^9}, {3.8594604392974176`*^9, 3.859460459866928*^9}, {
   3.8594605543879423`*^9, 3.8594606948087983`*^9}, {3.859461213092307*^9, 
   3.859461312972269*^9}, {3.859461456083396*^9, 3.8594615505012484`*^9}, {
   3.859462220633724*^9, 3.8594622279563*^9}, {3.859462474337384*^9, 
   3.859462479394371*^9}, {3.859462877545724*^9, 3.8594629057664413`*^9}, 
   3.859462996333089*^9, 3.8594635922714834`*^9, 3.8594636340681467`*^9, {
   3.8594637438873477`*^9, 3.859463791885425*^9}, {3.8594639699825983`*^9, 
   3.859463993630597*^9}, {3.8594640780306993`*^9, 3.859464080788702*^9}, {
   3.859464160341225*^9, 3.8594641705877085`*^9}, {3.859507550099011*^9, 
   3.859507582307036*^9}, {3.859508906543721*^9, 3.859508907902869*^9}, {
   3.8595090210468235`*^9, 3.8595090622782507`*^9}, {3.8595093108548994`*^9, 
   3.859509325919695*^9}, 3.8595094056896963`*^9, 3.8595094801925726`*^9, {
   3.859509553449321*^9, 3.85950956355905*^9}, {3.8595096368638353`*^9, 
   3.85950964812885*^9}, {3.8595099036070156`*^9, 3.8595099071768007`*^9}, {
   3.859510171019932*^9, 3.8595101711688385`*^9}, {3.859510568356614*^9, 
   3.85951056850852*^9}, {3.859510610515703*^9, 3.859510640261258*^9}, {
   3.859510712571088*^9, 3.8595107385160027`*^9}, 3.8595142673511114`*^9, {
   3.8595149548109922`*^9, 3.8595149817355723`*^9}, {3.8595150236977634`*^9, 
   3.8595150302927055`*^9}, 3.8595150839917297`*^9, {3.8595151326769953`*^9, 
   3.859515159452526*^9}, {3.859600557376666*^9, 3.859600592054014*^9}, {
   3.8596006562025523`*^9, 3.859600672454644*^9}, {3.8596008393259487`*^9, 
   3.8596008479064274`*^9}, {3.8596008806649933`*^9, 
   3.8596009087814913`*^9}, {3.859601104999363*^9, 3.85960112035612*^9}, {
   3.859601258427606*^9, 3.8596012586579933`*^9}, 3.85960143303165*^9, {
   3.859601531071765*^9, 3.8596015701271353`*^9}, {3.859601625403966*^9, 
   3.859601658867322*^9}, {3.8596019123143167`*^9, 3.859601920014387*^9}, 
   3.859602009077052*^9, {3.8596020465958467`*^9, 3.85960212841488*^9}, {
   3.8596077214275875`*^9, 3.8596077576714063`*^9}, {3.859607805462963*^9, 
   3.8596078264650097`*^9}, {3.859607858844967*^9, 3.8596078748131227`*^9}, 
   3.8596079059100637`*^9, {3.859608163862884*^9, 3.859608176478674*^9}, {
   3.8596082185277414`*^9, 3.8596082476387873`*^9}, {3.860063972092306*^9, 
   3.8600639884144163`*^9}, {3.860064082136467*^9, 3.8600640835361605`*^9}, 
   3.860064367934267*^9, {3.8600644779513025`*^9, 3.860064482708833*^9}, {
   3.860064825521562*^9, 3.8600648282413807`*^9}, 3.8600650189116974`*^9, {
   3.8600651437893195`*^9, 3.8600651469514074`*^9}, {3.860065200041277*^9, 
   3.8600652141611476`*^9}, {3.860065257544154*^9, 3.8600652593173056`*^9}, {
   3.8600653105208073`*^9, 3.8600653114114046`*^9}, 3.860065360031438*^9, {
   3.8600654144515057`*^9, 3.8600654234212255`*^9}, {3.860065481256881*^9, 
   3.8600655021013365`*^9}, {3.8600655707474833`*^9, 
   3.8600655709512434`*^9}, {3.860065621258689*^9, 3.860065626021537*^9}, 
   3.860065827771549*^9, {3.860065888701377*^9, 3.8600658949912596`*^9}, 
   3.8600659707712946`*^9, {3.860066226471365*^9, 3.860066230563578*^9}, 
   3.860066561855797*^9, {3.860066633315779*^9, 3.8600666334833145`*^9}, {
   3.860066831205914*^9, 3.860066837362755*^9}, 3.860066904575856*^9, {
   3.860067011375463*^9, 3.8600670459227915`*^9}, {3.8600671050154624`*^9, 
   3.860067143915722*^9}, {3.860108033143886*^9, 3.860108038521595*^9}, {
   3.8601080784992657`*^9, 3.8601080806086054`*^9}, {3.860111427849783*^9, 
   3.860111430193488*^9}, {3.8601115741591253`*^9, 3.8601115996513686`*^9}, {
   3.8605777818345966`*^9, 3.8605778138716097`*^9}, {3.8605779482572412`*^9, 
   3.860577949080242*^9}, {3.86057883081254*^9, 3.8605788610685387`*^9}, {
   3.861332239829957*^9, 3.861332266331642*^9}, {3.8617699152950683`*^9, 
   3.861769920729446*^9}, 3.8619263315662594`*^9, {3.8870173985236807`*^9, 
   3.8870174363630733`*^9}, {3.8955547737024174`*^9, 
   3.8955547737104106`*^9}, {3.956199042446658*^9, 3.956199042455611*^9}, {
   3.9599340680669613`*^9, 3.959934077774197*^9}, {3.967777451614749*^9, 
   3.967777451614749*^9}, {3.971053547639739*^9, 3.971053555589531*^9}, {
   3.975308400424533*^9, 
   3.975308458973736*^9}},ExpressionUUID->"55cfa897-81b7-4dd3-958b-\
b5eff504d035"]
}, Closed]],

Cell[CellGroupData[{

Cell["Eigensystem", "Subsubsection",
 CellChangeTimes->{{3.8991744790285034`*^9, 
  3.899174483778578*^9}},ExpressionUUID->"fd508f6f-e15c-4d3c-8ca6-\
88cad961051f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", 
    RowBox[{"Second", " ", "strategy", " ", "of", " ", "ONFF"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Tensor", "/:", 
    RowBox[{"Eigensystem", "[", "t_Tensor", "]"}], ":=", 
    RowBox[{"Eigensystem", "[", 
     RowBox[{"TensorComponents", "[", "t", "]"}], "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8991744805625577`*^9, 3.8991744805835476`*^9}, {
  3.8991799365535846`*^9, 
  3.8991799438111134`*^9}},ExpressionUUID->"ed628348-f31e-4a9b-ba50-\
421e43ee81c2"]
}, Closed]],

Cell[CellGroupData[{

Cell["OrthonormalFrameField", "Subsubsection",
 CellChangeTimes->{{3.8611417830099425`*^9, 
  3.8611417898900027`*^9}},ExpressionUUID->"ee3581fd-c267-4aa2-b53e-\
618eedbcc19a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   StyleBox[
    RowBox[{"OrthonormalFrameField", " ", "Tensor", " ", "part"}],
    FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"The", " ", 
       StyleBox["pattern",
        FontColor->RGBColor[1, 0, 1]], 
       StyleBox[" ",
        FontColor->RGBColor[1, 0, 1]], 
       StyleBox["check",
        FontColor->RGBColor[1, 0, 1]], " ", "here", " ", "take", " ", "care", 
       " ", "of", " ", "pattern", " ", "checking", " ", 
       RowBox[{
        StyleBox["efficiency",
         FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"xx__", "/;", 
      RowBox[{"(", 
       RowBox[{"(*", 
        RowBox[{"Check", " ", 
         StyleBox["ChristoffelComponents",
          FontColor->RGBColor[1, 0, 1]], " ", "is", " ", "to", " ", "ensure", 
         " ", "we", " ", "finished", " ", "all", " ", 
         StyleBox["basic",
          FontColor->RGBColor[1, 0, 1]], 
         StyleBox[" ",
          FontColor->RGBColor[1, 0, 1]], 
         StyleBox["metric",
          FontColor->RGBColor[1, 0, 1]], 
         StyleBox[" ",
          FontColor->RGBColor[1, 0, 1]], 
         RowBox[{
          StyleBox["calculation",
           FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"{", "xx", "}"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"ChristoffelComponents", "\[Rule]", "cc_"}], ")"}], 
             "\[Rule]", "cc"}], ",", "1"}], "]"}], "=!=", 
          RowBox[{"{", "}"}]}], ")"}], "&&", "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"IndicesNoPart", "[", 
           RowBox[{"{", "xx", "}"}], "]"}], "=!=", 
          RowBox[{"{", "}"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"{", "xx", "}"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorComponents", "\[Rule]", "tc_"}], ")"}], 
             "\[Rule]", "tc"}], ",", "1"}], "]"}], "=!=", 
          RowBox[{"{", "}"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TensorTypeNoPart", "[", 
           RowBox[{"{", "xx", "}"}], "]"}], "===", 
          RowBox[{"{", "\"\<Metric\>\"", "}"}]}], ")"}], "&&", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           StyleBox["FlatMetric",
            FontColor->RGBColor[1, 0, 1]], " ", "should", " ", "be", " ", 
           StyleBox["not",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["Null",
            FontColor->RGBColor[1, 0, 1]], " ", "and", " ", "a", " ", 
           StyleBox["Rank",
            FontColor->RGBColor[1, 0, 1]]}], 
          StyleBox["-",
           FontColor->RGBColor[1, 0, 1]], 
          RowBox[{
           StyleBox["1",
            FontColor->RGBColor[1, 0, 1]], " ", 
           RowBox[{
            StyleBox["list",
             FontColor->RGBColor[1, 0, 1]], ".", " ", "We"}], " ", "will", 
           " ", "diagnalize", " ", "it", " ", "and", " ", "make", " ", "it", 
           " ", "become", " ", "a", " ", "Rank"}], "-", 
          RowBox[{"2", " ", "matrix", " ", "so", " ", "that", " ", "it", " ", 
           RowBox[{"won", "'"}], "t", " ", "macth", " ", "the", " ", 
           "pattern", " ", 
           RowBox[{"again", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"{", "xx", "}"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"FlatMetric", "\[Rule]", "fm_"}], ")"}], "\[Rule]", 
             "fm"}], ",", "1"}], "]"}], "=!=", 
          RowBox[{"{", "Null", "}"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ComponentRankNumber", "[", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"{", "xx", "}"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"FlatMetric", "\[Rule]", "fm_"}], ")"}], "\[Rule]", 
               "fm"}], ",", "1"}], "]"}], "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "]"}], "===", "1"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "xx", "}"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"OrthonormalFrameField", "\[Rule]", "onfff_"}], 
                  ")"}], "\[Rule]", "onfff"}], ",", "1"}], "]"}], "=!=", 
              RowBox[{"{", "Null", "}"}]}], ")"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Head", "[", 
                 RowBox[{
                  RowBox[{"Cases", "[", 
                   RowBox[{
                    RowBox[{"{", "xx", "}"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"OrthonormalFrameField", "\[Rule]", "onfff_"}], 
                    ")"}], "\[Rule]", "onfff"}], ",", "1"}], "]"}], 
                  "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 "]"}], "===", "List"}], ")"}], ",", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Dimensions", "[", 
                 RowBox[{
                  RowBox[{"Cases", "[", 
                   RowBox[{
                    RowBox[{"{", "xx", "}"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"TensorComponents", "\[Rule]", "tc_"}], ")"}], 
                    "\[Rule]", "tc"}], ",", "1"}], "]"}], 
                  "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 "]"}], "===", 
                RowBox[{"Dimensions", "[", 
                 RowBox[{
                  RowBox[{"Cases", "[", 
                   RowBox[{
                    RowBox[{"{", "xx", "}"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"OrthonormalFrameField", "\[Rule]", "onfff_"}], 
                    ")"}], "\[Rule]", "onfff"}], ",", "1"}], "]"}], 
                  "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 "]"}]}], ")"}], ",", "False"}], "]"}], ",", "True"}], "]"}], 
          "&&", 
          RowBox[{"(", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"{", "xx", "}"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                   "InverseOrthonormalFrameField", "\[Rule]", "invonfff_"}], 
                   ")"}], "\[Rule]", "invonfff"}], ",", "1"}], "]"}], "=!=", 
               RowBox[{"{", "Null", "}"}]}], ")"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Head", "[", 
                  RowBox[{
                   RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"{", "xx", "}"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    "InverseOrthonormalFrameField", "\[Rule]", "invonfff_"}], 
                    ")"}], "\[Rule]", "invonfff"}], ",", "1"}], "]"}], 
                   "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                  "]"}], "===", "List"}], ")"}], ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Dimensions", "[", 
                  RowBox[{
                   RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"{", "xx", "}"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"TensorComponents", "\[Rule]", "tc_"}], ")"}], 
                    "\[Rule]", "tc"}], ",", "1"}], "]"}], 
                   "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                  "]"}], "===", 
                 RowBox[{"Dimensions", "[", 
                  RowBox[{
                   RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"{", "xx", "}"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    "InverseOrthonormalFrameField", "\[Rule]", "invonfff_"}], 
                    ")"}], "\[Rule]", "invonfff"}], ",", "1"}], "]"}], 
                   "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                  "]"}]}], ")"}], ",", "False"}], "]"}], ",", "True"}], "]"}],
            ")"}]}], ")"}], "&&", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", "xx", "}"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"OrthonormalFrameField", "\[Rule]", "onfff_"}], 
                 ")"}], "\[Rule]", "onfff"}], ",", "1"}], "]"}], "===", 
             RowBox[{"{", "Null", "}"}]}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", "xx", "}"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                 "InverseOrthonormalFrameField", "\[Rule]", "invonfff_"}], 
                 ")"}], "\[Rule]", "invonfff"}], ",", "1"}], "]"}], "===", 
             RowBox[{"{", "Null", "}"}]}], ")"}]}], ",", 
          RowBox[{"DiagonalMatrixQ", "[", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"{", "xx", "}"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"TensorComponents", "\[Rule]", "tc_"}], ")"}], 
               "\[Rule]", "tc"}], ",", "1"}], "]"}], "\[LeftDoubleBracket]", 
            "1", "\[RightDoubleBracket]"}], "]"}], ",", "True"}], "]"}]}], 
       ")"}]}], "\[IndentingNewLine]", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "eigens", ",", "Flatmetric", ",", "g", ",", "ginv", ",", "d", ",", 
        "rotm", ",", "valuesqrt", ",", "ONFFm", ",", "ONFFinvm", ",", 
        "output", ",", "onff", ",", "invonff", ",", "idx", ",", "matrix", ",",
         "onffop", ",", "fm", ",", "cc", ",", "tempm", ",", "ONFFt", ",", 
        "ONFFinvt", ",", "\[Alpha]", ",", "\[Mu]", ",", "coord", ",", 
        "onffidx", ",", "ONFFtidx", ",", "ONFFinvtidx", ",", "i"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       StyleBox[
        RowBox[{"Extract", " ", "arguments"}],
        FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"idx", "=", 
        RowBox[{"Indices", "[", 
         RowBox[{"{", "xx", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"matrix", "=", 
        RowBox[{"TensorComponents", "[", 
         RowBox[{"{", "xx", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"fm", "=", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"{", "xx", "}"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"FlatMetric", "\[Rule]", "cc_"}], ")"}], "\[Rule]", 
            "cc"}], ",", "\[Infinity]"}], "]"}], "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{"Length", "[", "fm", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"onff", "=", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"{", "xx", "}"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"OrthonormalFrameField", "\[Rule]", "cc_"}], ")"}], 
            "\[Rule]", "cc"}], ",", "\[Infinity]"}], "]"}], 
         "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"invonff", "=", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"{", "xx", "}"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "cc_"}], 
             ")"}], "\[Rule]", "cc"}], ",", "\[Infinity]"}], "]"}], 
         "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"onffop", "=", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"{", "xx", "}"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"OrthonormalFrameFieldOperator", "\[Rule]", "cc_"}], 
             ")"}], "\[Rule]", "cc"}], ",", "\[Infinity]"}], "]"}], 
         "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"coord", "=", 
        RowBox[{"Coordinates", "[", 
         RowBox[{"{", "xx", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"onffidx", "=", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"{", "xx", "}"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"OrthonormalFrameFieldIndices", "\[Rule]", "cc_"}], 
             ")"}], "\[Rule]", "cc"}], ",", "\[Infinity]"}], "]"}], 
         "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"If", " ", "we", " ", "have", " ", 
          StyleBox[
           SubscriptBox["g", "ab"],
           FontColor->RGBColor[1, 0, 1]]}], ",", " ", 
         RowBox[{"we", " ", "should", " ", "calculate", " ", 
          RowBox[{
           StyleBox[
            SuperscriptBox["g", "ab"],
            FontColor->RGBColor[1, 0, 1]], ".", " ", "vice"}], " ", "versa"}],
          ",", " ", 
         RowBox[{"if", " ", "we", " ", "have", " ", 
          StyleBox[
           SuperscriptBox["g", "ab"],
           FontColor->RGBColor[1, 0, 1]]}], ",", " ", 
         RowBox[{"we", " ", "should", " ", "calculate", " ", 
          RowBox[{
           StyleBox[
            SubscriptBox["g", "ab"],
            FontColor->RGBColor[1, 0, 1]], ".", " ", "it"}], " ", "shares", 
          " ", "same", " ", 
          StyleBox["operator",
           FontColor->RGBColor[1, 0, 1]], " ", 
          RowBox[{"w", "/", " ", 
           RowBox[{"OrthonormalFrameField", "."}]}]}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"idx", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"SubMinus", "[", "_", "]"}], ",", 
             RowBox[{"SubMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"g", "=", "matrix"}], ";", 
          RowBox[{"ginv", "=", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Inverse", "[", "matrix", "]"}], "//", "onffop"}], 
            ")"}]}]}], ",", 
         RowBox[{"MatchQ", "[", 
          RowBox[{"idx", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"SuperMinus", "[", "_", "]"}], ",", 
             RowBox[{"SuperMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"ginv", "=", "matrix"}], ";", 
          RowBox[{"g", "=", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Inverse", "[", "matrix", "]"}], "//", "onffop"}], 
            ")"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         StyleBox["DiagonalMatrix",
          FontColor->RGBColor[1, 0, 1]], " ", "on", " ", 
         StyleBox["FlatMetric",
          FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Flatmetric", "=", 
        RowBox[{"DiagonalMatrix", "[", "fm", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"onff", "===", "Null"}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{"invonff", "===", "Null"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ONFFm", "=", 
           RowBox[{"DiagonalMatrix", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Sqrt", "[", 
                RowBox[{
                 RowBox[{
                 "fm", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
                  " ", 
                 RowBox[{"g", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}]}], "]"}],
                ")"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "d"}], "}"}]}], "]"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"ONFFinvm", "=", 
           RowBox[{"DiagonalMatrix", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Sqrt", "[", 
                RowBox[{
                 RowBox[{
                 "fm", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
                  " ", 
                 RowBox[{"ginv", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}]}], "]"}],
                ")"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "d"}], "}"}]}], "]"}], "]"}]}], 
          ";"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "If", " ", "user", " ", "offer", " ", "at", " ", "least", " ", 
            "one"}], ",", " ", 
           RowBox[{
           "we", " ", "utilize", " ", "it", " ", "to", " ", "get", " ", "the",
             " ", 
            RowBox[{"other", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"onff", "=!=", "Null"}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{"invonff", "===", "Null"}], ")"}]}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"ONFFm", "=", "onff"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           StyleBox[
            RowBox[{
             SuperscriptBox[
              SubscriptBox[
               StyleBox["\[CurlyEpsilon]",
                FontColor->RGBColor[1, 0, 1]], 
               OverscriptBox["a", "^"]], "b"], "=", 
             RowBox[{
              SubscriptBox["\[Eta]", "ad"], 
              SubscriptBox[
               SuperscriptBox[
                StyleBox["\[CurlyEpsilon]",
                 FontColor->RGBColor[1, 0, 1]], 
                OverscriptBox["d", "^"]], "c"], 
              SuperscriptBox["g", "cb"]}]}],
            FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"ONFFinvm", "=", 
           RowBox[{"Flatmetric", ".", "onff", ".", "ginv"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"onff", "===", "Null"}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{"invonff", "=!=", "Null"}], ")"}]}], ",", 
         RowBox[{
          RowBox[{"ONFFinvm", "=", "invonff"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           StyleBox[
            RowBox[{
             SubscriptBox[
              SuperscriptBox[
               StyleBox["\[CurlyEpsilon]",
                FontColor->RGBColor[1, 0, 1]], 
               OverscriptBox["d", "^"]], "c"], "=", 
             RowBox[{
              SuperscriptBox["\[Eta]", "da"], 
              SuperscriptBox[
               SubscriptBox[
                StyleBox["\[CurlyEpsilon]",
                 FontColor->RGBColor[1, 0, 1]], 
                OverscriptBox["a", "^"]], "b"], 
              SubscriptBox["g", "bc"]}]}],
            FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"ONFFm", "=", 
           RowBox[{"Flatmetric", ".", "invonff", ".", "g"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "If", " ", "user", " ", "offer", " ", "both", " ", "of", " ", 
            "them"}], ",", " ", 
           RowBox[{"we", " ", "use", " ", 
            RowBox[{"them", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"onff", "=!=", "Null"}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{"invonff", "=!=", "Null"}], ")"}]}], ",", 
         RowBox[{
          RowBox[{"ONFFm", "=", "onff"}], ";", 
          RowBox[{"ONFFinvm", "=", "invonff"}]}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"ONFFm", "=", 
        RowBox[{"(", 
         RowBox[{"ONFFm", "//", "onffop"}], ")"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ONFFinvm", "=", 
        RowBox[{"(", 
         RowBox[{"ONFFinvm", "//", "onffop"}], ")"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Declare", " ", 
         StyleBox["OrthonormalFrameField",
          FontColor->RGBColor[1, 0, 1]], 
         StyleBox[" ",
          FontColor->RGBColor[1, 0, 1]], "as", " ", "a", 
         StyleBox[" ",
          FontColor->RGBColor[1, 0, 1]], 
         StyleBox["Tensor",
          FontColor->RGBColor[1, 0, 1]], 
         StyleBox[" ",
          FontColor->RGBColor[1, 0, 1]], 
         RowBox[{"object", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"ONFFtidx", "=", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"onffidx", "=!=", "Null"}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "[", "#", "]"}], "&"}], "/@", "onffidx"}], 
               ")"}], "===", 
              RowBox[{"{", 
               RowBox[{"OverHat", ",", "Symbol"}], "}"}]}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Head", "[", 
               RowBox[{"onffidx", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], "===",
               "Symbol"}], ")"}]}], ")"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox[
             RowBox[{
             "onffidx", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}], "-"], ",", 
            SubscriptBox[
             RowBox[{
             "onffidx", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}], "-"]}], "}"}], ",", "True", ",", 
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox[
             OverscriptBox["\[Alpha]", "^"], "-"], ",", 
            SubscriptBox["\[Mu]", "-"]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ONFFinvtidx", "=", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"onffidx", "=!=", "Null"}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "[", "#", "]"}], "&"}], "/@", "onffidx"}], 
               ")"}], "===", 
              RowBox[{"{", 
               RowBox[{"OverHat", ",", "Symbol"}], "}"}]}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Head", "[", 
               RowBox[{"onffidx", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], "===",
               "Symbol"}], ")"}]}], ")"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox[
             RowBox[{"(", 
              RowBox[{
              "onffidx", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], ")"}], "-"], ",", 
            SuperscriptBox[
             RowBox[{
             "onffidx", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}], "-"]}], "}"}], ",", "True", ",", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox[
             OverscriptBox["\[Alpha]", "^"], "-"], ",", 
            SuperscriptBox["\[Mu]", "-"]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ONFFt", "=", 
        RowBox[{
         RowBox[{
         "{", "\[IndentingNewLine]", "xx", "\[IndentingNewLine]", "}"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"FlatMetric", "\[Rule]", "fm_"}], ")"}], "\[Rule]", 
            "Nothing"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"OrthonormalFrameField", "\[Rule]", "onf_"}], ")"}], 
            "\[Rule]", "Nothing"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "ionf_"}], 
             ")"}], "\[Rule]", "Nothing"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorType", "\[Rule]", "tt_"}], ")"}], "\[Rule]", " ", 
            "Nothing"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", "tn_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", "\"\<\[CurlyEpsilon]\>\""}], 
             ")"}]}], " ", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "idxx_"}], ")"}], "\[Rule]", " ", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "ONFFtidx"}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "tc_"}], ")"}], "\[Rule]",
             " ", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "ONFFm"}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"MetricDeterminant", "\[Rule]", "md_"}], ")"}], 
            "\[Rule]", "Nothing"}], " ", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ChristoffelComponents", "\[Rule]", "ccc_"}], ")"}], 
            "\[Rule]", "Nothing"}], " ", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"RiemannComponents", "\[Rule]", "rc_"}], ")"}], 
            "\[Rule]", "Nothing"}], " ", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"RicciComponents", "\[Rule]", "ric_"}], ")"}], "\[Rule]",
             "Nothing"}], " ", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"RicciScalarInvariant", "\[Rule]", "rsi_"}], ")"}], 
            "\[Rule]", "Nothing"}], " ", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
             "OrthonormalFrameFieldIndices", "\[Rule]", "onffidxxx_"}], ")"}],
             "\[Rule]", "Nothing"}]}], " ", "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ONFFinvt", "=", 
        RowBox[{"ONFFt", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "idxx_"}], ")"}], "\[Rule]", " ", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "ONFFinvtidx"}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "tc_"}], ")"}], "\[Rule]",
             " ", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "ONFFinvm"}], ")"}]}]}], 
          "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ONFFt", "=", 
        RowBox[{"Apply", "[", 
         RowBox[{"Tensor", ",", "ONFFt"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ONFFinvt", "=", 
        RowBox[{"Apply", "[", 
         RowBox[{"Tensor", ",", "ONFFinvt"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tempm", "=", 
        RowBox[{"ReleaseHold", "[", 
         RowBox[{"(*", 
          RowBox[{
           StyleBox["Hold",
            FontColor->RGBColor[1, 0, 1]], " ", "first", " ", "and", " ", 
           RowBox[{"replace", ".", " ", "To"}], " ", "avoid", " ", "trigger", 
           " ", "initial", " ", "pattern", " ", "and", " ", "create", " ", 
           "infinte", " ", 
           RowBox[{"loop", "."}]}], "*)"}], 
         RowBox[{
          RowBox[{"Hold", "[", 
           RowBox[{
           "Tensor", "[", "\[IndentingNewLine]", "xx", "\[IndentingNewLine]", 
            "]"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"FlatMetric", "\[Rule]", "fm_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"FlatMetric", "\[Rule]", "Flatmetric"}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"OrthonormalFrameField", "\[Rule]", "onf_"}], ")"}], 
             "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"OrthonormalFrameField", "\[Rule]", "ONFFt"}], ")"}]}], 
            ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "ionf_"}], 
              ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "ONFFinvt"}],
               ")"}]}]}], "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8601080522590923`*^9, 3.8601081081782317`*^9}, {
   3.860108811512925*^9, 3.8601088371643662`*^9}, {3.8601095812633944`*^9, 
   3.860109581732105*^9}, {3.8601101383349247`*^9, 3.8601101387255373`*^9}, 
   3.8601101930271015`*^9, {3.86011035996247*^9, 3.860110371228373*^9}, {
   3.8601104262791476`*^9, 3.8601104782863235`*^9}, {3.8601105112798724`*^9, 
   3.860110546463823*^9}, {3.860110590503169*^9, 3.8601108217131147`*^9}, {
   3.8601109130146365`*^9, 3.8601109130615134`*^9}, {3.8601109455241995`*^9, 
   3.86011096347215*^9}, 3.860111054501237*^9, {3.8601116091614213`*^9, 
   3.860111646034217*^9}, {3.860111755837822*^9, 3.8601117804486065`*^9}, {
   3.860112181427363*^9, 3.8601123158824863`*^9}, {3.860112482889504*^9, 
   3.8601124983706427`*^9}, {3.86011312294491*^9, 3.8601131953905745`*^9}, 
   3.8601136846374483`*^9, {3.86011380527277*^9, 3.8601138056321363`*^9}, 
   3.860113838140704*^9, {3.8601138896641283`*^9, 3.860113889976621*^9}, {
   3.860114189114008*^9, 3.8601142126037383`*^9}, {3.860114322604232*^9, 
   3.8601143252135296`*^9}, 3.8601149892654653`*^9, {3.860115025869733*^9, 
   3.860115028604026*^9}, {3.860115118839145*^9, 3.860115124198991*^9}, 
   3.8601180296784124`*^9, {3.8601181066120033`*^9, 3.860118110301178*^9}, 
   3.8604722115502033`*^9, {3.8605778278176594`*^9, 3.8605778509044867`*^9}, {
   3.8605779281712427`*^9, 3.8605779364162397`*^9}, {3.8605779755922413`*^9, 
   3.860577979136243*^9}, {3.860663753607079*^9, 3.8606637632430806`*^9}, {
   3.8606641863329043`*^9, 3.860664260996916*^9}, 3.8606646229786787`*^9, 
   3.8606647042290688`*^9, {3.860664835251212*^9, 3.860664996450909*^9}, {
   3.8606652653092923`*^9, 3.8606652661862936`*^9}, {3.8606654497703395`*^9, 
   3.860665450723338*^9}, {3.8606657115904317`*^9, 3.8606657139964275`*^9}, {
   3.860665766731951*^9, 3.8606657748269486`*^9}, {3.8606660277208195`*^9, 
   3.860666049186817*^9}, {3.8606669449796877`*^9, 3.86066696337269*^9}, {
   3.8606671253952312`*^9, 3.8606671385900197`*^9}, {3.8606676493271637`*^9, 
   3.86066767901116*^9}, {3.8607198490544224`*^9, 3.8607198614807205`*^9}, 
   3.860720062704801*^9, {3.8607203324562683`*^9, 3.860720403837408*^9}, {
   3.861139623586132*^9, 3.8611396412312202`*^9}, {3.8611401948165274`*^9, 
   3.861140393349902*^9}, {3.8611404311198716`*^9, 3.861140640869858*^9}, {
   3.8611408367197275`*^9, 3.861140887128128*^9}, {3.8611409409898925`*^9, 
   3.861141009699751*^9}, {3.8611410603676467`*^9, 3.86114120335999*^9}, {
   3.861141248939698*^9, 3.861141290329917*^9}, {3.8611413464874115`*^9, 
   3.861141476179534*^9}, {3.86114171073994*^9, 3.861141772289896*^9}, {
   3.8611421239499493`*^9, 3.8611422365900736`*^9}, {3.861142266949956*^9, 
   3.8611424022398853`*^9}, {3.8611428492863407`*^9, 3.861142850696164*^9}, {
   3.861142937178194*^9, 3.861142961765764*^9}, {3.861143322765983*^9, 
   3.8611433242240114`*^9}, {3.8612292602860684`*^9, 3.86122926115753*^9}, {
   3.861236554709715*^9, 3.861236739783842*^9}, {3.8612374710153465`*^9, 
   3.861237549945371*^9}, 3.861237813310624*^9, {3.8612785357984533`*^9, 
   3.861278549488081*^9}, {3.8613224431771493`*^9, 3.861322509927991*^9}, {
   3.861322662281725*^9, 3.8613226730645533`*^9}, {3.861326351092517*^9, 
   3.8613263541936083`*^9}, {3.8613326825228963`*^9, 3.861332687431579*^9}, {
   3.8613327213047214`*^9, 3.861332803607329*^9}, {3.8613330619187245`*^9, 
   3.8613331732761126`*^9}, {3.861333208717292*^9, 3.861333280608028*^9}, {
   3.8655880592341213`*^9, 3.8655880615349355`*^9}, 3.865721377649269*^9, {
   3.8757455905406084`*^9, 3.87574560410826*^9}, {3.875752823311498*^9, 
   3.875752882433886*^9}, {3.875752928897497*^9, 3.875752940482314*^9}, {
   3.8861136166742306`*^9, 3.886113647311449*^9}, {3.8922078275038404`*^9, 
   3.8922078323769617`*^9}, {3.892207904753392*^9, 3.8922079351642046`*^9}, {
   3.892208035144802*^9, 3.8922080770152235`*^9}, {3.89220812284818*^9, 
   3.8922083076686697`*^9}, {3.8922083865564146`*^9, 3.892208462742731*^9}, 
   3.89220881354918*^9, {3.892208863450921*^9, 3.892208890987011*^9}, {
   3.8928660462310443`*^9, 3.8928661016849337`*^9}, {3.895071831213197*^9, 
   3.8950718471912403`*^9}, {3.899189493127262*^9, 3.899189601264044*^9}, {
   3.8991897843029346`*^9, 3.8991897982993107`*^9}, {3.8991898952026377`*^9, 
   3.8991898968905945`*^9}, {3.899189987148969*^9, 3.899189994265585*^9}, 
   3.8993769789349537`*^9, {3.899378287275901*^9, 3.8993782898882885`*^9}, {
   3.9028232275413523`*^9, 3.902823232122712*^9}, {3.9028247896595116`*^9, 
   3.902824832629794*^9}, {3.95299375036834*^9, 3.952993767972468*^9}, {
   3.956199042478525*^9, 3.9561990425554132`*^9}, {3.95993409252913*^9, 
   3.959934152071274*^9}, {3.9677774516308575`*^9, 3.967777451640383*^9}, 
   3.971052880751697*^9, {3.9710533394390507`*^9, 3.971053347222699*^9}, 
   3.971083296890932*^9, {3.971083500975155*^9, 3.971083503654166*^9}, 
   3.971085616933097*^9, 3.971087787685368*^9, 3.9717500097664633`*^9, {
   3.971750787760158*^9, 3.9717508134585657`*^9}, {3.971750890744589*^9, 
   3.9717508920370407`*^9}, 3.971751660727211*^9, 3.972352197584866*^9, {
   3.972352314438554*^9, 3.972352337062351*^9}, 3.972352375597863*^9, 
   3.972352592887938*^9, 3.972353135044132*^9, 3.972353514180698*^9, {
   3.9737654918890963`*^9, 3.973765491907929*^9}, {3.975308473687353*^9, 
   3.975308569438274*^9}, {3.9753086039662333`*^9, 
   3.9753086514777203`*^9}},ExpressionUUID->"f1b9dee0-dab0-4772-9362-\
1e686da3addd"]
}, Closed]],

Cell[CellGroupData[{

Cell["Series", "Subsubsection",
 CellChangeTimes->{
  3.8611418015499945`*^9},ExpressionUUID->"f5ba511d-dc39-4266-9a5d-\
b47036fe4c37"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     StyleBox["Series",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox["expansion",
      FontColor->RGBColor[0.5, 0, 0.5]], " ", "on", " ", "geometric", " ", 
     "quantities"}], ";", " ", 
    RowBox[{
    "Normal", " ", "is", " ", "applied", " ", "to", " ", "get", " ", "rid", 
     " ", "of", " ", "the", " ", "O", " ", "sign"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Need", " ", "to", " ", "remember", " ", "to", " ", "apply", " ", "Series",
     " ", "on", " ", "Tooltipdisplay", " ", "stuff", " ", 
    RowBox[{"too", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Metric", " ", "related"}],
    FontColor->RGBColor[0, 0, 1]], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tensor", "/:", 
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
        RowBox[{"xx___", ",", "\[IndentingNewLine]", 
         RowBox[{"TensorType", "\[Rule]", "\"\<Metric\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TensorComponents", "\[Rule]", "matrix_"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MetricDeterminant", "\[Rule]", "Detg_"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ChristoffelComponents", "\[Rule]", "ChrisRules_"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"RiemannComponents", "\[Rule]", "RiemRules_"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"RicciComponents", "\[Rule]", "RicRules_"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"RicciScalarInvariant", "\[Rule]", "RRule_"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"OrthonormalFrameField", "\[Rule]", "onffuser_"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
         "InverseOrthonormalFrameField", "\[Rule]", "invonffuser_"}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[Epsilon]__List"}], "]"}], ":=", 
     RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
      RowBox[{"xx", ",", "\[IndentingNewLine]", 
       RowBox[{"TensorType", "\[Rule]", "\"\<Metric\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TensorComponents", "\[Rule]", 
        RowBox[{"Normal", "[", 
         RowBox[{"Series", "[", 
          RowBox[{"matrix", ",", "\[Epsilon]"}], "]"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"MetricDeterminant", "\[Rule]", 
        RowBox[{"Normal", "[", 
         RowBox[{"Series", "[", 
          RowBox[{"Detg", ",", "\[Epsilon]"}], "]"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ChristoffelComponents", "\[Rule]", "ChrisRules"}], "/.", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ChristoffelComponents", "[", "chx__", "]"}], "\[Rule]", 
           "rhs_"}], ")"}], "\[RuleDelayed]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ChristoffelComponents", "[", "chx", "]"}], "\[Rule]", 
           RowBox[{"Normal", "[", 
            RowBox[{"Series", "[", 
             RowBox[{"rhs", ",", "\[Epsilon]"}], "]"}], "]"}]}], ")"}]}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"RiemannComponents", "\[Rule]", "RiemRules"}], "/.", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"RiemannComponents", "[", "riex__", "]"}], "\[Rule]", 
           "rhs_"}], ")"}], "\[RuleDelayed]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"RiemannComponents", "[", "riex", "]"}], "\[Rule]", 
           RowBox[{"Normal", "[", 
            RowBox[{"Series", "[", 
             RowBox[{"rhs", ",", "\[Epsilon]"}], "]"}], "]"}]}], ")"}]}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"RicciComponents", "\[Rule]", "RicRules"}], "/.", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"RicciComponents", "[", "ricx__", "]"}], "\[Rule]", 
           "rhs_"}], ")"}], "\[RuleDelayed]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"RicciComponents", "[", "ricx", "]"}], "\[Rule]", 
           RowBox[{"Normal", "[", 
            RowBox[{"Series", "[", 
             RowBox[{"rhs", ",", "\[Epsilon]"}], "]"}], "]"}]}], ")"}]}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"RicciScalarInvariant", "\[Rule]", "RRule"}], "/.", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"RicciScalar", "\[Rule]", "rhs_"}], ")"}], "\[RuleDelayed]", 
         RowBox[{"(", 
          RowBox[{"RicciScalar", "\[Rule]", 
           RowBox[{"Normal", "[", 
            RowBox[{"Series", "[", 
             RowBox[{"rhs", ",", "\[Epsilon]"}], "]"}], "]"}]}], ")"}]}]}], 
       ",", 
       RowBox[{"OrthonormalFrameField", "\[Rule]", 
        RowBox[{"Normal", "[", 
         RowBox[{"Series", "[", 
          RowBox[{"onffuser", ",", "\[Epsilon]"}], "]"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"InverseOrthonormalFrameField", "\[Rule]", 
        RowBox[{"Normal", "[", 
         RowBox[{"Series", "[", 
          RowBox[{"invonffuser", ",", "\[Epsilon]"}], "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     StyleBox[
      RowBox[{"Non", "-", "Metric"}],
      FontColor->RGBColor[0, 0, 1]], ",", " ", 
     RowBox[{"Does", " ", "not", " ", "contain", " ", "TooltipDisplay"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Tensor", "/:", 
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{"t_Tensor", "/;", 
        RowBox[{"(", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TensorTypeNoPart", "[", "t", "]"}], "=!=", 
           RowBox[{"{", "\"\<Metric\>\"", "}"}]}], ")"}], ")"}]}], ",", 
       "\[Epsilon]__List"}], "]"}], ":=", 
     RowBox[{"t", "/.", 
      RowBox[{"{", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
         "\[RuleDelayed]", 
         RowBox[{"(", 
          RowBox[{"TensorComponents", "\[Rule]", 
           RowBox[{"Normal", "[", 
            RowBox[{"Series", "[", 
             RowBox[{"mx", ",", "\[Epsilon]"}], "]"}], "]"}]}], ")"}]}], 
        ")"}], "}"}]}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.518287025359375*^9, 3.518287083796875*^9}, {
   3.518287204515625*^9, 3.518287246046875*^9}, {3.518288154015625*^9, 
   3.518288179625*^9}, {3.5196834121875*^9, 3.519683417953125*^9}, {
   3.519689356625*^9, 3.519689356921875*^9}, {3.51976580715625*^9, 
   3.519765810671875*^9}, {3.519963432453125*^9, 3.519963433953125*^9}, 
   3.520125837828125*^9, {3.5201289498125*^9, 3.5201289504375*^9}, 
   3.520219859578125*^9, 3.5202268538125*^9, {3.52027377246875*^9, 
   3.520273831296875*^9}, {3.5202738760625*^9, 3.52027388446875*^9}, {
   3.5202739371875*^9, 3.5202741019375*^9}, {3.52027416353125*^9, 
   3.520274167671875*^9}, 3.520274919453125*^9, {3.52027495775*^9, 
   3.52027500990625*^9}, {3.520275109328125*^9, 3.52027513640625*^9}, {
   3.520275352625*^9, 3.520275353015625*^9}, {3.52027552415625*^9, 
   3.5202755711875*^9}, 3.520275790296875*^9, {3.5202759311875*^9, 
   3.520275948625*^9}, {3.520276746125*^9, 3.5202767880625*^9}, {
   3.52027692378125*^9, 3.52027700428125*^9}, {3.520277061046875*^9, 
   3.520277097125*^9}, {3.520277138046875*^9, 3.520277203125*^9}, {
   3.52027851596875*^9, 3.520278524*^9}, {3.52027856384375*^9, 
   3.520278653328125*^9}, 3.5202787563125*^9, {3.520279456296875*^9, 
   3.5202794635625*^9}, {3.520279561640625*^9, 3.520279567359375*^9}, {
   3.52028006315625*^9, 3.520280068671875*^9}, {3.5202804206875*^9, 
   3.520280495234375*^9}, 3.520281272765625*^9, {3.52028149878125*^9, 
   3.5202815018125*^9}, {3.520281674421875*^9, 3.5202816786875*^9}, {
   3.520281727390625*^9, 3.520281730375*^9}, 3.52028190265625*^9, {
   3.52028213190625*^9, 3.520282169640625*^9}, {3.520282364859375*^9, 
   3.520282395859375*^9}, {3.520282483109375*^9, 3.520282499046875*^9}, {
   3.52028567246875*^9, 3.520285695984375*^9}, {3.5202857606875*^9, 
   3.520285762578125*^9}, {3.520285792890625*^9, 3.520285807109375*^9}, {
   3.5202858616875*^9, 3.52028586721875*^9}, {3.520286964859375*^9, 
   3.520286985015625*^9}, {3.52028713909375*^9, 3.520287168453125*^9}, {
   3.52030002590625*^9, 3.520300043171875*^9}, {3.520300760625*^9, 
   3.520300806765625*^9}, {3.52030106778125*^9, 3.520301101625*^9}, {
   3.520301143203125*^9, 3.520301143921875*^9}, {3.520301203140625*^9, 
   3.520301219734375*^9}, {3.520301382671875*^9, 3.520301408375*^9}, {
   3.5203015531875*^9, 3.520301561859375*^9}, {3.52030160309375*^9, 
   3.52030162021875*^9}, {3.520301674546875*^9, 3.520301675078125*^9}, 
   3.520301885265625*^9, {3.52030235646875*^9, 3.5203024485*^9}, {
   3.52030252584375*^9, 3.520302587984375*^9}, {3.520302792015625*^9, 
   3.520302959515625*^9}, {3.520303101875*^9, 3.520303107296875*^9}, {
   3.520303238609375*^9, 3.52030324271875*^9}, {3.520303299859375*^9, 
   3.520303323609375*^9}, 3.5203034191875*^9, {3.5203509418125*^9, 
   3.520350955265625*^9}, {3.520374181640625*^9, 3.52037419353125*^9}, {
   3.52037428890625*^9, 3.52037429225*^9}, {3.520374390359375*^9, 
   3.520374391046875*^9}, {3.52037449153125*^9, 3.520374508859375*^9}, {
   3.520374542359375*^9, 3.520374562515625*^9}, {3.520374665328125*^9, 
   3.520374666125*^9}, {3.520374798734375*^9, 3.5203748170625*^9}, {
   3.520442091734375*^9, 3.520442103078125*^9}, {3.520442156859375*^9, 
   3.520442237609375*^9}, {3.520442932203125*^9, 3.520442946328125*^9}, 
   3.5204430529375*^9, {3.520449654171875*^9, 3.520449741703125*^9}, {
   3.520461701390625*^9, 3.52046171115625*^9}, {3.520461829296875*^9, 
   3.5204618643125*^9}, {3.52046189925*^9, 3.5204619086875*^9}, {
   3.520462190671875*^9, 3.520462199265625*^9}, {3.520462248390625*^9, 
   3.520462255953125*^9}, {3.52046263196875*^9, 3.520462676203125*^9}, {
   3.520462781609375*^9, 3.520462783296875*^9}, {3.52046295721875*^9, 
   3.52046300696875*^9}, {3.520463069578125*^9, 3.520463097359375*^9}, {
   3.52046330721875*^9, 3.520463328234375*^9}, {3.520463500234375*^9, 
   3.520463506578125*^9}, {3.5204635759375*^9, 3.52046357878125*^9}, {
   3.520463627625*^9, 3.520463634921875*^9}, {3.52046371734375*^9, 
   3.520463719828125*^9}, {3.520463799875*^9, 3.52046387153125*^9}, {
   3.5204646916875*^9, 3.520464736625*^9}, {3.52069951259375*^9, 
   3.520699699609375*^9}, {3.520699992109375*^9, 3.52069999440625*^9}, {
   3.520811957234375*^9, 3.520812132578125*^9}, {3.52081218434375*^9, 
   3.520812365828125*^9}, {3.520812564921875*^9, 3.520812569625*^9}, {
   3.5208126603125*^9, 3.520812664359375*^9}, {3.5208127515*^9, 
   3.52081275875*^9}, {3.520812849*^9, 3.520812859109375*^9}, {
   3.520812903453125*^9, 3.5208130645*^9}, {3.520813114734375*^9, 
   3.520813119109375*^9}, {3.52081316215625*^9, 3.52081316665625*^9}, {
   3.5208133298125*^9, 3.520813333390625*^9}, {3.5208135518125*^9, 
   3.520813616953125*^9}, {3.520814478625*^9, 3.520814517421875*^9}, {
   3.520814555859375*^9, 3.520814613671875*^9}, {3.5208146563125*^9, 
   3.520814722828125*^9}, {3.52081482359375*^9, 3.520814830421875*^9}, {
   3.52087296378125*^9, 3.520873035734375*^9}, {3.52087306871875*^9, 
   3.520873075875*^9}, {3.520873179546875*^9, 3.5208732265625*^9}, {
   3.52087327746875*^9, 3.520873296546875*^9}, {3.52087335853125*^9, 
   3.520873361484375*^9}, {3.520873428328125*^9, 3.520873439921875*^9}, {
   3.520873528796875*^9, 3.520873596453125*^9}, {3.520874029125*^9, 
   3.520874058125*^9}, {3.52087876996875*^9, 3.520878774265625*^9}, {
   3.520879095359375*^9, 3.520879096078125*^9}, {3.520881848546875*^9, 
   3.520882124296875*^9}, {3.5208821583125*^9, 3.5208822268125*^9}, {
   3.520882285359375*^9, 3.520882299640625*^9}, {3.52088233096875*^9, 
   3.520882332296875*^9}, {3.52088237009375*^9, 3.5208825624375*^9}, {
   3.520882741546875*^9, 3.5208828856875*^9}, {3.520884240671875*^9, 
   3.520884241375*^9}, {3.520885397109375*^9, 3.520885515015625*^9}, {
   3.52088556446875*^9, 3.5208858435625*^9}, {3.520885898484375*^9, 
   3.520885974234375*^9}, {3.520898025796875*^9, 3.520898078625*^9}, {
   3.520898132015625*^9, 3.520898159171875*^9}, {3.520898268171875*^9, 
   3.520898439453125*^9}, {3.520898471875*^9, 3.52089847509375*^9}, {
   3.5208987905625*^9, 3.520898791046875*^9}, 3.520957046015625*^9, {
   3.5209570961875*^9, 3.520957131078125*^9}, {3.52107807721875*^9, 
   3.521078188765625*^9}, {3.5210782819375*^9, 3.521078383796875*^9}, {
   3.521137026140625*^9, 3.521137068953125*^9}, {3.521142246921875*^9, 
   3.52114265653125*^9}, {3.52114442525*^9, 3.521144472171875*^9}, {
   3.521144505640625*^9, 3.52114451575*^9}, {3.52114454646875*^9, 
   3.5211445929375*^9}, {3.52121984296875*^9, 3.5212198994375*^9}, {
   3.521220739*^9, 3.52122090625*^9}, {3.521221086375*^9, 
   3.5212210973125*^9}, {3.521221169703125*^9, 3.521221170109375*^9}, {
   3.521241296640625*^9, 3.52124132271875*^9}, {3.521241364609375*^9, 
   3.521241377921875*^9}, {3.521241761265625*^9, 3.521241789875*^9}, {
   3.52125020228125*^9, 3.5212503195*^9}, {3.521250367578125*^9, 
   3.52125043315625*^9}, {3.521348381171875*^9, 3.521348591296875*^9}, {
   3.5213486974375*^9, 3.52134881896875*^9}, {3.52134888690625*^9, 
   3.521348973890625*^9}, 3.5213493814375*^9, 3.521349424265625*^9, {
   3.521349591765625*^9, 3.52134976540625*^9}, {3.521349909984375*^9, 
   3.52134995234375*^9}, {3.5213501821875*^9, 3.521350185953125*^9}, {
   3.5213504943125*^9, 3.521350511640625*^9}, {3.5213506120625*^9, 
   3.521350633390625*^9}, {3.52135068425*^9, 3.521350712765625*^9}, {
   3.521351003671875*^9, 3.521351010375*^9}, {3.52135113328125*^9, 
   3.52135113853125*^9}, {3.521351225125*^9, 3.521351264515625*^9}, {
   3.521353769546875*^9, 3.52135380609375*^9}, {3.52135391003125*^9, 
   3.5213539324375*^9}, {3.52138689021875*^9, 3.521386896859375*^9}, {
   3.5213915893125*^9, 3.52139181034375*^9}, {3.52139186425*^9, 
   3.521391942109375*^9}, {3.521391976125*^9, 3.521391991109375*^9}, {
   3.521392049890625*^9, 3.52139216490625*^9}, {3.52139221046875*^9, 
   3.521392215734375*^9}, {3.52139226215625*^9, 3.5213922816875*^9}, {
   3.5213923241875*^9, 3.52139238159375*^9}, {3.521392606671875*^9, 
   3.5213926106875*^9}, {3.521392646546875*^9, 3.521392830515625*^9}, {
   3.521392927671875*^9, 3.521392945734375*^9}, {3.521393239734375*^9, 
   3.521393253125*^9}, {3.52139330940625*^9, 3.52139332665625*^9}, {
   3.52139486253125*^9, 3.52139486378125*^9}, {3.521395281328125*^9, 
   3.521395287609375*^9}, {3.52139612678125*^9, 3.521396148546875*^9}, {
   3.521396433484375*^9, 3.52139647615625*^9}, {3.521396513796875*^9, 
   3.521396530703125*^9}, {3.521396718125*^9, 3.521396718453125*^9}, {
   3.521398676140625*^9, 3.52139875478125*^9}, {3.52139878946875*^9, 
   3.52139882240625*^9}, {3.521399017640625*^9, 3.521399148484375*^9}, {
   3.521399182484375*^9, 3.521399183546875*^9}, {3.521399244109375*^9, 
   3.5213993385*^9}, {3.5213995170625*^9, 3.521399783703125*^9}, {
   3.52139984184375*^9, 3.521399940109375*^9}, {3.521400227171875*^9, 
   3.521400233828125*^9}, {3.521400279890625*^9, 3.5214002875625*^9}, {
   3.521400370515625*^9, 3.521400373984375*^9}, {3.521400410140625*^9, 
   3.521400412890625*^9}, {3.521401423609375*^9, 3.52140142775*^9}, {
   3.5214015165625*^9, 3.52140151815625*^9}, {3.521401780921875*^9, 
   3.521401883765625*^9}, {3.52140193640625*^9, 3.521401969265625*^9}, {
   3.52140201503125*^9, 3.52140202003125*^9}, {3.521402455625*^9, 
   3.5214025640625*^9}, {3.52140260134375*^9, 3.52140261928125*^9}, {
   3.521402734453125*^9, 3.521402863140625*^9}, {3.52141532615625*^9, 
   3.5214153873125*^9}, {3.5214156420625*^9, 3.52141570696875*^9}, {
   3.521442583140625*^9, 3.521442620640625*^9}, {3.521442651796875*^9, 
   3.521442666296875*^9}, {3.5214427025*^9, 3.521442792484375*^9}, {
   3.52144286128125*^9, 3.52144296165625*^9}, {3.521443004765625*^9, 
   3.5214430215625*^9}, {3.52144312996875*^9, 3.521443237265625*^9}, {
   3.521443272421875*^9, 3.52144328728125*^9}, {3.521471452890625*^9, 
   3.521471462828125*^9}, {3.521472116640625*^9, 3.52147218709375*^9}, {
   3.521472280796875*^9, 3.52147230184375*^9}, {3.521472418421875*^9, 
   3.521472429140625*^9}, {3.521472511109375*^9, 3.521472519234375*^9}, {
   3.521472551109375*^9, 3.521472579375*^9}, {3.52164943446875*^9, 
   3.521649441140625*^9}, {3.52164978603125*^9, 3.521649794796875*^9}, {
   3.521653219375*^9, 3.521653224921875*^9}, {3.52165329765625*^9, 
   3.5216533165625*^9}, {3.52165483128125*^9, 3.521654835875*^9}, {
   3.5216555458125*^9, 3.5216555685*^9}, {3.52166988665625*^9, 
   3.52166989046875*^9}, {3.521670768421875*^9, 3.52167081534375*^9}, {
   3.521670849203125*^9, 3.521670860421875*^9}, {3.521670891625*^9, 
   3.5216709856875*^9}, {3.521671147125*^9, 3.52167118725*^9}, {
   3.5216712428125*^9, 3.521671386015625*^9}, {3.52167158846875*^9, 
   3.5216716393125*^9}, {3.52167168784375*^9, 3.52167170453125*^9}, {
   3.521671767953125*^9, 3.521671800890625*^9}, {3.52167184703125*^9, 
   3.52167188040625*^9}, {3.5216719656875*^9, 3.5216720203125*^9}, {
   3.521672086421875*^9, 3.521672149015625*^9}, {3.521672195671875*^9, 
   3.5216722440625*^9}, {3.521672320125*^9, 3.52167243040625*^9}, {
   3.521672468421875*^9, 3.521672645609375*^9}, 3.521672796265625*^9, {
   3.5216729164375*^9, 3.52167311040625*^9}, {3.521673143375*^9, 
   3.52167317259375*^9}, {3.521673209484375*^9, 3.521673232453125*^9}, {
   3.521673284078125*^9, 3.52167331528125*^9}, {3.52167336734375*^9, 
   3.521673388625*^9}, {3.5216751101875*^9, 3.52167523325*^9}, {
   3.5216758554375*^9, 3.52167588446875*^9}, {3.521676011109375*^9, 
   3.521676031296875*^9}, {3.521676083265625*^9, 3.52167608490625*^9}, {
   3.52167614078125*^9, 3.521676144140625*^9}, {3.521676218859375*^9, 
   3.521676219984375*^9}, {3.521676257140625*^9, 3.521676342625*^9}, {
   3.521676404546875*^9, 3.52167643903125*^9}, {3.52167657284375*^9, 
   3.521676714046875*^9}, {3.521676750734375*^9, 3.521676871203125*^9}, {
   3.521677046671875*^9, 3.521677063546875*^9}, {3.5216771815625*^9, 
   3.52167723953125*^9}, {3.52167732425*^9, 3.52167734403125*^9}, {
   3.521677383*^9, 3.521677383875*^9}, {3.521677432109375*^9, 
   3.521677540125*^9}, {3.52167758334375*^9, 3.521677617234375*^9}, {
   3.521677668*^9, 3.521677671203125*^9}, {3.52167772715625*^9, 
   3.521677757234375*^9}, {3.521677788*^9, 3.52167782253125*^9}, {
   3.521677906875*^9, 3.521677914546875*^9}, {3.521677984171875*^9, 
   3.5216780049375*^9}, {3.521678053546875*^9, 3.521678053734375*^9}, {
   3.5216998578125*^9, 3.52169988396875*^9}, {3.521699914484375*^9, 
   3.521699973359375*^9}, {3.521700012703125*^9, 3.52170021290625*^9}, {
   3.521700272359375*^9, 3.521700381625*^9}, {3.52170041990625*^9, 
   3.52170087975*^9}, {3.52170095365625*^9, 3.5217009635*^9}, {
   3.52170103315625*^9, 3.52170115653125*^9}, {3.521701254953125*^9, 
   3.521701351890625*^9}, {3.5217013993125*^9, 3.521701438234375*^9}, {
   3.521701516515625*^9, 3.52170153925*^9}, {3.521701892234375*^9, 
   3.52170189378125*^9}, {3.521702314984375*^9, 3.521702329390625*^9}, {
   3.52173341071875*^9, 3.521733630953125*^9}, {3.52173367478125*^9, 
   3.52173375459375*^9}, {3.521733804375*^9, 3.521733833953125*^9}, {
   3.521741591*^9, 3.52174163671875*^9}, {3.521741705890625*^9, 
   3.521741768546875*^9}, {3.52174187984375*^9, 3.52174188003125*^9}, {
   3.521742036875*^9, 3.52174203709375*^9}, {3.521745152640625*^9, 
   3.521745164734375*^9}, {3.521745200890625*^9, 3.521745255765625*^9}, {
   3.521745324890625*^9, 3.52174536284375*^9}, {3.521745446203125*^9, 
   3.52174547321875*^9}, {3.521745506265625*^9, 3.521745513234375*^9}, {
   3.52174554921875*^9, 3.52174556996875*^9}, {3.5217456041875*^9, 
   3.521745606546875*^9}, {3.521745796859375*^9, 3.521745798109375*^9}, {
   3.521746119421875*^9, 3.521746202171875*^9}, {3.521746247578125*^9, 
   3.5217462608125*^9}, {3.521746322625*^9, 3.521746349625*^9}, {
   3.52175678640625*^9, 3.521756816921875*^9}, {3.521757001703125*^9, 
   3.521757017046875*^9}, {3.5217610119375*^9, 3.52176102221875*^9}, {
   3.5217647861875*^9, 3.521764807984375*^9}, {3.521764873484375*^9, 
   3.521764892078125*^9}, {3.52176496665625*^9, 3.521764992953125*^9}, {
   3.521765145359375*^9, 3.52176515403125*^9}, {3.52176547803125*^9, 
   3.521765486640625*^9}, {3.521784419484375*^9, 3.52178441959375*^9}, {
   3.521784735171875*^9, 3.521784739125*^9}, {3.521784803*^9, 
   3.521784832328125*^9}, {3.5217852330625*^9, 3.521785233265625*^9}, {
   3.521788073828125*^9, 3.521788104875*^9}, {3.52179265278125*^9, 
   3.521792721640625*^9}, {3.521792757875*^9, 3.521792783609375*^9}, {
   3.52179304334375*^9, 3.521793217125*^9}, {3.521793247703125*^9, 
   3.52179326671875*^9}, {3.521867759015625*^9, 3.521867794828125*^9}, {
   3.521903765703125*^9, 3.52190378259375*^9}, {3.521910287625*^9, 
   3.5219103075625*^9}, {3.52191037603125*^9, 3.521910410796875*^9}, {
   3.52191902275*^9, 3.521919058921875*^9}, {3.52191974478125*^9, 
   3.5219197580625*^9}, {3.5219389993125*^9, 3.521939153*^9}, {
   3.52194930271875*^9, 3.52194932571875*^9}, {3.52194942278125*^9, 
   3.5219494263125*^9}, {3.521950287453125*^9, 3.52195029703125*^9}, {
   3.521953722984375*^9, 3.52195380025*^9}, {3.52195433934375*^9, 
   3.521954407375*^9}, {3.5219544496875*^9, 3.52195451690625*^9}, {
   3.5219546679375*^9, 3.52195468209375*^9}, {3.5219548593125*^9, 
   3.521954863546875*^9}, {3.52195602975*^9, 3.521956063796875*^9}, {
   3.52195629140625*^9, 3.521956357828125*^9}, {3.521956396453125*^9, 
   3.5219564374375*^9}, {3.5338712661975746`*^9, 3.533871361323346*^9}, {
   3.5338813382784786`*^9, 3.5338813663273277`*^9}, {3.5338815867333527`*^9, 
   3.53388159891597*^9}, {3.5338816780572996`*^9, 3.533881853354808*^9}, {
   3.533881894133279*^9, 3.5338820548759613`*^9}, {3.53388210515485*^9, 
   3.5338821573837414`*^9}, {3.5338824795243073`*^9, 3.533882480304309*^9}, {
   3.5338826190353527`*^9, 3.5338826220773573`*^9}, {3.533882797000465*^9, 
   3.5338828884946256`*^9}, 3.533882972625573*^9, {3.5338830165708504`*^9, 
   3.533883031609277*^9}, {3.533883077816558*^9, 3.5338830803125625`*^9}, {
   3.5338831964547663`*^9, 3.533883212085994*^9}, {3.5338832641276855`*^9, 
   3.533883270461296*^9}, {3.5338833237977905`*^9, 3.5338833905035076`*^9}, {
   3.5338834292071753`*^9, 3.5338834566632233`*^9}, {3.5338835023089037`*^9, 
   3.5338835056785097`*^9}, {3.5338835727118273`*^9, 
   3.5338835994502745`*^9}, {3.5338836545651712`*^9, 
   3.5338836686519957`*^9}, {3.533883732097307*^9, 3.533883735388913*^9}, {
   3.5338838282402763`*^9, 3.533883831469482*^9}, {3.5338838790807657`*^9, 
   3.5338839318556585`*^9}, {3.5338841950601697`*^9, 
   3.5338842006611776`*^9}, {3.533884289183502*^9, 3.533884385586038*^9}, {
   3.5338844540299344`*^9, 3.5338846658554325`*^9}, {3.533896646054044*^9, 
   3.5338967398621426`*^9}, {3.533896822025326*^9, 3.5338968359964437`*^9}, {
   3.53389691032167*^9, 3.5338969105856824`*^9}, {3.5338971233903627`*^9, 
   3.5338971363541813`*^9}, {3.533897219401898*^9, 3.5338972354505205`*^9}, {
   3.5338972707361703`*^9, 3.5338972749661765`*^9}, {3.5338978585023127`*^9, 
   3.533897865536066*^9}, {3.5338979217961693`*^9, 3.533898000278984*^9}, {
   3.5338980623234015`*^9, 3.533898066186492*^9}, {3.533898144347541*^9, 
   3.5338981535560675`*^9}, {3.533898233983821*^9, 3.5338982373649206`*^9}, {
   3.5339312966250153`*^9, 3.533931296985016*^9}, {3.5339314506542325`*^9, 
   3.5339314570856414`*^9}, {3.533931664934333*^9, 3.5339316768215537`*^9}, {
   3.5857213419283295`*^9, 3.58572134252113*^9}, {3.5857215487846923`*^9, 
   3.585721549174693*^9}, {3.585721605319192*^9, 3.5857216509180717`*^9}, {
   3.5857216896061397`*^9, 3.585721690448541*^9}, {3.58572175242745*^9, 
   3.5857217649074717`*^9}, {3.5857221603837667`*^9, 3.585722165188575*^9}, {
   3.5857222535315304`*^9, 3.5857222644515495`*^9}, {3.5857227752120466`*^9, 
   3.5857228235877314`*^9}, {3.585722986264817*^9, 3.5857230354673033`*^9}, {
   3.585723093686606*^9, 3.585723122203456*^9}, {3.585723169643139*^9, 
   3.585723171733543*^9}, {3.5857232526664853`*^9, 3.58572327258772*^9}, {
   3.606335159966839*^9, 3.606335198046506*^9}, {3.6063352330685673`*^9, 
   3.606335262131418*^9}, {3.6063353403967557`*^9, 3.6063353699744077`*^9}, {
   3.6063355019506392`*^9, 3.6063355100002537`*^9}, {3.6063358322344193`*^9, 
   3.6063358372576284`*^9}, {3.6066738883426533`*^9, 3.606673983512097*^9}, {
   3.6066740559482403`*^9, 3.6066740635486746`*^9}, {3.6066743363332767`*^9, 
   3.606674360126638*^9}, {3.6066746414127264`*^9, 3.6066746456029663`*^9}, {
   3.6066746864413023`*^9, 3.6066746935107064`*^9}, {3.606764163770528*^9, 
   3.6067641878257694`*^9}, {3.6067646447193723`*^9, 
   3.6067646954194613`*^9}, {3.6067650160780244`*^9, 
   3.6067650464980783`*^9}, {3.629562191862056*^9, 3.6295622179565096`*^9}, {
   3.6295624903759656`*^9, 3.6295625052137947`*^9}, {3.629562566755515*^9, 
   3.6295625671621156`*^9}, {3.629563111218094*^9, 3.6295631194739094`*^9}, {
   3.6295678441846895`*^9, 3.6295678567385135`*^9}, {3.6295769150568147`*^9, 
   3.629576939323668*^9}, 3.6295791738516903`*^9, 3.6295792209418187`*^9, {
   3.629581267714156*^9, 3.6295812912406006`*^9}, {3.629581325784066*^9, 
   3.629581340671893*^9}, {3.6295814029374175`*^9, 3.629581429304266*^9}, {
   3.6295818560362825`*^9, 3.629581856332683*^9}, {3.6295819110649934`*^9, 
   3.6295819150988007`*^9}, 3.62958195994705*^9, {3.6295827367218447`*^9, 
   3.6295827372990456`*^9}, {3.629582811380183*^9, 3.6295830005573826`*^9}, {
   3.6295922773693624`*^9, 3.6295923269242268`*^9}, {3.629592361069789*^9, 
   3.629592363895294*^9}, {3.6295923947624507`*^9, 3.6295924368449287`*^9}, {
   3.629592556257448*^9, 3.6295925866629047`*^9}, {3.6295926742687674`*^9, 
   3.6295926896873956`*^9}, {3.629592857642812*^9, 3.6295928635884237`*^9}, {
   3.6296008298157945`*^9, 3.629600857037795*^9}, {3.6296010760041723`*^9, 
   3.6296011709187737`*^9}, {3.6296012604938602`*^9, 
   3.6296013158603663`*^9}, {3.629601566485784*^9, 3.6296017289910207`*^9}, {
   3.629601965126772*^9, 3.629602009106655*^9}, {3.629602234491691*^9, 
   3.62960233417128*^9}, {3.6296025406568675`*^9, 3.629602545034876*^9}, {
   3.629602605592389*^9, 3.6296026720725155`*^9}, {3.629602819991993*^9, 
   3.629602824448001*^9}, {3.629605598839726*^9, 3.629605607327141*^9}, {
   3.6296058220871186`*^9, 3.62960582882633*^9}, {3.6296063832065477`*^9, 
   3.629606402387883*^9}, {3.629606538604329*^9, 3.6296066163905716`*^9}, {
   3.629606677993684*^9, 3.629606687579601*^9}, {3.6296068047490234`*^9, 
   3.629606830226368*^9}, 3.6296068624429245`*^9, {3.6296068979092875`*^9, 
   3.6296069681300106`*^9}, {3.629609076756136*^9, 3.6296091040088844`*^9}, {
   3.6296099141079187`*^9, 3.6296099316810493`*^9}, {3.6296100423732443`*^9, 
   3.629610095608038*^9}, {3.6296101382529125`*^9, 3.6296102324377785`*^9}, {
   3.629610465776189*^9, 3.6296105719830756`*^9}, {3.6296106080628395`*^9, 
   3.6296106195756593`*^9}, {3.629610656929625*^9, 3.629610732269657*^9}, {
   3.629610770130324*^9, 3.629610865268092*^9}, {3.629610900164753*^9, 
   3.6296109467227354`*^9}, {3.62961103488599*^9, 3.629611035478791*^9}, {
   3.62961131996777*^9, 3.629611351764426*^9}, {3.6296113965317063`*^9, 
   3.629611407320126*^9}, {3.629611650866873*^9, 3.629611658370486*^9}, {
   3.629611693028248*^9, 3.629611725211104*^9}, {3.629660344681587*^9, 
   3.629660396816783*^9}, {3.629662054116185*^9, 3.629662109498183*^9}, {
   3.629662485797946*^9, 3.629662506233982*^9}, {3.6296627377648115`*^9, 
   3.629662875565055*^9}, {3.629663059835583*^9, 3.6296630605400844`*^9}, {
   3.629663213456155*^9, 3.6296632447274103`*^9}, {3.62966339066107*^9, 
   3.629663505423672*^9}, {3.629663629963293*^9, 3.62966374139069*^9}, 
   3.6296637790073557`*^9, {3.6296639427647448`*^9, 3.62966405344954*^9}, {
   3.629664258753003*^9, 3.6296642835833473`*^9}, {3.629664357640478*^9, 
   3.629664406652266*^9}, {3.6296644497627425`*^9, 3.6296644754010878`*^9}, {
   3.6296645845515814`*^9, 3.629664754351282*^9}, {3.6296648207714*^9, 
   3.6296648719226904`*^9}, {3.6296649072767525`*^9, 3.629665007539429*^9}, {
   3.629665128176044*^9, 3.629665131155649*^9}, {3.629665198002467*^9, 
   3.629665208579286*^9}, {3.629665989873558*^9, 3.6296660606365824`*^9}, {
   3.629666240755704*^9, 3.629666248087716*^9}, {3.629680463417473*^9, 
   3.629680463611674*^9}, {3.6296839559917583`*^9, 3.629684004376444*^9}, {
   3.629684359598235*^9, 3.6296844225402164`*^9}, {3.629697473161625*^9, 
   3.6296975310175266`*^9}, {3.6296984575100627`*^9, 
   3.6296984799167023`*^9}, {3.629698536527603*^9, 3.6296985539120336`*^9}, {
   3.6297029070413284`*^9, 3.629702918063344*^9}, {3.629702984562439*^9, 
   3.629702988605445*^9}, {3.6297038644319816`*^9, 3.629703884097009*^9}, 
   3.6297039422184496`*^9, {3.629704987754769*^9, 3.6297050664593077`*^9}, {
   3.6297051249286375`*^9, 3.6297051564516935`*^9}, {3.6297051944125605`*^9, 
   3.6297052523000636`*^9}, {3.6297052825731173`*^9, 
   3.6297053031671534`*^9}, {3.629705388300189*^9, 3.62970538895539*^9}, {
   3.62972916921355*^9, 3.6297291763503666`*^9}, {3.6297292561692886`*^9, 
   3.629729263599902*^9}, {3.629761051728472*^9, 3.629761065720507*^9}, {
   3.629829049363864*^9, 3.629829080818822*^9}, {3.629832420822437*^9, 
   3.629832422351239*^9}, {3.629833134540451*^9, 3.629833156760482*^9}, {
   3.629841550046672*^9, 3.62984155467428*^9}, {3.6298419857146883`*^9, 
   3.6298419986509113`*^9}, {3.629842327687729*^9, 3.6298423483446655`*^9}, {
   3.6298424340556164`*^9, 3.6298424347651176`*^9}, {3.629857562453469*^9, 
   3.6298575752992034`*^9}, {3.6298617363544903`*^9, 3.629861743498315*^9}, {
   3.629861792832088*^9, 3.629861797965208*^9}, {3.6298621478116827`*^9, 
   3.6298621703399477`*^9}, {3.629862224692195*^9, 3.6298622386228337`*^9}, {
   3.629934024806528*^9, 3.6299340705926085`*^9}, {3.629935785029563*^9, 
   3.6299358234439325`*^9}, {3.630093833832834*^9, 3.630093925755106*^9}, {
   3.6303312112935457`*^9, 3.6303312550516224`*^9}, {3.6303358993921537`*^9, 
   3.6303359226755953`*^9}, {3.6306356399709835`*^9, 
   3.6306356458927946`*^9}, {3.630636068179586*^9, 3.6306361110125637`*^9}, {
   3.6306361560057445`*^9, 3.630636184065894*^9}, {3.630636235447586*^9, 
   3.630636267952746*^9}, {3.63063630275181*^9, 3.6306363664175234`*^9}, {
   3.6306364437215614`*^9, 3.6306365062241726`*^9}, {3.630636538221331*^9, 
   3.630636557862567*^9}, {3.630636607219159*^9, 3.6306366182246785`*^9}, {
   3.6306367049124327`*^9, 3.6306367069872365`*^9}, {3.6306367739863553`*^9, 
   3.6306368265585485`*^9}, {3.6306368669329214`*^9, 
   3.6306368850077534`*^9}, {3.6306369704707117`*^9, 
   3.6306369715340137`*^9}, {3.6306370050048733`*^9, 3.6306370121403866`*^9}, 
   3.6306370476386495`*^9, {3.6306371345330048`*^9, 3.6306371389166126`*^9}, {
   3.6306372376894894`*^9, 3.6306372761020594`*^9}, {3.6306374107348022`*^9, 
   3.6306374177860146`*^9}, {3.6306374703665094`*^9, 
   3.6306376025850487`*^9}, {3.6306376480269303`*^9, 
   3.6306376569389467`*^9}, {3.630637688572405*^9, 3.6306377047228336`*^9}, {
   3.630638005103675*^9, 3.63063803012432*^9}, {3.630638132477803*^9, 
   3.6306381742124786`*^9}, {3.630638443344762*^9, 3.6306384548725824`*^9}, {
   3.630693969338559*^9, 3.6306940821519747`*^9}, {3.630694494199352*^9, 
   3.6306945206800165`*^9}, {3.63069542859525*^9, 3.6306954292512627`*^9}, {
   3.630695677045081*^9, 3.6306957023971386`*^9}, {3.63069573859525*^9, 
   3.6306958461515474`*^9}, {3.6306960563359995`*^9, 3.630696315629788*^9}, {
   3.630696895134617*^9, 3.6306969769772644`*^9}, {3.6306970092793493`*^9, 
   3.630697023245936*^9}, {3.6306970610093985`*^9, 3.6306971134507113`*^9}, {
   3.63069721480139*^9, 3.6306972323263006`*^9}, {3.671909193986844*^9, 
   3.6719092506401615`*^9}, {3.8358601334159107`*^9, 3.835860134977911*^9}, {
   3.872730352918479*^9, 3.8727303559106407`*^9}, {3.872730441325736*^9, 
   3.8727306353403215`*^9}, {3.8727321029186935`*^9, 
   3.8727321153410535`*^9}, {3.872732234281945*^9, 3.8727324192912235`*^9}, {
   3.8727324961060076`*^9, 3.872732510602254*^9}, {3.872732562842143*^9, 
   3.872732837241123*^9}, 3.872732870207861*^9, {3.872732911695358*^9, 
   3.8727330531424704`*^9}, 3.8727435514542027`*^9, 3.8727436034754596`*^9, {
   3.8732447099846177`*^9, 3.873244719176941*^9}, {3.8732449340058103`*^9, 
   3.8732449457468014`*^9}, {3.873247874567914*^9, 3.873247887447654*^9}, {
   3.873248068717987*^9, 3.873248074307585*^9}, {3.873248291320121*^9, 
   3.8732482962880373`*^9}, {3.873248374358128*^9, 3.873248382467146*^9}, {
   3.8732484489576817`*^9, 3.8732485508179083`*^9}, {3.8732487303304234`*^9, 
   3.873248772308071*^9}, {3.8732489313437614`*^9, 3.87324893586771*^9}, {
   3.873249085168085*^9, 3.8732491010700884`*^9}, {3.8732495020780067`*^9, 
   3.8732495084056253`*^9}, {3.873249576056493*^9, 3.873249582757741*^9}, {
   3.873249657367875*^9, 3.873249685967734*^9}, {3.8732498875379305`*^9, 
   3.8732499012460546`*^9}, 3.8732499749981422`*^9, {3.8732500374880967`*^9, 
   3.8732501047881336`*^9}, {3.8732501459354644`*^9, 
   3.8732503004081473`*^9}, {3.873250365348068*^9, 3.873250371343517*^9}, {
   3.8732507312001114`*^9, 3.873250748805163*^9}, {3.873252414133135*^9, 
   3.8732524237231483`*^9}, {3.8733297644200706`*^9, 
   3.8733297656700373`*^9}, {3.873329946826194*^9, 3.8733300147290106`*^9}, {
   3.8757529754787717`*^9, 3.8757530554782963`*^9}, 3.875753532855688*^9, {
   3.970695940581005*^9, 3.970695981810074*^9}, {3.9753087406580067`*^9, 
   3.9753087764030952`*^9}},ExpressionUUID->"52b440c1-9bbf-457b-af8b-\
55cb007f9e1c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Dimensions", "Subsubsection",
 CellChangeTimes->{
  3.8611419236597853`*^9},ExpressionUUID->"5199a88c-d4cf-4f1e-92d6-\
70c2399599c5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Dimensions", " ", "of", " ", "Tensors"}],
    FontColor->RGBColor[0.5, 0, 0.5]], 
   StyleBox[" ",
    FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", 
    StyleBox[
     RowBox[{"TagSetDelay", " ", 
      RowBox[{"w", "/", "t_Tensor"}]}],
     FontColor->RGBColor[0.5, 0, 0.5]]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Tensor", "/:", 
    RowBox[{"Dimensions", "[", "t_Tensor", "]"}], ":=", 
    RowBox[{"Dimensions", "[", 
     RowBox[{"TensorComponents", "[", "t", "]"}], "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.672964252873741*^9, 3.6729643833032446`*^9}, {
  3.7669422126612077`*^9, 3.7669422444372387`*^9}, {3.8727216231185036`*^9, 
  3.8727216299701567`*^9}, {3.873329800511198*^9, 
  3.873329800948694*^9}},ExpressionUUID->"f39524e6-1023-42d5-91d4-\
26667a17a23e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Normal", "Subsubsection",
 CellChangeTimes->{{3.884219844687734*^9, 3.8842198478557863`*^9}, 
   3.8853787123059735`*^9},ExpressionUUID->"2eb70b72-66c1-4cca-92a3-\
faebd7ac4aa9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tensor", "/:", 
   RowBox[{"Normal", "[", "t_Tensor", "]"}], ":=", 
   RowBox[{"t", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"TensorComponents", "\[Rule]", " ", "comp_"}], ")"}], 
      "\[RuleDelayed]", " ", 
      RowBox[{"(", 
       RowBox[{"TensorComponents", "\[Rule]", " ", 
        RowBox[{"Normal", "[", "comp", "]"}]}], ")"}]}], "}"}]}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8842199221650925`*^9, 3.884220015159384*^9}, {
  3.8842200466150427`*^9, 3.884220061318999*^9}, {3.884220506412386*^9, 
  3.8842205113085737`*^9}, {3.8847798554973927`*^9, 3.884779888464262*^9}, {
  3.8853783112753534`*^9, 3.8853783139706917`*^9}, {3.8853787176826577`*^9, 
  3.885378721984007*^9}},ExpressionUUID->"2e9cd62b-3af6-44da-a73d-\
4f398e9fd199"]
}, Closed]],

Cell[CellGroupData[{

Cell["Conjugate", "Subsubsection",
 CellChangeTimes->{{3.884219844687734*^9, 
  3.8842198478557863`*^9}},ExpressionUUID->"f7e3c5b7-2c51-41cc-b797-\
cdaf49449972"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tensor", "/:", 
   RowBox[{"Conjugate", "[", "t_Tensor", "]"}], ":=", 
   RowBox[{"t", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"TensorComponents", "\[Rule]", " ", "comp_"}], ")"}], 
       "\[RuleDelayed]", " ", 
       RowBox[{"(", 
        RowBox[{"TensorComponents", "\[Rule]", " ", 
         RowBox[{"Conjugate", "[", "comp", "]"}]}], ")"}]}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"TensorName", "\[Rule]", " ", "name_"}], ")"}], 
       "\[RuleDelayed]", " ", 
       RowBox[{"(", 
        RowBox[{"TensorName", "\[Rule]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Head", "[", "name", "]"}], "===", "OverBar"}], ")"}], 
           ",", 
           RowBox[{
           "name", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           ",", "True", ",", " ", 
           RowBox[{"OverBar", "[", "name", "]"}]}], "]"}]}], ")"}]}]}], 
     "}"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8842199221650925`*^9, 3.884220015159384*^9}, {
   3.8842200466150427`*^9, 3.884220061318999*^9}, {3.884220506412386*^9, 
   3.8842205113085737`*^9}, {3.8847798554973927`*^9, 3.884779888464262*^9}, 
   3.8854273448100014`*^9},ExpressionUUID->"944f0416-dd94-4d25-b197-\
86aa93bad688"]
}, Closed]],

Cell[CellGroupData[{

Cell["Derivative for Tensor", "Subsubsection",
 CellChangeTimes->{{3.8611418192322197`*^9, 
  3.8611418232219305`*^9}},ExpressionUUID->"453dc659-8cc9-4a14-b820-\
7a84bc7c10c1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   StyleBox["D",
    FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"PartialD", "[", "\[IndentingNewLine]", 
     RowBox[{"t_Tensor", ",", 
      RowBox[{"stuff_", "/;", 
       RowBox[{"TestExpressionForm", "[", "stuff", "]"}]}]}], "]"}], ":=", 
    RowBox[{"(*", 
     RowBox[{"re", "-", 
      RowBox[{"declare", " ", "a", " ", "new", " ", "Tensor", " ", 
       RowBox[{"w", "/", " ", "add"}], " ", 
       StyleBox["\"\<\[PartialD]\>\"",
        FontColor->RGBColor[1, 0, 1]], " ", "in", " ", "front", " ", "if", 
       " ", 
       StyleBox["TensorName",
        FontColor->RGBColor[1, 0, 1]], " ", "and", " ", "take", " ", "a", " ", 
       StyleBox["derivative",
        FontColor->RGBColor[1, 0, 1]], " ", "on", " ", "all", " ", "the", " ", 
       RowBox[{
        StyleBox["TensorComponents",
         FontColor->RGBColor[1, 0, 1]], "."}]}]}], "*)"}], 
    RowBox[{"t", "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"TensorName", "\[Rule]", "tc_"}], ")"}], "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"TensorName", "\[Rule]", 
          RowBox[{
           RowBox[{"Subscript", "[", 
            RowBox[{"\"\<\[PartialD]\>\"", ",", "stuff"}], "]"}], "[", 
           RowBox[{"TensorName", "[", "t", "]"}], "]"}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"TensorComponents", "\[Rule]", "cc_"}], ")"}], "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"TensorComponents", "\[Rule]", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"TensorComponents", "[", "t", "]"}], ",", "stuff"}], 
           "]"}]}], ")"}]}]}], "}"}]}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.518287025359375*^9, 3.518287083796875*^9}, {
   3.518287204515625*^9, 3.518287246046875*^9}, {3.518288154015625*^9, 
   3.518288179625*^9}, {3.5196834121875*^9, 3.519683417953125*^9}, {
   3.519689356625*^9, 3.519689356921875*^9}, {3.51976580715625*^9, 
   3.519765810671875*^9}, {3.519963432453125*^9, 3.519963433953125*^9}, 
   3.520125837828125*^9, {3.5201289498125*^9, 3.5201289504375*^9}, 
   3.520219859578125*^9, 3.5202268538125*^9, {3.52027377246875*^9, 
   3.520273831296875*^9}, {3.5202738760625*^9, 3.52027388446875*^9}, {
   3.5202739371875*^9, 3.5202741019375*^9}, {3.52027416353125*^9, 
   3.520274167671875*^9}, 3.520274919453125*^9, {3.52027495775*^9, 
   3.52027500990625*^9}, {3.520275109328125*^9, 3.52027513640625*^9}, {
   3.520275352625*^9, 3.520275353015625*^9}, {3.52027552415625*^9, 
   3.5202755711875*^9}, 3.520275790296875*^9, {3.5202759311875*^9, 
   3.520275948625*^9}, {3.520276746125*^9, 3.5202767880625*^9}, {
   3.52027692378125*^9, 3.52027700428125*^9}, {3.520277061046875*^9, 
   3.520277097125*^9}, {3.520277138046875*^9, 3.520277203125*^9}, {
   3.52027851596875*^9, 3.520278524*^9}, {3.52027856384375*^9, 
   3.520278653328125*^9}, 3.5202787563125*^9, {3.520279456296875*^9, 
   3.5202794635625*^9}, {3.520279561640625*^9, 3.520279567359375*^9}, {
   3.52028006315625*^9, 3.520280068671875*^9}, {3.5202804206875*^9, 
   3.520280495234375*^9}, 3.520281272765625*^9, {3.52028149878125*^9, 
   3.5202815018125*^9}, {3.520281674421875*^9, 3.5202816786875*^9}, {
   3.520281727390625*^9, 3.520281730375*^9}, 3.52028190265625*^9, {
   3.52028213190625*^9, 3.520282169640625*^9}, {3.520282364859375*^9, 
   3.520282395859375*^9}, {3.520282483109375*^9, 3.520282499046875*^9}, {
   3.52028567246875*^9, 3.520285695984375*^9}, {3.5202857606875*^9, 
   3.520285762578125*^9}, {3.520285792890625*^9, 3.520285807109375*^9}, {
   3.5202858616875*^9, 3.52028586721875*^9}, {3.520286964859375*^9, 
   3.520286985015625*^9}, {3.52028713909375*^9, 3.520287168453125*^9}, {
   3.52030002590625*^9, 3.520300043171875*^9}, {3.520300760625*^9, 
   3.520300806765625*^9}, {3.52030106778125*^9, 3.520301101625*^9}, {
   3.520301143203125*^9, 3.520301143921875*^9}, {3.520301203140625*^9, 
   3.520301219734375*^9}, {3.520301382671875*^9, 3.520301408375*^9}, {
   3.5203015531875*^9, 3.520301561859375*^9}, {3.52030160309375*^9, 
   3.52030162021875*^9}, {3.520301674546875*^9, 3.520301675078125*^9}, 
   3.520301885265625*^9, {3.52030235646875*^9, 3.5203024485*^9}, {
   3.52030252584375*^9, 3.520302587984375*^9}, {3.520302792015625*^9, 
   3.520302959515625*^9}, {3.520303101875*^9, 3.520303107296875*^9}, {
   3.520303238609375*^9, 3.52030324271875*^9}, {3.520303299859375*^9, 
   3.520303323609375*^9}, 3.5203034191875*^9, {3.5203509418125*^9, 
   3.520350955265625*^9}, {3.520374181640625*^9, 3.52037419353125*^9}, {
   3.52037428890625*^9, 3.52037429225*^9}, {3.520374390359375*^9, 
   3.520374391046875*^9}, {3.52037449153125*^9, 3.520374508859375*^9}, {
   3.520374542359375*^9, 3.520374562515625*^9}, {3.520374665328125*^9, 
   3.520374666125*^9}, {3.520374798734375*^9, 3.5203748170625*^9}, {
   3.520442091734375*^9, 3.520442103078125*^9}, {3.520442156859375*^9, 
   3.520442237609375*^9}, {3.520442932203125*^9, 3.520442946328125*^9}, 
   3.5204430529375*^9, {3.520449654171875*^9, 3.520449741703125*^9}, {
   3.520461701390625*^9, 3.52046171115625*^9}, {3.520461829296875*^9, 
   3.5204618643125*^9}, {3.52046189925*^9, 3.5204619086875*^9}, {
   3.520462190671875*^9, 3.520462199265625*^9}, {3.520462248390625*^9, 
   3.520462255953125*^9}, {3.52046263196875*^9, 3.520462676203125*^9}, {
   3.520462781609375*^9, 3.520462783296875*^9}, {3.52046295721875*^9, 
   3.52046300696875*^9}, {3.520463069578125*^9, 3.520463097359375*^9}, {
   3.52046330721875*^9, 3.520463328234375*^9}, {3.520463500234375*^9, 
   3.520463506578125*^9}, {3.5204635759375*^9, 3.52046357878125*^9}, {
   3.520463627625*^9, 3.520463634921875*^9}, {3.52046371734375*^9, 
   3.520463719828125*^9}, {3.520463799875*^9, 3.52046387153125*^9}, {
   3.5204646916875*^9, 3.520464736625*^9}, {3.52069951259375*^9, 
   3.520699699609375*^9}, {3.520699992109375*^9, 3.52069999440625*^9}, {
   3.520811957234375*^9, 3.520812132578125*^9}, {3.52081218434375*^9, 
   3.520812365828125*^9}, {3.520812564921875*^9, 3.520812569625*^9}, {
   3.5208126603125*^9, 3.520812664359375*^9}, {3.5208127515*^9, 
   3.52081275875*^9}, {3.520812849*^9, 3.520812859109375*^9}, {
   3.520812903453125*^9, 3.5208130645*^9}, {3.520813114734375*^9, 
   3.520813119109375*^9}, {3.52081316215625*^9, 3.52081316665625*^9}, {
   3.5208133298125*^9, 3.520813333390625*^9}, {3.5208135518125*^9, 
   3.520813616953125*^9}, {3.520814478625*^9, 3.520814517421875*^9}, {
   3.520814555859375*^9, 3.520814613671875*^9}, {3.5208146563125*^9, 
   3.520814722828125*^9}, {3.52081482359375*^9, 3.520814830421875*^9}, {
   3.52087296378125*^9, 3.520873035734375*^9}, {3.52087306871875*^9, 
   3.520873075875*^9}, {3.520873179546875*^9, 3.5208732265625*^9}, {
   3.52087327746875*^9, 3.520873296546875*^9}, {3.52087335853125*^9, 
   3.520873361484375*^9}, {3.520873428328125*^9, 3.520873439921875*^9}, {
   3.520873528796875*^9, 3.520873596453125*^9}, {3.520874029125*^9, 
   3.520874058125*^9}, {3.52087876996875*^9, 3.520878774265625*^9}, {
   3.520879095359375*^9, 3.520879096078125*^9}, {3.520881848546875*^9, 
   3.520882124296875*^9}, {3.5208821583125*^9, 3.5208822268125*^9}, {
   3.520882285359375*^9, 3.520882299640625*^9}, {3.52088233096875*^9, 
   3.520882332296875*^9}, {3.52088237009375*^9, 3.5208825624375*^9}, {
   3.520882741546875*^9, 3.5208828856875*^9}, {3.520884240671875*^9, 
   3.520884241375*^9}, {3.520885397109375*^9, 3.520885515015625*^9}, {
   3.52088556446875*^9, 3.5208858435625*^9}, {3.520885898484375*^9, 
   3.520885974234375*^9}, {3.520898025796875*^9, 3.520898078625*^9}, {
   3.520898132015625*^9, 3.520898159171875*^9}, {3.520898268171875*^9, 
   3.520898439453125*^9}, {3.520898471875*^9, 3.52089847509375*^9}, {
   3.5208987905625*^9, 3.520898791046875*^9}, 3.520957046015625*^9, {
   3.5209570961875*^9, 3.520957131078125*^9}, {3.52107807721875*^9, 
   3.521078188765625*^9}, {3.5210782819375*^9, 3.521078383796875*^9}, {
   3.521137026140625*^9, 3.521137068953125*^9}, {3.521142246921875*^9, 
   3.52114265653125*^9}, {3.52114442525*^9, 3.521144472171875*^9}, {
   3.521144505640625*^9, 3.52114451575*^9}, {3.52114454646875*^9, 
   3.5211445929375*^9}, {3.52121984296875*^9, 3.5212198994375*^9}, {
   3.521220739*^9, 3.52122090625*^9}, {3.521221086375*^9, 
   3.5212210973125*^9}, {3.521221169703125*^9, 3.521221170109375*^9}, {
   3.521241296640625*^9, 3.52124132271875*^9}, {3.521241364609375*^9, 
   3.521241377921875*^9}, {3.521241761265625*^9, 3.521241789875*^9}, {
   3.52125020228125*^9, 3.5212503195*^9}, {3.521250367578125*^9, 
   3.52125043315625*^9}, {3.521348381171875*^9, 3.521348591296875*^9}, {
   3.5213486974375*^9, 3.52134881896875*^9}, {3.52134888690625*^9, 
   3.521348973890625*^9}, 3.5213493814375*^9, 3.521349424265625*^9, {
   3.521349591765625*^9, 3.52134976540625*^9}, {3.521349909984375*^9, 
   3.52134995234375*^9}, {3.5213501821875*^9, 3.521350185953125*^9}, {
   3.5213504943125*^9, 3.521350511640625*^9}, {3.5213506120625*^9, 
   3.521350633390625*^9}, {3.52135068425*^9, 3.521350712765625*^9}, {
   3.521351003671875*^9, 3.521351010375*^9}, {3.52135113328125*^9, 
   3.52135113853125*^9}, {3.521351225125*^9, 3.521351264515625*^9}, {
   3.521353769546875*^9, 3.52135380609375*^9}, {3.52135391003125*^9, 
   3.5213539324375*^9}, {3.52138689021875*^9, 3.521386896859375*^9}, {
   3.5213915893125*^9, 3.52139181034375*^9}, {3.52139186425*^9, 
   3.521391942109375*^9}, {3.521391976125*^9, 3.521391991109375*^9}, {
   3.521392049890625*^9, 3.52139216490625*^9}, {3.52139221046875*^9, 
   3.521392215734375*^9}, {3.52139226215625*^9, 3.5213922816875*^9}, {
   3.5213923241875*^9, 3.52139238159375*^9}, {3.521392606671875*^9, 
   3.5213926106875*^9}, {3.521392646546875*^9, 3.521392830515625*^9}, {
   3.521392927671875*^9, 3.521392945734375*^9}, {3.521393239734375*^9, 
   3.521393253125*^9}, {3.52139330940625*^9, 3.52139332665625*^9}, {
   3.52139486253125*^9, 3.52139486378125*^9}, {3.521395281328125*^9, 
   3.521395287609375*^9}, {3.52139612678125*^9, 3.521396148546875*^9}, {
   3.521396433484375*^9, 3.52139647615625*^9}, {3.521396513796875*^9, 
   3.521396530703125*^9}, {3.521396718125*^9, 3.521396718453125*^9}, {
   3.521398676140625*^9, 3.52139875478125*^9}, {3.52139878946875*^9, 
   3.52139882240625*^9}, {3.521399017640625*^9, 3.521399148484375*^9}, {
   3.521399182484375*^9, 3.521399183546875*^9}, {3.521399244109375*^9, 
   3.5213993385*^9}, {3.5213995170625*^9, 3.521399783703125*^9}, {
   3.52139984184375*^9, 3.521399940109375*^9}, {3.521400227171875*^9, 
   3.521400233828125*^9}, {3.521400279890625*^9, 3.5214002875625*^9}, {
   3.521400370515625*^9, 3.521400373984375*^9}, {3.521400410140625*^9, 
   3.521400412890625*^9}, {3.521401423609375*^9, 3.52140142775*^9}, {
   3.5214015165625*^9, 3.52140151815625*^9}, {3.521401780921875*^9, 
   3.521401883765625*^9}, {3.52140193640625*^9, 3.521401969265625*^9}, {
   3.52140201503125*^9, 3.52140202003125*^9}, {3.521402455625*^9, 
   3.5214025640625*^9}, {3.52140260134375*^9, 3.52140261928125*^9}, {
   3.521402734453125*^9, 3.521402863140625*^9}, {3.52141532615625*^9, 
   3.5214153873125*^9}, {3.5214156420625*^9, 3.52141570696875*^9}, {
   3.521442583140625*^9, 3.521442620640625*^9}, {3.521442651796875*^9, 
   3.521442666296875*^9}, {3.5214427025*^9, 3.521442792484375*^9}, {
   3.52144286128125*^9, 3.52144296165625*^9}, {3.521443004765625*^9, 
   3.5214430215625*^9}, {3.52144312996875*^9, 3.521443237265625*^9}, {
   3.521443272421875*^9, 3.52144328728125*^9}, {3.521471452890625*^9, 
   3.521471462828125*^9}, {3.521472116640625*^9, 3.52147218709375*^9}, {
   3.521472280796875*^9, 3.52147230184375*^9}, {3.521472418421875*^9, 
   3.521472429140625*^9}, {3.521472511109375*^9, 3.521472519234375*^9}, {
   3.521472551109375*^9, 3.521472579375*^9}, {3.52164943446875*^9, 
   3.521649441140625*^9}, {3.52164978603125*^9, 3.521649794796875*^9}, {
   3.521653219375*^9, 3.521653224921875*^9}, {3.52165329765625*^9, 
   3.5216533165625*^9}, {3.52165483128125*^9, 3.521654835875*^9}, {
   3.5216555458125*^9, 3.5216555685*^9}, {3.52166988665625*^9, 
   3.52166989046875*^9}, {3.521670768421875*^9, 3.52167081534375*^9}, {
   3.521670849203125*^9, 3.521670860421875*^9}, {3.521670891625*^9, 
   3.5216709856875*^9}, {3.521671147125*^9, 3.52167118725*^9}, {
   3.5216712428125*^9, 3.521671386015625*^9}, {3.52167158846875*^9, 
   3.5216716393125*^9}, {3.52167168784375*^9, 3.52167170453125*^9}, {
   3.521671767953125*^9, 3.521671800890625*^9}, {3.52167184703125*^9, 
   3.52167188040625*^9}, {3.5216719656875*^9, 3.5216720203125*^9}, {
   3.521672086421875*^9, 3.521672149015625*^9}, {3.521672195671875*^9, 
   3.5216722440625*^9}, {3.521672320125*^9, 3.52167243040625*^9}, {
   3.521672468421875*^9, 3.521672645609375*^9}, 3.521672796265625*^9, {
   3.5216729164375*^9, 3.52167311040625*^9}, {3.521673143375*^9, 
   3.52167317259375*^9}, {3.521673209484375*^9, 3.521673232453125*^9}, {
   3.521673284078125*^9, 3.52167331528125*^9}, {3.52167336734375*^9, 
   3.521673388625*^9}, {3.5216751101875*^9, 3.52167523325*^9}, {
   3.5216758554375*^9, 3.52167588446875*^9}, {3.521676011109375*^9, 
   3.521676031296875*^9}, {3.521676083265625*^9, 3.52167608490625*^9}, {
   3.52167614078125*^9, 3.521676144140625*^9}, {3.521676218859375*^9, 
   3.521676219984375*^9}, {3.521676257140625*^9, 3.521676342625*^9}, {
   3.521676404546875*^9, 3.52167643903125*^9}, {3.52167657284375*^9, 
   3.521676714046875*^9}, {3.521676750734375*^9, 3.521676871203125*^9}, {
   3.521677046671875*^9, 3.521677063546875*^9}, {3.5216771815625*^9, 
   3.52167723953125*^9}, {3.52167732425*^9, 3.52167734403125*^9}, {
   3.521677383*^9, 3.521677383875*^9}, {3.521677432109375*^9, 
   3.521677540125*^9}, {3.52167758334375*^9, 3.521677617234375*^9}, {
   3.521677668*^9, 3.521677671203125*^9}, {3.52167772715625*^9, 
   3.521677757234375*^9}, {3.521677788*^9, 3.52167782253125*^9}, {
   3.521677906875*^9, 3.521677914546875*^9}, {3.521677984171875*^9, 
   3.5216780049375*^9}, {3.521678053546875*^9, 3.521678053734375*^9}, {
   3.5216998578125*^9, 3.52169988396875*^9}, {3.521699914484375*^9, 
   3.521699973359375*^9}, {3.521700012703125*^9, 3.52170021290625*^9}, {
   3.521700272359375*^9, 3.521700381625*^9}, {3.52170041990625*^9, 
   3.52170087975*^9}, {3.52170095365625*^9, 3.5217009635*^9}, {
   3.52170103315625*^9, 3.52170115653125*^9}, {3.521701254953125*^9, 
   3.521701351890625*^9}, {3.5217013993125*^9, 3.521701438234375*^9}, {
   3.521701516515625*^9, 3.52170153925*^9}, {3.521701892234375*^9, 
   3.52170189378125*^9}, {3.521702314984375*^9, 3.521702329390625*^9}, {
   3.52173341071875*^9, 3.521733630953125*^9}, {3.52173367478125*^9, 
   3.52173375459375*^9}, {3.521733804375*^9, 3.521733833953125*^9}, {
   3.521741591*^9, 3.52174163671875*^9}, {3.521741705890625*^9, 
   3.521741768546875*^9}, {3.52174187984375*^9, 3.52174188003125*^9}, {
   3.521742036875*^9, 3.52174203709375*^9}, {3.521745152640625*^9, 
   3.521745164734375*^9}, {3.521745200890625*^9, 3.521745255765625*^9}, {
   3.521745324890625*^9, 3.52174536284375*^9}, {3.521745446203125*^9, 
   3.52174547321875*^9}, {3.521745506265625*^9, 3.521745513234375*^9}, {
   3.52174554921875*^9, 3.52174556996875*^9}, {3.5217456041875*^9, 
   3.521745606546875*^9}, {3.521745796859375*^9, 3.521745798109375*^9}, {
   3.521746119421875*^9, 3.521746202171875*^9}, {3.521746247578125*^9, 
   3.5217462608125*^9}, {3.521746322625*^9, 3.521746349625*^9}, {
   3.52175678640625*^9, 3.521756816921875*^9}, {3.521757001703125*^9, 
   3.521757017046875*^9}, {3.5217610119375*^9, 3.52176102221875*^9}, {
   3.5217647861875*^9, 3.521764807984375*^9}, {3.521764873484375*^9, 
   3.521764892078125*^9}, {3.52176496665625*^9, 3.521764992953125*^9}, {
   3.521765145359375*^9, 3.52176515403125*^9}, {3.52176547803125*^9, 
   3.521765486640625*^9}, {3.521784419484375*^9, 3.52178441959375*^9}, {
   3.521784735171875*^9, 3.521784739125*^9}, {3.521784803*^9, 
   3.521784832328125*^9}, {3.5217852330625*^9, 3.521785233265625*^9}, {
   3.521788073828125*^9, 3.521788104875*^9}, {3.52179265278125*^9, 
   3.521792721640625*^9}, {3.521792757875*^9, 3.521792783609375*^9}, {
   3.52179304334375*^9, 3.521793217125*^9}, {3.521793247703125*^9, 
   3.52179326671875*^9}, {3.521867759015625*^9, 3.521867794828125*^9}, {
   3.521903765703125*^9, 3.52190378259375*^9}, {3.521910287625*^9, 
   3.5219103075625*^9}, {3.52191037603125*^9, 3.521910410796875*^9}, {
   3.52191902275*^9, 3.521919058921875*^9}, {3.52191974478125*^9, 
   3.5219197580625*^9}, {3.5219389993125*^9, 3.521939153*^9}, {
   3.52194930271875*^9, 3.52194932571875*^9}, {3.52194942278125*^9, 
   3.5219494263125*^9}, {3.521950287453125*^9, 3.52195029703125*^9}, {
   3.521953722984375*^9, 3.52195380025*^9}, {3.52195433934375*^9, 
   3.521954407375*^9}, {3.5219544496875*^9, 3.52195451690625*^9}, {
   3.5219546679375*^9, 3.52195468209375*^9}, {3.5219548593125*^9, 
   3.521954863546875*^9}, {3.52195602975*^9, 3.521956063796875*^9}, {
   3.52195629140625*^9, 3.521956357828125*^9}, {3.521956396453125*^9, 
   3.5219564374375*^9}, {3.5338712661975746`*^9, 3.533871361323346*^9}, {
   3.5338813382784786`*^9, 3.5338813663273277`*^9}, {3.5338815867333527`*^9, 
   3.53388159891597*^9}, {3.5338816780572996`*^9, 3.533881853354808*^9}, {
   3.533881894133279*^9, 3.5338820548759613`*^9}, {3.53388210515485*^9, 
   3.5338821573837414`*^9}, {3.5338824795243073`*^9, 3.533882480304309*^9}, {
   3.5338826190353527`*^9, 3.5338826220773573`*^9}, {3.533882797000465*^9, 
   3.5338828884946256`*^9}, 3.533882972625573*^9, {3.5338830165708504`*^9, 
   3.533883031609277*^9}, {3.533883077816558*^9, 3.5338830803125625`*^9}, {
   3.5338831964547663`*^9, 3.533883212085994*^9}, {3.5338832641276855`*^9, 
   3.533883270461296*^9}, {3.5338833237977905`*^9, 3.5338833905035076`*^9}, {
   3.5338834292071753`*^9, 3.5338834566632233`*^9}, {3.5338835023089037`*^9, 
   3.5338835056785097`*^9}, {3.5338835727118273`*^9, 
   3.5338835994502745`*^9}, {3.5338836545651712`*^9, 
   3.5338836686519957`*^9}, {3.533883732097307*^9, 3.533883735388913*^9}, {
   3.5338838282402763`*^9, 3.533883831469482*^9}, {3.5338838790807657`*^9, 
   3.5338839318556585`*^9}, {3.5338841950601697`*^9, 
   3.5338842006611776`*^9}, {3.533884289183502*^9, 3.533884385586038*^9}, {
   3.5338844540299344`*^9, 3.5338846658554325`*^9}, {3.533896646054044*^9, 
   3.5338967398621426`*^9}, {3.533896822025326*^9, 3.5338968359964437`*^9}, {
   3.53389691032167*^9, 3.5338969105856824`*^9}, {3.5338971233903627`*^9, 
   3.5338971363541813`*^9}, {3.533897219401898*^9, 3.5338972354505205`*^9}, {
   3.5338972707361703`*^9, 3.5338972749661765`*^9}, {3.5338978585023127`*^9, 
   3.533897865536066*^9}, {3.5338979217961693`*^9, 3.533898000278984*^9}, {
   3.5338980623234015`*^9, 3.533898066186492*^9}, {3.533898144347541*^9, 
   3.5338981535560675`*^9}, {3.533898233983821*^9, 3.5338982373649206`*^9}, {
   3.5339312966250153`*^9, 3.533931296985016*^9}, {3.5339314506542325`*^9, 
   3.5339314570856414`*^9}, {3.533931664934333*^9, 3.5339316768215537`*^9}, {
   3.5857213419283295`*^9, 3.58572134252113*^9}, {3.5857215487846923`*^9, 
   3.585721549174693*^9}, {3.585721605319192*^9, 3.5857216509180717`*^9}, {
   3.5857216896061397`*^9, 3.585721690448541*^9}, {3.58572175242745*^9, 
   3.5857217649074717`*^9}, {3.5857221603837667`*^9, 3.585722165188575*^9}, {
   3.5857222535315304`*^9, 3.5857222644515495`*^9}, {3.5857227752120466`*^9, 
   3.5857228235877314`*^9}, {3.585722986264817*^9, 3.5857230354673033`*^9}, {
   3.585723093686606*^9, 3.585723122203456*^9}, {3.585723169643139*^9, 
   3.585723171733543*^9}, {3.5857232526664853`*^9, 3.58572327258772*^9}, {
   3.606335159966839*^9, 3.606335198046506*^9}, {3.6063352330685673`*^9, 
   3.606335262131418*^9}, {3.6063353403967557`*^9, 3.6063353699744077`*^9}, {
   3.6063355019506392`*^9, 3.6063355100002537`*^9}, {3.6063358322344193`*^9, 
   3.6063358372576284`*^9}, {3.6066738883426533`*^9, 3.606673983512097*^9}, {
   3.6066740559482403`*^9, 3.6066740635486746`*^9}, {3.6066743363332767`*^9, 
   3.606674360126638*^9}, {3.6066746414127264`*^9, 3.6066746456029663`*^9}, {
   3.6066746864413023`*^9, 3.6066746935107064`*^9}, {3.606764163770528*^9, 
   3.6067641878257694`*^9}, {3.6067646447193723`*^9, 
   3.6067646954194613`*^9}, {3.6067650160780244`*^9, 
   3.6067650464980783`*^9}, {3.629562191862056*^9, 3.6295622179565096`*^9}, {
   3.6295624903759656`*^9, 3.6295625052137947`*^9}, {3.629562566755515*^9, 
   3.6295625671621156`*^9}, {3.629563111218094*^9, 3.6295631194739094`*^9}, {
   3.6295678441846895`*^9, 3.6295678567385135`*^9}, {3.6295769150568147`*^9, 
   3.629576939323668*^9}, 3.6295791738516903`*^9, 3.6295792209418187`*^9, {
   3.629581267714156*^9, 3.6295812912406006`*^9}, {3.629581325784066*^9, 
   3.629581340671893*^9}, {3.6295814029374175`*^9, 3.629581429304266*^9}, {
   3.6295818560362825`*^9, 3.629581856332683*^9}, {3.6295819110649934`*^9, 
   3.6295819150988007`*^9}, 3.62958195994705*^9, {3.6295827367218447`*^9, 
   3.6295827372990456`*^9}, {3.629582811380183*^9, 3.6295830005573826`*^9}, {
   3.6295922773693624`*^9, 3.6295923269242268`*^9}, {3.629592361069789*^9, 
   3.629592363895294*^9}, {3.6295923947624507`*^9, 3.6295924368449287`*^9}, {
   3.629592556257448*^9, 3.6295925866629047`*^9}, {3.6295926742687674`*^9, 
   3.6295926896873956`*^9}, {3.629592857642812*^9, 3.6295928635884237`*^9}, {
   3.6296008298157945`*^9, 3.629600857037795*^9}, {3.6296010760041723`*^9, 
   3.6296011709187737`*^9}, {3.6296012604938602`*^9, 
   3.6296013158603663`*^9}, {3.629601566485784*^9, 3.6296017289910207`*^9}, {
   3.629601965126772*^9, 3.629602009106655*^9}, {3.629602234491691*^9, 
   3.62960233417128*^9}, {3.6296025406568675`*^9, 3.629602545034876*^9}, {
   3.629602605592389*^9, 3.6296026720725155`*^9}, {3.629602819991993*^9, 
   3.629602824448001*^9}, {3.629605598839726*^9, 3.629605607327141*^9}, {
   3.6296058220871186`*^9, 3.62960582882633*^9}, {3.6296063832065477`*^9, 
   3.629606402387883*^9}, {3.629606538604329*^9, 3.6296066163905716`*^9}, {
   3.629606677993684*^9, 3.629606687579601*^9}, {3.6296068047490234`*^9, 
   3.629606830226368*^9}, 3.6296068624429245`*^9, {3.6296068979092875`*^9, 
   3.6296069681300106`*^9}, {3.629609076756136*^9, 3.6296091040088844`*^9}, {
   3.6296099141079187`*^9, 3.6296099316810493`*^9}, {3.6296100423732443`*^9, 
   3.629610095608038*^9}, {3.6296101382529125`*^9, 3.6296102324377785`*^9}, {
   3.629610465776189*^9, 3.6296105719830756`*^9}, {3.6296106080628395`*^9, 
   3.6296106195756593`*^9}, {3.629610656929625*^9, 3.629610732269657*^9}, {
   3.629610770130324*^9, 3.629610865268092*^9}, {3.629610900164753*^9, 
   3.6296109467227354`*^9}, {3.62961103488599*^9, 3.629611035478791*^9}, {
   3.62961131996777*^9, 3.629611351764426*^9}, {3.6296113965317063`*^9, 
   3.629611407320126*^9}, {3.629611650866873*^9, 3.629611658370486*^9}, {
   3.629611693028248*^9, 3.629611725211104*^9}, {3.629660344681587*^9, 
   3.629660396816783*^9}, {3.629662054116185*^9, 3.629662109498183*^9}, {
   3.629662485797946*^9, 3.629662506233982*^9}, {3.6296627377648115`*^9, 
   3.629662875565055*^9}, {3.629663059835583*^9, 3.6296630605400844`*^9}, {
   3.629663213456155*^9, 3.6296632447274103`*^9}, {3.62966339066107*^9, 
   3.629663505423672*^9}, {3.629663629963293*^9, 3.62966374139069*^9}, 
   3.6296637790073557`*^9, {3.6296639427647448`*^9, 3.62966405344954*^9}, {
   3.629664258753003*^9, 3.6296642835833473`*^9}, {3.629664357640478*^9, 
   3.629664406652266*^9}, {3.6296644497627425`*^9, 3.6296644754010878`*^9}, {
   3.6296645845515814`*^9, 3.629664754351282*^9}, {3.6296648207714*^9, 
   3.6296648719226904`*^9}, {3.6296649072767525`*^9, 3.629665007539429*^9}, {
   3.629665128176044*^9, 3.629665131155649*^9}, {3.629665198002467*^9, 
   3.629665208579286*^9}, {3.629665989873558*^9, 3.6296660606365824`*^9}, {
   3.629666240755704*^9, 3.629666248087716*^9}, {3.629680463417473*^9, 
   3.629680463611674*^9}, {3.6296839559917583`*^9, 3.629684004376444*^9}, {
   3.629684359598235*^9, 3.6296844225402164`*^9}, {3.629697473161625*^9, 
   3.6296975310175266`*^9}, {3.6296984575100627`*^9, 
   3.6296984799167023`*^9}, {3.629698536527603*^9, 3.6296985539120336`*^9}, {
   3.6297029070413284`*^9, 3.629702918063344*^9}, {3.629702984562439*^9, 
   3.629702988605445*^9}, {3.6297038644319816`*^9, 3.629703884097009*^9}, 
   3.6297039422184496`*^9, {3.629704987754769*^9, 3.6297050664593077`*^9}, {
   3.6297051249286375`*^9, 3.6297051564516935`*^9}, {3.6297051944125605`*^9, 
   3.6297052523000636`*^9}, {3.6297052825731173`*^9, 
   3.6297053031671534`*^9}, {3.629705388300189*^9, 3.62970538895539*^9}, {
   3.62972916921355*^9, 3.6297291763503666`*^9}, {3.6297292561692886`*^9, 
   3.629729263599902*^9}, {3.629761051728472*^9, 3.629761065720507*^9}, {
   3.629829049363864*^9, 3.629829080818822*^9}, {3.629832420822437*^9, 
   3.629832422351239*^9}, {3.629833134540451*^9, 3.629833156760482*^9}, {
   3.629841550046672*^9, 3.62984155467428*^9}, {3.6298419857146883`*^9, 
   3.6298419986509113`*^9}, {3.629842327687729*^9, 3.6298423483446655`*^9}, {
   3.6298424340556164`*^9, 3.6298424347651176`*^9}, {3.629857562453469*^9, 
   3.6298575752992034`*^9}, {3.6298617363544903`*^9, 3.629861743498315*^9}, {
   3.629861792832088*^9, 3.629861797965208*^9}, {3.6298621478116827`*^9, 
   3.6298621703399477`*^9}, {3.629862224692195*^9, 3.6298622386228337`*^9}, {
   3.629934024806528*^9, 3.6299340705926085`*^9}, {3.629935785029563*^9, 
   3.6299358234439325`*^9}, {3.630093833832834*^9, 3.630093925755106*^9}, {
   3.6303312112935457`*^9, 3.6303312550516224`*^9}, {3.6303358993921537`*^9, 
   3.6303359226755953`*^9}, {3.6306356399709835`*^9, 
   3.6306356458927946`*^9}, {3.630636068179586*^9, 3.6306361110125637`*^9}, {
   3.6306361560057445`*^9, 3.630636184065894*^9}, {3.630636235447586*^9, 
   3.630636267952746*^9}, {3.63063630275181*^9, 3.6306363664175234`*^9}, {
   3.6306364437215614`*^9, 3.6306365062241726`*^9}, {3.630636538221331*^9, 
   3.630636557862567*^9}, {3.630636607219159*^9, 3.6306366182246785`*^9}, {
   3.6306367049124327`*^9, 3.6306367069872365`*^9}, {3.6306367739863553`*^9, 
   3.6306368265585485`*^9}, {3.6306368669329214`*^9, 
   3.6306368850077534`*^9}, {3.6306369704707117`*^9, 
   3.6306369715340137`*^9}, {3.6306370050048733`*^9, 3.6306370121403866`*^9}, 
   3.6306370476386495`*^9, {3.6306371345330048`*^9, 3.6306371389166126`*^9}, {
   3.6306372376894894`*^9, 3.6306372761020594`*^9}, {3.6306374107348022`*^9, 
   3.6306374177860146`*^9}, {3.6306374703665094`*^9, 
   3.6306376025850487`*^9}, {3.6306376480269303`*^9, 
   3.6306376569389467`*^9}, {3.630637688572405*^9, 3.6306377047228336`*^9}, {
   3.630638005103675*^9, 3.63063803012432*^9}, {3.630638132477803*^9, 
   3.6306381742124786`*^9}, {3.630638443344762*^9, 3.6306384548725824`*^9}, {
   3.630693969338559*^9, 3.6306940821519747`*^9}, {3.630694494199352*^9, 
   3.6306945206800165`*^9}, {3.63069542859525*^9, 3.6306954292512627`*^9}, {
   3.630695677045081*^9, 3.6306957023971386`*^9}, {3.63069573859525*^9, 
   3.6306958461515474`*^9}, {3.6306960563359995`*^9, 3.630696315629788*^9}, {
   3.630696895134617*^9, 3.6306969769772644`*^9}, {3.6306970092793493`*^9, 
   3.630697023245936*^9}, {3.6306970610093985`*^9, 3.6306971134507113`*^9}, {
   3.63069721480139*^9, 3.6306972323263006`*^9}, {3.671909193986844*^9, 
   3.6719092506401615`*^9}, {3.835859602926553*^9, 3.835859728311108*^9}, {
   3.835859791250119*^9, 3.835859804322502*^9}, {3.8358598345356293`*^9, 
   3.835859838531027*^9}, 3.8358598721245165`*^9, {3.8358599532439394`*^9, 
   3.835859957561669*^9}, {3.835860143619153*^9, 3.835860145369688*^9}, {
   3.835860221002843*^9, 3.8358602625621796`*^9}, 3.8358605805204043`*^9, {
   3.8358606388794003`*^9, 3.8358606467324133`*^9}, {3.8358606937574034`*^9, 
   3.835860703303405*^9}, {3.8358617594312496`*^9, 3.83586187699807*^9}, {
   3.8358619621210504`*^9, 3.835861968212232*^9}, 3.8358627392517357`*^9, {
   3.8358627770034075`*^9, 3.8358627773683376`*^9}, {3.8358628243884783`*^9, 
   3.8358628415763392`*^9}, {3.8358629083773623`*^9, 
   3.8358629727894125`*^9}, {3.835863089365315*^9, 3.8358631243379207`*^9}, {
   3.835863169281988*^9, 3.835863187539895*^9}, 3.8358632412599115`*^9, {
   3.835863433945222*^9, 3.835863439453006*^9}, 3.835863689797821*^9, {
   3.835864063766061*^9, 3.835864120354599*^9}, {3.8358642464275*^9, 
   3.835864253261094*^9}, {3.835864422411518*^9, 3.8358644229484215`*^9}, {
   3.8358645134704227`*^9, 3.8358645669434233`*^9}, {3.835864653310423*^9, 
   3.835864656034425*^9}, {3.835864748415412*^9, 3.835864757289424*^9}, {
   3.8358708947183275`*^9, 3.835870900186552*^9}, {3.8358711248677454`*^9, 
   3.835871148471379*^9}, {3.8358712149838257`*^9, 3.8358712251802435`*^9}, {
   3.835921099472575*^9, 3.835921154919902*^9}, {3.835921201194438*^9, 
   3.8359212355804343`*^9}, {3.835921631831324*^9, 3.8359216380753202`*^9}, {
   3.8359220216857185`*^9, 3.83592204296344*^9}, {3.836440224612873*^9, 
   3.836440250386945*^9}, 3.836441933581911*^9, {3.8364425314510565`*^9, 
   3.836442545730586*^9}, {3.8375015279338017`*^9, 3.8375015289337807`*^9}, {
   3.8375015734025517`*^9, 3.8375015740900292`*^9}, 3.837639265724143*^9, 
   3.8376393651142817`*^9, {3.8376395448328195`*^9, 3.8376395474562893`*^9}, {
   3.8376396686697636`*^9, 3.837639672396969*^9}, {3.837641332851806*^9, 
   3.8376413965861115`*^9}, {3.837641460418699*^9, 3.8376415349119864`*^9}, {
   3.8376419006223016`*^9, 3.8376419028935113`*^9}, {3.837645325106383*^9, 
   3.837645329162382*^9}, {3.837645524246386*^9, 3.837645526840377*^9}, {
   3.8376457577595215`*^9, 3.8376457609835234`*^9}, 3.837646893891533*^9, {
   3.8376469333207164`*^9, 3.837646935675719*^9}, {3.837652726116737*^9, 
   3.837652735935737*^9}, {3.837654742250891*^9, 3.837654800787981*^9}, {
   3.837655243904982*^9, 3.8376552646809855`*^9}, {3.837655324350054*^9, 
   3.837655354432051*^9}, {3.8378363518154*^9, 3.8378363624912643`*^9}, {
   3.8378364540157194`*^9, 3.8378364810095468`*^9}, {3.838191010180602*^9, 
   3.83819103728315*^9}, {3.838191274355959*^9, 3.8381912791602645`*^9}, 
   3.849143402827999*^9, {3.852007855718226*^9, 3.8520078600576468`*^9}, {
   3.852020979370977*^9, 3.8520210175010433`*^9}, 3.8520217914252577`*^9, 
   3.8520222878838015`*^9, {3.8520223576512814`*^9, 3.852022359171401*^9}, {
   3.8520225524699516`*^9, 3.852022554804723*^9}, {3.853279225604104*^9, 
   3.8532792716969824`*^9}, {3.853279361008794*^9, 3.853279401192734*^9}, {
   3.8532794373436747`*^9, 3.8532795093988323`*^9}, {3.853279548519978*^9, 
   3.8532795486648865`*^9}, {3.853289082452416*^9, 3.85328914138163*^9}, 
   3.8586872691029367`*^9, {3.858818182340184*^9, 3.858818212078759*^9}, 
   3.858818317387984*^9, 3.8588183822218094`*^9, 3.858818441731039*^9, 
   3.858818488877357*^9, 3.8588977831100874`*^9, 3.8590025027744246`*^9, 
   3.859445502512094*^9, 3.8594635460141306`*^9, 3.8594635771926537`*^9, {
   3.8596019690701036`*^9, 3.85960199275854*^9}, 3.85985509097552*^9, 
   3.861767540665697*^9, 3.8617681482387257`*^9, {3.861768273538753*^9, 
   3.8617684109950356`*^9}, {3.8617684886583176`*^9, 3.861768565629671*^9}, {
   3.8617686135658855`*^9, 3.8617686422310066`*^9}, {3.861769083815488*^9, 
   3.861769084939062*^9}, {3.8617691369898*^9, 3.861769214680065*^9}, {
   3.861769274055255*^9, 3.8617692764770536`*^9}, {3.861769326113449*^9, 
   3.8617693321132317`*^9}, {3.8617697830553784`*^9, 
   3.8617698325519686`*^9}, {3.8619263463902254`*^9, 
   3.8619263567499113`*^9}, {3.86193188893808*^9, 3.861931898015473*^9}, 
   3.862532921559805*^9, {3.862536912993188*^9, 3.862536916215206*^9}, {
   3.862540519532971*^9, 3.8625405235714893`*^9}, {3.8625406675381207`*^9, 
   3.862540677495*^9}, {3.8625407080801916`*^9, 3.8625407135418344`*^9}, {
   3.8627087151699495`*^9, 3.86270872294034*^9}, 3.862967194294706*^9, {
   3.865560131108966*^9, 3.865560146517609*^9}, 3.8655605984057074`*^9, {
   3.865561281771064*^9, 3.8655613432955055`*^9}, 3.8655614475486803`*^9, {
   3.8727224444911375`*^9, 3.872722473579224*^9}, {3.872722560224428*^9, 
   3.872722588419077*^9}, 3.872722634211478*^9, {3.872722700741763*^9, 
   3.8727227032260704`*^9}, {3.872722777813127*^9, 3.8727227934793034`*^9}, {
   3.8757530700320196`*^9, 3.875753117862438*^9}, 3.890265548583604*^9, 
   3.8902846703066487`*^9, 3.890284701199937*^9, {3.8902849853181124`*^9, 
   3.8902850007286386`*^9}, {3.9737643469169817`*^9, 3.973764404885571*^9}, {
   3.9737645366814737`*^9, 3.973764536687297*^9}, {3.975233148834125*^9, 
   3.9752331518571663`*^9}, {3.9752333296071663`*^9, 3.975233353393839*^9}, 
   3.9753087911463213`*^9, {3.9753088233214006`*^9, 
   3.975308860955947*^9}},ExpressionUUID->"136d1ccd-7984-4b1f-9f4e-\
8346551e4ac6"]
}, Closed]],

Cell[CellGroupData[{

Cell["Simplify", "Subsubsection",
 CellChangeTimes->{{3.886907985980402*^9, 
  3.886908014692019*^9}},ExpressionUUID->"4c2e7990-bf65-48b1-8ec8-\
74cf66a257b3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tensor", "/:", 
   RowBox[{"Simplify", "[", "t_Tensor", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"TA", "=", 
       RowBox[{"TensorAssumption", "[", "t", "]"}]}], "}"}], ",", 
     RowBox[{"Simplify", "[", 
      RowBox[{"t", ",", "TA"}], "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.886908031314934*^9, 3.8869080833470964`*^9}, {
   3.8869084260193853`*^9, 3.8869084398507643`*^9}, {3.8869086719244003`*^9, 
   3.8869086878112245`*^9}, {3.886908781476242*^9, 3.886908785955391*^9}, {
   3.8869088702507854`*^9, 3.886908911531067*^9}, {3.8872458622983956`*^9, 
   3.8872459138629313`*^9}, {3.8920149737009*^9, 3.892014983784693*^9}, {
   3.8988528576028547`*^9, 3.898852928949194*^9}, 3.898852972958228*^9, {
   3.898853066967451*^9, 3.8988531071916084`*^9}, {3.898853230648549*^9, 
   3.898853235679679*^9}, {3.975308925516014*^9, 
   3.975308954561326*^9}},ExpressionUUID->"6e842148-ea8f-4433-b072-\
9e6630dcb93a"]
}, Closed]],

Cell[CellGroupData[{

Cell["FullSimplify", "Subsubsection",
 CellChangeTimes->{{3.886907985980402*^9, 
  3.886907993284156*^9}},ExpressionUUID->"cba288e5-988d-40bd-ae0e-\
5e166730c5fd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tensor", "/:", 
   RowBox[{"FullSimplify", "[", "t_Tensor", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"TA", "=", 
       RowBox[{"TensorAssumption", "[", "t", "]"}]}], "}"}], ",", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"t", ",", "TA"}], "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.886908054112037*^9, 3.8869080553637457`*^9}, {
   3.8869080889770255`*^9, 3.886908091971876*^9}, {3.8869089179254923`*^9, 
   3.8869089239234304`*^9}, {3.89201499261026*^9, 3.8920149997684736`*^9}, {
   3.8988529899623566`*^9, 3.8988529935404077`*^9}, 3.8988531181134205`*^9, {
   3.8988532441547756`*^9, 3.8988532474515343`*^9}, {3.975308946609338*^9, 
   3.975308951535644*^9}},ExpressionUUID->"5f34a97a-072a-4f9a-a613-\
82479f4825e7"]
}, Closed]],

Cell[CellGroupData[{

Cell["TensorSymmetry", "Subsubsection",
 CellChangeTimes->{
  3.861141905720069*^9},ExpressionUUID->"14afb864-641f-466b-b691-\
a1771dfe6365"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"TensorSymmetry", " ", "of", " ", "Tensors"}],
    FontColor->RGBColor[0.5, 0, 0.5]], 
   StyleBox[" ",
    FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Tensor", "/:", 
   RowBox[{"TensorSymmetry", "[", "t_Tensor", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "ts", "}"}], ",", 
     RowBox[{
      RowBox[{"ts", "=", 
       RowBox[{"TensorSymmetry", "[", 
        RowBox[{"TensorComponents", "[", "t", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"t", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorSymmetry", "\[Rule]", "tss_"}], ")"}], "\[Rule]",
              "tss"}]}], "]"}], "===", 
          RowBox[{"{", "}"}]}], ")"}], ",", 
        RowBox[{"{", 
         RowBox[{"ts", ",", 
          RowBox[{"Append", "[", 
           RowBox[{"t", ",", 
            RowBox[{"TensorSymmetry", "\[Rule]", "ts"}]}], "]"}]}], "}"}], 
        ",", "True", ",", 
        RowBox[{"{", 
         RowBox[{"ts", ",", 
          RowBox[{"t", "/.", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorSymmetry", "\[Rule]", "oldts_"}], ")"}], 
            "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorSymmetry", "\[Rule]", "ts"}], ")"}]}]}]}], 
         "}"}]}], "]"}]}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.672964252873741*^9, 3.6729643833032446`*^9}, {
   3.8454341927154727`*^9, 3.845434212486429*^9}, {3.8460310209181595`*^9, 
   3.8460311147301235`*^9}, {3.8460311538159637`*^9, 
   3.8460311760786333`*^9}, {3.846031368802162*^9, 3.8460313956112995`*^9}, 
   3.847244168918722*^9, {3.847244654910158*^9, 3.847244663677137*^9}, {
   3.8472458282849016`*^9, 3.847245838552026*^9}, {3.847772557700958*^9, 
   3.8477725755809636`*^9}, 3.8477831348011355`*^9, {3.84779136804475*^9, 
   3.847791373011225*^9}, {3.853218368177205*^9, 3.853218378517086*^9}, {
   3.855269307064885*^9, 3.855269564911346*^9}, {3.8552696403502526`*^9, 
   3.8552696940623903`*^9}, {3.8751423143590374`*^9, 3.87514233667031*^9}, {
   3.8751423764048605`*^9, 3.875142400268011*^9}, {3.975308997395494*^9, 
   3.975309011674721*^9}},ExpressionUUID->"37147205-5cb8-4f7a-b766-\
decc14db435c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Evaluating abstract indices at specific coordinates/values", \
"Subsubsection",
 CellChangeTimes->{
  3.8611418680599484`*^9, {3.8673187698376665`*^9, 
   3.8673187743332243`*^9}},ExpressionUUID->"21452b93-eb66-46fe-8421-\
ce6f17afd95c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "Evaluating", " ", "abstract", " ", "indices", " ", "at", " ", "specific",
      " ", 
     RowBox[{"coordinates", "/", "values"}]}],
    FontColor->RGBColor[0.5, 0, 0.5]], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"IofII", ":", " ", 
     RowBox[{
     "If", " ", "all", " ", "Indices", " ", "are", " ", "either", " ", 
      "Integers", " ", "or", " ", "Coordinates", " ", "we", " ", "return", 
      " ", "the", " ", "component"}]}],
    FontColor->RGBColor[0, 0, 1]], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "we", " ", "need", " ", "to", " ", "include", " ", "the", " ", 
    "possibility", " ", "that", " ", "there", " ", "may", " ", "be", " ", 
    "an", " ", "UnderBar", " ", "applied", " ", "to", " ", "some", " ", "of", 
    " ", "the", " ", "indices"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"No", " ", "UnderBarred", " ", "Indices"}],
    FontColor->RGBColor[0.6, 0.4, 0.2]], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
      RowBox[{"xxx___", ",", "\[IndentingNewLine]", 
       RowBox[{"Coordinates", "\[Rule]", "cooo_List"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"StartIndex", "\[Rule]", "si_Integer"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Indices", "\[Rule]", "\[Mu]T_List"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TensorComponents", "\[Rule]", "matrix_"}]}], 
      "\[IndentingNewLine]", "]"}], ":=", 
     RowBox[{
      RowBox[{"matrix", "\[LeftDoubleBracket]", 
       RowBox[{"Sequence", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"NumericIndex", "[", 
                 RowBox[{"#", ",", "cooo", ",", "si"}], "]"}], 
                "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "/.", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"OverHat", "[", "a_", "]"}], ":>", "a"}], ")"}]}], 
              ")"}], "-", "si", "+", "1"}], ")"}], "&"}], "/@", "\[Mu]T"}], 
         ")"}]}], "\[RightDoubleBracket]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Union", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"NotAbstractIndex", "[", 
            RowBox[{"#", ",", "cooo", ",", "si"}], "]"}], "&"}], "/@", 
          "\[Mu]T"}], "]"}], "===", 
        RowBox[{"{", "True", "}"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "If", " ", "there", " ", "are", " ", "more", " ", "than", " ", "1", " ", 
      "UnderBarred", " ", "Indices", " ", "and", " ", "all", " ", "Indices", 
      " ", "are", " ", "not", " ", "abstract", " ", "then", " ", "all", " ", 
      "those", " ", "indices", " ", "not", " ", "UnderBarred", " ", "are", 
      " ", "subject", " ", "to", " ", "the", " ", "operations", " ", "in", 
      " ", "IIofII", " ", "below"}], ",", " ", 
     RowBox[{
     "until", " ", "all", " ", "indices", " ", "are", " ", "UnderBarred"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "So", " ", "what", " ", "remains", " ", "is", " ", "to", " ", "deal", " ",
      "with", " ", "a", " ", "Tensor", " ", "with", " ", "all", " ", 
     "UnderBarred", " ", "Indices"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    StyleBox[
     RowBox[{"All", " ", "UnderBarred", " ", "Indices"}],
     FontColor->RGBColor[0.6, 0.4, 0.2]], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
     RowBox[{"xxx___", ",", "\[IndentingNewLine]", 
      RowBox[{"Coordinates", "\[Rule]", "cooo_List"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"StartIndex", "\[Rule]", "si_Integer"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Indices", "\[Rule]", 
       RowBox[{"\[Mu]T_List", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{"\[Mu]T", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"SuperMinus", "|", "SubMinus"}], ")"}], "[", 
               RowBox[{"UnderBar", "[", "_", "]"}], "]"}], ".."}], "}"}]}], 
           "]"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"RemoveUnderBarredIndices", "[", "\[Mu]T", "]"}], "===", 
            RowBox[{"{", "}"}]}], ")"}]}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"TensorComponents", "\[Rule]", "matrix_"}]}], 
     "\[IndentingNewLine]", "]"}], ":=", 
    RowBox[{"(*", " ", 
     RowBox[{
     "if", " ", "all", " ", "Indices", " ", "are", " ", "UnderBarred", " ", 
      "there", " ", "should", " ", "be", " ", "only", " ", "one", " ", 
      "component"}], " ", "*)"}], "matrix"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    StyleBox[
     RowBox[{"IIofII", ":", " ", 
      RowBox[{"If", " ", "one", " ", "or", " ", "more", " ", 
       RowBox[{"Indices", " ", "--"}], " ", "but", " ", "not", " ", "all", 
       " ", "of", " ", 
       RowBox[{"them", " ", "--"}], " ", "are", " ", "Integer", " ", "or", 
       " ", "coordinates", " ", "we", " ", "reduce", " ", "the", " ", "rank", 
       " ", "of", " ", "the", " ", "Tensor", " ", "accordingly"}]}],
     FontColor->RGBColor[0, 0, 1]], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
      RowBox[{"xxx___", ",", "\[IndentingNewLine]", 
       RowBox[{"Coordinates", "\[Rule]", "cooo_List"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"StartIndex", "\[Rule]", "si_Integer"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Indices", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"i1___", ",", "\[Mu]T_", ",", "i2___"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TensorComponents", "\[Rule]", "matrix_"}]}], 
      "\[IndentingNewLine]", "]"}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mtx", ",", "ni", ",", "VectorJ", ",", "ix", ",", "leftidx"}], "}"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"contract", " ", "with", " ", 
          SubscriptBox[
           SuperscriptBox["\[Delta]", "\[Mu]"], "ni"], " ", "or", " ", 
          SubscriptBox["\[Delta]", 
           RowBox[{"\[Mu]", " ", "ni"}]]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ni", "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"NumericIndex", "[", 
              RowBox[{"\[Mu]T", ",", "cooo", ",", "si"}], "]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "/.", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"OverHat", "[", "a_", "]"}], ":>", "a"}], ")"}]}], 
           ")"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           SubscriptBox[
            SuperscriptBox["\[Delta]", "\[Mu]"], "ni"], " ", "or", " ", 
           SubscriptBox["\[Delta]", 
            RowBox[{"\[Mu]", " ", "ni"}]]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"VectorJ", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"ni", "===", "ix"}], ",", "1", ",", "True", ",", "0"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"ix", ",", "si", ",", 
              RowBox[{
               RowBox[{"Length", "[", "cooo", "]"}], "+", "si", "-", "1"}]}], 
             "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "we", " ", "are", " ", "going", " ", "to", " ", "contract", " ", 
           "Tensor", " ", "with", " ", 
           SubscriptBox[
            SuperscriptBox["\[Delta]", "\[Mu]"], "ni"], " ", "or", " ", 
           SubscriptBox["\[Delta]", 
            RowBox[{"\[Mu]", " ", "ni"}]]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"mtx", "=", 
          RowBox[{"TensorProduct", "[", 
           RowBox[{"VectorJ", ",", "matrix"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "...", " ", "do", " ", "not", " ", "include", " ", "indices", " ", 
            "that", " ", "do", " ", "not", " ", "pass", " ", "TestIndices", 
            " ", "ensuring", " ", "that", " ", "sequential", " ", "Tensor", 
            " ", "reduction", " ", "is", " ", 
            RowBox[{"OK", " ", "--"}], " ", 
            RowBox[{"i", ".", "e", "."}]}], ",", " ", 
           RowBox[{"no", " ", "infinite", " ", "recursion", " ", 
            RowBox[{"occurs", " ", "--"}], " ", "as", " ", "long", " ", "as", 
            " ", "the", " ", "UnderBar", " ", "is", " ", "applied", " ", "to",
             " ", "the", " ", "said", " ", "index", " ", "after", " ", 
            "TensorContract", " ", "is", " ", "applied"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"leftidx", "=", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"{", "i1", "}"}], ",", 
            RowBox[{"xx_", "/;", 
             RowBox[{
              RowBox[{"TestIndices", "[", "xx", "]"}], "===", "False"}]}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"mtx", "=", 
          RowBox[{"TensorContract", "[", 
           RowBox[{"mtx", ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{
                RowBox[{"Length", "[", "leftidx", "]"}], "+", "2"}]}], "}"}], 
             "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"return", " ", "the", " ", "Tensor", " ", 
           RowBox[{"w", "/", " ", "everything"}], " ", "the", " ", "same", 
           " ", "except", " ", "the", " ", "TensorComponents", " ", "and", 
           " ", "the", " ", "index", " ", "\[Mu]T"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
          RowBox[{"xxx", ",", "\[IndentingNewLine]", 
           RowBox[{"Coordinates", "\[Rule]", "cooo"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"StartIndex", "\[Rule]", "si"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Indices", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"i1", ",", 
              RowBox[{"UnderBar", "/@", "\[Mu]T"}], ",", "i2"}], "}"}]}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"TensorComponents", "\[Rule]", "mtx"}]}], 
          "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"TestIndices", "[", "\[Mu]T", "]"}], "&&", 
        RowBox[{"(*", " ", 
         RowBox[{
         "check", " ", "the", " ", "index", " ", "is", " ", "not", " ", 
          "abstract"}], " ", "*)"}], 
        RowBox[{"NotAbstractIndex", "[", 
         RowBox[{"\[Mu]T", ",", "cooo", ",", "si"}], "]"}]}], ")"}]}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.518287025359375*^9, 3.518287083796875*^9}, {
   3.518287204515625*^9, 3.518287246046875*^9}, {3.518288154015625*^9, 
   3.518288179625*^9}, {3.5196834121875*^9, 3.519683417953125*^9}, {
   3.519689356625*^9, 3.519689356921875*^9}, {3.51976580715625*^9, 
   3.519765810671875*^9}, {3.519963432453125*^9, 3.519963433953125*^9}, 
   3.520125837828125*^9, {3.5201289498125*^9, 3.5201289504375*^9}, 
   3.520219859578125*^9, 3.5202268538125*^9, {3.52027377246875*^9, 
   3.520273831296875*^9}, {3.5202738760625*^9, 3.52027388446875*^9}, {
   3.5202739371875*^9, 3.5202741019375*^9}, {3.52027416353125*^9, 
   3.520274167671875*^9}, 3.520274919453125*^9, {3.52027495775*^9, 
   3.52027500990625*^9}, {3.520275109328125*^9, 3.52027513640625*^9}, {
   3.520275352625*^9, 3.520275353015625*^9}, {3.52027552415625*^9, 
   3.5202755711875*^9}, 3.520275790296875*^9, {3.5202759311875*^9, 
   3.520275948625*^9}, {3.520276746125*^9, 3.5202767880625*^9}, {
   3.52027692378125*^9, 3.52027700428125*^9}, {3.520277061046875*^9, 
   3.520277097125*^9}, {3.520277138046875*^9, 3.520277203125*^9}, {
   3.52027851596875*^9, 3.520278524*^9}, {3.52027856384375*^9, 
   3.520278653328125*^9}, 3.5202787563125*^9, {3.520279456296875*^9, 
   3.5202794635625*^9}, {3.520279561640625*^9, 3.520279567359375*^9}, {
   3.52028006315625*^9, 3.520280068671875*^9}, {3.5202804206875*^9, 
   3.520280495234375*^9}, 3.520281272765625*^9, {3.52028149878125*^9, 
   3.5202815018125*^9}, {3.520281674421875*^9, 3.5202816786875*^9}, {
   3.520281727390625*^9, 3.520281730375*^9}, 3.52028190265625*^9, {
   3.52028213190625*^9, 3.520282169640625*^9}, {3.520282364859375*^9, 
   3.520282395859375*^9}, {3.520282483109375*^9, 3.520282499046875*^9}, {
   3.52028567246875*^9, 3.520285695984375*^9}, {3.5202857606875*^9, 
   3.520285762578125*^9}, {3.520285792890625*^9, 3.520285807109375*^9}, {
   3.5202858616875*^9, 3.52028586721875*^9}, {3.520286964859375*^9, 
   3.520286985015625*^9}, {3.52028713909375*^9, 3.520287168453125*^9}, {
   3.52030002590625*^9, 3.520300043171875*^9}, {3.520300760625*^9, 
   3.520300806765625*^9}, {3.52030106778125*^9, 3.520301101625*^9}, {
   3.520301143203125*^9, 3.520301143921875*^9}, {3.520301203140625*^9, 
   3.520301219734375*^9}, {3.520301382671875*^9, 3.520301408375*^9}, {
   3.5203015531875*^9, 3.520301561859375*^9}, {3.52030160309375*^9, 
   3.52030162021875*^9}, {3.520301674546875*^9, 3.520301675078125*^9}, 
   3.520301885265625*^9, {3.52030235646875*^9, 3.5203024485*^9}, {
   3.52030252584375*^9, 3.520302587984375*^9}, {3.520302792015625*^9, 
   3.520302959515625*^9}, {3.520303101875*^9, 3.520303107296875*^9}, {
   3.520303238609375*^9, 3.52030324271875*^9}, {3.520303299859375*^9, 
   3.520303323609375*^9}, 3.5203034191875*^9, {3.5203509418125*^9, 
   3.520350955265625*^9}, {3.520374181640625*^9, 3.52037419353125*^9}, {
   3.52037428890625*^9, 3.52037429225*^9}, {3.520374390359375*^9, 
   3.520374391046875*^9}, {3.52037449153125*^9, 3.520374508859375*^9}, {
   3.520374542359375*^9, 3.520374562515625*^9}, {3.520374665328125*^9, 
   3.520374666125*^9}, {3.520374798734375*^9, 3.5203748170625*^9}, {
   3.520442091734375*^9, 3.520442103078125*^9}, {3.520442156859375*^9, 
   3.520442237609375*^9}, {3.520442932203125*^9, 3.520442946328125*^9}, 
   3.5204430529375*^9, {3.520449654171875*^9, 3.520449741703125*^9}, {
   3.520461701390625*^9, 3.52046171115625*^9}, {3.520461829296875*^9, 
   3.5204618643125*^9}, {3.52046189925*^9, 3.5204619086875*^9}, {
   3.520462190671875*^9, 3.520462199265625*^9}, {3.520462248390625*^9, 
   3.520462255953125*^9}, {3.52046263196875*^9, 3.520462676203125*^9}, {
   3.520462781609375*^9, 3.520462783296875*^9}, {3.52046295721875*^9, 
   3.52046300696875*^9}, {3.520463069578125*^9, 3.520463097359375*^9}, {
   3.52046330721875*^9, 3.520463328234375*^9}, {3.520463500234375*^9, 
   3.520463506578125*^9}, {3.5204635759375*^9, 3.52046357878125*^9}, {
   3.520463627625*^9, 3.520463634921875*^9}, {3.52046371734375*^9, 
   3.520463719828125*^9}, {3.520463799875*^9, 3.52046387153125*^9}, {
   3.5204646916875*^9, 3.520464736625*^9}, {3.52069951259375*^9, 
   3.520699699609375*^9}, {3.520699992109375*^9, 3.52069999440625*^9}, {
   3.520811957234375*^9, 3.520812132578125*^9}, {3.52081218434375*^9, 
   3.520812365828125*^9}, {3.520812564921875*^9, 3.520812569625*^9}, {
   3.5208126603125*^9, 3.520812664359375*^9}, {3.5208127515*^9, 
   3.52081275875*^9}, {3.520812849*^9, 3.520812859109375*^9}, {
   3.520812903453125*^9, 3.5208130645*^9}, {3.520813114734375*^9, 
   3.520813119109375*^9}, {3.52081316215625*^9, 3.52081316665625*^9}, {
   3.5208133298125*^9, 3.520813333390625*^9}, {3.5208135518125*^9, 
   3.520813616953125*^9}, {3.520814478625*^9, 3.520814517421875*^9}, {
   3.520814555859375*^9, 3.520814613671875*^9}, {3.5208146563125*^9, 
   3.520814722828125*^9}, {3.52081482359375*^9, 3.520814830421875*^9}, {
   3.52087296378125*^9, 3.520873035734375*^9}, {3.52087306871875*^9, 
   3.520873075875*^9}, {3.520873179546875*^9, 3.5208732265625*^9}, {
   3.52087327746875*^9, 3.520873296546875*^9}, {3.52087335853125*^9, 
   3.520873361484375*^9}, {3.520873428328125*^9, 3.520873439921875*^9}, {
   3.520873528796875*^9, 3.520873596453125*^9}, {3.520874029125*^9, 
   3.520874058125*^9}, {3.52087876996875*^9, 3.520878774265625*^9}, {
   3.520879095359375*^9, 3.520879096078125*^9}, {3.520881848546875*^9, 
   3.520882124296875*^9}, {3.5208821583125*^9, 3.5208822268125*^9}, {
   3.520882285359375*^9, 3.520882299640625*^9}, {3.52088233096875*^9, 
   3.520882332296875*^9}, {3.52088237009375*^9, 3.5208825624375*^9}, {
   3.520882741546875*^9, 3.5208828856875*^9}, {3.520884240671875*^9, 
   3.520884241375*^9}, {3.520885397109375*^9, 3.520885515015625*^9}, {
   3.52088556446875*^9, 3.5208858435625*^9}, {3.520885898484375*^9, 
   3.520885974234375*^9}, {3.520898025796875*^9, 3.520898078625*^9}, {
   3.520898132015625*^9, 3.520898159171875*^9}, {3.520898268171875*^9, 
   3.520898439453125*^9}, {3.520898471875*^9, 3.52089847509375*^9}, {
   3.5208987905625*^9, 3.520898791046875*^9}, 3.520957046015625*^9, {
   3.5209570961875*^9, 3.520957131078125*^9}, {3.52107807721875*^9, 
   3.521078188765625*^9}, {3.5210782819375*^9, 3.521078383796875*^9}, {
   3.521137026140625*^9, 3.521137068953125*^9}, {3.521142246921875*^9, 
   3.52114265653125*^9}, {3.52114442525*^9, 3.521144472171875*^9}, {
   3.521144505640625*^9, 3.52114451575*^9}, {3.52114454646875*^9, 
   3.5211445929375*^9}, {3.52121984296875*^9, 3.5212198994375*^9}, {
   3.521220739*^9, 3.52122090625*^9}, {3.521221086375*^9, 
   3.5212210973125*^9}, {3.521221169703125*^9, 3.521221170109375*^9}, {
   3.521241296640625*^9, 3.52124132271875*^9}, {3.521241364609375*^9, 
   3.521241377921875*^9}, {3.521241761265625*^9, 3.521241789875*^9}, {
   3.52125020228125*^9, 3.5212503195*^9}, {3.521250367578125*^9, 
   3.52125043315625*^9}, {3.521348381171875*^9, 3.521348591296875*^9}, {
   3.5213486974375*^9, 3.52134881896875*^9}, {3.52134888690625*^9, 
   3.521348973890625*^9}, 3.5213493814375*^9, 3.521349424265625*^9, {
   3.521349591765625*^9, 3.52134976540625*^9}, {3.521349909984375*^9, 
   3.52134995234375*^9}, {3.5213501821875*^9, 3.521350185953125*^9}, {
   3.5213504943125*^9, 3.521350511640625*^9}, {3.5213506120625*^9, 
   3.521350633390625*^9}, {3.52135068425*^9, 3.521350712765625*^9}, {
   3.521351003671875*^9, 3.521351010375*^9}, {3.52135113328125*^9, 
   3.52135113853125*^9}, {3.521351225125*^9, 3.521351264515625*^9}, {
   3.521353769546875*^9, 3.52135380609375*^9}, {3.52135391003125*^9, 
   3.5213539324375*^9}, {3.52138689021875*^9, 3.521386896859375*^9}, {
   3.5213915893125*^9, 3.52139181034375*^9}, {3.52139186425*^9, 
   3.521391942109375*^9}, {3.521391976125*^9, 3.521391991109375*^9}, {
   3.521392049890625*^9, 3.52139216490625*^9}, {3.52139221046875*^9, 
   3.521392215734375*^9}, {3.52139226215625*^9, 3.5213922816875*^9}, {
   3.5213923241875*^9, 3.52139238159375*^9}, {3.521392606671875*^9, 
   3.5213926106875*^9}, {3.521392646546875*^9, 3.521392830515625*^9}, {
   3.521392927671875*^9, 3.521392945734375*^9}, {3.521393239734375*^9, 
   3.521393253125*^9}, {3.52139330940625*^9, 3.52139332665625*^9}, {
   3.52139486253125*^9, 3.52139486378125*^9}, {3.521395281328125*^9, 
   3.521395287609375*^9}, {3.52139612678125*^9, 3.521396148546875*^9}, {
   3.521396433484375*^9, 3.52139647615625*^9}, {3.521396513796875*^9, 
   3.521396530703125*^9}, {3.521396718125*^9, 3.521396718453125*^9}, {
   3.521398676140625*^9, 3.52139875478125*^9}, {3.52139878946875*^9, 
   3.52139882240625*^9}, {3.521399017640625*^9, 3.521399148484375*^9}, {
   3.521399182484375*^9, 3.521399183546875*^9}, {3.521399244109375*^9, 
   3.5213993385*^9}, {3.5213995170625*^9, 3.521399783703125*^9}, {
   3.52139984184375*^9, 3.521399940109375*^9}, {3.521400227171875*^9, 
   3.521400233828125*^9}, {3.521400279890625*^9, 3.5214002875625*^9}, {
   3.521400370515625*^9, 3.521400373984375*^9}, {3.521400410140625*^9, 
   3.521400412890625*^9}, {3.521401423609375*^9, 3.52140142775*^9}, {
   3.5214015165625*^9, 3.52140151815625*^9}, {3.521401780921875*^9, 
   3.521401883765625*^9}, {3.52140193640625*^9, 3.521401969265625*^9}, {
   3.52140201503125*^9, 3.52140202003125*^9}, {3.521402455625*^9, 
   3.5214025640625*^9}, {3.52140260134375*^9, 3.52140261928125*^9}, {
   3.521402734453125*^9, 3.521402863140625*^9}, {3.52141532615625*^9, 
   3.5214153873125*^9}, {3.5214156420625*^9, 3.52141570696875*^9}, {
   3.521442583140625*^9, 3.521442620640625*^9}, {3.521442651796875*^9, 
   3.521442666296875*^9}, {3.5214427025*^9, 3.521442792484375*^9}, {
   3.52144286128125*^9, 3.52144296165625*^9}, {3.521443004765625*^9, 
   3.5214430215625*^9}, {3.52144312996875*^9, 3.521443237265625*^9}, {
   3.521443272421875*^9, 3.52144328728125*^9}, {3.521471452890625*^9, 
   3.521471462828125*^9}, {3.521472116640625*^9, 3.52147218709375*^9}, {
   3.521472280796875*^9, 3.52147230184375*^9}, {3.521472418421875*^9, 
   3.521472429140625*^9}, {3.521472511109375*^9, 3.521472519234375*^9}, {
   3.521472551109375*^9, 3.521472579375*^9}, {3.52164943446875*^9, 
   3.521649441140625*^9}, {3.52164978603125*^9, 3.521649794796875*^9}, {
   3.521653219375*^9, 3.521653224921875*^9}, {3.52165329765625*^9, 
   3.5216533165625*^9}, {3.52165483128125*^9, 3.521654835875*^9}, {
   3.5216555458125*^9, 3.5216555685*^9}, {3.52166988665625*^9, 
   3.52166989046875*^9}, {3.521670768421875*^9, 3.52167081534375*^9}, {
   3.521670849203125*^9, 3.521670860421875*^9}, {3.521670891625*^9, 
   3.5216709856875*^9}, {3.521671147125*^9, 3.52167118725*^9}, {
   3.5216712428125*^9, 3.521671386015625*^9}, {3.52167158846875*^9, 
   3.5216716393125*^9}, {3.52167168784375*^9, 3.52167170453125*^9}, {
   3.521671767953125*^9, 3.521671800890625*^9}, {3.52167184703125*^9, 
   3.52167188040625*^9}, {3.5216719656875*^9, 3.5216720203125*^9}, {
   3.521672086421875*^9, 3.521672149015625*^9}, {3.521672195671875*^9, 
   3.5216722440625*^9}, {3.521672320125*^9, 3.52167243040625*^9}, {
   3.521672468421875*^9, 3.521672645609375*^9}, 3.521672796265625*^9, {
   3.5216729164375*^9, 3.52167311040625*^9}, {3.521673143375*^9, 
   3.52167317259375*^9}, {3.521673209484375*^9, 3.521673232453125*^9}, {
   3.521673284078125*^9, 3.52167331528125*^9}, {3.52167336734375*^9, 
   3.521673388625*^9}, {3.5216751101875*^9, 3.52167523325*^9}, {
   3.5216758554375*^9, 3.52167588446875*^9}, {3.521676011109375*^9, 
   3.521676031296875*^9}, {3.521676083265625*^9, 3.52167608490625*^9}, {
   3.52167614078125*^9, 3.521676144140625*^9}, {3.521676218859375*^9, 
   3.521676219984375*^9}, {3.521676257140625*^9, 3.521676342625*^9}, {
   3.521676404546875*^9, 3.52167643903125*^9}, {3.52167657284375*^9, 
   3.521676714046875*^9}, {3.521676750734375*^9, 3.521676871203125*^9}, {
   3.521677046671875*^9, 3.521677063546875*^9}, {3.5216771815625*^9, 
   3.52167723953125*^9}, {3.52167732425*^9, 3.52167734403125*^9}, {
   3.521677383*^9, 3.521677383875*^9}, {3.521677432109375*^9, 
   3.521677540125*^9}, {3.52167758334375*^9, 3.521677617234375*^9}, {
   3.521677668*^9, 3.521677671203125*^9}, {3.52167772715625*^9, 
   3.521677757234375*^9}, {3.521677788*^9, 3.52167782253125*^9}, {
   3.521677906875*^9, 3.521677914546875*^9}, {3.521677984171875*^9, 
   3.5216780049375*^9}, {3.521678053546875*^9, 3.521678053734375*^9}, {
   3.5216998578125*^9, 3.52169988396875*^9}, {3.521699914484375*^9, 
   3.521699973359375*^9}, {3.521700012703125*^9, 3.52170021290625*^9}, {
   3.521700272359375*^9, 3.521700381625*^9}, {3.52170041990625*^9, 
   3.52170087975*^9}, {3.52170095365625*^9, 3.5217009635*^9}, {
   3.52170103315625*^9, 3.52170115653125*^9}, {3.521701254953125*^9, 
   3.521701351890625*^9}, {3.5217013993125*^9, 3.521701438234375*^9}, {
   3.521701516515625*^9, 3.52170153925*^9}, {3.521701892234375*^9, 
   3.52170189378125*^9}, {3.521702314984375*^9, 3.521702329390625*^9}, {
   3.52173341071875*^9, 3.521733630953125*^9}, {3.52173367478125*^9, 
   3.52173375459375*^9}, {3.521733804375*^9, 3.521733833953125*^9}, {
   3.521741591*^9, 3.52174163671875*^9}, {3.521741705890625*^9, 
   3.521741768546875*^9}, {3.52174187984375*^9, 3.52174188003125*^9}, {
   3.521742036875*^9, 3.52174203709375*^9}, {3.521745152640625*^9, 
   3.521745164734375*^9}, {3.521745200890625*^9, 3.521745255765625*^9}, {
   3.521745324890625*^9, 3.52174536284375*^9}, {3.521745446203125*^9, 
   3.52174547321875*^9}, {3.521745506265625*^9, 3.521745513234375*^9}, {
   3.52174554921875*^9, 3.52174556996875*^9}, {3.5217456041875*^9, 
   3.521745606546875*^9}, {3.521745796859375*^9, 3.521745798109375*^9}, {
   3.521746119421875*^9, 3.521746202171875*^9}, {3.521746247578125*^9, 
   3.5217462608125*^9}, {3.521746322625*^9, 3.521746349625*^9}, {
   3.52175678640625*^9, 3.521756816921875*^9}, {3.521757001703125*^9, 
   3.521757017046875*^9}, {3.5217610119375*^9, 3.52176102221875*^9}, {
   3.5217647861875*^9, 3.521764807984375*^9}, {3.521764873484375*^9, 
   3.521764892078125*^9}, {3.52176496665625*^9, 3.521764992953125*^9}, {
   3.521765145359375*^9, 3.52176515403125*^9}, {3.52176547803125*^9, 
   3.521765486640625*^9}, {3.521784419484375*^9, 3.52178441959375*^9}, {
   3.521784735171875*^9, 3.521784739125*^9}, {3.521784803*^9, 
   3.521784832328125*^9}, {3.5217852330625*^9, 3.521785233265625*^9}, {
   3.521788073828125*^9, 3.521788104875*^9}, {3.52179265278125*^9, 
   3.521792721640625*^9}, {3.521792757875*^9, 3.521792783609375*^9}, {
   3.52179304334375*^9, 3.521793217125*^9}, {3.521793247703125*^9, 
   3.52179326671875*^9}, {3.521867759015625*^9, 3.521867794828125*^9}, {
   3.521903765703125*^9, 3.52190378259375*^9}, {3.521910287625*^9, 
   3.5219103075625*^9}, {3.52191037603125*^9, 3.521910410796875*^9}, {
   3.52191902275*^9, 3.521919058921875*^9}, {3.52191974478125*^9, 
   3.5219197580625*^9}, {3.5219389993125*^9, 3.521939153*^9}, {
   3.52194930271875*^9, 3.52194932571875*^9}, {3.52194942278125*^9, 
   3.5219494263125*^9}, {3.521950287453125*^9, 3.52195029703125*^9}, {
   3.521953722984375*^9, 3.52195380025*^9}, {3.52195433934375*^9, 
   3.521954407375*^9}, {3.5219544496875*^9, 3.52195451690625*^9}, {
   3.5219546679375*^9, 3.52195468209375*^9}, {3.5219548593125*^9, 
   3.521954863546875*^9}, {3.52195602975*^9, 3.521956063796875*^9}, {
   3.52195629140625*^9, 3.521956357828125*^9}, {3.521956396453125*^9, 
   3.5219564374375*^9}, {3.5338712661975746`*^9, 3.533871361323346*^9}, {
   3.5338813382784786`*^9, 3.5338813663273277`*^9}, {3.5338815867333527`*^9, 
   3.53388159891597*^9}, {3.5338816780572996`*^9, 3.533881853354808*^9}, {
   3.533881894133279*^9, 3.5338820548759613`*^9}, {3.53388210515485*^9, 
   3.5338821573837414`*^9}, {3.5338824795243073`*^9, 3.533882480304309*^9}, {
   3.5338826190353527`*^9, 3.5338826220773573`*^9}, {3.533882797000465*^9, 
   3.5338828884946256`*^9}, 3.533882972625573*^9, {3.5338830165708504`*^9, 
   3.533883031609277*^9}, {3.533883077816558*^9, 3.5338830803125625`*^9}, {
   3.5338831964547663`*^9, 3.533883212085994*^9}, {3.5338832641276855`*^9, 
   3.533883270461296*^9}, {3.5338833237977905`*^9, 3.5338833905035076`*^9}, {
   3.5338834292071753`*^9, 3.5338834566632233`*^9}, {3.5338835023089037`*^9, 
   3.5338835056785097`*^9}, {3.5338835727118273`*^9, 
   3.5338835994502745`*^9}, {3.5338836545651712`*^9, 
   3.5338836686519957`*^9}, {3.533883732097307*^9, 3.533883735388913*^9}, {
   3.5338838282402763`*^9, 3.533883831469482*^9}, {3.5338838790807657`*^9, 
   3.5338839318556585`*^9}, {3.5338841950601697`*^9, 
   3.5338842006611776`*^9}, {3.533884289183502*^9, 3.533884385586038*^9}, {
   3.5338844540299344`*^9, 3.5338846658554325`*^9}, {3.533896646054044*^9, 
   3.5338967398621426`*^9}, {3.533896822025326*^9, 3.5338968359964437`*^9}, {
   3.53389691032167*^9, 3.5338969105856824`*^9}, {3.5338971233903627`*^9, 
   3.5338971363541813`*^9}, {3.533897219401898*^9, 3.5338972354505205`*^9}, {
   3.5338972707361703`*^9, 3.5338972749661765`*^9}, {3.5338978585023127`*^9, 
   3.533897865536066*^9}, {3.5338979217961693`*^9, 3.533898000278984*^9}, {
   3.5338980623234015`*^9, 3.533898066186492*^9}, {3.533898144347541*^9, 
   3.5338981535560675`*^9}, {3.533898233983821*^9, 3.5338982373649206`*^9}, {
   3.5339312966250153`*^9, 3.533931296985016*^9}, {3.5339314506542325`*^9, 
   3.5339314570856414`*^9}, {3.533931664934333*^9, 3.5339316768215537`*^9}, {
   3.5857213419283295`*^9, 3.58572134252113*^9}, {3.5857215487846923`*^9, 
   3.585721549174693*^9}, {3.585721605319192*^9, 3.5857216509180717`*^9}, {
   3.5857216896061397`*^9, 3.585721690448541*^9}, {3.58572175242745*^9, 
   3.5857217649074717`*^9}, {3.5857221603837667`*^9, 3.585722165188575*^9}, {
   3.5857222535315304`*^9, 3.5857222644515495`*^9}, {3.5857227752120466`*^9, 
   3.5857228235877314`*^9}, {3.585722986264817*^9, 3.5857230354673033`*^9}, {
   3.585723093686606*^9, 3.585723122203456*^9}, {3.585723169643139*^9, 
   3.585723171733543*^9}, {3.5857232526664853`*^9, 3.58572327258772*^9}, {
   3.606335159966839*^9, 3.606335198046506*^9}, {3.6063352330685673`*^9, 
   3.606335262131418*^9}, {3.6063353403967557`*^9, 3.6063353699744077`*^9}, {
   3.6063355019506392`*^9, 3.6063355100002537`*^9}, {3.6063358322344193`*^9, 
   3.6063358372576284`*^9}, {3.6066738883426533`*^9, 3.606673983512097*^9}, {
   3.6066740559482403`*^9, 3.6066740635486746`*^9}, {3.6066743363332767`*^9, 
   3.606674360126638*^9}, {3.6066746414127264`*^9, 3.6066746456029663`*^9}, {
   3.6066746864413023`*^9, 3.6066746935107064`*^9}, {3.606764163770528*^9, 
   3.6067641878257694`*^9}, {3.6067646447193723`*^9, 
   3.6067646954194613`*^9}, {3.6067650160780244`*^9, 
   3.6067650464980783`*^9}, {3.629562191862056*^9, 3.6295622179565096`*^9}, {
   3.6295624903759656`*^9, 3.6295625052137947`*^9}, {3.629562566755515*^9, 
   3.6295625671621156`*^9}, {3.629563111218094*^9, 3.6295631194739094`*^9}, {
   3.6295678441846895`*^9, 3.6295678567385135`*^9}, {3.6295769150568147`*^9, 
   3.629576939323668*^9}, 3.6295791738516903`*^9, 3.6295792209418187`*^9, {
   3.629581267714156*^9, 3.6295812912406006`*^9}, {3.629581325784066*^9, 
   3.629581340671893*^9}, {3.6295814029374175`*^9, 3.629581429304266*^9}, {
   3.6295818560362825`*^9, 3.629581856332683*^9}, {3.6295819110649934`*^9, 
   3.6295819150988007`*^9}, 3.62958195994705*^9, {3.6295827367218447`*^9, 
   3.6295827372990456`*^9}, {3.629582811380183*^9, 3.6295830005573826`*^9}, {
   3.6295922773693624`*^9, 3.6295923269242268`*^9}, {3.629592361069789*^9, 
   3.629592363895294*^9}, {3.6295923947624507`*^9, 3.6295924368449287`*^9}, {
   3.629592556257448*^9, 3.6295925866629047`*^9}, {3.6295926742687674`*^9, 
   3.6295926896873956`*^9}, {3.629592857642812*^9, 3.6295928635884237`*^9}, {
   3.6296008298157945`*^9, 3.629600857037795*^9}, {3.6296010760041723`*^9, 
   3.6296011709187737`*^9}, {3.6296012604938602`*^9, 
   3.6296013158603663`*^9}, {3.629601566485784*^9, 3.6296017289910207`*^9}, {
   3.629601965126772*^9, 3.629602009106655*^9}, {3.629602234491691*^9, 
   3.62960233417128*^9}, {3.6296025406568675`*^9, 3.629602545034876*^9}, {
   3.629602605592389*^9, 3.6296026720725155`*^9}, {3.629602819991993*^9, 
   3.629602824448001*^9}, {3.629605598839726*^9, 3.629605607327141*^9}, {
   3.6296058220871186`*^9, 3.62960582882633*^9}, {3.6296063832065477`*^9, 
   3.629606402387883*^9}, {3.629606538604329*^9, 3.6296066163905716`*^9}, {
   3.629606677993684*^9, 3.629606687579601*^9}, {3.6296068047490234`*^9, 
   3.629606830226368*^9}, 3.6296068624429245`*^9, {3.6296068979092875`*^9, 
   3.6296069681300106`*^9}, {3.629609076756136*^9, 3.6296091040088844`*^9}, {
   3.6296099141079187`*^9, 3.6296099316810493`*^9}, {3.6296100423732443`*^9, 
   3.629610095608038*^9}, {3.6296101382529125`*^9, 3.6296102324377785`*^9}, {
   3.629610465776189*^9, 3.6296105719830756`*^9}, {3.6296106080628395`*^9, 
   3.6296106195756593`*^9}, {3.629610656929625*^9, 3.629610732269657*^9}, {
   3.629610770130324*^9, 3.629610865268092*^9}, {3.629610900164753*^9, 
   3.6296109467227354`*^9}, {3.62961103488599*^9, 3.629611035478791*^9}, {
   3.62961131996777*^9, 3.629611351764426*^9}, {3.6296113965317063`*^9, 
   3.629611407320126*^9}, {3.629611650866873*^9, 3.629611658370486*^9}, {
   3.629611693028248*^9, 3.629611725211104*^9}, {3.629660344681587*^9, 
   3.629660396816783*^9}, {3.629662054116185*^9, 3.629662109498183*^9}, {
   3.629662485797946*^9, 3.629662506233982*^9}, {3.6296627377648115`*^9, 
   3.629662875565055*^9}, {3.629663059835583*^9, 3.6296630605400844`*^9}, {
   3.629663213456155*^9, 3.6296632447274103`*^9}, {3.62966339066107*^9, 
   3.629663505423672*^9}, {3.629663629963293*^9, 3.62966374139069*^9}, 
   3.6296637790073557`*^9, {3.6296639427647448`*^9, 3.62966405344954*^9}, {
   3.629664258753003*^9, 3.6296642835833473`*^9}, {3.629664357640478*^9, 
   3.629664406652266*^9}, {3.6296644497627425`*^9, 3.6296644754010878`*^9}, {
   3.6296645845515814`*^9, 3.629664754351282*^9}, {3.6296648207714*^9, 
   3.6296648719226904`*^9}, {3.6296649072767525`*^9, 3.629665007539429*^9}, {
   3.629665128176044*^9, 3.629665131155649*^9}, {3.629665198002467*^9, 
   3.629665208579286*^9}, {3.629665989873558*^9, 3.6296660606365824`*^9}, {
   3.629666240755704*^9, 3.629666248087716*^9}, {3.629680463417473*^9, 
   3.629680463611674*^9}, {3.6296839559917583`*^9, 3.629684004376444*^9}, {
   3.629684359598235*^9, 3.6296844225402164`*^9}, {3.629697473161625*^9, 
   3.6296975310175266`*^9}, {3.6296984575100627`*^9, 
   3.6296984799167023`*^9}, {3.629698536527603*^9, 3.6296985539120336`*^9}, {
   3.6297029070413284`*^9, 3.629702918063344*^9}, {3.629702984562439*^9, 
   3.629702988605445*^9}, {3.6297038644319816`*^9, 3.629703884097009*^9}, 
   3.6297039422184496`*^9, {3.629704987754769*^9, 3.6297050664593077`*^9}, {
   3.6297051249286375`*^9, 3.6297051564516935`*^9}, {3.6297051944125605`*^9, 
   3.6297052523000636`*^9}, {3.6297052825731173`*^9, 
   3.6297053031671534`*^9}, {3.629705388300189*^9, 3.62970538895539*^9}, {
   3.62972916921355*^9, 3.6297291763503666`*^9}, {3.6297292561692886`*^9, 
   3.629729263599902*^9}, {3.629761051728472*^9, 3.629761065720507*^9}, {
   3.629829049363864*^9, 3.629829080818822*^9}, {3.629832420822437*^9, 
   3.629832422351239*^9}, {3.629833134540451*^9, 3.629833156760482*^9}, {
   3.629841550046672*^9, 3.62984155467428*^9}, {3.6298419857146883`*^9, 
   3.6298419986509113`*^9}, {3.629842327687729*^9, 3.6298423483446655`*^9}, {
   3.6298424340556164`*^9, 3.6298424347651176`*^9}, {3.629857562453469*^9, 
   3.6298575752992034`*^9}, {3.6298617363544903`*^9, 3.629861743498315*^9}, {
   3.629861792832088*^9, 3.629861797965208*^9}, {3.6298621478116827`*^9, 
   3.6298621703399477`*^9}, {3.629862224692195*^9, 3.6298622386228337`*^9}, {
   3.629934024806528*^9, 3.6299340705926085`*^9}, {3.629935785029563*^9, 
   3.6299358234439325`*^9}, {3.630093833832834*^9, 3.630093925755106*^9}, {
   3.6303312112935457`*^9, 3.6303312550516224`*^9}, {3.6303358993921537`*^9, 
   3.6303359226755953`*^9}, {3.6306356399709835`*^9, 
   3.6306356458927946`*^9}, {3.630636068179586*^9, 3.6306361110125637`*^9}, {
   3.6306361560057445`*^9, 3.630636184065894*^9}, {3.630636235447586*^9, 
   3.630636267952746*^9}, {3.63063630275181*^9, 3.6306363664175234`*^9}, {
   3.6306364437215614`*^9, 3.6306365062241726`*^9}, {3.630636538221331*^9, 
   3.630636557862567*^9}, {3.630636607219159*^9, 3.6306366182246785`*^9}, {
   3.6306367049124327`*^9, 3.6306367069872365`*^9}, {3.6306367739863553`*^9, 
   3.6306368265585485`*^9}, {3.6306368669329214`*^9, 
   3.6306368850077534`*^9}, {3.6306369704707117`*^9, 
   3.6306369715340137`*^9}, {3.6306370050048733`*^9, 3.6306370121403866`*^9}, 
   3.6306370476386495`*^9, {3.6306371345330048`*^9, 3.6306371389166126`*^9}, {
   3.6306372376894894`*^9, 3.6306372761020594`*^9}, {3.6306374107348022`*^9, 
   3.6306374177860146`*^9}, {3.6306374703665094`*^9, 
   3.6306376025850487`*^9}, {3.6306376480269303`*^9, 
   3.6306376569389467`*^9}, {3.630637688572405*^9, 3.6306377047228336`*^9}, {
   3.630638005103675*^9, 3.63063803012432*^9}, {3.630638132477803*^9, 
   3.6306381742124786`*^9}, {3.630638443344762*^9, 3.6306384548725824`*^9}, {
   3.630693969338559*^9, 3.6306940821519747`*^9}, {3.630694494199352*^9, 
   3.6306945206800165`*^9}, {3.63069542859525*^9, 3.6306954292512627`*^9}, {
   3.630695677045081*^9, 3.6306957023971386`*^9}, {3.63069573859525*^9, 
   3.6306958461515474`*^9}, {3.6306960563359995`*^9, 3.630696315629788*^9}, {
   3.630696895134617*^9, 3.6306969769772644`*^9}, {3.6306970092793493`*^9, 
   3.630697023245936*^9}, {3.6306970610093985`*^9, 3.6306971134507113`*^9}, {
   3.63069721480139*^9, 3.6306972323263006`*^9}, {3.671909193986844*^9, 
   3.6719092506401615`*^9}, {3.831438981749403*^9, 3.8314389863695817`*^9}, {
   3.838192702526781*^9, 3.838192713373404*^9}, {3.8484516378413415`*^9, 
   3.8484516417909007`*^9}, {3.848451690072141*^9, 3.84845169096559*^9}, {
   3.8955547737883625`*^9, 3.8955547737953587`*^9}, {3.967777451644392*^9, 
   3.9677774516549563`*^9}, 3.97108232010742*^9, {3.971385949477669*^9, 
   3.9713859496949177`*^9}, 3.9732195791662903`*^9, 3.973219806265747*^9, 
   3.973219965831306*^9, {3.97530902427593*^9, 
   3.975309050176642*^9}},ExpressionUUID->"338b0823-3ca3-4ff0-ae40-\
9910b605f2d3"]
}, Closed]],

Cell[CellGroupData[{

Cell["Einstein summation", "Subsubsection",
 CellChangeTimes->{
  3.8611418822063417`*^9},ExpressionUUID->"8fd9aec0-45a5-4318-82ee-\
88053c8585f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Einstein", " ", 
     RowBox[{"summation", ":", " ", 
      RowBox[{
      "Repeated", " ", "indices", " ", "are", " ", "summed", " ", "over"}]}]}],
    FontColor->RGBColor[0.5, 0, 0.5]], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
     RowBox[{"xxx___", ",", "\[IndentingNewLine]", 
      RowBox[{"Coordinates", "\[Rule]", "cooo_List"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"StartIndex", "\[Rule]", "si_Integer"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Indices", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "i1___", ",", "\[Mu]1T_", ",", "i2___", ",", "\[Mu]2T_", ",", 
         "i3___"}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"TensorComponents", "\[Rule]", "matrix_"}]}], 
     "\[IndentingNewLine]", "]"}], ":=", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mtx", ",", 
         RowBox[{"i1WOUnderBar", "=", 
          RowBox[{"RemoveUnderBarredIndices", "[", 
           RowBox[{"{", "i1", "}"}], "]"}]}], ",", 
         RowBox[{"i2WOUnderBar", "=", 
          RowBox[{"RemoveUnderBarredIndices", "[", 
           RowBox[{"{", "i2", "}"}], "]"}]}], ",", 
         RowBox[{"i3WOUnderBar", "=", 
          RowBox[{"RemoveUnderBarredIndices", "[", 
           RowBox[{"{", "i3", "}"}], "]"}]}], ",", "l1", ",", "l2", ",", "l3",
          ",", "ilist", ",", "ilistNoPos", ",", "matrixDimensions", ",", 
         "isequencelist1", ",", "isequencelist2", ",", "isequencelist3", ",", 
         "ContractIndicesRange", ",", "Joinisequencelist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Remember", " ", "to", " ", "remove", " ", "underbarred", " ", 
         "indices", " ", "because", " ", "they", " ", "are", " ", "no", " ", 
         "longer", " ", "part", " ", "of", " ", "the", " ", "active", " ", 
         "index", " ", "structue"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"matrixDimensions", "=", 
         RowBox[{"Dimensions", "[", "matrix", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ilist", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"i1WOUnderBar", ",", 
           RowBox[{"{", "\[Mu]1T", "}"}], ",", "i2WOUnderBar", ",", 
           RowBox[{"{", "\[Mu]2T", "}"}], ",", "i3WOUnderBar"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"ilistNoPos", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "&"}],
           "/@", "ilist"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"l1", "=", 
         RowBox[{
          RowBox[{"Dimensions", "[", 
           RowBox[{"RemoveUnderBarredIndices", "[", 
            RowBox[{"{", "i1", "}"}], "]"}], "]"}], "\[LeftDoubleBracket]", 
          "1", "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"l2", "=", 
         RowBox[{
          RowBox[{"Dimensions", "[", 
           RowBox[{"RemoveUnderBarredIndices", "[", 
            RowBox[{"{", "i2", "}"}], "]"}], "]"}], "\[LeftDoubleBracket]", 
          "1", "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"l3", "=", 
         RowBox[{
          RowBox[{"Dimensions", "[", 
           RowBox[{"RemoveUnderBarredIndices", "[", 
            RowBox[{"{", "i3", "}"}], "]"}], "]"}], "\[LeftDoubleBracket]", 
          "1", "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"isequencelist1", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",",
              "1", ",", 
             RowBox[{"matrixDimensions", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{"i1WOUnderBar", ",", "#"}], "]"}], 
               "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], 
              "\[RightDoubleBracket]"}]}], "}"}], "&"}], "/@", 
          "i1WOUnderBar"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"isequencelist2", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",",
              "1", ",", 
             RowBox[{"matrixDimensions", "\[LeftDoubleBracket]", 
              RowBox[{"l1", "+", "1", "+", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"i2WOUnderBar", ",", "#"}], "]"}], 
                "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
              "\[RightDoubleBracket]"}]}], "}"}], "&"}], "/@", 
          "i2WOUnderBar"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"isequencelist3", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",",
              "1", ",", 
             RowBox[{"matrixDimensions", "\[LeftDoubleBracket]", 
              RowBox[{"l1", "+", "1", "+", "l2", "+", "1", "+", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"i3WOUnderBar", ",", "#"}], "]"}], 
                "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
              "\[RightDoubleBracket]"}]}], "}"}], "&"}], "/@", 
          "i3WOUnderBar"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ContractIndicesRange", "=", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "\[Mu]1T", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
             ",", "1", ",", 
            RowBox[{"matrixDimensions", "\[LeftDoubleBracket]", 
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"ilist", ",", "\[Mu]1T"}], "]"}], 
              "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], 
             "\[RightDoubleBracket]"}]}], "}"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Joinisequencelist", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
          "isequencelist1", ",", "isequencelist2", ",", "isequencelist3"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mtx", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"matrix", "\[LeftDoubleBracket]", 
              RowBox[{"Sequence", "@@", "ilistNoPos"}], 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"Sequence", "@@", "ContractIndicesRange"}], "]"}]}], 
            "]"}], ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"Sequence", "@@", "Joinisequencelist"}], "]"}]}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"return", " ", "the", " ", "Tensor", " ", 
          RowBox[{"w", "/", " ", "everything"}], " ", "the", " ", "same", " ",
           "except", " ", "the", " ", "TensorComponents", " ", "and", " ", 
          "the", " ", "indics", " ", "\[Mu]1T", " ", "and", " ", "\[Mu]2T"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{"xxx", ",", "\[IndentingNewLine]", 
          RowBox[{"Coordinates", "\[Rule]", "cooo"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"i1", ",", 
             RowBox[{"UnderBar", "/@", "\[Mu]1T"}], ",", "i2", ",", 
             RowBox[{"UnderBar", "/@", "\[Mu]2T"}], ",", "i3"}], "}"}]}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", "mtx"}]}], "]"}]}]}], "]"}], 
     "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"(*", " ", 
         RowBox[{"check", " ", "repeated", " ", "indices"}], " ", "*)"}], 
        RowBox[{
         RowBox[{
         "\[Mu]1T", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "===", 
         RowBox[{
         "\[Mu]2T", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{"(*", " ", 
         RowBox[{
         "check", " ", "one", " ", "index", " ", "up", " ", "and", " ", "one",
           " ", "down"}], " ", "*)"}], 
        RowBox[{
         RowBox[{
          RowBox[{"Sgn", "[", "\[Mu]1T", "]"}], 
          RowBox[{"Sgn", "[", "\[Mu]2T", "]"}]}], "===", 
         RowBox[{"-", "1"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{"(*", " ", 
         RowBox[{
         "check", " ", "that", " ", "both", " ", "indices", " ", "are", " ", 
          "abstract"}], " ", "*)"}], 
        RowBox[{"!", 
         RowBox[{"NotAbstractIndex", "[", 
          RowBox[{"\[Mu]1T", ",", "cooo", ",", "si"}], "]"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{"(*", " ", 
         RowBox[{
         "check", " ", "that", " ", "both", " ", "indices", " ", "are", " ", 
          "abstract"}], " ", "*)"}], 
        RowBox[{"!", 
         RowBox[{"NotAbstractIndex", "[", 
          RowBox[{"\[Mu]2T", ",", "cooo", ",", "si"}], "]"}]}], ")"}], "&&", 
       RowBox[{"TestIndices", "[", "\[Mu]1T", "]"}], "&&", 
       RowBox[{"TestIndices", "[", "\[Mu]2T", "]"}]}], ")"}]}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.518287025359375*^9, 3.518287083796875*^9}, {
   3.518287204515625*^9, 3.518287246046875*^9}, {3.518288154015625*^9, 
   3.518288179625*^9}, {3.5196834121875*^9, 3.519683417953125*^9}, {
   3.519689356625*^9, 3.519689356921875*^9}, {3.51976580715625*^9, 
   3.519765810671875*^9}, {3.519963432453125*^9, 3.519963433953125*^9}, 
   3.520125837828125*^9, {3.5201289498125*^9, 3.5201289504375*^9}, 
   3.520219859578125*^9, 3.5202268538125*^9, {3.52027377246875*^9, 
   3.520273831296875*^9}, {3.5202738760625*^9, 3.52027388446875*^9}, {
   3.5202739371875*^9, 3.5202741019375*^9}, {3.52027416353125*^9, 
   3.520274167671875*^9}, 3.520274919453125*^9, {3.52027495775*^9, 
   3.52027500990625*^9}, {3.520275109328125*^9, 3.52027513640625*^9}, {
   3.520275352625*^9, 3.520275353015625*^9}, {3.52027552415625*^9, 
   3.5202755711875*^9}, 3.520275790296875*^9, {3.5202759311875*^9, 
   3.520275948625*^9}, {3.520276746125*^9, 3.5202767880625*^9}, {
   3.52027692378125*^9, 3.52027700428125*^9}, {3.520277061046875*^9, 
   3.520277097125*^9}, {3.520277138046875*^9, 3.520277203125*^9}, {
   3.52027851596875*^9, 3.520278524*^9}, {3.52027856384375*^9, 
   3.520278653328125*^9}, 3.5202787563125*^9, {3.520279456296875*^9, 
   3.5202794635625*^9}, {3.520279561640625*^9, 3.520279567359375*^9}, {
   3.52028006315625*^9, 3.520280068671875*^9}, {3.5202804206875*^9, 
   3.520280495234375*^9}, 3.520281272765625*^9, {3.52028149878125*^9, 
   3.5202815018125*^9}, {3.520281674421875*^9, 3.5202816786875*^9}, {
   3.520281727390625*^9, 3.520281730375*^9}, 3.52028190265625*^9, {
   3.52028213190625*^9, 3.520282169640625*^9}, {3.520282364859375*^9, 
   3.520282395859375*^9}, {3.520282483109375*^9, 3.520282499046875*^9}, {
   3.52028567246875*^9, 3.520285695984375*^9}, {3.5202857606875*^9, 
   3.520285762578125*^9}, {3.520285792890625*^9, 3.520285807109375*^9}, {
   3.5202858616875*^9, 3.52028586721875*^9}, {3.520286964859375*^9, 
   3.520286985015625*^9}, {3.52028713909375*^9, 3.520287168453125*^9}, {
   3.52030002590625*^9, 3.520300043171875*^9}, {3.520300760625*^9, 
   3.520300806765625*^9}, {3.52030106778125*^9, 3.520301101625*^9}, {
   3.520301143203125*^9, 3.520301143921875*^9}, {3.520301203140625*^9, 
   3.520301219734375*^9}, {3.520301382671875*^9, 3.520301408375*^9}, {
   3.5203015531875*^9, 3.520301561859375*^9}, {3.52030160309375*^9, 
   3.52030162021875*^9}, {3.520301674546875*^9, 3.520301675078125*^9}, 
   3.520301885265625*^9, {3.52030235646875*^9, 3.5203024485*^9}, {
   3.52030252584375*^9, 3.520302587984375*^9}, {3.520302792015625*^9, 
   3.520302959515625*^9}, {3.520303101875*^9, 3.520303107296875*^9}, {
   3.520303238609375*^9, 3.52030324271875*^9}, {3.520303299859375*^9, 
   3.520303323609375*^9}, 3.5203034191875*^9, {3.5203509418125*^9, 
   3.520350955265625*^9}, {3.520374181640625*^9, 3.52037419353125*^9}, {
   3.52037428890625*^9, 3.52037429225*^9}, {3.520374390359375*^9, 
   3.520374391046875*^9}, {3.52037449153125*^9, 3.520374508859375*^9}, {
   3.520374542359375*^9, 3.520374562515625*^9}, {3.520374665328125*^9, 
   3.520374666125*^9}, {3.520374798734375*^9, 3.5203748170625*^9}, {
   3.520442091734375*^9, 3.520442103078125*^9}, {3.520442156859375*^9, 
   3.520442237609375*^9}, {3.520442932203125*^9, 3.520442946328125*^9}, 
   3.5204430529375*^9, {3.520449654171875*^9, 3.520449741703125*^9}, {
   3.520461701390625*^9, 3.52046171115625*^9}, {3.520461829296875*^9, 
   3.5204618643125*^9}, {3.52046189925*^9, 3.5204619086875*^9}, {
   3.520462190671875*^9, 3.520462199265625*^9}, {3.520462248390625*^9, 
   3.520462255953125*^9}, {3.52046263196875*^9, 3.520462676203125*^9}, {
   3.520462781609375*^9, 3.520462783296875*^9}, {3.52046295721875*^9, 
   3.52046300696875*^9}, {3.520463069578125*^9, 3.520463097359375*^9}, {
   3.52046330721875*^9, 3.520463328234375*^9}, {3.520463500234375*^9, 
   3.520463506578125*^9}, {3.5204635759375*^9, 3.52046357878125*^9}, {
   3.520463627625*^9, 3.520463634921875*^9}, {3.52046371734375*^9, 
   3.520463719828125*^9}, {3.520463799875*^9, 3.52046387153125*^9}, {
   3.5204646916875*^9, 3.520464736625*^9}, {3.52069951259375*^9, 
   3.520699699609375*^9}, {3.520699992109375*^9, 3.52069999440625*^9}, {
   3.520811957234375*^9, 3.520812132578125*^9}, {3.52081218434375*^9, 
   3.520812365828125*^9}, {3.520812564921875*^9, 3.520812569625*^9}, {
   3.5208126603125*^9, 3.520812664359375*^9}, {3.5208127515*^9, 
   3.52081275875*^9}, {3.520812849*^9, 3.520812859109375*^9}, {
   3.520812903453125*^9, 3.5208130645*^9}, {3.520813114734375*^9, 
   3.520813119109375*^9}, {3.52081316215625*^9, 3.52081316665625*^9}, {
   3.5208133298125*^9, 3.520813333390625*^9}, {3.5208135518125*^9, 
   3.520813616953125*^9}, {3.520814478625*^9, 3.520814517421875*^9}, {
   3.520814555859375*^9, 3.520814613671875*^9}, {3.5208146563125*^9, 
   3.520814722828125*^9}, {3.52081482359375*^9, 3.520814830421875*^9}, {
   3.52087296378125*^9, 3.520873035734375*^9}, {3.52087306871875*^9, 
   3.520873075875*^9}, {3.520873179546875*^9, 3.5208732265625*^9}, {
   3.52087327746875*^9, 3.520873296546875*^9}, {3.52087335853125*^9, 
   3.520873361484375*^9}, {3.520873428328125*^9, 3.520873439921875*^9}, {
   3.520873528796875*^9, 3.520873596453125*^9}, {3.520874029125*^9, 
   3.520874058125*^9}, {3.52087876996875*^9, 3.520878774265625*^9}, {
   3.520879095359375*^9, 3.520879096078125*^9}, {3.520881848546875*^9, 
   3.520882124296875*^9}, {3.5208821583125*^9, 3.5208822268125*^9}, {
   3.520882285359375*^9, 3.520882299640625*^9}, {3.52088233096875*^9, 
   3.520882332296875*^9}, {3.52088237009375*^9, 3.5208825624375*^9}, {
   3.520882741546875*^9, 3.5208828856875*^9}, {3.520884240671875*^9, 
   3.520884241375*^9}, {3.520885397109375*^9, 3.520885515015625*^9}, {
   3.52088556446875*^9, 3.5208858435625*^9}, {3.520885898484375*^9, 
   3.520885974234375*^9}, {3.520898025796875*^9, 3.520898078625*^9}, {
   3.520898132015625*^9, 3.520898159171875*^9}, {3.520898268171875*^9, 
   3.520898439453125*^9}, {3.520898471875*^9, 3.52089847509375*^9}, {
   3.5208987905625*^9, 3.520898791046875*^9}, 3.520957046015625*^9, {
   3.5209570961875*^9, 3.520957131078125*^9}, {3.52107807721875*^9, 
   3.521078188765625*^9}, {3.5210782819375*^9, 3.521078383796875*^9}, {
   3.521137026140625*^9, 3.521137068953125*^9}, {3.521142246921875*^9, 
   3.52114265653125*^9}, {3.52114442525*^9, 3.521144472171875*^9}, {
   3.521144505640625*^9, 3.52114451575*^9}, {3.52114454646875*^9, 
   3.5211445929375*^9}, {3.52121984296875*^9, 3.5212198994375*^9}, {
   3.521220739*^9, 3.52122090625*^9}, {3.521221086375*^9, 
   3.5212210973125*^9}, {3.521221169703125*^9, 3.521221170109375*^9}, {
   3.521241296640625*^9, 3.52124132271875*^9}, {3.521241364609375*^9, 
   3.521241377921875*^9}, {3.521241761265625*^9, 3.521241789875*^9}, {
   3.52125020228125*^9, 3.5212503195*^9}, {3.521250367578125*^9, 
   3.52125043315625*^9}, {3.521348381171875*^9, 3.521348591296875*^9}, {
   3.5213486974375*^9, 3.52134881896875*^9}, {3.52134888690625*^9, 
   3.521348973890625*^9}, 3.5213493814375*^9, 3.521349424265625*^9, {
   3.521349591765625*^9, 3.52134976540625*^9}, {3.521349909984375*^9, 
   3.52134995234375*^9}, {3.5213501821875*^9, 3.521350185953125*^9}, {
   3.5213504943125*^9, 3.521350511640625*^9}, {3.5213506120625*^9, 
   3.521350633390625*^9}, {3.52135068425*^9, 3.521350712765625*^9}, {
   3.521351003671875*^9, 3.521351010375*^9}, {3.52135113328125*^9, 
   3.52135113853125*^9}, {3.521351225125*^9, 3.521351264515625*^9}, {
   3.521353769546875*^9, 3.52135380609375*^9}, {3.52135391003125*^9, 
   3.5213539324375*^9}, {3.52138689021875*^9, 3.521386896859375*^9}, {
   3.5213915893125*^9, 3.52139181034375*^9}, {3.52139186425*^9, 
   3.521391942109375*^9}, {3.521391976125*^9, 3.521391991109375*^9}, {
   3.521392049890625*^9, 3.52139216490625*^9}, {3.52139221046875*^9, 
   3.521392215734375*^9}, {3.52139226215625*^9, 3.5213922816875*^9}, {
   3.5213923241875*^9, 3.52139238159375*^9}, {3.521392606671875*^9, 
   3.5213926106875*^9}, {3.521392646546875*^9, 3.521392830515625*^9}, {
   3.521392927671875*^9, 3.521392945734375*^9}, {3.521393239734375*^9, 
   3.521393253125*^9}, {3.52139330940625*^9, 3.52139332665625*^9}, {
   3.52139486253125*^9, 3.52139486378125*^9}, {3.521395281328125*^9, 
   3.521395287609375*^9}, {3.52139612678125*^9, 3.521396148546875*^9}, {
   3.521396433484375*^9, 3.52139647615625*^9}, {3.521396513796875*^9, 
   3.521396530703125*^9}, {3.521396718125*^9, 3.521396718453125*^9}, {
   3.521398676140625*^9, 3.52139875478125*^9}, {3.52139878946875*^9, 
   3.52139882240625*^9}, {3.521399017640625*^9, 3.521399148484375*^9}, {
   3.521399182484375*^9, 3.521399183546875*^9}, {3.521399244109375*^9, 
   3.5213993385*^9}, {3.5213995170625*^9, 3.521399783703125*^9}, {
   3.52139984184375*^9, 3.521399940109375*^9}, {3.521400227171875*^9, 
   3.521400233828125*^9}, {3.521400279890625*^9, 3.5214002875625*^9}, {
   3.521400370515625*^9, 3.521400373984375*^9}, {3.521400410140625*^9, 
   3.521400412890625*^9}, {3.521401423609375*^9, 3.52140142775*^9}, {
   3.5214015165625*^9, 3.52140151815625*^9}, {3.521401780921875*^9, 
   3.521401883765625*^9}, {3.52140193640625*^9, 3.521401969265625*^9}, {
   3.52140201503125*^9, 3.52140202003125*^9}, {3.521402455625*^9, 
   3.5214025640625*^9}, {3.52140260134375*^9, 3.52140261928125*^9}, {
   3.521402734453125*^9, 3.521402863140625*^9}, {3.52141532615625*^9, 
   3.5214153873125*^9}, {3.5214156420625*^9, 3.52141570696875*^9}, {
   3.521442583140625*^9, 3.521442620640625*^9}, {3.521442651796875*^9, 
   3.521442666296875*^9}, {3.5214427025*^9, 3.521442792484375*^9}, {
   3.52144286128125*^9, 3.52144296165625*^9}, {3.521443004765625*^9, 
   3.5214430215625*^9}, {3.52144312996875*^9, 3.521443237265625*^9}, {
   3.521443272421875*^9, 3.52144328728125*^9}, {3.521471452890625*^9, 
   3.521471462828125*^9}, {3.521472116640625*^9, 3.52147218709375*^9}, {
   3.521472280796875*^9, 3.52147230184375*^9}, {3.521472418421875*^9, 
   3.521472429140625*^9}, {3.521472511109375*^9, 3.521472519234375*^9}, {
   3.521472551109375*^9, 3.521472579375*^9}, {3.52164943446875*^9, 
   3.521649441140625*^9}, {3.52164978603125*^9, 3.521649794796875*^9}, {
   3.521653219375*^9, 3.521653224921875*^9}, {3.52165329765625*^9, 
   3.5216533165625*^9}, {3.52165483128125*^9, 3.521654835875*^9}, {
   3.5216555458125*^9, 3.5216555685*^9}, {3.52166988665625*^9, 
   3.52166989046875*^9}, {3.521670768421875*^9, 3.52167081534375*^9}, {
   3.521670849203125*^9, 3.521670860421875*^9}, {3.521670891625*^9, 
   3.5216709856875*^9}, {3.521671147125*^9, 3.52167118725*^9}, {
   3.5216712428125*^9, 3.521671386015625*^9}, {3.52167158846875*^9, 
   3.5216716393125*^9}, {3.52167168784375*^9, 3.52167170453125*^9}, {
   3.521671767953125*^9, 3.521671800890625*^9}, {3.52167184703125*^9, 
   3.52167188040625*^9}, {3.5216719656875*^9, 3.5216720203125*^9}, {
   3.521672086421875*^9, 3.521672149015625*^9}, {3.521672195671875*^9, 
   3.5216722440625*^9}, {3.521672320125*^9, 3.52167243040625*^9}, {
   3.521672468421875*^9, 3.521672645609375*^9}, 3.521672796265625*^9, {
   3.5216729164375*^9, 3.52167311040625*^9}, {3.521673143375*^9, 
   3.52167317259375*^9}, {3.521673209484375*^9, 3.521673232453125*^9}, {
   3.521673284078125*^9, 3.52167331528125*^9}, {3.52167336734375*^9, 
   3.521673388625*^9}, {3.5216751101875*^9, 3.52167523325*^9}, {
   3.5216758554375*^9, 3.52167588446875*^9}, {3.521676011109375*^9, 
   3.521676031296875*^9}, {3.521676083265625*^9, 3.52167608490625*^9}, {
   3.52167614078125*^9, 3.521676144140625*^9}, {3.521676218859375*^9, 
   3.521676219984375*^9}, {3.521676257140625*^9, 3.521676342625*^9}, {
   3.521676404546875*^9, 3.52167643903125*^9}, {3.52167657284375*^9, 
   3.521676714046875*^9}, {3.521676750734375*^9, 3.521676871203125*^9}, {
   3.521677046671875*^9, 3.521677063546875*^9}, {3.5216771815625*^9, 
   3.52167723953125*^9}, {3.52167732425*^9, 3.52167734403125*^9}, {
   3.521677383*^9, 3.521677383875*^9}, {3.521677432109375*^9, 
   3.521677540125*^9}, {3.52167758334375*^9, 3.521677617234375*^9}, {
   3.521677668*^9, 3.521677671203125*^9}, {3.52167772715625*^9, 
   3.521677757234375*^9}, {3.521677788*^9, 3.52167782253125*^9}, {
   3.521677906875*^9, 3.521677914546875*^9}, {3.521677984171875*^9, 
   3.5216780049375*^9}, {3.521678053546875*^9, 3.521678053734375*^9}, {
   3.5216998578125*^9, 3.52169988396875*^9}, {3.521699914484375*^9, 
   3.521699973359375*^9}, {3.521700012703125*^9, 3.52170021290625*^9}, {
   3.521700272359375*^9, 3.521700381625*^9}, {3.52170041990625*^9, 
   3.52170087975*^9}, {3.52170095365625*^9, 3.5217009635*^9}, {
   3.52170103315625*^9, 3.52170115653125*^9}, {3.521701254953125*^9, 
   3.521701351890625*^9}, {3.5217013993125*^9, 3.521701438234375*^9}, {
   3.521701516515625*^9, 3.52170153925*^9}, {3.521701892234375*^9, 
   3.52170189378125*^9}, {3.521702314984375*^9, 3.521702329390625*^9}, {
   3.52173341071875*^9, 3.521733630953125*^9}, {3.52173367478125*^9, 
   3.52173375459375*^9}, {3.521733804375*^9, 3.521733833953125*^9}, {
   3.521741591*^9, 3.52174163671875*^9}, {3.521741705890625*^9, 
   3.521741768546875*^9}, {3.52174187984375*^9, 3.52174188003125*^9}, {
   3.521742036875*^9, 3.52174203709375*^9}, {3.521745152640625*^9, 
   3.521745164734375*^9}, {3.521745200890625*^9, 3.521745255765625*^9}, {
   3.521745324890625*^9, 3.52174536284375*^9}, {3.521745446203125*^9, 
   3.52174547321875*^9}, {3.521745506265625*^9, 3.521745513234375*^9}, {
   3.52174554921875*^9, 3.52174556996875*^9}, {3.5217456041875*^9, 
   3.521745606546875*^9}, {3.521745796859375*^9, 3.521745798109375*^9}, {
   3.521746119421875*^9, 3.521746202171875*^9}, {3.521746247578125*^9, 
   3.5217462608125*^9}, {3.521746322625*^9, 3.521746349625*^9}, {
   3.52175678640625*^9, 3.521756816921875*^9}, {3.521757001703125*^9, 
   3.521757017046875*^9}, {3.5217610119375*^9, 3.52176102221875*^9}, {
   3.5217647861875*^9, 3.521764807984375*^9}, {3.521764873484375*^9, 
   3.521764892078125*^9}, {3.52176496665625*^9, 3.521764992953125*^9}, {
   3.521765145359375*^9, 3.52176515403125*^9}, {3.52176547803125*^9, 
   3.521765486640625*^9}, {3.521784419484375*^9, 3.52178441959375*^9}, {
   3.521784735171875*^9, 3.521784739125*^9}, {3.521784803*^9, 
   3.521784832328125*^9}, {3.5217852330625*^9, 3.521785233265625*^9}, {
   3.521788073828125*^9, 3.521788104875*^9}, {3.52179265278125*^9, 
   3.521792721640625*^9}, {3.521792757875*^9, 3.521792783609375*^9}, {
   3.52179304334375*^9, 3.521793217125*^9}, {3.521793247703125*^9, 
   3.52179326671875*^9}, {3.521867759015625*^9, 3.521867794828125*^9}, {
   3.521903765703125*^9, 3.52190378259375*^9}, {3.521910287625*^9, 
   3.5219103075625*^9}, {3.52191037603125*^9, 3.521910410796875*^9}, {
   3.52191902275*^9, 3.521919058921875*^9}, {3.52191974478125*^9, 
   3.5219197580625*^9}, {3.5219389993125*^9, 3.521939153*^9}, {
   3.52194930271875*^9, 3.52194932571875*^9}, {3.52194942278125*^9, 
   3.5219494263125*^9}, {3.521950287453125*^9, 3.52195029703125*^9}, {
   3.521953722984375*^9, 3.52195380025*^9}, {3.52195433934375*^9, 
   3.521954407375*^9}, {3.5219544496875*^9, 3.52195451690625*^9}, {
   3.5219546679375*^9, 3.52195468209375*^9}, {3.5219548593125*^9, 
   3.521954863546875*^9}, {3.52195602975*^9, 3.521956063796875*^9}, {
   3.52195629140625*^9, 3.521956357828125*^9}, {3.521956396453125*^9, 
   3.5219564374375*^9}, {3.5338712661975746`*^9, 3.533871361323346*^9}, {
   3.5338813382784786`*^9, 3.5338813663273277`*^9}, {3.5338815867333527`*^9, 
   3.53388159891597*^9}, {3.5338816780572996`*^9, 3.533881853354808*^9}, {
   3.533881894133279*^9, 3.5338820548759613`*^9}, {3.53388210515485*^9, 
   3.5338821573837414`*^9}, {3.5338824795243073`*^9, 3.533882480304309*^9}, {
   3.5338826190353527`*^9, 3.5338826220773573`*^9}, {3.533882797000465*^9, 
   3.5338828884946256`*^9}, 3.533882972625573*^9, {3.5338830165708504`*^9, 
   3.533883031609277*^9}, {3.533883077816558*^9, 3.5338830803125625`*^9}, {
   3.5338831964547663`*^9, 3.533883212085994*^9}, {3.5338832641276855`*^9, 
   3.533883270461296*^9}, {3.5338833237977905`*^9, 3.5338833905035076`*^9}, {
   3.5338834292071753`*^9, 3.5338834566632233`*^9}, {3.5338835023089037`*^9, 
   3.5338835056785097`*^9}, {3.5338835727118273`*^9, 
   3.5338835994502745`*^9}, {3.5338836545651712`*^9, 
   3.5338836686519957`*^9}, {3.533883732097307*^9, 3.533883735388913*^9}, {
   3.5338838282402763`*^9, 3.533883831469482*^9}, {3.5338838790807657`*^9, 
   3.5338839318556585`*^9}, {3.5338841950601697`*^9, 
   3.5338842006611776`*^9}, {3.533884289183502*^9, 3.533884385586038*^9}, {
   3.5338844540299344`*^9, 3.5338846658554325`*^9}, {3.533896646054044*^9, 
   3.5338967398621426`*^9}, {3.533896822025326*^9, 3.5338968359964437`*^9}, {
   3.53389691032167*^9, 3.5338969105856824`*^9}, {3.5338971233903627`*^9, 
   3.5338971363541813`*^9}, {3.533897219401898*^9, 3.5338972354505205`*^9}, {
   3.5338972707361703`*^9, 3.5338972749661765`*^9}, {3.5338978585023127`*^9, 
   3.533897865536066*^9}, {3.5338979217961693`*^9, 3.533898000278984*^9}, {
   3.5338980623234015`*^9, 3.533898066186492*^9}, {3.533898144347541*^9, 
   3.5338981535560675`*^9}, {3.533898233983821*^9, 3.5338982373649206`*^9}, {
   3.5339312966250153`*^9, 3.533931296985016*^9}, {3.5339314506542325`*^9, 
   3.5339314570856414`*^9}, {3.533931664934333*^9, 3.5339316768215537`*^9}, {
   3.5857213419283295`*^9, 3.58572134252113*^9}, {3.5857215487846923`*^9, 
   3.585721549174693*^9}, {3.585721605319192*^9, 3.5857216509180717`*^9}, {
   3.5857216896061397`*^9, 3.585721690448541*^9}, {3.58572175242745*^9, 
   3.5857217649074717`*^9}, {3.5857221603837667`*^9, 3.585722165188575*^9}, {
   3.5857222535315304`*^9, 3.5857222644515495`*^9}, {3.5857227752120466`*^9, 
   3.5857228235877314`*^9}, {3.585722986264817*^9, 3.5857230354673033`*^9}, {
   3.585723093686606*^9, 3.585723122203456*^9}, {3.585723169643139*^9, 
   3.585723171733543*^9}, {3.5857232526664853`*^9, 3.58572327258772*^9}, {
   3.606335159966839*^9, 3.606335198046506*^9}, {3.6063352330685673`*^9, 
   3.606335262131418*^9}, {3.6063353403967557`*^9, 3.6063353699744077`*^9}, {
   3.6063355019506392`*^9, 3.6063355100002537`*^9}, {3.6063358322344193`*^9, 
   3.6063358372576284`*^9}, {3.6066738883426533`*^9, 3.606673983512097*^9}, {
   3.6066740559482403`*^9, 3.6066740635486746`*^9}, {3.6066743363332767`*^9, 
   3.606674360126638*^9}, {3.6066746414127264`*^9, 3.6066746456029663`*^9}, {
   3.6066746864413023`*^9, 3.6066746935107064`*^9}, {3.606764163770528*^9, 
   3.6067641878257694`*^9}, {3.6067646447193723`*^9, 
   3.6067646954194613`*^9}, {3.6067650160780244`*^9, 
   3.6067650464980783`*^9}, {3.629562191862056*^9, 3.6295622179565096`*^9}, {
   3.6295624903759656`*^9, 3.6295625052137947`*^9}, {3.629562566755515*^9, 
   3.6295625671621156`*^9}, {3.629563111218094*^9, 3.6295631194739094`*^9}, {
   3.6295678441846895`*^9, 3.6295678567385135`*^9}, {3.6295769150568147`*^9, 
   3.629576939323668*^9}, 3.6295791738516903`*^9, 3.6295792209418187`*^9, {
   3.629581267714156*^9, 3.6295812912406006`*^9}, {3.629581325784066*^9, 
   3.629581340671893*^9}, {3.6295814029374175`*^9, 3.629581429304266*^9}, {
   3.6295818560362825`*^9, 3.629581856332683*^9}, {3.6295819110649934`*^9, 
   3.6295819150988007`*^9}, 3.62958195994705*^9, {3.6295827367218447`*^9, 
   3.6295827372990456`*^9}, {3.629582811380183*^9, 3.6295830005573826`*^9}, {
   3.6295922773693624`*^9, 3.6295923269242268`*^9}, {3.629592361069789*^9, 
   3.629592363895294*^9}, {3.6295923947624507`*^9, 3.6295924368449287`*^9}, {
   3.629592556257448*^9, 3.6295925866629047`*^9}, {3.6295926742687674`*^9, 
   3.6295926896873956`*^9}, {3.629592857642812*^9, 3.6295928635884237`*^9}, {
   3.6296008298157945`*^9, 3.629600857037795*^9}, {3.6296010760041723`*^9, 
   3.6296011709187737`*^9}, {3.6296012604938602`*^9, 
   3.6296013158603663`*^9}, {3.629601566485784*^9, 3.6296017289910207`*^9}, {
   3.629601965126772*^9, 3.629602009106655*^9}, {3.629602234491691*^9, 
   3.62960233417128*^9}, {3.6296025406568675`*^9, 3.629602545034876*^9}, {
   3.629602605592389*^9, 3.6296026720725155`*^9}, {3.629602819991993*^9, 
   3.629602824448001*^9}, {3.629605598839726*^9, 3.629605607327141*^9}, {
   3.6296058220871186`*^9, 3.62960582882633*^9}, {3.6296063832065477`*^9, 
   3.629606402387883*^9}, {3.629606538604329*^9, 3.6296066163905716`*^9}, {
   3.629606677993684*^9, 3.629606687579601*^9}, {3.6296068047490234`*^9, 
   3.629606830226368*^9}, 3.6296068624429245`*^9, {3.6296068979092875`*^9, 
   3.6296069681300106`*^9}, {3.629609076756136*^9, 3.6296091040088844`*^9}, {
   3.6296099141079187`*^9, 3.6296099316810493`*^9}, {3.6296100423732443`*^9, 
   3.629610095608038*^9}, {3.6296101382529125`*^9, 3.6296102324377785`*^9}, {
   3.629610465776189*^9, 3.6296105719830756`*^9}, {3.6296106080628395`*^9, 
   3.6296106195756593`*^9}, {3.629610656929625*^9, 3.629610732269657*^9}, {
   3.629610770130324*^9, 3.629610865268092*^9}, {3.629610900164753*^9, 
   3.6296109467227354`*^9}, {3.62961103488599*^9, 3.629611035478791*^9}, {
   3.62961131996777*^9, 3.629611351764426*^9}, {3.6296113965317063`*^9, 
   3.629611407320126*^9}, {3.629611650866873*^9, 3.629611658370486*^9}, {
   3.629611693028248*^9, 3.629611725211104*^9}, {3.629660344681587*^9, 
   3.629660396816783*^9}, {3.629662054116185*^9, 3.629662109498183*^9}, {
   3.629662485797946*^9, 3.629662506233982*^9}, {3.6296627377648115`*^9, 
   3.629662875565055*^9}, {3.629663059835583*^9, 3.6296630605400844`*^9}, {
   3.629663213456155*^9, 3.6296632447274103`*^9}, {3.62966339066107*^9, 
   3.629663505423672*^9}, {3.629663629963293*^9, 3.62966374139069*^9}, 
   3.6296637790073557`*^9, {3.6296639427647448`*^9, 3.62966405344954*^9}, {
   3.629664258753003*^9, 3.6296642835833473`*^9}, {3.629664357640478*^9, 
   3.629664406652266*^9}, {3.6296644497627425`*^9, 3.6296644754010878`*^9}, {
   3.6296645845515814`*^9, 3.629664754351282*^9}, {3.6296648207714*^9, 
   3.6296648719226904`*^9}, {3.6296649072767525`*^9, 3.629665007539429*^9}, {
   3.629665128176044*^9, 3.629665131155649*^9}, {3.629665198002467*^9, 
   3.629665208579286*^9}, {3.629665989873558*^9, 3.6296660606365824`*^9}, {
   3.629666240755704*^9, 3.629666248087716*^9}, {3.629680463417473*^9, 
   3.629680463611674*^9}, {3.6296839559917583`*^9, 3.629684004376444*^9}, {
   3.629684359598235*^9, 3.6296844225402164`*^9}, {3.629697473161625*^9, 
   3.6296975310175266`*^9}, {3.6296984575100627`*^9, 
   3.6296984799167023`*^9}, {3.629698536527603*^9, 3.6296985539120336`*^9}, {
   3.6297029070413284`*^9, 3.629702918063344*^9}, {3.629702984562439*^9, 
   3.629702988605445*^9}, {3.6297038644319816`*^9, 3.629703884097009*^9}, 
   3.6297039422184496`*^9, {3.629704987754769*^9, 3.6297050664593077`*^9}, {
   3.6297051249286375`*^9, 3.6297051564516935`*^9}, {3.6297051944125605`*^9, 
   3.6297052523000636`*^9}, {3.6297052825731173`*^9, 
   3.6297053031671534`*^9}, {3.629705388300189*^9, 3.62970538895539*^9}, {
   3.62972916921355*^9, 3.6297291763503666`*^9}, {3.6297292561692886`*^9, 
   3.629729263599902*^9}, {3.629761051728472*^9, 3.629761065720507*^9}, {
   3.629829049363864*^9, 3.629829080818822*^9}, {3.629832420822437*^9, 
   3.629832422351239*^9}, {3.629833134540451*^9, 3.629833156760482*^9}, {
   3.629841550046672*^9, 3.62984155467428*^9}, {3.6298419857146883`*^9, 
   3.6298419986509113`*^9}, {3.629842327687729*^9, 3.6298423483446655`*^9}, {
   3.6298424340556164`*^9, 3.6298424347651176`*^9}, {3.629857562453469*^9, 
   3.6298575752992034`*^9}, {3.6298617363544903`*^9, 3.629861743498315*^9}, {
   3.629861792832088*^9, 3.629861797965208*^9}, {3.6298621478116827`*^9, 
   3.6298621703399477`*^9}, {3.629862224692195*^9, 3.6298622386228337`*^9}, {
   3.629934024806528*^9, 3.6299340705926085`*^9}, {3.629935785029563*^9, 
   3.6299358234439325`*^9}, {3.630093833832834*^9, 3.630093925755106*^9}, {
   3.6303312112935457`*^9, 3.6303312550516224`*^9}, {3.6303358993921537`*^9, 
   3.6303359226755953`*^9}, {3.6306356399709835`*^9, 
   3.6306356458927946`*^9}, {3.630636068179586*^9, 3.6306361110125637`*^9}, {
   3.6306361560057445`*^9, 3.630636184065894*^9}, {3.630636235447586*^9, 
   3.630636267952746*^9}, {3.63063630275181*^9, 3.6306363664175234`*^9}, {
   3.6306364437215614`*^9, 3.6306365062241726`*^9}, {3.630636538221331*^9, 
   3.630636557862567*^9}, {3.630636607219159*^9, 3.6306366182246785`*^9}, {
   3.6306367049124327`*^9, 3.6306367069872365`*^9}, {3.6306367739863553`*^9, 
   3.6306368265585485`*^9}, {3.6306368669329214`*^9, 
   3.6306368850077534`*^9}, {3.6306369704707117`*^9, 
   3.6306369715340137`*^9}, {3.6306370050048733`*^9, 3.6306370121403866`*^9}, 
   3.6306370476386495`*^9, {3.6306371345330048`*^9, 3.6306371389166126`*^9}, {
   3.6306372376894894`*^9, 3.6306372761020594`*^9}, {3.6306374107348022`*^9, 
   3.6306374177860146`*^9}, {3.6306374703665094`*^9, 
   3.6306376025850487`*^9}, {3.6306376480269303`*^9, 
   3.6306376569389467`*^9}, {3.630637688572405*^9, 3.6306377047228336`*^9}, {
   3.630638005103675*^9, 3.63063803012432*^9}, {3.630638132477803*^9, 
   3.6306381742124786`*^9}, {3.630638443344762*^9, 3.6306384548725824`*^9}, {
   3.630693969338559*^9, 3.6306940821519747`*^9}, {3.630694494199352*^9, 
   3.6306945206800165`*^9}, {3.63069542859525*^9, 3.6306954292512627`*^9}, {
   3.630695677045081*^9, 3.6306957023971386`*^9}, {3.63069573859525*^9, 
   3.6306958461515474`*^9}, {3.6306960563359995`*^9, 3.630696315629788*^9}, {
   3.630696895134617*^9, 3.6306969769772644`*^9}, {3.6306970092793493`*^9, 
   3.630697023245936*^9}, {3.6306970610093985`*^9, 3.6306971134507113`*^9}, {
   3.63069721480139*^9, 3.6306972323263006`*^9}, {3.671403822997702*^9, 
   3.6714038860202975`*^9}, {3.671404769666751*^9, 3.671404932124491*^9}, {
   3.671404999032096*^9, 3.671404999152096*^9}, {3.6714050894249077`*^9, 
   3.671405092122412*^9}, {3.67140523671815*^9, 3.6714053192882805`*^9}, {
   3.6714054173459363`*^9, 3.671405533768616*^9}, {3.671409211990823*^9, 
   3.671409256770013*^9}, {3.671409296689161*^9, 3.671409307821204*^9}, 
   3.6714105541618795`*^9, {3.671410809268471*^9, 3.671410822660237*^9}, {
   3.6714124277246027`*^9, 3.67141242885212*^9}, {3.671648361386112*^9, 
   3.6716483651301193`*^9}, {3.671648574498087*^9, 3.671648600425332*^9}, {
   3.6716488824270277`*^9, 3.671649000831236*^9}, {3.671740416301479*^9, 
   3.6717404423390565`*^9}, 3.671747751830694*^9, {3.671762336815095*^9, 
   3.6717623586929307`*^9}, 3.671762401491088*^9, {3.825631538697545*^9, 
   3.8256315947610993`*^9}, {3.8256316516018195`*^9, 
   3.8256317001842775`*^9}, {3.8314389891691003`*^9, 
   3.8314389931051197`*^9}, {3.837500976504446*^9, 3.837500993879443*^9}, {
   3.837501078254426*^9, 3.83750112008255*^9}, {3.837501159988804*^9, 
   3.8375012158820705`*^9}, {3.8375012480695696`*^9, 
   3.8375012502102175`*^9}, {3.8375013464337997`*^9, 
   3.8375013604962997`*^9}, {3.837501475652548*^9, 3.8375014880275517`*^9}, {
   3.8757532108817077`*^9, 3.8757532167029066`*^9}, {3.8955547738173447`*^9, 
   3.8955547738273396`*^9}, {3.9597431672707233`*^9, 
   3.9597431731913548`*^9}, {3.959935571993141*^9, 3.959935592821467*^9}, 
   3.962764719510668*^9, {3.9627647592414417`*^9, 3.962764878710812*^9}, {
   3.962765085139309*^9, 3.962765117208786*^9}, {3.9627651951547403`*^9, 
   3.962765252066057*^9}, {3.9627654126251793`*^9, 3.9627654162127934`*^9}, {
   3.962765449030932*^9, 3.962765450817075*^9}, {3.962765488275814*^9, 
   3.962765496975831*^9}, {3.962765957424247*^9, 3.962765968537829*^9}, {
   3.9677774516569614`*^9, 3.967777451662475*^9}, {3.9688230510680637`*^9, 
   3.96882312175242*^9}, {3.968823520707572*^9, 3.968823521913238*^9}, {
   3.969749009602899*^9, 3.9697490122909946`*^9}, {3.9697491081542*^9, 
   3.969749109867494*^9}, 3.969750149101265*^9, 3.9697502339865093`*^9, {
   3.969750327777569*^9, 3.969750350721537*^9}, {3.97305266744466*^9, 
   3.973052686371437*^9}, {3.975309102669956*^9, 3.9753091257614527`*^9}, {
   3.9753091597436857`*^9, 
   3.975309160552725*^9}},ExpressionUUID->"36cf09fb-177d-4db5-95d5-\
946628070b0d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Format", "Subsubsection",
 CellChangeTimes->{
  3.861141894360052*^9},ExpressionUUID->"e40595af-8b16-4e8a-bd7d-\
29d3504b2037"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Format", ":"}],
    FontColor->RGBColor[0.5, 0, 0.5]], 
   StyleBox[" ",
    FontColor->GrayLevel[0.5]], 
   StyleBox["*)",
    FontColor->GrayLevel[0.5]]}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "we", " ", "display", " ", "the", " ", "TensorName", " ", "and", " ", 
    "associated", " ", "indices"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"w", "/", " ", "TooltipDisplay"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Format", "[", 
     RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
      RowBox[{"xxx___", ",", "\[IndentingNewLine]", 
       RowBox[{"TensorName", "\[Rule]", "name_"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Indices", "\[Rule]", "\[Mu]T_List"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TooltipDisplay", "\[Rule]", 
        RowBox[{"display_", "/;", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"display", "=!=", "Null"}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{"display", "=!=", "TensorComponents"}], ")"}]}]}]}]}], 
      "\[IndentingNewLine]", "]"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Tooltip", "[", 
     RowBox[{
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FormatTensorName", "[", "name", "]"}], ",", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"UpOrDown", "[", "#", "]"}], "&"}], "/@", "\[Mu]T"}], 
           ")"}]}]}], "}"}], "]"}], ",", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "display", "]"}], "===", "List"}], ",", 
        RowBox[{"Flatten", "[", "display", "]"}], ",", "True", ",", 
        "display"}], "]"}], ",", 
      RowBox[{"Sequence", "@@", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"TooltipStyleNoPart", "[", 
             RowBox[{"{", "xxx", "}"}], "]"}], ")"}], "===", 
           RowBox[{"{", "}"}]}], ")"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"TooltipStyleNoPart", "[", 
             RowBox[{"{", "xxx", "}"}], "]"}], ")"}], "=!=", 
           RowBox[{"{", "}"}]}], ")"}], ",", 
         RowBox[{"{", 
          RowBox[{"TooltipStyle", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"TooltipStyle", "[", 
             RowBox[{"{", "xxx", "}"}], "]"}], ")"}]}], "}"}]}], "]"}]}]}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"w", "/", "o"}], " ", "TooltipDisplay", " ", "I", " ", "of", " ",
      "II"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Scalars", ",", " ", 
     RowBox[{
      RowBox[{"vectors", " ", "and", " ", "rank"}], "-", 
      RowBox[{"2", " ", "tensors"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Format", "[", 
     RowBox[{
      RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xxx___", "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"TooltipDisplayNoPart", "[", 
                 RowBox[{"{", "xxx", "}"}], "]"}], "]"}], "===", 
               RowBox[{"{", "}"}]}], ")"}], "||", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"TooltipDisplayNoPart", "[", 
                 RowBox[{"{", "xxx", "}"}], "]"}], "]"}], "===", 
               RowBox[{"{", "Null", "}"}]}], ")"}]}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"TooltipDisplayNoPart", "[", 
              RowBox[{"{", "xxx", "}"}], "]"}], "=!=", 
             RowBox[{"{", "TensorComponents", "}"}]}], ")"}]}], ")"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TensorName", "\[Rule]", "name_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Indices", "\[Rule]", "\[Mu]T_List"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TensorComponents", "\[Rule]", "ttM_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Coordinates", "\[Rule]", "coords_List"}]}], 
       "\[IndentingNewLine]", "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"(*", " ", 
        RowBox[{"scalar", ",", " ", 
         RowBox[{
         "vector", " ", "or", " ", "rank", " ", "2", " ", "tensor"}]}], " ", 
        "*)"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RemoveUnderBarredIndices", "[", "\[Mu]T", "]"}], "===", 
          RowBox[{"{", "}"}]}], ")"}], "||", 
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"Dimensions", "[", "ttM", "]"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Length", "[", "coords", "]"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Length", "[", "coords", "]"}], ",", 
             RowBox[{"Length", "[", "coords", "]"}]}], "}"}]}]}], "]"}]}], 
       ")"}]}], "]"}], ":=", 
    RowBox[{"Tooltip", "[", 
     RowBox[{
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FormatTensorName", "[", "name", "]"}], ",", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"UpOrDown", "[", "#", "]"}], "&"}], "/@", "\[Mu]T"}], 
           ")"}]}]}], "}"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"MatrixForm", "[", "ttM", "]"}], ",", 
        RowBox[{"\"\<Coordinates\>\"", "\[Rule]", "coords"}]}], "}"}], ",", 
      RowBox[{"Sequence", "@@", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"TooltipStyleNoPart", "[", 
             RowBox[{"{", "xxx", "}"}], "]"}], ")"}], "===", 
           RowBox[{"{", "}"}]}], ")"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"TooltipStyleNoPart", "[", 
            RowBox[{"{", "xxx", "}"}], "]"}], ")"}], "=!=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"TooltipStyle", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"TooltipStyle", "[", 
             RowBox[{"{", "xxx", "}"}], "]"}], ")"}]}], "}"}]}], "]"}]}]}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"w", "/", "o"}], " ", "TooltipDisplay", " ", "II", " ", "of", 
     " ", "II"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"everything", " ", "else"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Format", "[", 
      RowBox[{
       RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"xxx___", "/;", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"TooltipDisplayNoPart", "[", 
                RowBox[{"{", "xxx", "}"}], "]"}], "]"}], "===", 
              RowBox[{"{", "}"}]}], ")"}], "||", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"TooltipDisplayNoPart", "[", 
                 RowBox[{"{", "xxx", "}"}], "]"}], "]"}], "===", 
               RowBox[{"{", "Null", "}"}]}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"TooltipDisplayNoPart", "[", 
                RowBox[{"{", "xxx", "}"}], "]"}], "=!=", 
               RowBox[{"{", "TensorComponents", "}"}]}], ")"}]}]}], ")"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"TensorName", "\[Rule]", "name_"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Indices", "\[Rule]", "\[Mu]T_List"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TensorComponents", "\[Rule]", "ttM_"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Coordinates", "\[Rule]", "coords_List"}]}], 
        "\[IndentingNewLine]", "]"}], "/;", 
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{"scalar", ",", " ", 
           RowBox[{
           "vector", " ", "or", " ", "rank", " ", "2", " ", "tensor"}]}], " ",
           "*)"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"RemoveUnderBarredIndices", "[", "\[Mu]T", "]"}], "===", 
            RowBox[{"{", "}"}]}], ")"}], "||", 
          RowBox[{"MatchQ", "[", 
           RowBox[{
            RowBox[{"Dimensions", "[", "ttM", "]"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Length", "[", "coords", "]"}], "}"}], "|", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Length", "[", "coords", "]"}], ",", 
               RowBox[{"Length", "[", "coords", "]"}]}], "}"}]}]}], "]"}]}], 
         ")"}]}]}], "]"}], ":=", 
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FormatTensorName", "[", "name", "]"}], ",", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"UpOrDown", "[", "#", "]"}], "&"}], "/@", "\[Mu]T"}], 
          ")"}]}]}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Format", "[", "\[IndentingNewLine]", 
      RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
       RowBox[{"xxx___", ",", "\[IndentingNewLine]", 
        RowBox[{"TooltipDisplay", "\[Rule]", "TensorComponents"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TensorName", "\[Rule]", "name_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Indices", "\[Rule]", "\[Mu]T_List"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TensorComponents", "\[Rule]", "ttM_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Coordinates", "\[Rule]", "coords_List"}]}], 
       "\[IndentingNewLine]", "]"}], "]"}], ":=", 
     StyleBox["\n", "Code"], 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"TooltipStyleNoPart", "[", 
           RowBox[{"{", "xxx", "}"}], "]"}], "]"}], "===", 
         RowBox[{"{", "}"}]}], ")"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Tooltip", "[", 
        RowBox[{
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FormatTensorName", "[", "name", "]"}], ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"UpOrDown", "[", "#", "]"}], "&"}], "/@", "\[Mu]T"}], 
              ")"}]}]}], "}"}], "]"}], ",", 
         RowBox[{"NonZeroTensorComponents", "[", 
          RowBox[{
          "name", ",", "\[IndentingNewLine]", "\[Mu]T", ",", 
           "\[IndentingNewLine]", "ttM", ",", "\[IndentingNewLine]", 
           "coords"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"TooltipStyleNoPart", "[", 
           RowBox[{"{", "xxx", "}"}], "]"}], "]"}], "=!=", 
         RowBox[{"{", "}"}]}], ")"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Tooltip", "[", 
        RowBox[{
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FormatTensorName", "[", "name", "]"}], ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"UpOrDown", "[", "#", "]"}], "&"}], "/@", "\[Mu]T"}], 
              ")"}]}]}], "}"}], "]"}], ",", 
         RowBox[{"NonZeroTensorComponents", "[", 
          RowBox[{
          "name", ",", "\[IndentingNewLine]", "\[Mu]T", ",", 
           "\[IndentingNewLine]", "ttM", ",", "\[IndentingNewLine]", 
           "coords"}], "]"}], ",", 
         RowBox[{"TooltipStyle", "\[Rule]", 
          RowBox[{"TooltipStyle", "[", 
           RowBox[{"{", "xxx", "}"}], "]"}]}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.518287025359375*^9, 3.518287083796875*^9}, {
   3.518287204515625*^9, 3.518287246046875*^9}, {3.518288154015625*^9, 
   3.518288179625*^9}, {3.5196834121875*^9, 3.519683417953125*^9}, {
   3.519689356625*^9, 3.519689356921875*^9}, {3.51976580715625*^9, 
   3.519765810671875*^9}, {3.519963432453125*^9, 3.519963433953125*^9}, 
   3.520125837828125*^9, {3.5201289498125*^9, 3.5201289504375*^9}, 
   3.520219859578125*^9, 3.5202268538125*^9, {3.52027377246875*^9, 
   3.520273831296875*^9}, {3.5202738760625*^9, 3.52027388446875*^9}, {
   3.5202739371875*^9, 3.5202741019375*^9}, {3.52027416353125*^9, 
   3.520274167671875*^9}, 3.520274919453125*^9, {3.52027495775*^9, 
   3.52027500990625*^9}, {3.520275109328125*^9, 3.52027513640625*^9}, {
   3.520275352625*^9, 3.520275353015625*^9}, {3.52027552415625*^9, 
   3.5202755711875*^9}, 3.520275790296875*^9, {3.5202759311875*^9, 
   3.520275948625*^9}, {3.520276746125*^9, 3.5202767880625*^9}, {
   3.52027692378125*^9, 3.52027700428125*^9}, {3.520277061046875*^9, 
   3.520277097125*^9}, {3.520277138046875*^9, 3.520277203125*^9}, {
   3.52027851596875*^9, 3.520278524*^9}, {3.52027856384375*^9, 
   3.520278653328125*^9}, 3.5202787563125*^9, {3.520279456296875*^9, 
   3.5202794635625*^9}, {3.520279561640625*^9, 3.520279567359375*^9}, {
   3.52028006315625*^9, 3.520280068671875*^9}, {3.5202804206875*^9, 
   3.520280495234375*^9}, 3.520281272765625*^9, {3.52028149878125*^9, 
   3.5202815018125*^9}, {3.520281674421875*^9, 3.5202816786875*^9}, {
   3.520281727390625*^9, 3.520281730375*^9}, 3.52028190265625*^9, {
   3.52028213190625*^9, 3.520282169640625*^9}, {3.520282364859375*^9, 
   3.520282395859375*^9}, {3.520282483109375*^9, 3.520282499046875*^9}, {
   3.52028567246875*^9, 3.520285695984375*^9}, {3.5202857606875*^9, 
   3.520285762578125*^9}, {3.520285792890625*^9, 3.520285807109375*^9}, {
   3.5202858616875*^9, 3.52028586721875*^9}, {3.520286964859375*^9, 
   3.520286985015625*^9}, {3.52028713909375*^9, 3.520287168453125*^9}, {
   3.52030002590625*^9, 3.520300043171875*^9}, {3.520300760625*^9, 
   3.520300806765625*^9}, {3.52030106778125*^9, 3.520301101625*^9}, {
   3.520301143203125*^9, 3.520301143921875*^9}, {3.520301203140625*^9, 
   3.520301219734375*^9}, {3.520301382671875*^9, 3.520301408375*^9}, {
   3.5203015531875*^9, 3.520301561859375*^9}, {3.52030160309375*^9, 
   3.52030162021875*^9}, {3.520301674546875*^9, 3.520301675078125*^9}, 
   3.520301885265625*^9, {3.52030235646875*^9, 3.5203024485*^9}, {
   3.52030252584375*^9, 3.520302587984375*^9}, {3.520302792015625*^9, 
   3.520302959515625*^9}, {3.520303101875*^9, 3.520303107296875*^9}, {
   3.520303238609375*^9, 3.52030324271875*^9}, {3.520303299859375*^9, 
   3.520303323609375*^9}, 3.5203034191875*^9, {3.5203509418125*^9, 
   3.520350955265625*^9}, {3.520374181640625*^9, 3.52037419353125*^9}, {
   3.52037428890625*^9, 3.52037429225*^9}, {3.520374390359375*^9, 
   3.520374391046875*^9}, {3.52037449153125*^9, 3.520374508859375*^9}, {
   3.520374542359375*^9, 3.520374562515625*^9}, {3.520374665328125*^9, 
   3.520374666125*^9}, {3.520374798734375*^9, 3.5203748170625*^9}, {
   3.520442091734375*^9, 3.520442103078125*^9}, {3.520442156859375*^9, 
   3.520442237609375*^9}, {3.520442932203125*^9, 3.520442946328125*^9}, 
   3.5204430529375*^9, {3.520449654171875*^9, 3.520449741703125*^9}, {
   3.520461701390625*^9, 3.52046171115625*^9}, {3.520461829296875*^9, 
   3.5204618643125*^9}, {3.52046189925*^9, 3.5204619086875*^9}, {
   3.520462190671875*^9, 3.520462199265625*^9}, {3.520462248390625*^9, 
   3.520462255953125*^9}, {3.52046263196875*^9, 3.520462676203125*^9}, {
   3.520462781609375*^9, 3.520462783296875*^9}, {3.52046295721875*^9, 
   3.52046300696875*^9}, {3.520463069578125*^9, 3.520463097359375*^9}, {
   3.52046330721875*^9, 3.520463328234375*^9}, {3.520463500234375*^9, 
   3.520463506578125*^9}, {3.5204635759375*^9, 3.52046357878125*^9}, {
   3.520463627625*^9, 3.520463634921875*^9}, {3.52046371734375*^9, 
   3.520463719828125*^9}, {3.520463799875*^9, 3.52046387153125*^9}, {
   3.5204646916875*^9, 3.520464736625*^9}, {3.52069951259375*^9, 
   3.520699699609375*^9}, {3.520699992109375*^9, 3.52069999440625*^9}, {
   3.520811957234375*^9, 3.520812132578125*^9}, {3.52081218434375*^9, 
   3.520812365828125*^9}, {3.520812564921875*^9, 3.520812569625*^9}, {
   3.5208126603125*^9, 3.520812664359375*^9}, {3.5208127515*^9, 
   3.52081275875*^9}, {3.520812849*^9, 3.520812859109375*^9}, {
   3.520812903453125*^9, 3.5208130645*^9}, {3.520813114734375*^9, 
   3.520813119109375*^9}, {3.52081316215625*^9, 3.52081316665625*^9}, {
   3.5208133298125*^9, 3.520813333390625*^9}, {3.5208135518125*^9, 
   3.520813616953125*^9}, {3.520814478625*^9, 3.520814517421875*^9}, {
   3.520814555859375*^9, 3.520814613671875*^9}, {3.5208146563125*^9, 
   3.520814722828125*^9}, {3.52081482359375*^9, 3.520814830421875*^9}, {
   3.52087296378125*^9, 3.520873035734375*^9}, {3.52087306871875*^9, 
   3.520873075875*^9}, {3.520873179546875*^9, 3.5208732265625*^9}, {
   3.52087327746875*^9, 3.520873296546875*^9}, {3.52087335853125*^9, 
   3.520873361484375*^9}, {3.520873428328125*^9, 3.520873439921875*^9}, {
   3.520873528796875*^9, 3.520873596453125*^9}, {3.520874029125*^9, 
   3.520874058125*^9}, {3.52087876996875*^9, 3.520878774265625*^9}, {
   3.520879095359375*^9, 3.520879096078125*^9}, {3.520881848546875*^9, 
   3.520882124296875*^9}, {3.5208821583125*^9, 3.5208822268125*^9}, {
   3.520882285359375*^9, 3.520882299640625*^9}, {3.52088233096875*^9, 
   3.520882332296875*^9}, {3.52088237009375*^9, 3.5208825624375*^9}, {
   3.520882741546875*^9, 3.5208828856875*^9}, {3.520884240671875*^9, 
   3.520884241375*^9}, {3.520885397109375*^9, 3.520885515015625*^9}, {
   3.52088556446875*^9, 3.5208858435625*^9}, {3.520885898484375*^9, 
   3.520885974234375*^9}, {3.520898025796875*^9, 3.520898078625*^9}, {
   3.520898132015625*^9, 3.520898159171875*^9}, {3.520898268171875*^9, 
   3.520898439453125*^9}, {3.520898471875*^9, 3.52089847509375*^9}, {
   3.5208987905625*^9, 3.520898791046875*^9}, 3.520957046015625*^9, {
   3.5209570961875*^9, 3.520957131078125*^9}, {3.52107807721875*^9, 
   3.521078188765625*^9}, {3.5210782819375*^9, 3.521078383796875*^9}, {
   3.521137026140625*^9, 3.521137068953125*^9}, {3.521142246921875*^9, 
   3.52114265653125*^9}, {3.52114442525*^9, 3.521144472171875*^9}, {
   3.521144505640625*^9, 3.52114451575*^9}, {3.52114454646875*^9, 
   3.5211445929375*^9}, {3.52121984296875*^9, 3.5212198994375*^9}, {
   3.521220739*^9, 3.52122090625*^9}, {3.521221086375*^9, 
   3.5212210973125*^9}, {3.521221169703125*^9, 3.521221170109375*^9}, {
   3.521241296640625*^9, 3.52124132271875*^9}, {3.521241364609375*^9, 
   3.521241377921875*^9}, {3.521241761265625*^9, 3.521241789875*^9}, {
   3.52125020228125*^9, 3.5212503195*^9}, {3.521250367578125*^9, 
   3.52125043315625*^9}, {3.521348381171875*^9, 3.521348591296875*^9}, {
   3.5213486974375*^9, 3.52134881896875*^9}, {3.52134888690625*^9, 
   3.521348973890625*^9}, 3.5213493814375*^9, 3.521349424265625*^9, {
   3.521349591765625*^9, 3.52134976540625*^9}, {3.521349909984375*^9, 
   3.52134995234375*^9}, {3.5213501821875*^9, 3.521350185953125*^9}, {
   3.5213504943125*^9, 3.521350511640625*^9}, {3.5213506120625*^9, 
   3.521350633390625*^9}, {3.52135068425*^9, 3.521350712765625*^9}, {
   3.521351003671875*^9, 3.521351010375*^9}, {3.52135113328125*^9, 
   3.52135113853125*^9}, {3.521351225125*^9, 3.521351264515625*^9}, {
   3.521353769546875*^9, 3.52135380609375*^9}, {3.52135391003125*^9, 
   3.5213539324375*^9}, {3.52138689021875*^9, 3.521386896859375*^9}, {
   3.5213915893125*^9, 3.52139181034375*^9}, {3.52139186425*^9, 
   3.521391942109375*^9}, {3.521391976125*^9, 3.521391991109375*^9}, {
   3.521392049890625*^9, 3.52139216490625*^9}, {3.52139221046875*^9, 
   3.521392215734375*^9}, {3.52139226215625*^9, 3.5213922816875*^9}, {
   3.5213923241875*^9, 3.52139238159375*^9}, {3.521392606671875*^9, 
   3.5213926106875*^9}, {3.521392646546875*^9, 3.521392830515625*^9}, {
   3.521392927671875*^9, 3.521392945734375*^9}, {3.521393239734375*^9, 
   3.521393253125*^9}, {3.52139330940625*^9, 3.52139332665625*^9}, {
   3.52139486253125*^9, 3.52139486378125*^9}, {3.521395281328125*^9, 
   3.521395287609375*^9}, {3.52139612678125*^9, 3.521396148546875*^9}, {
   3.521396433484375*^9, 3.52139647615625*^9}, {3.521396513796875*^9, 
   3.521396530703125*^9}, {3.521396718125*^9, 3.521396718453125*^9}, {
   3.521398676140625*^9, 3.52139875478125*^9}, {3.52139878946875*^9, 
   3.52139882240625*^9}, {3.521399017640625*^9, 3.521399148484375*^9}, {
   3.521399182484375*^9, 3.521399183546875*^9}, {3.521399244109375*^9, 
   3.5213993385*^9}, {3.5213995170625*^9, 3.521399783703125*^9}, {
   3.52139984184375*^9, 3.521399940109375*^9}, {3.521400227171875*^9, 
   3.521400233828125*^9}, {3.521400279890625*^9, 3.5214002875625*^9}, {
   3.521400370515625*^9, 3.521400373984375*^9}, {3.521400410140625*^9, 
   3.521400412890625*^9}, {3.521401423609375*^9, 3.52140142775*^9}, {
   3.5214015165625*^9, 3.52140151815625*^9}, {3.521401780921875*^9, 
   3.521401883765625*^9}, {3.52140193640625*^9, 3.521401969265625*^9}, {
   3.52140201503125*^9, 3.52140202003125*^9}, {3.521402455625*^9, 
   3.5214025640625*^9}, {3.52140260134375*^9, 3.52140261928125*^9}, {
   3.521402734453125*^9, 3.521402863140625*^9}, {3.52141532615625*^9, 
   3.5214153873125*^9}, {3.5214156420625*^9, 3.52141570696875*^9}, {
   3.521442583140625*^9, 3.521442620640625*^9}, {3.521442651796875*^9, 
   3.521442666296875*^9}, {3.5214427025*^9, 3.521442792484375*^9}, {
   3.52144286128125*^9, 3.52144296165625*^9}, {3.521443004765625*^9, 
   3.5214430215625*^9}, {3.52144312996875*^9, 3.521443237265625*^9}, {
   3.521443272421875*^9, 3.52144328728125*^9}, {3.521471452890625*^9, 
   3.521471462828125*^9}, {3.521472116640625*^9, 3.52147218709375*^9}, {
   3.521472280796875*^9, 3.52147230184375*^9}, {3.521472418421875*^9, 
   3.521472429140625*^9}, {3.521472511109375*^9, 3.521472519234375*^9}, {
   3.521472551109375*^9, 3.521472579375*^9}, {3.52164943446875*^9, 
   3.521649441140625*^9}, {3.52164978603125*^9, 3.521649794796875*^9}, {
   3.521653219375*^9, 3.521653224921875*^9}, {3.52165329765625*^9, 
   3.5216533165625*^9}, {3.52165483128125*^9, 3.521654835875*^9}, {
   3.5216555458125*^9, 3.5216555685*^9}, {3.52166988665625*^9, 
   3.52166989046875*^9}, {3.521670768421875*^9, 3.52167081534375*^9}, {
   3.521670849203125*^9, 3.521670860421875*^9}, {3.521670891625*^9, 
   3.5216709856875*^9}, {3.521671147125*^9, 3.52167118725*^9}, {
   3.5216712428125*^9, 3.521671386015625*^9}, {3.52167158846875*^9, 
   3.5216716393125*^9}, {3.52167168784375*^9, 3.52167170453125*^9}, {
   3.521671767953125*^9, 3.521671800890625*^9}, {3.52167184703125*^9, 
   3.52167188040625*^9}, {3.5216719656875*^9, 3.5216720203125*^9}, {
   3.521672086421875*^9, 3.521672149015625*^9}, {3.521672195671875*^9, 
   3.5216722440625*^9}, {3.521672320125*^9, 3.52167243040625*^9}, {
   3.521672468421875*^9, 3.521672645609375*^9}, 3.521672796265625*^9, {
   3.5216729164375*^9, 3.52167311040625*^9}, {3.521673143375*^9, 
   3.52167317259375*^9}, {3.521673209484375*^9, 3.521673232453125*^9}, {
   3.521673284078125*^9, 3.52167331528125*^9}, {3.52167336734375*^9, 
   3.521673388625*^9}, {3.5216751101875*^9, 3.52167523325*^9}, {
   3.5216758554375*^9, 3.52167588446875*^9}, {3.521676011109375*^9, 
   3.521676031296875*^9}, {3.521676083265625*^9, 3.52167608490625*^9}, {
   3.52167614078125*^9, 3.521676144140625*^9}, {3.521676218859375*^9, 
   3.521676219984375*^9}, {3.521676257140625*^9, 3.521676342625*^9}, {
   3.521676404546875*^9, 3.52167643903125*^9}, {3.52167657284375*^9, 
   3.521676714046875*^9}, {3.521676750734375*^9, 3.521676871203125*^9}, {
   3.521677046671875*^9, 3.521677063546875*^9}, {3.5216771815625*^9, 
   3.52167723953125*^9}, {3.52167732425*^9, 3.52167734403125*^9}, {
   3.521677383*^9, 3.521677383875*^9}, {3.521677432109375*^9, 
   3.521677540125*^9}, {3.52167758334375*^9, 3.521677617234375*^9}, {
   3.521677668*^9, 3.521677671203125*^9}, {3.52167772715625*^9, 
   3.521677757234375*^9}, {3.521677788*^9, 3.52167782253125*^9}, {
   3.521677906875*^9, 3.521677914546875*^9}, {3.521677984171875*^9, 
   3.5216780049375*^9}, {3.521678053546875*^9, 3.521678053734375*^9}, {
   3.5216998578125*^9, 3.52169988396875*^9}, {3.521699914484375*^9, 
   3.521699973359375*^9}, {3.521700012703125*^9, 3.52170021290625*^9}, {
   3.521700272359375*^9, 3.521700381625*^9}, {3.52170041990625*^9, 
   3.52170087975*^9}, {3.52170095365625*^9, 3.5217009635*^9}, {
   3.52170103315625*^9, 3.52170115653125*^9}, {3.521701254953125*^9, 
   3.521701351890625*^9}, {3.5217013993125*^9, 3.521701438234375*^9}, {
   3.521701516515625*^9, 3.52170153925*^9}, {3.521701892234375*^9, 
   3.52170189378125*^9}, {3.521702314984375*^9, 3.521702329390625*^9}, {
   3.52173341071875*^9, 3.521733630953125*^9}, {3.52173367478125*^9, 
   3.52173375459375*^9}, {3.521733804375*^9, 3.521733833953125*^9}, {
   3.521741591*^9, 3.52174163671875*^9}, {3.521741705890625*^9, 
   3.521741768546875*^9}, {3.52174187984375*^9, 3.52174188003125*^9}, {
   3.521742036875*^9, 3.52174203709375*^9}, {3.521745152640625*^9, 
   3.521745164734375*^9}, {3.521745200890625*^9, 3.521745255765625*^9}, {
   3.521745324890625*^9, 3.52174536284375*^9}, {3.521745446203125*^9, 
   3.52174547321875*^9}, {3.521745506265625*^9, 3.521745513234375*^9}, {
   3.52174554921875*^9, 3.52174556996875*^9}, {3.5217456041875*^9, 
   3.521745606546875*^9}, {3.521745796859375*^9, 3.521745798109375*^9}, {
   3.521746119421875*^9, 3.521746202171875*^9}, {3.521746247578125*^9, 
   3.5217462608125*^9}, {3.521746322625*^9, 3.521746349625*^9}, {
   3.52175678640625*^9, 3.521756816921875*^9}, {3.521757001703125*^9, 
   3.521757017046875*^9}, {3.5217610119375*^9, 3.52176102221875*^9}, {
   3.5217647861875*^9, 3.521764807984375*^9}, {3.521764873484375*^9, 
   3.521764892078125*^9}, {3.52176496665625*^9, 3.521764992953125*^9}, {
   3.521765145359375*^9, 3.52176515403125*^9}, {3.52176547803125*^9, 
   3.521765486640625*^9}, {3.521784419484375*^9, 3.52178441959375*^9}, {
   3.521784735171875*^9, 3.521784739125*^9}, {3.521784803*^9, 
   3.521784832328125*^9}, {3.5217852330625*^9, 3.521785233265625*^9}, {
   3.521788073828125*^9, 3.521788104875*^9}, {3.52179265278125*^9, 
   3.521792721640625*^9}, {3.521792757875*^9, 3.521792783609375*^9}, {
   3.52179304334375*^9, 3.521793217125*^9}, {3.521793247703125*^9, 
   3.52179326671875*^9}, {3.521867759015625*^9, 3.521867794828125*^9}, {
   3.521903765703125*^9, 3.52190378259375*^9}, {3.521910287625*^9, 
   3.5219103075625*^9}, {3.52191037603125*^9, 3.521910410796875*^9}, {
   3.52191902275*^9, 3.521919058921875*^9}, {3.52191974478125*^9, 
   3.5219197580625*^9}, {3.5219389993125*^9, 3.521939153*^9}, {
   3.52194930271875*^9, 3.52194932571875*^9}, {3.52194942278125*^9, 
   3.5219494263125*^9}, {3.521950287453125*^9, 3.52195029703125*^9}, {
   3.521953722984375*^9, 3.52195380025*^9}, {3.52195433934375*^9, 
   3.521954407375*^9}, {3.5219544496875*^9, 3.52195451690625*^9}, {
   3.5219546679375*^9, 3.52195468209375*^9}, {3.5219548593125*^9, 
   3.521954863546875*^9}, {3.52195602975*^9, 3.521956063796875*^9}, {
   3.52195629140625*^9, 3.521956357828125*^9}, {3.521956396453125*^9, 
   3.5219564374375*^9}, {3.5338712661975746`*^9, 3.533871361323346*^9}, {
   3.5338813382784786`*^9, 3.5338813663273277`*^9}, {3.5338815867333527`*^9, 
   3.53388159891597*^9}, {3.5338816780572996`*^9, 3.533881853354808*^9}, {
   3.533881894133279*^9, 3.5338820548759613`*^9}, {3.53388210515485*^9, 
   3.5338821573837414`*^9}, {3.5338824795243073`*^9, 3.533882480304309*^9}, {
   3.5338826190353527`*^9, 3.5338826220773573`*^9}, {3.533882797000465*^9, 
   3.5338828884946256`*^9}, 3.533882972625573*^9, {3.5338830165708504`*^9, 
   3.533883031609277*^9}, {3.533883077816558*^9, 3.5338830803125625`*^9}, {
   3.5338831964547663`*^9, 3.533883212085994*^9}, {3.5338832641276855`*^9, 
   3.533883270461296*^9}, {3.5338833237977905`*^9, 3.5338833905035076`*^9}, {
   3.5338834292071753`*^9, 3.5338834566632233`*^9}, {3.5338835023089037`*^9, 
   3.5338835056785097`*^9}, {3.5338835727118273`*^9, 
   3.5338835994502745`*^9}, {3.5338836545651712`*^9, 
   3.5338836686519957`*^9}, {3.533883732097307*^9, 3.533883735388913*^9}, {
   3.5338838282402763`*^9, 3.533883831469482*^9}, {3.5338838790807657`*^9, 
   3.5338839318556585`*^9}, {3.5338841950601697`*^9, 
   3.5338842006611776`*^9}, {3.533884289183502*^9, 3.533884385586038*^9}, {
   3.5338844540299344`*^9, 3.5338846658554325`*^9}, {3.533896646054044*^9, 
   3.5338967398621426`*^9}, {3.533896822025326*^9, 3.5338968359964437`*^9}, {
   3.53389691032167*^9, 3.5338969105856824`*^9}, {3.5338971233903627`*^9, 
   3.5338971363541813`*^9}, {3.533897219401898*^9, 3.5338972354505205`*^9}, {
   3.5338972707361703`*^9, 3.5338972749661765`*^9}, {3.5338978585023127`*^9, 
   3.533897865536066*^9}, {3.5338979217961693`*^9, 3.533898000278984*^9}, {
   3.5338980623234015`*^9, 3.533898066186492*^9}, {3.533898144347541*^9, 
   3.5338981535560675`*^9}, {3.533898233983821*^9, 3.5338982373649206`*^9}, {
   3.5339312966250153`*^9, 3.533931296985016*^9}, {3.5339314506542325`*^9, 
   3.5339314570856414`*^9}, {3.533931664934333*^9, 3.5339316768215537`*^9}, {
   3.5857213419283295`*^9, 3.58572134252113*^9}, {3.5857215487846923`*^9, 
   3.585721549174693*^9}, {3.585721605319192*^9, 3.5857216509180717`*^9}, {
   3.5857216896061397`*^9, 3.585721690448541*^9}, {3.58572175242745*^9, 
   3.5857217649074717`*^9}, {3.5857221603837667`*^9, 3.585722165188575*^9}, {
   3.5857222535315304`*^9, 3.5857222644515495`*^9}, {3.5857227752120466`*^9, 
   3.5857228235877314`*^9}, {3.585722986264817*^9, 3.5857230354673033`*^9}, {
   3.585723093686606*^9, 3.585723122203456*^9}, {3.585723169643139*^9, 
   3.585723171733543*^9}, {3.5857232526664853`*^9, 3.58572327258772*^9}, {
   3.606335159966839*^9, 3.606335198046506*^9}, {3.6063352330685673`*^9, 
   3.606335262131418*^9}, {3.6063353403967557`*^9, 3.6063353699744077`*^9}, {
   3.6063355019506392`*^9, 3.6063355100002537`*^9}, {3.6063358322344193`*^9, 
   3.6063358372576284`*^9}, {3.6066738883426533`*^9, 3.606673983512097*^9}, {
   3.6066740559482403`*^9, 3.6066740635486746`*^9}, {3.6066743363332767`*^9, 
   3.606674360126638*^9}, {3.6066746414127264`*^9, 3.6066746456029663`*^9}, {
   3.6066746864413023`*^9, 3.6066746935107064`*^9}, {3.606764163770528*^9, 
   3.6067641878257694`*^9}, {3.6067646447193723`*^9, 
   3.6067646954194613`*^9}, {3.6067650160780244`*^9, 
   3.6067650464980783`*^9}, {3.629562191862056*^9, 3.6295622179565096`*^9}, {
   3.6295624903759656`*^9, 3.6295625052137947`*^9}, {3.629562566755515*^9, 
   3.6295625671621156`*^9}, {3.629563111218094*^9, 3.6295631194739094`*^9}, {
   3.6295678441846895`*^9, 3.6295678567385135`*^9}, {3.6295769150568147`*^9, 
   3.629576939323668*^9}, 3.6295791738516903`*^9, 3.6295792209418187`*^9, {
   3.629581267714156*^9, 3.6295812912406006`*^9}, {3.629581325784066*^9, 
   3.629581340671893*^9}, {3.6295814029374175`*^9, 3.629581429304266*^9}, {
   3.6295818560362825`*^9, 3.629581856332683*^9}, {3.6295819110649934`*^9, 
   3.6295819150988007`*^9}, 3.62958195994705*^9, {3.6295827367218447`*^9, 
   3.6295827372990456`*^9}, {3.629582811380183*^9, 3.6295830005573826`*^9}, {
   3.6295922773693624`*^9, 3.6295923269242268`*^9}, {3.629592361069789*^9, 
   3.629592363895294*^9}, {3.6295923947624507`*^9, 3.6295924368449287`*^9}, {
   3.629592556257448*^9, 3.6295925866629047`*^9}, {3.6295926742687674`*^9, 
   3.6295926896873956`*^9}, {3.629592857642812*^9, 3.6295928635884237`*^9}, {
   3.6296008298157945`*^9, 3.629600857037795*^9}, {3.6296010760041723`*^9, 
   3.6296011709187737`*^9}, {3.6296012604938602`*^9, 
   3.6296013158603663`*^9}, {3.629601566485784*^9, 3.6296017289910207`*^9}, {
   3.629601965126772*^9, 3.629602009106655*^9}, {3.629602234491691*^9, 
   3.62960233417128*^9}, {3.6296025406568675`*^9, 3.629602545034876*^9}, {
   3.629602605592389*^9, 3.6296026720725155`*^9}, {3.629602819991993*^9, 
   3.629602824448001*^9}, {3.629605598839726*^9, 3.629605607327141*^9}, {
   3.6296058220871186`*^9, 3.62960582882633*^9}, {3.6296063832065477`*^9, 
   3.629606402387883*^9}, {3.629606538604329*^9, 3.6296066163905716`*^9}, {
   3.629606677993684*^9, 3.629606687579601*^9}, {3.6296068047490234`*^9, 
   3.629606830226368*^9}, 3.6296068624429245`*^9, {3.6296068979092875`*^9, 
   3.6296069681300106`*^9}, {3.629609076756136*^9, 3.6296091040088844`*^9}, {
   3.6296099141079187`*^9, 3.6296099316810493`*^9}, {3.6296100423732443`*^9, 
   3.629610095608038*^9}, {3.6296101382529125`*^9, 3.6296102324377785`*^9}, {
   3.629610465776189*^9, 3.6296105719830756`*^9}, {3.6296106080628395`*^9, 
   3.6296106195756593`*^9}, {3.629610656929625*^9, 3.629610732269657*^9}, {
   3.629610770130324*^9, 3.629610865268092*^9}, {3.629610900164753*^9, 
   3.6296109467227354`*^9}, {3.62961103488599*^9, 3.629611035478791*^9}, {
   3.62961131996777*^9, 3.629611351764426*^9}, {3.6296113965317063`*^9, 
   3.629611407320126*^9}, {3.629611650866873*^9, 3.629611658370486*^9}, {
   3.629611693028248*^9, 3.629611725211104*^9}, {3.629660344681587*^9, 
   3.629660396816783*^9}, {3.629662054116185*^9, 3.629662109498183*^9}, {
   3.629662485797946*^9, 3.629662506233982*^9}, {3.6296627377648115`*^9, 
   3.629662875565055*^9}, {3.629663059835583*^9, 3.6296630605400844`*^9}, {
   3.629663213456155*^9, 3.6296632447274103`*^9}, {3.62966339066107*^9, 
   3.629663505423672*^9}, {3.629663629963293*^9, 3.62966374139069*^9}, 
   3.6296637790073557`*^9, {3.6296639427647448`*^9, 3.62966405344954*^9}, {
   3.629664258753003*^9, 3.6296642835833473`*^9}, {3.629664357640478*^9, 
   3.629664406652266*^9}, {3.6296644497627425`*^9, 3.6296644754010878`*^9}, {
   3.6296645845515814`*^9, 3.629664754351282*^9}, {3.6296648207714*^9, 
   3.6296648719226904`*^9}, {3.6296649072767525`*^9, 3.629665007539429*^9}, {
   3.629665128176044*^9, 3.629665131155649*^9}, {3.629665198002467*^9, 
   3.629665208579286*^9}, {3.629665989873558*^9, 3.6296660606365824`*^9}, {
   3.629666240755704*^9, 3.629666248087716*^9}, {3.629680463417473*^9, 
   3.629680463611674*^9}, {3.6296839559917583`*^9, 3.629684004376444*^9}, {
   3.629684359598235*^9, 3.6296844225402164`*^9}, {3.629697473161625*^9, 
   3.6296975310175266`*^9}, {3.6296984575100627`*^9, 
   3.6296984799167023`*^9}, {3.629698536527603*^9, 3.6296985539120336`*^9}, {
   3.6297029070413284`*^9, 3.629702918063344*^9}, {3.629702984562439*^9, 
   3.629702988605445*^9}, {3.6297038644319816`*^9, 3.629703884097009*^9}, 
   3.6297039422184496`*^9, {3.629704987754769*^9, 3.6297050664593077`*^9}, {
   3.6297051249286375`*^9, 3.6297051564516935`*^9}, {3.6297051944125605`*^9, 
   3.6297052523000636`*^9}, {3.6297052825731173`*^9, 
   3.6297053031671534`*^9}, {3.629705388300189*^9, 3.62970538895539*^9}, {
   3.62972916921355*^9, 3.6297291763503666`*^9}, {3.6297292561692886`*^9, 
   3.629729263599902*^9}, {3.629761051728472*^9, 3.629761065720507*^9}, {
   3.629829049363864*^9, 3.629829080818822*^9}, {3.629832420822437*^9, 
   3.629832422351239*^9}, {3.629833134540451*^9, 3.629833156760482*^9}, {
   3.629841550046672*^9, 3.62984155467428*^9}, {3.6298419857146883`*^9, 
   3.6298419986509113`*^9}, {3.629842327687729*^9, 3.6298423483446655`*^9}, {
   3.6298424340556164`*^9, 3.6298424347651176`*^9}, {3.629857562453469*^9, 
   3.6298575752992034`*^9}, {3.6298617363544903`*^9, 3.629861743498315*^9}, {
   3.629861792832088*^9, 3.629861797965208*^9}, {3.6298621478116827`*^9, 
   3.6298621703399477`*^9}, {3.629862224692195*^9, 3.6298622386228337`*^9}, {
   3.629934024806528*^9, 3.6299340705926085`*^9}, {3.629935785029563*^9, 
   3.6299358234439325`*^9}, {3.630093833832834*^9, 3.630093925755106*^9}, {
   3.6303312112935457`*^9, 3.6303312550516224`*^9}, {3.6303358993921537`*^9, 
   3.6303359226755953`*^9}, {3.6306356399709835`*^9, 
   3.6306356458927946`*^9}, {3.630636068179586*^9, 3.6306361110125637`*^9}, {
   3.6306361560057445`*^9, 3.630636184065894*^9}, {3.630636235447586*^9, 
   3.630636267952746*^9}, {3.63063630275181*^9, 3.6306363664175234`*^9}, {
   3.6306364437215614`*^9, 3.6306365062241726`*^9}, {3.630636538221331*^9, 
   3.630636557862567*^9}, {3.630636607219159*^9, 3.6306366182246785`*^9}, {
   3.6306367049124327`*^9, 3.6306367069872365`*^9}, {3.6306367739863553`*^9, 
   3.6306368265585485`*^9}, {3.6306368669329214`*^9, 
   3.6306368850077534`*^9}, {3.6306369704707117`*^9, 
   3.6306369715340137`*^9}, {3.6306370050048733`*^9, 3.6306370121403866`*^9}, 
   3.6306370476386495`*^9, {3.6306371345330048`*^9, 3.6306371389166126`*^9}, {
   3.6306372376894894`*^9, 3.6306372761020594`*^9}, {3.6306374107348022`*^9, 
   3.6306374177860146`*^9}, {3.6306374703665094`*^9, 
   3.6306376025850487`*^9}, {3.6306376480269303`*^9, 
   3.6306376569389467`*^9}, {3.630637688572405*^9, 3.6306377047228336`*^9}, {
   3.630638005103675*^9, 3.63063803012432*^9}, {3.630638132477803*^9, 
   3.6306381742124786`*^9}, {3.630638443344762*^9, 3.6306384548725824`*^9}, {
   3.630693969338559*^9, 3.6306940821519747`*^9}, {3.630694494199352*^9, 
   3.6306945206800165`*^9}, {3.63069542859525*^9, 3.6306954292512627`*^9}, {
   3.630695677045081*^9, 3.6306957023971386`*^9}, {3.63069573859525*^9, 
   3.6306958461515474`*^9}, {3.6306960563359995`*^9, 3.630696315629788*^9}, {
   3.630696895134617*^9, 3.6306969769772644`*^9}, {3.6306970092793493`*^9, 
   3.630697023245936*^9}, {3.6306970610093985`*^9, 3.6306971134507113`*^9}, {
   3.63069721480139*^9, 3.6306972323263006`*^9}, {3.671909193986844*^9, 
   3.6719092176573935`*^9}, {3.6720740087360315`*^9, 3.672074075534852*^9}, {
   3.672074987021986*^9, 3.672074999122678*^9}, {3.6720750949751606`*^9, 
   3.672075105894785*^9}, {3.672075159332842*^9, 3.672075169396417*^9}, {
   3.6720752377493267`*^9, 3.6720752607176404`*^9}, {3.6720828553884125`*^9, 
   3.6720828660860767`*^9}, {3.6720828971890545`*^9, 
   3.6720829003941035`*^9}, {3.8262358604865246`*^9, 
   3.8262358608389063`*^9}, {3.8262359183019056`*^9, 
   3.8262359185427027`*^9}, {3.8365150275588408`*^9, 
   3.8365150507492037`*^9}, {3.836515245108944*^9, 3.8365153930392113`*^9}, 
   3.8365154381289167`*^9, {3.8365155720588017`*^9, 3.8365156095288286`*^9}, {
   3.8365156823688655`*^9, 3.8365157001690054`*^9}, {3.8365159170689583`*^9, 
   3.836515921233824*^9}, 3.8365165030823064`*^9, {3.836516795034235*^9, 
   3.836516817415293*^9}, {3.8365168529003077`*^9, 3.83651688141634*^9}, {
   3.8365169617025023`*^9, 3.836516984785651*^9}, {3.8365170845064473`*^9, 
   3.8365173153855686`*^9}, {3.83651761500602*^9, 3.8365176366267977`*^9}, {
   3.836517826859807*^9, 3.836517963886343*^9}, {3.8365179991860795`*^9, 
   3.8365180311134453`*^9}, {3.836518063708222*^9, 3.836518186174382*^9}, {
   3.8365182972198324`*^9, 3.836518325075186*^9}, 3.8365183923036757`*^9, {
   3.8365186140992365`*^9, 3.836518636830546*^9}, {3.83651913895794*^9, 
   3.836519174503744*^9}, {3.836519340162985*^9, 3.8365193437554083`*^9}, {
   3.836519733430002*^9, 3.836519737357012*^9}, 3.8365198639242077`*^9, 
   3.836519914313467*^9, 3.836527600174177*^9, 3.8365285238024883`*^9, {
   3.8365287836708336`*^9, 3.8365287950993757`*^9}, {3.836528984248169*^9, 
   3.8365289861581697`*^9}, 3.837499534541447*^9, {3.837499601697709*^9, 
   3.837499616525835*^9}, {3.837499646775832*^9, 3.8374996782149844`*^9}, {
   3.837499727308753*^9, 3.83749972941812*^9}, {3.837499764386859*^9, 
   3.837499780543131*^9}, 3.8375003058890777`*^9, {3.8375009668794236`*^9, 
   3.837500968113796*^9}, {3.846031687562609*^9, 3.8460317040663166`*^9}, {
   3.8460318655619345`*^9, 3.846031870389908*^9}, {3.8460319555754375`*^9, 
   3.8460320563093023`*^9}, {3.84603212927774*^9, 3.84603215947159*^9}, {
   3.846032253115411*^9, 3.8460322559550915`*^9}, 3.8472451727531757`*^9, 
   3.847245237997714*^9, {3.8472454968177752`*^9, 3.84724550650664*^9}, {
   3.847245619876923*^9, 3.8472456229236784`*^9}, 3.8472456829236927`*^9, 
   3.847772314831476*^9, {3.8477723561016693`*^9, 3.847772361073612*^9}, 
   3.847772403511515*^9, {3.8477937114574594`*^9, 3.8477937186663227`*^9}, {
   3.84779460846754*^9, 3.8477946190063505`*^9}, 3.8478339500281925`*^9, {
   3.847834029899483*^9, 3.8478341250176616`*^9}, 3.8478345704838595`*^9, {
   3.8478346049132657`*^9, 3.847834638506363*^9}, 3.8478357123347893`*^9, {
   3.847838149780706*^9, 3.847838165232731*^9}, {3.847838328175954*^9, 
   3.8478383489427657`*^9}, {3.8489975869366035`*^9, 3.848997632780204*^9}, {
   3.8489978434514723`*^9, 3.848997859618456*^9}, {3.8532180985290766`*^9, 
   3.8532181013589973`*^9}, {3.8532181564283133`*^9, 3.853218158538715*^9}, 
   3.853218308947239*^9, {3.853218507786126*^9, 3.8532185251855364`*^9}, 
   3.853218588555437*^9, {3.860066278727498*^9, 3.8600662980715694`*^9}, 
   3.860066371251645*^9, {3.860578071860258*^9, 3.8605781001533947`*^9}, {
   3.8611442712014313`*^9, 3.8611443110513754`*^9}, {3.861144389161501*^9, 
   3.861144394624101*^9}, 3.8611444803815823`*^9, {3.8611445180216103`*^9, 
   3.861144518991531*^9}, {3.866763147694089*^9, 3.8667631628319864`*^9}, {
   3.8667632455889463`*^9, 3.866763247008811*^9}, 3.8667632928254957`*^9, {
   3.8667633284878473`*^9, 3.8667633716236153`*^9}, {3.8667634181521397`*^9, 
   3.866763426645866*^9}, {3.866763460366863*^9, 3.866763518803314*^9}, {
   3.8667637080895348`*^9, 3.8667637569204636`*^9}, {3.8667637983436203`*^9, 
   3.8667638015055237`*^9}, {3.8667638577445316`*^9, 
   3.8667639111104307`*^9}, {3.866764016828268*^9, 3.866764018251977*^9}, {
   3.866764068531627*^9, 3.866764071630863*^9}, {3.8667642452254415`*^9, 
   3.866764286304215*^9}, {3.8667643260909863`*^9, 3.8667643379754086`*^9}, 
   3.866764390921748*^9, 3.8667644752599688`*^9, {3.866764513520646*^9, 
   3.866764555527948*^9}, {3.8667646306058965`*^9, 3.866764654087795*^9}, {
   3.8667646888963704`*^9, 3.8667647021122246`*^9}, {3.866764738165637*^9, 
   3.8667648053976803`*^9}, {3.8667718408811545`*^9, 3.866771858091778*^9}, {
   3.866771959716087*^9, 3.8667719627644544`*^9}, {3.866772047576489*^9, 
   3.8667720762554307`*^9}, {3.867319482387926*^9, 3.8673195357927704`*^9}, {
   3.868519640828643*^9, 3.868519642469198*^9}, {3.868581794490655*^9, 
   3.8685817958768296`*^9}, 3.8732519294832687`*^9, {3.874537141432888*^9, 
   3.874537239662412*^9}, {3.874537350333072*^9, 3.8745373802238073`*^9}, {
   3.874537428144106*^9, 3.87453746357551*^9}, 3.8750931644036765`*^9, 
   3.875093257698656*^9, 3.8750933143877463`*^9, {3.875093475216889*^9, 
   3.875093482586351*^9}, {3.875093858313075*^9, 3.8750938768686485`*^9}, {
   3.8750939389064503`*^9, 3.875093973253297*^9}, 3.875096911489003*^9, 
   3.8751015560178933`*^9, {3.8752335248915634`*^9, 3.8752335259383793`*^9}, {
   3.8752335577468696`*^9, 3.875233623046691*^9}, {3.8752492429347095`*^9, 
   3.8752492715238247`*^9}, {3.875249316128373*^9, 3.875249329647545*^9}, {
   3.875249683252559*^9, 3.87524973904854*^9}, {3.875753225474447*^9, 
   3.8757533225213256`*^9}, {3.875753380940504*^9, 3.875753460726071*^9}, {
   3.875753611330094*^9, 3.8757536689287367`*^9}, {3.875759022047869*^9, 
   3.875759031222004*^9}, 3.88538386145723*^9, {3.885384182232299*^9, 
   3.8853841890960684`*^9}, {3.8853844287802553`*^9, 3.8853844324999638`*^9}, 
   3.8853845082291555`*^9, {3.8853849948706803`*^9, 3.8853850081526856`*^9}, 
   3.885385064737802*^9, 3.8853851073375416`*^9, {3.885387437069361*^9, 
   3.885387491034937*^9}, {3.885389350602725*^9, 3.885389362418072*^9}, {
   3.885436947160122*^9, 3.8854369494537473`*^9}, {3.885437023440462*^9, 
   3.8854370288536463`*^9}, {3.885958919011883*^9, 3.885958931597186*^9}, {
   3.885963916821184*^9, 3.88596395156194*^9}, {3.8859641005379796`*^9, 
   3.8859641263227773`*^9}, {3.8860390119411955`*^9, 
   3.8860390158598003`*^9}, {3.886039058346332*^9, 3.8860390585182285`*^9}, {
   3.8860390900679684`*^9, 3.8860391123380294`*^9}, {3.8860391462779865`*^9, 
   3.8860391840370646`*^9}, {3.8955547739442673`*^9, 
   3.8955547739932375`*^9}, {3.955682391465823*^9, 3.955682391466449*^9}, {
   3.955682445842976*^9, 3.9556824481801767`*^9}, {3.959930869245891*^9, 
   3.959930872573674*^9}, {3.959930991815052*^9, 3.959930991821287*^9}, {
   3.967777451688222*^9, 3.967777451725849*^9}, {3.975309192905257*^9, 
   3.975309323930902*^9}, {3.975309369711446*^9, 
   3.9753093930600758`*^9}},ExpressionUUID->"a2d8608e-d483-43a5-abfa-\
b2ddb2badaa8"]
}, Closed]],

Cell[CellGroupData[{

Cell["TensorWedge", "Subsubsection",
 CellChangeTimes->{{3.8715535411617823`*^9, 
  3.87155355517332*^9}},ExpressionUUID->"4f587374-e443-482e-8a24-\
a68a8ad56bd9"],

Cell[BoxData[
 RowBox[{"Tensor", "/:", 
  RowBox[{
   RowBox[{"TensorWedge", "[", 
    RowBox[{
     RowBox[{"t1_Tensor", "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"RankNumber", "[", "t1", "]"}], ">", "0"}], ")"}]}], ",", 
     RowBox[{"t2_Tensor", "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"RankNumber", "[", "t2", "]"}], ">", "0"}], ")"}]}]}], "]"}], 
   "/;", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"TestFormVectorIndices", "[", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Indices", "[", "t1", "]"}], ",", 
         RowBox[{"Indices", "[", "t2", "]"}]}], "]"}], "]"}], ")"}], "&&", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Coordinates", "[", "t1", "]"}], "===", 
       RowBox[{"Coordinates", "[", "t2", "]"}]}], ")"}]}], ")"}]}], ":=", 
  RowBox[{"t1", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Indices", "\[Rule]", "idx_"}], ")"}], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"Indices", "\[Rule]", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Indices", "[", "t1", "]"}], ",", 
          RowBox[{"Indices", "[", "t2", "]"}]}], "]"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"TensorComponents", "\[Rule]", "tc_"}], ")"}], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"TensorComponents", "\[Rule]", 
        RowBox[{"Normal", "[", 
         RowBox[{
          RowBox[{"TensorComponents", "[", "t1", "]"}], "\[TensorWedge]", 
          RowBox[{"TensorComponents", "[", "t2", "]"}]}], "]"}]}], ")"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"TensorName", "\[Rule]", "tn_"}], ")"}], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"TensorName", "\[Rule]", 
        RowBox[{"TensorWedge", "[", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"TensorName", "[", "#", "]"}], "&"}], "/@", 
            RowBox[{"{", 
             RowBox[{"t1", ",", "t2"}], "}"}]}], ")"}]}], "]"}]}], ")"}]}]}], 
    "}"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.871554255499343*^9, 3.87155434521754*^9}, {
   3.87155439323206*^9, 3.871554423173257*^9}, {3.87155455760633*^9, 
   3.8715545616406183`*^9}, {3.8715546222186184`*^9, 3.871554680876766*^9}, {
   3.871555070965699*^9, 3.8715550724859266`*^9}, {3.871555233183864*^9, 
   3.8715552497168264`*^9}, {3.871601386597025*^9, 3.8716013971485424`*^9}, {
   3.8716090250540304`*^9, 3.871609050684745*^9}, {3.871609095947385*^9, 
   3.8716091439954653`*^9}, {3.8716092242515306`*^9, 3.8716092337083917`*^9}, 
   3.871609355947235*^9, {3.871610634645377*^9, 3.871610689161745*^9}, {
   3.8720450772033043`*^9, 3.8720451788353043`*^9}, 3.872045304828312*^9, {
   3.872045376036312*^9, 3.8720454277393103`*^9}, {3.872045464396305*^9, 
   3.8720454783063097`*^9}, {3.8720455960442867`*^9, 3.872045603900278*^9}, {
   3.8720459290272813`*^9, 3.8720460046272864`*^9}, {3.8721252515702796`*^9, 
   3.872125252249511*^9}, {3.872127484715887*^9, 3.872127518936771*^9}, {
   3.8721365645446777`*^9, 3.8721365738400064`*^9}, 3.872136752066078*^9, 
   3.872137200094269*^9, {3.8733298535294833`*^9, 3.8733298541248274`*^9}, {
   3.8757537416715617`*^9, 3.8757537794605656`*^9}, {3.875753820015767*^9, 
   3.8757538209532356`*^9}, {3.8901942269571238`*^9, 3.89019424962121*^9}, {
   3.8901945245761485`*^9, 3.8901945279280853`*^9}, {3.8901946174161882`*^9, 
   3.8901946253668795`*^9}, {3.895555772607154*^9, 3.8955557741745043`*^9}, {
   3.9561933844428062`*^9, 3.9561934087437067`*^9}, 3.9561978569224873`*^9, 
   3.956794321521593*^9, {3.960511906482492*^9, 3.96051190648354*^9}, {
   3.973765519747345*^9, 3.9737655197482653`*^9}, {3.9753095107961197`*^9, 
   3.9753095301362877`*^9}},ExpressionUUID->"79feeefb-52be-427f-9713-\
1a81e1d0c3a2"]
}, Closed]],

Cell[CellGroupData[{

Cell["SymmetrizedArray", "Subsubsection",
 CellChangeTimes->{{3.8745352300428543`*^9, 
  3.874535234670026*^9}},ExpressionUUID->"144b4830-8fee-44b7-8263-\
a050478e3b14"],

Cell[BoxData[
 RowBox[{"Tensor", "/:", 
  RowBox[{"SymmetrizedArray", "[", "t_Tensor", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"output", ",", "newts", ",", "tc", ",", "sa"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tc", "=", 
      RowBox[{"TensorComponents", "[", "t", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sa", "=", 
      RowBox[{"SymmetrizedArray", "[", "tc", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"t", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"TensorComponents", "\[Rule]", "xxx___"}], ")"}], "\[Rule]", 
         RowBox[{"(", 
          RowBox[{"TensorComponents", "\[Rule]", "sa"}], ")"}]}], "}"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"newts", "=", 
      RowBox[{"TensorSymmetry", "[", "sa", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"t", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorSymmetry", "\[Rule]", "ts_"}], ")"}], "\[Rule]", 
            "ts"}]}], "]"}], "===", 
         RowBox[{"{", "}"}]}], ")"}], ",", 
       RowBox[{"Append", "[", 
        RowBox[{"output", ",", 
         RowBox[{"TensorSymmetry", "\[Rule]", "newts"}]}], "]"}], ",", "True",
        ",", 
       RowBox[{"output", "/.", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"TensorSymmetry", "\[Rule]", "oldts_"}], ")"}], "\[Rule]", 
         RowBox[{"(", 
          RowBox[{"TensorSymmetry", "\[Rule]", "newts"}], ")"}]}]}]}], 
      "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8745352453825326`*^9, 3.874535301851828*^9}, {
   3.8745354706253147`*^9, 3.8745354966414146`*^9}, {3.874535765600994*^9, 
   3.8745357947049265`*^9}, {3.8745358487609825`*^9, 
   3.8745359323289165`*^9}, {3.874536007008989*^9, 3.874536055464908*^9}, 
   3.8745361353941855`*^9, {3.874536371000757*^9, 3.874536393112314*^9}, {
   3.874537245540819*^9, 3.874537245854628*^9}, {3.9753095384480658`*^9, 
   3.9753095393706713`*^9}},ExpressionUUID->"adf3d5e7-382b-45db-8489-\
dc31b7bb2318"]
}, Closed]],

Cell[CellGroupData[{

Cell["TensorComponents", "Subsubsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.533880012946951*^9, 3.5338800148345547`*^9}, {
   3.6064499663461447`*^9, 3.606449970874403*^9}, {3.6719161950603175`*^9, 
   3.6719162069379997`*^9}, {3.6720177824038334`*^9, 
   3.672017782669034*^9}},ExpressionUUID->"703c590b-c2fa-432e-9327-\
0051b74354d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TensorComponentsNoPart", "[", 
    RowBox[{"m_", "/;", 
     RowBox[{"TestExpressionForm", "[", "m", "]"}]}], "]"}], ":=", 
   RowBox[{"{", "m", "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.89507240671309*^9, 3.8950724291978345`*^9}, {
   3.8950749272174034`*^9, 3.895074930732938*^9}, {3.895075257902565*^9, 
   3.8950752581369114`*^9}, 3.895547707077297*^9, {3.895555838030388*^9, 
   3.8955558380343843`*^9}, {3.96045714948927*^9, 3.9604571547180862`*^9}, {
   3.960457209450288*^9, 3.9604572119988413`*^9}, {3.9753095772654257`*^9, 
   3.9753095813712263`*^9}},ExpressionUUID->"f0463e5c-46ae-45fb-9c45-\
47b88f73699a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Coordinates", "Subsubsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.533880012946951*^9, 
   3.5338800148345547`*^9}},ExpressionUUID->"afc02d37-1a20-42d1-8887-\
b5233f42effe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Coordinates", "[", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"t_Tensor", "|", "t_List"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"t", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a_", "\[Rule]", " ", "b_"}], ")"}], ":>", " ", 
           RowBox[{"(", 
            RowBox[{"a", "\[Rule]", " ", "b"}], ")"}]}], ",", 
          RowBox[{"{", "1", "}"}]}], "]"}], "=!=", 
        RowBox[{"{", "}"}]}], ")"}]}], ")"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"t", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Coordinates", "\[Rule]", "output_"}], ")"}], ":>", 
       "output"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CoordinatesNoPart", "[", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"t_Tensor", "|", "t_List"}], "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"t", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"a_", "\[Rule]", " ", "b_"}], ")"}], ":>", "  ", 
          RowBox[{"(", 
           RowBox[{"a", "\[Rule]", " ", "b"}], ")"}]}], ",", 
         RowBox[{"{", "1", "}"}]}], "]"}], "=!=", 
       RowBox[{"{", "}"}]}], ")"}]}], ")"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "mmm", "}"}], ",", 
    RowBox[{"Cases", "[", 
     RowBox[{"t", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Coordinates", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", "mmm"}],
       ",", "1"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Coordinates", "[", 
   RowBox[{"t_Tensor", ",", "coords_List"}], "]"}], ":=", 
  RowBox[{"t", "/.", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Coordinates", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", 
    RowBox[{"(", 
     RowBox[{"Coordinates", "\[Rule]", "coords"}], ")"}]}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.6698433615844946`*^9, 
   3.6698433880800104`*^9}, {3.669843474192936*^9, 3.6698434754330063`*^9}, {
   3.6698435353114314`*^9, 3.6698435357544565`*^9}, {3.875743971743964*^9, 
   3.8757439829660597`*^9}, {3.875747614296013*^9, 3.875747654883006*^9}, 
   3.8757477023229423`*^9, {3.8757479909925957`*^9, 3.875747991258222*^9}, {
   3.875752777800908*^9, 3.875752785114856*^9}, {3.8757602068070116`*^9, 
   3.8757602189517016`*^9}, {3.8861130176660748`*^9, 3.886113041948106*^9}, {
   3.8901990429958506`*^9, 3.8901990690527115`*^9}, 3.8950713769890904`*^9, {
   3.895555838066365*^9, 3.895555838071362*^9}, {3.9609344198014383`*^9, 
   3.9609344226406927`*^9}, {3.960936486317316*^9, 3.960936516195539*^9}, 
   3.9609403061691637`*^9, {3.967777451738639*^9, 3.967777451745695*^9}, {
   3.975309631896246*^9, 
   3.975309646989799*^9}},ExpressionUUID->"835e3df6-d88f-4a15-96ec-\
a1877aacb2a8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Indices", "Subsubsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.533880012946951*^9, 3.5338800148345547`*^9}, {
   3.606329216258676*^9, 3.6063292218312616`*^9}, 
   3.606497441942197*^9},ExpressionUUID->"4066e9c4-6855-4c5e-b8c7-\
c1fa83be599e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Indices", "[", "stuff_", "]"}], "/;", 
   RowBox[{"(", 
    RowBox[{"(*", 
     RowBox[{"Scalar", " ", 
      StyleBox["Expression",
       FontColor->RGBColor[1, 0, 1]], 
      StyleBox[" ",
       FontColor->RGBColor[1, 0, 1]], 
      StyleBox["Form",
       FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
    RowBox[{"TestExpressionForm", "[", "stuff", "]"}], ")"}]}], ":=", 
  RowBox[{"{", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IndicesNoPart", "[", "stuff_", "]"}], "/;", 
   RowBox[{"(", 
    RowBox[{"(*", 
     RowBox[{"Scalar", " ", 
      StyleBox["Expression",
       FontColor->RGBColor[1, 0, 1]], 
      StyleBox[" ",
       FontColor->RGBColor[1, 0, 1]], 
      StyleBox["Form",
       FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
    RowBox[{"TestExpressionForm", "[", "stuff", "]"}], ")"}]}], ":=", 
  RowBox[{"{", 
   RowBox[{"{", "}"}], "}"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.6063292322449217`*^9, 
   3.606329256638296*^9}, {3.6064974490496035`*^9, 3.6064974614663134`*^9}, {
   3.869045786004552*^9, 3.869045818873536*^9}, 3.8691008170883627`*^9, {
   3.8692874769265437`*^9, 3.8692874941040273`*^9}, {3.875743935792083*^9, 
   3.8757439420562305`*^9}, {3.875747719805605*^9, 3.875747728761551*^9}, {
   3.8757479746635723`*^9, 3.8757479803995376`*^9}, {3.8757527369863043`*^9, 
   3.875752752897251*^9}, {3.875760120552158*^9, 3.87576013266424*^9}, {
   3.8765435500809064`*^9, 3.8765435690752225`*^9}, {3.88603753230795*^9, 
   3.886037539998308*^9}, {3.8860454563612833`*^9, 3.8860454843691874`*^9}, {
   3.8860456652277884`*^9, 3.886045669354272*^9}, 3.886045767178056*^9, {
   3.886110907124282*^9, 3.886110919621586*^9}, {3.8861109901008615`*^9, 
   3.8861109926922693`*^9}, 3.886111024269823*^9, {3.886111353058346*^9, 
   3.886111353457098*^9}, {3.8861129892768383`*^9, 3.8861129941408405`*^9}, {
   3.890198785749992*^9, 3.890198806766276*^9}, {3.8901988959038424`*^9, 
   3.890198934597074*^9}, {3.893289124060669*^9, 3.8932891240636663`*^9}, 
   3.8950713915556073`*^9, {3.8955553396523843`*^9, 3.895555339655382*^9}, {
   3.89555583807436*^9, 3.895555838080723*^9}, {3.897192287574514*^9, 
   3.8971922972495265`*^9}, {3.960457297332528*^9, 3.960457312032028*^9}, {
   3.960457411977598*^9, 3.9604574208028297`*^9}, {3.960940097436042*^9, 
   3.960940101125846*^9}, {3.975309667032593*^9, 3.975309675360304*^9}, {
   3.975309708004273*^9, 
   3.9753097202230787`*^9}},ExpressionUUID->"b3f00983-0f85-4982-a9d0-\
43b38e4a62f1"]
}, Closed]],

Cell[CellGroupData[{

Cell["TensorName", "Subsubsection",
 CellChangeTimes->{
  3.875746244359597*^9},ExpressionUUID->"b1347b2c-9378-472d-8d1f-\
d2969626c983"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TensorName", "[", "t_Tensor", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "mmm", "}"}], ",", 
     RowBox[{
      RowBox[{"Cases", "[", 
       RowBox[{"t", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"TensorName", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", 
         "mmm"}], ",", "1"}], "]"}], "\[LeftDoubleBracket]", "1", 
      "\[RightDoubleBracket]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TensorName", "[", 
    RowBox[{"stuff_", "/;", 
     RowBox[{"TestExpressionForm", "[", "stuff", "]"}]}], "]"}], ":=", 
   RowBox[{"ToString", "[", 
    RowBox[{"stuff", ",", "InputForm"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TensorNameNoPart", "[", 
    RowBox[{"stuff_", "/;", 
     RowBox[{"TestExpressionForm", "[", "stuff", "]"}]}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"ToString", "[", 
     RowBox[{"stuff", ",", "InputForm"}], "]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TensorName", "[", 
    RowBox[{"(", "t_List", ")"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"Apply", "[", 
      RowBox[{"TensorProduct", ",", 
       RowBox[{"t", "/.", 
        RowBox[{"{", 
         RowBox[{"ttt_Tensor", "\[RuleDelayed]", 
          RowBox[{"TensorName", "[", "ttt", "]"}]}], " ", "}"}]}]}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TensorName", "[", 
    RowBox[{"(", 
     RowBox[{"t_Times", "|", "t_Plus"}], ")"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"t", "/.", 
      RowBox[{"{", 
       RowBox[{"ttt_Tensor", "\[RuleDelayed]", 
        RowBox[{"TensorName", "[", "ttt", "]"}]}], " ", "}"}]}]}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.89555533966038*^9, {3.8955558380887175`*^9, 3.8955558380937147`*^9}, 
   3.9604578159779654`*^9, {3.960457879801241*^9, 3.960457882327676*^9}, {
   3.9609401996308203`*^9, 3.960940203496509*^9}, {3.975309739914151*^9, 
   3.975309760070455*^9}},ExpressionUUID->"bb0ea90d-c494-44be-a406-\
c9e0494f9712"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Operators\[CloseCurlyQuote] Rules", "Subsection",
 CellChangeTimes->{{3.8950681941601295`*^9, 
  3.8950682052275953`*^9}},ExpressionUUID->"f3f44c39-e189-4599-a024-\
fd5d7b9b5c7b"],

Cell[CellGroupData[{

Cell["OperatorNullList", "Subsubsection",
 CellChangeTimes->{3.8950725408048186`*^9, 
  3.89507338817723*^9},ExpressionUUID->"23ecd828-5ed8-439a-8735-8f25774e6733"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"OperatorNullList", "[", "a_", 
   RowBox[{"(*", 
    StyleBox[
     RowBox[{"Function", " ", "Name"}],
     FontColor->RGBColor[1, 0, 1]], "*)"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"x1___", ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"x2___", "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"{", "x2", "}"}], ",", "Tensor", ",", 
          RowBox[{"{", "1", "}"}]}], "]"}], "===", 
        RowBox[{"{", "}"}]}], ")"}]}]}], "]"}], ":=", 
   "1"}]}], "\[IndentingNewLine]", 
 RowBox[{"OperatorNullList", "[", "TensorsProduct", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorNullList", "[", "TensorComponents", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorNullList", "[", "ContractTensors", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.895073372902302*^9, 3.895073377324029*^9}, 
   3.895073612840896*^9, 3.8950743923250165`*^9, 3.895074849409528*^9, {
   3.966394066623859*^9, 3.966394067314742*^9}, {3.9663944245598383`*^9, 
   3.966394424728196*^9}, {3.975310016317548*^9, 
   3.975310016789607*^9}},ExpressionUUID->"8df9954d-80ca-4556-9487-\
8ff41072a942"]
}, Closed]],

Cell[CellGroupData[{

Cell["OperatorDistributeOverPlus", "Subsubsection",
 CellChangeTimes->{{3.8950725408048186`*^9, 3.895072550695156*^9}, 
   3.895072594132703*^9},ExpressionUUID->"1aa6c251-39ee-4486-8824-\
260a86b5abeb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OperatorDistributeOverPlus", "[", "a_", 
    RowBox[{"(*", 
     StyleBox[
      RowBox[{"Function", " ", "Name"}],
      FontColor->RGBColor[1, 0, 1]], "*)"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"a", "[", 
     RowBox[{"x1___", ",", "t_Plus", ",", 
      RowBox[{"x2___", "/;", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"{", "x2", "}"}], ",", "Tensor", ",", 
           RowBox[{"{", "1", "}"}]}], "]"}], "===", 
         RowBox[{"{", "}"}]}], ")"}]}]}], "]"}], ":=", 
    RowBox[{"Apply", "[", 
     RowBox[{"Plus", ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "#", ",", "x2"}], "}"}]}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"Apply", "[", 
          RowBox[{"List", ",", "t"}], "]"}], ")"}]}], ")"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorDistributeOverPlus", "[", "TensorsProduct", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorDistributeOverPlus", "[", "TensorComponents", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OperatorDistributeOverPlus", "[", "PartialD", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OperatorDistributeOverPlus", "[", "CovariantD", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OperatorDistributeOverPlus", "[", "LieD", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OperatorDistributeOverPlus", "[", "LieBracket", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OperatorDistributeOverPlus", "[", "ExteriorD", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Unprotect", "[", "Conjugate", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OperatorDistributeOverPlus", "[", "Conjugate", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", "Conjugate", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorDistributeOverPlus", "[", "ContractTensors", 
  "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.895072551585758*^9, 3.8950725919921627`*^9, 3.8950736200685687`*^9, 
   3.8950744045288415`*^9, 3.895074850284481*^9, {3.895549279309618*^9, 
   3.8955492830710707`*^9}, {3.8984011733807507`*^9, 
   3.8984012091886573`*^9}, {3.8987524414261913`*^9, 
   3.8987524472555437`*^9}, {3.9663941188103867`*^9, 3.966394128208529*^9}, 
   3.966394184193727*^9, {3.966394430311639*^9, 3.966394430602577*^9}, 
   3.973765345165947*^9, {3.97531002537542*^9, 
   3.9753100259022303`*^9}},ExpressionUUID->"0ddf66b2-2c4f-46d3-a8b5-\
2c4366356ce4"]
}, Closed]],

Cell[CellGroupData[{

Cell["OperatorExpansion", "Subsubsection",
 CellChangeTimes->{{3.8950725408048186`*^9, 3.895072550695156*^9}, 
   3.895072626577613*^9},ExpressionUUID->"7c82a65f-04a3-4068-a8d3-\
46c810bf713b"],

Cell[BoxData[{
 RowBox[{"OperatorDistributeOverPlus", "[", "LT", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OperatorExpansion", "[", "a_", 
    RowBox[{"(*", 
     StyleBox[
      RowBox[{"Function", " ", "Name"}],
      FontColor->RGBColor[1, 0, 1]], "*)"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"x1___", ",", 
          RowBox[{"(", "t_Times", ")"}], ",", 
          RowBox[{"x2___", "/;", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", "x2", "}"}], ",", "Tensor", ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "===", 
             RowBox[{"{", "}"}]}], ")"}]}]}], "]"}], "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"List", ",", "t"}], "]"}], ",", 
            RowBox[{"Plus", "[", 
             RowBox[{
              RowBox[{"tt_", "/;", 
               RowBox[{"!", 
                RowBox[{"TestExpressionForm", "[", "tt", "]"}]}]}], ",", 
              "___"}], "]"}], ",", 
            RowBox[{"{", "1", "}"}]}], "]"}], "=!=", 
          RowBox[{"{", "}"}]}], ")"}]}], ":=", 
       RowBox[{"a", "[", 
        RowBox[{"x1", ",", 
         RowBox[{"Expand", "[", "t", "]"}], ",", "x2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"x1___", ",", 
          RowBox[{"(", 
           RowBox[{"t_List", "/;", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"t", "=!=", 
                RowBox[{"{", "}"}]}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cases", "[", 
                 RowBox[{"t", ",", "_Tensor", ",", "Infinity"}], "]"}], "=!=", 
                RowBox[{"{", "}"}]}], ")"}]}], ")"}]}], ")"}], ",", 
          RowBox[{"x2___", "/;", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", "x2", "}"}], ",", "Tensor", ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "===", 
             RowBox[{"{", "}"}]}], ")"}]}]}], "]"}], "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"t", ",", 
            RowBox[{"Plus", "[", 
             RowBox[{
              RowBox[{"tt_", "/;", 
               RowBox[{"!", 
                RowBox[{"TestExpressionForm", "[", "tt", "]"}]}]}], ",", 
              "___"}], "]"}], ",", 
            RowBox[{"{", "1", "}"}]}], "]"}], "=!=", 
          RowBox[{"{", "}"}]}], ")"}]}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"LTttt", ",", "output1"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LTttt", "=", 
           RowBox[{"Apply", "[", 
            RowBox[{"LT", ",", "t"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"output1", "=", 
           RowBox[{"a", "[", 
            RowBox[{"x1", ",", "LTttt", ",", "x2"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"output1", "=", 
           RowBox[{"output1", "/.", 
            RowBox[{"{", 
             RowBox[{"LT", "\[Rule]", " ", "List"}], "}"}]}]}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorExpansion", "[", "TensorsProduct", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorExpansion", "[", "TensorComponents", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorExpansion", "[", "ContractTensors", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorExpansion", "[", "LieD", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.895072551585758*^9, {3.8950726171829147`*^9, 3.8950726226871204`*^9}, 
   3.8950744056538095`*^9, 3.8950748514719505`*^9, {3.895555838150107*^9, 
   3.8955558381531043`*^9}, {3.966394170328322*^9, 3.966394170643565*^9}, {
   3.966394435039467*^9, 3.966394435228222*^9}, {3.97321230694265*^9, 
   3.973212307520606*^9}, 3.973765345166892*^9, {3.9753100364812098`*^9, 
   3.975310046992845*^9}},ExpressionUUID->"f48a2b94-e898-4e99-8e01-\
5f1f5164877b"]
}, Closed]],

Cell[CellGroupData[{

Cell["OperatorDistribute ", "Subsubsection",
 CellChangeTimes->{{3.8950725408048186`*^9, 3.895072550695156*^9}, 
   3.895072626577613*^9, 3.9712557643375196`*^9, 
   3.971256263312986*^9},ExpressionUUID->"0c2730b0-e45f-4feb-b070-\
5e3823f7f668"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OperatorDistribute", "[", "a_", 
     RowBox[{"(*", 
      StyleBox[
       RowBox[{"Function", " ", "Name"}],
       FontColor->RGBColor[1, 0, 1]], "*)"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"x1___", ",", 
        RowBox[{"(", "t_NonCommutativeMultiply", ")"}], ",", 
        RowBox[{"x2___", "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"{", "x2", "}"}], ",", "Tensor", ",", 
             RowBox[{"{", "1", "}"}]}], "]"}], "===", 
           RowBox[{"{", "}"}]}], ")"}]}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"Apply", "[", 
           RowBox[{"List", ",", "t"}], "]"}], ",", 
          RowBox[{"Plus", "[", 
           RowBox[{
            RowBox[{"tt_", "/;", 
             RowBox[{"!", 
              RowBox[{"TestExpressionForm", "[", "tt", "]"}]}]}], ",", 
            "___"}], "]"}], ",", 
          RowBox[{"{", "1", "}"}]}], "]"}], "=!=", 
        RowBox[{"{", "}"}]}], ")"}]}], ":=", 
     RowBox[{"a", "[", 
      RowBox[{"x1", ",", 
       RowBox[{"Distribute", "[", "t", "]"}], ",", "x2"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorDistribute", "[", "TensorsProduct", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorDistribute", "[", "TensorComponents", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorDistribute", "[", "ContractTensors", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.895072551585758*^9, {3.8950726171829147`*^9, 3.8950726226871204`*^9}, 
   3.8950744056538095`*^9, 3.8950748514719505`*^9, {3.895555838150107*^9, 
   3.8955558381531043`*^9}, {3.966394170328322*^9, 3.966394170643565*^9}, {
   3.966394435039467*^9, 3.966394435228222*^9}, 3.9712557619337053`*^9, {
   3.9712562297828693`*^9, 3.97125623250893*^9}, 3.9725432814463997`*^9, {
   3.975310051819447*^9, 3.975310057609543*^9}, 
   3.9753101700005207`*^9},ExpressionUUID->"cf5dea5a-7daa-458b-a7cd-\
311104b85b97"]
}, Closed]],

Cell[CellGroupData[{

Cell["OperatorFactorOutScalar", "Subsubsection",
 CellChangeTimes->{{3.8950725408048186`*^9, 3.895072550695156*^9}, 
   3.895072792222621*^9},ExpressionUUID->"8c83a780-d5bd-4f42-9a88-\
4a2610da6da9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OperatorFactorOutScalar", "[", 
    RowBox[{"a_", 
     RowBox[{"(*", 
      StyleBox[
       RowBox[{"Function", " ", "Name"}],
       FontColor->RGBColor[1, 0, 1]], "*)"}], ",", 
     RowBox[{"pos___", "/;", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", "pos", "}"}], "===", 
          RowBox[{"{", "}"}]}], ")"}], ",", "True", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"IntegerQ", "[", "pos", "]"}], "&&", 
          RowBox[{"(", 
           RowBox[{"pos", ">", "0"}], ")"}]}], ")"}]}], "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "t", "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{
          RowBox[{"x1___", "/;", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", "pos", "}"}], "===", 
               RowBox[{"{", "}"}]}], ")"}], ",", "True", ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"{", "x1", "}"}], "]"}], "===", 
               RowBox[{"(", 
                RowBox[{"pos", "-", "1"}], ")"}]}], ")"}]}], "]"}]}], ",", 
          RowBox[{"(", "t_Times", ")"}], ",", 
          RowBox[{"x2___", "/;", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", "x2", "}"}], ",", "Tensor", ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "===", 
             RowBox[{"{", "}"}]}], ")"}]}]}], "]"}], "/;", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"Apply", "[", 
              RowBox[{"List", ",", "t"}], "]"}], ",", 
             RowBox[{"Plus", "[", 
              RowBox[{
               RowBox[{"tt_", "/;", 
                RowBox[{"!", 
                 RowBox[{"TestExpressionForm", "[", "tt", "]"}]}]}], ",", 
               "___"}], "]"}], ",", 
             RowBox[{"{", "1", "}"}]}], "]"}], "===", 
           RowBox[{"{", "}"}]}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Union", "[", 
            RowBox[{"(", 
             RowBox[{"TestSingleTensorTensor", "/@", 
              RowBox[{"(", 
               RowBox[{"Apply", "[", 
                RowBox[{"List", ",", "t"}], "]"}], ")"}]}], ")"}], "]"}], "=!=", 
           RowBox[{"{", "True", "}"}]}], ")"}]}]}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "allTensors", ",", "scalarexpr", ",", "scalartensor", ",", 
           "FunctionOfScalarTensor", ",", 
           RowBox[{"Listmm", "=", 
            RowBox[{"(", 
             RowBox[{"Apply", "[", 
              RowBox[{"List", ",", "t"}], "]"}], ")"}]}], ",", 
           "FunctionOfTensorTensor"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"scalarexpr", "=", 
           RowBox[{"Cases", "[", 
            RowBox[{"Listmm", ",", 
             RowBox[{"(", 
              RowBox[{"se_", "/;", 
               RowBox[{"TestExpressionForm", "[", "se", "]"}]}], ")"}], ",", 
             RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"scalartensor", "=", 
           RowBox[{"Cases", "[", 
            RowBox[{"Listmm", ",", 
             RowBox[{"(", 
              RowBox[{"st_", "/;", 
               RowBox[{"TestScalarTensor", "[", "st", "]"}]}], ")"}], ",", 
             RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"FunctionOfScalarTensor", "=", 
           RowBox[{"Cases", "[", 
            RowBox[{"Listmm", ",", 
             RowBox[{"(", 
              RowBox[{"func_", "/;", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Head", "[", "func", "]"}], "=!=", "Tensor"}], 
                  ")"}], "&&", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Head", "[", "func", "]"}], "=!=", "Plus"}], ")"}],
                  "&&", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Head", "[", "func", "]"}], "=!=", "Times"}], 
                  ")"}], "&&", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"TestScalarTensor", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{"Cases", "[", 
                    RowBox[{"func", ",", "_Tensor", ",", "Infinity"}], 
                    "]"}]}], "]"}], "===", 
                   RowBox[{"{", "True", "}"}]}], ")"}]}], ")"}]}], ")"}], ",", 
             RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"FunctionOfTensorTensor", "=", 
           RowBox[{"Cases", "[", 
            RowBox[{"Listmm", ",", 
             RowBox[{"(", 
              RowBox[{"fott_", "/;", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Head", "[", "fott", "]"}], "=!=", "Tensor"}], 
                  ")"}], "&&", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Head", "[", "fott", "]"}], "=!=", "Plus"}], ")"}],
                  "&&", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Head", "[", "fott", "]"}], "=!=", "Times"}], 
                  ")"}], "&&", 
                 RowBox[{"!", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"TestScalarTensor", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{"Cases", "[", 
                    RowBox[{"fott", ",", "_Tensor", ",", "Infinity"}], 
                    "]"}]}], "]"}], "===", 
                    RowBox[{"{", "True", "}"}]}], ")"}]}], "&&", 
                 RowBox[{"!", 
                  RowBox[{"TestExpressionForm", "[", "fott", "]"}]}]}], 
                ")"}]}], ")"}], ",", 
             RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"allTensors", "=", 
           RowBox[{"Complement", "[", 
            RowBox[{
            "Listmm", ",", "scalarexpr", ",", "scalartensor", ",", 
             "FunctionOfScalarTensor", ",", "FunctionOfTensorTensor"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Times", "@@", "scalarexpr"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"TensorComponents", "[", "#", "]"}], "&"}], "/@", 
               "scalartensor"}], ")"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"TensorComponents", "[", "#", "]"}], "&"}], "/@", 
               "FunctionOfScalarTensor"}], ")"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"TensorComponents", "[", "#", "]"}], "&"}], "/@", 
               "FunctionOfTensorTensor"}], ")"}]}], ")"}], " ", 
           RowBox[{"a", "[", 
            RowBox[{"x1", ",", 
             RowBox[{"(", 
              RowBox[{"Times", "@@", "allTensors"}], ")"}], ",", "x2"}], 
            "]"}]}]}]}], "\[IndentingNewLine]", " ", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{
          RowBox[{"x1___", "/;", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", "pos", "}"}], "===", 
               RowBox[{"{", "}"}]}], ")"}], ",", "True", ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"{", "x1", "}"}], "]"}], "===", 
               RowBox[{"(", 
                RowBox[{"pos", "-", "1"}], ")"}]}], ")"}]}], "]"}]}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"t_List", "/;", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"t", "=!=", 
                  RowBox[{"{", "}"}]}], ")"}], "&&", 
                RowBox[{"(", 
                 RowBox[{"!", 
                  RowBox[{"MatchQ", "[", 
                   RowBox[{"t", ",", 
                    RowBox[{"{", 
                    RowBox[{"Repeated", "[", 
                    RowBox[{"Rule", "[", 
                    RowBox[{"_", ",", "_"}], "]"}], "]"}], "}"}]}], "]"}]}], 
                 ")"}]}], ")"}]}], ")"}], "|", "t_NonCommutativeMultiply"}], 
           ")"}], ",", 
          RowBox[{"x2___", "/;", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", "x2", "}"}], ",", "Tensor", ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "===", 
             RowBox[{"{", "}"}]}], ")"}]}]}], "]"}], "/;", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"t", ",", 
             RowBox[{"Plus", "[", 
              RowBox[{
               RowBox[{"tt_", "/;", 
                RowBox[{"!", 
                 RowBox[{"TestExpressionForm", "[", "tt", "]"}]}]}], ",", 
               "___"}], "]"}], ",", 
             RowBox[{"{", "1", "}"}]}], "]"}], "===", 
           RowBox[{"{", "}"}]}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"(", 
               RowBox[{"TestSingleTensorTensor", "/@", 
                RowBox[{"(", 
                 RowBox[{"Apply", "[", 
                  RowBox[{"List", ",", "t"}], "]"}], ")"}]}], ")"}], "]"}], "=!=", 
             RowBox[{"{", "True", "}"}]}], ")"}], "&&", 
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{"MatchQ", "[", 
              RowBox[{"t", ",", 
               RowBox[{"{", 
                RowBox[{"___", ",", 
                 RowBox[{"TensorsProduct", "[", 
                  RowBox[{"___", ",", "Tensor"}], "]"}], ",", "___"}], 
                "}"}]}], "]"}], ")"}]}]}], ")"}]}]}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "allTensors", ",", "scalarexpr", ",", "scalartensor", ",", 
           "FunctionOfScalarTensor", ",", "FunctionOfTensorTensor", ",", 
           "TimesScalarTensor", ",", "TimesScalarTensorR", ",", 
           "TimesScalarTensorTensor", ",", "TimesScalarTensorScalar"}], "}"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"scalarexpr", "=", 
           RowBox[{"Cases", "[", 
            RowBox[{"t", ",", 
             RowBox[{"(", 
              RowBox[{"se_", "/;", 
               RowBox[{"TestExpressionForm", "[", "se", "]"}]}], ")"}], ",", 
             RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"scalartensor", "=", 
           RowBox[{"Cases", "[", 
            RowBox[{"t", ",", 
             RowBox[{"(", 
              RowBox[{"st_", "/;", 
               RowBox[{"TestScalarTensor", "[", "st", "]"}]}], ")"}], ",", 
             RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"FunctionOfScalarTensor", "=", 
           RowBox[{"Cases", "[", 
            RowBox[{"t", ",", 
             RowBox[{"(", 
              RowBox[{"func_", "/;", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Head", "[", "func", "]"}], "=!=", "Tensor"}], 
                  ")"}], "&&", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Head", "[", "func", "]"}], "=!=", "Plus"}], ")"}],
                  "&&", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Head", "[", "func", "]"}], "=!=", 
                   "NonCommutativeMultiply"}], ")"}], "&&", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Head", "[", "func", "]"}], "=!=", "Times"}], 
                  ")"}], "&&", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"TestScalarTensor", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{"Cases", "[", 
                    RowBox[{"func", ",", "_Tensor", ",", "Infinity"}], 
                    "]"}]}], "]"}], "===", 
                   RowBox[{"{", "True", "}"}]}], ")"}]}], ")"}]}], ")"}], ",", 
             RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"FunctionOfTensorTensor", "=", 
           RowBox[{"Cases", "[", 
            RowBox[{"t", ",", 
             RowBox[{"(", 
              RowBox[{"fott_", "/;", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Head", "[", "fott", "]"}], "=!=", "Tensor"}], 
                  ")"}], "&&", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Head", "[", "fott", "]"}], "=!=", "Plus"}], ")"}],
                  "&&", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Head", "[", "fott", "]"}], "=!=", 
                   "NonCommutativeMultiply"}], ")"}], "&&", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Head", "[", "fott", "]"}], "=!=", "Times"}], 
                  ")"}], "&&", 
                 RowBox[{"!", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"TestScalarTensor", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{"Cases", "[", 
                    RowBox[{"fott", ",", "_Tensor", ",", "Infinity"}], 
                    "]"}]}], "]"}], "===", 
                    RowBox[{"{", "True", "}"}]}], ")"}]}], "&&", 
                 RowBox[{"!", 
                  RowBox[{"TestExpressionForm", "[", "fott", "]"}]}]}], 
                ")"}]}], ")"}], ",", 
             RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"allTensors", "=", 
           RowBox[{"Replace", "[", 
            RowBox[{"t", ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"#", "\[Rule]", " ", "Nothing"}], ")"}], "&"}], "/@",
                "scalarexpr"}], ")"}], ",", 
             RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"allTensors", "=", 
           RowBox[{"Replace", "[", 
            RowBox[{"allTensors", ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"#", "\[Rule]", " ", "Nothing"}], ")"}], "&"}], "/@",
                "scalartensor"}], ")"}], ",", 
             RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"allTensors", "=", 
           RowBox[{"Replace", "[", 
            RowBox[{"allTensors", ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"#", "\[Rule]", " ", "Nothing"}], ")"}], "&"}], "/@",
                "FunctionOfScalarTensor"}], ")"}], ",", 
             RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"allTensors", "=", 
           RowBox[{"Replace", "[", 
            RowBox[{"allTensors", ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"#", "\[Rule]", " ", "Nothing"}], ")"}], "&"}], "/@",
                "FunctionOfTensorTensor"}], ")"}], ",", 
             RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"TimesScalarTensor", "=", 
           RowBox[{"Cases", "[", 
            RowBox[{"allTensors", ",", 
             RowBox[{"(", 
              RowBox[{"_Times", "|", "_NonCommutativeMultiply"}], ")"}], ",", 
             RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"TimesScalarTensorTensor", "=", 
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Apply", "[", 
                 RowBox[{"List", ",", "#"}], "]"}], "&"}], "/@", 
               "TimesScalarTensor"}], ")"}], ",", 
             RowBox[{"(", 
              RowBox[{"tt_", "/;", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Head", "[", "tt", "]"}], "===", "Tensor"}], ")"}], 
                "&&", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"RankNumber", "[", "tt", "]"}], ">", "0"}], 
                 ")"}]}]}], ")"}], ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"TimesScalarTensorScalar", "=", 
           RowBox[{"Replace", "[", 
            RowBox[{
             RowBox[{"Apply", "[", 
              RowBox[{"List", ",", "TimesScalarTensor"}], "]"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"#", "\[Rule]", " ", "1"}], ")"}], "&"}], "/@", 
               "TimesScalarTensorTensor"}], ")"}], ",", "Infinity"}], "]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"TimesScalarTensorR", "=", 
           RowBox[{"Thread", "[", 
            RowBox[{"TimesScalarTensor", "->", "TimesScalarTensorTensor"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Times", "@@", "scalarexpr"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"TensorComponents", "[", "#", "]"}], "&"}], "/@", 
               "scalartensor"}], ")"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"TensorComponents", "[", "#", "]"}], "&"}], "/@", 
               "FunctionOfScalarTensor"}], ")"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"TensorComponents", "[", "#", "]"}], "&"}], "/@", 
               "FunctionOfTensorTensor"}], ")"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"TensorComponents", "[", "#", "]"}], "&"}], "/@", 
               "TimesScalarTensorScalar"}], ")"}]}], ")"}], 
           RowBox[{"a", "[", 
            RowBox[{"x1", ",", 
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"TimesScalarTensor", "===", 
                 RowBox[{"{", "}"}]}], ")"}], ",", "allTensors", ",", "True", 
               ",", 
               RowBox[{"Replace", "[", 
                RowBox[{"allTensors", ",", "TimesScalarTensorR", ",", 
                 RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}], ",", "x2"}], 
            "]"}]}]}]}], "\[IndentingNewLine]", " ", "]"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorFactorOutScalar", "[", 
  RowBox[{"TensorsProduct", ",", "1"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorFactorOutScalar", "[", 
  RowBox[{"TensorComponents", ",", "1"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorFactorOutScalar", "[", 
  RowBox[{"ContractTensors", ",", "1"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OperatorFactorOutScalar", "[", 
   RowBox[{"LieD", ",", "1"}], "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.895072551585758*^9, 3.895072783613448*^9, {3.8950744094199347`*^9, 
   3.895074423091793*^9}, {3.8950744882775497`*^9, 3.8950744912618465`*^9}, {
   3.8950745605477467`*^9, 3.8950745620477047`*^9}, 3.89507485225318*^9, {
   3.895555339697356*^9, 3.89555533974433*^9}, {3.8955558381610994`*^9, 
   3.895555838197076*^9}, 3.962876122522108*^9, 3.963394245531507*^9, {
   3.9633979529380217`*^9, 3.963397983931671*^9}, {3.964662758401065*^9, 
   3.964662759297387*^9}, {3.964662792795659*^9, 3.964662793468841*^9}, 
   3.964662840771742*^9, 3.964663568292816*^9, {3.964665376203339*^9, 
   3.96466540815668*^9}, {3.966394143369416*^9, 3.966394143722834*^9}, {
   3.966394441840702*^9, 3.966394442050806*^9}, {3.9677972768138227`*^9, 
   3.967797286967866*^9}, {3.9688911270148077`*^9, 3.968891164910574*^9}, 
   3.969260297365095*^9, {3.9692604275892143`*^9, 3.9692604287813063`*^9}, 
   3.971255834529921*^9, 3.971310373122322*^9, {3.971311104952854*^9, 
   3.971311120331414*^9}, {3.971311243880774*^9, 3.9713112948594427`*^9}, {
   3.971311328266922*^9, 3.9713113563895693`*^9}, 3.971311607599774*^9, 
   3.971312023886675*^9, 3.9713124800006733`*^9, 3.971313148496608*^9, 
   3.97131322809881*^9, 3.972612786195479*^9, 3.9726130618167057`*^9, 
   3.972616830991913*^9, {3.973212405607853*^9, 3.973212448477868*^9}, 
   3.973765345168648*^9, {3.975310200147839*^9, 
   3.9753103397183657`*^9}},ExpressionUUID->"2c93cd0b-eca5-4afe-839b-\
d6a84edb3bc6"]
}, Closed]],

Cell[CellGroupData[{

Cell["OperatorRemoveSingleComponentList", "Subsubsection",
 CellChangeTimes->{{3.8950725408048186`*^9, 3.895072550695156*^9}, 
   3.8950728029872255`*^9},ExpressionUUID->"93e1a582-cf2e-4df0-8776-\
723340952030"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OperatorRemoveSingleComponentList", "[", "a_", 
     RowBox[{"(*", 
      StyleBox[
       RowBox[{"Function", " ", "Name"}],
       FontColor->RGBColor[1, 0, 1]], "*)"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"x1___", ",", 
       RowBox[{"{", 
        RowBox[{"t_Tensor", "/;", 
         RowBox[{"(", 
          RowBox[{"t", "=!=", "Tensor"}], ")"}]}], "}"}], ",", 
       RowBox[{"x2___", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"{", "x2", "}"}], ",", "Tensor", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}], "===", 
          RowBox[{"{", "}"}]}], ")"}]}]}], "]"}], ":=", 
     RowBox[{"a", "[", 
      RowBox[{"x1", ",", "t", ",", "x2"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorRemoveSingleComponentList", "[", "TensorsProduct", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorRemoveSingleComponentList", "[", "TensorComponents", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorRemoveSingleComponentList", "[", "ContractTensors", 
  "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.895072551585758*^9, 3.8950728015341644`*^9, 3.895074563063302*^9, 
   3.895074852878163*^9, 3.895118706411739*^9, 3.895118789270382*^9, {
   3.9730519686334352`*^9, 3.9730519701069098`*^9}, {3.9753103471116858`*^9, 
   3.9753103475002737`*^9}},ExpressionUUID->"68673e80-1522-444a-8f48-\
9a4fcb952557"]
}, Closed]],

Cell[CellGroupData[{

Cell["OperatorThreadThroughFunction", "Subsubsection",
 CellChangeTimes->{{3.8950725408048186`*^9, 3.895072550695156*^9}, 
   3.8950728148585377`*^9},ExpressionUUID->"93ad3344-221c-47ed-8021-\
9301d3e0e3f8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OperatorThreadThroughFunction", "[", "a_", 
    RowBox[{"(*", 
     StyleBox[
      RowBox[{"Function", " ", "Name"}],
      FontColor->RGBColor[1, 0, 1]], "*)"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"a", "[", 
     RowBox[{
      RowBox[{"x1___", "/;", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x1", "===", "Null"}], ")"}], ",", "True", ",", "True", ",", 
         RowBox[{"TestExpressionForm", "[", "x1", "]"}]}], "]"}]}], ",", 
      RowBox[{"func_", "/;", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "func", "]"}], "=!=", 
           "NonCommutativeMultiply"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "func", "]"}], "=!=", "LT"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "func", "]"}], "=!=", "a"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "func", "]"}], "=!=", "List"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "func", "]"}], "=!=", "Tensor"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "func", "]"}], "=!=", "Plus"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "func", "]"}], "=!=", "Times"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Union", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"TestScalarTensor", "[", "#", "]"}], "&"}], "/@", 
             RowBox[{"Cases", "[", 
              RowBox[{"func", ",", "_Tensor", ",", "Infinity"}], "]"}]}], 
            "]"}], "===", 
           RowBox[{"{", "True", "}"}]}], ")"}]}], ")"}]}], ",", 
      RowBox[{"x2___", "/;", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"{", "x2", "}"}], ",", "Tensor", ",", 
             RowBox[{"{", "1", "}"}]}], "]"}], "===", 
           RowBox[{"{", "}"}]}], ")"}], "&&", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x2", "===", "Null"}], ")"}], ",", "True", ",", "True", 
           ",", 
           RowBox[{"TestExpressionForm", "[", "x2", "]"}]}], "]"}]}], 
        ")"}]}]}], "]"}], ":=", 
    RowBox[{"Replace", "[", 
     RowBox[{"func", ",", 
      RowBox[{
       RowBox[{"ContentWithTensor_", "/;", 
        RowBox[{"(", 
         RowBox[{"!", 
          RowBox[{"TestExpressionForm", "[", "ContentWithTensor", "]"}]}], 
         ")"}]}], "\[RuleDelayed]", 
       RowBox[{"a", "[", 
        RowBox[{"x1", ",", "ContentWithTensor", ",", "x2"}], "]"}]}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorThreadThroughFunction", "[", "TensorsProduct", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorThreadThroughFunction", "[", "TensorComponents", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorThreadThroughFunction", "[", "ContractTensors", 
  "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.895072551585758*^9, 3.8950728129679356`*^9, 3.895074563907031*^9, 
   3.895074853659416*^9, 3.8955553397493258`*^9, {3.9628417467771883`*^9, 
   3.962841771399557*^9}, {3.962841847477792*^9, 3.962841852546224*^9}, {
   3.962842036974763*^9, 3.9628420663526583`*^9}, {3.962842245700596*^9, 
   3.962842283779717*^9}, {3.962842338356119*^9, 3.962842379789719*^9}, {
   3.96339374024641*^9, 3.963393753934993*^9}, {3.963393959112524*^9, 
   3.963394018653913*^9}, {3.966394155112019*^9, 3.966394155393558*^9}, {
   3.966394487847548*^9, 3.966394488120489*^9}, 3.971250689418086*^9, 
   3.9712525725727386`*^9, 3.971253631109598*^9, {3.975310355404809*^9, 
   3.9753103706671124`*^9}},ExpressionUUID->"f4bf9519-da37-4584-8229-\
68da2fcbca6e"]
}, Closed]],

Cell[CellGroupData[{

Cell["OperatorTensorReturnItself", "Subsubsection",
 CellChangeTimes->{{3.8950725408048186`*^9, 3.895072550695156*^9}, 
   3.895072841836537*^9},ExpressionUUID->"10bafcd7-3513-408d-abb3-\
134089a6cebd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OperatorTensorReturnItself", "[", "a_", 
    RowBox[{"(*", 
     StyleBox[
      RowBox[{"Function", " ", "Name"}],
      FontColor->RGBColor[1, 0, 1]], "*)"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"a", "[", 
     RowBox[{"(", 
      RowBox[{"t_Tensor", "/;", 
       RowBox[{"(", 
        RowBox[{"t", "=!=", "Tensor"}], ")"}]}], ")"}], "]"}], ":=", "t"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorTensorReturnItself", "[", "TensorsProduct", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorTensorReturnItself", "[", "ContractTensors", 
  "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.895072551585758*^9, 3.895072840477172*^9, 3.8950745647038827`*^9, {
   3.966394291640202*^9, 3.9663942919851923`*^9}, {3.96639449211093*^9, 
   3.966394492524316*^9}, {3.975310376687563*^9, 
   3.975310385425165*^9}},ExpressionUUID->"4e371737-231c-4a4c-b82d-\
436fd001d52c"]
}, Closed]],

Cell[CellGroupData[{

Cell["OperatorExpressionFormReturnItself", "Subsubsection",
 CellChangeTimes->{{3.8950725408048186`*^9, 3.895072550695156*^9}, 
   3.895072851452937*^9},ExpressionUUID->"75ca5e59-f155-4b3b-a983-\
7ded1a3e689c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OperatorExpressionFormReturnItself", "[", "a_", 
    RowBox[{"(*", 
     StyleBox[
      RowBox[{"Function", " ", "Name"}],
      FontColor->RGBColor[1, 0, 1]], "*)"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"a", "[", 
     RowBox[{"(", 
      RowBox[{"t_", "/;", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"TestExpressionForm", "[", "t", "]"}], "&&", 
         RowBox[{"(", 
          RowBox[{"t", "=!=", "Tensor"}], ")"}]}], ")"}]}], ")"}], "]"}], ":=",
     "t"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorExpressionFormReturnItself", "[", "TensorsProduct", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorExpressionFormReturnItself", "[", "TensorComponents", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorExpressionFormReturnItself", "[", "ContractTensors", 
  "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.895072551585758*^9, 3.8950728499217014`*^9, 3.8950745658757544`*^9, 
   3.8950748543156476`*^9, 3.895555838200074*^9, {3.9628399271785088`*^9, 
   3.962839927715652*^9}, {3.966394218208222*^9, 3.966394218427511*^9}, {
   3.966394496937831*^9, 3.96639449720347*^9}, {3.975310392500087*^9, 
   3.9753104011182747`*^9}},ExpressionUUID->"f7074981-1802-4521-80a0-\
1bdf63318722"]
}, Closed]],

Cell[CellGroupData[{

Cell["OperatorTensorsProduct", "Subsubsection",
 CellChangeTimes->{{3.8950725408048186`*^9, 3.895072550695156*^9}, 
   3.8950728652731066`*^9, 
   3.895074567906929*^9},ExpressionUUID->"21366297-de70-431e-bb9a-\
44742026c5d0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OperatorTensorsProduct", "[", "a_", 
    RowBox[{"(*", 
     StyleBox[
      RowBox[{"Function", " ", "Name"}],
      FontColor->RGBColor[1, 0, 1]], "*)"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"a", "[", 
     RowBox[{"x1___", ",", 
      RowBox[{"(", 
       RowBox[{"t_Times", "|", 
        RowBox[{"(", 
         RowBox[{"t_List", "/;", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"t", "=!=", 
              RowBox[{"{", "}"}]}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{"t", ",", "_Tensor", ",", "Infinity"}], "]"}], "=!=", 
              RowBox[{"{", "}"}]}], ")"}], "&&", 
            RowBox[{"TestTensorsProduct", "[", "t", "]"}]}], ")"}]}], ")"}], 
        "|", "t_NonCommutativeMultiply"}], ")"}], ",", 
      RowBox[{"x2___", "/;", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"{", "x2", "}"}], ",", "Tensor", ",", 
           RowBox[{"{", "1", "}"}]}], "]"}], "===", 
         RowBox[{"{", "}"}]}], ")"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tensorproduct", ",", "allindices", ",", "tensornames", ",", 
        RowBox[{"listt", "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"List", ",", "t"}], "]"}]}], ",", "ii"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"perform", " ", "a", " ", "tensor", " ", "product"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tensorproduct", "=", 
        RowBox[{"TensorProduct", "[", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"(", 
           RowBox[{"TensorComponents", "/@", "listt"}], ")"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Join", " ", "all", " ", "indices", " ", "to", " ", "form", " ", 
         "index", " ", "structure", " ", "of", " ", "Tensor", " ", 
         "Product"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"allindices", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"(", 
           RowBox[{"Indices", "/@", "listt"}], ")"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Tensor", " ", "names"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"tensornames", "=", 
        RowBox[{"TensorName", "[", "listt", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "output", " ", "Tensor", " ", "will", " ", "inherit", " ", 
         "properties", " ", "of", " ", "the", " ", "first", " ", "Tensor"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"a", "[", 
        RowBox[{"x1", ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", "listt", ")"}], "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "/.", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorName", "\[Rule]", "xxx_"}], ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"TensorName", "\[Rule]", "tensornames"}], ")"}]}], ",",
              "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Indices", "\[Rule]", "xxx_"}], ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"Indices", "\[Rule]", "allindices"}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorComponents", "\[Rule]", "xxxxx_"}], ")"}], 
              "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"TensorComponents", "\[Rule]", "tensorproduct"}], 
               ")"}]}]}], "}"}]}], ")"}], ",", "x2"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorTensorsProduct", "[", "TensorsProduct", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorTensorsProduct", "[", "TensorComponents", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.895072551585758*^9, 3.8950728615232306`*^9, {3.8950745687506523`*^9, 
   3.895074576656689*^9}, 3.8950748550500026`*^9, 3.895555339757321*^9, {
   3.898406112540882*^9, 3.898406116567314*^9}, {3.898406147390956*^9, 
   3.8984061478767996`*^9}, {3.8984062078321314`*^9, 
   3.8984062152465277`*^9}, {3.898406254449374*^9, 3.898406261126567*^9}, {
   3.966394765899411*^9, 3.9663947991222887`*^9}, 3.971313458874462*^9, {
   3.975310408910078*^9, 
   3.975310444361106*^9}},ExpressionUUID->"5ee271bf-6c2a-458e-8e57-\
9e23e8a922f1"]
}, Closed]],

Cell[CellGroupData[{

Cell["OperatorContractThroughFunction", "Subsubsection",
 CellChangeTimes->{{3.8950725408048186`*^9, 3.895072550695156*^9}, 
   3.895072888853574*^9},ExpressionUUID->"bd0e82e6-1ea8-4e4f-a672-\
f441813d8795"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OperatorContractThroughFunction", "[", "a_", 
    RowBox[{"(*", 
     StyleBox[
      RowBox[{"Function", " ", "Name"}],
      FontColor->RGBColor[1, 0, 1]], "*)"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"a", "[", 
     RowBox[{"x1___", ",", 
      RowBox[{"func_", "/;", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "func", "]"}], "=!=", 
           "NonCommutativeMultiply"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "func", "]"}], "=!=", "TensorsProduct"}], 
          ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "func", "]"}], "=!=", "LT"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "func", "]"}], "=!=", "a"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "func", "]"}], "=!=", "List"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "func", "]"}], "=!=", "Tensor"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "func", "]"}], "=!=", "Plus"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "func", "]"}], "=!=", "Times"}], ")"}], "&&", 
         RowBox[{"!", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Union", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"TestScalarTensor", "[", "#", "]"}], "&"}], "/@", 
              RowBox[{"Cases", "[", 
               RowBox[{"func", ",", "_Tensor", ",", "Infinity"}], "]"}]}], 
             "]"}], "===", 
            RowBox[{"{", "True", "}"}]}], ")"}]}], "&&", 
         RowBox[{"!", 
          RowBox[{"TestExpressionForm", "[", "func", "]"}]}]}], ")"}]}], ",", 
      RowBox[{"x2___", "/;", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"{", "x2", "}"}], ",", "Tensor", ",", 
           RowBox[{"{", "1", "}"}]}], "]"}], "===", 
         RowBox[{"{", "}"}]}], ")"}]}]}], "]"}], ":=", 
    RowBox[{"Replace", "[", 
     RowBox[{"func", ",", 
      RowBox[{
       RowBox[{"ContentWithTensor_", "/;", 
        RowBox[{"(", 
         RowBox[{"!", 
          RowBox[{"TestExpressionForm", "[", "ContentWithTensor", "]"}]}], 
         ")"}]}], "\[RuleDelayed]", 
       RowBox[{"a", "[", 
        RowBox[{"x1", ",", 
         RowBox[{"TensorsProduct", "[", "ContentWithTensor", "]"}], ",", 
         "x2"}], "]"}]}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorContractThroughFunction", "[", "TensorsProduct", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorContractThroughFunction", "[", "TensorComponents", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorContractThroughFunction", "[", "ContractTensors", 
  "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.895072551585758*^9, 3.8950728857755537`*^9, {3.895074577875435*^9, 
   3.8950745803765173`*^9}, 3.8950748557843595`*^9, 3.8955553397613187`*^9, {
   3.895555838204072*^9, 3.895555838206071*^9}, {3.9628382143403482`*^9, 
   3.962838244175332*^9}, {3.9628415873829727`*^9, 3.9628416074761744`*^9}, {
   3.962841647155168*^9, 3.962841660538426*^9}, {3.9663942082619543`*^9, 
   3.966394208512616*^9}, {3.9663945012875557`*^9, 3.966394501528816*^9}, 
   3.971253643855303*^9, {3.9753104607888603`*^9, 
   3.9753104675561666`*^9}},ExpressionUUID->"a9ffbde1-9315-41e5-99ca-\
9ce6e4cdab7c"]
}, Closed]],

Cell[CellGroupData[{

Cell["OutputBecomesOneTensor", "Subsubsection",
 CellChangeTimes->{{3.8950725408048186`*^9, 3.895072550695156*^9}, 
   3.895072959633258*^9},ExpressionUUID->"5abeb7ce-6d51-43f6-a46b-\
d7054dbb4971"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OutputBecomesOneTensor", "[", 
    RowBox[{"a_", 
     RowBox[{"(*", 
      StyleBox[
       RowBox[{"Function", " ", "Name"}],
       FontColor->RGBColor[1, 0, 1]], "*)"}], ",", 
     RowBox[{"namerule_", "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"{", "namerule", "}"}], ",", "TensorName", ",", 
          "Infinity"}], "]"}], "=!=", 
        RowBox[{"{", "}"}]}], ")"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"x1___", ",", 
         RowBox[{"wholeBunchOfStuff_", "/;", 
          RowBox[{"!", 
           RowBox[{"TestExpressionForm", "[", "wholeBunchOfStuff", "]"}]}]}], 
         ",", "x2___", ",", "Tensor"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "FirstOutput", ",", "AllTensor", ",", "FirstTensor", ",", "output", 
           ",", "name", ",", "indices"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"FirstOutput", "=", 
           RowBox[{"a", "[", 
            RowBox[{"x1", ",", "wholeBunchOfStuff", ",", "x2"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"AllTensor", "=", 
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"{", "wholeBunchOfStuff", "}"}], ",", "_Tensor", ",", 
             "Infinity"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"FirstTensor", "=", 
           RowBox[{
           "AllTensor", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "FirstOutput", "}"}], ",", 
                RowBox[{"(", 
                 RowBox[{"t_", "/;", 
                  RowBox[{"TestTensorTensor", "[", "t", "]"}]}], ")"}], ",", 
                "Infinity"}], "]"}], "===", 
              RowBox[{"{", "}"}]}], ")"}], ",", "\[IndentingNewLine]", 
            RowBox[{"indices", "=", 
             RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "True", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"indices", "=", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "FirstOutput", "}"}], ",", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Indices", "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"idx_", "/;", 
                    RowBox[{"(", 
                    RowBox[{"idx", "=!=", 
                    RowBox[{"{", "}"}]}], ")"}]}], ")"}]}], ")"}], "\[Rule]", 
                  " ", "idx"}], " ", ")"}], ",", "Infinity"}], "]"}], 
              "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"name", "=", 
           RowBox[{"namerule", "/.", 
            RowBox[{"{", 
             RowBox[{"(", 
              RowBox[{"TensorName", "\[Rule]", " ", 
               RowBox[{"TensorName", "[", "wholeBunchOfStuff", "]"}]}], ")"}],
              "}"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"TestExpressionForm", "[", "FirstOutput", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"output", "=", 
              RowBox[{"Indices", "[", 
               RowBox[{"FirstTensor", ",", "indices"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"output", "=", 
              RowBox[{"TensorName", "[", 
               RowBox[{"output", ",", "name"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"output", "=", 
              RowBox[{"output", "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
                 "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{"TensorComponents", "\[Rule]", "FirstOutput"}], 
                  ")"}]}], "}"}]}]}]}], ",", "\[IndentingNewLine]", "True", 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"output", "=", 
              RowBox[{"TensorName", "[", 
               RowBox[{"FirstTensor", ",", "name"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"output", "=", 
              RowBox[{"output", "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
                 "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{"TensorComponents", "\[Rule]", 
                   RowBox[{"TensorComponents", "[", "FirstOutput", "]"}]}], 
                  ")"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"output", "=", 
              RowBox[{"Indices", "[", 
               RowBox[{"output", ",", "indices"}], "]"}]}]}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"x1___", ",", 
         RowBox[{"wholeBunchOfStuff_", "/;", 
          RowBox[{"!", 
           RowBox[{"TestExpressionForm", "[", "wholeBunchOfStuff", "]"}]}]}], 
         ",", "x2___", ",", "Tensor", ",", 
         RowBox[{"TensorName", "\[Rule]", " ", "username_"}]}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "FirstOutput", ",", "AllTensor", ",", "FirstTensor", ",", "output", 
           ",", "name", ",", "indices"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"FirstOutput", "=", 
           RowBox[{"a", "[", 
            RowBox[{"x1", ",", "wholeBunchOfStuff", ",", "x2"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"AllTensor", "=", 
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"{", "wholeBunchOfStuff", "}"}], ",", "_Tensor", ",", 
             "Infinity"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"FirstTensor", "=", 
           RowBox[{
           "AllTensor", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "FirstOutput", "}"}], ",", 
                RowBox[{"(", 
                 RowBox[{"t_", "/;", 
                  RowBox[{"TestTensorTensor", "[", "t", "]"}]}], ")"}], ",", 
                "Infinity"}], "]"}], "===", 
              RowBox[{"{", "}"}]}], ")"}], ",", "\[IndentingNewLine]", 
            RowBox[{"indices", "=", 
             RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "True", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"indices", "=", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "FirstOutput", "}"}], ",", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Indices", "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"idx_", "/;", 
                    RowBox[{"(", 
                    RowBox[{"idx", "=!=", 
                    RowBox[{"{", "}"}]}], ")"}]}], ")"}]}], ")"}], "\[Rule]", 
                  " ", "idx"}], " ", ")"}], ",", "Infinity"}], "]"}], 
              "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"TestExpressionForm", "[", "FirstOutput", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"output", "=", 
              RowBox[{"Indices", "[", 
               RowBox[{"FirstTensor", ",", 
                RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"output", "=", 
              RowBox[{"TensorName", "[", 
               RowBox[{"output", ",", "username"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"output", "=", 
              RowBox[{"output", "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
                 "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{"TensorComponents", "\[Rule]", "FirstOutput"}], 
                  ")"}]}], "}"}]}]}]}], ",", "\[IndentingNewLine]", "True", 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"output", "=", 
              RowBox[{"TensorName", "[", 
               RowBox[{"FirstTensor", ",", "username"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"output", "=", 
              RowBox[{"output", "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
                 "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{"TensorComponents", "\[Rule]", 
                   RowBox[{"TensorComponents", "[", "FirstOutput", "]"}]}], 
                  ")"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"output", "=", 
              RowBox[{"Indices", "[", 
               RowBox[{"output", ",", "indices"}], "]"}]}]}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OutputBecomesOneTensor", "[", 
   RowBox[{"TensorsProduct", ",", "TensorName"}], "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.895072551585758*^9, 3.895072955333823*^9, {3.8950738577996945`*^9, 
   3.8950738722056046`*^9}, 3.8950745813452673`*^9, {3.895540312444418*^9, 
   3.895540374995787*^9}, 3.8955404174133015`*^9, {3.895540509477047*^9, 
   3.8955405158202944`*^9}, {3.895540580347581*^9, 3.895540616643103*^9}, {
   3.8955408241144743`*^9, 3.8955408290267076`*^9}, {3.8955409552097793`*^9, 
   3.8955410202354493`*^9}, {3.8955410519856853`*^9, 
   3.8955411395292735`*^9}, {3.8955412146999264`*^9, 3.895541236845701*^9}, {
   3.895541518536989*^9, 3.8955415204245663`*^9}, {3.895541766690523*^9, 
   3.8955417827534246`*^9}, {3.895541832641014*^9, 3.895541835527197*^9}, {
   3.8955558382135787`*^9, 3.895555838226572*^9}, {3.8984078010452347`*^9, 
   3.8984078145528903`*^9}, {3.8984078608573217`*^9, 3.898407863076021*^9}, {
   3.898407953557758*^9, 3.898407958250008*^9}, {3.898407989092769*^9, 
   3.898407992485592*^9}, {3.8984080535007777`*^9, 3.898408089336933*^9}, {
   3.8984082411587453`*^9, 3.8984082643815613`*^9}, {3.8984084966172295`*^9, 
   3.8984085036689496`*^9}, 3.8984753140844183`*^9, {3.8984755454493604`*^9, 
   3.8984755479138455`*^9}, 3.898543297734887*^9, {3.898543373070589*^9, 
   3.8985433763745594`*^9}, {3.975310478130292*^9, 
   3.975310486700493*^9}},ExpressionUUID->"1f65dda3-6561-49d3-b889-\
ec8afc65b582"]
}, Closed]],

Cell[CellGroupData[{

Cell["OperatorProductRule", "Subsubsection",
 CellChangeTimes->{{3.868567905630082*^9, 3.868567906389614*^9}, 
   3.8685713395391026`*^9, {3.8692685734412975`*^9, 3.8692685747773304`*^9}, 
   3.869784486679248*^9, 
   3.8950729811170626`*^9},ExpressionUUID->"a7f7f10d-763e-4c72-a7ca-\
7359b6939cd0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OperatorProductRule", "[", 
    RowBox[{"a_", 
     RowBox[{"(*", 
      StyleBox[
       RowBox[{"Function", " ", "Name"}],
       FontColor->RGBColor[1, 0, 1]], "*)"}], ",", 
     RowBox[{"pos___", "/;", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", "pos", "}"}], "===", 
          RowBox[{"{", "}"}]}], ")"}], ",", "True", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"IntegerQ", "[", "pos", "]"}], "&&", 
          RowBox[{"(", 
           RowBox[{"pos", ">", "0"}], ")"}]}], ")"}]}], "]"}]}]}], "]"}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{
         RowBox[{"x1___", "/;", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", "pos", "}"}], "===", 
              RowBox[{"{", "}"}]}], ")"}], ",", "True", ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"{", "x1", "}"}], "]"}], "===", 
              RowBox[{"(", 
               RowBox[{"pos", "-", "1"}], ")"}]}], ")"}]}], "]"}]}], ",", 
         RowBox[{"t_Times", "/;", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{"(", 
                RowBox[{"Head", "/@", 
                 RowBox[{"(", 
                  RowBox[{"List", "@@", "t"}], ")"}]}], ")"}], "]"}], "=!=", 
              RowBox[{"{", "Tensor", "}"}]}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{"!", 
              RowBox[{"TestExpressionForm", "[", "t", "]"}]}], ")"}]}], 
           ")"}]}], ",", "x2___"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"allTensors", ",", "therest", ",", "part1", ",", "part2"}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"allTensors", "=", 
           RowBox[{"Apply", "[", 
            RowBox[{"Times", ",", 
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Apply", "[", 
                 RowBox[{"List", ",", "t"}], "]"}], ")"}], ",", 
               RowBox[{"tt_", "/;", 
                RowBox[{"TestTensorTensor", "[", "tt", "]"}]}]}], "]"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"therest", "=", 
           RowBox[{"Apply", "[", 
            RowBox[{"Times", ",", 
             RowBox[{"DeleteCases", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Apply", "[", 
                 RowBox[{"List", ",", "t"}], "]"}], ")"}], ",", 
               RowBox[{"tt_", "/;", 
                RowBox[{"TestTensorTensor", "[", "tt", "]"}]}]}], "]"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"part1", "=", 
           RowBox[{"a", "[", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"{", 
              RowBox[{"x1", ",", "allTensors", ",", "x2"}], "}"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"part2", "=", 
           RowBox[{"a", "[", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"{", 
              RowBox[{"x1", ",", "therest", ",", "x2"}], "}"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"part1", "=", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"ZeroTensorQ", "[", "part1", "]"}], ",", "0", ",", 
             "True", ",", "part1"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"part2", "=", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"ZeroTensorQ", "[", "part2", "]"}], ",", "0", ",", 
             "True", ",", "part2"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"therest", " ", "part1"}], "+", 
           RowBox[{"TensorsProduct", "[", 
            RowBox[{"allTensors", " ", "part2"}], "]"}]}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"x1___", ",", 
         RowBox[{"t_Times", "/;", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Union", "[", 
             RowBox[{"(", 
              RowBox[{"Head", "/@", 
               RowBox[{"(", 
                RowBox[{"Apply", "[", 
                 RowBox[{"List", ",", "t"}], "]"}], ")"}]}], ")"}], "]"}], "===", 
            RowBox[{"{", "Tensor", "}"}]}], ")"}]}], ",", "x2___"}], "]"}], ":=", 
       RowBox[{"a", "[", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"{", 
          RowBox[{"x1", ",", 
           RowBox[{"TensorsProduct", "[", 
            RowBox[{"t", ",", "Tensor"}], "]"}], ",", "x2"}], "}"}]}], 
        "]"}]}], ";"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OperatorProductRule", "[", "PartialD", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OperatorProductRule", "[", "CovariantD", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OperatorProductRule", "[", 
   RowBox[{"LieD", ",", "2"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OperatorProductRule", "[", "LieBracket", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OperatorProductRule", "[", "ExteriorD", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8685679623021145`*^9, 3.8685680314928904`*^9}, {
   3.8685681569581947`*^9, 3.8685681641497574`*^9}, {3.8685691764693556`*^9, 
   3.868569195171815*^9}, {3.868569322339351*^9, 3.868569329441968*^9}, {
   3.86856969760701*^9, 3.8685697216387405`*^9}, {3.8685697542816424`*^9, 
   3.8685697850306654`*^9}, {3.8685698168875837`*^9, 
   3.8685698331490974`*^9}, {3.868569901430086*^9, 3.8685699165013437`*^9}, {
   3.8685700571434937`*^9, 3.868570062308307*^9}, {3.868570631278344*^9, 
   3.8685706321193624`*^9}, {3.8685713749040813`*^9, 3.868571385397997*^9}, {
   3.868585260863675*^9, 3.868585269575096*^9}, {3.8685853292384205`*^9, 
   3.8685853659269342`*^9}, {3.86858586200412*^9, 3.8685858653304224`*^9}, {
   3.8692685792576027`*^9, 3.869268581764486*^9}, {3.869268770906531*^9, 
   3.8692688149768305`*^9}, {3.869268880688589*^9, 3.86926889686454*^9}, {
   3.8692689409365473`*^9, 3.8692689582249627`*^9}, {3.869269009312674*^9, 
   3.8692690195040016`*^9}, {3.8692690598797956`*^9, 3.8692690914544606`*^9}, 
   3.8696539130614195`*^9, {3.8696595977559977`*^9, 3.869659626167713*^9}, {
   3.8696596857138553`*^9, 3.8696597056014357`*^9}, 3.869659844861117*^9, {
   3.869659879545611*^9, 3.8696598828111525`*^9}, 3.8696599805295024`*^9, {
   3.8696603808613415`*^9, 3.869660391316813*^9}, 3.869660426445712*^9, {
   3.869660562302675*^9, 3.8696606109036407`*^9}, {3.869660732303149*^9, 
   3.8696607344148293`*^9}, {3.8696610257207403`*^9, 
   3.8696610266994286`*^9}, {3.869661092751726*^9, 3.869661097879053*^9}, {
   3.8696611534659452`*^9, 3.8696611557783885`*^9}, {3.8696612161894655`*^9, 
   3.869661216439459*^9}, {3.869661549015382*^9, 3.8696615605825176`*^9}, {
   3.8696615919862003`*^9, 3.8696616165348463`*^9}, {3.8696628404281015`*^9, 
   3.869662878557923*^9}, {3.869662951246763*^9, 3.8696629528682675`*^9}, {
   3.869736260489716*^9, 3.8697363893193007`*^9}, 3.8697364639982686`*^9, {
   3.8697365410127926`*^9, 3.869736552173975*^9}, {3.8697368702522235`*^9, 
   3.8697368719861546`*^9}, {3.8697369623634496`*^9, 
   3.8697369775780706`*^9}, {3.869780586093996*^9, 3.869780626021951*^9}, {
   3.869780720757214*^9, 3.8697807276609554`*^9}, {3.8697833609914165`*^9, 
   3.869783368295017*^9}, {3.8697834874231205`*^9, 3.869783509998849*^9}, {
   3.869784472723075*^9, 3.8697844837960243`*^9}, {3.869784550419446*^9, 
   3.869784615882824*^9}, 3.8697851155517893`*^9, {3.8697851629836664`*^9, 
   3.8697851865511255`*^9}, {3.8697870038720407`*^9, 
   3.8697870890085225`*^9}, {3.8697871355418167`*^9, 
   3.8697871467579594`*^9}, {3.8697878504716015`*^9, 
   3.8697879121680965`*^9}, {3.869807029923705*^9, 3.869807157825574*^9}, 
   3.869807209826666*^9, 3.8698072862740574`*^9, {3.8726560742949734`*^9, 
   3.8726560890334406`*^9}, {3.873938944121187*^9, 3.8739389745703926`*^9}, 
   3.875245713080204*^9, {3.875245928780851*^9, 3.8752459595012364`*^9}, {
   3.8752459912209635`*^9, 3.8752460435115013`*^9}, {3.8752463227198257`*^9, 
   3.875246326235374*^9}, {3.875246360042892*^9, 3.875246387344263*^9}, {
   3.8752465082725024`*^9, 3.875246549904358*^9}, {3.8752469634629526`*^9, 
   3.875246964969907*^9}, {3.875247461640865*^9, 3.875247471780938*^9}, {
   3.8752476568665023`*^9, 3.875247695363555*^9}, {3.875248359532177*^9, 
   3.875248370803824*^9}, {3.875248435234214*^9, 3.875248487544714*^9}, {
   3.884769124813263*^9, 3.884769126975298*^9}, 3.895072991194916*^9, {
   3.8955490510140657`*^9, 3.895549061932602*^9}, {3.895549292023367*^9, 
   3.895549358984203*^9}, 3.8955558382325664`*^9, {3.8971955878271246`*^9, 
   3.897195589401308*^9}, {3.89874898055123*^9, 3.898748983051158*^9}, {
   3.898752392518583*^9, 3.898752399961263*^9}, {3.972612721192608*^9, 
   3.972612722947995*^9}, 3.973765345170277*^9, {3.97376554596273*^9, 
   3.973765545966247*^9}, {3.975310496901472*^9, 
   3.975310510617901*^9}},ExpressionUUID->"4ce8865e-e8e3-49bd-81b4-\
905700e9f61e"]
}, Closed]],

Cell[CellGroupData[{

Cell["OperatorThreadThroughTimes", "Subsubsection",
 CellChangeTimes->{
  3.898401764120573*^9},ExpressionUUID->"0f0f2248-1ca5-4f9f-85f4-\
262176613ebb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OperatorThreadThroughTimes", "[", "a_", 
     RowBox[{"(*", 
      StyleBox[
       RowBox[{"Function", " ", "Name"}],
       FontColor->RGBColor[1, 0, 1]], "*)"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"x1___", ",", 
       RowBox[{"(", "t_Times", ")"}], ",", 
       RowBox[{"x2___", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"{", "x2", "}"}], ",", "Tensor", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}], "===", 
          RowBox[{"{", "}"}]}], ")"}]}]}], "]"}], ":=", 
     RowBox[{"Times", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"x1", ",", "#", ",", "x2"}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"Apply", "[", 
          RowBox[{"List", ",", "t"}], "]"}], ")"}]}], ")"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Unprotect", "[", "Conjugate", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OperatorThreadThroughTimes", "[", "Conjugate", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", "Conjugate", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8984013386702724`*^9, 3.8984013386859045`*^9}, {
   3.8984015269509964`*^9, 3.898401559717451*^9}, {3.8984015951781006`*^9, 
   3.898401715647459*^9}, 
   3.9753105205870857`*^9},ExpressionUUID->"216ec684-5d09-4555-9dbd-\
c9030a7b3685"]
}, Closed]],

Cell[CellGroupData[{

Cell["OperatorSplitByCoordinates", "Subsubsection",
 CellChangeTimes->{3.8950725408048186`*^9, 3.89507338817723*^9, 
  3.9730509698115396`*^9},ExpressionUUID->"78c7c497-8b87-442f-a84b-\
ef140aef0242"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OperatorSplitByCoordinates", "[", "a_", 
     RowBox[{"(*", 
      StyleBox[
       RowBox[{"Function", " ", "Name"}],
       FontColor->RGBColor[1, 0, 1]], "*)"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"x1___", ",", 
       RowBox[{"(", 
        RowBox[{"t_Times", "|", 
         RowBox[{"(", 
          RowBox[{"t_List", "/;", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"t", "=!=", 
               RowBox[{"{", "}"}]}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{"t", ",", "_Tensor", ",", "Infinity"}], "]"}], "=!=", 
               RowBox[{"{", "}"}]}], ")"}], "&&", 
             RowBox[{"!", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"Union", "[", 
                  RowBox[{"Coordinates", "/@", 
                   RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"Apply", "[", 
                    RowBox[{"List", ",", "t"}], "]"}], ",", 
                    RowBox[{"Tensor", "[", "___", "]"}]}], "]"}]}], "]"}], 
                 "]"}], "===", "1"}], ")"}]}], "&&", 
             RowBox[{"(*", " ", 
              RowBox[{"check", " ", "tensor", " ", "product"}], " ", "*)"}], 
             RowBox[{"(*", " ", 
              RowBox[{"everybody", " ", "is", " ", "a", " ", "Tensor"}], " ", 
              "*)"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Union", "[", 
                RowBox[{"Head", "/@", 
                 RowBox[{"(", 
                  RowBox[{"Apply", "[", 
                   RowBox[{"List", ",", "t"}], "]"}], ")"}]}], "]"}], "===", 
               RowBox[{"{", "Tensor", "}"}]}], ")"}], "&&", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "All", " ", "scalar", " ", "Tensors", " ", "have", " ", 
               "already", " ", "been", " ", "factored", " ", 
               RowBox[{"out", "."}]}], "*)"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"Apply", "[", 
                   RowBox[{"List", ",", "t"}], "]"}], ")"}], ",", 
                 RowBox[{"(", 
                  RowBox[{"st_", "/;", 
                   RowBox[{"TestScalarTensor", "[", "st", "]"}]}], ")"}], ",", 
                 RowBox[{"{", "1", "}"}]}], "]"}], "===", 
               RowBox[{"{", "}"}]}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"Apply", "[", 
                 RowBox[{"List", ",", "t"}], "]"}], "]"}], "=!=", "1"}], 
              ")"}]}], ")"}]}], ")"}], "|", "t_NonCommutativeMultiply"}], 
        ")"}], ",", 
       RowBox[{"x2___", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"{", "x2", "}"}], ",", "Tensor", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}], "===", 
          RowBox[{"{", "}"}]}], ")"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"listt", "=", 
          RowBox[{"Apply", "[", 
           RowBox[{"List", ",", "t"}], "]"}]}], ",", "ii", ",", "ALLCoods", 
         ",", "coordsTypes", ",", "SplitT"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"perform", " ", "a", " ", "tensor", " ", "product"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ALLCoods", "=", 
         RowBox[{"Union", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Coordinates", "[", "#", "]"}], "&"}], "/@", "listt"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"coordsTypes", "=", 
         RowBox[{"Length", "[", "ALLCoods", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SplitT", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Coordinates", "[", "#", "]"}], "===", 
                  RowBox[{
                  "ALLCoods", "\[LeftDoubleBracket]", "ii", 
                   "\[RightDoubleBracket]"}]}], ")"}], ",", "#", ",", 
                "Nothing"}], "]"}], "&"}], "/@", "listt"}], ")"}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", "1", ",", "coordsTypes"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Times", "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"a", "[", 
             RowBox[{"x1", ",", "#", ",", "x2"}], "]"}], "&"}], "/@", 
           "SplitT"}], ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OperatorSplitByCoordinates", "[", "ContractTensors", "]"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.895073372902302*^9, 3.895073377324029*^9}, 
   3.895073612840896*^9, 3.8950743923250165`*^9, 3.895074849409528*^9, {
   3.966394066623859*^9, 3.966394067314742*^9}, {3.9663944245598383`*^9, 
   3.966394424728196*^9}, {3.97305088591619*^9, 3.973050911454225*^9}, 
   3.9753105301068296`*^9},ExpressionUUID->"310eb20c-ade5-414b-b867-\
3c359be75cbc"]
}, Closed]],

Cell[CellGroupData[{

Cell["TensorComponentsManipulation", "Subsubsection",
 CellChangeTimes->{
  3.887159309454103*^9, {3.887159346908943*^9, 3.8871593485488877`*^9}, {
   3.887159856004425*^9, 3.887159859775711*^9}, {3.975311166690085*^9, 
   3.975311168599435*^9}},ExpressionUUID->"7dfb31c1-6cd3-4f41-a858-\
7d9052b29eaa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TensorComponentsManipulation", "[", "name_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{"Tensor", "/:", 
      RowBox[{"name", "[", "t_Tensor", "]"}], ":=", 
      RowBox[{"t", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"TensorComponents", "\[Rule]", " ", "comp_"}], ")"}], 
         "\[RuleDelayed]", " ", 
         RowBox[{"(", 
          RowBox[{"TensorComponents", "\[Rule]", " ", 
           RowBox[{"name", "[", "comp", "]"}]}], ")"}]}], "}"}]}]}], ")"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TensorComponentsManipulation", "[", "Expand", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TensorComponentsManipulation", "[", "ExpToTrig", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TensorComponentsManipulation", "[", "TrigToExp", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TensorComponentsManipulation", "[", "TrigReduce", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TensorComponentsManipulation", "[", "ComplexExpand", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TensorComponentsManipulation", "[", "FunctionExpand", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TensorComponentsManipulation", "[", "PowerExpand", "]"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.887159360916139*^9, 3.887159387950362*^9}, {
   3.8871594225002747`*^9, 3.8871594569811983`*^9}, {3.8871594874828796`*^9, 
   3.8871594945791883`*^9}, {3.887159573539638*^9, 3.8871597547926397`*^9}, 
   3.887762233516088*^9, 
   3.8877623136488776`*^9},ExpressionUUID->"390ef9bb-7716-4452-8d5b-\
ae7722bd9d7f"]
}, Closed]],

Cell[CellGroupData[{

Cell["ExtractFunction", "Subsubsection",
 CellChangeTimes->{{3.868567905630082*^9, 3.868567906389614*^9}, 
   3.8685713395391026`*^9, {3.8692685734412975`*^9, 3.8692685747773304`*^9}, 
   3.869784486679248*^9, 3.8950729811170626`*^9, 
   3.960456477701354*^9},ExpressionUUID->"930e20e8-4d96-4bbf-b75e-\
5fcb612993eb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ExtractFunction", "[", "fn_", 
     RowBox[{"(*", 
      StyleBox[
       RowBox[{"Function", " ", "Name"}],
       FontColor->RGBColor[1, 0, 1]], "*)"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"fn", "[", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"t_Tensor", "|", "t_List"}], "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"t", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"a_", "\[Rule]", " ", "b_"}], ")"}], ":>", " ", 
             RowBox[{"(", 
              RowBox[{"a", "\[Rule]", " ", "b"}], ")"}]}], ",", 
            RowBox[{"{", "1", "}"}]}], "]"}], "=!=", 
          RowBox[{"{", "}"}]}], ")"}]}], ")"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Cases", "[", 
       RowBox[{"t", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"fn", "\[Rule]", "output_"}], ")"}], ":>", "output"}], ",", 
        RowBox[{"{", "1", "}"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
      "\[RightDoubleBracket]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ExtractFunction", "[", "TensorComponents", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ExtractFunction", "[", "Indices", "]"}], "\[IndentingNewLine]", 
 RowBox[{"ExtractFunction", "[", "StartIndex", "]"}], "\[IndentingNewLine]", 
 RowBox[{"ExtractFunction", "[", "TensorType", "]"}], "\[IndentingNewLine]", 
 RowBox[{"ExtractFunction", "[", "TooltipDisplay", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Unprotect", "[", "TooltipStyle", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ExtractFunction", "[", "TooltipStyle", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", "TooltipStyle", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8685679623021145`*^9, 3.8685680314928904`*^9}, {
   3.8685681569581947`*^9, 3.8685681641497574`*^9}, {3.8685691764693556`*^9, 
   3.868569195171815*^9}, {3.868569322339351*^9, 3.868569329441968*^9}, {
   3.86856969760701*^9, 3.8685697216387405`*^9}, {3.8685697542816424`*^9, 
   3.8685697850306654`*^9}, {3.8685698168875837`*^9, 
   3.8685698331490974`*^9}, {3.868569901430086*^9, 3.8685699165013437`*^9}, {
   3.8685700571434937`*^9, 3.868570062308307*^9}, {3.868570631278344*^9, 
   3.8685706321193624`*^9}, {3.8685713749040813`*^9, 3.868571385397997*^9}, {
   3.868585260863675*^9, 3.868585269575096*^9}, {3.8685853292384205`*^9, 
   3.8685853659269342`*^9}, {3.86858586200412*^9, 3.8685858653304224`*^9}, {
   3.8692685792576027`*^9, 3.869268581764486*^9}, {3.869268770906531*^9, 
   3.8692688149768305`*^9}, {3.869268880688589*^9, 3.86926889686454*^9}, {
   3.8692689409365473`*^9, 3.8692689582249627`*^9}, {3.869269009312674*^9, 
   3.8692690195040016`*^9}, {3.8692690598797956`*^9, 3.8692690914544606`*^9}, 
   3.8696539130614195`*^9, {3.8696595977559977`*^9, 3.869659626167713*^9}, {
   3.8696596857138553`*^9, 3.8696597056014357`*^9}, 3.869659844861117*^9, {
   3.869659879545611*^9, 3.8696598828111525`*^9}, 3.8696599805295024`*^9, {
   3.8696603808613415`*^9, 3.869660391316813*^9}, 3.869660426445712*^9, {
   3.869660562302675*^9, 3.8696606109036407`*^9}, {3.869660732303149*^9, 
   3.8696607344148293`*^9}, {3.8696610257207403`*^9, 
   3.8696610266994286`*^9}, {3.869661092751726*^9, 3.869661097879053*^9}, {
   3.8696611534659452`*^9, 3.8696611557783885`*^9}, {3.8696612161894655`*^9, 
   3.869661216439459*^9}, {3.869661549015382*^9, 3.8696615605825176`*^9}, {
   3.8696615919862003`*^9, 3.8696616165348463`*^9}, {3.8696628404281015`*^9, 
   3.869662878557923*^9}, {3.869662951246763*^9, 3.8696629528682675`*^9}, {
   3.869736260489716*^9, 3.8697363893193007`*^9}, 3.8697364639982686`*^9, {
   3.8697365410127926`*^9, 3.869736552173975*^9}, {3.8697368702522235`*^9, 
   3.8697368719861546`*^9}, {3.8697369623634496`*^9, 
   3.8697369775780706`*^9}, {3.869780586093996*^9, 3.869780626021951*^9}, {
   3.869780720757214*^9, 3.8697807276609554`*^9}, {3.8697833609914165`*^9, 
   3.869783368295017*^9}, {3.8697834874231205`*^9, 3.869783509998849*^9}, {
   3.869784472723075*^9, 3.8697844837960243`*^9}, {3.869784550419446*^9, 
   3.869784615882824*^9}, 3.8697851155517893`*^9, {3.8697851629836664`*^9, 
   3.8697851865511255`*^9}, {3.8697870038720407`*^9, 
   3.8697870890085225`*^9}, {3.8697871355418167`*^9, 
   3.8697871467579594`*^9}, {3.8697878504716015`*^9, 
   3.8697879121680965`*^9}, {3.869807029923705*^9, 3.869807157825574*^9}, 
   3.869807209826666*^9, 3.8698072862740574`*^9, {3.8726560742949734`*^9, 
   3.8726560890334406`*^9}, {3.873938944121187*^9, 3.8739389745703926`*^9}, 
   3.875245713080204*^9, {3.875245928780851*^9, 3.8752459595012364`*^9}, {
   3.8752459912209635`*^9, 3.8752460435115013`*^9}, {3.8752463227198257`*^9, 
   3.875246326235374*^9}, {3.875246360042892*^9, 3.875246387344263*^9}, {
   3.8752465082725024`*^9, 3.875246549904358*^9}, {3.8752469634629526`*^9, 
   3.875246964969907*^9}, {3.875247461640865*^9, 3.875247471780938*^9}, {
   3.8752476568665023`*^9, 3.875247695363555*^9}, {3.875248359532177*^9, 
   3.875248370803824*^9}, {3.875248435234214*^9, 3.875248487544714*^9}, {
   3.884769124813263*^9, 3.884769126975298*^9}, 3.895072991194916*^9, {
   3.8955490510140657`*^9, 3.895549061932602*^9}, {3.895549292023367*^9, 
   3.895549358984203*^9}, 3.8955558382325664`*^9, {3.8971955878271246`*^9, 
   3.897195589401308*^9}, {3.89874898055123*^9, 3.898748983051158*^9}, {
   3.898752392518583*^9, 3.898752399961263*^9}, {3.96045649496906*^9, 
   3.960456516727957*^9}, {3.9604568631059113`*^9, 3.960456866626913*^9}, {
   3.9604572342452917`*^9, 3.960457243385705*^9}, {3.960457431823202*^9, 
   3.960457436537438*^9}, {3.960457513758811*^9, 3.960457518406868*^9}, {
   3.960457843822421*^9, 3.960457863845792*^9}, {3.9604579006676083`*^9, 
   3.960457905079919*^9}, {3.96045799020662*^9, 3.960457994462315*^9}, {
   3.960458186790756*^9, 3.9604581909028788`*^9}, {3.9605149973047533`*^9, 
   3.9605150011633863`*^9}, {3.975310546139798*^9, 
   3.975310547668522*^9}},ExpressionUUID->"c7126864-ffec-40e5-a7bc-\
453dde1b6339"]
}, Closed]],

Cell[CellGroupData[{

Cell["ExtractFunctionNoPart", "Subsubsection",
 CellChangeTimes->{{3.868567905630082*^9, 3.868567906389614*^9}, 
   3.8685713395391026`*^9, {3.8692685734412975`*^9, 3.8692685747773304`*^9}, 
   3.869784486679248*^9, 3.8950729811170626`*^9, 3.960456477701354*^9, 
   3.96045662418126*^9},ExpressionUUID->"8d38ae25-75a4-4e2d-8b10-\
56fbde23716a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ExtractFunctionNoPart", "[", "fn_", 
     RowBox[{"(*", 
      StyleBox[
       RowBox[{"Function", " ", "Name"}],
       FontColor->RGBColor[1, 0, 1]], "*)"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"Symbol", "[", 
       RowBox[{
        RowBox[{"ToString", "[", "fn", "]"}], "<>", "\"\<NoPart\>\""}], "]"}],
       "[", 
      RowBox[{"(", 
       RowBox[{"t_Tensor", "|", 
        RowBox[{"(", 
         RowBox[{"t_List", "/;", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"t", ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"a_", "\[Rule]", " ", "b_"}], ")"}], ":>", " ", 
               RowBox[{"(", 
                RowBox[{"a", "\[Rule]", " ", "b"}], ")"}]}], ",", 
              RowBox[{"{", "1", "}"}]}], "]"}], "=!=", 
            RowBox[{"{", "}"}]}], ")"}]}], ")"}]}], ")"}], "]"}], ":=", 
     RowBox[{"Cases", "[", 
      RowBox[{"t", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"fn", "\[Rule]", "output_"}], ")"}], ":>", "output"}], ",", 
       RowBox[{"{", "1", "}"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ExtractFunctionNoPart", "[", "TensorComponents", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ExtractFunctionNoPart", "[", "Indices", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ExtractFunctionNoPart", "[", "StartIndex", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ExtractFunctionNoPart", "[", "TensorName", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ExtractFunctionNoPart", "[", "TensorType", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ExtractFunctionNoPart", "[", "TooltipDisplay", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Unprotect", "[", "TooltipStyle", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ExtractFunctionNoPart", "[", "TooltipStyle", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", "TooltipStyle", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8685679623021145`*^9, 3.8685680314928904`*^9}, {
   3.8685681569581947`*^9, 3.8685681641497574`*^9}, {3.8685691764693556`*^9, 
   3.868569195171815*^9}, {3.868569322339351*^9, 3.868569329441968*^9}, {
   3.86856969760701*^9, 3.8685697216387405`*^9}, {3.8685697542816424`*^9, 
   3.8685697850306654`*^9}, {3.8685698168875837`*^9, 
   3.8685698331490974`*^9}, {3.868569901430086*^9, 3.8685699165013437`*^9}, {
   3.8685700571434937`*^9, 3.868570062308307*^9}, {3.868570631278344*^9, 
   3.8685706321193624`*^9}, {3.8685713749040813`*^9, 3.868571385397997*^9}, {
   3.868585260863675*^9, 3.868585269575096*^9}, {3.8685853292384205`*^9, 
   3.8685853659269342`*^9}, {3.86858586200412*^9, 3.8685858653304224`*^9}, {
   3.8692685792576027`*^9, 3.869268581764486*^9}, {3.869268770906531*^9, 
   3.8692688149768305`*^9}, {3.869268880688589*^9, 3.86926889686454*^9}, {
   3.8692689409365473`*^9, 3.8692689582249627`*^9}, {3.869269009312674*^9, 
   3.8692690195040016`*^9}, {3.8692690598797956`*^9, 3.8692690914544606`*^9}, 
   3.8696539130614195`*^9, {3.8696595977559977`*^9, 3.869659626167713*^9}, {
   3.8696596857138553`*^9, 3.8696597056014357`*^9}, 3.869659844861117*^9, {
   3.869659879545611*^9, 3.8696598828111525`*^9}, 3.8696599805295024`*^9, {
   3.8696603808613415`*^9, 3.869660391316813*^9}, 3.869660426445712*^9, {
   3.869660562302675*^9, 3.8696606109036407`*^9}, {3.869660732303149*^9, 
   3.8696607344148293`*^9}, {3.8696610257207403`*^9, 
   3.8696610266994286`*^9}, {3.869661092751726*^9, 3.869661097879053*^9}, {
   3.8696611534659452`*^9, 3.8696611557783885`*^9}, {3.8696612161894655`*^9, 
   3.869661216439459*^9}, {3.869661549015382*^9, 3.8696615605825176`*^9}, {
   3.8696615919862003`*^9, 3.8696616165348463`*^9}, {3.8696628404281015`*^9, 
   3.869662878557923*^9}, {3.869662951246763*^9, 3.8696629528682675`*^9}, {
   3.869736260489716*^9, 3.8697363893193007`*^9}, 3.8697364639982686`*^9, {
   3.8697365410127926`*^9, 3.869736552173975*^9}, {3.8697368702522235`*^9, 
   3.8697368719861546`*^9}, {3.8697369623634496`*^9, 
   3.8697369775780706`*^9}, {3.869780586093996*^9, 3.869780626021951*^9}, {
   3.869780720757214*^9, 3.8697807276609554`*^9}, {3.8697833609914165`*^9, 
   3.869783368295017*^9}, {3.8697834874231205`*^9, 3.869783509998849*^9}, {
   3.869784472723075*^9, 3.8697844837960243`*^9}, {3.869784550419446*^9, 
   3.869784615882824*^9}, 3.8697851155517893`*^9, {3.8697851629836664`*^9, 
   3.8697851865511255`*^9}, {3.8697870038720407`*^9, 
   3.8697870890085225`*^9}, {3.8697871355418167`*^9, 
   3.8697871467579594`*^9}, {3.8697878504716015`*^9, 
   3.8697879121680965`*^9}, {3.869807029923705*^9, 3.869807157825574*^9}, 
   3.869807209826666*^9, 3.8698072862740574`*^9, {3.8726560742949734`*^9, 
   3.8726560890334406`*^9}, {3.873938944121187*^9, 3.8739389745703926`*^9}, 
   3.875245713080204*^9, {3.875245928780851*^9, 3.8752459595012364`*^9}, {
   3.8752459912209635`*^9, 3.8752460435115013`*^9}, {3.8752463227198257`*^9, 
   3.875246326235374*^9}, {3.875246360042892*^9, 3.875246387344263*^9}, {
   3.8752465082725024`*^9, 3.875246549904358*^9}, {3.8752469634629526`*^9, 
   3.875246964969907*^9}, {3.875247461640865*^9, 3.875247471780938*^9}, {
   3.8752476568665023`*^9, 3.875247695363555*^9}, {3.875248359532177*^9, 
   3.875248370803824*^9}, {3.875248435234214*^9, 3.875248487544714*^9}, {
   3.884769124813263*^9, 3.884769126975298*^9}, 3.895072991194916*^9, {
   3.8955490510140657`*^9, 3.895549061932602*^9}, {3.895549292023367*^9, 
   3.895549358984203*^9}, 3.8955558382325664`*^9, {3.8971955878271246`*^9, 
   3.897195589401308*^9}, {3.89874898055123*^9, 3.898748983051158*^9}, {
   3.898752392518583*^9, 3.898752399961263*^9}, {3.96045649496906*^9, 
   3.960456516727957*^9}, {3.960456636417227*^9, 3.960456650774325*^9}, 
   3.9604568744728937`*^9, {3.960457247608934*^9, 3.960457252740632*^9}, {
   3.960457441303419*^9, 3.9604574449579153`*^9}, {3.960457520631266*^9, 
   3.960457523975173*^9}, {3.960457833079411*^9, 3.960457866159236*^9}, {
   3.9604579079426317`*^9, 3.960457910796056*^9}, {3.9604579973196297`*^9, 
   3.960457999612199*^9}, {3.960458195879036*^9, 3.9604581981797457`*^9}, {
   3.960515010975503*^9, 3.960515012724449*^9}, 
   3.975310554650074*^9},ExpressionUUID->"f3f9531b-10f7-4d70-9d91-\
9937d429f0d7"]
}, Closed]],

Cell[CellGroupData[{

Cell["EndowFunction", "Subsubsection",
 CellChangeTimes->{{3.868567905630082*^9, 3.868567906389614*^9}, 
   3.8685713395391026`*^9, {3.8692685734412975`*^9, 3.8692685747773304`*^9}, 
   3.869784486679248*^9, 3.8950729811170626`*^9, 3.960456477701354*^9, 
   3.9609397201654663`*^9},ExpressionUUID->"281d2c7c-fed4-4e76-a2ed-\
c2a22a5258d1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"EndowFunction", "[", 
    RowBox[{"fn_", 
     RowBox[{"(*", 
      StyleBox[
       RowBox[{"Function", " ", "Name"}],
       FontColor->RGBColor[1, 0, 1]], "*)"}], ",", "type___"}], "]"}], ":=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{"type", "===", "Null"}], ",", 
     RowBox[{
      RowBox[{"fn", "[", 
       RowBox[{"t_Tensor", ",", "NewValue_"}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "OldValue", "}"}], ",", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"t", ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"fn", "\[Rule]", "OldValue_"}], ")"}], "\[Rule]", 
               "OldValue"}]}], "]"}], "===", 
            RowBox[{"{", "}"}]}], ")"}], ",", 
          RowBox[{"Append", "[", 
           RowBox[{"t", ",", 
            RowBox[{"fn", "\[Rule]", "NewValue"}]}], "]"}], ",", "True", ",", 
          RowBox[{"t", "/.", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"fn", "\[Rule]", "OldValue_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"fn", "\[Rule]", "NewValue"}], ")"}]}]}]}], "]"}]}], 
       "]"}]}], ",", 
     RowBox[{"type", "=!=", "Null"}], ",", 
     RowBox[{
      RowBox[{"fn", "[", 
       RowBox[{"t_Tensor", ",", "NewValue_type"}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "OldValue", "}"}], ",", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"t", ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"fn", "\[Rule]", "OldValue_"}], ")"}], "\[Rule]", 
               "OldValue"}]}], "]"}], "===", 
            RowBox[{"{", "}"}]}], ")"}], ",", 
          RowBox[{"Append", "[", 
           RowBox[{"t", ",", 
            RowBox[{"fn", "\[Rule]", "NewValue"}]}], "]"}], ",", "True", ",", 
          RowBox[{"t", "/.", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"fn", "\[Rule]", "OldValue_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"fn", "\[Rule]", "NewValue"}], ")"}]}]}]}], "]"}]}], 
       "]"}]}]}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"EndowFunction", "[", 
  RowBox[{"Indices", ",", "List"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"EndowFunction", "[", 
  RowBox[{"StartIndex", ",", "Integer"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"EndowFunction", "[", "TensorName", "]"}], "\[IndentingNewLine]", 
 RowBox[{"EndowFunction", "[", "TensorType", "]"}], "\[IndentingNewLine]", 
 RowBox[{"EndowFunction", "[", "TooltipDisplay", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Unprotect", "[", "TooltipStyle", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"EndowFunction", "[", "TooltipStyle", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", "TooltipStyle", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8685679623021145`*^9, 3.8685680314928904`*^9}, {
   3.8685681569581947`*^9, 3.8685681641497574`*^9}, {3.8685691764693556`*^9, 
   3.868569195171815*^9}, {3.868569322339351*^9, 3.868569329441968*^9}, {
   3.86856969760701*^9, 3.8685697216387405`*^9}, {3.8685697542816424`*^9, 
   3.8685697850306654`*^9}, {3.8685698168875837`*^9, 
   3.8685698331490974`*^9}, {3.868569901430086*^9, 3.8685699165013437`*^9}, {
   3.8685700571434937`*^9, 3.868570062308307*^9}, {3.868570631278344*^9, 
   3.8685706321193624`*^9}, {3.8685713749040813`*^9, 3.868571385397997*^9}, {
   3.868585260863675*^9, 3.868585269575096*^9}, {3.8685853292384205`*^9, 
   3.8685853659269342`*^9}, {3.86858586200412*^9, 3.8685858653304224`*^9}, {
   3.8692685792576027`*^9, 3.869268581764486*^9}, {3.869268770906531*^9, 
   3.8692688149768305`*^9}, {3.869268880688589*^9, 3.86926889686454*^9}, {
   3.8692689409365473`*^9, 3.8692689582249627`*^9}, {3.869269009312674*^9, 
   3.8692690195040016`*^9}, {3.8692690598797956`*^9, 3.8692690914544606`*^9}, 
   3.8696539130614195`*^9, {3.8696595977559977`*^9, 3.869659626167713*^9}, {
   3.8696596857138553`*^9, 3.8696597056014357`*^9}, 3.869659844861117*^9, {
   3.869659879545611*^9, 3.8696598828111525`*^9}, 3.8696599805295024`*^9, {
   3.8696603808613415`*^9, 3.869660391316813*^9}, 3.869660426445712*^9, {
   3.869660562302675*^9, 3.8696606109036407`*^9}, {3.869660732303149*^9, 
   3.8696607344148293`*^9}, {3.8696610257207403`*^9, 
   3.8696610266994286`*^9}, {3.869661092751726*^9, 3.869661097879053*^9}, {
   3.8696611534659452`*^9, 3.8696611557783885`*^9}, {3.8696612161894655`*^9, 
   3.869661216439459*^9}, {3.869661549015382*^9, 3.8696615605825176`*^9}, {
   3.8696615919862003`*^9, 3.8696616165348463`*^9}, {3.8696628404281015`*^9, 
   3.869662878557923*^9}, {3.869662951246763*^9, 3.8696629528682675`*^9}, {
   3.869736260489716*^9, 3.8697363893193007`*^9}, 3.8697364639982686`*^9, {
   3.8697365410127926`*^9, 3.869736552173975*^9}, {3.8697368702522235`*^9, 
   3.8697368719861546`*^9}, {3.8697369623634496`*^9, 
   3.8697369775780706`*^9}, {3.869780586093996*^9, 3.869780626021951*^9}, {
   3.869780720757214*^9, 3.8697807276609554`*^9}, {3.8697833609914165`*^9, 
   3.869783368295017*^9}, {3.8697834874231205`*^9, 3.869783509998849*^9}, {
   3.869784472723075*^9, 3.8697844837960243`*^9}, {3.869784550419446*^9, 
   3.869784615882824*^9}, 3.8697851155517893`*^9, {3.8697851629836664`*^9, 
   3.8697851865511255`*^9}, {3.8697870038720407`*^9, 
   3.8697870890085225`*^9}, {3.8697871355418167`*^9, 
   3.8697871467579594`*^9}, {3.8697878504716015`*^9, 
   3.8697879121680965`*^9}, {3.869807029923705*^9, 3.869807157825574*^9}, 
   3.869807209826666*^9, 3.8698072862740574`*^9, {3.8726560742949734`*^9, 
   3.8726560890334406`*^9}, {3.873938944121187*^9, 3.8739389745703926`*^9}, 
   3.875245713080204*^9, {3.875245928780851*^9, 3.8752459595012364`*^9}, {
   3.8752459912209635`*^9, 3.8752460435115013`*^9}, {3.8752463227198257`*^9, 
   3.875246326235374*^9}, {3.875246360042892*^9, 3.875246387344263*^9}, {
   3.8752465082725024`*^9, 3.875246549904358*^9}, {3.8752469634629526`*^9, 
   3.875246964969907*^9}, {3.875247461640865*^9, 3.875247471780938*^9}, {
   3.8752476568665023`*^9, 3.875247695363555*^9}, {3.875248359532177*^9, 
   3.875248370803824*^9}, {3.875248435234214*^9, 3.875248487544714*^9}, {
   3.884769124813263*^9, 3.884769126975298*^9}, 3.895072991194916*^9, {
   3.8955490510140657`*^9, 3.895549061932602*^9}, {3.895549292023367*^9, 
   3.895549358984203*^9}, 3.8955558382325664`*^9, {3.8971955878271246`*^9, 
   3.897195589401308*^9}, {3.89874898055123*^9, 3.898748983051158*^9}, {
   3.898752392518583*^9, 3.898752399961263*^9}, {3.96045649496906*^9, 
   3.960456516727957*^9}, {3.9604568631059113`*^9, 3.960456866626913*^9}, {
   3.9604572342452917`*^9, 3.960457243385705*^9}, {3.960457431823202*^9, 
   3.960457436537438*^9}, {3.960457513758811*^9, 3.960457518406868*^9}, {
   3.960457843822421*^9, 3.960457863845792*^9}, {3.9604579006676083`*^9, 
   3.960457905079919*^9}, {3.96045799020662*^9, 3.960457994462315*^9}, {
   3.960458186790756*^9, 3.9604581909028788`*^9}, {3.9605149973047533`*^9, 
   3.9605150011633863`*^9}, 3.960939731458672*^9, 3.960940555371847*^9, 
   3.960941089735326*^9, 3.9610328153598137`*^9, 
   3.975310561136681*^9},ExpressionUUID->"058cdca0-9ce8-4779-87a2-\
72b9e6ba9520"]
}, Closed]],

Cell[CellGroupData[{

Cell["ExtractEndowFunctionWithDefaultValue", "Subsubsection",
 CellChangeTimes->{{3.868567905630082*^9, 3.868567906389614*^9}, 
   3.8685713395391026`*^9, {3.8692685734412975`*^9, 3.8692685747773304`*^9}, 
   3.869784486679248*^9, 3.8950729811170626`*^9, 3.960456477701354*^9, 
   3.9609397201654663`*^9, 
   3.961211711478238*^9},ExpressionUUID->"0d7a336a-7f98-45a1-a897-\
4082e8f2d0d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "difference", " ", "between", " ", 
     "ExtractEndowFunctionWithDefaultValue", " ", "and", " ", "normal", " ", 
     "ExtractFunction", " ", "is", " ", "that", " ", "it", " ", "allows", " ",
      "developers", " ", "to", " ", "assign", " ", "the", " ", "default", " ",
      "value", " ", "for", " ", "new", " ", "invented", " ", "property", " ", 
     RowBox[{"easily", ".", " ", "Just"}], " ", "one", " ", "place"}], ",", 
    " ", 
    RowBox[{
     RowBox[{"as", " ", "the", " ", "second", " ", "argument", " ", 
      RowBox[{"here", ".", " ", "No"}], " ", "need", " ", "to", " ", "assign",
       " ", "default", " ", "Function"}], "-", "by", "-", 
     RowBox[{
      RowBox[{"Function", ".", " ", "The"}], " ", "defualt", " ", "value", 
      " ", "means", " ", "when", " ", "user", " ", "extract", " ", "property",
       " ", "from", " ", "a", " ", "Tensor", " ", "without", " ", "that", " ",
       "property", " ", "stored"}]}], ",", " ", 
    RowBox[{
    "the", " ", "output", " ", "is", " ", "assigned", " ", "to", " ", "be", 
     " ", "that", " ", "default", " ", 
     RowBox[{"one", ".", " ", "The"}], " ", "assigned", " ", "value", " ", 
     "should", " ", "be", " ", 
     RowBox[{"\"\<harmless\>\"", ".", " ", "E", ".", "g", "."}]}], ",", " ", 
    RowBox[{
     RowBox[{"it", "'"}], "s", " ", "not", " ", "wrong", " ", "to", " ", 
     "provide", " ", "Null", " ", "List", " ", "as", " ", "the", " ", 
     "default", " ", "value", " ", "of", " ", 
     RowBox[{"TensorAssumption", ".", " ", 
      RowBox[{"It", "'"}]}], "s", " ", "harmless", " ", "to", " ", "provide", 
     " ", "Simplify", " ", "as", " ", "the", " ", "default", " ", "value", 
     " ", "of", " ", 
     RowBox[{"TensorOperator", ".", " ", "\[IndentingNewLine]", "There"}], 
     " ", "are", " ", "a", " ", "few", " ", "cases", " ", "you", " ", "want", 
     " ", "to", " ", "use", " ", "this", " ", 
     "ExtractEndowFunctionWithDefaultValue", " ", 
     RowBox[{"rule", ":", " ", 
      RowBox[{"1.", " ", "The", " ", "default", " ", "value", " ", "is", " ", 
       RowBox[{"harmless", ".", " ", "2."}], " ", "Every", " ", "Function", 
       " ", "is", " ", "expected", " ", "to", " ", "have", " ", "the", " ", 
       "same", " ", "default", " ", 
       RowBox[{"value", ".", " ", "3."}], " ", "The", " ", "property", " ", 
       "is", " ", "not", " ", "mandatory", " ", "for", " ", "users", " ", 
       "as", " ", "input", " ", "argument", " ", "of", " ", "Tensor", " ", 
       "output", " ", 
       RowBox[{"Function", ".", " ", "4."}], " ", "If", " ", "we", " ", 
       "want", " ", "to", " ", "modify", " ", "Extract", " ", "Function", " ",
        "in", " ", "specified", " ", "codes"}]}]}], ",", " ", 
    RowBox[{"e", ".", "g", "."}], ",", " ", 
    RowBox[{"TensorOperator", " ", "in", " ", 
     RowBox[{"ZeroTensorQ", ".", " ", "Then"}], " ", "the", " ", "code", " ", 
     "will", " ", "be", " ", "not", " ", "concise", " ", "and", " ", 
     "lengthy"}], ",", " ", 
    RowBox[{
     RowBox[{
     "especially", " ", "if", " ", "we", " ", "are", " ", "going", " ", "to", 
      " ", "extract", " ", "the", " ", "property", " ", 
      RowBox[{"frequently", ".", " ", "\[IndentingNewLine]", "Ther"}], " ", 
      "are", " ", "a", " ", "few", " ", "case", " ", "you", " ", "want", " ", 
      "to", " ", "use", " ", "normal", " ", "extract", " ", "function", " ", 
      "and", " ", "edit", " ", "default", " ", "value", " ", "Function"}], 
     "-", "by", "-", 
     RowBox[{"Function", ":", " ", 
      RowBox[{
      "1.", " ", "The", " ", "default", " ", "value", " ", "is", " ", 
       "sensitive", " ", "if", " ", 
       RowBox[{"it", "'"}], "s", " ", "mathematically", " ", 
       RowBox[{"wrong", ".", " ", "2."}], " ", "the", " ", "default", " ", 
       "values", " ", "varies", " ", "for", " ", "different", " ", 
       RowBox[{"Function", ".", " ", "3."}], " ", "We", " ", "can", " ", 
       "modify", " ", "the", " ", "extract", " ", "Function", " ", "in", " ", 
       "code", " ", "if", " ", "we", " ", 
       RowBox[{"don", "'"}], "t", " ", "extract", " ", 
       RowBox[{"frequently", "."}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ExtractEndowFunctionWithDefaultValue", "[", 
     RowBox[{"fn_", 
      RowBox[{"(*", 
       StyleBox[
        RowBox[{"Function", " ", "Name"}],
        FontColor->RGBColor[1, 0, 1]], "*)"}], ",", "DefualtValue_", ",", 
      "type___"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"fn", "[", 
         RowBox[{"(", 
          RowBox[{"t_Tensor", "|", 
           RowBox[{"(", 
            RowBox[{"t_List", "/;", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{"t", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"a_", "\[Rule]", " ", "b_"}], ")"}], ":>", " ", 
                  RowBox[{"(", 
                   RowBox[{"a", "\[Rule]", " ", "b"}], ")"}]}], ",", 
                 RowBox[{"{", "1", "}"}]}], "]"}], "=!=", 
               RowBox[{"{", "}"}]}], ")"}]}], ")"}]}], ")"}], "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"output", ",", "result"}], "}"}], ",", 
          RowBox[{
           RowBox[{"result", "=", 
            RowBox[{"Cases", "[", 
             RowBox[{"t", ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"fn", "\[Rule]", "output_"}], ")"}], ":>", "output"}],
               ",", 
              RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"result", "===", 
               RowBox[{"{", "}"}]}], ")"}], ",", "DefualtValue", ",", "True", 
             ",", 
             RowBox[{
             "result", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Symbol", "[", 
          RowBox[{
           RowBox[{"ToString", "[", "fn", "]"}], "<>", "\"\<NoPart\>\""}], 
          "]"}], "[", 
         RowBox[{"(", 
          RowBox[{"t_Tensor", "|", 
           RowBox[{"(", 
            RowBox[{"t_List", "/;", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{"t", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"a_", "\[Rule]", " ", "b_"}], ")"}], ":>", " ", 
                  RowBox[{"(", 
                   RowBox[{"a", "\[Rule]", " ", "b"}], ")"}]}], ",", 
                 RowBox[{"{", "1", "}"}]}], "]"}], "=!=", 
               RowBox[{"{", "}"}]}], ")"}]}], ")"}]}], ")"}], "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"output", ",", "result"}], "}"}], ",", 
          RowBox[{
           RowBox[{"result", "=", 
            RowBox[{"Cases", "[", 
             RowBox[{"t", ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"fn", "\[Rule]", "output_"}], ")"}], ":>", "output"}],
               ",", 
              RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"result", "===", 
               RowBox[{"{", "}"}]}], ")"}], ",", 
             RowBox[{"{", "DefualtValue", "}"}], ",", "True", ",", "result"}],
             "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"type", "===", "Null"}], ",", 
         RowBox[{
          RowBox[{"fn", "[", 
           RowBox[{"t_Tensor", ",", "NewValue_"}], "]"}], ":=", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", "OldValue", "}"}], ",", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cases", "[", 
                 RowBox[{"t", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"fn", "\[Rule]", "OldValue_"}], ")"}], "\[Rule]", 
                   "OldValue"}]}], "]"}], "===", 
                RowBox[{"{", "}"}]}], ")"}], ",", 
              RowBox[{"Append", "[", 
               RowBox[{"t", ",", 
                RowBox[{"fn", "\[Rule]", "NewValue"}]}], "]"}], ",", "True", 
              ",", 
              RowBox[{"t", "/.", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"fn", "\[Rule]", "OldValue_"}], ")"}], "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"fn", "\[Rule]", "NewValue"}], ")"}]}]}]}], "]"}]}], 
           "]"}]}], ",", 
         RowBox[{"type", "=!=", "Null"}], ",", 
         RowBox[{
          RowBox[{"fn", "[", 
           RowBox[{"t_Tensor", ",", "NewValue_type"}], "]"}], ":=", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", "OldValue", "}"}], ",", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cases", "[", 
                 RowBox[{"t", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"fn", "\[Rule]", "OldValue_"}], ")"}], "\[Rule]", 
                   "OldValue"}]}], "]"}], "===", 
                RowBox[{"{", "}"}]}], ")"}], ",", 
              RowBox[{"Append", "[", 
               RowBox[{"t", ",", 
                RowBox[{"fn", "\[Rule]", "NewValue"}]}], "]"}], ",", "True", 
              ",", 
              RowBox[{"t", "/.", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"fn", "\[Rule]", "OldValue_"}], ")"}], "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"fn", "\[Rule]", "NewValue"}], ")"}]}]}]}], "]"}]}], 
           "]"}]}]}], "]"}], ";"}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"ExtractEndowFunctionWithDefaultValue", "[", 
    RowBox[{"TensorAssumption", ",", 
     RowBox[{"{", "}"}], ",", "List"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"ExtractEndowFunctionWithDefaultValue", "[", 
    RowBox[{"TensorOperator", ",", "Simplify"}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8685679623021145`*^9, 3.8685680314928904`*^9}, {
   3.8685681569581947`*^9, 3.8685681641497574`*^9}, {3.8685691764693556`*^9, 
   3.868569195171815*^9}, {3.868569322339351*^9, 3.868569329441968*^9}, {
   3.86856969760701*^9, 3.8685697216387405`*^9}, {3.8685697542816424`*^9, 
   3.8685697850306654`*^9}, {3.8685698168875837`*^9, 
   3.8685698331490974`*^9}, {3.868569901430086*^9, 3.8685699165013437`*^9}, {
   3.8685700571434937`*^9, 3.868570062308307*^9}, {3.868570631278344*^9, 
   3.8685706321193624`*^9}, {3.8685713749040813`*^9, 3.868571385397997*^9}, {
   3.868585260863675*^9, 3.868585269575096*^9}, {3.8685853292384205`*^9, 
   3.8685853659269342`*^9}, {3.86858586200412*^9, 3.8685858653304224`*^9}, {
   3.8692685792576027`*^9, 3.869268581764486*^9}, {3.869268770906531*^9, 
   3.8692688149768305`*^9}, {3.869268880688589*^9, 3.86926889686454*^9}, {
   3.8692689409365473`*^9, 3.8692689582249627`*^9}, {3.869269009312674*^9, 
   3.8692690195040016`*^9}, {3.8692690598797956`*^9, 3.8692690914544606`*^9}, 
   3.8696539130614195`*^9, {3.8696595977559977`*^9, 3.869659626167713*^9}, {
   3.8696596857138553`*^9, 3.8696597056014357`*^9}, 3.869659844861117*^9, {
   3.869659879545611*^9, 3.8696598828111525`*^9}, 3.8696599805295024`*^9, {
   3.8696603808613415`*^9, 3.869660391316813*^9}, 3.869660426445712*^9, {
   3.869660562302675*^9, 3.8696606109036407`*^9}, {3.869660732303149*^9, 
   3.8696607344148293`*^9}, {3.8696610257207403`*^9, 
   3.8696610266994286`*^9}, {3.869661092751726*^9, 3.869661097879053*^9}, {
   3.8696611534659452`*^9, 3.8696611557783885`*^9}, {3.8696612161894655`*^9, 
   3.869661216439459*^9}, {3.869661549015382*^9, 3.8696615605825176`*^9}, {
   3.8696615919862003`*^9, 3.8696616165348463`*^9}, {3.8696628404281015`*^9, 
   3.869662878557923*^9}, {3.869662951246763*^9, 3.8696629528682675`*^9}, {
   3.869736260489716*^9, 3.8697363893193007`*^9}, 3.8697364639982686`*^9, {
   3.8697365410127926`*^9, 3.869736552173975*^9}, {3.8697368702522235`*^9, 
   3.8697368719861546`*^9}, {3.8697369623634496`*^9, 
   3.8697369775780706`*^9}, {3.869780586093996*^9, 3.869780626021951*^9}, {
   3.869780720757214*^9, 3.8697807276609554`*^9}, {3.8697833609914165`*^9, 
   3.869783368295017*^9}, {3.8697834874231205`*^9, 3.869783509998849*^9}, {
   3.869784472723075*^9, 3.8697844837960243`*^9}, {3.869784550419446*^9, 
   3.869784615882824*^9}, 3.8697851155517893`*^9, {3.8697851629836664`*^9, 
   3.8697851865511255`*^9}, {3.8697870038720407`*^9, 
   3.8697870890085225`*^9}, {3.8697871355418167`*^9, 
   3.8697871467579594`*^9}, {3.8697878504716015`*^9, 
   3.8697879121680965`*^9}, {3.869807029923705*^9, 3.869807157825574*^9}, 
   3.869807209826666*^9, 3.8698072862740574`*^9, {3.8726560742949734`*^9, 
   3.8726560890334406`*^9}, {3.873938944121187*^9, 3.8739389745703926`*^9}, 
   3.875245713080204*^9, {3.875245928780851*^9, 3.8752459595012364`*^9}, {
   3.8752459912209635`*^9, 3.8752460435115013`*^9}, {3.8752463227198257`*^9, 
   3.875246326235374*^9}, {3.875246360042892*^9, 3.875246387344263*^9}, {
   3.8752465082725024`*^9, 3.875246549904358*^9}, {3.8752469634629526`*^9, 
   3.875246964969907*^9}, {3.875247461640865*^9, 3.875247471780938*^9}, {
   3.8752476568665023`*^9, 3.875247695363555*^9}, {3.875248359532177*^9, 
   3.875248370803824*^9}, {3.875248435234214*^9, 3.875248487544714*^9}, {
   3.884769124813263*^9, 3.884769126975298*^9}, 3.895072991194916*^9, {
   3.8955490510140657`*^9, 3.895549061932602*^9}, {3.895549292023367*^9, 
   3.895549358984203*^9}, 3.8955558382325664`*^9, {3.8971955878271246`*^9, 
   3.897195589401308*^9}, {3.89874898055123*^9, 3.898748983051158*^9}, {
   3.898752392518583*^9, 3.898752399961263*^9}, {3.96045649496906*^9, 
   3.960456516727957*^9}, {3.9604568631059113`*^9, 3.960456866626913*^9}, {
   3.9604572342452917`*^9, 3.960457243385705*^9}, {3.960457431823202*^9, 
   3.960457436537438*^9}, {3.960457513758811*^9, 3.960457518406868*^9}, {
   3.960457843822421*^9, 3.960457863845792*^9}, {3.9604579006676083`*^9, 
   3.960457905079919*^9}, {3.96045799020662*^9, 3.960457994462315*^9}, {
   3.960458186790756*^9, 3.9604581909028788`*^9}, {3.9605149973047533`*^9, 
   3.9605150011633863`*^9}, 3.960939731458672*^9, 3.960940555371847*^9, 
   3.960941089735326*^9, 3.9610328153598137`*^9, {3.961211725406455*^9, 
   3.961211732691312*^9}, {3.9622425033290586`*^9, 3.962242503742659*^9}, {
   3.9646657425271463`*^9, 3.964665895017478*^9}, {3.96466594175922*^9, 
   3.964665970622511*^9}, 3.964666008983107*^9, {3.9646660436469584`*^9, 
   3.964666395709916*^9}, {3.964666437990265*^9, 3.964666491447357*^9}, {
   3.964666532300886*^9, 3.964666777399068*^9}, 3.97376554596874*^9, {
   3.9753105767206984`*^9, 3.97531058228448*^9}, {3.975310637157157*^9, 
   3.97531067687411*^9}, {3.975310744709004*^9, 
   3.975310746847736*^9}},ExpressionUUID->"aff80114-7aa4-47f3-a778-\
b0ad83b6972e"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["ToExpressionForm", "Subsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.533880012946951*^9, 3.5338800148345547`*^9}, {
   3.606329216258676*^9, 3.6063292218312616`*^9}, 3.606497441942197*^9, 
   3.8691357631635294`*^9, 3.8932955067668486`*^9, 
   3.8947748025855646`*^9},ExpressionUUID->"a6b6a354-d554-49ba-8092-\
63da772c0038"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ToExpressionForm", "[", "tt_Tensor", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "coord", ",", "dcoords", ",", "delcoords", ",", "indices", ",", "idxl", 
       ",", "mx", ",", "mx2", ",", "mx2basis", ",", "mx2component", ",", 
       "output", ",", "dim", ",", "basislist", ",", "ilist", ",", "i", ",", 
       "j", ",", "sequencelist", ",", "isequencelist", ",", "a", ",", "b", 
       ",", "sa", ",", "IndptElements", ",", "indptN", ",", "position", ",", 
       "indptEleValue", ",", "iilistValue", ",", "countlist"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"coord", "=", 
       RowBox[{"Coordinates", "[", "tt", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dcoords", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[DifferentialD]", "#"}], ")"}], "&"}], "/@", "coord"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"delcoords", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Del]", "#"}], ")"}], "&"}], "/@", "coord"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"indices", "=", 
       RowBox[{"RemoveUnderBarredIndices", "[", 
        RowBox[{"Indices", "[", "tt", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"idxl", "=", 
       RowBox[{"RankNumber", "[", "indices", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dim", "=", 
       RowBox[{"Length", "[", "coord", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"basislist", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Sgn", "[", 
             RowBox[{
             "indices", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "]"}], "===", "1"}], ",", 
           "delcoords", ",", 
           RowBox[{
            RowBox[{"Sgn", "[", 
             RowBox[{
             "indices", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "]"}], "===", 
            RowBox[{"-", "1"}]}], ",", "dcoords"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "idxl"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ilist", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Unique", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "1", ",", "idxl"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sequencelist", "=", 
       RowBox[{"Quiet", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{
            "basislist", "\[LeftDoubleBracket]", "a", 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "ilist", "\[LeftDoubleBracket]", "a", "\[RightDoubleBracket]"}]}],
            "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "1", ",", "idxl"}], "}"}]}], "]"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"TensorSymmetry", "[", "tt", "]"}], "\[LeftDoubleBracket]",
            "1", "\[RightDoubleBracket]"}], "===", 
          RowBox[{"Antisymmetric", "[", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", 
             RowBox[{"RemoveUnderBarredIndices", "[", 
              RowBox[{"Indices", "[", "tt", "]"}], "]"}], "]"}], "]"}], 
           "]"}]}], ")"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"sa", "=", 
          RowBox[{"SymmetrizedArray", "[", 
           RowBox[{"TensorComponents", "[", "tt", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"IndptElements", "=", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"SymmetrizedArrayRules", "[", "sa", "]"}], ",", 
            RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"indptN", "=", 
          RowBox[{"Length", "[", "IndptElements", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"position", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"IndptElements", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "indptN"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"indptEleValue", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"IndptElements", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "indptN"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"iilistValue", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"(", 
              RowBox[{"ilist", "\[Rule]", "#"}], ")"}], "]"}], "&"}], "/@", 
           "position"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Plus", "@@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "indptEleValue", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], " ", 
             RowBox[{"(", 
              RowBox[{"TensorWedge", "@@", 
               RowBox[{"(", 
                RowBox[{"sequencelist", "/.", 
                 RowBox[{
                 "iilistValue", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}]}], ")"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "indptN"}], "}"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"TensorSymmetry", "[", "tt", "]"}], "\[LeftDoubleBracket]",
            "1", "\[RightDoubleBracket]"}], "===", 
          RowBox[{"Symmetric", "[", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", 
             RowBox[{"RemoveUnderBarredIndices", "[", 
              RowBox[{"Indices", "[", "tt", "]"}], "]"}], "]"}], "]"}], 
           "]"}]}], ")"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"sa", "=", 
          RowBox[{"SymmetrizedArray", "[", 
           RowBox[{"TensorComponents", "[", "tt", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"IndptElements", "=", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"SymmetrizedArrayRules", "[", "sa", "]"}], ",", 
            RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"indptN", "=", 
          RowBox[{"Length", "[", "IndptElements", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"position", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"IndptElements", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "indptN"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"indptEleValue", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"IndptElements", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "indptN"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"iilistValue", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"(", 
              RowBox[{"ilist", "\[Rule]", "#"}], ")"}], "]"}], "&"}], "/@", 
           "position"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Plus", "@@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"countlist", "=", 
              RowBox[{"Counts", "[", 
               RowBox[{
               "position", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "]"}]}], ";", 
             RowBox[{
              RowBox[{"Multinomial", "[", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                  "countlist", "\[LeftDoubleBracket]", "j", 
                   "\[RightDoubleBracket]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", 
                    RowBox[{"Length", "[", "countlist", "]"}]}], "}"}]}], 
                 "]"}]}], "]"}], " ", 
              RowBox[{
              "indptEleValue", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], " ", 
              RowBox[{"(", 
               RowBox[{"Times", "@@", 
                RowBox[{"(", 
                 RowBox[{"sequencelist", "/.", 
                  RowBox[{
                  "iilistValue", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]}], ")"}]}], ")"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "indptN"}], "}"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", ",", "True", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"isequencelist", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"#", ",", "1", ",", "dim"}], "}"}], "&"}], "/@", 
           "ilist"}]}], ";", 
         RowBox[{"Plus", "@@", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"TensorComponents", "[", "tt", "]"}], 
               "\[LeftDoubleBracket]", 
               RowBox[{"Sequence", "@@", "ilist"}], "\[RightDoubleBracket]"}],
               " ", 
              RowBox[{"TensorProduct", "[", 
               RowBox[{"Sequence", "@@", "sequencelist"}], "]"}]}], ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"Sequence", "@@", "isequencelist"}], "]"}]}], "]"}], 
           "]"}]}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.6063292322449217`*^9, 
   3.606329256638296*^9}, {3.6064974490496035`*^9, 3.6064974614663134`*^9}, {
   3.869045786004552*^9, 3.869045818873536*^9}, 3.8691008170883627`*^9, {
   3.8691357685763817`*^9, 3.869135793280121*^9}, {3.8691358557040486`*^9, 
   3.8691359078236876`*^9}, {3.8691359596871786`*^9, 3.869135965936968*^9}, 
   3.8691360363909674`*^9, {3.8698006308619995`*^9, 3.869800727978799*^9}, 
   3.8703878650567365`*^9, {3.8703879080710335`*^9, 3.870387931141947*^9}, 
   3.871551777474723*^9, {3.871596998629507*^9, 3.871597000475988*^9}, {
   3.8752417741682405`*^9, 3.875241802158727*^9}, {3.8947748041388054`*^9, 
   3.8947748052926655`*^9}, {3.9599324918727837`*^9, 3.959932500784028*^9}, {
   3.975310758537918*^9, 
   3.975310759541236*^9}},ExpressionUUID->"b8663cdd-4807-484a-941a-\
972af46a9cf8"]
}, Closed]],

Cell[CellGroupData[{

Cell["ToTensorComponents", "Subsection",
 CellChangeTimes->{
  3.894776773532593*^9},ExpressionUUID->"f950017d-de23-4b3a-bc36-\
deac1ceb23c6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ToTensorComponents", "[", 
     RowBox[{
      RowBox[{"stuff_", "/;", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"TestExpressionForm", "[", "stuff", "]"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"{", "stuff", "}"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"\[DifferentialD]", "a_"}], ")"}], "\[Rule]", " ", 
               "a"}], ",", "Infinity"}], "]"}], "=!=", 
            RowBox[{"{", "}"}]}], "||", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", "stuff", "}"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[Del]", "a_"}], ")"}], "\[Rule]", " ", "a"}], ",", 
               "Infinity"}], "]"}], "=!=", 
             RowBox[{"{", "}"}]}], ")"}]}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"{", "stuff", "}"}], ",", 
             RowBox[{"TensorWedge", "[", "__", "]"}], ",", "Infinity"}], 
            "]"}], "===", 
           RowBox[{"{", "}"}]}], ")"}], "&&", 
         RowBox[{"!", 
          RowBox[{
          "TestSymmetricTensorExpressionForm", "[", "stuff", "]"}]}]}], 
        ")"}]}], ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "tpexpand", ",", "dcoords", ",", "delcoords", ",", "idxl", ",", "dim", 
        ",", "basislist", ",", "ilist", ",", "sequencelist", ",", 
        "isequencelist", ",", "output", ",", "i", ",", "b", ",", "a", ",", 
        "coord", ",", "CasesTP", ",", "CasesTPFirstList", ",", "basissgn"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"coord", "=", 
        RowBox[{"OptionValue", "[", "Coordinates", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tpexpand", "=", 
        RowBox[{"stuff", "//", "TensorExpand"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dcoords", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[DifferentialD]", "#"}], ")"}], "&"}], "/@", "coord"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"delcoords", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Del]", "#"}], ")"}], "&"}], "/@", "coord"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"CasesTP", "=", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"{", "tpexpand", "}"}], ",", 
          RowBox[{
           RowBox[{"TensorProduct", "[", 
            RowBox[{"a_", ",", "___"}], "]"}], "/;", 
           RowBox[{"MatchQ", "[", 
            RowBox[{"a", ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[DifferentialD]", "__"}], "|", 
               RowBox[{"\[Del]", "__"}]}], ")"}]}], "]"}]}], ",", 
          "Infinity"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"CasesTPFirstList", "=", 
        RowBox[{"Apply", "[", 
         RowBox[{"List", ",", 
          RowBox[{"First", "[", "CasesTP", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"basissgn", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"BasisSgn", "[", "#", "]"}], "&"}], "/@", 
         "CasesTPFirstList"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"idxl", "=", 
        RowBox[{"Length", "[", "basissgn", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dim", "=", 
        RowBox[{"Length", "[", "coord", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"basislist", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "basissgn", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "===", "1"}], ",", "delcoords", ",", 
            RowBox[{
             RowBox[{
             "basissgn", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "===", 
             RowBox[{"-", "1"}]}], ",", "dcoords"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "idxl"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ilist", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Unique", "[", "i", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"b", ",", "1", ",", "idxl"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sequencelist", "=", 
        RowBox[{"Quiet", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Part", "[", 
            RowBox[{
             RowBox[{
             "basislist", "\[LeftDoubleBracket]", "a", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "ilist", "\[LeftDoubleBracket]", "a", 
              "\[RightDoubleBracket]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "1", ",", "idxl"}], "}"}]}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"isequencelist", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#", ",", "1", ",", "dim"}], "}"}], "&"}], "/@", 
         "ilist"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"output", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Coefficient", "[", 
           RowBox[{"tpexpand", ",", 
            RowBox[{"TensorProduct", "[", 
             RowBox[{"Sequence", "@@", "sequencelist"}], "]"}]}], "]"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"Sequence", "@@", "isequencelist"}], "]"}]}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ToTensorComponents", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"stuff_", "/;", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"TestExpressionForm", "[", "stuff", "]"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"{", "stuff", "}"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"\[DifferentialD]", "a_"}], ")"}], "\[Rule]", " ", 
               "a"}], ",", "Infinity"}], "]"}], "=!=", 
            RowBox[{"{", "}"}]}], "||", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", "stuff", "}"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[Del]", "a_"}], ")"}], "\[Rule]", " ", "a"}], ",", 
               "Infinity"}], "]"}], "=!=", 
             RowBox[{"{", "}"}]}], ")"}]}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"{", "stuff", "}"}], ",", 
             RowBox[{"TensorWedge", "[", "__", "]"}], ",", "Infinity"}], 
            "]"}], "===", 
           RowBox[{"{", "}"}]}], ")"}], "&&", 
         RowBox[{"TestSymmetricTensorExpressionForm", "[", "stuff", "]"}]}], 
        ")"}]}], ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "texpand", ",", "dcoords", ",", "delcoords", ",", "idxl", ",", "dim", 
        ",", "basislist", ",", "ilist", ",", "sequencelist", ",", 
        "isequencelist", ",", "output", ",", "i", ",", "b", ",", "a", ",", 
        "coord", ",", "\[Epsilon]downpower", ",", "\[Epsilon]uppower", ",", 
        "\[Epsilon]", ",", "sgn"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"coord", "=", 
        RowBox[{"OptionValue", "[", "Coordinates", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"texpand", "=", 
        RowBox[{"stuff", "//", "Expand"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dcoords", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[DifferentialD]", "#"}], ")"}], "&"}], "/@", "coord"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"delcoords", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Del]", "#"}], ")"}], "&"}], "/@", "coord"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Epsilon]downpower", "=", 
        RowBox[{
         FractionBox[
          RowBox[{"texpand", "/.", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Del]", "a_"}], ")"}], "->", 
            RowBox[{"(", 
             RowBox[{"\[Epsilon]", 
              RowBox[{"\[Del]", "a"}]}], ")"}]}]}], "texpand"], "//", 
         "Simplify"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Epsilon]uppower", "=", 
        RowBox[{
         FractionBox[
          RowBox[{"texpand", "/.", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[DifferentialD]", "a_"}], ")"}], "->", 
            RowBox[{"(", 
             RowBox[{"\[Epsilon]", 
              RowBox[{"\[DifferentialD]", "a"}]}], ")"}]}]}], "texpand"], "//",
          "Simplify"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Epsilon]uppower", "===", "1"}], ")"}], "&&", 
          RowBox[{"MatchQ", "[", 
           RowBox[{"\[Epsilon]downpower", ",", 
            RowBox[{"Power", "[", 
             RowBox[{"\[Epsilon]", ",", "_"}], "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"sgn", "=", 
           RowBox[{"-", "1"}]}], ";", 
          RowBox[{"idxl", "=", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"{", "\[Epsilon]downpower", "}"}], ",", 
              RowBox[{
               RowBox[{"Power", "[", 
                RowBox[{"\[Epsilon]", ",", "idxl_"}], "]"}], "->", "idxl"}]}],
              "]"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
           ";"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Epsilon]downpower", "===", "1"}], ")"}], "&&", 
          RowBox[{"MatchQ", "[", 
           RowBox[{"\[Epsilon]uppower", ",", 
            RowBox[{"Power", "[", 
             RowBox[{"\[Epsilon]", ",", "_"}], "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"sgn", "=", 
           RowBox[{"+", "1"}]}], ";", 
          RowBox[{"idxl", "=", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"{", "\[Epsilon]uppower", "}"}], ",", 
              RowBox[{
               RowBox[{"Power", "[", 
                RowBox[{"\[Epsilon]", ",", "idxl_"}], "]"}], "->", "idxl"}]}],
              "]"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
           ";"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Epsilon]uppower", "===", "1"}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{"\[Epsilon]downpower", "===", "\[Epsilon]"}], ")"}]}], ",", 
         RowBox[{
          RowBox[{"sgn", "=", 
           RowBox[{"-", "1"}]}], ";", 
          RowBox[{"idxl", "=", "1"}], ";"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Epsilon]downpower", "===", "1"}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{"\[Epsilon]uppower", "===", "\[Epsilon]"}], ")"}]}], ",", 
         RowBox[{
          RowBox[{"sgn", "=", 
           RowBox[{"+", "1"}]}], ";", 
          RowBox[{"idxl", "=", "1"}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dim", "=", 
        RowBox[{"Length", "[", "coord", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"basislist", "=", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"sgn", "===", "1"}], ")"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"dcoords", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "idxl"}], "}"}]}], "]"}], ",", 
          RowBox[{"(", 
           RowBox[{"sgn", "===", 
            RowBox[{"-", "1"}]}], ")"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"delcoords", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "idxl"}], "}"}]}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"ilist", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Unique", "[", "i", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"b", ",", "1", ",", "idxl"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sequencelist", "=", 
        RowBox[{"Quiet", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Part", "[", 
            RowBox[{
             RowBox[{
             "basislist", "\[LeftDoubleBracket]", "a", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "ilist", "\[LeftDoubleBracket]", "a", 
              "\[RightDoubleBracket]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "1", ",", "idxl"}], "}"}]}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"isequencelist", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#", ",", "1", ",", "dim"}], "}"}], "&"}], "/@", 
         "ilist"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"output", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           FractionBox["1", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Permutations", "[", "sequencelist", "]"}], "//", 
              "Length"}], ")"}]], " ", 
           RowBox[{"Coefficient", "[", 
            RowBox[{"texpand", ",", 
             RowBox[{"Times", "[", 
              RowBox[{"Sequence", "@@", "sequencelist"}], "]"}]}], "]"}]}], 
          ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"Sequence", "@@", "isequencelist"}], "]"}]}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ToTensorComponents", "[", 
     RowBox[{
      RowBox[{"stuff_", "/;", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"TestExpressionForm", "[", "stuff", "]"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"{", "stuff", "}"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"\[DifferentialD]", "a_"}], ")"}], "\[Rule]", " ", 
               "a"}], ",", "Infinity"}], "]"}], "=!=", 
            RowBox[{"{", "}"}]}], "||", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", "stuff", "}"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[Del]", "a_"}], ")"}], "\[Rule]", " ", "a"}], ",", 
               "Infinity"}], "]"}], "=!=", 
             RowBox[{"{", "}"}]}], ")"}]}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"{", "stuff", "}"}], ",", 
             RowBox[{"TensorWedge", "[", "__", "]"}], ",", "Infinity"}], 
            "]"}], "=!=", 
           RowBox[{"{", "}"}]}], ")"}]}], ")"}]}], ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "twteProduct", ",", "dcoords", ",", "delcoords", ",", "idxl", ",", 
        "dim", ",", "basislist", ",", "ilist", ",", "sequencelist", ",", 
        "isequencelist", ",", "output", ",", "i", ",", "b", ",", "a", ",", 
        "coord"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"twteProduct", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"stuff", "//", "TensorExpand"}], ")"}], "//", 
         "WedgeExpand"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ToTensorComponents", "[", 
        RowBox[{"twteProduct", ",", 
         RowBox[{"Coordinates", "\[Rule]", 
          RowBox[{"OptionValue", "[", "Coordinates", "]"}]}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Unprotect", "[", "TensorProduct", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TensorProduct", "[", 
     RowBox[{"x1___", ",", 
      RowBox[{"Times", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[DifferentialD]", "coord_"}], ")"}], ",", 
        RowBox[{"x3___", "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TestExpressionForm", "[", 
            RowBox[{
             RowBox[{"Unique", "[", "a", "]"}], "[", "x3", "]"}], "]"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", "x3", "}"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[DifferentialD]", "a_"}], ")"}], "\[Rule]", " ", 
                "a"}], ",", "Infinity"}], "]"}], "===", 
             RowBox[{"{", "}"}]}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", "x3", "}"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[Del]", "a_"}], ")"}], "\[Rule]", " ", "a"}], ",", 
               "Infinity"}], "]"}], "===", 
             RowBox[{"{", "}"}]}], ")"}]}], ")"}]}]}], "]"}], ",", "x2___"}], 
     "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Times", "@@", 
       RowBox[{"{", "x3", "}"}]}], ")"}], " ", 
     RowBox[{"TensorProduct", "[", 
      RowBox[{"x1", ",", 
       RowBox[{"\[DifferentialD]", "coord"}], ",", "x2"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TensorProduct", "[", 
    RowBox[{"x1___", ",", 
     RowBox[{"Times", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Del]", "coord_"}], ")"}], ",", 
       RowBox[{"x3___", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestExpressionForm", "[", 
           RowBox[{
            RowBox[{"Unique", "[", "a", "]"}], "[", "x3", "]"}], "]"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"{", "x3", "}"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"\[DifferentialD]", "a_"}], ")"}], "\[Rule]", " ", 
               "a"}], ",", "Infinity"}], "]"}], "===", 
            RowBox[{"{", "}"}]}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"{", "x3", "}"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"\[Del]", "a_"}], ")"}], "\[Rule]", " ", "a"}], ",", 
              "Infinity"}], "]"}], "===", 
            RowBox[{"{", "}"}]}], ")"}]}], ")"}]}]}], "]"}], ",", "x2___"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Times", "@@", 
      RowBox[{"{", "x3", "}"}]}], ")"}], " ", 
    RowBox[{"TensorProduct", "[", 
     RowBox[{"x1", ",", 
      RowBox[{"\[Del]", "coord"}], ",", "x2"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", "TensorProduct", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.894784174085971*^9, 3.894784180327305*^9}, {
   3.894886198642889*^9, 3.8948861990796223`*^9}, {3.8948863500420837`*^9, 
   3.8948863803795466`*^9}, 3.894886426279498*^9, {3.8948878892653427`*^9, 
   3.894887899059771*^9}, 3.8948883811674385`*^9, 3.8948884713319635`*^9, {
   3.8948885365609837`*^9, 3.894888566434301*^9}, {3.8948887478682528`*^9, 
   3.8948887553827143`*^9}, {3.8948888600468254`*^9, 
   3.8948888844893503`*^9}, {3.8948896470131865`*^9, 3.8948896551791925`*^9}, 
   3.894890235819585*^9, {3.8948904816645813`*^9, 3.8948904835775843`*^9}, {
   3.895116389466457*^9, 3.8951163990525527`*^9}, 3.8951165584633303`*^9, {
   3.8955558382405624`*^9, 3.895555838252555*^9}, {3.8973008939411807`*^9, 
   3.897300896508587*^9}, {3.953086801722981*^9, 3.953086802626281*^9}, 
   3.9533460576475887`*^9, 3.957859982580268*^9, {3.959933119723778*^9, 
   3.9599331743573103`*^9}, 3.959933327161468*^9, {3.9677774517517104`*^9, 
   3.967777451765316*^9}, 3.968888854244691*^9, {3.9688898157530613`*^9, 
   3.968889823922243*^9}, {3.9688898672975817`*^9, 3.9688898695691757`*^9}, {
   3.969273126400332*^9, 3.969273132299777*^9}, {3.969273983846855*^9, 
   3.9692740064400673`*^9}, {3.969274564739493*^9, 3.969274576414053*^9}, {
   3.969275859413402*^9, 3.969275864589676*^9}, 3.975293104069968*^9, 
   3.975301740474769*^9, {3.975310769060644*^9, 
   3.975310846489567*^9}},ExpressionUUID->"bea6ffd1-ee56-429a-9016-\
22680cfeaabc"]
}, Closed]],

Cell[CellGroupData[{

Cell["WedgeExpand", "Subsection",
 CellChangeTimes->{3.894776845533681*^9, 3.895542967354926*^9, 
  3.975293108696063*^9, 
  3.9753017419432774`*^9},ExpressionUUID->"311d1f40-968d-4328-b149-\
24ed785a7f46"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WedgeExpand", "[", 
     RowBox[{"tw_", "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Head", "[", "tw", "]"}], "=!=", "TensorWedge"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"{", "tw", "}"}], ",", 
            RowBox[{"TensorWedge", "[", "__", "]"}], ",", "Infinity"}], "]"}],
           "=!=", 
          RowBox[{"{", "}"}]}], ")"}]}], ")"}]}], "]"}], ":=", 
    RowBox[{"tw", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TensorWedge", "[", "xxx___", "]"}], "\[RuleDelayed]", " ", 
       RowBox[{"WedgeExpand", "[", 
        RowBox[{"TensorWedge", "[", "xxx", "]"}], "]"}]}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Unprotect", "[", "TensorWedge", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TensorWedge", "[", 
     RowBox[{"x1___", ",", 
      RowBox[{"Times", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[DifferentialD]", "coord_"}], ")"}], ",", 
        RowBox[{"x3___", "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TestExpressionForm", "[", 
            RowBox[{
             RowBox[{"Unique", "[", "a", "]"}], "[", "x3", "]"}], "]"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", "x3", "}"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[DifferentialD]", "a_"}], ")"}], "\[Rule]", " ", 
                "a"}], ",", "Infinity"}], "]"}], "===", 
             RowBox[{"{", "}"}]}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", "x3", "}"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[Del]", "a_"}], ")"}], "\[Rule]", " ", "a"}], ",", 
               "Infinity"}], "]"}], "===", 
             RowBox[{"{", "}"}]}], ")"}]}], ")"}]}]}], "]"}], ",", "x2___"}], 
     "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Times", "@@", 
       RowBox[{"{", "x3", "}"}]}], ")"}], " ", 
     RowBox[{"TensorWedge", "[", 
      RowBox[{"x1", ",", 
       RowBox[{"\[DifferentialD]", "coord"}], ",", "x2"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TensorWedge", "[", 
    RowBox[{"x1___", ",", 
     RowBox[{"Times", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Del]", "coord_"}], ")"}], ",", 
       RowBox[{"x3___", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestExpressionForm", "[", 
           RowBox[{
            RowBox[{"Unique", "[", "a", "]"}], "[", "x3", "]"}], "]"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"{", "x3", "}"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"\[DifferentialD]", "a_"}], ")"}], "\[Rule]", " ", 
               "a"}], ",", "Infinity"}], "]"}], "===", 
            RowBox[{"{", "}"}]}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"{", "x3", "}"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"\[Del]", "a_"}], ")"}], "\[Rule]", " ", "a"}], ",", 
              "Infinity"}], "]"}], "===", 
            RowBox[{"{", "}"}]}], ")"}]}], ")"}]}]}], "]"}], ",", "x2___"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Times", "@@", 
      RowBox[{"{", "x3", "}"}]}], ")"}], " ", 
    RowBox[{"TensorWedge", "[", 
     RowBox[{"x1", ",", 
      RowBox[{"\[Del]", "coord"}], ",", "x2"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", "TensorWedge", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8947841563956447`*^9, 3.8947841689053955`*^9}, {
   3.8947997720788603`*^9, 3.89479977340701*^9}, {3.8955429582866173`*^9, 
   3.8955429582896156`*^9}, {3.8955431086795607`*^9, 3.895543143796641*^9}, {
   3.895555838257552*^9, 3.8955558382595525`*^9}, {3.897528778781376*^9, 
   3.897528781603902*^9}, {3.975293093161251*^9, 3.975293093166254*^9}, {
   3.9753017310457306`*^9, 3.975301731047737*^9}, 
   3.975310856277891*^9},ExpressionUUID->"21e201e5-ef62-4f4d-b138-\
529dc05ee9fc"]
}, Closed]],

Cell[CellGroupData[{

Cell["Metric", "Subsection",
 CellChangeTimes->{{3.520303444109375*^9, 3.520303449859375*^9}, {
  3.520303728828125*^9, 3.52030373996875*^9}, {3.52169976384375*^9, 
  3.52169981365625*^9}, {3.52173410659375*^9, 
  3.52173414321875*^9}},ExpressionUUID->"b3b5ca54-2a98-41b1-b0bc-\
4a1ae48419be"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Entering", " ", "a", " ", "geometry"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"I", " ", "of", " ", 
     RowBox[{"II", ":", " ", 
      RowBox[{
      "Metric", " ", "takes", " ", "in", " ", "a", " ", "specific", " ", 
       "metric", " ", "and", " ", "Coordinates"}]}]}], ",", " ", 
    RowBox[{"computes", " ", "Christoffel", " ", "symbols"}], ",", "Riemann", 
    ",", " ", 
    RowBox[{"Ricci", " ", "tensor", " ", "and", " ", "scalar"}], ",", 
    RowBox[{
    "and", " ", "returns", " ", "a", " ", "Tensor", " ", "containing", " ", 
     "these", " ", 
     RowBox[{"computations", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Metric", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"(", 
          RowBox[{"TestIndices", "[", "\[Mu]T", "]"}], ")"}]}], ",", 
        RowBox[{"\[Nu]T_", "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TestIndices", "[", "\[Nu]T", "]"}], "&&", 
           RowBox[{"!", 
            RowBox[{"TestOverHatIndex", "[", "\[Nu]T", "]"}]}]}], ")"}]}], 
        ",", 
        RowBox[{"matrix_", "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"Dimensions", "[", "matrix", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"nn_", ",", "nn_"}], "}"}]}], "]"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Head", "[", "matrix", "]"}], "===", "List"}], ")"}]}], 
          ")"}]}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"SubMinus", "[", "_", "]"}], ",", 
            RowBox[{"SubMinus", "[", "_", "]"}]}], "}"}]}], "]"}], "||", 
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"SuperMinus", "[", "_", "]"}], ",", 
            RowBox[{"SuperMinus", "[", "_", "]"}]}], "}"}]}], "]"}]}], 
       ")"}]}], ":=", 
     RowBox[{
      RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"TensorType", "\[Rule]", "\"\<Metric\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Coordinates", "\[Rule]", 
         RowBox[{"OptionValue", "[", "Coordinates", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TensorName", "\[Rule]", 
         RowBox[{"OptionValue", "[", "TensorName", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"StartIndex", "\[Rule]", 
         RowBox[{"OptionValue", "[", "StartIndex", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ChristoffelOperator", "\[Rule]", 
         RowBox[{"OptionValue", "[", "ChristoffelOperator", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"RiemannOperator", "\[Rule]", 
         RowBox[{"OptionValue", "[", "RiemannOperator", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"RicciOperator", "\[Rule]", 
         RowBox[{"OptionValue", "[", "RicciOperator", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"RicciScalarOperator", "\[Rule]", 
         RowBox[{"OptionValue", "[", "RicciScalarOperator", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TooltipDisplay", "\[Rule]", 
         RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TooltipStyle", "\[Rule]", 
         RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Indices", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TensorComponents", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{"matrix", "//", 
           RowBox[{"OptionValue", "[", "MetricOperator", "]"}]}], ")"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"FlatMetric", "\[Rule]", 
         RowBox[{"OptionValue", "[", "FlatMetric", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"OrthonormalFrameField", "\[Rule]", 
         RowBox[{"OptionValue", "[", "OrthonormalFrameField", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"InverseOrthonormalFrameField", "\[Rule]", 
         RowBox[{"OptionValue", "[", "InverseOrthonormalFrameField", "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"OrthonormalFrameFieldOperator", "\[Rule]", 
         RowBox[{"OptionValue", "[", "OrthonormalFrameFieldOperator", "]"}]}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"OrthonormalFrameFieldIndices", "\[Rule]", 
         RowBox[{"OptionValue", "[", "OrthonormalFrameFieldIndices", "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"TensorAssumption", "\[Rule]", " ", 
         RowBox[{"OptionValue", "[", "TensorAssumption", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TensorOperator", "\[Rule]", " ", 
         RowBox[{"OptionValue", "[", "TensorOperator", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Head", "[", 
           RowBox[{"OptionValue", "[", "StartIndex", "]"}], "]"}], "===", 
          "Integer"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"OptionValue", "[", "StartIndex", "]"}], "\[GreaterEqual]", 
          "0"}], ")"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"II", " ", "of", " ", 
      RowBox[{"II", ":", " ", 
       RowBox[{"Same", " ", "as", " ", "above"}]}]}], ",", " ", 
     RowBox[{
     "except", " ", "we", " ", "allow", " ", "the", " ", "metric", " ", "to", 
      " ", "be", " ", "entered", " ", "in", " ", "terms", " ", "of", " ", 
      "differentials", " ", 
      RowBox[{"\[DifferentialD]", "t"}]}], ",", " ", 
     RowBox[{"\[DifferentialD]", "x"}], ",", " ", 
     RowBox[{"etc", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Metric", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"(", 
          RowBox[{"TestIndices", "[", "\[Mu]T", "]"}], ")"}]}], ",", 
        RowBox[{"\[Nu]T_", "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TestIndices", "[", "\[Nu]T", "]"}], "&&", 
           RowBox[{"!", 
            RowBox[{"TestOverHatIndex", "[", "\[Nu]T", "]"}]}]}], ")"}]}], 
        ",", 
        RowBox[{"matrix_", "/;", 
         RowBox[{"TestExpressionForm", "[", "matrix", "]"}]}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"SubMinus", "[", "_", "]"}], ",", 
           RowBox[{"SubMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ")"}]}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "MetricM", ",", "\[Mu]", ",", "\[Nu]", ",", "dcoords", ",", "lgth"}],
          "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "convert", " ", "the", " ", "expression", " ", "matrix", " ", "to", 
          " ", "a", " ", 
          RowBox[{"dim", ".", " ", "x"}], " ", 
          RowBox[{"dim", ".", " ", "List"}], " ", "matrix"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"lgth", "=", 
          RowBox[{"Length", "[", 
           RowBox[{"OptionValue", "[", "Coordinates", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"dcoords", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[DifferentialD]", "#"}], ")"}], "&"}], "/@", 
           RowBox[{"OptionValue", "[", "Coordinates", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"MetricM", "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
             RowBox[{"(*", " ", 
              RowBox[{"off", " ", "diagonal", " ", "terms"}], " ", "*)"}], 
             "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{"\[Mu]", "=!=", "\[Nu]"}], ",", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"Coefficient", "[", 
                RowBox[{
                 RowBox[{"Expand", "[", "matrix", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                  "dcoords", "\[LeftDoubleBracket]", "\[Mu]", 
                   "\[RightDoubleBracket]"}], 
                  RowBox[{
                  "dcoords", "\[LeftDoubleBracket]", "\[Nu]", 
                   "\[RightDoubleBracket]"}]}]}], "]"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"(*", " ", 
               RowBox[{"diagonal", " ", "terms"}], " ", "*)"}], 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\[Mu]", "===", "\[Nu]"}], ",", 
              RowBox[{"Coefficient", "[", 
               RowBox[{
                RowBox[{"Expand", "[", "matrix", "]"}], ",", 
                RowBox[{
                 RowBox[{
                 "dcoords", "\[LeftDoubleBracket]", "\[Mu]", 
                  "\[RightDoubleBracket]"}], 
                 RowBox[{
                 "dcoords", "\[LeftDoubleBracket]", "\[Nu]", 
                  "\[RightDoubleBracket]"}]}]}], "]"}]}], 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\[Mu]", ",", "1", ",", "lgth"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Nu]", ",", "1", ",", "lgth"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "then", " ", "feed", " ", "matrix", " ", "into", " ", "the", " ", 
           "same", " ", "code", " ", "as", " ", "above"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"TensorType", "\[Rule]", "\"\<Metric\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Coordinates", "\[Rule]", 
            RowBox[{"OptionValue", "[", "Coordinates", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"TensorName", "\[Rule]", 
            RowBox[{"OptionValue", "[", "TensorName", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"StartIndex", "\[Rule]", 
            RowBox[{"OptionValue", "[", "StartIndex", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ChristoffelOperator", "\[Rule]", 
            RowBox[{"OptionValue", "[", "ChristoffelOperator", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"RiemannOperator", "\[Rule]", 
            RowBox[{"OptionValue", "[", "RiemannOperator", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"RicciOperator", "\[Rule]", 
            RowBox[{"OptionValue", "[", "RicciOperator", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"RicciScalarOperator", "\[Rule]", 
            RowBox[{"OptionValue", "[", "RicciScalarOperator", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"TooltipDisplay", "\[Rule]", 
            RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"TooltipStyle", "\[Rule]", 
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Indices", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"TensorComponents", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"MetricM", "//", 
              RowBox[{"OptionValue", "[", "MetricOperator", "]"}]}], ")"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"FlatMetric", "\[Rule]", 
            RowBox[{"OptionValue", "[", "FlatMetric", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"OrthonormalFrameField", "\[Rule]", 
            RowBox[{"OptionValue", "[", "OrthonormalFrameField", "]"}]}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"InverseOrthonormalFrameField", "\[Rule]", 
            RowBox[{
            "OptionValue", "[", "InverseOrthonormalFrameField", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"OrthonormalFrameFieldOperator", "\[Rule]", 
            RowBox[{
            "OptionValue", "[", "OrthonormalFrameFieldOperator", "]"}]}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"OrthonormalFrameFieldIndices", "\[Rule]", 
            RowBox[{
            "OptionValue", "[", "OrthonormalFrameFieldIndices", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"TensorAssumption", "\[Rule]", " ", 
            RowBox[{"OptionValue", "[", "TensorAssumption", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"TensorOperator", "\[Rule]", " ", 
            RowBox[{"OptionValue", "[", "TensorOperator", "]"}]}]}], 
          "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Head", "[", 
           RowBox[{"OptionValue", "[", "StartIndex", "]"}], "]"}], "===", 
          "Integer"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"OptionValue", "[", "StartIndex", "]"}], "\[GreaterEqual]", 
          "0"}], ")"}], "&&", "\[IndentingNewLine]", 
        RowBox[{"TestQuadratic", "[", 
         RowBox[{"matrix", ",", 
          RowBox[{"OptionValue", "[", "Coordinates", "]"}], ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Metric", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"(", 
          RowBox[{"TestIndices", "[", "\[Mu]T", "]"}], ")"}]}], ",", 
        RowBox[{"\[Nu]T_", "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TestIndices", "[", "\[Nu]T", "]"}], "&&", 
           RowBox[{"!", 
            RowBox[{"TestOverHatIndex", "[", "\[Nu]T", "]"}]}]}], ")"}]}], 
        ",", 
        RowBox[{"matrix_", "/;", 
         RowBox[{"TestExpressionForm", "[", "matrix", "]"}]}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"SuperMinus", "[", "_", "]"}], ",", 
           RowBox[{"SuperMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ")"}]}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "MetricM", ",", "\[Mu]", ",", "\[Nu]", ",", "pdcoords", ",", 
          "lgth"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "convert", " ", "the", " ", "expression", " ", "matrix", " ", "to", 
          " ", "a", " ", 
          RowBox[{"dim", ".", " ", "x"}], " ", 
          RowBox[{"dim", ".", " ", "List"}], " ", "matrix"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"lgth", "=", 
          RowBox[{"Length", "[", 
           RowBox[{"OptionValue", "[", "Coordinates", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"pdcoords", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Del]", "#"}], ")"}], "&"}], "/@", 
           RowBox[{"OptionValue", "[", "Coordinates", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"MetricM", "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
             RowBox[{"(*", " ", 
              RowBox[{"off", " ", "diagonal", " ", "terms"}], " ", "*)"}], 
             "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{"\[Mu]", "=!=", "\[Nu]"}], ",", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"Coefficient", "[", 
                RowBox[{
                 RowBox[{"Expand", "[", "matrix", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                  "pdcoords", "\[LeftDoubleBracket]", "\[Mu]", 
                   "\[RightDoubleBracket]"}], 
                  RowBox[{
                  "pdcoords", "\[LeftDoubleBracket]", "\[Nu]", 
                   "\[RightDoubleBracket]"}]}]}], "]"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"(*", " ", 
               RowBox[{"diagonal", " ", "terms"}], " ", "*)"}], 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\[Mu]", "===", "\[Nu]"}], ",", 
              RowBox[{"Coefficient", "[", 
               RowBox[{
                RowBox[{"Expand", "[", "matrix", "]"}], ",", 
                RowBox[{
                 RowBox[{
                 "pdcoords", "\[LeftDoubleBracket]", "\[Mu]", 
                  "\[RightDoubleBracket]"}], 
                 RowBox[{
                 "pdcoords", "\[LeftDoubleBracket]", "\[Nu]", 
                  "\[RightDoubleBracket]"}]}]}], "]"}]}], 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\[Mu]", ",", "1", ",", "lgth"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Nu]", ",", "1", ",", "lgth"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "then", " ", "feed", " ", "matrix", " ", "into", " ", "the", " ", 
           "same", " ", "code", " ", "as", " ", "above"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"TensorType", "\[Rule]", "\"\<Metric\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Coordinates", "\[Rule]", 
            RowBox[{"OptionValue", "[", "Coordinates", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"TensorName", "\[Rule]", 
            RowBox[{"OptionValue", "[", "TensorName", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"StartIndex", "\[Rule]", 
            RowBox[{"OptionValue", "[", "StartIndex", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ChristoffelOperator", "\[Rule]", 
            RowBox[{"OptionValue", "[", "ChristoffelOperator", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"RiemannOperator", "\[Rule]", 
            RowBox[{"OptionValue", "[", "RiemannOperator", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"RicciOperator", "\[Rule]", 
            RowBox[{"OptionValue", "[", "RicciOperator", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"RicciScalarOperator", "\[Rule]", 
            RowBox[{"OptionValue", "[", "RicciScalarOperator", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"TooltipDisplay", "\[Rule]", 
            RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"TooltipStyle", "\[Rule]", 
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Indices", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"TensorComponents", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"MetricM", "//", 
              RowBox[{"OptionValue", "[", "MetricOperator", "]"}]}], ")"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"FlatMetric", "\[Rule]", 
            RowBox[{"OptionValue", "[", "FlatMetric", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"OrthonormalFrameField", "\[Rule]", 
            RowBox[{"OptionValue", "[", "OrthonormalFrameField", "]"}]}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"InverseOrthonormalFrameField", "\[Rule]", 
            RowBox[{
            "OptionValue", "[", "InverseOrthonormalFrameField", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"OrthonormalFrameFieldOperator", "\[Rule]", 
            RowBox[{
            "OptionValue", "[", "OrthonormalFrameFieldOperator", "]"}]}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"OrthonormalFrameFieldIndices", "\[Rule]", 
            RowBox[{
            "OptionValue", "[", "OrthonormalFrameFieldIndices", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"TensorAssumption", "\[Rule]", " ", 
            RowBox[{"OptionValue", "[", "TensorAssumption", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"TensorOperator", "\[Rule]", " ", 
            RowBox[{"OptionValue", "[", "TensorOperator", "]"}]}]}], 
          "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Head", "[", 
           RowBox[{"OptionValue", "[", "StartIndex", "]"}], "]"}], "===", 
          "Integer"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"OptionValue", "[", "StartIndex", "]"}], "\[GreaterEqual]", 
          "0"}], ")"}], "&&", 
        RowBox[{"TestQuadratic", "[", 
         RowBox[{"matrix", ",", 
          RowBox[{"OptionValue", "[", "Coordinates", "]"}], ",", 
          RowBox[{"+", "1"}]}], "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Metric", " ", "also", " ", "takes", " ", "in", " ", "a", " ", "Tensor", 
     " ", "object", " ", "of", " ", "type", " ", "Metric", " ", "and", " ", 
     "spits", " ", "out", " ", "the", " ", "components"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "aka", " ", "Raising", " ", "and", " ", "lowering", " ", "of", " ", 
     "Metric", " ", "indices"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"one", " ", "up", " ", "and", " ", "one", " ", "down"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Metric", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TestIndices", "[", "\[Mu]T", "]"}], "&&", 
           RowBox[{"!", 
            RowBox[{"TestOverHatIndex", "[", "\[Mu]T", "]"}]}]}], ")"}]}], 
        ",", 
        RowBox[{"\[Nu]T_", "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TestIndices", "[", "\[Nu]T", "]"}], "&&", 
           RowBox[{"!", 
            RowBox[{"TestOverHatIndex", "[", "\[Nu]T", "]"}]}]}], ")"}]}], 
        ",", "m_Tensor", ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"SuperMinus", "[", "_", "]"}], ",", 
              RowBox[{"SubMinus", "[", "_", "]"}]}], "}"}]}], "]"}], "||", 
          RowBox[{"MatchQ", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"SubMinus", "[", "_", "]"}], ",", 
              RowBox[{"SuperMinus", "[", "_", "]"}]}], "}"}]}], "]"}]}], 
         ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "idx", ",", "cpts", ",", "row", ",", "col", ",", "l", ",", "ix", ",", 
         "mx", ",", "id", ",", "output"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"l", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"Coordinates", "[", "m", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ix", "=", 
         RowBox[{"Indices", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mx", "=", 
         RowBox[{"TensorComponents", "[", "m", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"id", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"KroneckerDelta", "[", 
            RowBox[{"row", ",", "col"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"row", ",", "1", ",", "l"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"col", ",", "1", ",", "l"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"m", "/.", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Indices", "\[Rule]", "ix"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"Indices", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}]}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorComponents", "\[Rule]", "mx"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"TensorComponents", "\[Rule]", "id"}], ")"}]}]}], 
           "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}], "=!=", 
            "Null"}], ")"}], ",", 
          RowBox[{"output", "=", 
           RowBox[{"output", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TooltipDisplay", "\[Rule]", "td_"}], ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"TooltipDisplay", "\[Rule]", 
                RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], 
               ")"}]}], "}"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
            RowBox[{"{", "}"}]}], ")"}], ",", 
          RowBox[{"output", "=", 
           RowBox[{"output", "/.", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TooltipStyle", "\[Rule]", "tts_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"TooltipStyle", "\[Rule]", 
               RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], 
              ")"}]}]}]}]}], "]"}], ";", "\[IndentingNewLine]", "output"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"both", " ", "lower"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Metric", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TestIndices", "[", "\[Mu]T", "]"}], "&&", 
           RowBox[{"!", 
            RowBox[{"TestOverHatIndex", "[", "\[Mu]T", "]"}]}]}], ")"}]}], 
        ",", 
        RowBox[{"\[Nu]T_", "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TestIndices", "[", "\[Nu]T", "]"}], "&&", 
           RowBox[{"!", 
            RowBox[{"TestOverHatIndex", "[", "\[Nu]T", "]"}]}]}], ")"}]}], 
        ",", "m_Tensor", ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"SubMinus", "[", "_", "]"}], ",", 
            RowBox[{"SubMinus", "[", "_", "]"}]}], "}"}]}], "]"}], "&&", 
        RowBox[{"(", 
         RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ix", ",", "mx", ",", "output"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ix", "=", 
         RowBox[{"Indices", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mx", "=", 
         RowBox[{"TensorComponents", "[", "m", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "both", " ", "lower", " ", "then", " ", "just", " ", "return", " ",
             "the", " ", "Tensor"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{"ix", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"SubMinus", "[", "_", "]"}], ",", 
               RowBox[{"SubMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"m", "/.", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Indices", "\[Rule]", "ix"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"Indices", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}]}], ")"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "both", " ", "upper", " ", "we", " ", "have", " ", "to", " ", 
             "invert", " ", "the", " ", "TensorComponents"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"MatchQ", "[", 
            RowBox[{"ix", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"SuperMinus", "[", "_", "]"}], ",", 
               RowBox[{"SuperMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"m", "/.", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Indices", "\[Rule]", "ix"}], ")"}], "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"Indices", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}]}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"TensorComponents", "\[Rule]", "mx"}], ")"}], 
               "\[RuleDelayed]", 
               RowBox[{"(", 
                RowBox[{"TensorComponents", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Inverse", "[", "mx", "]"}], "//", 
                   RowBox[{"OptionValue", "[", "MetricOperator", "]"}]}], 
                  ")"}]}], ")"}]}]}], "}"}]}]}], "\[IndentingNewLine]", 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          StyleBox["TooltipDisplay",
           FontColor->RGBColor[1, 0, 1]], " ", "and", " ", 
          StyleBox["TooltipStyle",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}], "=!=", 
           "Null"}], ",", 
          RowBox[{"output", "=", 
           RowBox[{"output", "/.", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TooltipDisplay", "\[Rule]", "td_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"TooltipDisplay", "\[Rule]", 
               RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], 
              ")"}]}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"output", "=", 
           RowBox[{"output", "/.", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TooltipStyle", "\[Rule]", "tts_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"TooltipStyle", "\[Rule]", 
               RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], 
              ")"}]}]}]}]}], "]"}], ";", "\[IndentingNewLine]", "output"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"both", " ", "upper"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Metric", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TestIndices", "[", "\[Mu]T", "]"}], "&&", 
           RowBox[{"!", 
            RowBox[{"TestOverHatIndex", "[", "\[Mu]T", "]"}]}]}], ")"}]}], 
        ",", 
        RowBox[{"\[Nu]T_", "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TestIndices", "[", "\[Nu]T", "]"}], "&&", 
           RowBox[{"!", 
            RowBox[{"TestOverHatIndex", "[", "\[Nu]T", "]"}]}]}], ")"}]}], 
        ",", "m_Tensor", ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"SuperMinus", "[", "_", "]"}], ",", 
            RowBox[{"SuperMinus", "[", "_", "]"}]}], "}"}]}], "]"}], "&&", 
        RowBox[{"(", 
         RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ix", ",", "mx", ",", "output"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ix", "=", 
         RowBox[{"Indices", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mx", "=", 
         RowBox[{"TensorComponents", "[", "m", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "both", " ", "upper", " ", "then", " ", "just", " ", "return", " ",
             "the", " ", "Tensor"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{"ix", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"SuperMinus", "[", "_", "]"}], ",", 
               RowBox[{"SuperMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"m", "/.", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Indices", "\[Rule]", "ix"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"Indices", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}]}], ")"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "both", " ", "lower", " ", "we", " ", "have", " ", "to", " ", 
             "invert", " ", "the", " ", "TensorComponents"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"MatchQ", "[", 
            RowBox[{"ix", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"SubMinus", "[", "_", "]"}], ",", 
               RowBox[{"SubMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"m", "/.", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Indices", "\[Rule]", "ix"}], ")"}], "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"Indices", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}]}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"TensorComponents", "\[Rule]", "mx"}], ")"}], 
               "\[RuleDelayed]", 
               RowBox[{"(", 
                RowBox[{"TensorComponents", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Inverse", "[", "mx", "]"}], "//", 
                   RowBox[{"OptionValue", "[", "MetricOperator", "]"}]}], 
                  ")"}]}], ")"}]}]}], "}"}]}]}], "\[IndentingNewLine]", 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          StyleBox["TooltipDisplay",
           FontColor->RGBColor[1, 0, 1]], " ", "and", " ", 
          StyleBox["TooltipStyle",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}], "=!=", 
           "Null"}], ",", 
          RowBox[{"output", "=", 
           RowBox[{"output", "/.", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TooltipDisplay", "\[Rule]", "td_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"TooltipDisplay", "\[Rule]", 
               RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], 
              ")"}]}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"output", "=", 
           RowBox[{"output", "/.", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TooltipStyle", "\[Rule]", "tts_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"TooltipStyle", "\[Rule]", 
               RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], 
              ")"}]}]}]}]}], "]"}], ";", "\[IndentingNewLine]", "output"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.518287025359375*^9, 3.518287083796875*^9}, {
   3.518287204515625*^9, 3.518287246046875*^9}, {3.518288154015625*^9, 
   3.518288179625*^9}, {3.5196834121875*^9, 3.519683417953125*^9}, {
   3.519689356625*^9, 3.519689356921875*^9}, {3.51976580715625*^9, 
   3.519765810671875*^9}, {3.519963432453125*^9, 3.519963433953125*^9}, 
   3.520125837828125*^9, {3.5201289498125*^9, 3.5201289504375*^9}, 
   3.520219859578125*^9, 3.5202268538125*^9, {3.52027377246875*^9, 
   3.520273831296875*^9}, {3.5202738760625*^9, 3.52027388446875*^9}, {
   3.5202739371875*^9, 3.5202741019375*^9}, {3.52027416353125*^9, 
   3.520274167671875*^9}, 3.520274919453125*^9, {3.52027495775*^9, 
   3.52027500990625*^9}, {3.520275109328125*^9, 3.52027513640625*^9}, {
   3.520275352625*^9, 3.520275353015625*^9}, {3.52027552415625*^9, 
   3.5202755711875*^9}, 3.520275790296875*^9, {3.5202759311875*^9, 
   3.520275948625*^9}, {3.520276746125*^9, 3.5202767880625*^9}, {
   3.52027692378125*^9, 3.52027700428125*^9}, {3.520277061046875*^9, 
   3.520277097125*^9}, {3.520277138046875*^9, 3.520277203125*^9}, {
   3.52027851596875*^9, 3.520278524*^9}, {3.52027856384375*^9, 
   3.520278653328125*^9}, 3.5202787563125*^9, {3.520279456296875*^9, 
   3.5202794635625*^9}, {3.520279561640625*^9, 3.520279567359375*^9}, {
   3.52028006315625*^9, 3.520280068671875*^9}, {3.5202804206875*^9, 
   3.520280495234375*^9}, 3.520281272765625*^9, {3.52028149878125*^9, 
   3.5202815018125*^9}, {3.520281674421875*^9, 3.5202816786875*^9}, {
   3.520281727390625*^9, 3.520281730375*^9}, 3.52028190265625*^9, {
   3.52028213190625*^9, 3.520282169640625*^9}, {3.520282364859375*^9, 
   3.520282395859375*^9}, {3.520282483109375*^9, 3.520282499046875*^9}, {
   3.52028567246875*^9, 3.520285695984375*^9}, {3.5202857606875*^9, 
   3.520285762578125*^9}, {3.520285792890625*^9, 3.520285807109375*^9}, {
   3.5202858616875*^9, 3.52028586721875*^9}, {3.520286964859375*^9, 
   3.520286985015625*^9}, {3.52028713909375*^9, 3.520287168453125*^9}, {
   3.52030002590625*^9, 3.520300043171875*^9}, {3.520300760625*^9, 
   3.520300806765625*^9}, {3.52030106778125*^9, 3.520301101625*^9}, {
   3.520301143203125*^9, 3.520301143921875*^9}, {3.520301203140625*^9, 
   3.520301219734375*^9}, {3.520301382671875*^9, 3.520301408375*^9}, {
   3.5203015531875*^9, 3.520301561859375*^9}, {3.52030160309375*^9, 
   3.52030162021875*^9}, {3.520301674546875*^9, 3.520301675078125*^9}, 
   3.520301885265625*^9, {3.52030235646875*^9, 3.5203024485*^9}, {
   3.52030252584375*^9, 3.520302587984375*^9}, {3.520302792015625*^9, 
   3.520302959515625*^9}, {3.520303101875*^9, 3.520303107296875*^9}, {
   3.520303238609375*^9, 3.52030324271875*^9}, {3.520303299859375*^9, 
   3.520303323609375*^9}, {3.5203034191875*^9, 3.52030344328125*^9}, 
   3.520351041640625*^9, {3.520354657265625*^9, 3.52035465828125*^9}, {
   3.520376497171875*^9, 3.5203766185625*^9}, 3.520440086609375*^9, {
   3.520449996078125*^9, 3.52045002709375*^9}, {3.520699768765625*^9, 
   3.520699779125*^9}, {3.521673438296875*^9, 3.52167372978125*^9}, {
   3.5216737615625*^9, 3.52167376675*^9}, {3.52167382796875*^9, 
   3.521673927234375*^9}, {3.521673968046875*^9, 3.52167405828125*^9}, {
   3.521674091125*^9, 3.521674102953125*^9}, {3.521674145703125*^9, 
   3.521674146078125*^9}, {3.52167507421875*^9, 3.521675077796875*^9}, {
   3.521675520296875*^9, 3.521675520765625*^9}, {3.521675570890625*^9, 
   3.52167562759375*^9}, {3.521734146375*^9, 3.521734155234375*^9}, {
   3.521785471109375*^9, 3.521785474859375*^9}, {3.52195362765625*^9, 
   3.521953698625*^9}, {3.538313545475878*^9, 3.5383135716059237`*^9}, {
   3.5383136026343784`*^9, 3.538313654098869*^9}, {3.5383137245017924`*^9, 
   3.538313891219285*^9}, {3.538313927598549*^9, 3.538314020933513*^9}, {
   3.538314096578046*^9, 3.5383142462915087`*^9}, {3.538314425036623*^9, 
   3.5383147351963673`*^9}, {3.538314771996832*^9, 3.538314772355633*^9}, {
   3.538314865955797*^9, 3.538314871571807*^9}, {3.5383149199474916`*^9, 
   3.5383151912163687`*^9}, {3.5383153640646725`*^9, 3.538315425013979*^9}, {
   3.538317548755187*^9, 3.5383176524271164`*^9}, {3.53831769269742*^9, 
   3.538317746465495*^9}, {3.538317798316461*^9, 3.538317805799889*^9}, {
   3.538318262821029*^9, 3.53831826720428*^9}, {3.5383182999311514`*^9, 
   3.538318301021214*^9}, {3.5383183594935584`*^9, 3.538318427411443*^9}, 
   3.53831847701128*^9, {3.538318512643318*^9, 3.5383185165065393`*^9}, {
   3.53945193646068*^9, 3.539452027824099*^9}, {3.5394613154963274`*^9, 
   3.539461359753606*^9}, {3.5394615573903522`*^9, 3.53946183502404*^9}, {
   3.5394618904821377`*^9, 3.539461891152939*^9}, {3.5394619302154074`*^9, 
   3.5394619338190136`*^9}, {3.539549024833885*^9, 3.539549091414802*^9}, {
   3.539549759688776*^9, 3.539549782090415*^9}, {3.5395498214648843`*^9, 
   3.539549822900087*^9}, {3.5395499318350782`*^9, 3.539549973377951*^9}, {
   3.5395512665890226`*^9, 3.5395512750286374`*^9}, {3.5395515248006763`*^9, 
   3.5395515341918926`*^9}, {3.53955223868913*^9, 3.5395522519023533`*^9}, {
   3.5396586403653665`*^9, 3.539658650318184*^9}, {3.5404892022296424`*^9, 
   3.5404892583898544`*^9}, {3.5942339653207917`*^9, 
   3.5942340103589835`*^9}, {3.5942355577222557`*^9, 3.594235574513513*^9}, {
   3.594235703314992*^9, 3.5942357213387685`*^9}, {3.594236103856645*^9, 
   3.5942361269665003`*^9}, 3.5942361602240114`*^9, {3.5965848362773194`*^9, 
   3.5965848512221456`*^9}, {3.827371828371171*^9, 3.827371857003539*^9}, {
   3.827371897783679*^9, 3.827371959741398*^9}, {3.8273788315252905`*^9, 
   3.8273788548534107`*^9}, {3.8273789087040186`*^9, 
   3.8273789243915205`*^9}, {3.827378954813406*^9, 3.8273789767821565`*^9}, {
   3.827379676740183*^9, 3.827379678318308*^9}, 3.8273797547432065`*^9, {
   3.8273829922434273`*^9, 3.827382993350428*^9}, 3.8274025362384357`*^9, {
   3.8381932800303555`*^9, 3.838193299809534*^9}, {3.847250291794485*^9, 
   3.847250314022805*^9}, {3.847833609920641*^9, 3.847833634175925*^9}, {
   3.847833783430523*^9, 3.8478337900827403`*^9}, {3.847836296193078*^9, 
   3.847836309209085*^9}, {3.8478376479177656`*^9, 3.847837654124908*^9}, {
   3.8478379065442896`*^9, 3.8478379522882586`*^9}, {3.854158895216339*^9, 
   3.854158898346294*^9}, {3.8541589594657373`*^9, 3.8541589800659804`*^9}, {
   3.8541593052339115`*^9, 3.854159324684156*^9}, {3.8541594597131147`*^9, 
   3.8541594649628363`*^9}, {3.854159495083087*^9, 3.8541594999525537`*^9}, {
   3.854411932440406*^9, 3.8544119483163996`*^9}, {3.854412102888397*^9, 
   3.854412204181672*^9}, 3.8575342780515895`*^9, {3.8586824322849913`*^9, 
   3.8586824538374486`*^9}, {3.8586832294851484`*^9, 
   3.8586832543653717`*^9}, {3.8586837615229235`*^9, 3.858683789335107*^9}, {
   3.8586843609452667`*^9, 3.858684382044056*^9}, {3.859455182811283*^9, 
   3.859455183640324*^9}, {3.859455331550561*^9, 3.859455367758347*^9}, {
   3.8594554784025893`*^9, 3.859455498833501*^9}, {3.8594559617700167`*^9, 
   3.8594560088336163`*^9}, {3.8594624086270685`*^9, 
   3.8594624428603296`*^9}, {3.8595076776108923`*^9, 3.859507702521445*^9}, {
   3.85951318259258*^9, 3.8595131941694603`*^9}, {3.8596008517198443`*^9, 
   3.859600858540743*^9}, {3.8601115288446465`*^9, 3.8601115678403373`*^9}, {
   3.86133228216689*^9, 3.861332305869296*^9}, {3.8673180819280505`*^9, 
   3.8673181509471893`*^9}, {3.8750914221695566`*^9, 
   3.8750914954262314`*^9}, {3.8750915297299204`*^9, 
   3.8750916413195724`*^9}, {3.875092686440316*^9, 3.8750926961753225`*^9}, {
   3.8750927345410776`*^9, 3.875092738728498*^9}, 3.8752375275244617`*^9, 
   3.875249537336472*^9, 3.875250921526145*^9, {3.8757538453334646`*^9, 
   3.8757539241871843`*^9}, {3.875753970353657*^9, 3.875753975823884*^9}, {
   3.87575474604679*^9, 3.875754888552393*^9}, {3.8757594193940907`*^9, 
   3.875759428379321*^9}, {3.8870135353603306`*^9, 3.887013644035818*^9}, {
   3.887262087187251*^9, 3.887262087420108*^9}, {3.8872621765567017`*^9, 
   3.887262177476135*^9}, {3.887262970336014*^9, 3.887263007534269*^9}, {
   3.887263039140789*^9, 3.8872630497592435`*^9}, 3.8872631938992863`*^9, 
   3.891515032450389*^9, {3.8915157682646255`*^9, 3.891515774346943*^9}, {
   3.8915165959643493`*^9, 3.8915165963231306`*^9}, {3.891516727064974*^9, 
   3.891516749887664*^9}, {3.892080112838269*^9, 3.8920801228324356`*^9}, {
   3.895554774149148*^9, 3.8955547742400928`*^9}, {3.8955550194261084`*^9, 
   3.8955550194460955`*^9}, {3.8955551721487484`*^9, 
   3.8955551721687365`*^9}, {3.8955558382765408`*^9, 3.895555838286533*^9}, {
   3.898832564271274*^9, 3.898832603953411*^9}, {3.956199042567376*^9, 
   3.9561990426002693`*^9}, {3.9599341803131638`*^9, 3.959934208507886*^9}, {
   3.9677774517733107`*^9, 3.967777451868024*^9}, {3.971053679380106*^9, 
   3.9710536944030867`*^9}, 3.9710608590165167`*^9, 3.971144221365217*^9, {
   3.971144428580608*^9, 3.971144458874517*^9}, {3.972348002737694*^9, 
   3.972348014633869*^9}, {3.975310868779965*^9, 
   3.975311104888061*^9}},ExpressionUUID->"4aba9fe4-8dc2-4999-9899-\
a395918895d5"]
}, Closed]],

Cell[CellGroupData[{

Cell["NonMetricTensor", "Subsection",
 CellChangeTimes->{{3.629916437629241*^9, 3.6299164515196667`*^9}, 
   3.629916481882225*^9, 3.8532781798529825`*^9, 
   3.8532820254048448`*^9},ExpressionUUID->"c24b1520-13e6-4858-9683-\
fcd039868295"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Generates", " ", "a", " ", "Tensor", " ", "with", " ", "components", " ", 
    "stuff", " ", "and", " ", "indices", " ", "\[Mu]T"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"For", " ", "non"}], "-", "scalar"}],
    FontColor->RGBColor[0.5, 0, 0.5]], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"NonMetricTensor", "[", 
       RowBox[{"\[Mu]T_List", ",", 
        RowBox[{"(", 
         RowBox[{
         "stuff_List", "|", "stuff_SparseArray", "|", 
          "stuff_SymmetrizedArray"}], ")"}], ",", "exp_", ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{"TestIndices", "/@", "\[Mu]T"}], "]"}], "===", 
         RowBox[{"{", "True", "}"}]}], ")"}], "&&", 
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"Dimensions", "[", "stuff", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"nnn_Integer", ".."}], "}"}]}], "]"}]}]}], ":=", 
     RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Indices", "\[Rule]", "\[Mu]T"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Coordinates", "\[Rule]", 
        RowBox[{"OptionValue", "[", "Coordinates", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TensorComponents", "\[Rule]", "stuff"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TensorName", "\[Rule]", "exp"}], ",", "\[IndentingNewLine]", 
       RowBox[{"StartIndex", "\[Rule]", 
        RowBox[{"OptionValue", "[", "StartIndex", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TooltipDisplay", "\[Rule]", 
        RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TooltipStyle", "\[Rule]", 
        RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], ",", 
       RowBox[{"TensorType", "\[Rule]", 
        RowBox[{"OptionValue", "[", "TensorType", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TensorAssumption", "\[Rule]", " ", 
        RowBox[{"OptionValue", "[", "TensorAssumption", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TensorOperator", "\[Rule]", " ", 
        RowBox[{"OptionValue", "[", "TensorOperator", "]"}]}]}], "\n", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Generates", " ", "a", " ", "Tensor", " ", "with", " ", "components", " ",
      "stuff", " ", "and", " ", "indices", " ", "\[Mu]T"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    StyleBox[
     RowBox[{"For", " ", "scalar"}],
     FontColor->RGBColor[0.5, 0, 0.5]], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NonMetricTensor", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"stuff_", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestExpressionForm", "[", "stuff", "]"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"{", "stuff", "}"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"\[DifferentialD]", "a_"}], ")"}], "\[Rule]", " ", 
               "a"}], ",", "Infinity"}], "]"}], "===", 
            RowBox[{"{", "}"}]}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"{", "stuff", "}"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"\[Del]", "a_"}], ")"}], "\[Rule]", " ", "a"}], ",", 
              "Infinity"}], "]"}], "===", 
            RowBox[{"{", "}"}]}], ")"}]}], ")"}]}], ",", "exp_", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Indices", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Coordinates", "\[Rule]", 
        RowBox[{"OptionValue", "[", "Coordinates", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TensorComponents", "\[Rule]", "stuff"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TensorName", "\[Rule]", "exp"}], ",", "\[IndentingNewLine]", 
       RowBox[{"StartIndex", "\[Rule]", 
        RowBox[{"OptionValue", "[", "StartIndex", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TooltipDisplay", "\[Rule]", 
        RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TooltipStyle", "\[Rule]", 
        RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], ",", 
       RowBox[{"TensorType", "\[Rule]", 
        RowBox[{"OptionValue", "[", "TensorType", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TensorAssumption", "\[Rule]", " ", 
        RowBox[{"OptionValue", "[", "TensorAssumption", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TensorOperator", "\[Rule]", " ", 
        RowBox[{"OptionValue", "[", "TensorOperator", "]"}]}]}], "\n", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NonMetricTensor", " ", "for", " ", "ExpressionForm", " ", 
     RowBox[{"(", 
      RowBox[{"not", " ", "scalar"}], ")"}], " ", "with", " ", 
     RowBox[{"TensorProduct", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NonMetricTensor", "[", 
      RowBox[{
       RowBox[{"indices_", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RankNumber", "[", "indices", "]"}], "=!=", "0"}], ")"}]}], 
       ",", 
       RowBox[{"stuff_", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestExpressionForm", "[", "stuff", "]"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", "stuff", "}"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[DifferentialD]", "a_"}], ")"}], "\[Rule]", " ", 
                "a"}], ",", "Infinity"}], "]"}], "=!=", 
             RowBox[{"{", "}"}]}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "stuff", "}"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"\[Del]", "a_"}], ")"}], "\[Rule]", " ", "a"}], ",",
                 "Infinity"}], "]"}], "=!=", 
              RowBox[{"{", "}"}]}], ")"}]}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"{", "stuff", "}"}], ",", 
              RowBox[{"TensorWedge", "[", "__", "]"}], ",", "Infinity"}], 
             "]"}], "===", 
            RowBox[{"{", "}"}]}], ")"}], "&&", 
          RowBox[{"!", 
           RowBox[{
           "TestSymmetricTensorExpressionForm", "[", "stuff", "]"}]}]}], 
         ")"}]}], ",", "exp_", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"NonMetricTensor", "[", 
      RowBox[{"indices", ",", 
       RowBox[{"ToTensorComponents", "[", 
        RowBox[{"stuff", ",", 
         RowBox[{"Coordinates", "\[Rule]", 
          RowBox[{"OptionValue", "[", "Coordinates", "]"}]}]}], "]"}], ",", 
       "exp", ",", 
       RowBox[{"Coordinates", "\[Rule]", 
        RowBox[{"OptionValue", "[", "Coordinates", "]"}]}], " ", ",", 
       "opts"}], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NonMetricTensor", " ", "for", " ", "ExpressionForm", " ", 
     RowBox[{"(", 
      RowBox[{"not", " ", "scalar"}], ")"}], " ", "with", " ", 
     RowBox[{"TensorWedge", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NonMetricTensor", "[", 
      RowBox[{
       RowBox[{"indices_", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RankNumber", "[", "indices", "]"}], "=!=", "0"}], ")"}]}], 
       ",", 
       RowBox[{"stuff_", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestExpressionForm", "[", "stuff", "]"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", "stuff", "}"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[DifferentialD]", "a_"}], ")"}], "\[Rule]", " ", 
                "a"}], ",", "Infinity"}], "]"}], "=!=", 
             RowBox[{"{", "}"}]}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "stuff", "}"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"\[Del]", "a_"}], ")"}], "\[Rule]", " ", "a"}], ",",
                 "Infinity"}], "]"}], "=!=", 
              RowBox[{"{", "}"}]}], ")"}]}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"{", "stuff", "}"}], ",", 
              RowBox[{"TensorWedge", "[", "__", "]"}], ",", "Infinity"}], 
             "]"}], "=!=", 
            RowBox[{"{", "}"}]}], ")"}], "&&", 
          RowBox[{"!", 
           RowBox[{
           "TestSymmetricTensorExpressionForm", "[", "stuff", "]"}]}]}], 
         ")"}]}], ",", "exp_", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"twteProduct", ",", "m"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"twteProduct", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"stuff", "//", "TensorExpand"}], ")"}], "//", 
          "WedgeExpand"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"m", "=", 
         RowBox[{"ToTensorComponents", "[", 
          RowBox[{"twteProduct", ",", 
           RowBox[{"Coordinates", "\[Rule]", 
            RowBox[{"OptionValue", "[", "Coordinates", "]"}]}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"NonMetricTensor", "[", 
         RowBox[{"indices", ",", "m", ",", "exp", ",", 
          RowBox[{"Coordinates", "\[Rule]", 
           RowBox[{"OptionValue", "[", "Coordinates", "]"}]}], ",", "opts"}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Symmetric", " ", "NonMetricTensor", " ", "for", " ", "ExpressionForm", 
     " ", 
     RowBox[{"(", 
      RowBox[{"not", " ", "scalar"}], ")"}], " ", "with", " ", 
     RowBox[{"Times", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NonMetricTensor", "[", 
      RowBox[{
       RowBox[{"indices_", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RankNumber", "[", "indices", "]"}], "=!=", "0"}], ")"}]}], 
       ",", 
       RowBox[{"stuff_", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestExpressionForm", "[", "stuff", "]"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", "stuff", "}"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[DifferentialD]", "a_"}], ")"}], "\[Rule]", " ", 
                "a"}], ",", "Infinity"}], "]"}], "=!=", 
             RowBox[{"{", "}"}]}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "stuff", "}"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"\[Del]", "a_"}], ")"}], "\[Rule]", " ", "a"}], ",",
                 "Infinity"}], "]"}], "=!=", 
              RowBox[{"{", "}"}]}], ")"}]}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"{", "stuff", "}"}], ",", 
              RowBox[{"TensorWedge", "[", "__", "]"}], ",", "Infinity"}], 
             "]"}], "===", 
            RowBox[{"{", "}"}]}], ")"}], "&&", 
          RowBox[{"TestSymmetricTensorExpressionForm", "[", "stuff", "]"}]}], 
         ")"}]}], ",", "exp_", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"NonMetricTensor", "[", 
      RowBox[{"indices", ",", 
       RowBox[{"ToTensorComponents", "[", 
        RowBox[{"stuff", ",", 
         RowBox[{"Coordinates", "\[Rule]", 
          RowBox[{"OptionValue", "[", "Coordinates", "]"}]}]}], "]"}], ",", 
       "exp", ",", 
       RowBox[{"Coordinates", "\[Rule]", 
        RowBox[{"OptionValue", "[", "Coordinates", "]"}]}], " ", ",", 
       "opts"}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6299331236734877`*^9, 3.6299331641123896`*^9}, {
   3.6299331964067764`*^9, 3.6299332680446024`*^9}, {3.6299333320359144`*^9, 
   3.6299333771043935`*^9}, {3.6299334299416866`*^9, 3.629933613143939*^9}, {
   3.629933685650297*^9, 3.62993370978354*^9}, {3.6299346632097187`*^9, 
   3.629934681209852*^9}, {3.629934752898698*^9, 3.629934755433402*^9}, {
   3.6299348636856337`*^9, 3.629934922260865*^9}, {3.629934993988804*^9, 
   3.629935023007456*^9}, {3.629935128681553*^9, 3.6299351442586823`*^9}, {
   3.629935334095628*^9, 3.629935336567932*^9}, {3.6299353946274443`*^9, 
   3.6299353988302526`*^9}, {3.6299354476149464`*^9, 
   3.6299354480673475`*^9}, {3.629935502874649*^9, 3.629935503093049*^9}, {
   3.629935551106537*^9, 3.6299355559781456`*^9}, {3.629936551072497*^9, 
   3.629936612044925*^9}, {3.6299367892033534`*^9, 3.629936796945967*^9}, {
   3.6299377624410257`*^9, 3.6299377926834807`*^9}, {3.6299379377013726`*^9, 
   3.629937949759297*^9}, {3.7810027968065405`*^9, 3.7810027977151113`*^9}, 
   3.7810028477632437`*^9, {3.7810052367295804`*^9, 3.781005311006933*^9}, {
   3.8105263903568463`*^9, 3.810526404546586*^9}, {3.810526472349375*^9, 
   3.810526577760407*^9}, {3.8479656805085526`*^9, 3.8479656969406185`*^9}, {
   3.875251155989257*^9, 3.875251160832858*^9}, {3.875251268136101*^9, 
   3.8752512796859117`*^9}, 3.8763674667863073`*^9, {3.887014188468592*^9, 
   3.887014206049587*^9}, {3.8947834785770617`*^9, 3.8947835107197127`*^9}, {
   3.8947847676371794`*^9, 3.8947848156123934`*^9}, {3.8947964824544554`*^9, 
   3.894796503350196*^9}, {3.8947965918919544`*^9, 3.8947966068166895`*^9}, {
   3.8947967311641293`*^9, 3.8947967783221865`*^9}, {3.894797790979706*^9, 
   3.894797858487443*^9}, {3.8947979074270425`*^9, 3.8947979304219875`*^9}, 
   3.8947980566374516`*^9, {3.89479809763582*^9, 3.8947981024965334`*^9}, {
   3.894798227052437*^9, 3.8947982536013165`*^9}, 3.89479830076906*^9, {
   3.894798395597806*^9, 3.894798421817698*^9}, {3.89479846772228*^9, 
   3.8947985822565026`*^9}, {3.894798739985142*^9, 3.8947987885748434`*^9}, {
   3.8947990793623066`*^9, 3.894799086062415*^9}, {3.894799641897766*^9, 
   3.8947996433876343`*^9}, {3.8948846958099174`*^9, 
   3.8948847213568993`*^9}, {3.894884795738093*^9, 3.894884852034692*^9}, {
   3.894885076927269*^9, 3.894885087175006*^9}, {3.8948855422867355`*^9, 
   3.894885549824132*^9}, {3.8948862395079174`*^9, 3.8948862498995686`*^9}, {
   3.894886486698395*^9, 3.894886487155118*^9}, 3.8948865282360115`*^9, {
   3.8948878613165607`*^9, 3.8948878786341467`*^9}, 3.894888270011814*^9, {
   3.8948884223091393`*^9, 3.8948884550385647`*^9}, 3.894888667211878*^9, {
   3.8948887102022543`*^9, 3.894888731624566*^9}, {3.8948889011818933`*^9, 
   3.8948889189018917`*^9}, {3.8948892410613317`*^9, 3.894889244901925*^9}, {
   3.8948895584683323`*^9, 3.894889563157584*^9}, {3.894889624037278*^9, 
   3.894889636875182*^9}, 3.895116579026664*^9, 3.895542935974187*^9, 
   3.89555477426108*^9, {3.895555838296528*^9, 3.8955558383095217`*^9}, {
   3.967777451884221*^9, 3.9677774519352584`*^9}, {3.969276669036023*^9, 
   3.969276688350849*^9}, 3.97088635505901*^9, 3.975293093179935*^9, 
   3.9753017310556746`*^9, {3.975311178146431*^9, 
   3.975311344335287*^9}},ExpressionUUID->"e180f111-643b-4ad9-9190-\
34b76f2b913a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Christoffel", "Subsection",
 CellChangeTimes->{{3.52170197*^9, 
  3.521701990984375*^9}},ExpressionUUID->"3e851b52-9d26-44b4-88b1-\
d76b3c349201"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "either", " ", "input", " ", "the", " ", "coordinates", " ", "or", " ", 
    "their", " ", "corresponding", " ", "numbers"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Internally", " ", "we", " ", "build", " ", "the", " ", "Tensor", " ", 
    "with", " ", "abstract", " ", "indices", " ", "before", " ", "evaluating",
     " ", "it", " ", "with", " ", "the", " ", "specified", " ", "ones"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Christoffel", "[", 
      RowBox[{
       RowBox[{"\[Mu]I_", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestIndices", "[", "\[Mu]I", "]"}], "&&", 
          RowBox[{"!", 
           RowBox[{"TestOverHatIndex", "[", "\[Mu]I", "]"}]}]}], ")"}]}], ",", 
       RowBox[{"\[Alpha]I_", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestIndices", "[", "\[Alpha]I", "]"}], "&&", 
          RowBox[{"!", 
           RowBox[{"TestOverHatIndex", "[", "\[Alpha]I", "]"}]}]}], ")"}]}], 
       ",", 
       RowBox[{"\[Beta]I_", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestIndices", "[", "\[Beta]I", "]"}], "&&", 
          RowBox[{"!", 
           RowBox[{"TestOverHatIndex", "[", "\[Beta]I", "]"}]}]}], ")"}]}], 
       ",", "m_Tensor", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}], "&&", 
       RowBox[{"MatchQ", "[", 
        RowBox[{"\[Mu]I", ",", 
         RowBox[{"SuperMinus", "[", "_", "]"}]}], "]"}], "&&", 
       RowBox[{"MatchQ", "[", 
        RowBox[{"\[Alpha]I", ",", 
         RowBox[{"SubMinus", "[", "_", "]"}]}], "]"}], "&&", 
       RowBox[{"MatchQ", "[", 
        RowBox[{"\[Beta]I", ",", 
         RowBox[{"SubMinus", "[", "_", "]"}]}], "]"}]}], ")"}]}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Mu]", ",", "\[Alpha]", ",", "\[Beta]", ",", "cooo", ",", "st", ",", 
        "d", ",", "mm", ",", "Chris", ",", "cc", ",", "disp"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cooo", "=", 
        RowBox[{"Coordinates", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{"Length", "[", "cooo", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"st", "=", 
        RowBox[{"StartIndex", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Chris", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Cases", "[", 
          RowBox[{"m", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ChristoffelComponents", "\[Rule]", "cc_"}], ")"}], 
            "\[Rule]", "cc"}], ",", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mm", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ChristoffelComponents", "[", 
             RowBox[{
              RowBox[{"SuperMinus", "[", "\[Mu]", "]"}], ",", 
              RowBox[{"SubMinus", "[", "\[Alpha]", "]"}], ",", 
              RowBox[{"SubMinus", "[", "\[Beta]", "]"}]}], "]"}], "/.", 
            "Chris"}], ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Mu]", ",", "st", ",", 
            RowBox[{"st", "+", "d", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]", ",", "st", ",", 
            RowBox[{"st", "+", "d", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Beta]", ",", "st", ",", 
            RowBox[{"st", "+", "d", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"TensorType", "\[Rule]", "\"\<ChristoffelSymbols\>\""}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"TensorName", "\[Rule]", "\"\<\[CapitalGamma]\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Coordinates", "\[Rule]", "cooo"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TensorComponents", "\[Rule]", "mm"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"StartIndex", "\[Rule]", "st"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Indices", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\[Mu]I", ",", "\[Alpha]I", ",", "\[Beta]I"}], "}"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"TooltipDisplay", "\[Rule]", 
          RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TooltipStyle", "\[Rule]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
              RowBox[{"{", "}"}]}], ")"}], ",", 
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], ",", "True", 
            ",", " ", 
            RowBox[{"TooltipStyle", "[", "m", "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TensorAssumption", "\[Rule]", " ", 
          RowBox[{"TensorAssumption", "[", "m", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TensorOperator", "\[Rule]", 
          RowBox[{"TensorOperator", "[", "m", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521701940859375*^9, 3.521701962421875*^9}, {
   3.5217019955*^9, 3.521702083*^9}, {3.52170211303125*^9, 
   3.521702153515625*^9}, {3.52170220340625*^9, 3.521702243140625*^9}, {
   3.521702276890625*^9, 3.52170228828125*^9}, {3.521702356546875*^9, 
   3.52170261825*^9}, {3.5217026784375*^9, 3.521702780828125*^9}, {
   3.52170315325*^9, 3.521703346140625*^9}, {3.521703396078125*^9, 
   3.521703477015625*^9}, {3.5217036863125*^9, 3.52170370946875*^9}, {
   3.5217037753125*^9, 3.521703777578125*^9}, {3.521703871046875*^9, 
   3.521704226390625*^9}, {3.521704278875*^9, 3.521704286*^9}, {
   3.521704316265625*^9, 3.521704321015625*^9}, {3.521704371890625*^9, 
   3.5217043791875*^9}, {3.52170445840625*^9, 3.521704518171875*^9}, {
   3.52170460028125*^9, 3.5217046210625*^9}, {3.521704660421875*^9, 
   3.52170466371875*^9}, {3.521704822625*^9, 3.52170482784375*^9}, {
   3.521704897203125*^9, 3.5217049498125*^9}, {3.521705017578125*^9, 
   3.521705036828125*^9}, {3.521705074375*^9, 3.52170508596875*^9}, {
   3.521705117359375*^9, 3.5217051225625*^9}, {3.521705165140625*^9, 
   3.521705169703125*^9}, {3.52173392034375*^9, 3.52173392140625*^9}, {
   3.521734619109375*^9, 3.5217346573125*^9}, {3.52173516965625*^9, 
   3.5217352035*^9}, {3.521757092171875*^9, 3.52175712196875*^9}, {
   3.521757212578125*^9, 3.5217572370625*^9}, {3.52175731115625*^9, 
   3.521757395625*^9}, {3.521757462703125*^9, 3.52175747228125*^9}, {
   3.521758798625*^9, 3.521758851703125*^9}, {3.521758919484375*^9, 
   3.5217589975*^9}, {3.5217590398125*^9, 3.5217591825625*^9}, {
   3.521759574546875*^9, 3.5217596046875*^9}, {3.521785540296875*^9, 
   3.52178557575*^9}, {3.52178565253125*^9, 3.52178571865625*^9}, {
   3.521920863046875*^9, 3.521920863578125*^9}, {3.521921206046875*^9, 
   3.521921214390625*^9}, {3.5219212558125*^9, 3.521921258515625*^9}, {
   3.52192150490625*^9, 3.52192150825*^9}, {3.52192180103125*^9, 
   3.521921821484375*^9}, {3.521923471453125*^9, 3.5219234891875*^9}, {
   3.521923550609375*^9, 3.521923569515625*^9}, {3.5219236754375*^9, 
   3.5219237076875*^9}, 3.521923899484375*^9, {3.5219240685*^9, 
   3.521924091390625*^9}, {3.52192419671875*^9, 3.521924199671875*^9}, {
   3.521924313953125*^9, 3.521924377609375*^9}, {3.521924417515625*^9, 
   3.521924454765625*^9}, {3.521926034671875*^9, 3.52192606040625*^9}, {
   3.521926156203125*^9, 3.52192615959375*^9}, {3.52192629628125*^9, 
   3.52192629725*^9}, {3.521926336015625*^9, 3.52192633659375*^9}, {
   3.5219264416875*^9, 3.52192644578125*^9}, {3.521926494203125*^9, 
   3.5219264944375*^9}, {3.521926644359375*^9, 3.521926660171875*^9}, {
   3.6297527622404857`*^9, 3.6297527725920773`*^9}, {3.6298218719754953`*^9, 
   3.6298218730014973`*^9}, {3.629821921547593*^9, 3.6298219335150166`*^9}, {
   3.847838528961491*^9, 3.8478385603648305`*^9}, {3.8478386605111895`*^9, 
   3.847838786818737*^9}, {3.847839671348936*^9, 3.847839725284182*^9}, {
   3.87342015136122*^9, 3.8734201577712746`*^9}, {3.8757549136847267`*^9, 
   3.8757549858368845`*^9}, {3.875755319164792*^9, 3.8757553193679132`*^9}, 
   3.8757585752981043`*^9, {3.8870142738989477`*^9, 3.8870142974097195`*^9}, 
   3.887017305014722*^9, {3.8955547742750716`*^9, 3.8955547742830667`*^9}, 
   3.895555172174732*^9, {3.896615872905754*^9, 3.896615936007663*^9}, 
   3.8966165647263737`*^9, 3.9677774519411407`*^9, 3.9711449021069527`*^9, {
   3.975311363789792*^9, 
   3.975311395230019*^9}},ExpressionUUID->"88c465ea-0b26-453a-9f87-\
54d52741b1bd"]
}, Closed]],

Cell[CellGroupData[{

Cell["Riemann", "Subsection",
 CellChangeTimes->{{3.521734694046875*^9, 3.521734695609375*^9}, 
   3.521734751328125*^9},ExpressionUUID->"a2143a5b-8e99-4039-af31-\
7b892d4f9ccb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "either", " ", "input", " ", "the", " ", "coordinates", " ", "or", " ", 
    "their", " ", "corresponding", " ", "numbers"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Internally", " ", "we", " ", "build", " ", "the", " ", "Tensor", " ", 
    "with", " ", "abstract", " ", "indices", " ", "before", " ", "evaluating",
     " ", "it", " ", "with", " ", "the", " ", "specified", " ", "ones"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Riemann", "[", 
      RowBox[{
       RowBox[{"\[Mu]I_", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestIndices", "[", "\[Mu]I", "]"}], "&&", 
          RowBox[{"!", 
           RowBox[{"TestOverHatIndex", "[", "\[Mu]I", "]"}]}]}], ")"}]}], ",", 
       RowBox[{"\[Nu]I_", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestIndices", "[", "\[Nu]I", "]"}], "&&", 
          RowBox[{"!", 
           RowBox[{"TestOverHatIndex", "[", "\[Nu]I", "]"}]}]}], ")"}]}], ",", 
       RowBox[{"\[Alpha]I_", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestIndices", "[", "\[Alpha]I", "]"}], "&&", 
          RowBox[{"!", 
           RowBox[{"TestOverHatIndex", "[", "\[Alpha]I", "]"}]}]}], ")"}]}], 
       ",", 
       RowBox[{"\[Beta]I_", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestIndices", "[", "\[Beta]I", "]"}], "&&", 
          RowBox[{"!", 
           RowBox[{"TestOverHatIndex", "[", "\[Beta]I", "]"}]}]}], ")"}]}], 
       ",", "m_Tensor", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
     RowBox[{"(", 
      RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}]}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "mm", ",", "\[Mu]", ",", "\[Nu]", ",", "\[Alpha]", ",", "\[Beta]", ",",
         "\[Mu]1", ",", "\[Nu]1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", 
        "rl", ",", "si", ",", "cooo", ",", "disp", ",", "d", ",", "cc", ",", 
        "Rie", ",", "lhs", ",", "rhs", ",", "RL1", ",", "RL2", ",", "RL3", 
        ",", "RL4", ",", "RiemannTemp", ",", "\[Tau]"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cooo", "=", 
        RowBox[{"Coordinates", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{"Length", "[", "cooo", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"si", "=", 
        RowBox[{"StartIndex", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Rie", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Cases", "[", 
          RowBox[{"m", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"RiemannComponents", "\[Rule]", "cc_"}], ")"}], 
            "\[Rule]", "cc"}], ",", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RL1", "[", 
           RowBox[{"\[Mu]", ",", "\[Mu]1"}], "]"}], "=", 
          RowBox[{"RaiseLower", "[", 
           RowBox[{
            RowBox[{"ReplaceIndex", "[", 
             RowBox[{"\[Mu]", ",", "\[Mu]I"}], "]"}], ",", 
            SuperscriptBox["\[Mu]1", "-"], ",", "m"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Mu]", ",", "si", ",", 
           RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Mu]1", ",", "si", ",", 
           RowBox[{"si", "+", "d", "-", "1"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RL2", "[", 
           RowBox[{"\[Nu]", ",", "\[Nu]1"}], "]"}], "=", 
          RowBox[{"RaiseLower", "[", 
           RowBox[{
            RowBox[{"ReplaceIndex", "[", 
             RowBox[{"\[Nu]", ",", "\[Nu]I"}], "]"}], ",", 
            SubscriptBox["\[Nu]1", "-"], ",", "m"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]", ",", "si", ",", 
           RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]1", ",", "si", ",", 
           RowBox[{"si", "+", "d", "-", "1"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RL3", "[", 
           RowBox[{"\[Alpha]", ",", "\[Alpha]1"}], "]"}], "=", 
          RowBox[{"RaiseLower", "[", 
           RowBox[{
            RowBox[{"ReplaceIndex", "[", 
             RowBox[{"\[Alpha]", ",", "\[Alpha]I"}], "]"}], ",", 
            SubscriptBox["\[Alpha]1", "-"], ",", "m"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]", ",", "si", ",", 
           RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]1", ",", "si", ",", 
           RowBox[{"si", "+", "d", "-", "1"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RL4", "[", 
           RowBox[{"\[Beta]", ",", "\[Beta]1"}], "]"}], "=", 
          RowBox[{"RaiseLower", "[", 
           RowBox[{
            RowBox[{"ReplaceIndex", "[", 
             RowBox[{"\[Beta]", ",", "\[Beta]I"}], "]"}], ",", 
            SubscriptBox["\[Beta]1", "-"], ",", "m"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Beta]", ",", "si", ",", 
           RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Beta]1", ",", "si", ",", 
           RowBox[{"si", "+", "d", "-", "1"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RiemannTemp", "[", 
           RowBox[{
           "\[Mu]1", ",", "\[Nu]1", ",", "\[Alpha]1", ",", "\[Beta]1"}], 
           "]"}], "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"RiemannComponents", "[", 
             RowBox[{
              SuperscriptBox["\[Mu]1", "-"], ",", 
              SubscriptBox["\[Nu]1", "-"], ",", 
              SubscriptBox["\[Alpha]1", "-"], ",", 
              SubscriptBox["\[Beta]1", "-"]}], "]"}], "/.", "Rie"}], ")"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\[Mu]1", ",", "si", ",", 
           RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]1", ",", "si", ",", 
           RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]1", ",", "si", ",", 
           RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Beta]1", ",", "si", ",", 
           RowBox[{"si", "+", "d", "-", "1"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mm", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"RL1", "[", 
              RowBox[{"\[Mu]", ",", "\[Mu]1"}], "]"}], 
             RowBox[{"RL2", "[", 
              RowBox[{"\[Nu]", ",", "\[Nu]1"}], "]"}], 
             RowBox[{"RL3", "[", 
              RowBox[{"\[Alpha]", ",", "\[Alpha]1"}], "]"}], 
             RowBox[{"RL4", "[", 
              RowBox[{"\[Beta]", ",", "\[Beta]1"}], "]"}], 
             RowBox[{"RiemannTemp", "[", 
              RowBox[{
              "\[Mu]1", ",", "\[Nu]1", ",", "\[Alpha]1", ",", "\[Beta]1"}], 
              "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\[Mu]1", ",", "si", ",", 
              RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Nu]1", ",", "si", ",", 
              RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Alpha]1", ",", "si", ",", 
              RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Beta]1", ",", "si", ",", 
              RowBox[{"si", "+", "d", "-", "1"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"\[Mu]", ",", "si", ",", 
            RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Nu]", ",", "si", ",", 
            RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]", ",", "si", ",", 
            RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Beta]", ",", "si", ",", 
            RowBox[{"si", "+", "d", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Originally", " ", "we", " ", "wanted", " ", "to", " ", "display", 
         " ", "Riemann", " ", "components"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "But", " ", "there", " ", "are", " ", "so", " ", "many", " ", 
         "components", " ", "and", " ", "it", " ", "slows", " ", "the", " ", 
         "whole", " ", "process", " ", "down", " ", "too", " ", "much"}], " ",
         "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "So", " ", "we", " ", "are", " ", "going", " ", "to", " ", "skip", 
         " ", "this", " ", "for", " ", "now"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "TensorName", "\[Rule]", 
          "\"\<\!\(\*StyleBox[\"R\",FontSlant->\"Italic\"]\)\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Coordinates", "\[Rule]", 
          RowBox[{"Coordinates", "[", "m", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TensorComponents", "\[Rule]", "mm"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Indices", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\[Mu]I", ",", "\[Nu]I", ",", "\[Alpha]I", ",", "\[Beta]I"}], 
           "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"TooltipDisplay", "\[Rule]", 
          RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TooltipStyle", "\[Rule]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
              RowBox[{"{", "}"}]}], ")"}], ",", 
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], ",", "True", 
            ",", " ", 
            RowBox[{"TooltipStyle", "[", "m", "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TensorAssumption", "\[Rule]", " ", 
          RowBox[{"TensorAssumption", "[", "m", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TensorOperator", "\[Rule]", 
          RowBox[{"TensorOperator", "[", "m", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521734700765625*^9, 3.521734734640625*^9}, {
   3.52173487478125*^9, 3.52173492440625*^9}, {3.5217352561875*^9, 
   3.521735312953125*^9}, {3.52173546925*^9, 3.52173547059375*^9}, {
   3.52174123378125*^9, 3.52174125609375*^9}, {3.52174142909375*^9, 
   3.521741443109375*^9}, {3.521741495765625*^9, 3.52174152578125*^9}, 
   3.52174221153125*^9, {3.52174227078125*^9, 3.521742318828125*^9}, {
   3.52174237790625*^9, 3.521742387515625*^9}, {3.5217425573125*^9, 
   3.52174261503125*^9}, {3.5217429701875*^9, 3.521743060046875*^9}, {
   3.52174309034375*^9, 3.52174312703125*^9}, {3.521743202421875*^9, 
   3.52174328740625*^9}, {3.5217433179375*^9, 3.52174332475*^9}, {
   3.5217433954375*^9, 3.521743463265625*^9}, {3.521743504828125*^9, 
   3.52174368890625*^9}, {3.521744190296875*^9, 3.521744191921875*^9}, {
   3.521757495484375*^9, 3.521757496546875*^9}, {3.521759661171875*^9, 
   3.521759719875*^9}, {3.52178575603125*^9, 3.52178577840625*^9}, {
   3.521785830296875*^9, 3.521785836796875*^9}, 3.52178631140625*^9, 
   3.5217865115*^9, {3.521786556609375*^9, 3.521786631640625*^9}, {
   3.52178668678125*^9, 3.52178682984375*^9}, {3.521786892046875*^9, 
   3.521786892359375*^9}, {3.52178695025*^9, 3.521786955328125*^9}, {
   3.52178699525*^9, 3.5217870186875*^9}, {3.521787374609375*^9, 
   3.521787502640625*^9}, 3.52191031203125*^9, {3.521921372765625*^9, 
   3.52192137315625*^9}, {3.52192155775*^9, 3.5219215621875*^9}, {
   3.5219221798125*^9, 3.5219221976875*^9}, {3.521923986484375*^9, 
   3.52192404196875*^9}, {3.52192447690625*^9, 3.52192448615625*^9}, {
   3.521926319296875*^9, 3.521926320171875*^9}, {3.52192646428125*^9, 
   3.521926469640625*^9}, {3.521926708734375*^9, 3.521926711578125*^9}, {
   3.52192726475*^9, 3.521927265390625*^9}, {3.52192732678125*^9, 
   3.521927331109375*^9}, {3.52192737059375*^9, 3.5219276574375*^9}, {
   3.521986638453125*^9, 3.5219867519375*^9}, {3.5219869874375*^9, 
   3.52198702090625*^9}, {3.52198776375*^9, 3.52198783859375*^9}, {
   3.52198857421875*^9, 3.52198860203125*^9}, {3.521989040203125*^9, 
   3.52198904790625*^9}, {3.52198924446875*^9, 3.521989323203125*^9}, {
   3.521989457359375*^9, 3.521989503859375*^9}, {3.52198970278125*^9, 
   3.5219897270625*^9}, {3.521989966171875*^9, 3.52198999225*^9}, {
   3.521990024421875*^9, 3.521990051515625*^9}, {3.5219901530625*^9, 
   3.521990263921875*^9}, {3.52199040546875*^9, 3.52199044909375*^9}, {
   3.521990681125*^9, 3.52199068253125*^9}, {3.629752726741455*^9, 
   3.6297527409332666`*^9}, {3.6298218168917894`*^9, 
   3.6298218174221907`*^9}, {3.6298431069387007`*^9, 3.6298431091851044`*^9}, 
   3.6299266252952766`*^9, {3.630638678608488*^9, 3.6306386825084953`*^9}, {
   3.8478397656562805`*^9, 3.847839791841218*^9}, {3.8478398490019493`*^9, 
   3.8478399032348657`*^9}, {3.8478401002461095`*^9, 
   3.8478401051422186`*^9}, {3.8757550009021716`*^9, 3.875755107112735*^9}, {
   3.8757553234706583`*^9, 3.8757553236738005`*^9}, 3.887014308763605*^9, {
   3.8955547743040714`*^9, 3.895554774321104*^9}, 3.8955551721807284`*^9, {
   3.896616039985834*^9, 3.896616045533027*^9}, {3.896616086535396*^9, 
   3.896616124936182*^9}, 3.8966165879066396`*^9, 3.9677774519431458`*^9, 
   3.970104994843894*^9, 3.971141531461399*^9, 3.971141575894087*^9, {
   3.975311405840108*^9, 
   3.975311470300132*^9}},ExpressionUUID->"c9a30d29-04d5-45c8-bb1d-\
513ed83291b4"]
}, Closed]],

Cell[CellGroupData[{

Cell["Ricci", "Subsection",
 CellChangeTimes->{{3.52174375309375*^9, 
  3.5217437626875*^9}},ExpressionUUID->"c2def25f-1776-4a82-abe4-e31e6156b5ce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "either", " ", "input", " ", "the", " ", "coordinates", " ", "or", " ", 
    "their", " ", "corresponding", " ", "numbers"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Ricci", "[", 
      RowBox[{
       RowBox[{"\[Nu]I_", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestIndices", "[", "\[Nu]I", "]"}], "&&", 
          RowBox[{"!", 
           RowBox[{"TestOverHatIndex", "[", "\[Nu]I", "]"}]}]}], ")"}]}], ",", 
       RowBox[{"\[Beta]I_", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestIndices", "[", "\[Beta]I", "]"}], "&&", 
          RowBox[{"!", 
           RowBox[{"TestOverHatIndex", "[", "\[Beta]I", "]"}]}]}], ")"}]}], 
       ",", "m_Tensor", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
     RowBox[{"(", 
      RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}]}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "mm", ",", "\[Mu]", ",", "\[Nu]", ",", "\[Alpha]", ",", "\[Beta]", ",",
         "\[Mu]1", ",", "\[Nu]1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", 
        "rl", ",", "si", ",", "cooo", ",", "disp", ",", "d", ",", "cc", ",", 
        "Ric", ",", "RL1", ",", "RL2", ",", "RicciTemp"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cooo", "=", 
        RowBox[{"Coordinates", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{"Length", "[", "cooo", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"si", "=", 
        RowBox[{"StartIndex", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Ric", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Cases", "[", 
          RowBox[{"m", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"RicciComponents", "\[Rule]", "cc_"}], ")"}], "\[Rule]", 
            "cc"}], ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RL1", "[", 
           RowBox[{"\[Nu]", ",", "\[Nu]1"}], "]"}], "=", 
          RowBox[{"RaiseLower", "[", 
           RowBox[{
            RowBox[{"ReplaceIndex", "[", 
             RowBox[{"\[Nu]", ",", "\[Nu]I"}], "]"}], ",", 
            SubscriptBox["\[Nu]1", "-"], ",", "m"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]", ",", "si", ",", 
           RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]1", ",", "si", ",", 
           RowBox[{"si", "+", "d", "-", "1"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RL2", "[", 
           RowBox[{"\[Beta]", ",", "\[Beta]1"}], "]"}], "=", 
          RowBox[{"RaiseLower", "[", 
           RowBox[{
            RowBox[{"ReplaceIndex", "[", 
             RowBox[{"\[Beta]", ",", "\[Beta]I"}], "]"}], ",", 
            SubscriptBox["\[Beta]1", "-"], ",", "m"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Beta]", ",", "si", ",", 
           RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Beta]1", ",", "si", ",", 
           RowBox[{"si", "+", "d", "-", "1"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RicciTemp", "[", 
           RowBox[{"\[Nu]1", ",", "\[Beta]1"}], "]"}], "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"RicciComponents", "[", 
             RowBox[{
              SubscriptBox["\[Nu]1", "-"], ",", 
              SubscriptBox["\[Beta]1", "-"]}], "]"}], "/.", "Ric"}], ")"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\[Nu]1", ",", "si", ",", 
           RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Beta]1", ",", "si", ",", 
           RowBox[{"si", "+", "d", "-", "1"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mm", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"RL1", "[", 
              RowBox[{"\[Nu]", ",", "\[Nu]1"}], "]"}], 
             RowBox[{"RL2", "[", 
              RowBox[{"\[Beta]", ",", "\[Beta]1"}], "]"}], 
             RowBox[{"RicciTemp", "[", 
              RowBox[{"\[Nu]1", ",", "\[Beta]1"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Nu]1", ",", "si", ",", 
              RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Beta]1", ",", "si", ",", 
              RowBox[{"si", "+", "d", "-", "1"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"\[Nu]", ",", "si", ",", 
            RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Beta]", ",", "si", ",", 
            RowBox[{"si", "+", "d", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Tensor", "[", 
        RowBox[{
         RowBox[{
         "TensorName", "\[Rule]", 
          "\"\<\!\(\*StyleBox[\"R\",FontSlant->\"Italic\"]\)\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Coordinates", "\[Rule]", 
          RowBox[{"Coordinates", "[", "m", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TensorComponents", "\[Rule]", "mm"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Indices", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\[Nu]I", ",", "\[Beta]I"}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TooltipDisplay", "\[Rule]", 
          RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TooltipStyle", "\[Rule]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
              RowBox[{"{", "}"}]}], ")"}], ",", 
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], ",", "True", 
            ",", " ", 
            RowBox[{"TooltipStyle", "[", "m", "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TensorAssumption", "\[Rule]", " ", 
          RowBox[{"TensorAssumption", "[", "m", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TensorOperator", "\[Rule]", 
          RowBox[{"TensorOperator", "[", "m", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.52174396084375*^9, 3.521743989140625*^9}, {
   3.52174404553125*^9, 3.52174406490625*^9}, {3.52174411178125*^9, 
   3.521744178*^9}, {3.52175753421875*^9, 3.52175753465625*^9}, {
   3.521759735640625*^9, 3.521759758125*^9}, {3.5217868350625*^9, 
   3.521786885078125*^9}, {3.52178704734375*^9, 3.521787116328125*^9}, {
   3.521787178828125*^9, 3.5217871886875*^9}, {3.521787424390625*^9, 
   3.5217874283125*^9}, {3.521787532828125*^9, 3.52178754371875*^9}, 
   3.521910410859375*^9, {3.5219174194375*^9, 3.521917422546875*^9}, {
   3.521917491703125*^9, 3.5219174925*^9}, {3.521917608890625*^9, 
   3.521917617625*^9}, {3.521918314421875*^9, 3.521918316125*^9}, {
   3.521919269328125*^9, 3.5219193048125*^9}, {3.521919497375*^9, 
   3.52191951465625*^9}, {3.521921384*^9, 3.5219213845625*^9}, {
   3.521922223546875*^9, 3.5219222338125*^9}, {3.521955617484375*^9, 
   3.521955648359375*^9}, {3.521990471359375*^9, 3.52199061959375*^9}, {
   3.521990750328125*^9, 3.521990763484375*^9}, {3.532452011949185*^9, 
   3.532452013961588*^9}, {3.532452056362463*^9, 3.5324520586088667`*^9}, {
   3.5324523712334156`*^9, 3.5324523744782214`*^9}, {3.5324524076906796`*^9, 
   3.532452416130295*^9}, {3.6297526960186977`*^9, 3.629752705008212*^9}, {
   3.6299261040969267`*^9, 3.629926110841316*^9}, {3.8364449484985237`*^9, 
   3.836444976697261*^9}, {3.836526197033885*^9, 3.836526201288885*^9}, {
   3.8381936494228725`*^9, 3.8381936501728716`*^9}, 3.8381942219189725`*^9, 
   3.8381942764834757`*^9, {3.847839941309194*^9, 3.8478399739321556`*^9}, {
   3.847840091019245*^9, 3.8478400933960853`*^9}, 3.874560218593365*^9, {
   3.875141420387806*^9, 3.8751414358123174`*^9}, {3.875755117850466*^9, 
   3.8757551698007727`*^9}, {3.8757552434406815`*^9, 
   3.8757552553027973`*^9}, {3.8757552903368187`*^9, 3.8757553064586596`*^9}, 
   3.887014320241514*^9, {3.8955547743370776`*^9, 3.8955547743411026`*^9}, 
   3.8955551721867247`*^9, {3.896616141846331*^9, 3.8966161428494377`*^9}, 
   3.896616595550499*^9, 3.967777451947155*^9, 3.971145216982243*^9, {
   3.975311480634799*^9, 
   3.9753115426730747`*^9}},ExpressionUUID->"1d2b45cd-c3da-4db1-94aa-\
061cf78888fa"]
}, Closed]],

Cell[CellGroupData[{

Cell["RicciScalar", "Subsection",
 CellChangeTimes->{{3.52174379078125*^9, 
  3.52174380503125*^9}},ExpressionUUID->"c25be501-361d-4b91-9c14-\
1d4568313200"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"RicciScalar", "[", "m_Tensor", "]"}], "/;", 
     RowBox[{"(", 
      RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}]}], ":=", 
    RowBox[{"(", 
     RowBox[{"RicciScalar", "/.", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Cases", "[", 
        RowBox[{"m", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"RicciScalarInvariant", "\[Rule]", "cc_"}], ")"}], 
          "\[Rule]", "cc"}], ",", "1"}], "]"}], "]"}]}], ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RicciScalar", "[", 
    RowBox[{"m_Tensor", ",", "Tensor"}], "]"}], "/;", 
   RowBox[{"(", 
    RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}]}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"NonMetricTensor", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", 
    RowBox[{"RicciScalar", "[", "m", "]"}], ",", "\"\<R\>\"", ",", 
    RowBox[{"Coordinates", "\[Rule]", 
     RowBox[{"Coordinates", "[", "m", "]"}]}], ",", 
    RowBox[{"StartIndex", "\[Rule]", 
     RowBox[{"StartIndex", "[", "m", "]"}]}], ",", 
    RowBox[{"TooltipDisplay", "\[Rule]", " ", "Null"}], ",", 
    RowBox[{"TooltipStyle", "\[Rule]", " ", 
     RowBox[{"TooltipStyle", "[", "m", "]"}]}], ",", 
    RowBox[{"TensorAssumption", "\[Rule]", " ", 
     RowBox[{"TensorAssumption", "[", "m", "]"}]}], ",", 
    RowBox[{"TensorOperator", "\[Rule]", " ", 
     RowBox[{"TensorOperator", "[", "m", "]"}]}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521743810890625*^9, 3.521743821640625*^9}, {
   3.52174386515625*^9, 3.52174389903125*^9}, {3.8757478876069565`*^9, 
   3.8757478954519525`*^9}, {3.875755263727872*^9, 3.8757552756086197`*^9}, {
   3.875755376923614*^9, 3.8757553812868214`*^9}, {3.887018957420314*^9, 
   3.8870189907480216`*^9}, {3.887019036734419*^9, 3.887019046670129*^9}, {
   3.8955551721907225`*^9, 3.895555172192722*^9}, {3.8966161794772377`*^9, 
   3.8966161863824224`*^9}, 3.8966163122061896`*^9, 3.9677774519491596`*^9, {
   3.9753115529273233`*^9, 
   3.975311559981999*^9}},ExpressionUUID->"b3fdcfec-523d-4d23-bb28-\
efc266000646"]
}, Closed]],

Cell[CellGroupData[{

Cell["Weyl", "Subsection",
 CellChangeTimes->{{3.521734694046875*^9, 3.521734695609375*^9}, 
   3.521734751328125*^9, {3.6297617465893908`*^9, 
   3.6297617474989944`*^9}},ExpressionUUID->"39601059-4c8d-4012-9dea-\
8af07a0a4633"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "either", " ", "input", " ", "the", " ", "coordinates", " ", "or", " ", 
    "their", " ", "corresponding", " ", "numbers"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Internally", " ", "we", " ", "build", " ", "the", " ", "Tensor", " ", 
    "with", " ", "abstract", " ", "indices", " ", "before", " ", "evaluating",
     " ", "it", " ", "with", " ", "the", " ", "specified", " ", "ones"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"d", ">", "3"}],
    FontColor->RGBColor[0.5, 0, 0.5]], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Weyl", "[", 
      RowBox[{
       RowBox[{"\[Alpha]I_", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestIndices", "[", "\[Alpha]I", "]"}], "&&", 
          RowBox[{"!", 
           RowBox[{"TestOverHatIndex", "[", "\[Alpha]I", "]"}]}]}], ")"}]}], 
       ",", 
       RowBox[{"\[Beta]I_", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestIndices", "[", "\[Beta]I", "]"}], "&&", 
          RowBox[{"!", 
           RowBox[{"TestOverHatIndex", "[", "\[Beta]I", "]"}]}]}], ")"}]}], 
       ",", 
       RowBox[{"\[Mu]I_", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestIndices", "[", "\[Mu]I", "]"}], "&&", 
          RowBox[{"!", 
           RowBox[{"TestOverHatIndex", "[", "\[Mu]I", "]"}]}]}], ")"}]}], ",", 
       RowBox[{"\[Nu]I_", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestIndices", "[", "\[Nu]I", "]"}], "&&", 
          RowBox[{"!", 
           RowBox[{"TestOverHatIndex", "[", "\[Nu]I", "]"}]}]}], ")"}]}], ",",
        "m_Tensor", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}], "&&", 
      RowBox[{"(", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"check", " ", "d"}], ">", "3"}], " ", "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{"Dimensions", "[", "m", "]"}], "]"}], 
         "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ">", "3"}], 
       ")"}]}]}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "mm", ",", "W", ",", "W0", ",", "\[Mu]", ",", "\[Nu]", ",", "\[Alpha]",
         ",", "\[Beta]", ",", "si", ",", "cooo", ",", "d", ",", "op"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"op", "=", 
        RowBox[{"OptionValue", "[", "WeylOperator", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cooo", "=", 
        RowBox[{"Coordinates", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{"Length", "[", "cooo", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"si", "=", 
        RowBox[{"StartIndex", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"W", "[", 
         RowBox[{
         "\[Alpha]_", ",", "\[Beta]_", ",", "\[Mu]_", ",", "\[Nu]_", ",", 
          "mm_Tensor"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"Riemann", "[", 
          RowBox[{
          "\[Alpha]", ",", "\[Beta]", ",", "\[Mu]", ",", "\[Nu]", ",", "mm"}],
           "]"}], "-", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"d", "-", "2"}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Ricci", "[", 
                RowBox[{"\[Alpha]", ",", "\[Mu]", ",", "mm"}], "]"}], 
               RowBox[{"Metric", "[", 
                RowBox[{"\[Nu]", ",", "\[Beta]", ",", "mm"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"Ricci", "[", 
                RowBox[{"\[Alpha]", ",", "\[Nu]", ",", "mm"}], "]"}], 
               RowBox[{"Metric", "[", 
                RowBox[{"\[Mu]", ",", "\[Beta]", ",", "mm"}], "]"}]}]}], 
             ")"}], "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Ricci", "[", 
                RowBox[{"\[Beta]", ",", "\[Mu]", ",", "mm"}], "]"}], 
               RowBox[{"Metric", "[", 
                RowBox[{"\[Nu]", ",", "\[Alpha]", ",", "mm"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"Ricci", "[", 
                RowBox[{"\[Beta]", ",", "\[Nu]", ",", "mm"}], "]"}], 
               RowBox[{"Metric", "[", 
                RowBox[{"\[Mu]", ",", "\[Alpha]", ",", "mm"}], "]"}]}]}], 
             ")"}]}], ")"}]}], "+", 
         RowBox[{
          FractionBox[
           RowBox[{"RicciScalar", "[", "mm", "]"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"d", "-", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{"d", "-", "2"}], ")"}]}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Metric", "[", 
              RowBox[{"\[Alpha]", ",", "\[Mu]", ",", "mm"}], "]"}], 
             RowBox[{"Metric", "[", 
              RowBox[{"\[Nu]", ",", "\[Beta]", ",", "mm"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"Metric", "[", 
              RowBox[{"\[Alpha]", ",", "\[Nu]", ",", "mm"}], "]"}], 
             RowBox[{"Metric", "[", 
              RowBox[{"\[Mu]", ",", "\[Beta]", ",", "mm"}], "]"}]}]}], 
           ")"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"W0", "=", 
        RowBox[{"W", "[", 
         RowBox[{
          RowBox[{"ReplaceIndex", "[", 
           RowBox[{"\[Alpha]", ",", "\[Alpha]I"}], "]"}], ",", 
          RowBox[{"ReplaceIndex", "[", 
           RowBox[{"\[Beta]", ",", "\[Beta]I"}], "]"}], ",", 
          RowBox[{"ReplaceIndex", "[", 
           RowBox[{"\[Mu]", ",", "\[Mu]I"}], "]"}], ",", 
          RowBox[{"ReplaceIndex", "[", 
           RowBox[{"\[Nu]", ",", "\[Nu]I"}], "]"}], ",", "m"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"W0", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"op", "[", "W0", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]", ",", "si", ",", 
            RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Beta]", ",", "si", ",", 
            RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Mu]", ",", "si", ",", 
            RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Nu]", ",", "si", ",", 
            RowBox[{"si", "+", "d", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"TensorType", "\[Rule]", "\"\<WeylCurvatureTensor\>\""}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
         "TensorName", "\[Rule]", 
          "\"\<\!\(\*StyleBox[\"C\",FontSlant->\"Italic\"]\)\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Coordinates", "\[Rule]", "cooo"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TensorComponents", "\[Rule]", "W0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Indices", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\[Alpha]I", ",", "\[Beta]I", ",", "\[Mu]I", ",", "\[Nu]I"}], 
           "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"TooltipDisplay", "\[Rule]", 
          RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TooltipStyle", "\[Rule]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
              RowBox[{"{", "}"}]}], ")"}], ",", 
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], ",", "True", 
            ",", " ", 
            RowBox[{"TooltipStyle", "[", "m", "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TensorAssumption", "\[Rule]", " ", 
          RowBox[{"TensorAssumption", "[", "m", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TensorOperator", "\[Rule]", 
          RowBox[{"TensorOperator", "[", "m", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521734700765625*^9, 3.521734734640625*^9}, {
   3.52173487478125*^9, 3.52173492440625*^9}, {3.5217352561875*^9, 
   3.521735312953125*^9}, {3.52173546925*^9, 3.52173547059375*^9}, {
   3.52174123378125*^9, 3.52174125609375*^9}, {3.52174142909375*^9, 
   3.521741443109375*^9}, {3.521741495765625*^9, 3.52174152578125*^9}, 
   3.52174221153125*^9, {3.52174227078125*^9, 3.521742318828125*^9}, {
   3.52174237790625*^9, 3.521742387515625*^9}, {3.5217425573125*^9, 
   3.52174261503125*^9}, {3.5217429701875*^9, 3.521743060046875*^9}, {
   3.52174309034375*^9, 3.52174312703125*^9}, {3.521743202421875*^9, 
   3.52174328740625*^9}, {3.5217433179375*^9, 3.52174332475*^9}, {
   3.5217433954375*^9, 3.521743463265625*^9}, {3.521743504828125*^9, 
   3.52174368890625*^9}, {3.521744190296875*^9, 3.521744191921875*^9}, {
   3.521757495484375*^9, 3.521757496546875*^9}, {3.521759661171875*^9, 
   3.521759719875*^9}, {3.52178575603125*^9, 3.52178577840625*^9}, {
   3.521785830296875*^9, 3.521785836796875*^9}, 3.52178631140625*^9, 
   3.5217865115*^9, {3.521786556609375*^9, 3.521786631640625*^9}, {
   3.52178668678125*^9, 3.52178682984375*^9}, {3.521786892046875*^9, 
   3.521786892359375*^9}, {3.52178695025*^9, 3.521786955328125*^9}, {
   3.52178699525*^9, 3.5217870186875*^9}, {3.521787374609375*^9, 
   3.521787502640625*^9}, 3.52191031203125*^9, {3.521921372765625*^9, 
   3.52192137315625*^9}, {3.52192155775*^9, 3.5219215621875*^9}, {
   3.5219221798125*^9, 3.5219221976875*^9}, {3.521923986484375*^9, 
   3.52192404196875*^9}, {3.52192447690625*^9, 3.52192448615625*^9}, {
   3.521926319296875*^9, 3.521926320171875*^9}, {3.52192646428125*^9, 
   3.521926469640625*^9}, {3.521926708734375*^9, 3.521926711578125*^9}, {
   3.52192726475*^9, 3.521927265390625*^9}, {3.52192732678125*^9, 
   3.521927331109375*^9}, {3.52192737059375*^9, 3.5219276574375*^9}, {
   3.521986638453125*^9, 3.5219867519375*^9}, {3.5219869874375*^9, 
   3.52198702090625*^9}, {3.52198776375*^9, 3.52198783859375*^9}, {
   3.52198857421875*^9, 3.52198860203125*^9}, {3.521989040203125*^9, 
   3.52198904790625*^9}, {3.52198924446875*^9, 3.521989323203125*^9}, {
   3.521989457359375*^9, 3.521989503859375*^9}, {3.52198970278125*^9, 
   3.5219897270625*^9}, {3.521989966171875*^9, 3.52198999225*^9}, {
   3.521990024421875*^9, 3.521990051515625*^9}, {3.5219901530625*^9, 
   3.521990263921875*^9}, {3.52199040546875*^9, 3.52199044909375*^9}, {
   3.521990681125*^9, 3.52199068253125*^9}, {3.629752726741455*^9, 
   3.6297527409332666`*^9}, {3.6297617545920153`*^9, 
   3.6297617553428164`*^9}, {3.6297617945443063`*^9, 
   3.6297618111627455`*^9}, {3.6297618445874224`*^9, 3.629761871731298*^9}, {
   3.629761903142968*^9, 3.6297621381319532`*^9}, {3.62976238261876*^9, 
   3.6297623918905773`*^9}, {3.6297624865225897`*^9, 
   3.6297625240860853`*^9}, {3.629762563940586*^9, 3.629762736237419*^9}, {
   3.6297627759801335`*^9, 3.6297627925663767`*^9}, {3.6297628761608286`*^9, 
   3.6297629075250955`*^9}, {3.629762957887407*^9, 3.6297629714540377`*^9}, {
   3.6297630520534487`*^9, 3.6297630986135473`*^9}, {3.6297645525047197`*^9, 
   3.629764582551174*^9}, {3.6297647840345716`*^9, 3.629764787654778*^9}, {
   3.6297651274614244`*^9, 3.629765128242426*^9}, {3.629765216948803*^9, 
   3.6297653417704325`*^9}, {3.62976555127981*^9, 3.6297656157873244`*^9}, {
   3.6297661357466607`*^9, 3.6297661396466675`*^9}, {3.6297661840407457`*^9, 
   3.629766217020605*^9}, {3.6297665433073854`*^9, 3.6297667847348146`*^9}, {
   3.629766859449747*^9, 3.6297668639133554`*^9}, {3.629766948098504*^9, 
   3.6297670085344114`*^9}, {3.6297671291576295`*^9, 
   3.6297671318408346`*^9}, {3.6297673443323603`*^9, 
   3.6297674245403256`*^9}, {3.629767497506068*^9, 3.6297675228775144`*^9}, {
   3.6297676001496615`*^9, 3.629767680439425*^9}, {3.629767760335778*^9, 
   3.629767977089387*^9}, {3.6297680266076803`*^9, 3.629768029079485*^9}, 
   3.6297685964429665`*^9, 3.6297686657964897`*^9, {3.6297687146989765`*^9, 
   3.6297687365460157`*^9}, {3.629768866183045*^9, 3.629768868211048*^9}, {
   3.6297690014112897`*^9, 3.629769090328247*^9}, {3.6298194414104404`*^9, 
   3.629819460006674*^9}, {3.6298194901459265`*^9, 3.6298195206811805`*^9}, {
   3.6298196059353304`*^9, 3.6298197214223332`*^9}, {3.6298214424336243`*^9, 
   3.6298214669324694`*^9}, {3.629821615464175*^9, 3.62982161773918*^9}, {
   3.629821767881694*^9, 3.6298218007117596`*^9}, {3.7670018459356575`*^9, 
   3.767001899349289*^9}, {3.767004084712014*^9, 3.7670040902724733`*^9}, {
   3.794028857121798*^9, 3.794028861076228*^9}, {3.847840162537179*^9, 
   3.847840166046197*^9}, {3.875755368453453*^9, 3.875755369250282*^9}, {
   3.875755405768169*^9, 3.8757554577621603`*^9}, 3.887014359043078*^9, {
   3.895554774359083*^9, 3.895554774370076*^9}, 3.8955551721977167`*^9, {
   3.8966161959794707`*^9, 3.8966161967599525`*^9}, 3.89661661658348*^9, 
   3.9677774519511642`*^9, 3.9711456695432253`*^9, {3.97531156993967*^9, 
   3.9753116162779207`*^9}},ExpressionUUID->"c9ec7425-5271-46ed-a20b-\
5b9376c901fe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"d", "<=", "3"}],
    FontColor->RGBColor[0.5, 0, 0.5]], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Weyl", ",", " ", 
    RowBox[{
     RowBox[{
     "defined", " ", "to", " ", "be", " ", "the", " ", "traceless", " ", 
      "part", " ", "of", " ", "Riemann", " ", "is", " ", "zero", " ", "if", 
      " ", "d"}], " ", "=", 
     RowBox[{
      RowBox[{"2", " ", "or", " ", "d"}], " ", "=", " ", "3."}]}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "For", " ", "3", "D", " ", "we", " ", "have", " ", "done", " ", "a", " ", 
    "brute", " ", "force", " ", "calculation", " ", "to", " ", "prove", " ", 
    RowBox[{"it", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "For", " ", "2", "D", " ", "the", " ", "usual", " ", "formula", " ", 
     "for", " ", "Weyl", " ", "breaks", " ", "down"}], ";", " ", 
    RowBox[{
    "Use", " ", "fact", " ", "that", " ", "einstein", " ", "tensor", " ", 
     "is", " ", "zero", " ", "and", " ", "2", "D", " ", "metrics", " ", "are",
      " ", "conformally", " ", "flat", " ", "to", " ", "prove"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Riemann", " ", "has", " ", "only", " ", "1", " ", "independent", " ", 
    "component", " ", "in", " ", "2", "D", " ", "so", " ", "heuristically", 
    " ", "that", " ", "means", " ", "subtracting", " ", "its", " ", "trace", 
    " ", "should", " ", "yield", " ", "zero"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Weyl", "[", 
      RowBox[{
       RowBox[{"\[Alpha]I_", "/;", 
        RowBox[{"TestIndices", "[", "\[Alpha]I", "]"}]}], ",", 
       RowBox[{"\[Beta]I_", "/;", 
        RowBox[{"TestIndices", "[", "\[Beta]I", "]"}]}], ",", 
       RowBox[{"\[Mu]I_", "/;", 
        RowBox[{"TestIndices", "[", "\[Mu]I", "]"}]}], ",", 
       RowBox[{"\[Nu]I_", "/;", 
        RowBox[{"TestIndices", "[", "\[Nu]I", "]"}]}], ",", "m_Tensor", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}], "&&", 
      RowBox[{"(", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"check", " ", "d"}], "<=", "3"}], " ", "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{"Dimensions", "[", "m", "]"}], "]"}], 
         "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "\[LessEqual]", "3"}], ")"}]}]}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "mm", ",", "W", ",", "W0", ",", "\[Mu]", ",", "\[Nu]", ",", "\[Alpha]",
         ",", "\[Beta]", ",", "si", ",", "cooo", ",", "d", ",", "op"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cooo", "=", 
        RowBox[{"Coordinates", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{"Length", "[", "cooo", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"si", "=", 
        RowBox[{"StartIndex", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "generate", " ", "an", " ", "array", " ", "of", " ", "zeroes"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"W0", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"d", ",", "d", ",", "d", ",", "d"}], "}"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"TensorType", "\[Rule]", "\"\<WeylCurvatureTensor\>\""}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"TensorName", "\[Rule]", "\"\<C\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Coordinates", "\[Rule]", "cooo"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TensorComponents", "\[Rule]", "W0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Indices", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\[Alpha]I", ",", "\[Beta]I", ",", "\[Mu]I", ",", "\[Nu]I"}], 
           "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
         "TooltipDisplay", "\[Rule]", 
          "\"\<Weyl, being the traceless part of the Riemann tensor, is zero \
in 2D and 3D.\>\""}]}], "\[IndentingNewLine]", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521734700765625*^9, 3.521734734640625*^9}, {
   3.52173487478125*^9, 3.52173492440625*^9}, {3.5217352561875*^9, 
   3.521735312953125*^9}, {3.52173546925*^9, 3.52173547059375*^9}, {
   3.52174123378125*^9, 3.52174125609375*^9}, {3.52174142909375*^9, 
   3.521741443109375*^9}, {3.521741495765625*^9, 3.52174152578125*^9}, 
   3.52174221153125*^9, {3.52174227078125*^9, 3.521742318828125*^9}, {
   3.52174237790625*^9, 3.521742387515625*^9}, {3.5217425573125*^9, 
   3.52174261503125*^9}, {3.5217429701875*^9, 3.521743060046875*^9}, {
   3.52174309034375*^9, 3.52174312703125*^9}, {3.521743202421875*^9, 
   3.52174328740625*^9}, {3.5217433179375*^9, 3.52174332475*^9}, {
   3.5217433954375*^9, 3.521743463265625*^9}, {3.521743504828125*^9, 
   3.52174368890625*^9}, {3.521744190296875*^9, 3.521744191921875*^9}, {
   3.521757495484375*^9, 3.521757496546875*^9}, {3.521759661171875*^9, 
   3.521759719875*^9}, {3.52178575603125*^9, 3.52178577840625*^9}, {
   3.521785830296875*^9, 3.521785836796875*^9}, 3.52178631140625*^9, 
   3.5217865115*^9, {3.521786556609375*^9, 3.521786631640625*^9}, {
   3.52178668678125*^9, 3.52178682984375*^9}, {3.521786892046875*^9, 
   3.521786892359375*^9}, {3.52178695025*^9, 3.521786955328125*^9}, {
   3.52178699525*^9, 3.5217870186875*^9}, {3.521787374609375*^9, 
   3.521787502640625*^9}, 3.52191031203125*^9, {3.521921372765625*^9, 
   3.52192137315625*^9}, {3.52192155775*^9, 3.5219215621875*^9}, {
   3.5219221798125*^9, 3.5219221976875*^9}, {3.521923986484375*^9, 
   3.52192404196875*^9}, {3.52192447690625*^9, 3.52192448615625*^9}, {
   3.521926319296875*^9, 3.521926320171875*^9}, {3.52192646428125*^9, 
   3.521926469640625*^9}, {3.521926708734375*^9, 3.521926711578125*^9}, {
   3.52192726475*^9, 3.521927265390625*^9}, {3.52192732678125*^9, 
   3.521927331109375*^9}, {3.52192737059375*^9, 3.5219276574375*^9}, {
   3.521986638453125*^9, 3.5219867519375*^9}, {3.5219869874375*^9, 
   3.52198702090625*^9}, {3.52198776375*^9, 3.52198783859375*^9}, {
   3.52198857421875*^9, 3.52198860203125*^9}, {3.521989040203125*^9, 
   3.52198904790625*^9}, {3.52198924446875*^9, 3.521989323203125*^9}, {
   3.521989457359375*^9, 3.521989503859375*^9}, {3.52198970278125*^9, 
   3.5219897270625*^9}, {3.521989966171875*^9, 3.52198999225*^9}, {
   3.521990024421875*^9, 3.521990051515625*^9}, {3.5219901530625*^9, 
   3.521990263921875*^9}, {3.52199040546875*^9, 3.52199044909375*^9}, {
   3.521990681125*^9, 3.52199068253125*^9}, {3.629752726741455*^9, 
   3.6297527409332666`*^9}, {3.6297617545920153`*^9, 
   3.6297617553428164`*^9}, {3.6297617945443063`*^9, 
   3.6297618111627455`*^9}, {3.6297618445874224`*^9, 3.629761871731298*^9}, {
   3.629761903142968*^9, 3.6297621381319532`*^9}, {3.62976238261876*^9, 
   3.6297623918905773`*^9}, {3.6297624865225897`*^9, 
   3.6297625240860853`*^9}, {3.629762563940586*^9, 3.629762736237419*^9}, {
   3.6297627759801335`*^9, 3.6297627925663767`*^9}, {3.6297628761608286`*^9, 
   3.6297629075250955`*^9}, {3.629762957887407*^9, 3.6297629714540377`*^9}, {
   3.6297630520534487`*^9, 3.6297630986135473`*^9}, {3.6297645525047197`*^9, 
   3.629764582551174*^9}, {3.6297647840345716`*^9, 3.629764787654778*^9}, {
   3.6297651274614244`*^9, 3.629765128242426*^9}, {3.629765216948803*^9, 
   3.6297653417704325`*^9}, {3.62976555127981*^9, 3.6297656157873244`*^9}, {
   3.6297661357466607`*^9, 3.6297661396466675`*^9}, {3.6297661840407457`*^9, 
   3.629766217020605*^9}, {3.6297665433073854`*^9, 3.6297667847348146`*^9}, {
   3.629766859449747*^9, 3.6297668639133554`*^9}, {3.629766948098504*^9, 
   3.6297670085344114`*^9}, {3.6297671291576295`*^9, 
   3.6297671318408346`*^9}, {3.6297673443323603`*^9, 
   3.6297674245403256`*^9}, {3.629767497506068*^9, 3.6297675228775144`*^9}, {
   3.6297676001496615`*^9, 3.629767680439425*^9}, {3.629767760335778*^9, 
   3.629767977089387*^9}, {3.6297680266076803`*^9, 3.629768029079485*^9}, 
   3.6297685964429665`*^9, 3.6297686657964897`*^9, {3.6297687146989765`*^9, 
   3.6297687365460157`*^9}, {3.629768866183045*^9, 3.629768868211048*^9}, {
   3.6297690014112897`*^9, 3.629769090328247*^9}, {3.6298194414104404`*^9, 
   3.629819460006674*^9}, {3.6298194901459265`*^9, 3.6298195206811805`*^9}, {
   3.6298196059353304`*^9, 3.6298197214223332`*^9}, {3.6298214424336243`*^9, 
   3.6298214669324694`*^9}, {3.629821615464175*^9, 3.62982161773918*^9}, {
   3.629821767881694*^9, 3.6298218007117596`*^9}, {3.7670019325712566`*^9, 
   3.767001952068388*^9}, 3.767002511678125*^9, {3.767002585422539*^9, 
   3.767002646876587*^9}, {3.7670027091542053`*^9, 3.767002713455365*^9}, {
   3.767002823773355*^9, 3.767002857699437*^9}, {3.7670029515761995`*^9, 
   3.7670029594384484`*^9}, {3.7670030151143847`*^9, 3.767003026695181*^9}, {
   3.767004077752054*^9, 3.7670040787586403`*^9}, {3.7670041180466757`*^9, 
   3.7670042804674006`*^9}, 3.7940287284746866`*^9, {3.8757554657658195`*^9, 
   3.8757555100435486`*^9}, 3.8870143732272563`*^9, {3.895554774382067*^9, 
   3.8955547743900647`*^9}, 3.895555172201713*^9, 3.9677774519551764`*^9, {
   3.975311625968216*^9, 
   3.975311630118351*^9}},ExpressionUUID->"21f8df74-d008-4560-b592-\
59d81d7698c8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Einstein", "Subsection",
 CellChangeTimes->{{3.52174375309375*^9, 3.5217437626875*^9}, {
  3.6294767609205427`*^9, 
  3.6294767624605446`*^9}},ExpressionUUID->"7cbc090d-7a83-4153-ae68-\
cc167684801f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Einstein", " ", "Tensor"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "either", " ", "input", " ", "the", " ", "coordinates", " ", "or", " ", 
    "their", " ", "corresponding", " ", "numbers"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Einstein", "[", 
      RowBox[{
       RowBox[{"\[Nu]I_", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestIndices", "[", "\[Nu]I", "]"}], "&&", 
          RowBox[{"!", 
           RowBox[{"TestOverHatIndex", "[", "\[Nu]I", "]"}]}]}], ")"}]}], ",", 
       RowBox[{"\[Beta]I_", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestIndices", "[", "\[Beta]I", "]"}], "&&", 
          RowBox[{"!", 
           RowBox[{"TestOverHatIndex", "[", "\[Beta]I", "]"}]}]}], ")"}]}], 
       ",", "m_Tensor", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
     RowBox[{"(", 
      RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}]}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "mm", ",", "cooo", ",", "si", ",", "disp", ",", "RicciScalarT", ",", 
        "RicciTensorT", ",", "MetricT", ",", "op", ",", "\[Nu]T", ",", 
        "\[Beta]T"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"op", "=", 
        RowBox[{"OptionValue", "[", "EinsteinOperator", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"RicciScalarT", "=", 
        RowBox[{"RicciScalar", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "we", " ", "will", " ", "construct", " ", "Einstein", " ", "with", 
          " ", "abstract", " ", "indices", " ", "first"}], "..."}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"RicciTensorT", "=", 
        RowBox[{"TensorComponents", "[", 
         RowBox[{"Ricci", "[", 
          RowBox[{
           RowBox[{"ReplaceIndex", "[", 
            RowBox[{"\[Nu]T", ",", "\[Nu]I"}], "]"}], ",", 
           RowBox[{"ReplaceIndex", "[", 
            RowBox[{"\[Beta]T", ",", "\[Beta]I"}], "]"}], ",", "m"}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"MetricT", "=", 
        RowBox[{"TensorComponents", "[", 
         RowBox[{"Metric", "[", 
          RowBox[{
           RowBox[{"ReplaceIndex", "[", 
            RowBox[{"\[Nu]T", ",", "\[Nu]I"}], "]"}], ",", 
           RowBox[{"ReplaceIndex", "[", 
            RowBox[{"\[Beta]T", ",", "\[Beta]I"}], "]"}], ",", "m"}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mm", "=", 
        RowBox[{"RicciTensorT", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"MetricT", "/", "2"}], ")"}], "RicciScalarT"}]}]}], ";", 
       RowBox[{"mm", "=", 
        RowBox[{"op", "[", "mm", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"si", "=", 
        RowBox[{"StartIndex", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cooo", "=", 
        RowBox[{"Coordinates", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "...", "then", " ", "we", " ", "will", " ", "evaluate", " ", "it", 
          " ", "with", " ", "specified", " ", "indices", " ", "which", " ", 
          "may", " ", "be", " ", "non"}], "-", "abstract"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"TensorType", "\[Rule]", "\"\<EinsteinTensor\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
         "TensorName", "\[Rule]", 
          "\"\<\!\(\*StyleBox[\"G\",FontSlant->\"Italic\"]\)\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Coordinates", "\[Rule]", "cooo"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TensorComponents", "\[Rule]", "mm"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Indices", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\[Nu]I", ",", "\[Beta]I"}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TooltipDisplay", "\[Rule]", 
          RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TooltipStyle", "\[Rule]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
              RowBox[{"{", "}"}]}], ")"}], ",", 
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], ",", "True", 
            ",", " ", 
            RowBox[{"TooltipStyle", "[", "m", "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TensorAssumption", "\[Rule]", " ", 
          RowBox[{"TensorAssumption", "[", "m", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TensorOperator", "\[Rule]", 
          RowBox[{"TensorOperator", "[", "m", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.52174396084375*^9, 3.521743989140625*^9}, {
   3.52174404553125*^9, 3.52174406490625*^9}, {3.52174411178125*^9, 
   3.521744178*^9}, {3.52175753421875*^9, 3.52175753465625*^9}, {
   3.521759735640625*^9, 3.521759758125*^9}, {3.5217868350625*^9, 
   3.521786885078125*^9}, {3.52178704734375*^9, 3.521787116328125*^9}, {
   3.521787178828125*^9, 3.5217871886875*^9}, {3.521787424390625*^9, 
   3.5217874283125*^9}, {3.521787532828125*^9, 3.52178754371875*^9}, 
   3.521910410859375*^9, {3.5219174194375*^9, 3.521917422546875*^9}, {
   3.521917491703125*^9, 3.5219174925*^9}, {3.521917608890625*^9, 
   3.521917617625*^9}, {3.521918314421875*^9, 3.521918316125*^9}, {
   3.521919269328125*^9, 3.5219193048125*^9}, {3.521919497375*^9, 
   3.52191951465625*^9}, {3.521921384*^9, 3.5219213845625*^9}, {
   3.521922223546875*^9, 3.5219222338125*^9}, {3.521955617484375*^9, 
   3.521955648359375*^9}, {3.521990471359375*^9, 3.52199061959375*^9}, {
   3.521990750328125*^9, 3.521990763484375*^9}, {3.532452011949185*^9, 
   3.532452013961588*^9}, {3.532452056362463*^9, 3.5324520586088667`*^9}, {
   3.5324523712334156`*^9, 3.5324523744782214`*^9}, {3.5324524076906796`*^9, 
   3.532452416130295*^9}, {3.6294767558105354`*^9, 3.6294767579105387`*^9}, 
   3.629476819010624*^9, {3.629476855280675*^9, 3.6294768627906857`*^9}, {
   3.6294769420807962`*^9, 3.6294769782008467`*^9}, {3.6294770387409315`*^9, 
   3.629477203181162*^9}, {3.6294798110415907`*^9, 3.6294798411316333`*^9}, {
   3.6294799183917413`*^9, 3.6294799514217873`*^9}, {3.629479982661831*^9, 
   3.6294800828419714`*^9}, 3.6294819207671757`*^9, {3.629483491756879*^9, 
   3.629483500526891*^9}, {3.629483590307017*^9, 3.6294836211570597`*^9}, {
   3.629747897740327*^9, 3.629747915448358*^9}, {3.6297481546121883`*^9, 
   3.6297482356537313`*^9}, {3.629748275436802*^9, 3.629748305868657*^9}, {
   3.629753251057444*^9, 3.6297532569207797`*^9}, 3.836444871675889*^9, {
   3.8364449186542997`*^9, 3.8364449245081587`*^9}, {3.8364449612656736`*^9, 
   3.83644496355101*^9}, {3.83652621470687*^9, 3.8365262151608677`*^9}, {
   3.838194318651956*^9, 3.838194328878889*^9}, {3.8478400683664017`*^9, 
   3.8478400808462744`*^9}, {3.8757555360810723`*^9, 3.8757555641553893`*^9}, 
   3.8870143869214177`*^9, 3.887015669394334*^9, 3.8870157171937666`*^9, {
   3.895554774403056*^9, 3.8955547744070535`*^9}, 3.8955551722067127`*^9, {
   3.8966162069425187`*^9, 3.896616208014423*^9}, 3.8966166277006645`*^9, 
   3.9677774519571824`*^9, 3.971145779710032*^9, {3.975311642668686*^9, 
   3.975311713807003*^9}},ExpressionUUID->"7f1ccae2-3c30-4371-8618-\
d91a4f17ca91"]
}, Closed]],

Cell[CellGroupData[{

Cell["Determinant", "Subsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9},ExpressionUUID->"31e090b9-dd85-40b9-a7df-\
ce03fcde407b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Determinant", "[", "m_Tensor", "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}]}], ":=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"m", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"MetricDeterminant", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", 
       "mmm"}], ",", "1"}], "]"}], "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Determinant", "[", 
    RowBox[{"m_Tensor", ",", "Tensor"}], "]"}], "/;", 
   RowBox[{"(", 
    RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}]}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"NonMetricTensor", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", 
    RowBox[{"Determinant", "[", "m", "]"}], ",", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{"\"\<|\>\"", ",", 
       RowBox[{"TensorName", "[", "m", "]"}], ",", "\"\<|\>\""}], "}"}], 
     "]"}], ",", 
    RowBox[{"Coordinates", "\[Rule]", 
     RowBox[{"Coordinates", "[", "m", "]"}]}], ",", 
    RowBox[{"StartIndex", "\[Rule]", 
     RowBox[{"StartIndex", "[", "m", "]"}]}], ",", 
    RowBox[{"TooltipDisplay", "\[Rule]", " ", "Null"}], ",", 
    RowBox[{"TooltipStyle", "\[Rule]", " ", 
     RowBox[{"TooltipStyle", "[", "m", "]"}]}], ",", 
    RowBox[{"TensorAssumption", "\[Rule]", " ", 
     RowBox[{"TensorAssumption", "[", "m", "]"}]}], ",", 
    RowBox[{"TensorOperator", "\[Rule]", " ", 
     RowBox[{"TensorOperator", "[", "m", "]"}]}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.8757478168229427`*^9, 3.8757478170104313`*^9}, {3.875747869710776*^9, 
   3.8757478987658987`*^9}, {3.87575557445354*^9, 3.8757555815235987`*^9}, {
   3.887018713637618*^9, 3.8870187362742324`*^9}, {3.88701882766383*^9, 
   3.8870189409166346`*^9}, {3.8870190506997623`*^9, 3.887019050949607*^9}, {
   3.895555172209711*^9, 3.8955551722127094`*^9}, {3.8966162416384373`*^9, 
   3.8966162557192945`*^9}, {3.8966162866628656`*^9, 3.8966163053334227`*^9}, 
   3.967777451959187*^9, {3.97531172284788*^9, 
   3.975311727739203*^9}},ExpressionUUID->"0d49aaa7-8277-4d46-b9c9-\
435647c290fa"]
}, Closed]],

Cell[CellGroupData[{

Cell["OrthonormalFrameField", "Subsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.8594633251764164`*^9, 
   3.859463333056177*^9}},ExpressionUUID->"55230c28-b185-4766-80cb-\
5916481cf9ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    StyleBox["Extract",
     FontColor->RGBColor[1, 0, 1]], " ", "from", " ", "a", " ", 
    StyleBox["metric",
     FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"OrthonormalFrameField", "[", "m_Tensor", "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}]}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Extract", " ", "both", " ", 
     StyleBox["OrthonormalFrameField",
      FontColor->RGBColor[1, 0, 1]], " ", "and", " ", 
     StyleBox["InverseOrthonormalFrameField",
      FontColor->RGBColor[1, 0, 1]], " ", "as", " ", "a", " ", 
     StyleBox["list",
      FontColor->RGBColor[1, 0, 1]], " ", 
     RowBox[{"output", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cases", "[", 
       RowBox[{"m", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"OrthonormalFrameField", "\[Rule]", "mmm_"}], ")"}], 
         "\[Rule]", "mmm"}], ",", "1"}], "]"}], "\[LeftDoubleBracket]", "1", 
      "\[RightDoubleBracket]"}], ",", 
     RowBox[{
      RowBox[{"Cases", "[", 
       RowBox[{"m", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "mmm_"}], ")"}], 
         "\[Rule]", "mmm"}], ",", "1"}], "]"}], "\[LeftDoubleBracket]", "1", 
      "\[RightDoubleBracket]"}]}], "}"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.859463335019122*^9, 3.8594633391156645`*^9}, {3.859464367519883*^9, 
   3.8594643690732255`*^9}, {3.859507713580587*^9, 3.8595077139573507`*^9}, {
   3.8596023095771112`*^9, 3.859602322728838*^9}, {3.861138859121119*^9, 
   3.861138875501281*^9}, {3.861139044404683*^9, 3.8611390670508685`*^9}, {
   3.87574403265349*^9, 3.875744034950078*^9}, {3.875755593216878*^9, 
   3.875755602188178*^9}, 3.895555172215708*^9, 
   3.9753117383890553`*^9},ExpressionUUID->"a95930d0-217d-4427-a008-\
12e0a3b0dc8e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Declare", " ", "OrthonormalFrameField", " ", "as", " ", "a", " ", 
    StyleBox["Tensor",
     FontColor->RGBColor[1, 0, 1]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 1]], 
    StyleBox[
     RowBox[{"object", ".", " ", "Input"}],
     FontColor->RGBColor[1, 0, 1]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 1]], 
    StyleBox["a",
     FontColor->RGBColor[1, 0, 1]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 1]], 
    StyleBox["metric",
     FontColor->RGBColor[1, 0, 1]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 1]], 
    StyleBox[
     RowBox[{"w", "/", " ", "OrthonormalFrameField"}],
     FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"OrthonormalFrameField", "[", 
     RowBox[{
      RowBox[{"\[Mu]1_", "/;", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"TestIndices", "[", "\[Mu]1", "]"}], "&&", 
         RowBox[{"TestOverHatIndex", "[", "\[Mu]1", "]"}]}], ")"}]}], ",", 
      RowBox[{"\[Mu]2_", "/;", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"TestIndices", "[", "\[Mu]2", "]"}], "&&", 
         RowBox[{"!", 
          RowBox[{"TestOverHatIndex", "[", "\[Mu]2", "]"}]}]}], ")"}]}], ",", 
      RowBox[{"m_Tensor", "/;", 
       RowBox[{"(", 
        RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "Flatmetric", ",", "invonfft", ",", "onfft", ",", "invonffm", ",", 
        "onffm"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Extract", " ", 
        StyleBox["Flatmetric",
         FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Flatmetric", "=", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"m", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"FlatMetric", "\[Rule]", "fm_"}], ")"}], "\[Rule]", 
            "fm"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"onfft", "=", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"m", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"OrthonormalFrameField", "\[Rule]", "onf_"}], ")"}], 
            "\[Rule]", "onf"}], ",", "1"}], "]"}], "\[LeftDoubleBracket]", 
         "1", "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"invonfft", "=", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"m", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "ionf_"}], 
             ")"}], "\[Rule]", "ionf"}], ",", "1"}], "]"}], 
         "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"onffm", "=", 
        RowBox[{"TensorComponents", "[", "onfft", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"invonffm", "=", 
        RowBox[{"TensorComponents", "[", "invonfft", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Indices", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"onfft", "/.", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], "->", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", 
              RowBox[{"Which", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Sgn", "[", "\[Mu]1", "]"}], "===", "1"}], "&&", 
                  RowBox[{
                   RowBox[{"Sgn", "[", "\[Mu]2", "]"}], "===", 
                   RowBox[{"-", "1"}]}]}], ")"}], ",", 
                RowBox[{"(*", 
                 StyleBox[
                  SubscriptBox[
                   SuperscriptBox["\[CurlyEpsilon]", 
                    OverscriptBox["a", "^"]], "b"],
                  FontColor->RGBColor[1, 0, 1]], "*)"}], "onffm", ",", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Sgn", "[", "\[Mu]1", "]"}], "===", 
                   RowBox[{"-", "1"}]}], "&&", 
                  RowBox[{
                   RowBox[{"Sgn", "[", "\[Mu]2", "]"}], "===", 
                   RowBox[{"-", "1"}]}]}], ")"}], ",", 
                RowBox[{"(*", 
                 StyleBox[
                  RowBox[{
                   SubscriptBox[
                    SubscriptBox[
                    StyleBox["\[CurlyEpsilon]",
                    FontColor->RGBColor[1, 0, 1]], 
                    OverscriptBox["a", "^"]], "b"], "=", 
                   RowBox[{
                    SubscriptBox["\[Eta]", "ac"], 
                    SubscriptBox[
                    SuperscriptBox[
                    StyleBox["\[CurlyEpsilon]",
                    FontColor->RGBColor[1, 0, 1]], 
                    OverscriptBox["c", "^"]], "b"]}]}],
                  FontColor->RGBColor[1, 0, 1]], "*)"}], 
                RowBox[{"Flatmetric", ".", "onffm"}], ",", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Sgn", "[", "\[Mu]1", "]"}], "===", 
                   RowBox[{"-", "1"}]}], "&&", 
                  RowBox[{
                   RowBox[{"Sgn", "[", "\[Mu]2", "]"}], "===", "1"}]}], ")"}],
                 ",", 
                RowBox[{"(*", 
                 StyleBox[
                  SuperscriptBox[
                   SubscriptBox["\[CurlyEpsilon]", 
                    OverscriptBox["a", "^"]], "b"],
                  FontColor->RGBColor[1, 0, 1]], "*)"}], "invonffm", ",", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Sgn", "[", "\[Mu]1", "]"}], "===", "1"}], "&&", 
                  RowBox[{
                   RowBox[{"Sgn", "[", "\[Mu]2", "]"}], "===", "1"}]}], ")"}],
                 ",", 
                RowBox[{"(*", 
                 StyleBox[
                  RowBox[{
                   SuperscriptBox["\[CurlyEpsilon]", 
                    RowBox[{
                    OverscriptBox["a", "^"], "b"}]], "=", 
                   RowBox[{
                    SuperscriptBox["\[Eta]", "ac"], 
                    SuperscriptBox[
                    SubscriptBox[
                    StyleBox["\[CurlyEpsilon]",
                    FontColor->RGBColor[1, 0, 1]], 
                    OverscriptBox["c", "^"]], "b"]}]}],
                  FontColor->RGBColor[1, 0, 1]], "*)"}], 
                RowBox[{"Flatmetric", ".", "invonffm"}]}], "]"}]}], ")"}]}]}],
           ")"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Mu]1", ",", "\[Mu]2"}], "}"}]}], "]"}]}]}], "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8596038964070253`*^9, 3.859603925518066*^9}, {
   3.8596045418323236`*^9, 3.8596045787998104`*^9}, {3.8596046297375183`*^9, 
   3.85960464509505*^9}, {3.859604838547741*^9, 3.8596048429860063`*^9}, {
   3.860069680577582*^9, 3.8600697491115823`*^9}, {3.860069809128106*^9, 
   3.8600699958960943`*^9}, {3.8600707987140965`*^9, 
   3.8600708276229396`*^9}, {3.8600709159052453`*^9, 3.8600709197903757`*^9}, 
   3.860071224435073*^9, {3.860071299365382*^9, 3.860071319425085*^9}, {
   3.8600713973703203`*^9, 3.8600713983938313`*^9}, {3.860071432945159*^9, 
   3.8600714494050827`*^9}, {3.8600714833254213`*^9, 
   3.8600715075550413`*^9}, {3.860071660435388*^9, 3.8600716789850674`*^9}, {
   3.8600717567213583`*^9, 3.8600717579950676`*^9}, {3.8600719208454685`*^9, 
   3.8600719616455045`*^9}, {3.8611389873711805`*^9, 
   3.8611390338411837`*^9}, {3.861139080130872*^9, 3.8611392960209627`*^9}, {
   3.8611393394309373`*^9, 3.861139444591175*^9}, {3.8611395013809657`*^9, 
   3.8611395376909866`*^9}, {3.8611399816967936`*^9, 3.8611399959312706`*^9}, 
   3.861140027652315*^9, {3.861140070991314*^9, 3.861140080791297*^9}, {
   3.8611424698671317`*^9, 3.8611425281325417`*^9}, {3.8611425629302006`*^9, 
   3.861142648906053*^9}, {3.8612291720969276`*^9, 3.861229174950161*^9}, {
   3.8612303391843367`*^9, 3.8612303553893957`*^9}, {3.8757556135227385`*^9, 
   3.8757556358427544`*^9}, {3.8955547744240427`*^9, 3.8955547744280405`*^9}, 
   3.895555172221701*^9, {3.897125884814992*^9, 3.897125903954294*^9}, 
   3.8993785019466133`*^9, {3.902823645204873*^9, 3.9028237227525187`*^9}, {
   3.952993829649548*^9, 3.9529938441230497`*^9}, 3.967777451961192*^9, 
   3.9710856962354717`*^9, 3.9723484164245358`*^9, {3.975311745486515*^9, 
   3.975311746426146*^9}},ExpressionUUID->"31fa951b-fa09-4c1b-8761-\
c958895c180d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Input", " ", "a", " ", 
    StyleBox["metric",
     FontColor->RGBColor[1, 0, 1]], " ", "and", " ", 
    StyleBox["FlatMetric",
     FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"OrthonormalFrameField", "[", 
       RowBox[{"m_Tensor", ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}]}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"onffoutput", ",", "tempm", ",", "onffidx"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"onffoutput", "=", 
         RowBox[{"OptionValue", "[", "OutputForm", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Trigger", " ", "Tensor", " ", 
          RowBox[{"code", ".", " ", 
           RowBox[{"See", ":", " ", 
            StyleBox[
             RowBox[{"OrthonormalFrameField", " ", "Tensor", " ", "part"}],
             FontColor->RGBColor[1, 0, 1]]}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"onffidx", "=", 
         RowBox[{"OptionValue", "[", "OrthonormalFrameFieldIndices", "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"tempm", "=", 
         RowBox[{"m", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"FlatMetric", "\[Rule]", "fmm_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"FlatMetric", "\[Rule]", 
               RowBox[{"OptionValue", "[", "FlatMetric", "]"}]}], ")"}]}], 
            ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"OrthonormalFrameField", "\[Rule]", "fmm_"}], ")"}], 
             "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"OrthonormalFrameField", "\[Rule]", 
               RowBox[{"OptionValue", "[", "OrthonormalFrameField", "]"}]}], 
              ")"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "fmm_"}], 
              ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"InverseOrthonormalFrameField", "\[Rule]", 
               RowBox[{
               "OptionValue", "[", "InverseOrthonormalFrameField", "]"}]}], 
              ")"}]}], ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
               "OrthonormalFrameFieldOperator", "\[Rule]", "onffop_"}], ")"}],
               "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"OrthonormalFrameFieldOperator", "\[Rule]", 
                RowBox[{
                "OptionValue", "[", "OrthonormalFrameFieldOperator", "]"}]}], 
               ")"}]}], ")"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
               "OrthonormalFrameFieldIndices", "\[Rule]", "onffidxx_"}], 
               ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"OrthonormalFrameFieldIndices", "\[Rule]", "onffidx"}],
                ")"}]}], ")"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"onffoutput", "===", "Metric"}], ")"}], ",", "tempm", ",", 
          RowBox[{"(", 
           RowBox[{"onffoutput", "===", "All"}], ")"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Sequence", "@@", 
             RowBox[{"OrthonormalFrameField", "[", "tempm", "]"}]}], ",", 
            "tempm"}], "}"}], ",", "True", ",", "tempm"}], "]"}]}]}], "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Second", " ", "strategy", " ", "of", " ", "ONFF"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OrthonormalFrameField", "[", 
      RowBox[{
       RowBox[{"m_Tensor", "/;", 
        RowBox[{"TestMetricTensor", "[", "m", "]"}]}], ",", "eigens_List", 
       ",", "order_List", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "fm", ",", "Flatmetric", ",", "g", ",", "ginv", ",", "d", ",", 
          "rotm", ",", "valuesqrt", ",", "ONFFm", ",", "ONFFinvm", ",", 
          "output", ",", "onff", ",", "invonff", ",", "idx", ",", "matrix", 
          ",", "onffop", ",", "cc", ",", "checkonff", ",", "tempm", ",", 
          "ONFFt", ",", "ONFFinvt", ",", "\[Alpha]", ",", "\[Mu]", ",", 
          "coord", ",", "onffidx", ",", "ONFFtidx", ",", "ONFFinvtidx", ",", 
          "eigenvalue", ",", "eigenvector", ",", "i", ",", "Listt", ",", 
          "onffoutput"}], "}"}], ",", 
        RowBox[{
         RowBox[{"fm", "=", 
          RowBox[{"OptionValue", "[", "FlatMetric", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"onffop", "=", 
          RowBox[{
          "OptionValue", "[", "OrthonormalFrameFieldOperator", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"onffidx", "=", 
          RowBox[{"OptionValue", "[", "OrthonormalFrameFieldIndices", "]"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"onffoutput", "=", 
          RowBox[{"OptionValue", "[", "OutputForm", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"idx", "=", 
          RowBox[{"Indices", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"matrix", "=", 
          RowBox[{"TensorComponents", "[", "m", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"coord", "=", 
          RowBox[{"Coordinates", "[", "m", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{"idx", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"SubMinus", "[", "_", "]"}], ",", 
               RowBox[{"SubMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"g", "=", "matrix"}], ";", 
            RowBox[{"ginv", "=", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Inverse", "[", "matrix", "]"}], "//", "onffop"}], 
              ")"}]}]}], ",", 
           RowBox[{"MatchQ", "[", 
            RowBox[{"idx", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"SuperMinus", "[", "_", "]"}], ",", 
               RowBox[{"SuperMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"ginv", "=", "matrix"}], ";", 
            RowBox[{"g", "=", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Inverse", "[", "matrix", "]"}], "//", "onffop"}], 
              ")"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"d", "=", 
          RowBox[{"Length", "[", "fm", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"eigenvalue", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"eigens", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", 
              RowBox[{
              "order", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}]}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "d"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"eigenvector", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"eigens", "\[LeftDoubleBracket]", 
             RowBox[{"2", ",", 
              RowBox[{
              "order", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}]}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "d"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Flatmetric", "=", 
          RowBox[{"DiagonalMatrix", "[", "fm", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"rotm", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Normalize", "[", 
               RowBox[{
               "eigenvector", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "]"}], "//", "onffop"}], ")"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "d"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"valuesqrt", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Sqrt", "[", "#", "]"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"Flatmetric", ".", "eigenvalue"}], ")"}]}], ")"}], "//",
            "onffop"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ONFFm", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "valuesqrt", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], " ", 
               RowBox[{
               "rotm", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "d"}], "}"}]}], "]"}], ")"}], "//",
            "onffop"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ONFFinvm", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Flatmetric", ".", "ONFFm", ".", "ginv"}], ")"}], "//", 
           "onffop"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Listt", "=", 
          RowBox[{"Apply", "[", 
           RowBox[{"List", ",", "m"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "The", " ", "first", " ", "index", " ", "should", " ", "have", " ", 
           "OverHat"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"ONFFtidx", "=", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"onffidx", "=!=", "Null"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Head", "[", "#", "]"}], "&"}], "/@", "onffidx"}], 
                 ")"}], "===", 
                RowBox[{"{", 
                 RowBox[{"OverHat", ",", "Symbol"}], "}"}]}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Head", "[", 
                 RowBox[{"onffidx", "\[LeftDoubleBracket]", 
                  RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], "===",
                 "Symbol"}], ")"}]}], ")"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SuperscriptBox[
               RowBox[{
               "onffidx", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "-"], ",", 
              SubscriptBox[
               RowBox[{
               "onffidx", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], "-"]}], "}"}], ",", "True", ",", 
            RowBox[{"{", 
             RowBox[{
              SuperscriptBox[
               OverscriptBox["\[Alpha]", "^"], "-"], ",", 
              SubscriptBox["\[Mu]", "-"]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ONFFinvtidx", "=", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"onffidx", "=!=", "Null"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Head", "[", "#", "]"}], "&"}], "/@", "onffidx"}], 
                 ")"}], "===", 
                RowBox[{"{", 
                 RowBox[{"OverHat", ",", "Symbol"}], "}"}]}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Head", "[", 
                 RowBox[{"onffidx", "\[LeftDoubleBracket]", 
                  RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], "===",
                 "Symbol"}], ")"}]}], ")"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox[
               RowBox[{"(", 
                RowBox[{
                "onffidx", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], ")"}], "-"], ",", 
              SuperscriptBox[
               RowBox[{
               "onffidx", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], "-"]}], "}"}], ",", "True", ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox[
               OverscriptBox["\[Alpha]", "^"], "-"], ",", 
              SuperscriptBox["\[Mu]", "-"]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ONFFt", "=", 
          RowBox[{"Listt", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"FlatMetric", "\[Rule]", "fmmmm_"}], ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"FlatMetric", "\[Rule]", "Flatmetric"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorType", "\[Rule]", "tt_"}], ")"}], "\[Rule]", 
              " ", "Nothing"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorName", "\[Rule]", "tn_"}], ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"TensorName", "\[Rule]", "\"\<\[CurlyEpsilon]\>\""}], 
               ")"}]}], " ", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Indices", "\[Rule]", "idxx_"}], ")"}], "\[Rule]", " ", 
              RowBox[{"(", 
               RowBox[{"Indices", "\[Rule]", "ONFFtidx"}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorComponents", "\[Rule]", "tc_"}], ")"}], 
              "\[Rule]", " ", 
              RowBox[{"(", 
               RowBox[{"TensorComponents", "\[Rule]", "ONFFm"}], ")"}]}]}], 
            "}"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ONFFinvt", "=", 
          RowBox[{"ONFFt", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Indices", "\[Rule]", "idxx_"}], ")"}], "\[Rule]", " ", 
              RowBox[{"(", 
               RowBox[{"Indices", "\[Rule]", "ONFFinvtidx"}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorComponents", "\[Rule]", "tc_"}], ")"}], 
              "\[Rule]", " ", 
              RowBox[{"(", 
               RowBox[{"TensorComponents", "\[Rule]", "ONFFinvm"}], ")"}]}]}],
             "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ONFFt", "=", 
          RowBox[{"Apply", "[", 
           RowBox[{"Tensor", ",", "ONFFt"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ONFFinvt", "=", 
          RowBox[{"Apply", "[", 
           RowBox[{"Tensor", ",", "ONFFinvt"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Replace", " ", 
           RowBox[{"w", "/", " ", "calculation"}], " ", 
           RowBox[{"result", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"tempm", "=", 
          RowBox[{"Listt", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"FlatMetric", "\[Rule]", "fmmmm_"}], ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"FlatMetric", "\[Rule]", "Flatmetric"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"OrthonormalFrameField", "\[Rule]", "onf_"}], ")"}], 
              "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"OrthonormalFrameField", "\[Rule]", "ONFFt"}], ")"}]}],
              ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "ionf_"}], 
               ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
               "InverseOrthonormalFrameField", "\[Rule]", "ONFFinvt"}], 
               ")"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"OrthonormalFrameFieldOperator", "\[Rule]", "oop_"}], 
               ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"OrthonormalFrameFieldOperator", "\[Rule]", "Null"}], 
               ")"}]}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tempm", "=", 
          RowBox[{"Apply", "[", 
           RowBox[{"Tensor", ",", "tempm"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"onffoutput", "===", "Metric"}], ")"}], ",", "tempm", ",", 
           RowBox[{"(", 
            RowBox[{"onffoutput", "===", "All"}], ")"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Sequence", "@@", 
              RowBox[{"OrthonormalFrameField", "[", "tempm", "]"}]}], ",", 
             "tempm"}], "}"}], ",", "True", ",", "tempm"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Dimensions", "[", "eigens", "]"}], "===", 
          RowBox[{"{", 
           RowBox[{"2", ",", 
            RowBox[{"CoordinatesDimension", "[", "m", "]"}]}], "}"}]}], ")"}],
         "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", "order", "]"}], "===", 
          RowBox[{"CoordinatesDimension", "[", "m", "]"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"OptionValue", "[", "FlatMetric", "]"}], "]"}], "===", 
          RowBox[{"CoordinatesDimension", "[", "m", "]"}]}], ")"}]}], 
       ")"}]}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.859463335019122*^9, 3.8594633391156645`*^9}, {3.859464367519883*^9, 
   3.859464391632702*^9}, {3.859464452769555*^9, 3.8594644880892754`*^9}, {
   3.859464618161083*^9, 3.8594646228577676`*^9}, {3.8595024952531805`*^9, 
   3.8595025289382677`*^9}, {3.8595027151916833`*^9, 
   3.8595027355233316`*^9}, {3.859502782470359*^9, 3.8595028008309746`*^9}, 
   3.8595028351596828`*^9, {3.8595029136000357`*^9, 3.8595029469893312`*^9}, {
   3.859502995133472*^9, 3.859503019173564*^9}, {3.85950364424656*^9, 
   3.8595036881333413`*^9}, {3.8595037643723617`*^9, 3.859503909492855*^9}, {
   3.8595039808743496`*^9, 3.859504012881143*^9}, {3.859504060345304*^9, 
   3.8595040724887753`*^9}, {3.8595041439218183`*^9, 3.859504197700467*^9}, 
   3.8595043124312744`*^9, {3.8595077167656107`*^9, 3.859507717094408*^9}, {
   3.859600932965207*^9, 3.8596009374764423`*^9}, {3.859602329842342*^9, 
   3.8596023339864054`*^9}, {3.8596023967141*^9, 3.859602578496228*^9}, {
   3.8606707705520325`*^9, 3.8606707736173344`*^9}, {3.8606708487181234`*^9, 
   3.860670927271941*^9}, {3.860671014351989*^9, 3.8606710808985023`*^9}, {
   3.8606711145220604`*^9, 3.860671134671993*^9}, {3.860671227842003*^9, 
   3.8606712485420094`*^9}, {3.8606713020420732`*^9, 
   3.8606713370420513`*^9}, {3.8606714331118574`*^9, 3.860671489222354*^9}, {
   3.8606719714548535`*^9, 3.86067198113586*^9}, {3.860673100105175*^9, 
   3.8606732721052413`*^9}, {3.860673448495226*^9, 3.8606734531652203`*^9}, {
   3.8606735346574316`*^9, 3.8606735897751274`*^9}, {3.860673632525326*^9, 
   3.860673707815308*^9}, {3.860673768745264*^9, 3.8606737911053715`*^9}, {
   3.861138827835783*^9, 3.8611388322112074`*^9}, {3.8611395634509287`*^9, 
   3.8611395938511086`*^9}, {3.8611396630104284`*^9, 
   3.8611396978812866`*^9}, {3.8611397817613583`*^9, 
   3.8611398627412343`*^9}, {3.861139962340995*^9, 3.8611399632012177`*^9}, {
   3.8611401006613417`*^9, 3.861140129951003*^9}, {3.8613325596625423`*^9, 
   3.8613326203092036`*^9}, {3.8655626600762515`*^9, 
   3.8655626641731806`*^9}, {3.8757557682682624`*^9, 
   3.8757557865109835`*^9}, {3.8955547744430313`*^9, 
   3.8955547744460297`*^9}, {3.895555172226699*^9, 3.895555172229698*^9}, {
   3.8991747485634193`*^9, 3.899174869149788*^9}, {3.899174902279078*^9, 
   3.899175088367309*^9}, {3.899175118860524*^9, 3.899175194555848*^9}, {
   3.899175307708144*^9, 3.8991753406418567`*^9}, {3.8991753744350386`*^9, 
   3.8991753870582623`*^9}, {3.8991754249139423`*^9, 3.899175481049362*^9}, 
   3.8991755364182334`*^9, {3.8991755939606557`*^9, 3.8991756078900743`*^9}, {
   3.899175638080456*^9, 3.8991756510804467`*^9}, 3.8991756879598117`*^9, {
   3.8991757479802556`*^9, 3.8991758130894265`*^9}, {3.899175847307356*^9, 
   3.8991758822258425`*^9}, {3.8991759128549757`*^9, 
   3.8991759339209986`*^9}, {3.899177335078223*^9, 3.899177335287097*^9}, 
   3.8991885530214653`*^9, 3.899377029018897*^9, {3.9028240668540874`*^9, 
   3.902824068793251*^9}, {3.952993846824641*^9, 3.952993851955427*^9}, {
   3.956199042606863*^9, 3.956199042650248*^9}, {3.959934223391993*^9, 
   3.959934281121777*^9}, {3.967777451962938*^9, 3.967777451962938*^9}, 
   3.971085718033119*^9, 3.971088001416112*^9, 3.971230073210322*^9, 
   3.9712307775999613`*^9, 3.971231750960031*^9, 3.971232753973146*^9, 
   3.971232943855418*^9, {3.971233072612629*^9, 3.971233077631974*^9}, 
   3.971233381208983*^9, {3.9717499039356327`*^9, 3.971749920178809*^9}, 
   3.9717540293729563`*^9, {3.9732214004709873`*^9, 3.97322140047768*^9}, 
   3.973765491917149*^9, {3.9753117563123207`*^9, 
   3.975311863146451*^9}},ExpressionUUID->"34349c22-e864-41cf-ad64-\
9e5af6463d2e"]
}, Closed]],

Cell[CellGroupData[{

Cell["OrthonormalFrameFieldQ", "Subsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.8594633251764164`*^9, 3.859463333056177*^9}, 
   3.971088611679667*^9, 
   3.9737654919265003`*^9},ExpressionUUID->"9f57dc72-9a35-4623-8283-\
7085f7bd2d73"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "OrthonormalFrameFieldQ", " ", "becomes", " ", "a", " ", "standalone", " ", 
    RowBox[{"Function", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"OrthonormalFrameFieldQ", "[", 
     RowBox[{
      RowBox[{"m_Tensor", "/;", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"TestMetricTensor", "[", "m", "]"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"m", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"OrthonormalFrameField", "\[Rule]", "onf_"}], ")"}], 
              "\[Rule]", "onf"}], ",", "1"}], "]"}], "=!=", 
           RowBox[{"{", "}"}]}], ")"}], "&&", "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"m", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "ionf_"}], 
               ")"}], "\[Rule]", "ionf"}], ",", "1"}], "]"}], "=!=", 
           RowBox[{"{", "}"}]}], ")"}]}], ")"}]}], ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "result1", ",", "result2", ",", "Flatmetric", ",", "invonfft", ",", 
        "onfft", ",", "invonffm", ",", "onffm", ",", "onffop", ",", "g"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Flatmetric", "=", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"m", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"FlatMetric", "\[Rule]", "fm_"}], ")"}], "\[Rule]", 
            "fm"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"onfft", "=", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"m", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"OrthonormalFrameField", "\[Rule]", "onf_"}], ")"}], 
            "\[Rule]", "onf"}], ",", "1"}], "]"}], "\[LeftDoubleBracket]", 
         "1", "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"invonfft", "=", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"m", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "ionf_"}], 
             ")"}], "\[Rule]", "ionf"}], ",", "1"}], "]"}], 
         "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"onffm", "=", 
        RowBox[{"TensorComponents", "[", "onfft", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"invonffm", "=", 
        RowBox[{"TensorComponents", "[", "invonfft", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"onffop", "=", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"m", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"OrthonormalFrameFieldOperator", "\[Rule]", "onfop_"}], 
             ")"}], "\[Rule]", "onfop"}], ",", "1"}], "]"}], 
         "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"g", "=", 
        RowBox[{"TensorComponents", "[", "m", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        StyleBox[
         RowBox[{
          SubscriptBox["g", "cd"], "=", 
          RowBox[{
           SubscriptBox[
            SuperscriptBox[
             StyleBox["\[CurlyEpsilon]",
              FontColor->RGBColor[1, 0, 1]], 
             OverscriptBox["a", "^"]], "c"], 
           FormBox[
            SubscriptBox["\[Eta]", "ab"],
            TraditionalForm], 
           SubscriptBox[
            SuperscriptBox["\[CurlyEpsilon]", 
             OverscriptBox["b", "^"]], "d"]}]}],
         FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"result1", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Transpose", "[", "onffm", "]"}], ".", "Flatmetric", ".", 
            "onffm"}], "\[Equal]", "g"}], ")"}], "//", "onffop"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        StyleBox[
         RowBox[{
          SubscriptBox["\[Eta]", "cd"], "=", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox[
             StyleBox["\[CurlyEpsilon]",
              FontColor->RGBColor[1, 0, 1]], 
             OverscriptBox["c", "^"]], "a"], 
           FormBox[
            SubscriptBox["g", "ab"],
            TraditionalForm], 
           SuperscriptBox[
            SubscriptBox["\[CurlyEpsilon]", 
             OverscriptBox["d", "^"]], "b"]}]}],
         FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"result2", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"invonffm", ".", "g", ".", 
             RowBox[{"Transpose", "[", "invonffm", "]"}]}], "==", 
            "Flatmetric"}], ")"}], "//", "onffop"}], ")"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"OptionValue", "[", "OutputForm", "]"}], "===", 
           "BooleanQ"}], ")"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"result1", "===", "True"}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{"result2", "===", "True"}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"result1", ",", "result2"}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.859463335019122*^9, 3.8594633391156645`*^9}, {3.859464367519883*^9, 
   3.8594643690732255`*^9}, {3.859507713580587*^9, 3.8595077139573507`*^9}, {
   3.8596023095771112`*^9, 3.859602322728838*^9}, {3.861138859121119*^9, 
   3.861138875501281*^9}, {3.861139044404683*^9, 3.8611390670508685`*^9}, {
   3.87574403265349*^9, 3.875744034950078*^9}, {3.875755593216878*^9, 
   3.875755602188178*^9}, 3.895555172215708*^9, 3.9710886083429623`*^9, 
   3.971753058434376*^9, 3.971753220742584*^9, 3.9732216559440928`*^9, {
   3.973634126703967*^9, 3.973634128305622*^9}, {3.973634216843677*^9, 
   3.9736342200863123`*^9}, 3.973720986420208*^9, {3.97376549193038*^9, 
   3.973765491932076*^9}, 
   3.975311881920793*^9},ExpressionUUID->"d7f23f52-99bd-410b-87a7-\
e3d80e321473"]
}, Closed]],

Cell[CellGroupData[{

Cell["TensorsProduct", "Subsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.533880012946951*^9, 3.5338800148345547`*^9}, {
   3.5760890087086353`*^9, 3.5760890111890397`*^9}, {3.6061493485872273`*^9, 
   3.6061493494062743`*^9}, {3.6063295871603746`*^9, 
   3.6063295903404236`*^9}, {3.6719161852351665`*^9, 
   3.6719161897602363`*^9}, {3.6720788835848565`*^9, 3.672078885110944*^9}, 
   3.895549051059042*^9, {3.895549110830656*^9, 3.895549136083763*^9}, {
   3.896614300254381*^9, 3.8966143394381533`*^9}, 3.89661436961596*^9, 
   3.964598916784186*^9},ExpressionUUID->"4b9962c6-9104-4d0d-bd43-\
8c6f3876bd96"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"\[TensorProduct]", 
    RowBox[{":", " ", 
     RowBox[{"esc", "+", " ", "t", "+", 
      RowBox[{"*", 
       RowBox[{"+", "esc"}], " ", "shortcut", " ", "for", " ", 
       RowBox[{"TensorsProduct", "."}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Unprotect", "[", "TensorProduct", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TensorProduct", "[", 
     RowBox[{"ttt__", "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Union", "[", 
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"{", "ttt", "}"}], ",", 
           RowBox[{"Tensor", "[", "xx___", "]"}], ",", "\[Infinity]"}], "]"}],
          "]"}], "=!=", 
        RowBox[{"{", "}"}]}], ")"}]}], "]"}], ":=", 
    RowBox[{"TensorsProduct", "[", 
     RowBox[{"{", "ttt", "}"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Protect", "[", "TensorProduct", "]"}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.895553990030738*^9, 3.8955539917922945`*^9}, {
   3.895556090116927*^9, 3.895556090120925*^9}, 3.896614319065859*^9, {
   3.964598890661813*^9, 3.964598995044272*^9}, {3.964599433236485*^9, 
   3.9645994365469503`*^9}, 3.964599494819963*^9, 3.964599558803492*^9, 
   3.9645999665511513`*^9, 3.964662644311019*^9, 
   3.975311895470999*^9},ExpressionUUID->"3ab4e30c-78c1-4071-bbae-\
834e928eba24"]
}, Closed]],

Cell[CellGroupData[{

Cell["ContractTensors", "Subsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.533880012946951*^9, 3.5338800148345547`*^9}, {
   3.5760890087086353`*^9, 3.5760890111890397`*^9}, {3.6061493485872273`*^9, 
   3.6061493494062743`*^9}, {3.6063295871603746`*^9, 
   3.6063295903404236`*^9}, {3.6719161852351665`*^9, 
   3.6719161897602363`*^9}, {3.6720788835848565`*^9, 3.672078885110944*^9}, 
   3.895549051059042*^9, {3.895549110830656*^9, 3.895549136083763*^9}, {
   3.896614300254381*^9, 3.8966143394381533`*^9}, 3.89661436961596*^9, {
   3.966394076463723*^9, 
   3.966394076744433*^9}},ExpressionUUID->"1e02da7f-dadb-4d22-9e40-\
becc081cf057"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ContractTensors", "[", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"t_Times", "|", "t_List"}], "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"t", "=!=", 
            RowBox[{"{", "}"}]}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"t", ",", "_Tensor", ",", "Infinity"}], "]"}], "=!=", 
            RowBox[{"{", "}"}]}], ")"}]}], ")"}]}], ")"}], "]"}], "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"TestTensorsProduct", "[", "t", "]"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Union", "[", 
           RowBox[{"IsThereInertTensor", "[", "t", "]"}], "]"}], ")"}], "=!=", 
         RowBox[{"{", "False", "}"}]}], ")"}]}], ")"}]}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"WhichTensorsAreInert", "=", 
         RowBox[{"IsThereInertTensor", "[", "t", "]"}]}], ",", 
        RowBox[{"tList", "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"List", ",", "t"}], "]"}]}], ",", 
        RowBox[{"InertTensorR", "=", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"ActiveTensor", "=", "tList"}], ",", 
        RowBox[{"InertTensor", "=", "1"}], ",", "tl"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tl", "=", 
        RowBox[{"Length", "[", "WhichTensorsAreInert", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
            "WhichTensorsAreInert", "\[LeftDoubleBracket]", "ii", 
             "\[RightDoubleBracket]"}], ")"}], ",", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"InertTensorR", ",", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "tList", "\[LeftDoubleBracket]", "ii", 
                 "\[RightDoubleBracket]"}], "->", "Nothing"}], ")"}]}], "]"}],
             ";", 
            RowBox[{"InertTensor", "=", 
             RowBox[{"InertTensor", " ", 
              RowBox[{
              "tList", "\[LeftDoubleBracket]", "ii", 
               "\[RightDoubleBracket]"}]}]}], ";"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "tl"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"InertTensor", "\[IndentingNewLine]", 
        RowBox[{"ContractTensors", "[", 
         RowBox[{"tList", "/.", "InertTensorR"}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ContractTensors", "[", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"t_Times", "|", "t_List"}], "/;", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"t", "=!=", 
           RowBox[{"{", "}"}]}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"t", ",", "_Tensor", ",", "Infinity"}], "]"}], "=!=", 
           RowBox[{"{", "}"}]}], ")"}]}], ")"}]}], ")"}], "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"TestTensorsProduct", "[", "t", "]"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Union", "[", 
          RowBox[{"IsThereInertTensor", "[", "t", "]"}], "]"}], ")"}], "===", 
        RowBox[{"{", "False", "}"}]}], ")"}]}], ")"}]}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"tList", "=", 
        RowBox[{"Apply", "[", 
         RowBox[{"List", ",", "t"}], "]"}]}], ",", "tl", ",", "allInidces", 
       ",", "allInidcesRemovePosition", ",", "FlattenAllInidces", ",", "idxl",
        ",", "IndicesFirst", ",", "RepeatedPlus", ",", "FirstTensor", ",", 
       "d", ",", "ContractIndices", ",", "DeleteContractIndicesR", ",", 
       "InertIndices", ",", "ContractIndicesRange", ",", "InertIndicesRange", 
       ",", "tcList", ",", "mtx", ",", "GatherFlattenAllIndices", ",", 
       "RepeatedPairs"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"allInidces", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"RemoveUnderBarredIndices", "[", "#", "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Indices", "[", "#", "]"}], "&"}], "/@", "tList"}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"allInidcesRemovePosition", "=", 
       RowBox[{"allInidces", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"SubMinus", "[", "a_", "]"}], ":>", "a"}], ",", 
          RowBox[{
           RowBox[{"SuperMinus", "[", "b_", "]"}], ":>", "b"}]}], "}"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"FlattenAllInidces", "=", 
       RowBox[{"Flatten", "[", "allInidces", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tl", "=", 
       RowBox[{"Length", "[", "allInidces", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"idxl", "=", 
       RowBox[{"Length", "[", "FlattenAllInidces", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"IndicesFirst", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"First", "[", "#", "]"}], "&"}], "/@", 
        "FlattenAllInidces"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", "RepeatedIndices", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"ContractIndices", "=", 
       RowBox[{
        RowBox[{"RepeatedIndices", "[", "FlattenAllInidces", "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"FirstTensor", "=", 
       RowBox[{"First", "[", "tList", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"CoordinatesDimension", "[", "FirstTensor", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"DeleteContractIndicesR", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", "->", "Nothing"}], ")"}], "&"}], "/@", 
        "ContractIndices"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"InertIndices", "=", 
       RowBox[{"IndicesFirst", "/.", "DeleteContractIndicesR"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ContractIndicesRange", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#", ",", "1", ",", "d"}], "}"}], "&"}], "/@", 
        "ContractIndices"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"InertIndicesRange", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#", ",", "1", ",", "d"}], "}"}], "&"}], "/@", 
        "InertIndices"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tcList", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"TensorComponents", "[", "#", "]"}], "&"}], "/@", 
        "tList"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mtx", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Times", "@@", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{
                 RowBox[{
                 "tcList", "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"Sequence", "@@", 
                  RowBox[{
                  "allInidcesRemovePosition", "\[LeftDoubleBracket]", "ii", 
                   "\[RightDoubleBracket]"}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"ii", ",", "1", ",", "tl"}], "}"}]}], "]"}]}], ")"}], 
           ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"Sequence", "@@", "ContractIndicesRange"}], "]"}]}], 
          "]"}], ",", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"Sequence", "@@", "InertIndicesRange"}], "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"FirstTensor", "=", 
       RowBox[{"FirstTensor", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"TensorComponents", "\[Rule]", "OldTC_"}], ")"}], 
          "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"TensorComponents", "\[Rule]", "mtx"}], ")"}]}], "}"}]}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"FirstTensor", "=", 
       RowBox[{"TensorName", "[", 
        RowBox[{"FirstTensor", ",", 
         RowBox[{"TensorName", "[", "tList", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"FirstTensor", "=", 
       RowBox[{"Indices", "[", 
        RowBox[{"FirstTensor", ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Indices", "[", "#", "]"}], "&"}], "/@", "tList"}], 
             ")"}], "]"}], "/.", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"#", ":>", 
                RowBox[{"UnderBar", "[", "#", "]"}]}], "&"}], ")"}], "/@", 
             "ContractIndices"}], ")"}]}], ")"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.895553990030738*^9, 3.8955539917922945`*^9}, {
   3.895556090116927*^9, 3.895556090120925*^9}, 3.896614319065859*^9, {
   3.9663946739152193`*^9, 3.966394693405149*^9}, 3.966400294873023*^9, 
   3.966400881155702*^9, {3.966402326010873*^9, 3.966402329097838*^9}, {
   3.96640327608355*^9, 3.966403279265217*^9}, {3.966403536360325*^9, 
   3.966403589979395*^9}, 3.966463024691409*^9, {3.966463726124482*^9, 
   3.9664637312254333`*^9}, {3.966463939384956*^9, 3.9664639408729563`*^9}, 
   3.966464010896834*^9, {3.96646408560426*^9, 3.966464088210396*^9}, {
   3.966464126033536*^9, 3.9664641365312023`*^9}, 3.966464212971368*^9, {
   3.9664643266236343`*^9, 3.9664643367541513`*^9}, {3.9664675290388727`*^9, 
   3.966467531674667*^9}, 3.96719292196305*^9, {3.9671930268457327`*^9, 
   3.967193027915307*^9}, {3.967193263794098*^9, 3.967193267891667*^9}, {
   3.968212599826912*^9, 3.968212712845017*^9}, 3.9688160449968224`*^9, {
   3.9753119034913473`*^9, 
   3.975311981661351*^9}},ExpressionUUID->"5473155c-5646-4432-91da-\
93d131664f44"]
}, Closed]],

Cell[CellGroupData[{

Cell["SwapIndices", "Subsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.533880012946951*^9, 3.5338800148345547`*^9}, {
   3.606329216258676*^9, 3.6063292218312616`*^9}, 3.606497441942197*^9, {
   3.606512368464484*^9, 
   3.606512376678954*^9}},ExpressionUUID->"05e9fa37-f55f-4e3e-90f1-\
83b8b508145e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "SwapIndices", " ", "returns", " ", "tt", " ", "except", " ", "the", " ", 
     "indices", " ", "are", " ", "permuted", " ", "into", " ", "idx"}], ";", 
    " ", 
    RowBox[{
     RowBox[{"i", ".", "e", ".", " ", 
      RowBox[{"Indices", "[", "tt", "]"}]}], " ", "\[Rule]", " ", "idx"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "idx", " ", "does", " ", "not", " ", "include", " ", "the", " ", 
    "UnderBarred", " ", "indices", " ", "in", " ", "tt"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"SwapIndices", "[", 
      RowBox[{"tt_Tensor", ",", "idx_List"}], "]"}], "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sort", "[", 
          RowBox[{"RemoveUnderBarredIndices", "[", 
           RowBox[{"Indices", "[", "tt", "]"}], "]"}], "]"}], "===", 
         RowBox[{"Sort", "[", "idx", "]"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"TestIndices", "[", 
              RowBox[{"#", "/.", 
               RowBox[{
                RowBox[{"UnderBar", "[", "ss_", "]"}], "\[Rule]", "ss"}]}], 
              "]"}], "&"}], "/@", "idx"}], ")"}], "]"}], "===", 
         RowBox[{"{", "True", "}"}]}], ")"}]}], ")"}]}], ":=", 
    RowBox[{"tt", "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"replace", " ", "TensorComponents"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"TensorComponents", "\[Rule]", "ss_"}], ")"}], 
        "\[RuleDelayed]", 
        RowBox[{"(", 
         RowBox[{"TensorComponents", "\[Rule]", 
          RowBox[{"Transpose", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"TensorComponents", "[", "tt", "]"}], ",", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{"(*", " ", 
                 RowBox[{
                 "this", " ", "is", " ", "the", " ", "ordering", " ", "of", 
                  " ", "indices", " ", "we", " ", "want"}], " ", "*)"}], 
                RowBox[{"idx", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"RemoveUnderBarredIndices", "[", 
               RowBox[{"Indices", "[", "tt", "]"}], "]"}]}], "]"}]}], "]"}]}],
          ")"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "replace", " ", "Indices", " ", "but", " ", "remember", " ", "not", 
         " ", "to", " ", "throw", " ", "away", " ", "the", " ", "UnderBarred",
          " ", "Indices"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Indices", "\[Rule]", "ss_"}], ")"}], "\[RuleDelayed]", 
        RowBox[{"(", 
         RowBox[{"Indices", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"ss", "/.", 
            RowBox[{"Thread", "[", 
             RowBox[{"Rule", "[", 
              RowBox[{
               RowBox[{"RemoveUnderBarredIndices", "[", 
                RowBox[{"Indices", "[", "tt", "]"}], "]"}], ",", "idx"}], 
              "]"}], "]"}]}], ")"}]}], ")"}]}]}], "\[IndentingNewLine]", 
      "}"}]}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.6063292322449217`*^9, 
   3.606329256638296*^9}, {3.6064974490496035`*^9, 3.6064974614663134`*^9}, 
   3.606512382622294*^9, {3.60651242556575*^9, 3.6065125215382395`*^9}, {
   3.6065125556711917`*^9, 3.606512600995784*^9}, {3.606512761984992*^9, 
   3.6065128691121197`*^9}, {3.6065129691668425`*^9, 3.606512970031892*^9}, {
   3.6065131686742535`*^9, 3.6065131898644657`*^9}, {3.6065132669168725`*^9, 
   3.606513293923417*^9}, {3.629692178653521*^9, 3.6296921823366594`*^9}, {
   3.6296927745837092`*^9, 3.6296927894092307`*^9}, {3.6296928455681496`*^9, 
   3.629692856442544*^9}, {3.6296929535388727`*^9, 3.6296929933152556`*^9}, {
   3.6296930748191504`*^9, 3.6296930871695933`*^9}, {3.6296932234826612`*^9, 
   3.6296932524307303`*^9}, {3.6296933014895077`*^9, 3.629693381002375*^9}, {
   3.6297662869445314`*^9, 3.629766315970583*^9}, {3.6298439670933137`*^9, 
   3.62984398806225*^9}, {3.6298442399943933`*^9, 3.6298442410395956`*^9}, 
   3.895554774487012*^9},ExpressionUUID->"8843326f-3452-4b7e-9d9f-\
ecdc3baed4a3"]
}, Closed]],

Cell[CellGroupData[{

Cell["MoveIndices", "Subsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.533880012946951*^9, 3.5338800148345547`*^9}, {
   3.606329216258676*^9, 3.6063292218312616`*^9}, 3.606497441942197*^9, {
   3.606512368464484*^9, 3.606512376678954*^9}, {3.630042521633257*^9, 
   3.6300425280604687`*^9}},ExpressionUUID->"62186d2f-6045-4bdd-821b-\
6e563a764add"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"MoveIndices", "[", 
     RowBox[{"tt_Tensor", ",", "idx_List", ",", "m_Tensor"}], "]"}], " ", 
    "returns", " ", "tt", " ", "with", " ", "its", " ", "indices", " ", 
    RowBox[{"moved", "/", "replaced"}], " ", "to", " ", "idx"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "idx", " ", "does", " ", "not", " ", "include", " ", "the", " ", 
    "UnderBarred", " ", "indices", " ", "in", " ", "tt", " ", "but", " ", 
    "has", " ", "to", " ", "contain", " ", "the", " ", "same", " ", "number", 
    " ", "of", " ", "indices"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "idx", " ", "may", " ", "also", " ", "contain", " ", "coordinates"}], 
     ";", " ", 
     RowBox[{"i", ".", "e", "."}]}], ",", " ", 
    RowBox[{
    "MoveIndices", " ", "should", " ", "be", " ", "able", " ", "to", " ", 
     "do", " ", "evaluate", " ", "specific", " ", "components", " ", "of", 
     " ", "the", " ", "tensor"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"new", " ", "code"}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MoveIndices", "[", 
       RowBox[{"tt_Tensor", ",", "idx_List", ",", "m_Tensor"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"(*", " ", 
        RowBox[{
        "check", " ", "that", " ", "there", " ", "are", " ", "same", " ", 
         "number", " ", "of", " ", "indices", " ", "in", " ", "tt", " ", 
         "and", " ", "idx"}], " ", "*)"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"RemoveUnderBarredIndices", "[", 
            RowBox[{"Indices", "[", "tt", "]"}], "]"}], "]"}], "===", 
          RowBox[{"Length", "[", "idx", "]"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{
          "check", " ", "idx", " ", "contain", " ", "proper", " ", 
           "indices"}], " ", "*)"}], 
         RowBox[{"(*", 
          RowBox[{"MoveIndices", " ", "for", " ", "scalar"}], "*)"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Union", "[", 
             RowBox[{"(", 
              RowBox[{"TestIndices", "/@", "idx"}], ")"}], "]"}], "===", 
            RowBox[{"{", "True", "}"}]}], ")"}], "||", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Union", "[", 
             RowBox[{"(", 
              RowBox[{"TestIndices", "/@", "idx"}], ")"}], "]"}], "===", 
            RowBox[{"{", "}"}]}], ")"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"check", " ", "m", " ", "is", " ", "a", " ", "Metric"}], 
           ";", " ", 
           RowBox[{
           "we", " ", "are", " ", "going", " ", "use", " ", "it", " ", "to", 
            " ", "move", " ", "the", " ", "indices", " ", "with"}]}], " ", 
          "*)"}], 
         RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}], 
        RowBox[{"(*", "OrthonormalFrameField", "*)"}], "&&", 
        RowBox[{"(*", 
         RowBox[{"check", " ", "if", " ", "the", " ", 
          StyleBox["type",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["of",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["indices",
           FontColor->RGBColor[1, 0, 1]], " ", "are", " ", "all", " ", 
          StyleBox["preserved",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"Thread", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"OverHatSgn", "[", "#", "]"}], "&"}], "/@", 
                  "idx"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"OverHatSgn", "[", "#", "]"}], "&"}], "/@", 
                  RowBox[{"RemoveUnderBarredIndices", "[", 
                   RowBox[{"Indices", "[", "tt", "]"}], "]"}]}], ")"}]}], 
               "]"}], "]"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", "}"}], "|", 
               RowBox[{"{", "1", "}"}]}], ")"}]}], "]"}], ")"}], "&&", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "We", " ", "can", " ", "only", " ", "move", " ", "on", " ", 
             "type", " ", "of", " ", "index"}], ",", " ", 
            RowBox[{"in", " ", 
             StyleBox["coordinate",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox["basis",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox["or",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox["orthonormal",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox["basis",
              FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], 
          RowBox[{"TestMoveOnlyOneType", "[", 
           RowBox[{"tt", ",", "idx"}], "]"}]}], ")"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "outputindices", ",", "ttix", ",", "outputtensor", ",", "s", ",", "g",
          ",", "Invg", ",", "xxx123", ",", "i123", ",", "\[Mu]", ",", 
         "\[Nu]"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "extract", " ", "relevant", " ", "indices", " ", "of", " ", "tt"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ttix", "=", 
         RowBox[{"RemoveUnderBarredIndices", "[", 
          RowBox[{"Indices", "[", "tt", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "we", " ", "will", " ", "replace", " ", "the", " ", "indices", " ", 
          "of", " ", "tt", " ", "with", " ", "idx"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"outputindices", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"Rule", "[", 
           RowBox[{"ttix", ",", "idx"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"start", " ", "with"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"outputtensor", "=", 
         RowBox[{"Normal", "[", 
          RowBox[{"TensorComponents", "[", "tt", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "first", " ", "compute", " ", "metric", " ", "and", " ", "inverse", 
          " ", "and", " ", "extract", " ", "TensorComponents", " ", "of", " ",
           "tt"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"g", "=", 
         RowBox[{"TensorComponents", "[", 
          RowBox[{"Metric", "[", 
           RowBox[{
            SubscriptBox["\[Mu]", "-"], ",", 
            SubscriptBox["\[Nu]", "-"], ",", "m"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Invg", "=", 
         RowBox[{"TensorComponents", "[", 
          RowBox[{"Metric", "[", 
           RowBox[{
            SuperscriptBox["\[Mu]", "-"], ",", 
            SuperscriptBox["\[Nu]", "-"], ",", "m"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "we", " ", "will", " ", "run", " ", "through", " ", "all", " ", 
          "relevant", " ", "indices", " ", "of", " ", "tt"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "compare", " ", "each", " ", "slot", " ", "with", " ", "the", " ", 
          "corresponding", " ", "one", " ", "in", " ", "idx"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"different", " ", "sgn"}], ";", " ", 
             RowBox[{
             "append", " ", "appropriate", " ", "g", " ", "or", " ", 
              "Inv"}]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"raise", " ", "index"}], ";", " ", 
             RowBox[{"contract", " ", 
              SubscriptBox["T", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"i1", " ", "i2"}], " ", "..."}], " ", "j"}], " ", 
                 "..."}], " ", "iD"}]], " ", 
              SuperscriptBox["g", 
               RowBox[{"j", " ", "is"}]]}], ";", " ", 
             RowBox[{
             "then", " ", "transpose", " ", "to", " ", "get", " ", "the", " ",
               "right", " ", "ordering", " ", "of", " ", "indices"}]}], " ", 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "last", " ", "index", " ", "does", " ", "not", " ", "need", " ", 
             "to", " ", "be", " ", "further", " ", 
             RowBox[{"transposed", "!"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Sgn", "[", 
                RowBox[{
                "ttix", "\[LeftDoubleBracket]", "s", 
                 "\[RightDoubleBracket]"}], "]"}], "===", 
               RowBox[{"-", "1"}]}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Sgn", "[", 
                RowBox[{
                "idx", "\[LeftDoubleBracket]", "s", "\[RightDoubleBracket]"}],
                 "]"}], "===", "1"}], ")"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"outputtensor", "=", 
             RowBox[{"Which", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"s", "<", 
                RowBox[{"Length", "[", "idx", "]"}]}], ",", 
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"TensorContract", "[", 
                  RowBox[{
                   RowBox[{"TensorProduct", "[", 
                    RowBox[{"outputtensor", ",", "Invg"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "idx", "]"}], "+", "1"}]}], "}"}], 
                    "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"s", "-", "1"}]}], "]"}]}], ",", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"s", "+", "1"}], ",", 
                    RowBox[{"Length", "[", "idx", "]"}]}], "]"}]}], ",", 
                   "s"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"s", "===", 
                RowBox[{"Length", "[", "idx", "]"}]}], ",", 
               RowBox[{"TensorContract", "[", 
                RowBox[{
                 RowBox[{"TensorProduct", "[", 
                  RowBox[{"outputtensor", ",", "Invg"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"s", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "idx", "]"}], "+", "1"}]}], "}"}], 
                  "}"}]}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"lower", " ", "index"}], ";", " ", 
              RowBox[{"contract", " ", 
               SuperscriptBox["T", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"i1", " ", "i2"}], " ", "..."}], " ", "j"}], " ", 
                  "..."}], " ", "iD"}]], " ", 
               SubscriptBox["g", 
                RowBox[{"j", " ", "is"}]]}], ";", " ", 
              RowBox[{
              "then", " ", "transpose", " ", "to", " ", "get", " ", "the", 
               " ", "right", " ", "ordering", " ", "of", " ", "indices"}]}], 
             " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "last", " ", "index", " ", "does", " ", "not", " ", "need", " ", 
              "to", " ", "be", " ", "further", " ", 
              RowBox[{"transposed", "!"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Sgn", "[", 
                RowBox[{
                "ttix", "\[LeftDoubleBracket]", "s", 
                 "\[RightDoubleBracket]"}], "]"}], "===", "1"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Sgn", "[", 
                RowBox[{
                "idx", "\[LeftDoubleBracket]", "s", "\[RightDoubleBracket]"}],
                 "]"}], "===", 
               RowBox[{"-", "1"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"outputtensor", "=", 
             RowBox[{"Which", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"s", "<", 
                RowBox[{"Length", "[", "idx", "]"}]}], ",", 
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"TensorContract", "[", 
                  RowBox[{
                   RowBox[{"TensorProduct", "[", 
                    RowBox[{"outputtensor", ",", "g"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "idx", "]"}], "+", "1"}]}], "}"}], 
                    "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"s", "-", "1"}]}], "]"}]}], ",", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"s", "+", "1"}], ",", 
                    RowBox[{"Length", "[", "idx", "]"}]}], "]"}]}], ",", 
                   "s"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"s", "===", 
                RowBox[{"Length", "[", "idx", "]"}]}], ",", 
               RowBox[{"TensorContract", "[", 
                RowBox[{
                 RowBox[{"TensorProduct", "[", 
                  RowBox[{"outputtensor", ",", "g"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"s", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "idx", "]"}], "+", "1"}]}], "}"}], 
                  "}"}]}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", "1", ",", 
            RowBox[{"Length", "[", "idx", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "output", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"tt", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "xxx123_"}], ")"}], 
            "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "outputtensor"}], ")"}]}],
            ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "i123_"}], ")"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"i123", "/.", "outputindices"}], ")"}]}], ")"}]}]}], 
          "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "OrthonormalFrameField", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MoveIndices", "[", 
       RowBox[{"tt_Tensor", ",", "idx_List", ",", "m_Tensor"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"(*", " ", 
        RowBox[{
        "check", " ", "that", " ", "there", " ", "are", " ", "same", " ", 
         "number", " ", "of", " ", "indices", " ", "in", " ", "tt", " ", 
         "and", " ", "idx"}], " ", "*)"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"RemoveUnderBarredIndices", "[", 
            RowBox[{"Indices", "[", "tt", "]"}], "]"}], "]"}], "===", 
          RowBox[{"Length", "[", "idx", "]"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{
          "check", " ", "idx", " ", "contain", " ", "proper", " ", 
           "indices"}], " ", "*)"}], 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"(", 
            RowBox[{"TestIndices", "/@", "idx"}], ")"}], "]"}], "===", 
          RowBox[{"{", "True", "}"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"check", " ", "m", " ", "is", " ", "a", " ", "Metric"}], 
           ";", " ", 
           RowBox[{
           "we", " ", "are", " ", "going", " ", "use", " ", "it", " ", "to", 
            " ", "move", " ", "the", " ", "indices", " ", "with"}]}], " ", 
          "*)"}], 
         RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"{", "m", "}"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"OrthonormalFrameField", "\[Rule]", "onff_"}], ")"}], 
             "\[Rule]", "onff"}], ",", "1"}], "]"}], "=!=", 
          RowBox[{"{", "Null", "}"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"{", "m", "}"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "invonff_"}],
               ")"}], "\[Rule]", "invonff"}], ",", "1"}], "]"}], "=!=", 
          RowBox[{"{", "Null", "}"}]}], ")"}], "&&", 
        RowBox[{"!", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"Thread", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"OverHatSgn", "[", "#", "]"}], "&"}], "/@", 
                  "idx"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"OverHatSgn", "[", "#", "]"}], "&"}], "/@", 
                  RowBox[{"RemoveUnderBarredIndices", "[", 
                   RowBox[{"Indices", "[", "tt", "]"}], "]"}]}], ")"}]}], 
               "]"}], "]"}], "===", 
             RowBox[{"{", "1", "}"}]}], ")"}], "&&", 
           RowBox[{"TestMoveOnlyOneType", "[", 
            RowBox[{"tt", ",", "idx"}], "]"}]}], ")"}]}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "outputindices", ",", "ttix", ",", "outputtensor", ",", "i123", ",", 
         "rank", ",", "idxlist", ",", "tttemp", ",", "idxlist2", ",", "fm", 
         ",", "onff", ",", "invonff", ",", "fmT", ",", "\[Mu]", ",", "\[Nu]", 
         ",", "cc", ",", "s", ",", "ii"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"basic", " ", "arguments"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rank", "=", 
         RowBox[{"RankNumber", "[", "idx", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ttix", "=", 
         RowBox[{"RemoveUnderBarredIndices", "[", 
          RowBox[{"Indices", "[", "tt", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Obtain", " ", 
          StyleBox["indices",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["list",
           FontColor->RGBColor[1, 0, 1]], " ", "with", " ", "indices", " ", 
          "only", " ", "be", " ", 
          StyleBox["moved",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["by",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          RowBox[{
           StyleBox["metric",
            FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"idxlist", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Sgn", "[", 
                 RowBox[{
                 "ttix", "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}], "]"}], " ", 
                RowBox[{"Sgn", "[", 
                 RowBox[{
                 "idx", "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}], "]"}]}], "===", 
               RowBox[{"-", "1"}]}], ")"}], "&&", 
             RowBox[{
              RowBox[{"OverHatSgn", "[", 
               RowBox[{
               "ttix", "\[LeftDoubleBracket]", "ii", 
                "\[RightDoubleBracket]"}], "]"}], "===", 
              RowBox[{"-", "1"}]}]}], ",", 
            RowBox[{"idxlist", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"idxlist", ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"ttix", "\[LeftDoubleBracket]", 
                  RowBox[{"ii", ",", "1"}], "\[RightDoubleBracket]"}], "//", 
                 RowBox[{"idx", "\[LeftDoubleBracket]", 
                  RowBox[{"ii", ",", "0"}], "\[RightDoubleBracket]"}]}], 
                ")"}]}], "]"}]}], ",", "True", ",", 
            RowBox[{"idxlist", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"idxlist", ",", 
               RowBox[{
               "ttix", "\[LeftDoubleBracket]", "ii", 
                "\[RightDoubleBracket]"}]}], "]"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", "rank"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"First", " ", 
          StyleBox["MoveIndices",
           FontColor->RGBColor[1, 0, 1]], " ", "with", " ", 
          StyleBox["metric",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"tttemp", "=", 
         RowBox[{"MoveIndices", "[", 
          RowBox[{"tt", ",", "idxlist", ",", "m"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Obtain", " ", 
          StyleBox["indices",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["list",
           FontColor->RGBColor[1, 0, 1]], " ", "with", " ", "indices", " ", 
          "only", " ", "be", " ", 
          StyleBox["moved",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["by",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          RowBox[{
           StyleBox["FlatMetric",
            FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"idxlist2", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"idxlist2", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"idxlist2", ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"idxlist", "\[LeftDoubleBracket]", 
                RowBox[{"ii", ",", "1"}], "\[RightDoubleBracket]"}], "//", 
               RowBox[{"idx", "\[LeftDoubleBracket]", 
                RowBox[{"ii", ",", "0"}], "\[RightDoubleBracket]"}]}], 
              ")"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", "rank"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Extract", " ", 
          StyleBox["FlatMetric",
           FontColor->RGBColor[1, 0, 1]], " ", "and", " ", 
          StyleBox["orthonormal",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["frame",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["field",
           FontColor->RGBColor[1, 0, 1]], " ", 
          RowBox[{"stuff", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"fm", "=", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"m", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"FlatMetric", "\[Rule]", "cc_"}], ")"}], "\[Rule]", 
             "cc"}], ",", "1"}], "]"}], "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"onff", "=", 
         RowBox[{"TensorComponents", "[", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"m", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"OrthonormalFrameField", "\[Rule]", "cc_"}], ")"}], 
              "\[Rule]", "cc"}], ",", "1"}], "]"}], "\[LeftDoubleBracket]", 
           "1", "\[RightDoubleBracket]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"invonff", "=", 
         RowBox[{"TensorComponents", "[", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"m", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "cc_"}], 
               ")"}], "\[Rule]", "cc"}], ",", "1"}], "]"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Declare", " ", "FlatMetric", " ", "as", " ", "a", " ", 
          StyleBox["Tensor",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"fmT", "=", 
         RowBox[{"Metric", "[", 
          RowBox[{
           SubscriptBox["\[Mu]", "-"], ",", 
           SubscriptBox["\[Nu]", "-"], ",", "fm", ",", 
           RowBox[{"TensorName", "\[Rule]", "\"\<g\>\""}], ",", 
           RowBox[{"Coordinates", "\[Rule]", 
            RowBox[{"Coordinates", "[", "m", "]"}]}], ",", 
           RowBox[{"StartIndex", "\[Rule]", 
            RowBox[{"StartIndex", "[", "m", "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Second", " ", "MoveIndices", " ", "with", " ", 
          RowBox[{
           StyleBox["FlatMetric",
            FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"tttemp", "=", 
         RowBox[{"MoveIndices", "[", 
          RowBox[{"tttemp", ",", "idxlist2", ",", "fmT"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "we", " ", "will", " ", "replace", " ", "the", " ", "indices", " ", 
          "of", " ", "tt", " ", "with", " ", "idx"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"outputindices", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"Rule", "[", 
           RowBox[{"ttix", ",", "idx"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"start", " ", "with"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"outputtensor", "=", 
         RowBox[{"TensorComponents", "[", "tttemp", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "we", " ", "will", " ", "run", " ", "through", " ", "all", " ", 
          "relevant", " ", "indices", " ", "of", " ", "tt"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "compare", " ", "each", " ", "slot", " ", "with", " ", "the", " ", 
          "corresponding", " ", "one", " ", "in", " ", "idx"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Transform", " ", "between", " ", 
          StyleBox["orthonormal",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["coordinate",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["and",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["basis",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          RowBox[{
           StyleBox["coordinate",
            FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            StyleBox[
             RowBox[{
              SubscriptBox[
               OverscriptBox["\[Alpha]", "^"], "-"], "\[Rule]", 
              SubscriptBox["\[Mu]", "-"]}],
             FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Sgn", "[", 
                RowBox[{
                "idxlist2", "\[LeftDoubleBracket]", "s", 
                 "\[RightDoubleBracket]"}], "]"}], "===", 
               RowBox[{"-", "1"}]}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"OverHatSgn", "[", 
                RowBox[{
                "idxlist2", "\[LeftDoubleBracket]", "s", 
                 "\[RightDoubleBracket]"}], "]"}], "===", "1"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Sgn", "[", 
                RowBox[{
                "idx", "\[LeftDoubleBracket]", "s", "\[RightDoubleBracket]"}],
                 "]"}], "===", 
               RowBox[{"-", "1"}]}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"OverHatSgn", "[", 
                RowBox[{
                "idx", "\[LeftDoubleBracket]", "s", "\[RightDoubleBracket]"}],
                 "]"}], "===", 
               RowBox[{"-", "1"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"outputtensor", "=", 
             RowBox[{"Which", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"s", "<", "rank"}], ",", 
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"TensorContract", "[", 
                  RowBox[{
                   RowBox[{"TensorProduct", "[", 
                    RowBox[{"outputtensor", ",", 
                    RowBox[{"(*", 
                    RowBox[{"Contract", " ", 
                    RowBox[{"w", "/", " ", 
                    StyleBox[
                    SubscriptBox[
                    SuperscriptBox["\[Epsilon]", 
                    OverscriptBox["\[Alpha]", "^"]], "\[Mu]"],
                    FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], "onff"}], 
                    "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{"rank", "+", "1"}]}], "}"}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"s", "-", "1"}]}], "]"}]}], ",", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"s", "+", "1"}], ",", "rank"}], "]"}]}], ",", 
                   "s"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{"Least", " ", "index", " ", 
                 RowBox[{"doesn", "'"}], "t", " ", "need", " ", "a", " ", 
                 RowBox[{"Transpose", "."}]}], "*)"}], 
               RowBox[{"s", "===", "rank"}], ",", 
               RowBox[{"TensorContract", "[", 
                RowBox[{
                 RowBox[{"TensorProduct", "[", 
                  RowBox[{"outputtensor", ",", 
                   RowBox[{"(*", 
                    RowBox[{"Contract", " ", 
                    RowBox[{"w", "/", " ", 
                    StyleBox[
                    SubscriptBox[
                    SuperscriptBox["\[Epsilon]", 
                    OverscriptBox["\[Alpha]", "^"]], "\[Mu]"],
                    FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], "onff"}], 
                  "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"s", ",", 
                    RowBox[{"rank", "+", "1"}]}], "}"}], "}"}]}], "]"}]}], 
              "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             StyleBox[
              RowBox[{
               SubscriptBox["\[Mu]", "-"], "\[Rule]", 
               SubscriptBox[
                OverscriptBox["\[Alpha]", "^"], "-"]}],
              FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Sgn", "[", 
                RowBox[{
                "idxlist2", "\[LeftDoubleBracket]", "s", 
                 "\[RightDoubleBracket]"}], "]"}], "===", 
               RowBox[{"-", "1"}]}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"OverHatSgn", "[", 
                RowBox[{
                "idxlist2", "\[LeftDoubleBracket]", "s", 
                 "\[RightDoubleBracket]"}], "]"}], "===", 
               RowBox[{"-", "1"}]}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Sgn", "[", 
                RowBox[{
                "idx", "\[LeftDoubleBracket]", "s", "\[RightDoubleBracket]"}],
                 "]"}], "===", 
               RowBox[{"-", "1"}]}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"OverHatSgn", "[", 
                RowBox[{
                "idx", "\[LeftDoubleBracket]", "s", "\[RightDoubleBracket]"}],
                 "]"}], "===", "1"}], ")"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"outputtensor", "=", 
             RowBox[{"Which", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"s", "<", 
                RowBox[{"Length", "[", "idx", "]"}]}], ",", 
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"TensorContract", "[", 
                  RowBox[{
                   RowBox[{"TensorProduct", "[", 
                    RowBox[{"outputtensor", ",", 
                    RowBox[{"(*", 
                    RowBox[{"Contract", " ", 
                    RowBox[{"w", "/", " ", 
                    StyleBox[
                    SuperscriptBox[
                    SubscriptBox["\[Epsilon]", 
                    OverscriptBox["\[Alpha]", "^"]], "\[Mu]"],
                    FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], "invonff"}], 
                    "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "idx", "]"}], "+", "1"}]}], "}"}], 
                    "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"s", "-", "1"}]}], "]"}]}], ",", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"s", "+", "1"}], ",", 
                    RowBox[{"Length", "[", "idx", "]"}]}], "]"}]}], ",", 
                   "s"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"s", "===", 
                RowBox[{"Length", "[", "idx", "]"}]}], ",", 
               RowBox[{"TensorContract", "[", 
                RowBox[{
                 RowBox[{"TensorProduct", "[", 
                  RowBox[{"outputtensor", ",", "invonff"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"s", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "idx", "]"}], "+", "1"}]}], "}"}], 
                  "}"}]}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             StyleBox[
              RowBox[{
               SuperscriptBox[
                StyleBox["\[Mu]",
                 FontColor->RGBColor[1, 0, 1]], "-"], "\[Rule]", 
               SuperscriptBox[
                StyleBox[
                 OverscriptBox["\[Alpha]", "^"],
                 FontColor->RGBColor[1, 0, 1]], "-"]}],
              FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Sgn", "[", 
                RowBox[{
                "idxlist2", "\[LeftDoubleBracket]", "s", 
                 "\[RightDoubleBracket]"}], "]"}], "===", "1"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"OverHatSgn", "[", 
                RowBox[{
                "idxlist2", "\[LeftDoubleBracket]", "s", 
                 "\[RightDoubleBracket]"}], "]"}], "===", 
               RowBox[{"-", "1"}]}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Sgn", "[", 
                RowBox[{
                "idx", "\[LeftDoubleBracket]", "s", "\[RightDoubleBracket]"}],
                 "]"}], "===", "1"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"OverHatSgn", "[", 
                RowBox[{
                "idx", "\[LeftDoubleBracket]", "s", "\[RightDoubleBracket]"}],
                 "]"}], "===", "1"}], ")"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"outputtensor", "=", 
             RowBox[{"Which", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"s", "<", 
                RowBox[{"Length", "[", "idx", "]"}]}], ",", 
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"TensorContract", "[", 
                  RowBox[{
                   RowBox[{"TensorProduct", "[", 
                    RowBox[{"outputtensor", ",", 
                    RowBox[{"(*", 
                    RowBox[{"Contract", " ", 
                    RowBox[{"w", "/", " ", 
                    StyleBox[
                    SubscriptBox[
                    SuperscriptBox["\[Epsilon]", 
                    OverscriptBox["\[Alpha]", "^"]], "\[Mu]"],
                    FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], "onff"}], 
                    "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "idx", "]"}], "+", "1"}]}], "}"}], 
                    "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"s", "-", "1"}]}], "]"}]}], ",", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"s", "+", "1"}], ",", 
                    RowBox[{"Length", "[", "idx", "]"}]}], "]"}]}], ",", 
                   "s"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"s", "===", 
                RowBox[{"Length", "[", "idx", "]"}]}], ",", 
               RowBox[{"TensorContract", "[", 
                RowBox[{
                 RowBox[{"TensorProduct", "[", 
                  RowBox[{"outputtensor", ",", "onff"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"s", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "idx", "]"}], "+", "1"}]}], "}"}], 
                  "}"}]}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             StyleBox[
              RowBox[{
               SuperscriptBox[
                StyleBox[
                 OverscriptBox["\[Alpha]", "^"],
                 FontColor->RGBColor[1, 0, 1]], "-"], "\[Rule]", 
               SuperscriptBox[
                StyleBox["\[Mu]",
                 FontColor->RGBColor[1, 0, 1]], "-"]}],
              FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Sgn", "[", 
                RowBox[{
                "idxlist2", "\[LeftDoubleBracket]", "s", 
                 "\[RightDoubleBracket]"}], "]"}], "===", "1"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"OverHatSgn", "[", 
                RowBox[{
                "idxlist2", "\[LeftDoubleBracket]", "s", 
                 "\[RightDoubleBracket]"}], "]"}], "===", "1"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Sgn", "[", 
                RowBox[{
                "idx", "\[LeftDoubleBracket]", "s", "\[RightDoubleBracket]"}],
                 "]"}], "===", "1"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"OverHatSgn", "[", 
                RowBox[{
                "idx", "\[LeftDoubleBracket]", "s", "\[RightDoubleBracket]"}],
                 "]"}], "===", 
               RowBox[{"-", "1"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"outputtensor", "=", 
             RowBox[{"Which", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"s", "<", 
                RowBox[{"Length", "[", "idx", "]"}]}], ",", 
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"TensorContract", "[", 
                  RowBox[{
                   RowBox[{"TensorProduct", "[", 
                    RowBox[{"outputtensor", ",", 
                    RowBox[{"(*", 
                    RowBox[{"Contract", " ", 
                    RowBox[{"w", "/", " ", 
                    StyleBox[
                    SuperscriptBox[
                    SubscriptBox["\[Epsilon]", 
                    OverscriptBox["\[Alpha]", "^"]], "\[Mu]"],
                    FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], "invonff"}], 
                    "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "idx", "]"}], "+", "1"}]}], "}"}], 
                    "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"s", "-", "1"}]}], "]"}]}], ",", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"s", "+", "1"}], ",", 
                    RowBox[{"Length", "[", "idx", "]"}]}], "]"}]}], ",", 
                   "s"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"s", "===", 
                RowBox[{"Length", "[", "idx", "]"}]}], ",", 
               RowBox[{"TensorContract", "[", 
                RowBox[{
                 RowBox[{"TensorProduct", "[", 
                  RowBox[{"outputtensor", ",", "invonff"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"s", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "idx", "]"}], "+", "1"}]}], "}"}], 
                  "}"}]}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", "1", ",", 
            RowBox[{"Length", "[", "idx", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         StyleBox["output",
          FontColor->RGBColor[1, 0, 1]], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"tttemp", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "xxx123_"}], ")"}], 
            "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "outputtensor"}], ")"}]}],
            ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "i123_"}], ")"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Indices", "[", "tt", "]"}], "/.", "outputindices"}], 
               ")"}]}], ")"}]}]}], "}"}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MoveIndices", "[", 
      RowBox[{"tt_Tensor", ",", "OrthonormalBasis", ",", "m_Tensor"}], "]"}], 
     "/;", 
     RowBox[{"(", 
      RowBox[{"(*", " ", 
       RowBox[{
       "check", " ", "that", " ", "there", " ", "are", " ", "same", " ", 
        "number", " ", "of", " ", "indices", " ", "in", " ", "tt", " ", "and",
         " ", "idx"}], " ", "*)"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"check", " ", "m", " ", "is", " ", "a", " ", "Metric"}], 
          ";", " ", 
          RowBox[{
          "we", " ", "are", " ", "going", " ", "use", " ", "it", " ", "to", 
           " ", "move", " ", "the", " ", "indices", " ", "with"}]}], " ", 
         "*)"}], 
        RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"{", "m", "}"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"OrthonormalFrameField", "\[Rule]", "onff_"}], ")"}], 
            "\[Rule]", "onff"}], ",", "1"}], "]"}], "=!=", 
         RowBox[{"{", "Null", "}"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"{", "m", "}"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "invonff_"}], 
             ")"}], "\[Rule]", "invonff"}], ",", "1"}], "]"}], "=!=", 
         RowBox[{"{", "Null", "}"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"Quiet", "[", 
          RowBox[{"TestMetricTensor", "[", "tt", "]"}], "]"}]}], ")"}]}], 
      ")"}]}], ":=", 
    RowBox[{"MoveIndices", "[", 
     RowBox[{"tt", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OverHatSgn", "[", "#", "]"}], "===", "1"}], ",", "#", ",", 
          RowBox[{
           RowBox[{"OverHatSgn", "[", "#", "]"}], "===", 
           RowBox[{"-", "1"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"OverHat", "[", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "]"}], ")"}], "//", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "0", "\[RightDoubleBracket]"}]}]}], 
         "]"}], "&"}], "/@", 
       RowBox[{"RemoveUnderBarredIndices", "[", 
        RowBox[{"Indices", "[", "tt", "]"}], "]"}]}], ",", "m"}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MoveIndices", "[", 
      RowBox[{"tt_Tensor", ",", "CoordinateBasis", ",", "m_Tensor"}], "]"}], "/;", 
     RowBox[{"(", 
      RowBox[{"(*", " ", 
       RowBox[{
       "check", " ", "that", " ", "there", " ", "are", " ", "same", " ", 
        "number", " ", "of", " ", "indices", " ", "in", " ", "tt", " ", "and",
         " ", "idx"}], " ", "*)"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"check", " ", "m", " ", "is", " ", "a", " ", "Metric"}], 
          ";", " ", 
          RowBox[{
          "we", " ", "are", " ", "going", " ", "use", " ", "it", " ", "to", 
           " ", "move", " ", "the", " ", "indices", " ", "with"}]}], " ", 
         "*)"}], 
        RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"{", "m", "}"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"OrthonormalFrameField", "\[Rule]", "onff_"}], ")"}], 
            "\[Rule]", "onff"}], ",", "1"}], "]"}], "=!=", 
         RowBox[{"{", "Null", "}"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"{", "m", "}"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "invonff_"}], 
             ")"}], "\[Rule]", "invonff"}], ",", "1"}], "]"}], "=!=", 
         RowBox[{"{", "Null", "}"}]}], ")"}], "&&", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"Quiet", "[", 
          RowBox[{"TestMetricTensor", "[", "tt", "]"}], "]"}]}], ")"}]}], 
      ")"}]}], ":=", 
    RowBox[{"MoveIndices", "[", 
     RowBox[{"tt", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OverHatSgn", "[", "#", "]"}], "===", "1"}], ",", 
          RowBox[{
           RowBox[{"#", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "//", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "0", "\[RightDoubleBracket]"}]}], ",", 
          RowBox[{
           RowBox[{"OverHatSgn", "[", "#", "]"}], "===", 
           RowBox[{"-", "1"}]}], ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"RemoveUnderBarredIndices", "[", 
        RowBox[{"Indices", "[", "tt", "]"}], "]"}]}], ",", "m"}], 
     "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.6063292322449217`*^9, 
   3.606329256638296*^9}, {3.6064974490496035`*^9, 3.6064974614663134`*^9}, 
   3.606512382622294*^9, {3.60651242556575*^9, 3.6065125215382395`*^9}, {
   3.6065125556711917`*^9, 3.606512600995784*^9}, {3.606512761984992*^9, 
   3.6065128691121197`*^9}, {3.6065129691668425`*^9, 3.606512970031892*^9}, {
   3.6065131686742535`*^9, 3.6065131898644657`*^9}, {3.6065132669168725`*^9, 
   3.606513293923417*^9}, {3.629692178653521*^9, 3.6296921823366594`*^9}, {
   3.6296927745837092`*^9, 3.6296927894092307`*^9}, {3.6296928455681496`*^9, 
   3.629692856442544*^9}, {3.6296929535388727`*^9, 3.6296929933152556`*^9}, {
   3.6296930748191504`*^9, 3.6296930871695933`*^9}, {3.6296932234826612`*^9, 
   3.6296932524307303`*^9}, {3.6296933014895077`*^9, 3.629693381002375*^9}, {
   3.6297662869445314`*^9, 3.629766315970583*^9}, {3.6298439670933137`*^9, 
   3.62984398806225*^9}, {3.6298442399943933`*^9, 3.6298442410395956`*^9}, {
   3.630042532709276*^9, 3.6300426463617764`*^9}, {3.630042703883478*^9, 
   3.6300427521936626`*^9}, {3.630042825447692*^9, 3.6300428286456976`*^9}, {
   3.630042980332965*^9, 3.6300430264254456`*^9}, {3.630043060105305*^9, 
   3.630043072949128*^9}, {3.6300941467346215`*^9, 3.6300941501305285`*^9}, {
   3.630094422824464*^9, 3.6300944485833097`*^9}, {3.6300945129192295`*^9, 
   3.6300945130596294`*^9}, {3.63009456993493*^9, 3.630094604724292*^9}, {
   3.630094645506065*^9, 3.630094671206911*^9}, {3.6300950713827314`*^9, 
   3.6300950923929887`*^9}, {3.630095126572833*^9, 3.630095148924312*^9}, {
   3.6300952987629194`*^9, 3.630095317689753*^9}, {3.630095631618222*^9, 
   3.6300957899633107`*^9}, {3.6300960708098197`*^9, 
   3.6300960867862473`*^9}, {3.6300962273194976`*^9, 3.63009628683821*^9}, {
   3.630096394701002*^9, 3.630096400755813*^9}, {3.6300966069840384`*^9, 
   3.6300966275030746`*^9}, {3.630096752960698*^9, 3.6300968779735284`*^9}, {
   3.630096912059989*^9, 3.6300969145091934`*^9}, {3.63012458548705*^9, 
   3.6301245859862514`*^9}, {3.630171696268879*^9, 3.630171697187932*^9}, {
   3.6301721267055283`*^9, 3.630172187186988*^9}, {3.6301725465885444`*^9, 
   3.6301725574831676`*^9}, 3.6301726028587627`*^9, {3.630172639309848*^9, 
   3.630172639791875*^9}, {3.6301726869325714`*^9, 3.6301727745875854`*^9}, {
   3.630173004281803*^9, 3.6301730118478165`*^9}, 3.630173624767943*^9, {
   3.630174010129105*^9, 3.630174033250958*^9}, {3.630174068378629*^9, 
   3.6301740923886747`*^9}, {3.6301741428191967`*^9, 
   3.6301742377847843`*^9}, {3.6301743004723024`*^9, 
   3.6301743866434655`*^9}, {3.630174545460163*^9, 3.63017462231811*^9}, {
   3.6301746580413885`*^9, 3.6301748707160015`*^9}, {3.630184130800047*^9, 
   3.630184229457509*^9}, {3.6301850052789664`*^9, 3.6301850107509813`*^9}, {
   3.630201973676296*^9, 3.6302019811364107`*^9}, {3.6302020119268837`*^9, 
   3.6302020259195986`*^9}, {3.6302020865180297`*^9, 3.630202099130723*^9}, {
   3.6302062623687735`*^9, 3.630206262774374*^9}, {3.630206526945647*^9, 
   3.63020653465456*^9}, {3.630206589878859*^9, 3.630206598284174*^9}, {
   3.6302069385396786`*^9, 3.6302069408977823`*^9}, {3.6302077285487456`*^9, 
   3.630207751509098*^9}, {3.630207950034648*^9, 3.6302079508521605`*^9}, {
   3.6302528520300617`*^9, 3.630252907757249*^9}, {3.630253300900735*^9, 
   3.6302533587870464`*^9}, {3.6302533928009915`*^9, 3.630253437125527*^9}, {
   3.630253539353374*^9, 3.630253546644791*^9}, {3.6302538002332954`*^9, 
   3.63025391675496*^9}, 3.6302539719411163`*^9, {3.6302548553419456`*^9, 
   3.630254856263347*^9}, {3.63025524972278*^9, 3.6302553181907015`*^9}, {
   3.6302553846950192`*^9, 3.630255482220399*^9}, {3.630255622908106*^9, 
   3.630255771687378*^9}, 3.630255920597887*^9, {3.6302561838895245`*^9, 
   3.6302562374302197`*^9}, {3.63025627707789*^9, 3.6302562862079067`*^9}, {
   3.63027400911228*^9, 3.6302740095322804`*^9}, {3.6302760017164326`*^9, 
   3.6302760021532335`*^9}, {3.6302760803358254`*^9, 3.630276097643756*^9}, {
   3.6302779572998476`*^9, 3.630278019811158*^9}, {3.6302782118409033`*^9, 
   3.630278248205868*^9}, {3.6302789403728676`*^9, 3.630278952415489*^9}, 
   3.6302789849690466`*^9, {3.630279062704089*^9, 3.6302790721053057`*^9}, {
   3.630293787958753*^9, 3.6302938141230297`*^9}, {3.630295113013002*^9, 
   3.6302951563480787`*^9}, {3.6302953058709517`*^9, 
   3.6302953084134912`*^9}, {3.630295437321472*^9, 3.6302954415365367`*^9}, {
   3.6302955365114965`*^9, 3.630295543759108*^9}, 3.630295625172858*^9, {
   3.630295725821904*^9, 3.6302957316869946`*^9}, {3.6302958003830495`*^9, 
   3.630295817580814*^9}, 3.6302959076796975`*^9, {3.6302959991886034`*^9, 
   3.6302960013736367`*^9}, {3.630296040071731*^9, 3.6302960829273896`*^9}, {
   3.6302963683317733`*^9, 3.6302965572696753`*^9}, {3.6302967437550397`*^9, 
   3.630296785528181*^9}, {3.630297190921908*^9, 3.630297194781967*^9}, {
   3.6302973560094433`*^9, 3.630297421670452*^9}, {3.6302974957740903`*^9, 
   3.630297504921731*^9}, {3.6302975815729084`*^9, 3.630297588438014*^9}, {
   3.630297648163931*^9, 3.63029765981911*^9}, {3.6302977345252576`*^9, 
   3.63029775553808*^9}, {3.6302978060738564`*^9, 3.630297856057124*^9}, {
   3.6302979279460716`*^9, 3.6302979381762085`*^9}, {3.6302980130646505`*^9, 
   3.630298014179663*^9}, {3.630298187432942*^9, 3.630298246224647*^9}, {
   3.630298410811104*^9, 3.630298411016404*^9}, {3.630299459602931*^9, 
   3.630299468104946*^9}, {3.6302996293748393`*^9, 3.6302996671644063`*^9}, {
   3.630299758470379*^9, 3.630299770504901*^9}, {3.630325511370754*^9, 
   3.630325529185773*^9}, {3.63032947295944*^9, 3.6303295435792074`*^9}, {
   3.630329932277378*^9, 3.6303299364856186`*^9}, 3.63033040779436*^9, {
   3.630330550250988*^9, 3.6303305567702045`*^9}, {3.631825624068637*^9, 
   3.631825658439165*^9}, {3.6318257507005825`*^9, 3.6318260298298693`*^9}, {
   3.631826159996869*^9, 3.6318262041700478`*^9}, {3.631826384475317*^9, 
   3.631826396060495*^9}, {3.631826509542238*^9, 3.631826585975912*^9}, {
   3.631826637616705*^9, 3.631826670727214*^9}, {3.631826704277729*^9, 
   3.63182670760528*^9}, {3.6318268396848087`*^9, 3.6318268836604843`*^9}, {
   3.6318269391813374`*^9, 3.6318270895236464`*^9}, {3.6318273432600436`*^9, 
   3.6318274812321625`*^9}, {3.631828158368924*^9, 3.6318281754929037`*^9}, {
   3.6318285845362997`*^9, 3.6318286087286835`*^9}, {3.631828762404473*^9, 
   3.631828771986021*^9}, {3.631828840096917*^9, 3.631828866321417*^9}, {
   3.6318294994896317`*^9, 3.6318295065490355`*^9}, {3.6318296490301847`*^9, 
   3.631829659802801*^9}, {3.6318300255307198`*^9, 3.6318301388732023`*^9}, {
   3.631830194620391*^9, 3.631830228921353*^9}, {3.6318306202007327`*^9, 
   3.6318306275971556`*^9}, {3.631830978986254*^9, 3.6318311422415915`*^9}, {
   3.631831367524477*^9, 3.6318314192764373`*^9}, {3.631831451996309*^9, 
   3.631831473612545*^9}, 3.6318315143338747`*^9, {3.6318317153613725`*^9, 
   3.63183171741549*^9}, {3.6318318563964396`*^9, 3.6318318646279097`*^9}, {
   3.631832451265464*^9, 3.631832471373614*^9}, {3.6318325184543066`*^9, 
   3.631832528445878*^9}, {3.631832871047474*^9, 3.6318330583031845`*^9}, 
   3.6318331093941064`*^9, {3.6318331917598176`*^9, 3.6318332390455217`*^9}, 
   3.631833464854438*^9, {3.6318334955801954`*^9, 3.6318334980353355`*^9}, {
   3.6318335410857983`*^9, 3.6318335413018103`*^9}, {3.6318336921354375`*^9, 
   3.631833734824879*^9}, {3.631836917554921*^9, 3.631836933892855*^9}, {
   3.6318370914248657`*^9, 3.6318371186944256`*^9}, {3.631837192928671*^9, 
   3.6318372509739914`*^9}, {3.6318374289391704`*^9, 
   3.6318374350395193`*^9}, {3.6318374985801535`*^9, 
   3.6318375045954976`*^9}, {3.6318375677141075`*^9, 
   3.6318375769666367`*^9}, {3.6318406437960496`*^9, 
   3.6318406784790335`*^9}, {3.6318407656400185`*^9, 3.631840785437151*^9}, {
   3.6318409550198507`*^9, 3.631841008121888*^9}, {3.6318410848682775`*^9, 
   3.631841118450198*^9}, {3.631842017177603*^9, 3.631842021097827*^9}, {
   3.6697709526878996`*^9, 3.6697709567621326`*^9}, {3.6698259479070406`*^9, 
   3.6698259615764704`*^9}, {3.669826303628376*^9, 3.6698263128895936`*^9}, {
   3.6698270808996496`*^9, 3.669827085548458*^9}, {3.6698279958287897`*^9, 
   3.6698280147652407`*^9}, {3.6711274898826237`*^9, 
   3.6711275728375826`*^9}, {3.67112813167308*^9, 3.6711283135574245`*^9}, {
   3.671128889077386*^9, 3.6711288931003933`*^9}, {3.671130077000167*^9, 
   3.671130102411614*^9}, {3.6711301652814283`*^9, 3.6711301657494287`*^9}, {
   3.6711336012682314`*^9, 3.6711336155522614`*^9}, {3.6711337354231052`*^9, 
   3.671133802571046*^9}, {3.671134637455387*^9, 3.6711346393011904`*^9}, {
   3.6711368562485313`*^9, 3.6711369660607586`*^9}, {3.6711370118820477`*^9, 
   3.6711370578671484`*^9}, {3.6711371001150312`*^9, 
   3.6711372092000704`*^9}, {3.6711496093415504`*^9, 3.671149823732727*^9}, {
   3.671150208725803*^9, 3.671150242375062*^9}, {3.6711502760399213`*^9, 
   3.6711502773971233`*^9}, {3.6711503989681373`*^9, 
   3.6711504242713814`*^9}, {3.67115077093519*^9, 3.6711507754435987`*^9}, {
   3.6711510231472306`*^9, 3.6711510301360426`*^9}, {3.6711511545150614`*^9, 
   3.6711512315479965`*^9}, {3.6711516175082746`*^9, 
   3.6711516217046824`*^9}, {3.67115175711292*^9, 3.671151959975676*^9}, {
   3.6711520650262604`*^9, 3.6711522767030325`*^9}, {3.6711523724248004`*^9, 
   3.6711523726120005`*^9}, {3.6711524199268837`*^9, 
   3.6711524327969065`*^9}, {3.6711525118578453`*^9, 3.671152575677558*^9}, {
   3.6711526490600863`*^9, 3.6711527060937867`*^9}, 3.6711528707052755`*^9, {
   3.6711531637205906`*^9, 3.6711531825186234`*^9}, {3.6711534422746797`*^9, 
   3.6711534741455355`*^9}, {3.671156401246009*^9, 3.6711564200787983`*^9}, 
   3.6711565354030695`*^9, {3.6711567238309636`*^9, 3.671156735046136*^9}, {
   3.6711571206395583`*^9, 3.6711571211120653`*^9}, {3.671157182695512*^9, 
   3.6711571839655313`*^9}, {3.671157908978011*^9, 3.671157953147798*^9}, 
   3.671158067348332*^9, {3.6711581102608175`*^9, 3.6711582882286687`*^9}, {
   3.6711587438708615`*^9, 3.6711587580360794`*^9}, {3.6711589131002607`*^9, 
   3.6711589299004173`*^9}, {3.6711601244428263`*^9, 3.671160141190583*^9}, {
   3.6711604872033978`*^9, 3.6711604946335125`*^9}, {3.671160866844229*^9, 
   3.6711610180440516`*^9}, {3.671161172762429*^9, 3.6711611844576087`*^9}, {
   3.6711619106322355`*^9, 3.671161922139657*^9}, {3.671162268956931*^9, 
   3.671162269456132*^9}, {3.6711678585118375`*^9, 3.67116787079454*^9}, {
   3.671231290046423*^9, 3.671231297575037*^9}, {3.6712313325027018`*^9, 
   3.6712313358524084`*^9}, {3.6712315640817347`*^9, 
   3.6712315643469353`*^9}, {3.6712318291184893`*^9, 
   3.6712318294304895`*^9}, {3.6712324080856977`*^9, 3.671232408600498*^9}, {
   3.6712326006144733`*^9, 3.6712326108000917`*^9}, {3.6712326563289757`*^9, 
   3.671232659437782*^9}, {3.6712327594318686`*^9, 3.6712327682330866`*^9}, {
   3.6712329030403433`*^9, 3.6712329262708864`*^9}, {3.6712340623797555`*^9, 
   3.6712340678416653`*^9}, {3.6712353156195374`*^9, 
   3.6712353282152615`*^9}, {3.6712359786953845`*^9, 3.671235996519517*^9}, {
   3.671236102523715*^9, 3.6712361326914716`*^9}, {3.671236399625929*^9, 
   3.6712364185607634`*^9}, {3.671237006711313*^9, 3.6712370149681273`*^9}, 
   3.671237053949098*^9, {3.671237088982561*^9, 3.671237174034914*^9}, {
   3.671237216012889*^9, 3.6712372623151717`*^9}, {3.671237332856898*^9, 
   3.671237420601054*^9}, {3.6712374900089784`*^9, 3.6712374992204943`*^9}, {
   3.671237535342759*^9, 3.6712377025263577`*^9}, {3.6712377439377317`*^9, 
   3.671237763741067*^9}, {3.6712378151364584`*^9, 3.6712378769495687`*^9}, {
   3.671238019224722*^9, 3.6712380815894327`*^9}, {3.6712382006922445`*^9, 
   3.671238246170927*^9}, {3.671238647331741*^9, 3.671238685096408*^9}, {
   3.6712389094288096`*^9, 3.67123890964721*^9}, {3.671239152704443*^9, 
   3.671239177847987*^9}, 3.6712392716117787`*^9, {3.671252482533229*^9, 
   3.671252508418627*^9}, {3.6712537970003138`*^9, 3.67125379740032*^9}, {
   3.6712538309433355`*^9, 3.671253831138338*^9}, 3.6712538952918234`*^9, {
   3.727791540786441*^9, 3.7277915413880305`*^9}, {3.859507424050129*^9, 
   3.8595074398183503`*^9}, {3.8595077967332335`*^9, 3.859507798198323*^9}, {
   3.8595084390300016`*^9, 3.8595084555173965`*^9}, {3.8595085315823793`*^9, 
   3.859508556075876*^9}, {3.8595086109878817`*^9, 3.859508626340315*^9}, 
   3.859509139514032*^9, 3.8595092081349206`*^9, 3.859509441555049*^9, {
   3.86127806434093*^9, 3.8612780650110292`*^9}, {3.8612783584410524`*^9, 
   3.8612783640810213`*^9}, 3.8612807254060135`*^9, {3.861320203116994*^9, 
   3.8613202648811674`*^9}, {3.861320474749791*^9, 3.861320474906066*^9}, {
   3.861320521386611*^9, 3.861320529015644*^9}, {3.8613207078810005`*^9, 
   3.8613207095059505`*^9}, {3.8613207868995705`*^9, 3.86132078993221*^9}, {
   3.8613210534409432`*^9, 3.8613210738199215`*^9}, {3.861321405816964*^9, 
   3.8613214067148123`*^9}, {3.8613218385178947`*^9, 
   3.8613218640546875`*^9}, {3.8613219034253836`*^9, 3.861321916555071*^9}, 
   3.8613219821902966`*^9, {3.861322307966164*^9, 3.8613223602460947`*^9}, {
   3.861322584840629*^9, 3.861322585012477*^9}, {3.861322735600915*^9, 
   3.861322741446396*^9}, {3.861322783023175*^9, 3.861322793227331*^9}, {
   3.8613228433160267`*^9, 3.861322846615349*^9}, {3.86132290910822*^9, 
   3.861322928754201*^9}, {3.8613230129959726`*^9, 3.8613230201847744`*^9}, {
   3.8613235819582224`*^9, 3.861323590633213*^9}, {3.8613346830929165`*^9, 
   3.8613346999455433`*^9}, {3.8613347359863515`*^9, 
   3.8613347554563637`*^9}, {3.861648813732291*^9, 3.86164882527402*^9}, {
   3.8617023909787507`*^9, 3.8617023996818743`*^9}, {3.8617496742104416`*^9, 
   3.8617497306902494`*^9}, 3.8617497609102507`*^9, {3.8617497911303673`*^9, 
   3.8617498977702675`*^9}, {3.861749945596493*^9, 3.8617499982429595`*^9}, {
   3.861750253450308*^9, 3.861750254232177*^9}, {3.8617503351599903`*^9, 
   3.861750348809881*^9}, {3.8617504235104065`*^9, 3.861750433960668*^9}, {
   3.861750465130866*^9, 3.861750485210384*^9}, {3.8617505217399054`*^9, 
   3.8617505440603914`*^9}, {3.8617505780304446`*^9, 
   3.8617505938806343`*^9}, {3.861750628800365*^9, 3.8617506289604273`*^9}, {
   3.8617509009805555`*^9, 3.8617509016407423`*^9}, 3.861750932990773*^9, 
   3.8617509968058124`*^9, {3.8617510335204115`*^9, 3.8617510339404626`*^9}, 
   3.8617510956604877`*^9, {3.861751176090515*^9, 3.8617511933704996`*^9}, {
   3.861751256030507*^9, 3.8617512659805665`*^9}, {3.861751643750515*^9, 
   3.8617516682588606`*^9}, {3.861751750191495*^9, 3.8617518210302863`*^9}, 
   3.861751873921317*^9, 3.861766643035576*^9, 3.86176684326286*^9, {
   3.861936728178451*^9, 3.861936730028886*^9}, {3.861936784677888*^9, 
   3.8619368486384706`*^9}, {3.8619381981853743`*^9, 3.861938206895655*^9}, {
   3.861939331147955*^9, 3.861939507628111*^9}, {3.861939629680274*^9, 
   3.8619396964179025`*^9}, {3.861939731667883*^9, 3.8619397644102983`*^9}, {
   3.8619398116548414`*^9, 3.8619398120376263`*^9}, {3.8619398650483418`*^9, 
   3.861939866503418*^9}, {3.8619399230744724`*^9, 3.8619399235171127`*^9}, {
   3.861939957687299*^9, 3.8619399580994415`*^9}, {3.86194001794092*^9, 
   3.861940046709462*^9}, {3.862538813692727*^9, 3.86253883571146*^9}, {
   3.8627087419369917`*^9, 3.862708750185024*^9}, {3.8651172084234433`*^9, 
   3.865117261142193*^9}, {3.865117303501568*^9, 3.8651173043296947`*^9}, 
   3.865119248698264*^9, {3.8651198440468054`*^9, 3.865120012320426*^9}, {
   3.866706809562356*^9, 3.8667068097472878`*^9}, {3.8667068471214466`*^9, 
   3.866706868786438*^9}, {3.8667069374856215`*^9, 3.8667069592835283`*^9}, {
   3.8667069912179117`*^9, 3.866706998486289*^9}, {3.8667669781924534`*^9, 
   3.8667669806906414`*^9}, 3.8667672762563457`*^9, {3.8757559851157503`*^9, 
   3.8757560139199195`*^9}, {3.875756051342039*^9, 3.8757561362107987`*^9}, {
   3.8763610758860817`*^9, 3.8763610985746155`*^9}, {3.8763629875553503`*^9, 
   3.8763630268208265`*^9}, 3.8860342709645314`*^9, 3.886036799517524*^9, {
   3.8915170280828485`*^9, 3.8915170627527013`*^9}, {3.8950590016886234`*^9, 
   3.895059027022355*^9}, {3.895554774547974*^9, 3.8955547745759783`*^9}, {
   3.8955551722476854`*^9, 3.8955551722896605`*^9}, {3.8955554988180103`*^9, 
   3.8955555268035326`*^9}, {3.8993774138859177`*^9, 3.899377426359249*^9}, {
   3.9028241046894984`*^9, 3.902824119064123*^9}, {3.958447636664733*^9, 
   3.9584476482149277`*^9}, 3.958796686277439*^9, {3.95993465613906*^9, 
   3.959934687650886*^9}, {3.959934817665497*^9, 3.9599348547265873`*^9}, 
   3.967777451991943*^9, 3.972618023753631*^9, {3.975312046480317*^9, 
   3.975312183439859*^9}},ExpressionUUID->"92a3c042-dbe0-47d4-9c1c-\
a11b13a56496"]
}, Closed]],

Cell[CellGroupData[{

Cell["RaiseAllIndices", "Subsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.533880012946951*^9, 3.5338800148345547`*^9}, {
   3.606329216258676*^9, 3.6063292218312616`*^9}, 3.606497441942197*^9, {
   3.606512368464484*^9, 3.606512376678954*^9}, {3.630042521633257*^9, 
   3.6300425280604687`*^9}, {3.6695632003793564`*^9, 
   3.6695632027043686`*^9}},ExpressionUUID->"3f734fc5-9c3f-4157-ab30-\
9d3e379fab20"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"RaiseAllIndices", "[", 
     RowBox[{"tt_Tensor", ",", "m_Tensor"}], "]"}], " ", "returns", " ", "tt",
     " ", "with", " ", "all", " ", "its", " ", "indices", " ", "raised"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"RaiseAllIndices", "[", 
      RowBox[{
       RowBox[{"t_Tensor", "/;", 
        RowBox[{"!", 
         RowBox[{"TestScalarTensor", "[", "t", "]"}]}]}], ",", 
       RowBox[{"m_Tensor", "/;", 
        RowBox[{"TestMetricTensor", "[", "m", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "idx", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "strip", " ", "off", " ", "all", " ", "the", " ", "SubMinus", " ", 
         "and", " ", "SuperMinus", " ", "and", " ", "then", " ", "replace", 
         " ", "them", " ", "all", " ", "with", " ", "SuperMinus"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"idx", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"SuperMinus", "[", "#", "]"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "&"}], "/@", 
            RowBox[{"RemoveUnderBarredIndices", "[", 
             RowBox[{"Indices", "[", "t", "]"}], "]"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"MoveIndices", "[", 
         RowBox[{"t", ",", "idx", ",", "m"}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RaiseAllIndices", "[", 
     RowBox[{
      RowBox[{"t_Tensor", "/;", 
       RowBox[{"TestScalarTensor", "[", "t", "]"}]}], ",", 
      RowBox[{"m_Tensor", "/;", 
       RowBox[{"TestMetricTensor", "[", "m", "]"}]}]}], "]"}], ":=", "t"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RaiseAllIndices", "[", 
     RowBox[{
      RowBox[{"t_", "/;", 
       RowBox[{"TestExpressionForm", "[", "t", "]"}]}], ",", 
      RowBox[{"m_Tensor", "/;", 
       RowBox[{"TestMetricTensor", "[", "m", "]"}]}]}], "]"}], ":=", 
    "t"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.6063292322449217`*^9, 
   3.606329256638296*^9}, {3.6064974490496035`*^9, 3.6064974614663134`*^9}, 
   3.606512382622294*^9, {3.60651242556575*^9, 3.6065125215382395`*^9}, {
   3.6065125556711917`*^9, 3.606512600995784*^9}, {3.606512761984992*^9, 
   3.6065128691121197`*^9}, {3.6065129691668425`*^9, 3.606512970031892*^9}, {
   3.6065131686742535`*^9, 3.6065131898644657`*^9}, {3.6065132669168725`*^9, 
   3.606513293923417*^9}, {3.629692178653521*^9, 3.6296921823366594`*^9}, {
   3.6296927745837092`*^9, 3.6296927894092307`*^9}, {3.6296928455681496`*^9, 
   3.629692856442544*^9}, {3.6296929535388727`*^9, 3.6296929933152556`*^9}, {
   3.6296930748191504`*^9, 3.6296930871695933`*^9}, {3.6296932234826612`*^9, 
   3.6296932524307303`*^9}, {3.6296933014895077`*^9, 3.629693381002375*^9}, {
   3.6297662869445314`*^9, 3.629766315970583*^9}, {3.6298439670933137`*^9, 
   3.62984398806225*^9}, {3.6298442399943933`*^9, 3.6298442410395956`*^9}, {
   3.630042532709276*^9, 3.6300426463617764`*^9}, {3.630042703883478*^9, 
   3.6300427521936626`*^9}, {3.630042825447692*^9, 3.6300428286456976`*^9}, {
   3.630042980332965*^9, 3.6300430264254456`*^9}, {3.630043060105305*^9, 
   3.630043072949128*^9}, {3.6300941467346215`*^9, 3.6300941501305285`*^9}, {
   3.630094422824464*^9, 3.6300944485833097`*^9}, {3.6300945129192295`*^9, 
   3.6300945130596294`*^9}, {3.63009456993493*^9, 3.630094604724292*^9}, {
   3.630094645506065*^9, 3.630094671206911*^9}, {3.6300950713827314`*^9, 
   3.6300950923929887`*^9}, {3.630095126572833*^9, 3.630095148924312*^9}, {
   3.6300952987629194`*^9, 3.630095317689753*^9}, {3.630095631618222*^9, 
   3.6300957899633107`*^9}, {3.6300960708098197`*^9, 
   3.6300960867862473`*^9}, {3.6300962273194976`*^9, 3.63009628683821*^9}, {
   3.630096394701002*^9, 3.630096400755813*^9}, {3.6300966069840384`*^9, 
   3.6300966275030746`*^9}, {3.630096752960698*^9, 3.6300968779735284`*^9}, {
   3.630096912059989*^9, 3.6300969145091934`*^9}, {3.63012458548705*^9, 
   3.6301245859862514`*^9}, {3.630171696268879*^9, 3.630171697187932*^9}, {
   3.6301721267055283`*^9, 3.630172187186988*^9}, {3.6301725465885444`*^9, 
   3.6301725574831676`*^9}, 3.6301726028587627`*^9, {3.630172639309848*^9, 
   3.630172639791875*^9}, {3.6301726869325714`*^9, 3.6301727745875854`*^9}, {
   3.630173004281803*^9, 3.6301730118478165`*^9}, 3.630173624767943*^9, {
   3.630174010129105*^9, 3.630174033250958*^9}, {3.630174068378629*^9, 
   3.6301740923886747`*^9}, {3.6301741428191967`*^9, 
   3.6301742377847843`*^9}, {3.6301743004723024`*^9, 
   3.6301743866434655`*^9}, {3.630174545460163*^9, 3.63017462231811*^9}, {
   3.6301746580413885`*^9, 3.6301748707160015`*^9}, {3.630184130800047*^9, 
   3.630184229457509*^9}, {3.6301850052789664`*^9, 3.6301850107509813`*^9}, {
   3.630201973676296*^9, 3.6302019811364107`*^9}, {3.6302020119268837`*^9, 
   3.6302020259195986`*^9}, {3.6302020865180297`*^9, 3.630202099130723*^9}, {
   3.6302062623687735`*^9, 3.630206262774374*^9}, {3.630206526945647*^9, 
   3.63020653465456*^9}, {3.630206589878859*^9, 3.630206598284174*^9}, {
   3.6302069385396786`*^9, 3.6302069408977823`*^9}, {3.6302077285487456`*^9, 
   3.630207751509098*^9}, {3.630207950034648*^9, 3.6302079508521605`*^9}, {
   3.6302528520300617`*^9, 3.630252907757249*^9}, {3.630253300900735*^9, 
   3.6302533587870464`*^9}, {3.6302533928009915`*^9, 3.630253437125527*^9}, {
   3.630253539353374*^9, 3.630253546644791*^9}, {3.6302538002332954`*^9, 
   3.63025391675496*^9}, 3.6302539719411163`*^9, {3.6302548553419456`*^9, 
   3.630254856263347*^9}, {3.63025524972278*^9, 3.6302553181907015`*^9}, {
   3.6302553846950192`*^9, 3.630255482220399*^9}, {3.630255622908106*^9, 
   3.630255771687378*^9}, 3.630255920597887*^9, {3.6302561838895245`*^9, 
   3.6302562374302197`*^9}, {3.63025627707789*^9, 3.6302562862079067`*^9}, {
   3.63027400911228*^9, 3.6302740095322804`*^9}, {3.6302760017164326`*^9, 
   3.6302760021532335`*^9}, {3.6302760803358254`*^9, 3.630276097643756*^9}, {
   3.6302779572998476`*^9, 3.630278019811158*^9}, {3.6302782118409033`*^9, 
   3.630278248205868*^9}, {3.6302789403728676`*^9, 3.630278952415489*^9}, 
   3.6302789849690466`*^9, {3.630279062704089*^9, 3.6302790721053057`*^9}, {
   3.630293787958753*^9, 3.6302938141230297`*^9}, {3.630295113013002*^9, 
   3.6302951563480787`*^9}, {3.6302953058709517`*^9, 
   3.6302953084134912`*^9}, {3.630295437321472*^9, 3.6302954415365367`*^9}, {
   3.6302955365114965`*^9, 3.630295543759108*^9}, 3.630295625172858*^9, {
   3.630295725821904*^9, 3.6302957316869946`*^9}, {3.6302958003830495`*^9, 
   3.630295817580814*^9}, 3.6302959076796975`*^9, {3.6302959991886034`*^9, 
   3.6302960013736367`*^9}, {3.630296040071731*^9, 3.6302960829273896`*^9}, {
   3.6302963683317733`*^9, 3.6302965572696753`*^9}, {3.6302967437550397`*^9, 
   3.630296785528181*^9}, {3.630297190921908*^9, 3.630297194781967*^9}, {
   3.6302973560094433`*^9, 3.630297421670452*^9}, {3.6302974957740903`*^9, 
   3.630297504921731*^9}, {3.6302975815729084`*^9, 3.630297588438014*^9}, {
   3.630297648163931*^9, 3.63029765981911*^9}, {3.6302977345252576`*^9, 
   3.63029775553808*^9}, {3.6302978060738564`*^9, 3.630297856057124*^9}, {
   3.6302979279460716`*^9, 3.6302979381762085`*^9}, {3.6302980130646505`*^9, 
   3.630298014179663*^9}, {3.630298187432942*^9, 3.630298246224647*^9}, {
   3.630298410811104*^9, 3.630298411016404*^9}, {3.630299459602931*^9, 
   3.630299468104946*^9}, {3.6302996293748393`*^9, 3.6302996671644063`*^9}, {
   3.630299758470379*^9, 3.630299770504901*^9}, {3.630325511370754*^9, 
   3.630325529185773*^9}, {3.63032947295944*^9, 3.6303295435792074`*^9}, {
   3.630329932277378*^9, 3.6303299364856186`*^9}, 3.63033040779436*^9, {
   3.630330550250988*^9, 3.6303305567702045`*^9}, {3.631825624068637*^9, 
   3.631825658439165*^9}, {3.6318257507005825`*^9, 3.6318260298298693`*^9}, {
   3.631826159996869*^9, 3.6318262041700478`*^9}, {3.631826384475317*^9, 
   3.631826396060495*^9}, {3.631826509542238*^9, 3.631826585975912*^9}, {
   3.631826637616705*^9, 3.631826670727214*^9}, {3.631826704277729*^9, 
   3.63182670760528*^9}, {3.6318268396848087`*^9, 3.6318268836604843`*^9}, {
   3.6318269391813374`*^9, 3.6318270895236464`*^9}, {3.6318273432600436`*^9, 
   3.6318274812321625`*^9}, {3.631828158368924*^9, 3.6318281754929037`*^9}, {
   3.6318285845362997`*^9, 3.6318286087286835`*^9}, {3.631828762404473*^9, 
   3.631828771986021*^9}, {3.631828840096917*^9, 3.631828866321417*^9}, {
   3.6318294994896317`*^9, 3.6318295065490355`*^9}, {3.6318296490301847`*^9, 
   3.631829659802801*^9}, {3.6318300255307198`*^9, 3.6318301388732023`*^9}, {
   3.631830194620391*^9, 3.631830228921353*^9}, {3.6318306202007327`*^9, 
   3.6318306275971556`*^9}, {3.631830978986254*^9, 3.6318311422415915`*^9}, {
   3.631831367524477*^9, 3.6318314192764373`*^9}, {3.631831451996309*^9, 
   3.631831473612545*^9}, 3.6318315143338747`*^9, {3.6318317153613725`*^9, 
   3.63183171741549*^9}, {3.6318318563964396`*^9, 3.6318318646279097`*^9}, {
   3.631832451265464*^9, 3.631832471373614*^9}, {3.6318325184543066`*^9, 
   3.631832528445878*^9}, {3.631832871047474*^9, 3.6318330583031845`*^9}, 
   3.6318331093941064`*^9, {3.6318331917598176`*^9, 3.6318332390455217`*^9}, 
   3.631833464854438*^9, {3.6318334955801954`*^9, 3.6318334980353355`*^9}, {
   3.6318335410857983`*^9, 3.6318335413018103`*^9}, {3.6318336921354375`*^9, 
   3.631833734824879*^9}, {3.631836917554921*^9, 3.631836933892855*^9}, {
   3.6318370914248657`*^9, 3.6318371186944256`*^9}, {3.631837192928671*^9, 
   3.6318372509739914`*^9}, {3.6318374289391704`*^9, 
   3.6318374350395193`*^9}, {3.6318374985801535`*^9, 
   3.6318375045954976`*^9}, {3.6318375677141075`*^9, 
   3.6318375769666367`*^9}, {3.6318406437960496`*^9, 
   3.6318406784790335`*^9}, {3.6318407656400185`*^9, 3.631840785437151*^9}, {
   3.6318409550198507`*^9, 3.631841008121888*^9}, {3.6318410848682775`*^9, 
   3.631841118450198*^9}, {3.631842017177603*^9, 3.631842021097827*^9}, {
   3.669563225736412*^9, 3.6695632328774233`*^9}, {3.669593004802393*^9, 
   3.6695930225264063`*^9}, {3.66959321315331*^9, 3.6695932649702735`*^9}, {
   3.6695933127800083`*^9, 3.669593345813897*^9}, {3.6695933925994377`*^9, 
   3.6695934028360233`*^9}, {3.6695934797294216`*^9, 
   3.6695934816175294`*^9}, {3.6695943890364923`*^9, 
   3.6695943905115767`*^9}, {3.6696949698389616`*^9, 3.669694977298972*^9}, {
   3.6697669687191277`*^9, 3.6697669750864916`*^9}, {3.6697718596827335`*^9, 
   3.669771881028954*^9}, 3.893146170647874*^9, {3.8932891243125167`*^9, 
   3.893289124314515*^9}, {3.8955551722986565`*^9, 3.8955551723026547`*^9}, {
   3.895555339819285*^9, 3.8955553398213973`*^9}, 
   3.8955558383574915`*^9},ExpressionUUID->"0175fc62-84a9-4af5-bd42-\
c8f70b287fdb"]
}, Closed]],

Cell[CellGroupData[{

Cell["LowerAllIndices", "Subsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.533880012946951*^9, 3.5338800148345547`*^9}, {
   3.606329216258676*^9, 3.6063292218312616`*^9}, 3.606497441942197*^9, {
   3.606512368464484*^9, 3.606512376678954*^9}, {3.630042521633257*^9, 
   3.6300425280604687`*^9}, {3.6695632003793564`*^9, 
   3.669563216695396*^9}},ExpressionUUID->"7ae3a39d-25a1-4c31-ab81-\
6f0c1e5a8675"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"LowerAllIndices", "[", 
     RowBox[{"tt_Tensor", ",", "m_Tensor"}], "]"}], " ", "returns", " ", "tt",
     " ", "with", " ", "all", " ", "its", " ", "indices", " ", "lowered"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"LowerAllIndices", "[", 
      RowBox[{
       RowBox[{"t_Tensor", "/;", 
        RowBox[{"!", 
         RowBox[{"TestScalarTensor", "[", "t", "]"}]}]}], ",", 
       RowBox[{"m_Tensor", "/;", 
        RowBox[{"TestMetricTensor", "[", "m", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "idx", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "strip", " ", "off", " ", "all", " ", "the", " ", "SubMinus", " ", 
         "and", " ", "SuperMinus", " ", "and", " ", "then", " ", "replace", 
         " ", "them", " ", "all", " ", "with", " ", "SuperMinus"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"idx", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"SubMinus", "[", "#", "]"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "&"}], "/@", 
            RowBox[{"RemoveUnderBarredIndices", "[", 
             RowBox[{"Indices", "[", "t", "]"}], "]"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"MoveIndices", "[", 
         RowBox[{"t", ",", "idx", ",", "m"}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LowerAllIndices", "[", 
     RowBox[{
      RowBox[{"t_Tensor", "/;", 
       RowBox[{"TestScalarTensor", "[", "t", "]"}]}], ",", 
      RowBox[{"m_Tensor", "/;", 
       RowBox[{"TestMetricTensor", "[", "m", "]"}]}]}], "]"}], ":=", "t"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LowerAllIndices", "[", 
     RowBox[{
      RowBox[{"t_", "/;", 
       RowBox[{"TestExpressionForm", "[", "t", "]"}]}], ",", 
      RowBox[{"m_Tensor", "/;", 
       RowBox[{"TestMetricTensor", "[", "m", "]"}]}]}], "]"}], ":=", 
    "t"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.6063292322449217`*^9, 
   3.606329256638296*^9}, {3.6064974490496035`*^9, 3.6064974614663134`*^9}, 
   3.606512382622294*^9, {3.60651242556575*^9, 3.6065125215382395`*^9}, {
   3.6065125556711917`*^9, 3.606512600995784*^9}, {3.606512761984992*^9, 
   3.6065128691121197`*^9}, {3.6065129691668425`*^9, 3.606512970031892*^9}, {
   3.6065131686742535`*^9, 3.6065131898644657`*^9}, {3.6065132669168725`*^9, 
   3.606513293923417*^9}, {3.629692178653521*^9, 3.6296921823366594`*^9}, {
   3.6296927745837092`*^9, 3.6296927894092307`*^9}, {3.6296928455681496`*^9, 
   3.629692856442544*^9}, {3.6296929535388727`*^9, 3.6296929933152556`*^9}, {
   3.6296930748191504`*^9, 3.6296930871695933`*^9}, {3.6296932234826612`*^9, 
   3.6296932524307303`*^9}, {3.6296933014895077`*^9, 3.629693381002375*^9}, {
   3.6297662869445314`*^9, 3.629766315970583*^9}, {3.6298439670933137`*^9, 
   3.62984398806225*^9}, {3.6298442399943933`*^9, 3.6298442410395956`*^9}, {
   3.630042532709276*^9, 3.6300426463617764`*^9}, {3.630042703883478*^9, 
   3.6300427521936626`*^9}, {3.630042825447692*^9, 3.6300428286456976`*^9}, {
   3.630042980332965*^9, 3.6300430264254456`*^9}, {3.630043060105305*^9, 
   3.630043072949128*^9}, {3.6300941467346215`*^9, 3.6300941501305285`*^9}, {
   3.630094422824464*^9, 3.6300944485833097`*^9}, {3.6300945129192295`*^9, 
   3.6300945130596294`*^9}, {3.63009456993493*^9, 3.630094604724292*^9}, {
   3.630094645506065*^9, 3.630094671206911*^9}, {3.6300950713827314`*^9, 
   3.6300950923929887`*^9}, {3.630095126572833*^9, 3.630095148924312*^9}, {
   3.6300952987629194`*^9, 3.630095317689753*^9}, {3.630095631618222*^9, 
   3.6300957899633107`*^9}, {3.6300960708098197`*^9, 
   3.6300960867862473`*^9}, {3.6300962273194976`*^9, 3.63009628683821*^9}, {
   3.630096394701002*^9, 3.630096400755813*^9}, {3.6300966069840384`*^9, 
   3.6300966275030746`*^9}, {3.630096752960698*^9, 3.6300968779735284`*^9}, {
   3.630096912059989*^9, 3.6300969145091934`*^9}, {3.63012458548705*^9, 
   3.6301245859862514`*^9}, {3.630171696268879*^9, 3.630171697187932*^9}, {
   3.6301721267055283`*^9, 3.630172187186988*^9}, {3.6301725465885444`*^9, 
   3.6301725574831676`*^9}, 3.6301726028587627`*^9, {3.630172639309848*^9, 
   3.630172639791875*^9}, {3.6301726869325714`*^9, 3.6301727745875854`*^9}, {
   3.630173004281803*^9, 3.6301730118478165`*^9}, 3.630173624767943*^9, {
   3.630174010129105*^9, 3.630174033250958*^9}, {3.630174068378629*^9, 
   3.6301740923886747`*^9}, {3.6301741428191967`*^9, 
   3.6301742377847843`*^9}, {3.6301743004723024`*^9, 
   3.6301743866434655`*^9}, {3.630174545460163*^9, 3.63017462231811*^9}, {
   3.6301746580413885`*^9, 3.6301748707160015`*^9}, {3.630184130800047*^9, 
   3.630184229457509*^9}, {3.6301850052789664`*^9, 3.6301850107509813`*^9}, {
   3.630201973676296*^9, 3.6302019811364107`*^9}, {3.6302020119268837`*^9, 
   3.6302020259195986`*^9}, {3.6302020865180297`*^9, 3.630202099130723*^9}, {
   3.6302062623687735`*^9, 3.630206262774374*^9}, {3.630206526945647*^9, 
   3.63020653465456*^9}, {3.630206589878859*^9, 3.630206598284174*^9}, {
   3.6302069385396786`*^9, 3.6302069408977823`*^9}, {3.6302077285487456`*^9, 
   3.630207751509098*^9}, {3.630207950034648*^9, 3.6302079508521605`*^9}, {
   3.6302528520300617`*^9, 3.630252907757249*^9}, {3.630253300900735*^9, 
   3.6302533587870464`*^9}, {3.6302533928009915`*^9, 3.630253437125527*^9}, {
   3.630253539353374*^9, 3.630253546644791*^9}, {3.6302538002332954`*^9, 
   3.63025391675496*^9}, 3.6302539719411163`*^9, {3.6302548553419456`*^9, 
   3.630254856263347*^9}, {3.63025524972278*^9, 3.6302553181907015`*^9}, {
   3.6302553846950192`*^9, 3.630255482220399*^9}, {3.630255622908106*^9, 
   3.630255771687378*^9}, 3.630255920597887*^9, {3.6302561838895245`*^9, 
   3.6302562374302197`*^9}, {3.63025627707789*^9, 3.6302562862079067`*^9}, {
   3.63027400911228*^9, 3.6302740095322804`*^9}, {3.6302760017164326`*^9, 
   3.6302760021532335`*^9}, {3.6302760803358254`*^9, 3.630276097643756*^9}, {
   3.6302779572998476`*^9, 3.630278019811158*^9}, {3.6302782118409033`*^9, 
   3.630278248205868*^9}, {3.6302789403728676`*^9, 3.630278952415489*^9}, 
   3.6302789849690466`*^9, {3.630279062704089*^9, 3.6302790721053057`*^9}, {
   3.630293787958753*^9, 3.6302938141230297`*^9}, {3.630295113013002*^9, 
   3.6302951563480787`*^9}, {3.6302953058709517`*^9, 
   3.6302953084134912`*^9}, {3.630295437321472*^9, 3.6302954415365367`*^9}, {
   3.6302955365114965`*^9, 3.630295543759108*^9}, 3.630295625172858*^9, {
   3.630295725821904*^9, 3.6302957316869946`*^9}, {3.6302958003830495`*^9, 
   3.630295817580814*^9}, 3.6302959076796975`*^9, {3.6302959991886034`*^9, 
   3.6302960013736367`*^9}, {3.630296040071731*^9, 3.6302960829273896`*^9}, {
   3.6302963683317733`*^9, 3.6302965572696753`*^9}, {3.6302967437550397`*^9, 
   3.630296785528181*^9}, {3.630297190921908*^9, 3.630297194781967*^9}, {
   3.6302973560094433`*^9, 3.630297421670452*^9}, {3.6302974957740903`*^9, 
   3.630297504921731*^9}, {3.6302975815729084`*^9, 3.630297588438014*^9}, {
   3.630297648163931*^9, 3.63029765981911*^9}, {3.6302977345252576`*^9, 
   3.63029775553808*^9}, {3.6302978060738564`*^9, 3.630297856057124*^9}, {
   3.6302979279460716`*^9, 3.6302979381762085`*^9}, {3.6302980130646505`*^9, 
   3.630298014179663*^9}, {3.630298187432942*^9, 3.630298246224647*^9}, {
   3.630298410811104*^9, 3.630298411016404*^9}, {3.630299459602931*^9, 
   3.630299468104946*^9}, {3.6302996293748393`*^9, 3.6302996671644063`*^9}, {
   3.630299758470379*^9, 3.630299770504901*^9}, {3.630325511370754*^9, 
   3.630325529185773*^9}, {3.63032947295944*^9, 3.6303295435792074`*^9}, {
   3.630329932277378*^9, 3.6303299364856186`*^9}, 3.63033040779436*^9, {
   3.630330550250988*^9, 3.6303305567702045`*^9}, {3.631825624068637*^9, 
   3.631825658439165*^9}, {3.6318257507005825`*^9, 3.6318260298298693`*^9}, {
   3.631826159996869*^9, 3.6318262041700478`*^9}, {3.631826384475317*^9, 
   3.631826396060495*^9}, {3.631826509542238*^9, 3.631826585975912*^9}, {
   3.631826637616705*^9, 3.631826670727214*^9}, {3.631826704277729*^9, 
   3.63182670760528*^9}, {3.6318268396848087`*^9, 3.6318268836604843`*^9}, {
   3.6318269391813374`*^9, 3.6318270895236464`*^9}, {3.6318273432600436`*^9, 
   3.6318274812321625`*^9}, {3.631828158368924*^9, 3.6318281754929037`*^9}, {
   3.6318285845362997`*^9, 3.6318286087286835`*^9}, {3.631828762404473*^9, 
   3.631828771986021*^9}, {3.631828840096917*^9, 3.631828866321417*^9}, {
   3.6318294994896317`*^9, 3.6318295065490355`*^9}, {3.6318296490301847`*^9, 
   3.631829659802801*^9}, {3.6318300255307198`*^9, 3.6318301388732023`*^9}, {
   3.631830194620391*^9, 3.631830228921353*^9}, {3.6318306202007327`*^9, 
   3.6318306275971556`*^9}, {3.631830978986254*^9, 3.6318311422415915`*^9}, {
   3.631831367524477*^9, 3.6318314192764373`*^9}, {3.631831451996309*^9, 
   3.631831473612545*^9}, 3.6318315143338747`*^9, {3.6318317153613725`*^9, 
   3.63183171741549*^9}, {3.6318318563964396`*^9, 3.6318318646279097`*^9}, {
   3.631832451265464*^9, 3.631832471373614*^9}, {3.6318325184543066`*^9, 
   3.631832528445878*^9}, {3.631832871047474*^9, 3.6318330583031845`*^9}, 
   3.6318331093941064`*^9, {3.6318331917598176`*^9, 3.6318332390455217`*^9}, 
   3.631833464854438*^9, {3.6318334955801954`*^9, 3.6318334980353355`*^9}, {
   3.6318335410857983`*^9, 3.6318335413018103`*^9}, {3.6318336921354375`*^9, 
   3.631833734824879*^9}, {3.631836917554921*^9, 3.631836933892855*^9}, {
   3.6318370914248657`*^9, 3.6318371186944256`*^9}, {3.631837192928671*^9, 
   3.6318372509739914`*^9}, {3.6318374289391704`*^9, 
   3.6318374350395193`*^9}, {3.6318374985801535`*^9, 
   3.6318375045954976`*^9}, {3.6318375677141075`*^9, 
   3.6318375769666367`*^9}, {3.6318406437960496`*^9, 
   3.6318406784790335`*^9}, {3.6318407656400185`*^9, 3.631840785437151*^9}, {
   3.6318409550198507`*^9, 3.631841008121888*^9}, {3.6318410848682775`*^9, 
   3.631841118450198*^9}, {3.631842017177603*^9, 3.631842021097827*^9}, {
   3.669563245602455*^9, 3.6695632500054617`*^9}, {3.6695935326524487`*^9, 
   3.6695935513725195`*^9}, {3.6695943853782835`*^9, 3.669594386452345*^9}, 
   3.669694981774984*^9, {3.669766981158839*^9, 3.669766983073949*^9}, {
   3.669771863596957*^9, 3.6697718761196733`*^9}, {3.8931327914010267`*^9, 
   3.893132791530949*^9}, {3.893145671826922*^9, 3.893145672818314*^9}, 
   3.8931461848731637`*^9, {3.893289124323509*^9, 3.893289124325508*^9}, {
   3.89555517230665*^9, 3.8955551723096485`*^9}, {3.8955553398262796`*^9, 
   3.8955553398292785`*^9}, 
   3.895555838361489*^9},ExpressionUUID->"3d65c77e-074d-4df2-90b5-\
34a2dc446b2d"]
}, Closed]],

Cell[CellGroupData[{

Cell["UniqueIndices", "Subsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.533880012946951*^9, 3.5338800148345547`*^9}, {
   3.606329216258676*^9, 3.6063292218312616`*^9}, 3.606497441942197*^9, {
   3.606512368464484*^9, 3.606512376678954*^9}, {3.630042521633257*^9, 
   3.6300425280604687`*^9}, {3.6695632003793564`*^9, 
   3.6695632027043686`*^9}, {3.6695727851785326`*^9, 
   3.6695727922199354`*^9}, {3.669573170398018*^9, 
   3.6695731714178257`*^9}},ExpressionUUID->"3e71db93-4edc-48aa-a385-\
44c9fa8f6a67"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"UniqueIndices", "[", "tt_Tensor", "]"}], " ", "returns", " ", 
    "tt", " ", "with", " ", "its", " ", "indices", " ", "made", " ", 
    "unique"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"UniqueIndices", "[", "t_Tensor", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"idx", ",", "xxx"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "strip", " ", "off", " ", "the", " ", "SubMinus", " ", "and", " ", 
        "SuperMinus"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"idx", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "&"}], "/@", 
         RowBox[{"RemoveUnderBarredIndices", "[", 
          RowBox[{"Indices", "[", "t", "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "replace", " ", "them", " ", "with", " ", "Unique", " ", "ones"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"idx", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#", "\[Rule]", 
            RowBox[{"Unique", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
         "idx"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"t", "/.", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Indices", "\[Rule]", "xxx_"}], ")"}], "\[RuleDelayed]", 
         RowBox[{"(", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"xxx", "/.", "idx"}], ")"}]}], ")"}]}]}]}]}], "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.6063292322449217`*^9, 
   3.606329256638296*^9}, {3.6064974490496035`*^9, 3.6064974614663134`*^9}, 
   3.606512382622294*^9, {3.60651242556575*^9, 3.6065125215382395`*^9}, {
   3.6065125556711917`*^9, 3.606512600995784*^9}, {3.606512761984992*^9, 
   3.6065128691121197`*^9}, {3.6065129691668425`*^9, 3.606512970031892*^9}, {
   3.6065131686742535`*^9, 3.6065131898644657`*^9}, {3.6065132669168725`*^9, 
   3.606513293923417*^9}, {3.629692178653521*^9, 3.6296921823366594`*^9}, {
   3.6296927745837092`*^9, 3.6296927894092307`*^9}, {3.6296928455681496`*^9, 
   3.629692856442544*^9}, {3.6296929535388727`*^9, 3.6296929933152556`*^9}, {
   3.6296930748191504`*^9, 3.6296930871695933`*^9}, {3.6296932234826612`*^9, 
   3.6296932524307303`*^9}, {3.6296933014895077`*^9, 3.629693381002375*^9}, {
   3.6297662869445314`*^9, 3.629766315970583*^9}, {3.6298439670933137`*^9, 
   3.62984398806225*^9}, {3.6298442399943933`*^9, 3.6298442410395956`*^9}, {
   3.630042532709276*^9, 3.6300426463617764`*^9}, {3.630042703883478*^9, 
   3.6300427521936626`*^9}, {3.630042825447692*^9, 3.6300428286456976`*^9}, {
   3.630042980332965*^9, 3.6300430264254456`*^9}, {3.630043060105305*^9, 
   3.630043072949128*^9}, {3.6300941467346215`*^9, 3.6300941501305285`*^9}, {
   3.630094422824464*^9, 3.6300944485833097`*^9}, {3.6300945129192295`*^9, 
   3.6300945130596294`*^9}, {3.63009456993493*^9, 3.630094604724292*^9}, {
   3.630094645506065*^9, 3.630094671206911*^9}, {3.6300950713827314`*^9, 
   3.6300950923929887`*^9}, {3.630095126572833*^9, 3.630095148924312*^9}, {
   3.6300952987629194`*^9, 3.630095317689753*^9}, {3.630095631618222*^9, 
   3.6300957899633107`*^9}, {3.6300960708098197`*^9, 
   3.6300960867862473`*^9}, {3.6300962273194976`*^9, 3.63009628683821*^9}, {
   3.630096394701002*^9, 3.630096400755813*^9}, {3.6300966069840384`*^9, 
   3.6300966275030746`*^9}, {3.630096752960698*^9, 3.6300968779735284`*^9}, {
   3.630096912059989*^9, 3.6300969145091934`*^9}, {3.63012458548705*^9, 
   3.6301245859862514`*^9}, {3.630171696268879*^9, 3.630171697187932*^9}, {
   3.6301721267055283`*^9, 3.630172187186988*^9}, {3.6301725465885444`*^9, 
   3.6301725574831676`*^9}, 3.6301726028587627`*^9, {3.630172639309848*^9, 
   3.630172639791875*^9}, {3.6301726869325714`*^9, 3.6301727745875854`*^9}, {
   3.630173004281803*^9, 3.6301730118478165`*^9}, 3.630173624767943*^9, {
   3.630174010129105*^9, 3.630174033250958*^9}, {3.630174068378629*^9, 
   3.6301740923886747`*^9}, {3.6301741428191967`*^9, 
   3.6301742377847843`*^9}, {3.6301743004723024`*^9, 
   3.6301743866434655`*^9}, {3.630174545460163*^9, 3.63017462231811*^9}, {
   3.6301746580413885`*^9, 3.6301748707160015`*^9}, {3.630184130800047*^9, 
   3.630184229457509*^9}, {3.6301850052789664`*^9, 3.6301850107509813`*^9}, {
   3.630201973676296*^9, 3.6302019811364107`*^9}, {3.6302020119268837`*^9, 
   3.6302020259195986`*^9}, {3.6302020865180297`*^9, 3.630202099130723*^9}, {
   3.6302062623687735`*^9, 3.630206262774374*^9}, {3.630206526945647*^9, 
   3.63020653465456*^9}, {3.630206589878859*^9, 3.630206598284174*^9}, {
   3.6302069385396786`*^9, 3.6302069408977823`*^9}, {3.6302077285487456`*^9, 
   3.630207751509098*^9}, {3.630207950034648*^9, 3.6302079508521605`*^9}, {
   3.6302528520300617`*^9, 3.630252907757249*^9}, {3.630253300900735*^9, 
   3.6302533587870464`*^9}, {3.6302533928009915`*^9, 3.630253437125527*^9}, {
   3.630253539353374*^9, 3.630253546644791*^9}, {3.6302538002332954`*^9, 
   3.63025391675496*^9}, 3.6302539719411163`*^9, {3.6302548553419456`*^9, 
   3.630254856263347*^9}, {3.63025524972278*^9, 3.6302553181907015`*^9}, {
   3.6302553846950192`*^9, 3.630255482220399*^9}, {3.630255622908106*^9, 
   3.630255771687378*^9}, 3.630255920597887*^9, {3.6302561838895245`*^9, 
   3.6302562374302197`*^9}, {3.63025627707789*^9, 3.6302562862079067`*^9}, {
   3.63027400911228*^9, 3.6302740095322804`*^9}, {3.6302760017164326`*^9, 
   3.6302760021532335`*^9}, {3.6302760803358254`*^9, 3.630276097643756*^9}, {
   3.6302779572998476`*^9, 3.630278019811158*^9}, {3.6302782118409033`*^9, 
   3.630278248205868*^9}, {3.6302789403728676`*^9, 3.630278952415489*^9}, 
   3.6302789849690466`*^9, {3.630279062704089*^9, 3.6302790721053057`*^9}, {
   3.630293787958753*^9, 3.6302938141230297`*^9}, {3.630295113013002*^9, 
   3.6302951563480787`*^9}, {3.6302953058709517`*^9, 
   3.6302953084134912`*^9}, {3.630295437321472*^9, 3.6302954415365367`*^9}, {
   3.6302955365114965`*^9, 3.630295543759108*^9}, 3.630295625172858*^9, {
   3.630295725821904*^9, 3.6302957316869946`*^9}, {3.6302958003830495`*^9, 
   3.630295817580814*^9}, 3.6302959076796975`*^9, {3.6302959991886034`*^9, 
   3.6302960013736367`*^9}, {3.630296040071731*^9, 3.6302960829273896`*^9}, {
   3.6302963683317733`*^9, 3.6302965572696753`*^9}, {3.6302967437550397`*^9, 
   3.630296785528181*^9}, {3.630297190921908*^9, 3.630297194781967*^9}, {
   3.6302973560094433`*^9, 3.630297421670452*^9}, {3.6302974957740903`*^9, 
   3.630297504921731*^9}, {3.6302975815729084`*^9, 3.630297588438014*^9}, {
   3.630297648163931*^9, 3.63029765981911*^9}, {3.6302977345252576`*^9, 
   3.63029775553808*^9}, {3.6302978060738564`*^9, 3.630297856057124*^9}, {
   3.6302979279460716`*^9, 3.6302979381762085`*^9}, {3.6302980130646505`*^9, 
   3.630298014179663*^9}, {3.630298187432942*^9, 3.630298246224647*^9}, {
   3.630298410811104*^9, 3.630298411016404*^9}, {3.630299459602931*^9, 
   3.630299468104946*^9}, {3.6302996293748393`*^9, 3.6302996671644063`*^9}, {
   3.630299758470379*^9, 3.630299770504901*^9}, {3.630325511370754*^9, 
   3.630325529185773*^9}, {3.63032947295944*^9, 3.6303295435792074`*^9}, {
   3.630329932277378*^9, 3.6303299364856186`*^9}, 3.63033040779436*^9, {
   3.630330550250988*^9, 3.6303305567702045`*^9}, {3.631825624068637*^9, 
   3.631825658439165*^9}, {3.6318257507005825`*^9, 3.6318260298298693`*^9}, {
   3.631826159996869*^9, 3.6318262041700478`*^9}, {3.631826384475317*^9, 
   3.631826396060495*^9}, {3.631826509542238*^9, 3.631826585975912*^9}, {
   3.631826637616705*^9, 3.631826670727214*^9}, {3.631826704277729*^9, 
   3.63182670760528*^9}, {3.6318268396848087`*^9, 3.6318268836604843`*^9}, {
   3.6318269391813374`*^9, 3.6318270895236464`*^9}, {3.6318273432600436`*^9, 
   3.6318274812321625`*^9}, {3.631828158368924*^9, 3.6318281754929037`*^9}, {
   3.6318285845362997`*^9, 3.6318286087286835`*^9}, {3.631828762404473*^9, 
   3.631828771986021*^9}, {3.631828840096917*^9, 3.631828866321417*^9}, {
   3.6318294994896317`*^9, 3.6318295065490355`*^9}, {3.6318296490301847`*^9, 
   3.631829659802801*^9}, {3.6318300255307198`*^9, 3.6318301388732023`*^9}, {
   3.631830194620391*^9, 3.631830228921353*^9}, {3.6318306202007327`*^9, 
   3.6318306275971556`*^9}, {3.631830978986254*^9, 3.6318311422415915`*^9}, {
   3.631831367524477*^9, 3.6318314192764373`*^9}, {3.631831451996309*^9, 
   3.631831473612545*^9}, 3.6318315143338747`*^9, {3.6318317153613725`*^9, 
   3.63183171741549*^9}, {3.6318318563964396`*^9, 3.6318318646279097`*^9}, {
   3.631832451265464*^9, 3.631832471373614*^9}, {3.6318325184543066`*^9, 
   3.631832528445878*^9}, {3.631832871047474*^9, 3.6318330583031845`*^9}, 
   3.6318331093941064`*^9, {3.6318331917598176`*^9, 3.6318332390455217`*^9}, 
   3.631833464854438*^9, {3.6318334955801954`*^9, 3.6318334980353355`*^9}, {
   3.6318335410857983`*^9, 3.6318335413018103`*^9}, {3.6318336921354375`*^9, 
   3.631833734824879*^9}, {3.631836917554921*^9, 3.631836933892855*^9}, {
   3.6318370914248657`*^9, 3.6318371186944256`*^9}, {3.631837192928671*^9, 
   3.6318372509739914`*^9}, {3.6318374289391704`*^9, 
   3.6318374350395193`*^9}, {3.6318374985801535`*^9, 
   3.6318375045954976`*^9}, {3.6318375677141075`*^9, 
   3.6318375769666367`*^9}, {3.6318406437960496`*^9, 
   3.6318406784790335`*^9}, {3.6318407656400185`*^9, 3.631840785437151*^9}, {
   3.6318409550198507`*^9, 3.631841008121888*^9}, {3.6318410848682775`*^9, 
   3.631841118450198*^9}, {3.631842017177603*^9, 3.631842021097827*^9}, {
   3.669563225736412*^9, 3.6695632328774233`*^9}, {3.6695727962541666`*^9, 
   3.66957280296255*^9}, {3.669573160323732*^9, 3.6695733097357454`*^9}, {
   3.669573543305316*^9, 3.6695735549105425`*^9}, {3.6695753844657793`*^9, 
   3.6695754468221025`*^9}, {3.669576382567544*^9, 3.669576384573659*^9}, 
   3.6695765844990935`*^9, {3.6695797133373833`*^9, 3.6695797652163506`*^9}, {
   3.669579961087554*^9, 3.6695799627676497`*^9}, 3.669694993946001*^9, {
   3.669767001915026*^9, 3.669767003877138*^9}, 
   3.669771853829398*^9},ExpressionUUID->"5d3c4916-383f-4df9-8f0d-\
5bc252b8f0ac"]
}, Closed]],

Cell[CellGroupData[{

Cell["SymmetrizeIndices", "Subsection",
 CellChangeTimes->{{3.52174375309375*^9, 3.5217437626875*^9}, {
   3.669439370764881*^9, 3.669439374298902*^9}, {3.7181131427585125`*^9, 
   3.7181131460241966`*^9}, {3.718873428731206*^9, 3.7188734353831544`*^9}, {
   3.7277791595451746`*^9, 3.7277791625376096`*^9}, {3.727779261292117*^9, 
   3.7277792645777283`*^9}, {3.8430970828593497`*^9, 3.843097090194527*^9}, {
   3.843097987499811*^9, 3.843097991491143*^9}, 3.8436019540581245`*^9, 
   3.8439584389127026`*^9},ExpressionUUID->"2f9c189e-c61f-4528-b068-\
5ee78157f7a7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   StyleBox["SymmetrizeIndices",
    FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    StyleBox["Partially",
     FontColor->RGBColor[1, 0, 1]], " ", "SymmetrizeIndices"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SymmetrizeIndices", "[", 
       RowBox[{"TargetIndices_List", ",", "t_Tensor", ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
      RowBox[{"(*", 
       RowBox[{"Check", ":", " ", 
        RowBox[{
        "All", " ", "indices", " ", "in", " ", "TargetIndices", " ", "should",
          " ", "be", " ", "included", " ", "in", " ", "Indices", " ", "list", 
         " ", "of", " ", "t"}]}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"SubsetQ", "[", 
        RowBox[{
         RowBox[{"RemoveUnderBarredIndices", "[", 
          RowBox[{"Indices", "[", "t", "]"}], "]"}], ",", "TargetIndices"}], 
        "]"}], ")"}]}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "indices", ",", "indices2", ",", "takelist", ",", "targetposition", 
         ",", "newindiceslist", ",", "m", ",", "UntouchedIdx", ",", " ", 
         "ListwithVerticleBar"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"indices2", ":", " ", 
         RowBox[{"Extract", " ", "extracting", " ", 
          StyleBox["Indices",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["list",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["preserving",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          RowBox[{
           StyleBox["UnderBar",
            FontColor->RGBColor[1, 0, 1]], ".", " ", "This"}], " ", "will", 
          " ", "be", " ", "used", " ", "at", " ", "the", " ", "end"}]}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"indices2", "=", 
         RowBox[{"Indices", "[", "t", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"indices", ":", 
           RowBox[{"Extract", " ", 
            StyleBox["Indices",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["list",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["removing",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            RowBox[{
             StyleBox["UnderBar",
              FontColor->RGBColor[1, 0, 1]], ".", " ", "Since"}], " ", 
            "UnderBar", " ", "has", " ", "no", " ", "meaning", " ", "in", " ",
             "this", " ", "operation"}]}], ",", 
          RowBox[{"we", " ", "should", " ", "remove", " ", "them", " ", 
           RowBox[{"first", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"indices", "=", 
         RowBox[{"RemoveUnderBarredIndices", "[", "indices2", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"UntouchedIdx", ":", " ", 
           RowBox[{
           "To", " ", "add", " ", "curly", " ", "bracket", " ", "and", " ", 
            "vertical", " ", "bar", " ", "in", " ", "the", " ", "output", " ",
             "indices", " ", "list"}]}], ",", " ", 
          RowBox[{"we", " ", "should", " ", "extract", " ", 
           StyleBox["those",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["indices",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["in",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["indices",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["list",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["excluded",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["from",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["TargetIndices",
             FontColor->RGBColor[1, 0, 1]], ".", " ", "We"}], " ", "use", " ",
            "Complement", " ", "to", " ", "get", " ", 
           RowBox[{"it", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"UntouchedIdx", "=", 
         RowBox[{"Complement", "[", 
          RowBox[{"indices", ",", "TargetIndices"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"targetposition", ":", " ", 
          RowBox[{
          "We", " ", "convert", " ", "TargetIndices", " ", "into", " ", "the",
            " ", "position", " ", 
           RowBox[{
            StyleBox["number",
             FontColor->RGBColor[1, 0, 1]], "."}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"targetposition", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"indices", ",", "#"}], "]"}], "&"}], "/@", 
            "TargetIndices"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"m", " ", "is", " ", "the", " ", "output", " ", 
          RowBox[{
           StyleBox["TensorComponents",
            FontColor->RGBColor[1, 0, 1]], ".", " ", "We"}], " ", "get", " ", 
          "the", " ", "symmetrized", " ", "tensor", " ", "of", " ", 
          RowBox[{"\"\<t\>\"", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Note", " ", "that", " ", "in", " ", "our", " ", "definition"}], 
          ",", " ", 
          RowBox[{"we", " ", "have", " ", "a", " ", 
           StyleBox["factorial",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["coefficient",
            FontColor->RGBColor[1, 0, 1]], " ", "difference", " ", 
           RowBox[{"w", "/", " ", 
            RowBox[{"Mathematica", "'"}]}], "s", " ", 
           RowBox[{"one", "."}]}]}], "*)"}], 
        RowBox[{"m", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "TargetIndices", "]"}], "!"}], 
           RowBox[{"Normal", "[", 
            RowBox[{"Symmetrize", "[", 
             RowBox[{
              RowBox[{"TensorComponents", "[", "t", "]"}], ",", 
              RowBox[{"Symmetric", "[", "targetposition", "]"}]}], "]"}], 
            "]"}]}], "//", 
          RowBox[{"OptionValue", "[", "SymmetrizeIndicesOperator", "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"From", " ", "here"}], ",", 
          RowBox[{
          "we", " ", "start", " ", "to", " ", "prepare", " ", "the", " ", 
           StyleBox["output",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["indices",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["list",
             FontColor->RGBColor[1, 0, 1]], "."}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Take", " ", "the", " ", "list", " ", "between", " ", "the", " ", 
          StyleBox["first",
           FontColor->RGBColor[1, 0, 1]], " ", "and", " ", "the", " ", 
          StyleBox["last",
           FontColor->RGBColor[1, 0, 1]], " ", "indices", " ", "which", " ", 
          "need", " ", "to", " ", "be", " ", 
          RowBox[{"symmetrize", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"takelist", "=", 
         RowBox[{"Take", "[", 
          RowBox[{"indices", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"First", "[", "targetposition", "]"}], ",", 
             RowBox[{"Last", "[", "targetposition", "]"}]}], "}"}]}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Extract", " ", "the", " ", "indices", " ", "which", " ", "need", 
           " ", "to", " ", "add", " ", "vertical", " ", "bars", " ", "around",
            " ", "them"}], ",", 
          RowBox[{
          "by", " ", "getting", " ", "intersection", " ", "of", " ", 
           "takelist", " ", "and", " ", "UntouchedIdx"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"ListwithVerticleBar", "=", 
         RowBox[{"takelist", "\[Intersection]", "UntouchedIdx"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         StyleBox[
          RowBox[{"Output", " ", "indices", " ", "list"}],
          FontColor->RGBColor[1, 0, 1]], "*)"}], 
        RowBox[{"newindiceslist", "=", 
         RowBox[{"indices2", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "TargetIndices", "]"}], "\[Rule]", 
             RowBox[{"Sequence", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"UnderBar", "[", "\"\<{\>\"", "]"}], "//", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"First", "[", "TargetIndices", "]"}], ")"}], 
                 "\[LeftDoubleBracket]", "0", "\[RightDoubleBracket]"}]}], 
               ",", 
               RowBox[{"First", "[", "TargetIndices", "]"}]}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Last", "[", "TargetIndices", "]"}], "\[Rule]", 
             RowBox[{"Sequence", "[", 
              RowBox[{
               RowBox[{"Last", "[", "TargetIndices", "]"}], ",", 
               RowBox[{
                RowBox[{"UnderBar", "[", "\"\<}\>\"", "]"}], "//", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"Last", "[", "TargetIndices", "]"}], ")"}], 
                 "\[LeftDoubleBracket]", "0", "\[RightDoubleBracket]"}]}]}], 
              "]"}]}], ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Rule", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"Sequence", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"UnderBar", "[", "\"\<|\>\"", "]"}], "//", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "0", 
                    "\[RightDoubleBracket]"}]}], ",", "#", ",", 
                    RowBox[{
                    RowBox[{"UnderBar", "[", "\"\<|\>\"", "]"}], "//", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "0", 
                    "\[RightDoubleBracket]"}]}]}], "]"}]}], "]"}], "&"}], "/@",
                "ListwithVerticleBar"}], ")"}]}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Change", " ", 
          StyleBox["TensorComponents",
           FontColor->RGBColor[1, 0, 1]], " ", "and", " ", 
          StyleBox["Indices",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"t", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "m"}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "idx_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "newindiceslist"}], ")"}]}]}], 
          "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    StyleBox[
     RowBox[{"Fully", " ", "SymmetrizeIndices"}],
     FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SymmetrizeIndices", "[", 
      RowBox[{"t_Tensor", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"SymmetrizeIndices", "[", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Recall", " ", 
         StyleBox["Partially",
          FontColor->RGBColor[1, 0, 1]], " ", "SymmetrizeIndices"}], ",", " ", 
        RowBox[{"but", " ", "symmetrize", " ", 
         RowBox[{"w", "/", " ", "all"}], " ", 
         RowBox[{"indices", "."}]}]}], "*)"}], 
      RowBox[{
       RowBox[{"RemoveUnderBarredIndices", "[", 
        RowBox[{"Indices", "[", "t", "]"}], "]"}], ",", "t", ",", 
       RowBox[{"SymmetrizeIndicesOperator", "\[Rule]", 
        RowBox[{"OptionValue", "[", "SymmetrizeIndicesOperator", "]"}]}]}], 
      "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.6063292322449217`*^9, 
   3.606329256638296*^9}, {3.6064974490496035`*^9, 3.6064974614663134`*^9}, 
   3.606512382622294*^9, {3.60651242556575*^9, 3.6065125215382395`*^9}, {
   3.6065125556711917`*^9, 3.606512600995784*^9}, {3.606512761984992*^9, 
   3.6065128691121197`*^9}, {3.6065129691668425`*^9, 3.606512970031892*^9}, {
   3.6065131686742535`*^9, 3.6065131898644657`*^9}, {3.6065132669168725`*^9, 
   3.606513293923417*^9}, {3.629692178653521*^9, 3.6296921823366594`*^9}, {
   3.6296927745837092`*^9, 3.6296927894092307`*^9}, {3.6296928455681496`*^9, 
   3.629692856442544*^9}, {3.6296929535388727`*^9, 3.6296929933152556`*^9}, {
   3.6296930748191504`*^9, 3.6296930871695933`*^9}, {3.6296932234826612`*^9, 
   3.6296932524307303`*^9}, {3.6296933014895077`*^9, 3.629693381002375*^9}, {
   3.6297662869445314`*^9, 3.629766315970583*^9}, {3.6298439670933137`*^9, 
   3.62984398806225*^9}, {3.6298442399943933`*^9, 3.6298442410395956`*^9}, {
   3.630042532709276*^9, 3.6300426463617764`*^9}, {3.630042703883478*^9, 
   3.6300427521936626`*^9}, {3.630042825447692*^9, 3.6300428286456976`*^9}, {
   3.630042980332965*^9, 3.6300430264254456`*^9}, {3.630043060105305*^9, 
   3.630043072949128*^9}, {3.6300941467346215`*^9, 3.6300941501305285`*^9}, {
   3.630094422824464*^9, 3.6300944485833097`*^9}, {3.6300945129192295`*^9, 
   3.6300945130596294`*^9}, {3.63009456993493*^9, 3.630094604724292*^9}, {
   3.630094645506065*^9, 3.630094671206911*^9}, {3.6300950713827314`*^9, 
   3.6300950923929887`*^9}, {3.630095126572833*^9, 3.630095148924312*^9}, {
   3.6300952987629194`*^9, 3.630095317689753*^9}, {3.630095631618222*^9, 
   3.6300957899633107`*^9}, {3.6300960708098197`*^9, 
   3.6300960867862473`*^9}, {3.6300962273194976`*^9, 3.63009628683821*^9}, {
   3.630096394701002*^9, 3.630096400755813*^9}, {3.6300966069840384`*^9, 
   3.6300966275030746`*^9}, {3.630096752960698*^9, 3.6300968779735284`*^9}, {
   3.630096912059989*^9, 3.6300969145091934`*^9}, {3.63012458548705*^9, 
   3.6301245859862514`*^9}, {3.630171696268879*^9, 3.630171697187932*^9}, {
   3.6301721267055283`*^9, 3.630172187186988*^9}, {3.6301725465885444`*^9, 
   3.6301725574831676`*^9}, 3.6301726028587627`*^9, {3.630172639309848*^9, 
   3.630172639791875*^9}, {3.6301726869325714`*^9, 3.6301727745875854`*^9}, {
   3.630173004281803*^9, 3.6301730118478165`*^9}, 3.630173624767943*^9, {
   3.630174010129105*^9, 3.630174033250958*^9}, {3.630174068378629*^9, 
   3.6301740923886747`*^9}, {3.6301741428191967`*^9, 
   3.6301742377847843`*^9}, {3.6301743004723024`*^9, 
   3.6301743866434655`*^9}, {3.630174545460163*^9, 3.63017462231811*^9}, {
   3.6301746580413885`*^9, 3.6301748707160015`*^9}, {3.630184130800047*^9, 
   3.630184229457509*^9}, {3.6301850052789664`*^9, 3.6301850107509813`*^9}, {
   3.630201973676296*^9, 3.6302019811364107`*^9}, {3.6302020119268837`*^9, 
   3.6302020259195986`*^9}, {3.6302020865180297`*^9, 3.630202099130723*^9}, {
   3.6302062623687735`*^9, 3.630206262774374*^9}, {3.630206526945647*^9, 
   3.63020653465456*^9}, {3.630206589878859*^9, 3.630206598284174*^9}, {
   3.6302069385396786`*^9, 3.6302069408977823`*^9}, {3.6302077285487456`*^9, 
   3.630207751509098*^9}, {3.630207950034648*^9, 3.6302079508521605`*^9}, {
   3.6302528520300617`*^9, 3.630252907757249*^9}, {3.630253300900735*^9, 
   3.6302533587870464`*^9}, {3.6302533928009915`*^9, 3.630253437125527*^9}, {
   3.630253539353374*^9, 3.630253546644791*^9}, {3.6302538002332954`*^9, 
   3.63025391675496*^9}, 3.6302539719411163`*^9, {3.6302548553419456`*^9, 
   3.630254856263347*^9}, {3.63025524972278*^9, 3.6302553181907015`*^9}, {
   3.6302553846950192`*^9, 3.630255482220399*^9}, {3.630255622908106*^9, 
   3.630255771687378*^9}, 3.630255920597887*^9, {3.6302561838895245`*^9, 
   3.6302562374302197`*^9}, {3.63025627707789*^9, 3.6302562862079067`*^9}, {
   3.63027400911228*^9, 3.6302740095322804`*^9}, {3.6302760017164326`*^9, 
   3.6302760021532335`*^9}, {3.6302760803358254`*^9, 3.630276097643756*^9}, {
   3.6302779572998476`*^9, 3.630278019811158*^9}, {3.6302782118409033`*^9, 
   3.630278248205868*^9}, {3.6302789403728676`*^9, 3.630278952415489*^9}, 
   3.6302789849690466`*^9, {3.630279062704089*^9, 3.6302790721053057`*^9}, {
   3.630293787958753*^9, 3.6302938141230297`*^9}, {3.630295113013002*^9, 
   3.6302951563480787`*^9}, {3.6302953058709517`*^9, 
   3.6302953084134912`*^9}, {3.630295437321472*^9, 3.6302954415365367`*^9}, {
   3.6302955365114965`*^9, 3.630295543759108*^9}, 3.630295625172858*^9, {
   3.630295725821904*^9, 3.6302957316869946`*^9}, {3.6302958003830495`*^9, 
   3.630295817580814*^9}, 3.6302959076796975`*^9, {3.6302959991886034`*^9, 
   3.6302960013736367`*^9}, {3.630296040071731*^9, 3.6302960829273896`*^9}, {
   3.6302963683317733`*^9, 3.6302965572696753`*^9}, {3.6302967437550397`*^9, 
   3.630296785528181*^9}, {3.630297190921908*^9, 3.630297194781967*^9}, {
   3.6302973560094433`*^9, 3.630297421670452*^9}, {3.6302974957740903`*^9, 
   3.630297504921731*^9}, {3.6302975815729084`*^9, 3.630297588438014*^9}, {
   3.630297648163931*^9, 3.63029765981911*^9}, {3.6302977345252576`*^9, 
   3.63029775553808*^9}, {3.6302978060738564`*^9, 3.630297856057124*^9}, {
   3.6302979279460716`*^9, 3.6302979381762085`*^9}, {3.6302980130646505`*^9, 
   3.630298014179663*^9}, {3.630298187432942*^9, 3.630298246224647*^9}, {
   3.630298410811104*^9, 3.630298411016404*^9}, {3.630299459602931*^9, 
   3.630299468104946*^9}, {3.6302996293748393`*^9, 3.6302996671644063`*^9}, {
   3.630299758470379*^9, 3.630299770504901*^9}, {3.630325511370754*^9, 
   3.630325529185773*^9}, {3.63032947295944*^9, 3.6303295435792074`*^9}, {
   3.630329932277378*^9, 3.6303299364856186`*^9}, 3.63033040779436*^9, {
   3.630330550250988*^9, 3.6303305567702045`*^9}, {3.631825624068637*^9, 
   3.631825658439165*^9}, {3.6318257507005825`*^9, 3.6318260298298693`*^9}, {
   3.631826159996869*^9, 3.6318262041700478`*^9}, {3.631826384475317*^9, 
   3.631826396060495*^9}, {3.631826509542238*^9, 3.631826585975912*^9}, {
   3.631826637616705*^9, 3.631826670727214*^9}, {3.631826704277729*^9, 
   3.63182670760528*^9}, {3.6318268396848087`*^9, 3.6318268836604843`*^9}, {
   3.6318269391813374`*^9, 3.6318270895236464`*^9}, {3.6318273432600436`*^9, 
   3.6318274812321625`*^9}, {3.631828158368924*^9, 3.6318281754929037`*^9}, {
   3.6318285845362997`*^9, 3.6318286087286835`*^9}, {3.631828762404473*^9, 
   3.631828771986021*^9}, {3.631828840096917*^9, 3.631828866321417*^9}, {
   3.6318294994896317`*^9, 3.6318295065490355`*^9}, {3.6318296490301847`*^9, 
   3.631829659802801*^9}, {3.6318300255307198`*^9, 3.6318301388732023`*^9}, {
   3.631830194620391*^9, 3.631830228921353*^9}, {3.6318306202007327`*^9, 
   3.6318306275971556`*^9}, {3.631830978986254*^9, 3.6318311422415915`*^9}, {
   3.631831367524477*^9, 3.6318314192764373`*^9}, {3.631831451996309*^9, 
   3.631831473612545*^9}, 3.6318315143338747`*^9, {3.6318317153613725`*^9, 
   3.63183171741549*^9}, {3.6318318563964396`*^9, 3.6318318646279097`*^9}, {
   3.631832451265464*^9, 3.631832471373614*^9}, {3.6318325184543066`*^9, 
   3.631832528445878*^9}, {3.631832871047474*^9, 3.6318330583031845`*^9}, 
   3.6318331093941064`*^9, {3.6318331917598176`*^9, 3.6318332390455217`*^9}, 
   3.631833464854438*^9, {3.6318334955801954`*^9, 3.6318334980353355`*^9}, {
   3.6318335410857983`*^9, 3.6318335413018103`*^9}, {3.6318336921354375`*^9, 
   3.631833734824879*^9}, {3.631836917554921*^9, 3.631836933892855*^9}, {
   3.6318370914248657`*^9, 3.6318371186944256`*^9}, {3.631837192928671*^9, 
   3.6318372509739914`*^9}, {3.6318374289391704`*^9, 
   3.6318374350395193`*^9}, {3.6318374985801535`*^9, 
   3.6318375045954976`*^9}, {3.6318375677141075`*^9, 
   3.6318375769666367`*^9}, {3.6318406437960496`*^9, 
   3.6318406784790335`*^9}, {3.6318407656400185`*^9, 3.631840785437151*^9}, {
   3.6318409550198507`*^9, 3.631841008121888*^9}, {3.6318410848682775`*^9, 
   3.631841118450198*^9}, {3.631842017177603*^9, 3.631842021097827*^9}, {
   3.669563225736412*^9, 3.6695632328774233`*^9}, {3.6695727962541666`*^9, 
   3.66957280296255*^9}, {3.669573160323732*^9, 3.6695733097357454`*^9}, {
   3.669573543305316*^9, 3.6695735549105425`*^9}, {3.6695753844657793`*^9, 
   3.6695754468221025`*^9}, {3.669576382567544*^9, 3.669576384573659*^9}, 
   3.6695765844990935`*^9, {3.6695797133373833`*^9, 3.6695797652163506`*^9}, {
   3.669579961087554*^9, 3.6695799627676497`*^9}, 3.669694993946001*^9, {
   3.669767001915026*^9, 3.669767003877138*^9}, 3.669771853829398*^9, {
   3.8435973050421762`*^9, 3.843597338632646*^9}, 3.8436007420518913`*^9, {
   3.8436014767828555`*^9, 3.843601671181758*^9}, {3.8436019366485043`*^9, 
   3.8436019566223125`*^9}, 3.8436021487185373`*^9, {3.8436027277674856`*^9, 
   3.8436027463021955`*^9}, 3.8436028384298425`*^9, {3.8448997049015245`*^9, 
   3.8448997080775747`*^9}, {3.845980585204308*^9, 3.84598061555431*^9}, {
   3.8459826007392807`*^9, 3.845982654035214*^9}, {3.8459826865194454`*^9, 
   3.8459827111990886`*^9}, {3.8459827990994005`*^9, 3.8459828601191807`*^9}, 
   3.8459832001791945`*^9, 3.8459833152190647`*^9, 3.8459833995294724`*^9, 
   3.845984243099217*^9, {3.8460212104701567`*^9, 3.8460212150138335`*^9}, {
   3.847846994630511*^9, 3.8478470032072372`*^9}, 3.847847100894129*^9, {
   3.847847407699396*^9, 3.847847448562264*^9}, {3.8478480767862444`*^9, 
   3.8478480846623993`*^9}, {3.847848221214572*^9, 3.8478482261021194`*^9}, {
   3.847969523425886*^9, 3.847969524946211*^9}, {3.854014362799085*^9, 
   3.8540143629171143`*^9}, {3.8540144240919952`*^9, 
   3.8540144376887226`*^9}, {3.8540144798360214`*^9, 3.854014632706029*^9}, {
   3.854014787983699*^9, 3.854014902996205*^9}, {3.854014935324292*^9, 
   3.854014985785879*^9}, {3.8540150240461864`*^9, 3.854015081896698*^9}, {
   3.854015991409299*^9, 3.8540160258596373`*^9}, {3.8540160882196608`*^9, 
   3.8540161941597214`*^9}, 
   3.975312217537526*^9},ExpressionUUID->"681613ce-1289-4aac-a8e3-\
82a65ac70130"]
}, Closed]],

Cell[CellGroupData[{

Cell["AntiSymmetrizeIndices", "Subsection",
 CellChangeTimes->{{3.52174375309375*^9, 3.5217437626875*^9}, {
   3.669439370764881*^9, 3.669439374298902*^9}, {3.7181131427585125`*^9, 
   3.7181131460241966`*^9}, {3.718873428731206*^9, 3.7188734353831544`*^9}, {
   3.7277791595451746`*^9, 3.7277791625376096`*^9}, {3.727779261292117*^9, 
   3.7277792645777283`*^9}, {3.8430970828593497`*^9, 3.843097090194527*^9}, {
   3.843097987499811*^9, 3.843098001371838*^9}, 
   3.8439584446783285`*^9},ExpressionUUID->"0e319148-22dc-463b-b4f2-\
1996df21df7b"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"(*", 
    StyleBox[
     StyleBox[
      RowBox[{
       StyleBox["A", "Input"], "nt", 
       StyleBox[
        StyleBox["i", "Input"], "Input",
        FontColor->RGBColor[0.5, 0, 0.5]], "SymmetrizeIndices"}]],
     FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      StyleBox["Partially",
       FontColor->RGBColor[1, 0, 1]], " ", "Anti"}], "-", 
     "SymmetrizeIndices"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"AntiSymmetrizeIndices", "[", 
        RowBox[{"TargetIndices_List", ",", "t_Tensor", ",", 
         RowBox[{"opts", ":", 
          RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
       RowBox[{"(*", 
        RowBox[{"Check", ":", " ", 
         RowBox[{
         "All", " ", "indices", " ", "in", " ", "TargetIndices", " ", 
          "should", " ", "be", " ", "included", " ", "in", " ", "Indices", 
          " ", "list", " ", "of", " ", "t"}]}], "*)"}], 
       RowBox[{"(", 
        RowBox[{"SubsetQ", "[", 
         RowBox[{
          RowBox[{"RemoveUnderBarredIndices", "[", 
           RowBox[{"Indices", "[", "t", "]"}], "]"}], ",", "TargetIndices"}], 
         "]"}], ")"}]}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "indices", ",", "indices2", ",", "takelist", ",", "targetposition", 
          ",", "newindiceslist", ",", "m", ",", "UntouchedIdx", ",", " ", 
          "ListwithVerticleBar"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"indices2", ":", " ", 
          RowBox[{"Extract", " ", "extracting", " ", 
           StyleBox["Indices",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["list",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["preserving",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["UnderBar",
             FontColor->RGBColor[1, 0, 1]], ".", " ", "This"}], " ", "will", 
           " ", "be", " ", "used", " ", "at", " ", "the", " ", "end"}]}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"indices2", "=", 
          RowBox[{"Indices", "[", "t", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"indices", ":", 
            RowBox[{"Extract", " ", 
             StyleBox["Indices",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox["list",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox["removing",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 1]], 
             RowBox[{
              StyleBox["UnderBar",
               FontColor->RGBColor[1, 0, 1]], ".", " ", "Since"}], " ", 
             "UnderBar", " ", "has", " ", "no", " ", "meaning", " ", "in", 
             " ", "this", " ", "operation"}]}], ",", 
           RowBox[{"we", " ", "should", " ", "remove", " ", "them", " ", 
            RowBox[{"first", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"indices", "=", 
          RowBox[{"RemoveUnderBarredIndices", "[", "indices2", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"UntouchedIdx", ":", " ", 
            RowBox[{
            "To", " ", "add", " ", "square", " ", "bracket", " ", "and", " ", 
             "vertical", " ", "bar", " ", "in", " ", "the", " ", "output", 
             " ", "indices", " ", "list"}]}], ",", " ", 
           RowBox[{"we", " ", "should", " ", "extract", " ", 
            StyleBox["those",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["indices",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["in",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["indices",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["list",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["excluded",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["from",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            RowBox[{
             StyleBox["TargetIndices",
              FontColor->RGBColor[1, 0, 1]], ".", " ", "We"}], " ", "use", 
            " ", "Complement", " ", "to", " ", "get", " ", 
            RowBox[{"it", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"UntouchedIdx", "=", 
          RowBox[{"Complement", "[", 
           RowBox[{"indices", ",", "TargetIndices"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"targetposition", ":", " ", 
           RowBox[{
           "We", " ", "convert", " ", "TargetIndices", " ", "into", " ", 
            "the", " ", "position", " ", 
            RowBox[{
             StyleBox["number",
              FontColor->RGBColor[1, 0, 1]], "."}]}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"targetposition", "=", 
          RowBox[{"Sort", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"indices", ",", "#"}], "]"}], "&"}], "/@", 
             "TargetIndices"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"m", " ", "is", " ", "the", " ", "output", " ", 
            RowBox[{
             StyleBox["TensorComponents",
              FontColor->RGBColor[1, 0, 1]], ".", " ", "We"}], " ", "get", 
            " ", "the", " ", "anti"}], "-", 
           RowBox[{"symmetrized", " ", "tensor", " ", "of", " ", 
            RowBox[{"\"\<t\>\"", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "Note", " ", "that", " ", "in", " ", "our", " ", "definition"}], 
           ",", " ", 
           RowBox[{"we", " ", "have", " ", "a", " ", 
            StyleBox["factorial",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["coefficient",
             FontColor->RGBColor[1, 0, 1]], " ", "difference", " ", 
            RowBox[{"w", "/", " ", 
             RowBox[{"Mathematica", "'"}]}], "s", " ", 
            RowBox[{"one", "."}]}]}], "*)"}], 
         RowBox[{"m", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "TargetIndices", "]"}], "!"}], 
            RowBox[{"Normal", "[", 
             RowBox[{"Symmetrize", "[", 
              RowBox[{
               RowBox[{"TensorComponents", "[", "t", "]"}], ",", 
               RowBox[{"Antisymmetric", "[", "targetposition", "]"}]}], "]"}],
              "]"}]}], "//", 
           RowBox[{
           "OptionValue", "[", "AntiSymmetrizeIndicesOperator", "]"}]}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"From", " ", "here"}], ",", 
           RowBox[{
           "we", " ", "start", " ", "to", " ", "prepare", " ", "the", " ", 
            StyleBox["output",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["indices",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            RowBox[{
             StyleBox["list",
              FontColor->RGBColor[1, 0, 1]], "."}]}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "Take", " ", "the", " ", "list", " ", "between", " ", "the", " ", 
            StyleBox["first",
             FontColor->RGBColor[1, 0, 1]], " ", "and", " ", "the", " ", 
            StyleBox["last",
             FontColor->RGBColor[1, 0, 1]], " ", "indices", " ", "which", " ",
             "need", " ", "to", " ", "be", " ", "anti"}], "-", 
           RowBox[{"symmetrized", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"takelist", "=", 
          RowBox[{"Take", "[", 
           RowBox[{"indices", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"First", "[", "targetposition", "]"}], ",", 
              RowBox[{"Last", "[", "targetposition", "]"}]}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "Extract", " ", "the", " ", "indices", " ", "which", " ", "need", 
            " ", "to", " ", "add", " ", "vertical", " ", "bars", " ", 
            "around", " ", "them"}], ",", 
           RowBox[{
           "by", " ", "getting", " ", "intersection", " ", "of", " ", 
            "takelist", " ", "and", " ", "UntouchedIdx"}]}], "*)"}], 
         RowBox[{"ListwithVerticleBar", "=", 
          RowBox[{"takelist", "\[Intersection]", "UntouchedIdx"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          StyleBox[
           RowBox[{"Output", " ", "indices", " ", "list"}],
           FontColor->RGBColor[1, 0, 1]], "*)"}], 
         RowBox[{"newindiceslist", "=", 
          RowBox[{"indices2", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"First", "[", "takelist", "]"}], "\[Rule]", 
              RowBox[{"Sequence", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"UnderBar", "[", "\"\<[\>\"", "]"}], "//", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"First", "[", "takelist", "]"}], ")"}], 
                  "\[LeftDoubleBracket]", "0", "\[RightDoubleBracket]"}]}], 
                ",", 
                RowBox[{"First", "[", "takelist", "]"}]}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"Last", "[", "takelist", "]"}], "\[Rule]", 
              RowBox[{"Sequence", "[", 
               RowBox[{
                RowBox[{"Last", "[", "takelist", "]"}], ",", 
                RowBox[{
                 RowBox[{"UnderBar", "[", "\"\<]\>\"", "]"}], "//", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Last", "[", "takelist", "]"}], ")"}], 
                  "\[LeftDoubleBracket]", "0", "\[RightDoubleBracket]"}]}]}], 
               "]"}]}], ",", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Rule", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"Sequence", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"UnderBar", "[", "\"\<|\>\"", "]"}], "//", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "0", 
                    "\[RightDoubleBracket]"}]}], ",", "#", ",", 
                    RowBox[{
                    RowBox[{"UnderBar", "[", "\"\<|\>\"", "]"}], "//", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "0", 
                    "\[RightDoubleBracket]"}]}]}], "]"}]}], "]"}], "&"}], "/@",
                 "ListwithVerticleBar"}], ")"}]}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Change", " ", 
           StyleBox["TensorComponents",
            FontColor->RGBColor[1, 0, 1]], " ", "and", " ", 
           StyleBox["Indices",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"t", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
             "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"TensorComponents", "\[Rule]", "m"}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Indices", "\[Rule]", "idx_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"Indices", "\[Rule]", "newindiceslist"}], ")"}]}]}], 
           "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\n", 
    RowBox[{"(*", 
     StyleBox[
      RowBox[{"Fully", "-", "AntiSymmetrizeIndices"}],
      FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"AntiSymmetrizeIndices", "[", 
       RowBox[{"t_Tensor", ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
      RowBox[{"AntiSymmetrizeIndices", "[", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Recall", " ", 
          StyleBox["Partially",
           FontColor->RGBColor[1, 0, 1]], " ", "AntiSymmetrizeIndices"}], ",",
          " ", 
         RowBox[{"but", " ", "symmetrize", " ", 
          RowBox[{"w", "/", " ", "all"}], " ", 
          RowBox[{"indices", "."}]}]}], "*)"}], 
       RowBox[{
        RowBox[{"RemoveUnderBarredIndices", "[", 
         RowBox[{"Indices", "[", "t", "]"}], "]"}], ",", "t", ",", 
        RowBox[{"AntiSymmetrizeIndicesOperator", "\[Rule]", 
         RowBox[{
         "OptionValue", "[", "AntiSymmetrizeIndicesOperator", "]"}]}]}], 
       "]"}]}], ";"}]}]}], "Input"]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.5760890361958838`*^9, 
   3.5760892921299334`*^9}, {3.576089327198795*^9, 3.5760893665108643`*^9}, {
   3.5760894467730045`*^9, 3.576089487177076*^9}, {3.576089599746874*^9, 
   3.576089794357215*^9}, {3.5760898355568876`*^9, 3.576089917379031*^9}, {
   3.576089953181094*^9, 3.576090082318121*^9}, {3.576560147053269*^9, 
   3.5765603514136276`*^9}, {3.5765603906008964`*^9, 3.576560411879334*^9}, {
   3.5765604668226304`*^9, 3.576560468913034*^9}, {3.5765932405918536`*^9, 
   3.576593241668256*^9}, {3.5765932876571364`*^9, 3.576593294365148*^9}, {
   3.576593413472658*^9, 3.5765934397421603`*^9}, {3.605905899085953*^9, 
   3.6059059169323845`*^9}, {3.605907375690477*^9, 3.605907376732993*^9}, {
   3.6059074214866805`*^9, 3.605907435022888*^9}, {3.6059074983508615`*^9, 
   3.605907502648427*^9}, {3.6059106918570814`*^9, 3.6059107179519825`*^9}, {
   3.6059108386183357`*^9, 3.605910859590658*^9}, {3.6059116367090964`*^9, 
   3.605911650068802*^9}, {3.605911842169753*^9, 3.605911895881578*^9}, {
   3.6059120020907097`*^9, 3.605912034981715*^9}, 3.6059120952461405`*^9, {
   3.605912172252824*^9, 3.605912231088728*^9}, {3.605912379985015*^9, 
   3.6059124141760397`*^9}, {3.605912547647091*^9, 3.6059125726254745`*^9}, 
   3.605912640557518*^9, {3.6059126921018095`*^9, 3.6059126993344207`*^9}, {
   3.606149316082368*^9, 3.6061493231657734`*^9}, {3.606149361203949*^9, 
   3.6061493833582163`*^9}, {3.6061495021670113`*^9, 
   3.6061496018337126`*^9}, {3.606149696681137*^9, 3.6061496971501637`*^9}, {
   3.6061497349753275`*^9, 3.6061497839071264`*^9}, {3.606149914846616*^9, 
   3.606149946487425*^9}, {3.6061501075506372`*^9, 3.6061501127199335`*^9}, {
   3.6061502607564*^9, 3.606150297869523*^9}, {3.6061503439731603`*^9, 
   3.606150399802354*^9}, {3.606150444232895*^9, 3.6061504505792575`*^9}, {
   3.6061506412691646`*^9, 3.60615079783912*^9}, {3.60615087215137*^9, 
   3.6061509190810547`*^9}, {3.6061510026398335`*^9, 
   3.6061510695636616`*^9}, {3.6061511012804756`*^9, 
   3.6061511022065287`*^9}, {3.606151174042638*^9, 3.6061511979290037`*^9}, {
   3.606151255141276*^9, 3.6061512782155957`*^9}, {3.6061517274972935`*^9, 
   3.606151749276539*^9}, {3.6061517850545855`*^9, 3.606151830330175*^9}, {
   3.606152246977006*^9, 3.6061522732695093`*^9}, 3.6061523568362894`*^9, {
   3.6061619084720783`*^9, 3.6061619096576805`*^9}, {3.606163263240858*^9, 
   3.606163263958459*^9}, {3.606163314471348*^9, 3.6061633160781507`*^9}, {
   3.606163378774661*^9, 3.606163413422322*^9}, 3.6061634632956095`*^9, {
   3.6061634941836634`*^9, 3.6061634946204643`*^9}, {3.6061635412957463`*^9, 
   3.6061636943476152`*^9}, {3.606163895151168*^9, 3.606163937037242*^9}, {
   3.6061640041329594`*^9, 3.606164018765785*^9}, {3.6061643337615385`*^9, 
   3.606164422744095*^9}, {3.6061645384026976`*^9, 3.6061645529731236`*^9}, {
   3.6061654490542974`*^9, 3.6061654690691323`*^9}, {3.6061656900123205`*^9, 
   3.6061657122579594`*^9}, {3.6061657561408367`*^9, 3.606165776280472*^9}, {
   3.6061659695336113`*^9, 3.6061659923564515`*^9}, {3.606166075114597*^9, 
   3.606166187918395*^9}, {3.6061662676657352`*^9, 3.6061662925945787`*^9}, {
   3.606166335837855*^9, 3.6061664592808714`*^9}, {3.6061665321329994`*^9, 
   3.6061665641286554`*^9}, {3.6061666252651634`*^9, 3.606166626559965*^9}, {
   3.6063210736379833`*^9, 3.6063210791355677`*^9}, 3.6063211492396445`*^9, {
   3.6063214202253075`*^9, 3.6063214618209467`*^9}, {3.606321625917968*^9, 
   3.6063216294880223`*^9}, {3.606321667340104*^9, 3.6063217452043004`*^9}, {
   3.6063218135733504`*^9, 3.6063218276655664`*^9}, {3.6063219714327755`*^9, 
   3.6063219994062057`*^9}, {3.606322158748153*^9, 3.6063222015913115`*^9}, {
   3.6063222598307066`*^9, 3.6063223402784424`*^9}, 3.606322462443319*^9, {
   3.6063226653409357`*^9, 3.6063227108891354`*^9}, {3.6063228320104966`*^9, 
   3.606322832784009*^9}, {3.6063229617499895`*^9, 3.606322969966116*^9}, {
   3.6063230880534306`*^9, 3.60632308867344*^9}, {3.606323326792098*^9, 
   3.606323351907984*^9}, {3.6063241585333757`*^9, 3.606324176213147*^9}, {
   3.6063242390986137`*^9, 3.606324282976787*^9}, {3.6063252896207523`*^9, 
   3.606325335455456*^9}, {3.606325382408677*^9, 3.6063254796761713`*^9}, 
   3.6063255205958004`*^9, {3.6063256422796693`*^9, 3.6063256443697014`*^9}, {
   3.6063257654995623`*^9, 3.6063257718131595`*^9}, {3.6063259134153347`*^9, 
   3.6063259413512635`*^9}, {3.6063641741698074`*^9, 3.606364192141835*^9}, {
   3.6063962921905727`*^9, 3.606396292923774*^9}, {3.606397566017028*^9, 
   3.606397636689613*^9}, {3.6063987641059313`*^9, 3.6063987870742846`*^9}, {
   3.6063993176404343`*^9, 3.6063993563175287`*^9}, 3.606399599800769*^9, {
   3.6063996475075016`*^9, 3.6063996743244133`*^9}, {3.606400359189934*^9, 
   3.606400359405937*^9}, {3.6064147318617353`*^9, 3.606414780243503*^9}, {
   3.606414942771799*^9, 3.606414968356262*^9}, {3.606415002285203*^9, 
   3.6064150066924553`*^9}, {3.606415050503961*^9, 3.6064150561282825`*^9}, {
   3.60641510398302*^9, 3.606415107171202*^9}, {3.606415149653632*^9, 
   3.606415271963628*^9}, {3.606415318698301*^9, 3.6064153496960735`*^9}, {
   3.606415439297199*^9, 3.6064154439654655`*^9}, {3.6064155734418716`*^9, 
   3.606415614767235*^9}, {3.606416011403921*^9, 3.6064160367773724`*^9}, {
   3.6064160876492825`*^9, 3.606416106172342*^9}, {3.6064161413863564`*^9, 
   3.606416153926073*^9}, {3.606416201531796*^9, 3.6064162124114184`*^9}, {
   3.6064164226034403`*^9, 3.6064164262046466`*^9}, {3.606416461872687*^9, 
   3.606416519591988*^9}, {3.606416656556822*^9, 3.6064166609770746`*^9}, {
   3.6064168185180855`*^9, 3.6064168709460845`*^9}, {3.606416957848055*^9, 
   3.606416979023266*^9}, {3.6064171656359396`*^9, 3.606417188828266*^9}, {
   3.606417281174548*^9, 3.606417326051115*^9}, {3.6064173998823376`*^9, 
   3.606417433523262*^9}, {3.606417467458203*^9, 3.606417500314082*^9}, {
   3.606417563021669*^9, 3.606417603650993*^9}, {3.60641768716877*^9, 
   3.6064176935111322`*^9}, {3.6064177622060614`*^9, 
   3.6064178086767197`*^9}, {3.6064178503651037`*^9, 3.606417878485712*^9}, {
   3.6064179976875305`*^9, 3.6064180039158864`*^9}, {3.606418123197709*^9, 
   3.606418125106818*^9}, {3.6064182368102074`*^9, 3.606418260005534*^9}, {
   3.6064183038340406`*^9, 3.606418342140232*^9}, {3.606418430367278*^9, 
   3.6064184936949005`*^9}, {3.6064185644959497`*^9, 
   3.6064185666510735`*^9}, {3.606418677719426*^9, 3.606418679805545*^9}, {
   3.606436543470795*^9, 3.6064365573235874`*^9}, {3.6064365990219727`*^9, 
   3.606436622187298*^9}, {3.606436806983867*^9, 3.6064368072418823`*^9}, {
   3.6064369956476583`*^9, 3.6064369958616705`*^9}, {3.6064371207458134`*^9, 
   3.6064371247680435`*^9}, {3.606437206666728*^9, 3.606437213891141*^9}, {
   3.6064373010921288`*^9, 3.606437333845002*^9}, {3.606437504073738*^9, 
   3.606437504289751*^9}, {3.6064379454409833`*^9, 3.606437960092821*^9}, {
   3.60643800237824*^9, 3.6064380077955494`*^9}, 3.606438145670436*^9, {
   3.606438258982917*^9, 3.6064382599669733`*^9}, {3.6064386627170095`*^9, 
   3.6064386728355875`*^9}, 3.6064387767465315`*^9, {3.6064388356599007`*^9, 
   3.606438842335283*^9}, {3.606438893568213*^9, 3.6064389037777967`*^9}, {
   3.6064390608037786`*^9, 3.606439094682716*^9}, {3.60643915822235*^9, 
   3.606439168216922*^9}, {3.60643921800677*^9, 3.6064392821324377`*^9}, {
   3.6064393296501555`*^9, 3.6064393487792497`*^9}, {3.606439485563073*^9, 
   3.6064395051461935`*^9}, {3.6064399730149536`*^9, 
   3.6064399878037996`*^9}, {3.6064400590218735`*^9, 3.606440076553876*^9}, {
   3.606440176433589*^9, 3.606440197594799*^9}, {3.6064402464825954`*^9, 
   3.606440253792013*^9}, {3.606440304795931*^9, 3.6064403077140975`*^9}, {
   3.606440524532499*^9, 3.60644052752067*^9}, {3.6064406171897984`*^9, 
   3.6064406209470134`*^9}, {3.6064407805891447`*^9, 3.606440787295528*^9}, {
   3.6064408236496077`*^9, 3.606440826737784*^9}, {3.606440856834505*^9, 
   3.606440861141752*^9}, {3.606440938633184*^9, 3.6064409772093906`*^9}, {
   3.606441053326744*^9, 3.606441106262772*^9}, 3.606444049039694*^9, 
   3.6064453186513114`*^9, {3.606445356832495*^9, 3.6064453903224106`*^9}, {
   3.6064460612407846`*^9, 3.606446065857049*^9}, {3.6064472620654683`*^9, 
   3.6064472653066535`*^9}, {3.6064473773500624`*^9, 3.60644741524823*^9}, {
   3.6064479502198286`*^9, 3.606447954931098*^9}, {3.6064484225688453`*^9, 
   3.606448439300802*^9}, {3.6064485513762126`*^9, 3.6064485981438875`*^9}, {
   3.6064491456562033`*^9, 3.606449146282239*^9}, {3.6064500206902523`*^9, 
   3.6064500424354963`*^9}, {3.6064501861307154`*^9, 
   3.6064502041757474`*^9}, {3.6064503561234384`*^9, 3.606450386525177*^9}, {
   3.606450434761936*^9, 3.606450439513208*^9}, {3.606451475026436*^9, 
   3.6064514993578277`*^9}, {3.6064516406889114`*^9, 3.606451641669967*^9}, {
   3.606451678449071*^9, 3.6064516793211207`*^9}, {3.6064517315281067`*^9, 
   3.606451759627714*^9}, {3.606451796842843*^9, 3.6064518143328433`*^9}, {
   3.6064519192058415`*^9, 3.6064519258752227`*^9}, {3.606452216699857*^9, 
   3.6064522186629696`*^9}, {3.6064522760802536`*^9, 
   3.6064522873698993`*^9}, {3.6064970666377306`*^9, 3.606497093791284*^9}, {
   3.6065038281633205`*^9, 3.606503840282014*^9}, 3.6065039166513815`*^9, {
   3.6065040202203054`*^9, 3.6065040491359596`*^9}, {3.6065040977297387`*^9, 
   3.606504108380348*^9}, {3.606504661197423*^9, 3.6065046902290745`*^9}, {
   3.6065048228917074`*^9, 3.6065048766026015`*^9}, {3.6065051618482494`*^9, 
   3.6065051665282574`*^9}, {3.6065053048849*^9, 3.6065053281289415`*^9}, {
   3.6065053664738083`*^9, 3.606505366676609*^9}, {3.6065058994799447`*^9, 
   3.606505899916745*^9}, {3.6065060448254004`*^9, 3.6065060450282*^9}, {
   3.606507180334243*^9, 3.606507190269811*^9}, {3.606507227590946*^9, 
   3.606507233061259*^9}, {3.6065075649162397`*^9, 3.60650759935421*^9}, {
   3.6065118524739714`*^9, 3.606511873380167*^9}, {3.6065119107953067`*^9, 
   3.60651192204195*^9}, {3.6065119620362377`*^9, 3.606512020667591*^9}, {
   3.6065120648481183`*^9, 3.6065120652151394`*^9}, {3.606512300743611*^9, 
   3.6065123180115986`*^9}, {3.606513025830083*^9, 3.60651306913056*^9}, {
   3.6065131466389933`*^9, 3.60651315585252*^9}, 3.606514109189048*^9, {
   3.6065143855958576`*^9, 3.6065143962424664`*^9}, {3.6065144404339943`*^9, 
   3.606514443546172*^9}, {3.606514516508345*^9, 3.606514606479491*^9}, {
   3.606514642402546*^9, 3.606514647298826*^9}, {3.60657601305414*^9, 
   3.606576025845872*^9}, {3.6294885962975087`*^9, 3.6294885968975096`*^9}, {
   3.6294887670077477`*^9, 3.6294887811277676`*^9}, 3.629488946017998*^9, 
   3.6294889762180405`*^9, {3.6296799808714633`*^9, 3.6296800186377373`*^9}, {
   3.6296800765780973`*^9, 3.6296800878709183`*^9}, {3.6296851347661448`*^9, 
   3.6296851379193497`*^9}, {3.629685349895347*^9, 3.6296853630081725`*^9}, {
   3.629687834535861*^9, 3.6296878493575363`*^9}, {3.629687948266225*^9, 
   3.629687974576489*^9}, {3.629688037883552*^9, 3.629688063712802*^9}, {
   3.6296883160957127`*^9, 3.629688343615058*^9}, {3.629688397209632*^9, 
   3.629688550367888*^9}, {3.6296886595640845`*^9, 3.6296887226079693`*^9}, {
   3.6296888438827596`*^9, 3.629688845144821*^9}, {3.6296892354808598`*^9, 
   3.629689305209598*^9}, {3.629689337167848*^9, 3.629689419362879*^9}, {
   3.6296919656916075`*^9, 3.6296919761680284`*^9}, {3.629693840199733*^9, 
   3.629693883066039*^9}, {3.629694123954773*^9, 3.629694194523058*^9}, {
   3.6296947833640385`*^9, 3.629694888216888*^9}, {3.629694974957252*^9, 
   3.6296949794912605`*^9}, {3.629695016853715*^9, 3.629695019568119*^9}, {
   3.629695068915369*^9, 3.629695070147771*^9}, {3.629695109662041*^9, 
   3.629695114045649*^9}, {3.629695201142003*^9, 3.629695257094702*^9}, {
   3.62969537974232*^9, 3.6296954018213587`*^9}, {3.629696180423136*^9, 
   3.6296961858685455`*^9}, {3.6296963162037787`*^9, 3.629696339169019*^9}, {
   3.629696377961688*^9, 3.6296963834996977`*^9}, {3.6296965025197077`*^9, 
   3.6296965251135483`*^9}, {3.629696620824117*^9, 3.629696632212137*^9}, {
   3.629696802275838*^9, 3.6296968542465296`*^9}, {3.629696951030902*^9, 
   3.6296970408562603`*^9}, {3.6296971532200594`*^9, 
   3.6296971742090964`*^9}, {3.6296972117497625`*^9, 
   3.6296972119681635`*^9}, {3.6296983718489113`*^9, 3.629698430922616*^9}, {
   3.6297274409048233`*^9, 3.629727464498066*^9}, {3.629727549906616*^9, 
   3.629727575325061*^9}, {3.6298456915444603`*^9, 3.629845701823281*^9}, {
   3.6298466291949453`*^9, 3.629846666829425*^9}, {3.6298469219078183`*^9, 
   3.629846938961754*^9}, {3.6298479732442703`*^9, 3.629847981134386*^9}, {
   3.6298483244007435`*^9, 3.6298483318414574`*^9}, {3.6298495776124363`*^9, 
   3.6298496207215223`*^9}, {3.6298535794568644`*^9, 
   3.6298536651670313`*^9}, {3.6298565207288785`*^9, 3.629856553513338*^9}, {
   3.629856638479088*^9, 3.629856659976926*^9}, {3.629857007221711*^9, 
   3.629857185623915*^9}, {3.629857221652976*^9, 3.6298572354907675`*^9}, {
   3.6298578357671013`*^9, 3.629857837127179*^9}, {3.6298579337247043`*^9, 
   3.6298579347447624`*^9}, {3.6298583272482123`*^9, 3.629858336241727*^9}, {
   3.62985863141861*^9, 3.629858633529731*^9}, {3.6298587849903936`*^9, 
   3.629858787928562*^9}, {3.6298588330311413`*^9, 3.629858860998741*^9}, {
   3.6298589360020313`*^9, 3.6298589428714237`*^9}, {3.629858986492919*^9, 
   3.6298589905491514`*^9}, 3.6298590768890896`*^9, {3.6298591288600616`*^9, 
   3.629859140505728*^9}, {3.6298591782148848`*^9, 3.6298591787819176`*^9}, {
   3.6298602983039503`*^9, 3.6298603530510817`*^9}, {3.6298662871976805`*^9, 
   3.6298662977812347`*^9}, {3.6298663995469913`*^9, 
   3.6298664025379076`*^9}, {3.629867805946912*^9, 3.629867863096182*^9}, {
   3.629867907431799*^9, 3.6298679076657996`*^9}, {3.629867938097679*^9, 
   3.629867942122688*^9}, {3.629909176889841*^9, 3.6299091975004773`*^9}, 
   3.629913789766417*^9, {3.6299138340045967`*^9, 3.62991395336893*^9}, {
   3.6299140417827883`*^9, 3.62991407057073*^9}, {3.629914105261263*^9, 
   3.6299141170914445`*^9}, {3.62991463043447*^9, 3.629914631089671*^9}, {
   3.6299146885963717`*^9, 3.6299146937131815`*^9}, {3.629915088830967*^9, 
   3.6299153407597475`*^9}, {3.6299158092601366`*^9, 
   3.6299158115221405`*^9}, {3.629915927193079*^9, 3.62991594200121*^9}, {
   3.629915992793312*^9, 3.629916008839244*^9}, {3.6299175161541896`*^9, 
   3.629917520155297*^9}, {3.8352604732219753`*^9, 3.8352604820549183`*^9}, {
   3.8352605560487156`*^9, 3.8352605661361046`*^9}, {3.8352606134635315`*^9, 
   3.835260705039947*^9}, {3.835260944287466*^9, 3.835260981278107*^9}, {
   3.8352648500877113`*^9, 3.835264945400612*^9}, 3.835265138891713*^9, 
   3.835265250326704*^9, {3.8352654302317057`*^9, 3.835265468734707*^9}, {
   3.8352655060487137`*^9, 3.8352655385707192`*^9}, 3.8352655851567087`*^9, {
   3.8352656489007072`*^9, 3.8352656525567055`*^9}, {3.835265786824703*^9, 
   3.835265797340705*^9}, {3.8352658960417137`*^9, 3.835265912952714*^9}, {
   3.8358344604663134`*^9, 3.8358345415951815`*^9}, {3.835834660938274*^9, 
   3.8358346826122007`*^9}, 3.8358347516523027`*^9, {3.8358347824806023`*^9, 
   3.8358347897211666`*^9}, {3.835835027221261*^9, 3.83583504546306*^9}, 
   3.8358355241242986`*^9, {3.8358537209622617`*^9, 3.8358537218619366`*^9}, {
   3.835853860567198*^9, 3.8358538736692047`*^9}, {3.835853980327199*^9, 
   3.835854096390462*^9}, {3.835854154295315*^9, 3.8358542191043854`*^9}, 
   3.8358543188331223`*^9, 3.8358544858413568`*^9, {3.8358545448720794`*^9, 
   3.835854618507143*^9}, 3.835854670120367*^9, {3.8358550024069624`*^9, 
   3.8358550347031765`*^9}, {3.835855071842867*^9, 3.8358550737479362`*^9}, {
   3.8358554434619637`*^9, 3.835855447220962*^9}, {3.8358554908449535`*^9, 
   3.835855547995963*^9}, {3.8358555928489633`*^9, 3.8358556857759504`*^9}, 
   3.8358608694734063`*^9, {3.835861218022401*^9, 3.835861222666402*^9}, 
   3.8359204809663844`*^9, {3.835922515828598*^9, 3.8359225278335958`*^9}, {
   3.835922952245639*^9, 3.835922965302247*^9}, {3.8359229990234833`*^9, 
   3.835923000831025*^9}, {3.836445921150355*^9, 3.836445927413431*^9}, {
   3.8365264813084908`*^9, 3.836526505542826*^9}, {3.8365274865371704`*^9, 
   3.8365274874911737`*^9}, {3.8374039957093225`*^9, 3.837404033976358*^9}, {
   3.8374042086242533`*^9, 3.8374042355055265`*^9}, {3.8374043572113156`*^9, 
   3.8374043831501446`*^9}, {3.837404437456546*^9, 3.8374044624903917`*^9}, {
   3.83740449461442*^9, 3.8374045284836416`*^9}, {3.8374295136883783`*^9, 
   3.837429532989379*^9}, {3.837429592547739*^9, 3.837429623021738*^9}, {
   3.837429748577462*^9, 3.83742977871146*^9}, {3.8376093050331783`*^9, 
   3.837609322988505*^9}, {3.8376402802354355`*^9, 3.8376402992055955`*^9}, {
   3.8376420561552305`*^9, 3.837642073760215*^9}, {3.8376519822422276`*^9, 
   3.837652028610064*^9}, {3.837652062236641*^9, 3.837652085651631*^9}, {
   3.8381944240614862`*^9, 3.8381944631469693`*^9}, {3.8381945747683415`*^9, 
   3.8381945762084007`*^9}, {3.8381946413935595`*^9, 
   3.8381946436989913`*^9}, {3.838194687583386*^9, 3.838194700899796*^9}, {
   3.838194779023388*^9, 3.8381948081002626`*^9}, {3.838194905251423*^9, 
   3.838194956058038*^9}, {3.838194986065569*^9, 3.8381949953028364`*^9}, {
   3.8381950899579177`*^9, 3.8381950995470543`*^9}, {3.838195158198583*^9, 
   3.838195174793747*^9}, {3.8381952508727427`*^9, 3.8381952736796026`*^9}, {
   3.8381953500940866`*^9, 3.8381953820097623`*^9}, {3.838195468501559*^9, 
   3.8381954918887043`*^9}, {3.8381955357781076`*^9, 
   3.8381955716109304`*^9}, {3.8381956070075502`*^9, 
   3.8381956350348434`*^9}, {3.8381957049801264`*^9, 3.83819570533545*^9}, {
   3.838195738157835*^9, 3.8381957473195305`*^9}, {3.8454271998063774`*^9, 
   3.845427204004798*^9}, {3.845429990901543*^9, 3.8454299920938115`*^9}, {
   3.845982899361779*^9, 3.845982927289239*^9}, {3.8459831679594984`*^9, 
   3.845983185179139*^9}, {3.8459832968401794`*^9, 3.8459833060193915`*^9}, 
   3.845983407619465*^9, 3.8459842644895077`*^9, {3.846021076440152*^9, 
   3.8460211206792006`*^9}, {3.8478469977515926`*^9, 
   3.8478470002060823`*^9}, {3.8478470851269865`*^9, 
   3.8478470894961386`*^9}, {3.8478474225292745`*^9, 
   3.8478474245540285`*^9}, {3.8478474578686028`*^9, 
   3.8478474618421574`*^9}, {3.8478480892495775`*^9, 
   3.8478480915911374`*^9}, {3.847848243008292*^9, 3.8478482446632752`*^9}, {
   3.8479695062912054`*^9, 3.847969508511413*^9}, {3.854014311459194*^9, 
   3.8540143245691485`*^9}, {3.8540150694535074`*^9, 
   3.8540150762160463`*^9}, {3.8540162737395105`*^9, 3.854016377059682*^9}, {
   3.854016516649788*^9, 3.854016525809317*^9}, {3.85401657170969*^9, 
   3.8540166137997637`*^9}, {3.9753123199615383`*^9, 
   3.9753123205675573`*^9}},ExpressionUUID->"f5045f13-e32e-4ccc-936b-\
6d56dd261ef9"]
}, Closed]],

Cell[CellGroupData[{

Cell["PartialD", "Subsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.533880012946951*^9, 3.5338800148345547`*^9}, {
   3.5760890087086353`*^9, 3.5760890111890397`*^9}, {3.6061493485872273`*^9, 
   3.6061493494062743`*^9}, {3.6299087800753407`*^9, 
   3.6299087836165466`*^9}},ExpressionUUID->"50ec6023-e205-4e05-b069-\
65396b86e78d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Partial", " ", "derivative", " ", "on", " ", "a", " ", 
    RowBox[{"scalar", ":", " ", 
     RowBox[{
      StyleBox[
       RowBox[{
        SubscriptBox["\[Del]", "\[Mu]"], "stuff"}],
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox[" ",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox["or",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox[" ",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      RowBox[{
       SuperscriptBox[
        StyleBox["\[Del]",
         FontColor->RGBColor[0.5, 0, 0.5]], 
        StyleBox["\[Mu]",
         FontColor->RGBColor[0.5, 0, 0.5]]], 
       StyleBox["stuff",
        FontColor->RGBColor[0.5, 0, 0.5]]}], " ", "using", " ", "the", " ", 
      "metric", " ", "m"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"scalar", ",", " ", 
    RowBox[{"Same", " ", "as", " ", "CovariantD"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"PartialD", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"(*", 
          RowBox[{"Not", " ", "allow", " ", "OverHatIndices", " ", "for", " ", 
           RowBox[{"now", "."}]}], "*)"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TestIndices", "[", "\[Mu]T", "]"}], "&&", 
           RowBox[{"!", 
            RowBox[{"TestOverHatIndex", "[", "\[Mu]T", "]"}]}]}], ")"}]}], 
        ",", "stuff_", ",", "m_Tensor"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"(*", 
        RowBox[{"Scalar", " ", 
         StyleBox["Tensor",
          FontColor->RGBColor[1, 0, 1]], 
         StyleBox[" ",
          FontColor->RGBColor[1, 0, 1]], 
         StyleBox["Form",
          FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestScalarTensor", "[", "stuff", "]"}], "||", 
          RowBox[{"(*", 
           RowBox[{"Scalar", " ", 
            StyleBox["Expression",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["Form",
             FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
          RowBox[{"(*", "TestExpressionForm", "*)"}], 
          RowBox[{"TestExpressionForm", "[", "stuff", "]"}]}], ")"}], "&&", 
        RowBox[{"(*", 
         RowBox[{"m", " ", "is", " ", "a", " ", "Metric"}], "*)"}], 
        RowBox[{"(", 
         RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}]}], ")"}]}], ":=", 
     RowBox[{"(*", 
      RowBox[{"Recall", " ", 
       StyleBox["CovariantD",
        FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
     RowBox[{"CovariantD", "[", 
      RowBox[{"\[Mu]T", ",", "stuff", ",", "m"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"PartialD", " ", "on", " ", "a", " ", 
     StyleBox["scalar",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[
      RowBox[{"(", 
       RowBox[{"as", " ", "a", " ", "expression", " ", "form"}], ")"}],
      FontColor->RGBColor[0.5, 0, 0.5]], " ", "with", " ", "given", " ", 
     StyleBox["coordinates",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     RowBox[{
      StyleBox["list",
       FontColor->RGBColor[0.5, 0, 0.5]], "."}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PartialD", "[", 
      RowBox[{
       RowBox[{"\[Mu]T_", "/;", 
        RowBox[{"(*", 
         RowBox[{"Not", " ", "allow", " ", "OverHatIndices", " ", "for", " ", 
          RowBox[{"now", "."}]}], "*)"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestIndices", "[", "\[Mu]T", "]"}], "&&", 
          RowBox[{"!", 
           RowBox[{"TestOverHatIndex", "[", "\[Mu]T", "]"}]}]}], ")"}]}], ",",
        "stuff_", ",", 
       RowBox[{"Coordinates", "\[Rule]", "coords_List"}]}], "]"}], "/;", 
     RowBox[{"(*", 
      RowBox[{"Scalar", " ", 
       StyleBox["Expression",
        FontColor->RGBColor[1, 0, 1]], 
       StyleBox[" ",
        FontColor->RGBColor[1, 0, 1]], 
       StyleBox["Form",
        FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
     RowBox[{"TestExpressionForm", "[", "stuff", "]"}]}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Recall", " ", "by", " ", 
      "\"\<PartialD for \!\(\*StyleBox[\"downstair\",FontColor->RGBColor[1, \
0, 1]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[1, 0, \
1]]\)\!\(\*StyleBox[\"on\",FontColor->RGBColor[1, 0, 1]]\)\!\(\*StyleBox[\" \
\",FontColor->RGBColor[1, 0, \
1]]\)\!\(\*StyleBox[\"Tensor\",FontColor->RGBColor[1, 0, 1]]\)\!\(\*StyleBox[\
\" \",FontColor->RGBColor[1, 0, \
1]]\)\!\(\*StyleBox[\"w\",FontColor->RGBColor[1, 0, \
1]]\)\!\(\*StyleBox[\"/\",FontColor->RGBColor[1, 0, \
1]]\)\!\(\*StyleBox[\"o\",FontColor->RGBColor[1, 0, 1]]\)\!\(\*StyleBox[\" \
\",FontColor->RGBColor[1, 0, \
1]]\)\!\(\*StyleBox[\"third\",FontColor->RGBColor[1, 0, \
1]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[1, 0, \
1]]\)\!\(\*StyleBox[\"argument\",FontColor->RGBColor[1, 0, 1]]\)\>\"", " ", 
      RowBox[{"code", "."}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"PartialD", "[", 
     RowBox[{"\[Mu]T", ",", 
      RowBox[{"(*", 
       RowBox[{"Declare", " ", "a", " ", 
        StyleBox["new",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["Tensor",
         FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
      RowBox[{"NonMetricTensor", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", "stuff", ",", "stuff", ",", 
        RowBox[{"Coordinates", "\[Rule]", "coords"}]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Note", " ", 
     RowBox[{"III", ".", " ", "Internally"}], " ", "we", " ", "build", " ", 
     "the", " ", "PartialD", " ", "as", " ", "a", " ", "Tensor", " ", "with", 
     " ", "abstract", " ", "indices", " ", "then", " ", "replace", " ", "the",
      " ", 
     RowBox[{"\[PartialD]", 
      RowBox[{"-", "index"}]}], " ", "with", " ", "\[Mu]T"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"PartialD", " ", "for", " ", 
     StyleBox["downstair",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox["on",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox["Tensor",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[
      RowBox[{"w", "/", "o"}],
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox["the",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox["third",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox["argument",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[
      RowBox[{"(", "metric", ")"}],
      FontColor->RGBColor[0.5, 0, 0.5]]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"PartialD", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"(*", 
          RowBox[{"Not", " ", "allow", " ", "OverHatIndices", " ", "for", " ", 
           RowBox[{"now", "."}]}], "*)"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TestIndices", "[", "\[Mu]T", "]"}], "&&", 
           RowBox[{"!", 
            RowBox[{"TestOverHatIndex", "[", "\[Mu]T", "]"}]}]}], ")"}]}], 
        ",", "\[Tau]T_Tensor"}], "]"}], "/;", 
      RowBox[{"(*", 
       RowBox[{
       "Notice", " ", "that", " ", "now", " ", "we", " ", "accept", " ", "a", 
        " ", "scalar", " ", "or", " ", "tensor", " ", "as", " ", "Tensor", 
        " ", 
        RowBox[{"object", ".", " ", "There"}], " ", "is", " ", 
        StyleBox["no",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["scalar",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["check",
         FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
      RowBox[{"MatchQ", "[", 
       RowBox[{"\[Mu]T", ",", 
        RowBox[{"SubMinus", "[", "_", "]"}]}], "]"}]}], 
     RowBox[{"(*", 
      RowBox[{"Check", " ", "for", " ", 
       StyleBox["downstair",
        FontColor->RGBColor[1, 0, 1]]}], "*)"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coords", ",", "\[Mu]TT", ",", "grad", ",", "\[Mu]", ",", "\[Nu]", 
         ",", "\[Sigma]", ",", "\[Lambda]", ",", "\[Kappa]", ",", "lgth", ",",
          "si", ",", "ii", ",", "invmetricM", ",", "\[CapitalSigma]", ",", 
         "indices", ",", "TensorMatrix", ",", "ChristT", ",", "partialT", ",",
          "output", ",", "out", ",", "outputindices", ",", 
         "FinalTensorType"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         StyleBox["output",
          FontColor->RGBColor[1, 0, 1]], " ", "Tensor", " ", "has", " ", 
         "the", " ", "following", " ", 
         StyleBox["indices",
          FontColor->RGBColor[1, 0, 1]]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"outputindices", "=", 
         RowBox[{"{", 
          RowBox[{"\[Mu]T", ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"Indices", "[", "\[Tau]T", "]"}]}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", 
          StyleBox["coordinates",
           FontColor->RGBColor[1, 0, 1]]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"coords", "=", 
         RowBox[{"Coordinates", "[", "\[Tau]T", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         StyleBox["Dimension",
          FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"lgth", "=", 
         RowBox[{"Length", "[", "coords", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", 
          StyleBox["StartIndex",
           FontColor->RGBColor[1, 0, 1]]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"si", "=", 
         RowBox[{"StartIndex", "[", "\[Tau]T", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", 
          StyleBox["indices",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["of",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["\[Tau]T",
           FontColor->RGBColor[1, 0, 1]]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"indices", "=", 
         RowBox[{"Indices", "[", "\[Tau]T", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", 
          StyleBox["components",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["of",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[
           RowBox[{"\[PartialD]", 
            RowBox[{"(", "\[Tau]T", ")"}]}],
           FontColor->RGBColor[1, 0, 1]], " ", "as", " ", "a", " ", 
          StyleBox["matrix",
           FontColor->RGBColor[1, 0, 1]]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"TensorComponents", "[", 
            RowBox[{"(*", 
             RowBox[{"Recall", " ", 
              RowBox[{
              "\"\<\!\(\*StyleBox[\"Derivative\",FontColor->RGBColor[1, 0, \
1]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[1, 0, 1]]\)\!\(\*StyleBox[\"for\
\",FontColor->RGBColor[1, 0, 1]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[1, \
0, 1]]\)\!\(\*StyleBox[\"Tensor\",FontColor->RGBColor[1, 0, 1]]\)\>\"", 
               "."}]}], "*)"}], 
            RowBox[{"PartialD", "[", 
             RowBox[{"\[Tau]T", ",", 
              RowBox[{
              "coords", "\[LeftDoubleBracket]", "\[Sigma]", 
               "\[RightDoubleBracket]"}]}], "]"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"\[Sigma]", ",", "1", ",", "lgth"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Prepend", " ", "\[Mu]T", " ", "in", " ", "to", " ", "new", " ", 
           StyleBox["Indices",
            FontColor->RGBColor[1, 0, 1]], " ", "list"}], ",", " ", 
          RowBox[{
          "add", " ", "a", " ", "\"\<\[PartialD]\>\"", " ", "mark", " ", "in",
            " ", "front", " ", "of", " ", 
           StyleBox["TensorName",
            FontColor->RGBColor[1, 0, 1]]}], ",", " ", 
          RowBox[{"and", " ", "update", " ", "the", " ", 
           StyleBox[
            RowBox[{"TensorComponents", "."}],
            FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"\[Tau]T", "/.", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "iii_"}], ")"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", 
              RowBox[{"Prepend", "[", 
               RowBox[{"iii", ",", "\[Mu]T"}], "]"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", "nnn_"}], ")"}], 
            "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", 
              RowBox[{"\"\<\[PartialD]\>\"", "[", 
               RowBox[{"TensorName", "[", "\[Tau]T", "]"}], "]"}]}], ")"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "ccc_"}], ")"}], 
            "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "output"}], ")"}]}]}], 
          "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Partial", " ", "derivative", " ", 
     StyleBox[
      RowBox[{
       SubscriptBox["\[PartialD]", "\[Mu]"], "Tensor"}],
      FontColor->RGBColor[0.5, 0, 0.5]], " ", "using", " ", "the", " ", 
     "metric", " ", "m"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"PartialD", " ", "for", " ", 
     StyleBox["given",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox["Metric",
      FontColor->RGBColor[0.5, 0, 0.5]], " ", "or", " ", 
     StyleBox["Coordinates",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox["list",
      FontColor->RGBColor[0.5, 0, 0.5]], " ", "on", " ", "Tensor", " ", "as", 
     " ", "the", " ", "third", " ", "argument", " ", 
     RowBox[{"(", "Optional", ")"}], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        StyleBox["downstair",
         FontColor->RGBColor[0.5, 0, 0.5]], " ", 
        StyleBox["PartialD",
         FontColor->RGBColor[0.5, 0, 0.5]]}], ")"}], "."}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"PartialD", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"(*", 
          RowBox[{"Not", " ", "allow", " ", "OverHatIndices", " ", "for", " ", 
           RowBox[{"now", "."}]}], "*)"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TestIndices", "[", "\[Mu]T", "]"}], "&&", 
           RowBox[{"!", 
            RowBox[{"TestOverHatIndex", "[", "\[Mu]T", "]"}]}]}], ")"}]}], 
        ",", "\[Tau]T_Tensor", ",", 
        RowBox[{"(", 
         RowBox[{"m_Tensor", "|", 
          RowBox[{"(", 
           RowBox[{"Coordinates", "\[Rule]", "coordslist_List"}], ")"}]}], 
         ")"}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Given", " ", "m", " ", "is", " ", "a", " ", 
          StyleBox["Metric",
           FontColor->RGBColor[1, 0, 1]]}], ",", 
         StyleBox[" ",
          FontColor->RGBColor[1, 0, 1]], 
         RowBox[{"coordslist", " ", "is", " ", 
          RowBox[{"Null", "."}]}]}], "*)"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"TestMetricTensor", "[", "m", "]"}], "===", "True"}], 
             ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{"coordslist", "===", "Null"}], ")"}]}], ")"}], "||", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Given", " ", 
             StyleBox["coordslist",
              FontColor->RGBColor[1, 0, 1]]}], ",", " ", 
            RowBox[{"m", " ", "is", " ", "Null"}]}], "*)"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "===", "Null"}], ")"}], "&&", 
            RowBox[{"!", 
             RowBox[{"(", 
              RowBox[{"coordslist", "===", "Null"}], ")"}]}]}], ")"}]}], 
         ")"}], "&&", 
        RowBox[{"(*", 
         RowBox[{"\[Mu]T", " ", "is", " ", 
          StyleBox["downstair",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
        RowBox[{"MatchQ", "[", 
         RowBox[{"\[Mu]T", ",", 
          RowBox[{"SubMinus", "[", "_", "]"}]}], "]"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coords", ",", "\[Mu]TT", ",", "grad", ",", "\[Mu]", ",", "\[Nu]", 
         ",", "\[Sigma]", ",", "\[Lambda]", ",", "\[Kappa]", ",", "lgth", ",",
          "si", ",", "ii", ",", "invmetricM", ",", "\[CapitalSigma]", ",", 
         "indices", ",", "TensorMatrix", ",", "ChristT", ",", "partialT", ",",
          "output", ",", "out", ",", "outputindices", ",", 
         "FinalTensorType"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "output", " ", "Tensor", " ", "has", " ", "the", " ", "following", 
         " ", 
         StyleBox["indices",
          FontColor->RGBColor[1, 0, 1]]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"outputindices", "=", 
         RowBox[{"{", 
          RowBox[{"\[Mu]T", ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"Indices", "[", "\[Tau]T", "]"}]}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", 
          StyleBox["coordinates",
           FontColor->RGBColor[1, 0, 1]]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"m", "===", "Null"}], ",", 
          RowBox[{"coords", "=", "coordslist"}], ",", "True", ",", 
          RowBox[{"coords", "=", 
           RowBox[{"Coordinates", "[", "m", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"lgth", "=", 
         RowBox[{"Length", "[", "coords", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", 
          StyleBox["StartIndex",
           FontColor->RGBColor[1, 0, 1]]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"si", "=", 
         RowBox[{"StartIndex", "[", "\[Tau]T", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", 
          StyleBox["indices",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["of",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["\[Tau]T",
           FontColor->RGBColor[1, 0, 1]]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"indices", "=", 
         RowBox[{"Indices", "[", "\[Tau]T", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", 
          StyleBox["components",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["of",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[
           RowBox[{"\[PartialD]", 
            RowBox[{"(", "\[Tau]T", ")"}]}],
           FontColor->RGBColor[1, 0, 1]], " ", "as", " ", "a", " ", 
          StyleBox["matrix",
           FontColor->RGBColor[1, 0, 1]]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"TensorComponents", "[", 
            RowBox[{"PartialD", "[", 
             RowBox[{"\[Tau]T", ",", 
              RowBox[{
              "coords", "\[LeftDoubleBracket]", "\[Sigma]", 
               "\[RightDoubleBracket]"}]}], "]"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"\[Sigma]", ",", "1", ",", "lgth"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Prepend", " ", "\[Mu]T", " ", "in", " ", "to", " ", "new", " ", 
           StyleBox["Indices",
            FontColor->RGBColor[1, 0, 1]], " ", "list"}], ",", " ", 
          RowBox[{
          "add", " ", "a", " ", "\"\<\[PartialD]\>\"", " ", "mark", " ", "in",
            " ", "front", " ", "of", " ", 
           StyleBox["TensorName",
            FontColor->RGBColor[1, 0, 1]]}], ",", " ", 
          RowBox[{"and", " ", "update", " ", "the", " ", 
           StyleBox[
            RowBox[{"TensorComponents", "."}],
            FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"\[Tau]T", "/.", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "iii_"}], ")"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", 
              RowBox[{"Prepend", "[", 
               RowBox[{"iii", ",", "\[Mu]T"}], "]"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", "nnn_"}], ")"}], 
            "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", 
              RowBox[{"\"\<\[PartialD]\>\"", "[", 
               RowBox[{"TensorName", "[", "\[Tau]T", "]"}], "]"}]}], ")"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "ccc_"}], ")"}], 
            "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "output"}], ")"}]}]}], 
          "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Covariant", " ", "derivative", " ", 
     StyleBox[
      RowBox[{
       SuperscriptBox["\[PartialD]", "\[Mu]"], "Tensor"}],
      FontColor->RGBColor[0.5, 0, 0.5]], " ", "using", " ", "the", " ", 
     StyleBox["metric",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox["m",
      FontColor->RGBColor[0.5, 0, 0.5]], " ", 
     RowBox[{"(", 
      StyleBox[
       RowBox[{"upper", " ", "index"}],
       FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"PartialD", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"(*", 
          RowBox[{"Not", " ", "allow", " ", "OverHatIndices", " ", "for", " ", 
           RowBox[{"now", "."}]}], "*)"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TestIndices", "[", "\[Mu]T", "]"}], "&&", 
           RowBox[{"!", 
            RowBox[{"TestOverHatIndex", "[", "\[Mu]T", "]"}]}]}], ")"}]}], 
        ",", "\[Tau]T_Tensor", ",", "m_Tensor"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "We", " ", "have", " ", "already", " ", "dealt", " ", "with", " ", 
          "scalars"}], ",", " ", 
         RowBox[{"to", " ", "not", " ", "conflict", " ", 
          RowBox[{"w", "/", " ", "previous"}], " ", 
          RowBox[{"code", ".", " ", "Check"}], " ", "\[Tau]T", " ", "is", " ", 
          StyleBox["not",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["a",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["scalar",
           FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"!", 
          RowBox[{"TestScalarTensor", "[", "\[Tau]T", "]"}]}], ")"}], "&&", 
        RowBox[{"(*", " ", 
         RowBox[{"check", " ", "m", " ", "is", " ", "a", " ", 
          StyleBox["Metric",
           FontColor->RGBColor[1, 0, 1]]}], " ", "*)"}], 
        RowBox[{"(", 
         RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}], "&&", 
        RowBox[{"(*", 
         StyleBox[
          RowBox[{"upper", " ", "index"}],
          FontColor->RGBColor[1, 0, 1]], "*)"}], 
        RowBox[{"MatchQ", "[", 
         RowBox[{"\[Mu]T", ",", 
          RowBox[{"SuperMinus", "[", "_", "]"}]}], "]"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Sigma]", ",", "\[Mu]TT", ",", "tempT", ",", "FinalTensorType"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tempT", "=", 
         RowBox[{"PartialD", "[", 
          RowBox[{
           SubscriptBox["\[Sigma]", "-"], ",", "\[Tau]T", ",", "m"}], "]"}]}],
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"\[Tau]T", "/.", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "Prepend", " ", "\[Mu]T", " ", "in", " ", "to", " ", "new", " ", 
             StyleBox["Indices",
              FontColor->RGBColor[1, 0, 1]], " ", "list"}], ",", " ", 
            RowBox[{
            "add", " ", "a", " ", "\"\<\[PartialD]\>\"", " ", "mark", " ", 
             "in", " ", "front", " ", "of", " ", 
             StyleBox["TensorName",
              FontColor->RGBColor[1, 0, 1]]}], ",", " ", 
            RowBox[{"and", " ", "update", " ", "the", " ", 
             StyleBox[
              RowBox[{"TensorComponents", "."}],
              FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "iii_"}], ")"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", 
              RowBox[{"Prepend", "[", 
               RowBox[{"iii", ",", "\[Mu]T"}], "]"}]}], ")"}]}], ",", 
           RowBox[{"(*", 
            RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", "nnn_"}], ")"}], 
            "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", 
              RowBox[{"\"\<\[PartialD]\>\"", "[", 
               RowBox[{"TensorName", "[", "\[Tau]T", "]"}], "]"}]}], ")"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "ccc_"}], ")"}], 
            "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", 
              RowBox[{"TensorContract", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"(*", 
                  StyleBox[
                   RowBox[{"Matrix", " ", "multiplication", " ", 
                    RowBox[{"w", "/", " ", "inverse"}], " ", "metric"}],
                   FontColor->RGBColor[1, 0, 1]], "*)"}], 
                 RowBox[{
                  RowBox[{"TensorComponents", "[", 
                   RowBox[{"Metric", "[", 
                    RowBox[{
                    SuperscriptBox["\[Mu]TT", "-"], ",", 
                    SuperscriptBox["\[Sigma]", "-"], ",", "m"}], "]"}], "]"}],
                   ",", 
                  RowBox[{"TensorComponents", "[", "tempT", "]"}]}], "]"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", "3"}], "}"}], "}"}]}], "]"}]}], ")"}]}]}],
           "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "This", " ", "allow", " ", "us", " ", "not", " ", "to", " ", 
      "derivative", " ", 
      RowBox[{"w", "/", " ", 
       RowBox[{"coord", ".", " ", "list", ".", " ", "For"}]}], " ", 
      RowBox[{"e", ".", "g", "."}]}], ",", " ", 
     RowBox[{"if", " ", "the", " ", 
      RowBox[{"coord", ".", " ", "list"}], " ", "is", " ", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ",", " ", 
     RowBox[{"we", " ", "can", " ", 
      StyleBox["derivative",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox[" ",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox[
       RowBox[{"w", ".", "r", ".", "t"}],
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox[" ",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox[
       RowBox[{"{", 
        RowBox[{
         OverscriptBox["x", "."], ",", 
         OverscriptBox["y", "."], ",", 
         OverscriptBox["z", "."]}], "}"}],
       FontColor->RGBColor[0.5, 0, 0.5]], " ", "by", " ", "inputting", " ", 
      "as", " ", "the", " ", "third", " ", 
      RowBox[{"argument", ".", " ", "Right"}], " ", "now", " ", 
      RowBox[{"it", "'"}], "s", " ", "supposed", " ", "not", " ", "to", " ", 
      "be", " ", "a", " ", "offical", " ", 
      RowBox[{"code", ".", " ", "So"}], " ", "I", " ", "named", " ", "it", 
      " ", "as", " ", 
      StyleBox[
       RowBox[{"PartialDWeiHao", "."}],
       FontColor->RGBColor[0.5, 0, 0.5]]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"PartialDWeiHao", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TestIndices", "[", "\[Mu]T", "]"}], "&&", 
           RowBox[{"!", 
            RowBox[{"TestOverHatIndex", "[", "\[Mu]T", "]"}]}]}], ")"}]}], 
        ",", "\[Tau]T_Tensor", ",", "Dlist_List"}], "]"}], "/;", 
      RowBox[{"MatchQ", "[", 
       RowBox[{"\[Mu]T", ",", 
        RowBox[{"SubMinus", "[", "_", "]"}]}], "]"}]}], 
     RowBox[{"(*", 
      RowBox[{"Check", " ", "for", " ", 
       StyleBox["downstair",
        FontColor->RGBColor[1, 0, 1]]}], "*)"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coords", ",", "\[Mu]TT", ",", "grad", ",", "\[Mu]", ",", "\[Nu]", 
         ",", "\[Sigma]", ",", "\[Lambda]", ",", "\[Kappa]", ",", "lgth", ",",
          "si", ",", "ii", ",", "invmetricM", ",", "\[CapitalSigma]", ",", 
         "indices", ",", "TensorMatrix", ",", "ChristT", ",", "partialT", ",",
          "output", ",", "out", ",", "outputindices", ",", 
         "FinalTensorType"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         StyleBox["output",
          FontColor->RGBColor[1, 0, 1]], " ", "Tensor", " ", "has", " ", 
         "the", " ", "following", " ", 
         StyleBox["indices",
          FontColor->RGBColor[1, 0, 1]]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"outputindices", "=", 
         RowBox[{"{", 
          RowBox[{"\[Mu]T", ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"Indices", "[", "\[Tau]T", "]"}]}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", 
          StyleBox["coordinates",
           FontColor->RGBColor[1, 0, 1]]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"coords", "=", 
         RowBox[{"Coordinates", "[", "\[Tau]T", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"lgth", "=", 
         RowBox[{"Length", "[", "coords", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", 
          StyleBox["StartIndex",
           FontColor->RGBColor[1, 0, 1]]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"si", "=", 
         RowBox[{"StartIndex", "[", "\[Tau]T", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", 
          StyleBox["indices",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["of",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["\[Tau]T",
           FontColor->RGBColor[1, 0, 1]]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"indices", "=", 
         RowBox[{"Indices", "[", "\[Tau]T", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", 
          StyleBox["components",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["of",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[
           RowBox[{"\[PartialD]", 
            RowBox[{"(", "\[Tau]T", ")"}]}],
           FontColor->RGBColor[1, 0, 1]], " ", "as", " ", "a", " ", 
          "matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"TensorComponents", "[", 
            RowBox[{"(*", 
             RowBox[{"Recall", " ", 
              RowBox[{
              "\"\<\!\(\*StyleBox[\"Derivative\",FontColor->RGBColor[1, 0, \
1]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[1, 0, 1]]\)\!\(\*StyleBox[\"for\
\",FontColor->RGBColor[1, 0, 1]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[1, \
0, 1]]\)\!\(\*StyleBox[\"Tensor\",FontColor->RGBColor[1, 0, 1]]\)\>\"", 
               "."}]}], "*)"}], 
            RowBox[{"PartialD", "[", 
             RowBox[{"\[Tau]T", ",", 
              RowBox[{"(*", 
               RowBox[{"Note", " ", "that", " ", 
                RowBox[{"it", "'"}], "s", " ", 
                StyleBox["Dlist",
                 FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
              RowBox[{
              "Dlist", "\[LeftDoubleBracket]", "\[Sigma]", 
               "\[RightDoubleBracket]"}]}], "]"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"\[Sigma]", ",", "1", ",", "lgth"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Prepend", " ", "\[Mu]T", " ", "in", " ", "to", " ", "new", " ", 
           StyleBox["Indices",
            FontColor->RGBColor[1, 0, 1]], " ", "list"}], ",", " ", 
          RowBox[{
          "add", " ", "a", " ", "\"\<\[PartialD]\>\"", " ", "mark", " ", "in",
            " ", "front", " ", "of", " ", 
           StyleBox["TensorName",
            FontColor->RGBColor[1, 0, 1]]}], ",", " ", 
          RowBox[{"and", " ", "update", " ", "the", " ", 
           StyleBox[
            RowBox[{"TensorComponents", "."}],
            FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"\[Tau]T", "/.", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "iii_"}], ")"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", 
              RowBox[{"Prepend", "[", 
               RowBox[{"iii", ",", "\[Mu]T"}], "]"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", "nnn_"}], ")"}], 
            "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", 
              RowBox[{"\"\<\[PartialD]\>\"", "[", 
               RowBox[{"TensorName", "[", "\[Tau]T", "]"}], "]"}]}], ")"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "ccc_"}], ")"}], 
            "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "output"}], ")"}]}]}], 
          "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     StyleBox["Short",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox["-",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     RowBox[{
      StyleBox["hand",
       FontColor->RGBColor[0.5, 0, 0.5]], " ", "for", " ", "PartialD"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"See", " ", 
     RowBox[{"also", ":", " ", 
      StyleBox[
       RowBox[{"Derivative", " ", "for", " ", "Tensor"}],
       FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Tensor", "/:", 
    RowBox[{"D", "[", 
     RowBox[{"t_Tensor", ",", 
      RowBox[{"SubMinus", "[", "\[Mu]T_Symbol", "]"}]}], "]"}], ":=", 
    RowBox[{"PartialD", "[", 
     RowBox[{
      SubscriptBox["\[Mu]T", "-"], ",", "t"}], "]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.5760890361958838`*^9, 
   3.5760892921299334`*^9}, {3.576089327198795*^9, 3.5760893665108643`*^9}, {
   3.5760894467730045`*^9, 3.576089487177076*^9}, {3.576089599746874*^9, 
   3.576089794357215*^9}, {3.5760898355568876`*^9, 3.576089917379031*^9}, {
   3.576089953181094*^9, 3.576090082318121*^9}, {3.576560147053269*^9, 
   3.5765603514136276`*^9}, {3.5765603906008964`*^9, 3.576560411879334*^9}, {
   3.5765604668226304`*^9, 3.576560468913034*^9}, {3.5765932405918536`*^9, 
   3.576593241668256*^9}, {3.5765932876571364`*^9, 3.576593294365148*^9}, {
   3.576593413472658*^9, 3.5765934397421603`*^9}, {3.605905899085953*^9, 
   3.6059059169323845`*^9}, {3.605907375690477*^9, 3.605907376732993*^9}, {
   3.6059074214866805`*^9, 3.605907435022888*^9}, {3.6059074983508615`*^9, 
   3.605907502648427*^9}, {3.6059106918570814`*^9, 3.6059107179519825`*^9}, {
   3.6059108386183357`*^9, 3.605910859590658*^9}, {3.6059116367090964`*^9, 
   3.605911650068802*^9}, {3.605911842169753*^9, 3.605911895881578*^9}, {
   3.6059120020907097`*^9, 3.605912034981715*^9}, 3.6059120952461405`*^9, {
   3.605912172252824*^9, 3.605912231088728*^9}, {3.605912379985015*^9, 
   3.6059124141760397`*^9}, {3.605912547647091*^9, 3.6059125726254745`*^9}, 
   3.605912640557518*^9, {3.6059126921018095`*^9, 3.6059126993344207`*^9}, {
   3.606149316082368*^9, 3.6061493231657734`*^9}, {3.606149361203949*^9, 
   3.6061493833582163`*^9}, {3.6061495021670113`*^9, 
   3.6061496018337126`*^9}, {3.606149696681137*^9, 3.6061496971501637`*^9}, {
   3.6061497349753275`*^9, 3.6061497839071264`*^9}, {3.606149914846616*^9, 
   3.606149946487425*^9}, {3.6061501075506372`*^9, 3.6061501127199335`*^9}, {
   3.6061502607564*^9, 3.606150297869523*^9}, {3.6061503439731603`*^9, 
   3.606150399802354*^9}, {3.606150444232895*^9, 3.6061504505792575`*^9}, {
   3.6061506412691646`*^9, 3.60615079783912*^9}, {3.60615087215137*^9, 
   3.6061509190810547`*^9}, {3.6061510026398335`*^9, 
   3.6061510695636616`*^9}, {3.6061511012804756`*^9, 
   3.6061511022065287`*^9}, {3.606151174042638*^9, 3.6061511979290037`*^9}, {
   3.606151255141276*^9, 3.6061512782155957`*^9}, {3.6061517274972935`*^9, 
   3.606151749276539*^9}, {3.6061517850545855`*^9, 3.606151830330175*^9}, {
   3.606152246977006*^9, 3.6061522732695093`*^9}, 3.6061523568362894`*^9, {
   3.6061619084720783`*^9, 3.6061619096576805`*^9}, {3.606163263240858*^9, 
   3.606163263958459*^9}, {3.606163314471348*^9, 3.6061633160781507`*^9}, {
   3.606163378774661*^9, 3.606163413422322*^9}, 3.6061634632956095`*^9, {
   3.6061634941836634`*^9, 3.6061634946204643`*^9}, {3.6061635412957463`*^9, 
   3.6061636943476152`*^9}, {3.606163895151168*^9, 3.606163937037242*^9}, {
   3.6061640041329594`*^9, 3.606164018765785*^9}, {3.6061643337615385`*^9, 
   3.606164422744095*^9}, {3.6061645384026976`*^9, 3.6061645529731236`*^9}, {
   3.6061654490542974`*^9, 3.6061654690691323`*^9}, {3.6061656900123205`*^9, 
   3.6061657122579594`*^9}, {3.6061657561408367`*^9, 3.606165776280472*^9}, {
   3.6061659695336113`*^9, 3.6061659923564515`*^9}, {3.606166075114597*^9, 
   3.606166187918395*^9}, {3.6061662676657352`*^9, 3.6061662925945787`*^9}, {
   3.606166335837855*^9, 3.6061664592808714`*^9}, {3.6061665321329994`*^9, 
   3.6061665641286554`*^9}, {3.6061666252651634`*^9, 3.606166626559965*^9}, {
   3.6063210736379833`*^9, 3.6063210791355677`*^9}, 3.6063211492396445`*^9, {
   3.6063214202253075`*^9, 3.6063214618209467`*^9}, {3.606321625917968*^9, 
   3.6063216294880223`*^9}, {3.606321667340104*^9, 3.6063217452043004`*^9}, {
   3.6063218135733504`*^9, 3.6063218276655664`*^9}, {3.6063219714327755`*^9, 
   3.6063219994062057`*^9}, {3.606322158748153*^9, 3.6063222015913115`*^9}, {
   3.6063222598307066`*^9, 3.6063223402784424`*^9}, 3.606322462443319*^9, {
   3.6063226653409357`*^9, 3.6063227108891354`*^9}, {3.6063228320104966`*^9, 
   3.606322832784009*^9}, {3.6063229617499895`*^9, 3.606322969966116*^9}, {
   3.6063230880534306`*^9, 3.60632308867344*^9}, {3.606323326792098*^9, 
   3.606323351907984*^9}, {3.6063241585333757`*^9, 3.606324176213147*^9}, {
   3.6063242390986137`*^9, 3.606324282976787*^9}, {3.6063252896207523`*^9, 
   3.606325335455456*^9}, {3.606325382408677*^9, 3.6063254796761713`*^9}, 
   3.6063255205958004`*^9, {3.6063256422796693`*^9, 3.6063256443697014`*^9}, {
   3.6063257654995623`*^9, 3.6063257718131595`*^9}, {3.6063259134153347`*^9, 
   3.6063259413512635`*^9}, {3.6063641741698074`*^9, 3.606364192141835*^9}, {
   3.6063962921905727`*^9, 3.606396292923774*^9}, {3.606397566017028*^9, 
   3.606397636689613*^9}, {3.6063987641059313`*^9, 3.6063987870742846`*^9}, {
   3.6063993176404343`*^9, 3.6063993563175287`*^9}, 3.606399599800769*^9, {
   3.6063996475075016`*^9, 3.6063996743244133`*^9}, {3.606400359189934*^9, 
   3.606400359405937*^9}, {3.6064147318617353`*^9, 3.606414780243503*^9}, {
   3.606414942771799*^9, 3.606414968356262*^9}, {3.606415002285203*^9, 
   3.6064150066924553`*^9}, {3.606415050503961*^9, 3.6064150561282825`*^9}, {
   3.60641510398302*^9, 3.606415107171202*^9}, {3.606415149653632*^9, 
   3.606415271963628*^9}, {3.606415318698301*^9, 3.6064153496960735`*^9}, {
   3.606415439297199*^9, 3.6064154439654655`*^9}, {3.6064155734418716`*^9, 
   3.606415614767235*^9}, {3.606416011403921*^9, 3.6064160367773724`*^9}, {
   3.6064160876492825`*^9, 3.606416106172342*^9}, {3.6064161413863564`*^9, 
   3.606416153926073*^9}, {3.606416201531796*^9, 3.6064162124114184`*^9}, {
   3.6064164226034403`*^9, 3.6064164262046466`*^9}, {3.606416461872687*^9, 
   3.606416519591988*^9}, {3.606416656556822*^9, 3.6064166609770746`*^9}, {
   3.6064168185180855`*^9, 3.6064168709460845`*^9}, {3.606416957848055*^9, 
   3.606416979023266*^9}, {3.6064171656359396`*^9, 3.606417188828266*^9}, {
   3.606417281174548*^9, 3.606417326051115*^9}, {3.6064173998823376`*^9, 
   3.606417433523262*^9}, {3.606417467458203*^9, 3.606417500314082*^9}, {
   3.606417563021669*^9, 3.606417603650993*^9}, {3.60641768716877*^9, 
   3.6064176935111322`*^9}, {3.6064177622060614`*^9, 
   3.6064178086767197`*^9}, {3.6064178503651037`*^9, 3.606417878485712*^9}, {
   3.6064179976875305`*^9, 3.6064180039158864`*^9}, {3.606418123197709*^9, 
   3.606418125106818*^9}, {3.6064182368102074`*^9, 3.606418260005534*^9}, {
   3.6064183038340406`*^9, 3.606418342140232*^9}, {3.606418430367278*^9, 
   3.6064184936949005`*^9}, {3.6064185644959497`*^9, 
   3.6064185666510735`*^9}, {3.606418677719426*^9, 3.606418679805545*^9}, {
   3.606436543470795*^9, 3.6064365573235874`*^9}, {3.6064365990219727`*^9, 
   3.606436622187298*^9}, {3.606436806983867*^9, 3.6064368072418823`*^9}, {
   3.6064369956476583`*^9, 3.6064369958616705`*^9}, {3.6064371207458134`*^9, 
   3.6064371247680435`*^9}, {3.606437206666728*^9, 3.606437213891141*^9}, {
   3.6064373010921288`*^9, 3.606437333845002*^9}, {3.606437504073738*^9, 
   3.606437504289751*^9}, {3.6064379454409833`*^9, 3.606437960092821*^9}, {
   3.60643800237824*^9, 3.6064380077955494`*^9}, 3.606438145670436*^9, {
   3.606438258982917*^9, 3.6064382599669733`*^9}, {3.6064386627170095`*^9, 
   3.6064386728355875`*^9}, 3.6064387767465315`*^9, {3.6064388356599007`*^9, 
   3.606438842335283*^9}, {3.606438893568213*^9, 3.6064389037777967`*^9}, {
   3.6064390608037786`*^9, 3.606439094682716*^9}, {3.60643915822235*^9, 
   3.606439168216922*^9}, {3.60643921800677*^9, 3.6064392821324377`*^9}, {
   3.6064393296501555`*^9, 3.6064393487792497`*^9}, {3.606439485563073*^9, 
   3.6064395051461935`*^9}, {3.6064399730149536`*^9, 
   3.6064399878037996`*^9}, {3.6064400590218735`*^9, 3.606440076553876*^9}, {
   3.606440176433589*^9, 3.606440197594799*^9}, {3.6064402464825954`*^9, 
   3.606440253792013*^9}, {3.606440304795931*^9, 3.6064403077140975`*^9}, {
   3.606440524532499*^9, 3.60644052752067*^9}, {3.6064406171897984`*^9, 
   3.6064406209470134`*^9}, {3.6064407805891447`*^9, 3.606440787295528*^9}, {
   3.6064408236496077`*^9, 3.606440826737784*^9}, {3.606440856834505*^9, 
   3.606440861141752*^9}, {3.606440938633184*^9, 3.6064409772093906`*^9}, {
   3.606441053326744*^9, 3.606441106262772*^9}, 3.606444049039694*^9, 
   3.6064453186513114`*^9, {3.606445356832495*^9, 3.6064453903224106`*^9}, {
   3.6064460612407846`*^9, 3.606446065857049*^9}, {3.6064472620654683`*^9, 
   3.6064472653066535`*^9}, {3.6064473773500624`*^9, 3.60644741524823*^9}, {
   3.6064479502198286`*^9, 3.606447954931098*^9}, {3.6064484225688453`*^9, 
   3.606448439300802*^9}, {3.6064485513762126`*^9, 3.6064485981438875`*^9}, {
   3.6064491456562033`*^9, 3.606449146282239*^9}, {3.6064500206902523`*^9, 
   3.6064500424354963`*^9}, {3.6064501861307154`*^9, 
   3.6064502041757474`*^9}, {3.6064503561234384`*^9, 3.606450386525177*^9}, {
   3.606450434761936*^9, 3.606450439513208*^9}, {3.606451475026436*^9, 
   3.6064514993578277`*^9}, {3.6064516406889114`*^9, 3.606451641669967*^9}, {
   3.606451678449071*^9, 3.6064516793211207`*^9}, {3.6064517315281067`*^9, 
   3.606451759627714*^9}, {3.606451796842843*^9, 3.6064518143328433`*^9}, {
   3.6064519192058415`*^9, 3.6064519258752227`*^9}, {3.606452216699857*^9, 
   3.6064522186629696`*^9}, {3.6064522760802536`*^9, 
   3.6064522873698993`*^9}, {3.6064970666377306`*^9, 3.606497093791284*^9}, {
   3.6065038281633205`*^9, 3.606503840282014*^9}, 3.6065039166513815`*^9, {
   3.6065040202203054`*^9, 3.6065040491359596`*^9}, {3.6065040977297387`*^9, 
   3.606504108380348*^9}, {3.606504661197423*^9, 3.6065046902290745`*^9}, {
   3.6065048228917074`*^9, 3.6065048766026015`*^9}, {3.6065051618482494`*^9, 
   3.6065051665282574`*^9}, {3.6065053048849*^9, 3.6065053281289415`*^9}, {
   3.6065053664738083`*^9, 3.606505366676609*^9}, {3.6065058994799447`*^9, 
   3.606505899916745*^9}, {3.6065060448254004`*^9, 3.6065060450282*^9}, {
   3.606507180334243*^9, 3.606507190269811*^9}, {3.606507227590946*^9, 
   3.606507233061259*^9}, {3.6065075649162397`*^9, 3.60650759935421*^9}, {
   3.6065118524739714`*^9, 3.606511873380167*^9}, {3.6065119107953067`*^9, 
   3.60651192204195*^9}, {3.6065119620362377`*^9, 3.606512020667591*^9}, {
   3.6065120648481183`*^9, 3.6065120652151394`*^9}, {3.606512300743611*^9, 
   3.6065123180115986`*^9}, {3.606513025830083*^9, 3.60651306913056*^9}, {
   3.6065131466389933`*^9, 3.60651315585252*^9}, 3.606514109189048*^9, {
   3.6065143855958576`*^9, 3.6065143962424664`*^9}, {3.6065144404339943`*^9, 
   3.606514443546172*^9}, {3.606514516508345*^9, 3.606514606479491*^9}, {
   3.606514642402546*^9, 3.606514647298826*^9}, {3.60657601305414*^9, 
   3.606576025845872*^9}, {3.6294885962975087`*^9, 3.6294885968975096`*^9}, {
   3.6294887670077477`*^9, 3.6294887811277676`*^9}, 3.629488946017998*^9, 
   3.6294889762180405`*^9, {3.6296799808714633`*^9, 3.6296800186377373`*^9}, {
   3.6296800765780973`*^9, 3.6296800878709183`*^9}, {3.6296851347661448`*^9, 
   3.6296851379193497`*^9}, {3.629685349895347*^9, 3.6296853630081725`*^9}, {
   3.629687834535861*^9, 3.6296878493575363`*^9}, {3.629687948266225*^9, 
   3.629687974576489*^9}, {3.629688037883552*^9, 3.629688063712802*^9}, {
   3.6296883160957127`*^9, 3.629688343615058*^9}, {3.629688397209632*^9, 
   3.629688550367888*^9}, {3.6296886595640845`*^9, 3.6296887226079693`*^9}, {
   3.6296888438827596`*^9, 3.629688845144821*^9}, {3.6296892354808598`*^9, 
   3.629689305209598*^9}, {3.629689337167848*^9, 3.629689419362879*^9}, {
   3.6296919656916075`*^9, 3.6296919761680284`*^9}, {3.629693840199733*^9, 
   3.629693883066039*^9}, {3.629694123954773*^9, 3.629694194523058*^9}, {
   3.6296947833640385`*^9, 3.629694888216888*^9}, {3.629694974957252*^9, 
   3.6296949794912605`*^9}, {3.629695016853715*^9, 3.629695019568119*^9}, {
   3.629695068915369*^9, 3.629695070147771*^9}, {3.629695109662041*^9, 
   3.629695114045649*^9}, {3.629695201142003*^9, 3.629695257094702*^9}, {
   3.62969537974232*^9, 3.6296954018213587`*^9}, {3.629696180423136*^9, 
   3.6296961858685455`*^9}, {3.6296963162037787`*^9, 3.629696339169019*^9}, {
   3.629696377961688*^9, 3.6296963834996977`*^9}, {3.6296965025197077`*^9, 
   3.6296965251135483`*^9}, {3.629696620824117*^9, 3.629696632212137*^9}, {
   3.629696802275838*^9, 3.6296968542465296`*^9}, {3.629696951030902*^9, 
   3.6296970408562603`*^9}, {3.6296971532200594`*^9, 
   3.6296971742090964`*^9}, {3.6296972117497625`*^9, 
   3.6296972119681635`*^9}, {3.6296983718489113`*^9, 3.629698430922616*^9}, {
   3.6297274409048233`*^9, 3.629727464498066*^9}, {3.629727549906616*^9, 
   3.629727575325061*^9}, {3.6298456915444603`*^9, 3.629845701823281*^9}, {
   3.6298466291949453`*^9, 3.629846666829425*^9}, {3.6298469219078183`*^9, 
   3.629846938961754*^9}, {3.6298479732442703`*^9, 3.629847981134386*^9}, {
   3.6298483244007435`*^9, 3.6298483318414574`*^9}, {3.6298495776124363`*^9, 
   3.6298496207215223`*^9}, {3.6298535794568644`*^9, 
   3.6298536651670313`*^9}, {3.6298565207288785`*^9, 3.629856553513338*^9}, {
   3.629856638479088*^9, 3.629856659976926*^9}, {3.629857007221711*^9, 
   3.629857185623915*^9}, {3.629857221652976*^9, 3.6298572354907675`*^9}, {
   3.6298578357671013`*^9, 3.629857837127179*^9}, {3.6298579337247043`*^9, 
   3.6298579347447624`*^9}, {3.6298583272482123`*^9, 3.629858336241727*^9}, {
   3.62985863141861*^9, 3.629858633529731*^9}, {3.6298587849903936`*^9, 
   3.629858787928562*^9}, {3.6298588330311413`*^9, 3.629858860998741*^9}, {
   3.6298589360020313`*^9, 3.6298589428714237`*^9}, {3.629858986492919*^9, 
   3.6298589905491514`*^9}, 3.6298590768890896`*^9, {3.6298591288600616`*^9, 
   3.629859140505728*^9}, {3.6298591782148848`*^9, 3.6298591787819176`*^9}, {
   3.6298602983039503`*^9, 3.6298603530510817`*^9}, {3.6298662871976805`*^9, 
   3.6298662977812347`*^9}, {3.6298663995469913`*^9, 
   3.6298664025379076`*^9}, {3.629867805946912*^9, 3.629867863096182*^9}, {
   3.629867907431799*^9, 3.6298679076657996`*^9}, {3.629867938097679*^9, 
   3.629867942122688*^9}, {3.629909176889841*^9, 3.6299091975004773`*^9}, 
   3.629913789766417*^9, {3.6299138340045967`*^9, 3.62991395336893*^9}, {
   3.6299140417827883`*^9, 3.62991407057073*^9}, {3.629914105261263*^9, 
   3.6299141170914445`*^9}, {3.62991463043447*^9, 3.629914631089671*^9}, {
   3.6299146885963717`*^9, 3.6299146937131815`*^9}, {3.629915088830967*^9, 
   3.6299153407597475`*^9}, {3.6299158092601366`*^9, 
   3.6299158115221405`*^9}, {3.629915927193079*^9, 3.62991594200121*^9}, {
   3.629915992793312*^9, 3.629916008839244*^9}, {3.6299175161541896`*^9, 
   3.629917520155297*^9}, {3.8352604732219753`*^9, 3.8352604820549183`*^9}, {
   3.8352605560487156`*^9, 3.8352605661361046`*^9}, {3.8352606134635315`*^9, 
   3.835260705039947*^9}, {3.835260944287466*^9, 3.835260981278107*^9}, {
   3.8352648500877113`*^9, 3.835264945400612*^9}, 3.835265138891713*^9, 
   3.835265250326704*^9, {3.8352654302317057`*^9, 3.835265468734707*^9}, {
   3.8352655060487137`*^9, 3.8352655385707192`*^9}, 3.8352655851567087`*^9, {
   3.8352656489007072`*^9, 3.8352656525567055`*^9}, {3.835265786824703*^9, 
   3.835265797340705*^9}, {3.8352658960417137`*^9, 3.835265912952714*^9}, {
   3.8358344604663134`*^9, 3.8358345415951815`*^9}, {3.835834660938274*^9, 
   3.8358346826122007`*^9}, 3.8358347516523027`*^9, {3.8358347824806023`*^9, 
   3.8358347897211666`*^9}, {3.835835027221261*^9, 3.83583504546306*^9}, 
   3.8358355241242986`*^9, {3.8358537209622617`*^9, 3.8358537218619366`*^9}, {
   3.835853860567198*^9, 3.8358538736692047`*^9}, {3.835853980327199*^9, 
   3.835854096390462*^9}, {3.835854154295315*^9, 3.8358542191043854`*^9}, 
   3.8358543188331223`*^9, 3.8358544858413568`*^9, {3.8358545448720794`*^9, 
   3.835854618507143*^9}, 3.835854670120367*^9, {3.8358550024069624`*^9, 
   3.8358550347031765`*^9}, {3.835855071842867*^9, 3.8358550737479362`*^9}, {
   3.8358554434619637`*^9, 3.835855447220962*^9}, {3.8358554908449535`*^9, 
   3.835855547995963*^9}, {3.8358555928489633`*^9, 3.8358556857759504`*^9}, 
   3.8358608694734063`*^9, {3.835861218022401*^9, 3.835861222666402*^9}, 
   3.8359204809663844`*^9, {3.835922515828598*^9, 3.8359225278335958`*^9}, {
   3.835922952245639*^9, 3.835922965302247*^9}, {3.8359229990234833`*^9, 
   3.835923000831025*^9}, {3.836445921150355*^9, 3.836445927413431*^9}, {
   3.8365264813084908`*^9, 3.836526505542826*^9}, {3.8365274865371704`*^9, 
   3.8365274874911737`*^9}, {3.8374039957093225`*^9, 3.837404033976358*^9}, {
   3.8374042086242533`*^9, 3.8374042355055265`*^9}, {3.8374043572113156`*^9, 
   3.8374043831501446`*^9}, {3.837404437456546*^9, 3.8374044624903917`*^9}, {
   3.83740449461442*^9, 3.8374045284836416`*^9}, {3.8374295136883783`*^9, 
   3.837429532989379*^9}, {3.837429592547739*^9, 3.837429623021738*^9}, {
   3.837429748577462*^9, 3.83742977871146*^9}, {3.8376093050331783`*^9, 
   3.837609322988505*^9}, {3.8376402802354355`*^9, 3.8376402992055955`*^9}, {
   3.8376420561552305`*^9, 3.837642073760215*^9}, {3.8376519822422276`*^9, 
   3.837652028610064*^9}, {3.837652062236641*^9, 3.837652085651631*^9}, {
   3.8381944240614862`*^9, 3.8381944631469693`*^9}, {3.8381945747683415`*^9, 
   3.8381945762084007`*^9}, {3.8381946413935595`*^9, 
   3.8381946436989913`*^9}, {3.838194687583386*^9, 3.838194700899796*^9}, {
   3.838194779023388*^9, 3.8381948081002626`*^9}, {3.838194905251423*^9, 
   3.838194956058038*^9}, {3.838194986065569*^9, 3.8381949953028364`*^9}, {
   3.8381950899579177`*^9, 3.8381950995470543`*^9}, {3.838195158198583*^9, 
   3.838195174793747*^9}, {3.8381952508727427`*^9, 3.8381952736796026`*^9}, {
   3.8381953500940866`*^9, 3.8381953820097623`*^9}, {3.838195468501559*^9, 
   3.8381954918887043`*^9}, {3.8381955357781076`*^9, 
   3.8381955716109304`*^9}, {3.8381956070075502`*^9, 
   3.8381956350348434`*^9}, {3.8381957049801264`*^9, 3.83819570533545*^9}, {
   3.838195738157835*^9, 3.8381957473195305`*^9}, {3.849142632114067*^9, 
   3.8491426394269037`*^9}, 3.849142708162401*^9, {3.8491427388238144`*^9, 
   3.8491427501078568`*^9}, 3.8491428033864927`*^9, {3.8491428399560757`*^9, 
   3.849142853693881*^9}, {3.8491430072324824`*^9, 3.8491430589945354`*^9}, {
   3.8520207815223293`*^9, 3.852020794214577*^9}, 3.852020882371525*^9, 
   3.8520217579551954`*^9, 3.8520221966372747`*^9, {3.852022681788927*^9, 
   3.852022725178568*^9}, {3.8525340608051767`*^9, 3.8525340959228477`*^9}, {
   3.8531556681227303`*^9, 3.853155714968808*^9}, {3.8531558584215193`*^9, 
   3.8531558626451344`*^9}, 3.853155946098933*^9, {3.853156015349465*^9, 
   3.853156079897089*^9}, {3.853156309476976*^9, 3.8531563680191135`*^9}, 
   3.853156406761874*^9, 3.8531585460260243`*^9, 3.8531587458137674`*^9, 
   3.8532178823902283`*^9, {3.8532228573635035`*^9, 3.8532228872647552`*^9}, {
   3.8532230983514853`*^9, 3.8532231012563567`*^9}, {3.853230248504196*^9, 
   3.8532303507137847`*^9}, {3.8532303913221235`*^9, 3.853230461418183*^9}, {
   3.8532305020066743`*^9, 3.853230503125723*^9}, {3.8532305775230026`*^9, 
   3.8532306519056935`*^9}, {3.8532306924291916`*^9, 
   3.8532306933319244`*^9}, {3.853230727251824*^9, 3.8532307325367765`*^9}, {
   3.8532308346337557`*^9, 3.8532308365551767`*^9}, {3.8532308741204085`*^9, 
   3.8532310994102716`*^9}, {3.853231137803812*^9, 3.853231187805028*^9}, {
   3.8532312741506944`*^9, 3.8532313574697685`*^9}, {3.853231971919577*^9, 
   3.85323201861742*^9}, 3.8532320531281724`*^9, {3.853232433017573*^9, 
   3.8532324365239716`*^9}, {3.8532324670455475`*^9, 
   3.8532324949373937`*^9}, {3.85323254104211*^9, 3.8532326562514563`*^9}, {
   3.853232805359167*^9, 3.8532330849647903`*^9}, {3.853289149458395*^9, 
   3.853289154964405*^9}, {3.854582578096811*^9, 3.854582622246666*^9}, {
   3.8545831374253197`*^9, 3.854583160233822*^9}, {3.854583331176526*^9, 
   3.854583333993795*^9}, {3.8655602082154684`*^9, 3.8655602268156233`*^9}, {
   3.8691007566078634`*^9, 3.8691007683241515`*^9}, {3.8692873573461623`*^9, 
   3.869287364205019*^9}, {3.869287420406159*^9, 3.8692874237740936`*^9}, {
   3.873253070036314*^9, 3.8732530816434774`*^9}, {3.8745455353983445`*^9, 
   3.87454553588105*^9}, {3.874545620733197*^9, 3.874545699425254*^9}, {
   3.874545856812318*^9, 3.874545857803713*^9}, {3.875756153573864*^9, 
   3.8757563363726687`*^9}, {3.8757563678185406`*^9, 3.875756383884798*^9}, {
   3.893289124404459*^9, 3.8932891244284444`*^9}, 3.895063697530863*^9, 
   3.8950638548382034`*^9, {3.895554774687979*^9, 3.895554774752987*^9}, {
   3.8955551723276367`*^9, 3.895555172352625*^9}, {3.8955553398572607`*^9, 
   3.895555339893238*^9}, {3.895555838379516*^9, 3.8955558384264536`*^9}, {
   3.8966173071091475`*^9, 3.8966173125272737`*^9}, {3.8966174280562415`*^9, 
   3.896617434799738*^9}, {3.8966175417546673`*^9, 3.8966175744099636`*^9}, {
   3.8966178055461483`*^9, 3.8966178062961226`*^9}, {3.897169720332014*^9, 
   3.8971697382497573`*^9}, {3.967777452003911*^9, 3.9677774520273275`*^9}, 
   3.972501660822966*^9, {3.973764536708356*^9, 3.9737645367246513`*^9}, {
   3.975312355464632*^9, 3.97531240534731*^9}, {3.975312442099798*^9, 
   3.975312601285581*^9}},ExpressionUUID->"60c56988-1c9a-4dd3-bdf9-\
66b8da5c2652"]
}, Closed]],

Cell[CellGroupData[{

Cell["CovariantD", "Subsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.533880012946951*^9, 3.5338800148345547`*^9}, {
   3.5760890087086353`*^9, 3.5760890111890397`*^9}, {3.6061493485872273`*^9, 
   3.6061493494062743`*^9}},ExpressionUUID->"068f7a26-195b-4784-ab30-\
cc18cb7a08c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Covariant", " ", "derivative", " ", "on", " ", "a", " ", 
    RowBox[{
     StyleBox["scalar",
      FontColor->RGBColor[1, 0, 0]], ":", " ", 
     RowBox[{
      StyleBox[
       RowBox[{
        SubscriptBox["\[Del]", "\[Mu]"], "stuff"}],
       FontColor->RGBColor[0.5, 0, 0.5]], " ", "using", " ", "the", " ", 
      "metric", " ", "m"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"stuff", " ", "with", " ", "no", " ", "Tensor", " ", "Head"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CovariantD", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"(*", 
          RowBox[{"Not", " ", "allow", " ", "OverHatIndices", " ", "for", " ", 
           RowBox[{"now", "."}]}], "*)"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TestIndices", "[", "\[Mu]T", "]"}], "&&", 
           RowBox[{"!", 
            RowBox[{"TestOverHatIndex", "[", "\[Mu]T", "]"}]}]}], ")"}]}], 
        ",", "stuff_", ",", "m_Tensor"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"TestExpressionForm", "[", "stuff", "]"}], "&&", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
        RowBox[{"(", 
         RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}], "&&", 
        RowBox[{"MatchQ", "[", 
         RowBox[{"\[Mu]T", ",", 
          RowBox[{"SubMinus", "[", "_", "]"}]}], "]"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coords", ",", "grad", ",", "\[Mu]", ",", "\[Nu]", ",", "\[Lambda]", 
         ",", "lgth", ",", "idx", ",", "ii", ",", "output", ",", "outputt"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"extract", " ", "coordinates"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coords", "=", 
         RowBox[{"Coordinates", "[", "m", "]"}]}], ";", 
        RowBox[{"lgth", "=", 
         RowBox[{"Length", "[", "coords", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", "StartIndex"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"idx", "=", 
         RowBox[{"StartIndex", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"return", " ", "Tensor"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"stuff", ",", "#"}], "]"}], "&"}], "/@", "coords"}], 
          ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TensorName", "\[Rule]", 
           RowBox[{"Del", "[", "stuff", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"{", "\[Mu]T", "}"}]}], ",", 
          RowBox[{"StartIndex", "\[Rule]", "idx"}], ",", 
          RowBox[{"Coordinates", "\[Rule]", "coords"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", "output"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TooltipStyle", "\[Rule]", " ", 
           RowBox[{"TooltipStyle", "[", "m", "]"}]}]}], "\[IndentingNewLine]",
          "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"stuff", " ", 
     RowBox[{"w", "/", " ", "Tensor"}], " ", "head"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CovariantD", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"(*", " ", 
          RowBox[{"Not", " ", "allow", " ", "OverHatIndices", " ", "for", " ", 
           RowBox[{"now", "."}]}], "*)"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TestIndices", "[", "\[Mu]T", "]"}], "&&", 
           RowBox[{"!", 
            RowBox[{"TestOverHatIndex", "[", "\[Mu]T", "]"}]}]}], ")"}]}], 
        ",", "stuff_Tensor", ",", "m_Tensor"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"(*", " ", 
        RowBox[{
        "check", " ", "stuff", " ", "is", " ", "indeed", " ", "a", " ", 
         "scalar"}], " ", "*)"}], 
       RowBox[{
        RowBox[{"TestScalarTensor", "[", "stuff", "]"}], "&&", 
        RowBox[{"(", 
         RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}], "&&", 
        RowBox[{"MatchQ", "[", 
         RowBox[{"\[Mu]T", ",", 
          RowBox[{"SubMinus", "[", "_", "]"}]}], "]"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coords", ",", "grad", ",", "\[Mu]", ",", "\[Nu]", ",", "\[Lambda]", 
         ",", "lgth", ",", "idx", ",", "ii", ",", "contents", ",", "output", 
         ",", "outputt"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"extract", " ", "coordinates"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coords", "=", 
         RowBox[{"Coordinates", "[", "m", "]"}]}], ";", 
        RowBox[{"lgth", "=", 
         RowBox[{"Length", "[", "coords", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", "StartIndex"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"idx", "=", 
         RowBox[{"StartIndex", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"contents", " ", "of", " ", "stuff"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"contents", "=", 
         RowBox[{"TensorComponents", "[", "stuff", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"return", " ", "Tensor"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"contents", ",", "#"}], "]"}], "&"}], "/@", "coords"}], 
          ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"outputt", "=", "stuff"}], ";", "\[IndentingNewLine]", 
        RowBox[{"outputt", "=", 
         RowBox[{"TensorName", "[", 
          RowBox[{"outputt", ",", 
           RowBox[{"Del", "[", 
            RowBox[{"TensorName", "[", "stuff", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"outputt", "=", 
         RowBox[{"Indices", "[", 
          RowBox[{"outputt", ",", 
           RowBox[{"{", "\[Mu]T", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"outputt", "=", 
         RowBox[{"StartIndex", "[", 
          RowBox[{"outputt", ",", "idx"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"outputt", "=", 
         RowBox[{"Coordinates", "[", 
          RowBox[{"outputt", ",", "coords"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{"outputt", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", " ", "tc_"}], ")"}], 
            "\[Rule]", "  ", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "output"}], ")"}]}], 
           "}"}]}], ")"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Covariant", " ", "derivative", " ", "on", " ", "a", " ", 
     RowBox[{
      StyleBox["scalar",
       FontColor->RGBColor[1, 0, 0]], ":", " ", 
      RowBox[{
       StyleBox[
        RowBox[{
         SuperscriptBox["\[Del]", "\[Mu]"], "stuff"}],
        FontColor->RGBColor[0.5, 0, 0.5]], " ", "using", " ", "the", " ", 
       "metric", " ", "m"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"stuff", " ", "with", " ", "no", " ", "Tensor", " ", "Head"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CovariantD", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"(*", 
          RowBox[{"Not", " ", "allow", " ", "OverHatIndices", " ", "for", " ", 
           RowBox[{"now", "."}]}], "*)"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TestIndices", "[", "\[Mu]T", "]"}], "&&", 
           RowBox[{"!", 
            RowBox[{"TestOverHatIndex", "[", "\[Mu]T", "]"}]}]}], ")"}]}], 
        ",", "stuff_", ",", "m_Tensor"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"TestExpressionForm", "[", "stuff", "]"}], "&&", 
        RowBox[{"(", 
         RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}], "&&", 
        RowBox[{"MatchQ", "[", 
         RowBox[{"\[Mu]T", ",", 
          RowBox[{"SuperMinus", "[", "_", "]"}]}], "]"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coords", ",", "grad", ",", "\[Mu]", ",", "\[Nu]", ",", "\[Lambda]", 
         ",", "lgth", ",", "idx", ",", "ii", ",", "invmetricM", ",", "output",
          ",", "outputt"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"extract", " ", "coordinates"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coords", "=", 
         RowBox[{"Coordinates", "[", "m", "]"}]}], ";", 
        RowBox[{"lgth", "=", 
         RowBox[{"Length", "[", "coords", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", "StartIndex"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"idx", "=", 
         RowBox[{"StartIndex", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "extract", " ", "inverse", " ", "metric", " ", "as", " ", "a", " ", 
          "matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"invmetricM", "=", 
         RowBox[{"TensorComponents", "[", 
          RowBox[{"Metric", "[", 
           RowBox[{
            SuperscriptBox["\[Mu]", "-"], ",", 
            SuperscriptBox["\[Nu]", "-"], ",", "m"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"return", " ", "Tensor"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"invmetricM", ".", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"stuff", ",", "#"}], "]"}], "&"}], "/@", "coords"}], 
           ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TensorName", "\[Rule]", 
           RowBox[{"Del", "[", "stuff", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"{", "\[Mu]T", "}"}]}], ",", 
          RowBox[{"StartIndex", "\[Rule]", "idx"}], ",", 
          RowBox[{"Coordinates", "\[Rule]", "coords"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", "output"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TooltipStyle", "\[Rule]", " ", 
           RowBox[{"TooltipStyle", "[", "m", "]"}]}]}], "\[IndentingNewLine]",
          "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"stuff", " ", 
     RowBox[{"w", "/", " ", "Tensor"}], " ", "head"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CovariantD", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"(*", 
          RowBox[{"Not", " ", "allow", " ", "OverHatIndices", " ", "for", " ", 
           RowBox[{"now", "."}]}], "*)"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TestIndices", "[", "\[Mu]T", "]"}], "&&", 
           RowBox[{"!", 
            RowBox[{"TestOverHatIndex", "[", "\[Mu]T", "]"}]}]}], ")"}]}], 
        ",", "stuff_Tensor", ",", "m_Tensor"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"(*", " ", 
        RowBox[{
        "check", " ", "stuff", " ", "is", " ", "indeed", " ", "a", " ", 
         "scalar"}], " ", "*)"}], 
       RowBox[{
        RowBox[{"TestScalarTensor", "[", "stuff", "]"}], "&&", 
        RowBox[{"(", 
         RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}], "&&", 
        RowBox[{"MatchQ", "[", 
         RowBox[{"\[Mu]T", ",", 
          RowBox[{"SuperMinus", "[", "_", "]"}]}], "]"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coords", ",", "grad", ",", "\[Mu]", ",", "\[Nu]", ",", "\[Lambda]", 
         ",", "lgth", ",", "idx", ",", "ii", ",", "contents", ",", 
         "invmetricM", ",", "output", ",", "outputt"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"extract", " ", "coordinates"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coords", "=", 
         RowBox[{"Coordinates", "[", "m", "]"}]}], ";", 
        RowBox[{"lgth", "=", 
         RowBox[{"Length", "[", "coords", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", "StartIndex"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"idx", "=", 
         RowBox[{"StartIndex", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"contents", " ", "of", " ", "stuff"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"contents", "=", 
         RowBox[{"TensorComponents", "[", "stuff", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "extract", " ", "inverse", " ", "metric", " ", "as", " ", "a", " ", 
          "matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"invmetricM", "=", 
         RowBox[{"TensorComponents", "[", 
          RowBox[{"Metric", "[", 
           RowBox[{
            SuperscriptBox["\[Mu]", "-"], ",", 
            SuperscriptBox["\[Nu]", "-"], ",", "m"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"return", " ", "Tensor"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"invmetricM", ".", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"contents", ",", "#"}], "]"}], "&"}], "/@", "coords"}], 
           ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"outputt", "=", "stuff"}], ";", "\[IndentingNewLine]", 
        RowBox[{"outputt", "=", 
         RowBox[{"TensorName", "[", 
          RowBox[{"outputt", ",", 
           RowBox[{"Del", "[", 
            RowBox[{"TensorName", "[", "stuff", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"outputt", "=", 
         RowBox[{"Indices", "[", 
          RowBox[{"outputt", ",", 
           RowBox[{"{", "\[Mu]T", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"outputt", "=", 
         RowBox[{"StartIndex", "[", 
          RowBox[{"outputt", ",", "idx"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"outputt", "=", 
         RowBox[{"Coordinates", "[", 
          RowBox[{"outputt", ",", "coords"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{"outputt", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", " ", "tc_"}], ")"}], 
            "\[Rule]", "  ", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "output"}], ")"}]}], 
           "}"}]}], ")"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.5760890361958838`*^9, 
   3.5760892921299334`*^9}, {3.576089327198795*^9, 3.5760893665108643`*^9}, {
   3.5760894467730045`*^9, 3.576089487177076*^9}, {3.576089599746874*^9, 
   3.576089794357215*^9}, {3.5760898355568876`*^9, 3.576089917379031*^9}, {
   3.576089953181094*^9, 3.576090082318121*^9}, {3.576560147053269*^9, 
   3.5765603514136276`*^9}, {3.5765603906008964`*^9, 3.576560411879334*^9}, {
   3.5765604668226304`*^9, 3.576560468913034*^9}, {3.5765932405918536`*^9, 
   3.576593241668256*^9}, {3.5765932876571364`*^9, 3.576593294365148*^9}, {
   3.576593413472658*^9, 3.5765934397421603`*^9}, {3.605905899085953*^9, 
   3.6059059169323845`*^9}, {3.605907375690477*^9, 3.605907376732993*^9}, {
   3.6059074214866805`*^9, 3.605907435022888*^9}, {3.6059074983508615`*^9, 
   3.605907502648427*^9}, {3.6059106918570814`*^9, 3.6059107179519825`*^9}, {
   3.6059108386183357`*^9, 3.605910859590658*^9}, {3.6059116367090964`*^9, 
   3.605911650068802*^9}, {3.605911842169753*^9, 3.605911895881578*^9}, {
   3.6059120020907097`*^9, 3.605912034981715*^9}, 3.6059120952461405`*^9, {
   3.605912172252824*^9, 3.605912231088728*^9}, {3.605912379985015*^9, 
   3.6059124141760397`*^9}, {3.605912547647091*^9, 3.6059125726254745`*^9}, 
   3.605912640557518*^9, {3.6059126921018095`*^9, 3.6059126993344207`*^9}, {
   3.606149316082368*^9, 3.6061493231657734`*^9}, {3.606149361203949*^9, 
   3.6061493833582163`*^9}, {3.6061495021670113`*^9, 
   3.6061496018337126`*^9}, {3.606149696681137*^9, 3.6061496971501637`*^9}, {
   3.6061497349753275`*^9, 3.6061497839071264`*^9}, {3.606149914846616*^9, 
   3.606149946487425*^9}, {3.6061501075506372`*^9, 3.6061501127199335`*^9}, {
   3.6061502607564*^9, 3.606150297869523*^9}, {3.6061503439731603`*^9, 
   3.606150399802354*^9}, {3.606150444232895*^9, 3.6061504505792575`*^9}, {
   3.6061506412691646`*^9, 3.60615079783912*^9}, {3.60615087215137*^9, 
   3.6061509190810547`*^9}, {3.6061510026398335`*^9, 
   3.6061510695636616`*^9}, {3.6061511012804756`*^9, 
   3.6061511022065287`*^9}, {3.606151174042638*^9, 3.6061511979290037`*^9}, {
   3.606151255141276*^9, 3.6061512782155957`*^9}, {3.6061517274972935`*^9, 
   3.606151749276539*^9}, {3.6061517850545855`*^9, 3.606151830330175*^9}, {
   3.606152246977006*^9, 3.6061522732695093`*^9}, 3.6061523568362894`*^9, {
   3.6061619084720783`*^9, 3.6061619096576805`*^9}, {3.606163263240858*^9, 
   3.606163263958459*^9}, {3.606163314471348*^9, 3.6061633160781507`*^9}, {
   3.606163378774661*^9, 3.606163413422322*^9}, 3.6061634632956095`*^9, {
   3.6061634941836634`*^9, 3.6061634946204643`*^9}, {3.6061635412957463`*^9, 
   3.6061636943476152`*^9}, {3.606163895151168*^9, 3.606163937037242*^9}, {
   3.6061640041329594`*^9, 3.606164018765785*^9}, {3.6061643337615385`*^9, 
   3.606164422744095*^9}, {3.6061645384026976`*^9, 3.6061645529731236`*^9}, {
   3.6061654490542974`*^9, 3.6061654690691323`*^9}, {3.6061656900123205`*^9, 
   3.6061657122579594`*^9}, {3.6061657561408367`*^9, 3.606165776280472*^9}, {
   3.6061659695336113`*^9, 3.6061659923564515`*^9}, {3.606166075114597*^9, 
   3.606166187918395*^9}, {3.6061662676657352`*^9, 3.6061662925945787`*^9}, {
   3.606166335837855*^9, 3.6061664592808714`*^9}, {3.6061665321329994`*^9, 
   3.6061665641286554`*^9}, {3.6061666252651634`*^9, 3.606166626559965*^9}, {
   3.6063210736379833`*^9, 3.6063210791355677`*^9}, 3.6063211492396445`*^9, {
   3.6063214202253075`*^9, 3.6063214618209467`*^9}, {3.606321625917968*^9, 
   3.6063216294880223`*^9}, {3.606321667340104*^9, 3.6063217452043004`*^9}, {
   3.6063218135733504`*^9, 3.6063218276655664`*^9}, {3.6063219714327755`*^9, 
   3.6063219994062057`*^9}, {3.606322158748153*^9, 3.6063222015913115`*^9}, {
   3.6063222598307066`*^9, 3.6063223402784424`*^9}, 3.606322462443319*^9, {
   3.6063226653409357`*^9, 3.6063227108891354`*^9}, {3.6063228320104966`*^9, 
   3.606322832784009*^9}, {3.6063229617499895`*^9, 3.606322969966116*^9}, {
   3.6063230880534306`*^9, 3.60632308867344*^9}, {3.606323326792098*^9, 
   3.606323351907984*^9}, {3.6063241585333757`*^9, 3.606324176213147*^9}, {
   3.6063242390986137`*^9, 3.606324282976787*^9}, {3.6063252896207523`*^9, 
   3.606325335455456*^9}, {3.606325382408677*^9, 3.6063254796761713`*^9}, 
   3.6063255205958004`*^9, {3.6063256422796693`*^9, 3.6063256443697014`*^9}, {
   3.6063257654995623`*^9, 3.6063257718131595`*^9}, {3.6063259134153347`*^9, 
   3.6063259413512635`*^9}, {3.6063641741698074`*^9, 3.606364192141835*^9}, {
   3.6063962921905727`*^9, 3.606396292923774*^9}, {3.606397566017028*^9, 
   3.606397636689613*^9}, {3.6063987641059313`*^9, 3.6063987870742846`*^9}, {
   3.6063993176404343`*^9, 3.6063993563175287`*^9}, 3.606399599800769*^9, {
   3.6063996475075016`*^9, 3.6063996743244133`*^9}, {3.606400359189934*^9, 
   3.606400359405937*^9}, {3.6064147318617353`*^9, 3.606414780243503*^9}, {
   3.606414942771799*^9, 3.606414968356262*^9}, {3.606415002285203*^9, 
   3.6064150066924553`*^9}, {3.606415050503961*^9, 3.6064150561282825`*^9}, {
   3.60641510398302*^9, 3.606415107171202*^9}, {3.606415149653632*^9, 
   3.606415271963628*^9}, {3.606415318698301*^9, 3.6064153496960735`*^9}, {
   3.606415439297199*^9, 3.6064154439654655`*^9}, {3.6064155734418716`*^9, 
   3.606415614767235*^9}, {3.606416011403921*^9, 3.6064160367773724`*^9}, {
   3.6064160876492825`*^9, 3.606416106172342*^9}, {3.6064161413863564`*^9, 
   3.606416153926073*^9}, {3.606416201531796*^9, 3.6064162124114184`*^9}, {
   3.6064164226034403`*^9, 3.6064164262046466`*^9}, {3.606416461872687*^9, 
   3.606416519591988*^9}, {3.606416656556822*^9, 3.6064166609770746`*^9}, {
   3.6064168185180855`*^9, 3.6064168709460845`*^9}, {3.606416957848055*^9, 
   3.606416979023266*^9}, {3.6064171656359396`*^9, 3.606417188828266*^9}, {
   3.606417281174548*^9, 3.606417326051115*^9}, {3.6064173998823376`*^9, 
   3.606417433523262*^9}, {3.606417467458203*^9, 3.606417500314082*^9}, {
   3.606417563021669*^9, 3.606417603650993*^9}, {3.60641768716877*^9, 
   3.6064176935111322`*^9}, {3.6064177622060614`*^9, 
   3.6064178086767197`*^9}, {3.6064178503651037`*^9, 3.606417878485712*^9}, {
   3.6064179976875305`*^9, 3.6064180039158864`*^9}, {3.606418123197709*^9, 
   3.606418125106818*^9}, {3.6064182368102074`*^9, 3.606418260005534*^9}, {
   3.6064183038340406`*^9, 3.606418342140232*^9}, {3.606418430367278*^9, 
   3.6064184936949005`*^9}, {3.6064185644959497`*^9, 
   3.6064185666510735`*^9}, {3.606418677719426*^9, 3.606418679805545*^9}, {
   3.606436543470795*^9, 3.6064365573235874`*^9}, {3.6064365990219727`*^9, 
   3.606436622187298*^9}, {3.606436806983867*^9, 3.6064368072418823`*^9}, {
   3.6064369956476583`*^9, 3.6064369958616705`*^9}, {3.6064371207458134`*^9, 
   3.6064371247680435`*^9}, {3.606437206666728*^9, 3.606437213891141*^9}, {
   3.6064373010921288`*^9, 3.606437333845002*^9}, {3.606437504073738*^9, 
   3.606437504289751*^9}, {3.6064379454409833`*^9, 3.606437960092821*^9}, {
   3.60643800237824*^9, 3.6064380077955494`*^9}, 3.606438145670436*^9, {
   3.606438258982917*^9, 3.6064382599669733`*^9}, {3.6064386627170095`*^9, 
   3.6064386728355875`*^9}, 3.6064387767465315`*^9, {3.6064388356599007`*^9, 
   3.606438842335283*^9}, {3.606438893568213*^9, 3.6064389037777967`*^9}, {
   3.6064390608037786`*^9, 3.606439094682716*^9}, {3.60643915822235*^9, 
   3.606439168216922*^9}, {3.60643921800677*^9, 3.6064392821324377`*^9}, {
   3.6064393296501555`*^9, 3.6064393487792497`*^9}, {3.606439485563073*^9, 
   3.6064395051461935`*^9}, {3.6064399730149536`*^9, 
   3.6064399878037996`*^9}, {3.6064400590218735`*^9, 3.606440076553876*^9}, {
   3.606440176433589*^9, 3.606440197594799*^9}, {3.6064402464825954`*^9, 
   3.606440253792013*^9}, {3.606440304795931*^9, 3.6064403077140975`*^9}, {
   3.606440524532499*^9, 3.60644052752067*^9}, {3.6064406171897984`*^9, 
   3.6064406209470134`*^9}, {3.6064407805891447`*^9, 3.606440787295528*^9}, {
   3.6064408236496077`*^9, 3.606440826737784*^9}, {3.606440856834505*^9, 
   3.606440861141752*^9}, {3.606440938633184*^9, 3.6064409772093906`*^9}, {
   3.606441053326744*^9, 3.606441106262772*^9}, 3.606444049039694*^9, 
   3.6064453186513114`*^9, {3.606445356832495*^9, 3.6064453903224106`*^9}, {
   3.6064460612407846`*^9, 3.606446065857049*^9}, {3.6064472620654683`*^9, 
   3.6064472653066535`*^9}, {3.6064473773500624`*^9, 3.60644741524823*^9}, {
   3.6064479502198286`*^9, 3.606447954931098*^9}, {3.6064484225688453`*^9, 
   3.606448439300802*^9}, {3.6064485513762126`*^9, 3.6064485981438875`*^9}, {
   3.6064491456562033`*^9, 3.606449146282239*^9}, {3.6064500206902523`*^9, 
   3.6064500424354963`*^9}, {3.6064501861307154`*^9, 
   3.6064502041757474`*^9}, {3.6064503561234384`*^9, 3.606450386525177*^9}, {
   3.606450434761936*^9, 3.606450439513208*^9}, {3.606451475026436*^9, 
   3.6064514993578277`*^9}, {3.6064516406889114`*^9, 3.606451641669967*^9}, {
   3.606451678449071*^9, 3.6064516793211207`*^9}, {3.6064517315281067`*^9, 
   3.606451759627714*^9}, {3.606451796842843*^9, 3.6064518143328433`*^9}, {
   3.6064519192058415`*^9, 3.6064519258752227`*^9}, {3.606452216699857*^9, 
   3.6064522186629696`*^9}, {3.6064522760802536`*^9, 
   3.6064522873698993`*^9}, {3.6064970666377306`*^9, 3.606497093791284*^9}, {
   3.6065038281633205`*^9, 3.606503840282014*^9}, 3.6065039166513815`*^9, {
   3.6065040202203054`*^9, 3.6065040491359596`*^9}, {3.6065040977297387`*^9, 
   3.606504108380348*^9}, {3.606504661197423*^9, 3.6065046902290745`*^9}, {
   3.6065048228917074`*^9, 3.6065048766026015`*^9}, {3.6065051618482494`*^9, 
   3.6065051665282574`*^9}, {3.6065053048849*^9, 3.6065053281289415`*^9}, {
   3.6065053664738083`*^9, 3.606505366676609*^9}, {3.6065058994799447`*^9, 
   3.606505899916745*^9}, {3.6065060448254004`*^9, 3.6065060450282*^9}, {
   3.606507180334243*^9, 3.606507190269811*^9}, {3.606507227590946*^9, 
   3.606507233061259*^9}, {3.6065075649162397`*^9, 3.60650759935421*^9}, {
   3.6065118524739714`*^9, 3.606511873380167*^9}, {3.6065119107953067`*^9, 
   3.60651192204195*^9}, {3.6065119620362377`*^9, 3.606512020667591*^9}, {
   3.6065120648481183`*^9, 3.6065120652151394`*^9}, {3.606512300743611*^9, 
   3.6065123180115986`*^9}, {3.606513025830083*^9, 3.60651306913056*^9}, {
   3.6065131466389933`*^9, 3.60651315585252*^9}, 3.606514109189048*^9, {
   3.6065143855958576`*^9, 3.6065143962424664`*^9}, {3.6065144404339943`*^9, 
   3.606514443546172*^9}, {3.606514516508345*^9, 3.606514606479491*^9}, {
   3.606514642402546*^9, 3.606514647298826*^9}, {3.60657601305414*^9, 
   3.606576025845872*^9}, {3.6294885962975087`*^9, 3.6294885968975096`*^9}, {
   3.6294887670077477`*^9, 3.6294887811277676`*^9}, 3.629488946017998*^9, 
   3.6294889762180405`*^9, {3.6296799808714633`*^9, 3.6296800186377373`*^9}, {
   3.6296800765780973`*^9, 3.6296800878709183`*^9}, {3.6296851347661448`*^9, 
   3.6296851379193497`*^9}, {3.629685349895347*^9, 3.6296853630081725`*^9}, {
   3.629687834535861*^9, 3.6296878493575363`*^9}, {3.629687948266225*^9, 
   3.629687974576489*^9}, {3.629688037883552*^9, 3.629688063712802*^9}, {
   3.6296883160957127`*^9, 3.629688343615058*^9}, {3.629688397209632*^9, 
   3.629688550367888*^9}, {3.6296886595640845`*^9, 3.6296887226079693`*^9}, {
   3.6296888438827596`*^9, 3.629688845144821*^9}, {3.6296892354808598`*^9, 
   3.629689305209598*^9}, {3.629689337167848*^9, 3.629689419362879*^9}, {
   3.6296919656916075`*^9, 3.6296919761680284`*^9}, {3.629693840199733*^9, 
   3.629693883066039*^9}, {3.629694123954773*^9, 3.629694194523058*^9}, {
   3.6296947833640385`*^9, 3.629694888216888*^9}, {3.629694974957252*^9, 
   3.6296949794912605`*^9}, {3.629695016853715*^9, 3.629695019568119*^9}, {
   3.629695068915369*^9, 3.629695070147771*^9}, {3.629695109662041*^9, 
   3.629695114045649*^9}, {3.629695201142003*^9, 3.629695257094702*^9}, {
   3.62969537974232*^9, 3.6296954018213587`*^9}, {3.629696180423136*^9, 
   3.6296961858685455`*^9}, {3.6296963162037787`*^9, 3.629696339169019*^9}, {
   3.629696377961688*^9, 3.6296963834996977`*^9}, {3.6296965025197077`*^9, 
   3.6296965251135483`*^9}, {3.629696620824117*^9, 3.629696632212137*^9}, {
   3.629696802275838*^9, 3.6296968542465296`*^9}, {3.629696951030902*^9, 
   3.6296970408562603`*^9}, {3.6296971532200594`*^9, 
   3.6296971742090964`*^9}, {3.6296972117497625`*^9, 
   3.6296972119681635`*^9}, {3.6296983718489113`*^9, 3.629698430922616*^9}, {
   3.6297274409048233`*^9, 3.629727464498066*^9}, {3.629727549906616*^9, 
   3.629727575325061*^9}, {3.6298456915444603`*^9, 3.629845701823281*^9}, {
   3.6298466291949453`*^9, 3.629846666829425*^9}, {3.6298469219078183`*^9, 
   3.629846938961754*^9}, {3.6298479732442703`*^9, 3.629847981134386*^9}, {
   3.6298483244007435`*^9, 3.6298483318414574`*^9}, {3.6298495776124363`*^9, 
   3.6298496207215223`*^9}, {3.6298535794568644`*^9, 
   3.6298536651670313`*^9}, {3.6298565207288785`*^9, 3.629856553513338*^9}, {
   3.629856638479088*^9, 3.629856659976926*^9}, {3.629857007221711*^9, 
   3.629857185623915*^9}, {3.629857221652976*^9, 3.6298572354907675`*^9}, {
   3.6298578357671013`*^9, 3.629857837127179*^9}, {3.6298579337247043`*^9, 
   3.6298579347447624`*^9}, {3.6298583272482123`*^9, 3.629858336241727*^9}, {
   3.62985863141861*^9, 3.629858633529731*^9}, {3.6298587849903936`*^9, 
   3.629858787928562*^9}, {3.6298588330311413`*^9, 3.629858860998741*^9}, {
   3.6298589360020313`*^9, 3.6298589428714237`*^9}, {3.629858986492919*^9, 
   3.6298589905491514`*^9}, 3.6298590768890896`*^9, {3.6298591288600616`*^9, 
   3.629859140505728*^9}, {3.6298591782148848`*^9, 3.6298591787819176`*^9}, {
   3.6298602983039503`*^9, 3.6298603530510817`*^9}, {3.6298662871976805`*^9, 
   3.6298662977812347`*^9}, {3.6298663995469913`*^9, 
   3.6298664025379076`*^9}, {3.629867805946912*^9, 3.629867863096182*^9}, {
   3.629867907431799*^9, 3.6298679076657996`*^9}, {3.629867938097679*^9, 
   3.629867942122688*^9}, {3.6299139619990625`*^9, 3.6299139692841744`*^9}, 
   3.671908904118229*^9, 3.6727825694188104`*^9, 3.8365296985952315`*^9, {
   3.836529780268464*^9, 3.836529785787463*^9}, {3.8478330966224947`*^9, 
   3.8478331218596563`*^9}, {3.8478333640821037`*^9, 
   3.8478334148209677`*^9}, {3.847837802630602*^9, 3.8478378100528536`*^9}, {
   3.853158364986801*^9, 3.853158375141774*^9}, {3.853158407466922*^9, 
   3.8531584399119463`*^9}, {3.8531588400495267`*^9, 3.853158848835021*^9}, {
   3.853217947080208*^9, 3.853217982339759*^9}, 3.8532180597443943`*^9, {
   3.8532191023917933`*^9, 3.8532191064217005`*^9}, {3.8532191563803186`*^9, 
   3.8532191602107606`*^9}, {3.853219192860713*^9, 3.8532191942308292`*^9}, {
   3.8532197812162285`*^9, 3.853219821385949*^9}, 3.853221625432823*^9, {
   3.853221669202771*^9, 3.853221669592552*^9}, 3.8532896637820015`*^9, 
   3.8532897881868176`*^9, {3.8691007718439856`*^9, 3.869100773610896*^9}, {
   3.8692873719952464`*^9, 3.86928737644211*^9}, {3.8692874133127785`*^9, 
   3.869287416105071*^9}, {3.875756392464123*^9, 3.8757565952159033`*^9}, {
   3.8932891244534283`*^9, 3.893289124457427*^9}, {3.895554774778982*^9, 
   3.8955547747919908`*^9}, {3.8955551723606186`*^9, 
   3.8955551723756094`*^9}, {3.89555533990523*^9, 3.895555339910228*^9}, {
   3.8955558384334493`*^9, 3.895555838448442*^9}, {3.896677035045806*^9, 
   3.896677098794981*^9}, 3.8966772916050014`*^9, {3.8971697953857107`*^9, 
   3.897170033976923*^9}, 3.8971700718641043`*^9, {3.8971701046051807`*^9, 
   3.897170179787458*^9}, {3.8971703834686804`*^9, 3.8971704174491158`*^9}, 
   3.897204439249395*^9, {3.89720469403481*^9, 3.897204696326358*^9}, {
   3.9677774520313325`*^9, 3.967777452037553*^9}, 3.972501802461361*^9, {
   3.975312614645965*^9, 
   3.9753127955381737`*^9}},ExpressionUUID->"c62c2130-ec1c-4ac0-8992-\
b3ffe500d352"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Covariant", " ", "derivative", " ", 
    StyleBox[
     RowBox[{
      SubscriptBox["\[Del]", "\[Mu]"], "Tensor"}],
     FontColor->RGBColor[0.5, 0, 0.5]], " ", "using", " ", "the", " ", 
    "metric", " ", "m"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Note", " ", 
     RowBox[{"I", ".", " ", "If"}], " ", "\[Tau]T", " ", "contains", " ", 
     "non"}], "-", 
    RowBox[{
    "repeated", " ", "UnderBarred", " ", "indices", " ", "then", " ", "we", 
     " ", "cannot", " ", "take", " ", "its", " ", "CovariantD", " ", 
     "because", " ", "there", " ", 
     RowBox[{"isn", "'"}], "t", " ", "enough", " ", "info", " ", "since", " ", 
     RowBox[{"we", "'"}], "d", " ", "have", " ", "to", " ", "sum", " ", 
     "over", " ", "other", " ", "components", " ", "of", " ", "the", " ", 
     "Tensor", " ", "that", " ", "are", " ", "not", " ", 
     RowBox[{"avai", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Note", " ", 
    RowBox[{"II", ".", " ", "If"}], " ", "\[Tau]T", " ", "contains", " ", 
    "repeated", " ", "UnderBarred", " ", "indices", " ", "___", " ", 
    RowBox[{"SubMinus", "[", 
     RowBox[{"UnderBar", "[", "\[Mu]", "]"}], "]"}], " ", "___", " ", 
    RowBox[{"SuperMinus", "[", 
     RowBox[{"UnderBar", "[", "\[Mu]", "]"}], "]"}], " ", "___", " ", "then", 
    " ", "these", " ", "indices", " ", "are", " ", "\"\<scalars\>\"", " ", 
    "and", " ", "do", " ", "not", " ", "take", " ", "part", " ", "in", " ", 
    "the", " ", "CovariantD", " ", "process"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Note", " ", 
     RowBox[{"III", ".", " ", "Internally"}], " ", "we", " ", "build", " ", 
     "the", " ", "CovariantD", " ", "as", " ", "a", " ", "Tensor", " ", 
     "with", " ", "abstract", " ", "indices", " ", "then", " ", "replace", 
     " ", "the", " ", "Del"}], "-", 
    RowBox[{"index", " ", "with", " ", "\[Mu]T"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CovariantD", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"(*", 
          RowBox[{"Not", " ", "allow", " ", "OverHatIndices", " ", "for", " ", 
           RowBox[{"now", "."}]}], "*)"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TestIndices", "[", "\[Mu]T", "]"}], "&&", 
           RowBox[{"!", 
            RowBox[{"TestOverHatIndex", "[", "\[Mu]T", "]"}]}]}], ")"}]}], 
        ",", "\[Tau]T_Tensor", ",", "m_Tensor"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"(*", " ", 
        RowBox[{
        "We", " ", "have", " ", "already", " ", "dealt", " ", "with", " ", 
         "scalars"}], " ", "*)"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"!", 
          RowBox[{"TestScalarTensor", "[", "\[Tau]T", "]"}]}], ")"}], "&&", 
        RowBox[{"(*", " ", 
         RowBox[{"check", " ", "m", " ", "is", " ", "a", " ", "Metric"}], " ",
          "*)"}], 
        RowBox[{"(", 
         RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}], "&&", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"\[Del]", " ", "on"}], " ", "\[CapitalGamma]", " ", "is", 
          " ", "not", " ", "a", " ", "correct", " ", 
          RowBox[{"definition", "."}]}], "*)"}], 
        RowBox[{"(*", 
         RowBox[{
         "Do", " ", "not", " ", "allow", " ", "CovariantD", " ", "operator", 
          " ", "on", " ", "a", " ", "Christoffel"}], "*)"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TensorTypeNoPart", "[", "\[Tau]T", "]"}], "=!=", 
          RowBox[{"{", "\"\<ChristoffelSymbols\>\"", "}"}]}], ")"}], "&&", 
        RowBox[{"MatchQ", "[", 
         RowBox[{"\[Mu]T", ",", 
          RowBox[{"SubMinus", "[", "_", "]"}]}], "]"}], "&&", 
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"check", " ", "for", " ", "non"}], "-", 
           RowBox[{"repeating", " ", "UnderBarred", " ", "Indices"}]}], " ", 
          "*)"}], 
         RowBox[{
          RowBox[{"RemoveRepeatedUnderBarredIndices", "[", 
           RowBox[{"Union", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"Indices", "[", "\[Tau]T", "]"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"SuperMinus", "|", "SubMinus"}], ")"}], "[", 
                RowBox[{"UnderBar", "[", "_", "]"}], "]"}], ",", 
               "\[Infinity]"}], "]"}], "]"}], "]"}], "]"}], "===", 
          RowBox[{"{", "}"}]}], ")"}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"NewCode", ":", " ", 
           RowBox[{"\[Del]", "g"}]}], "=", "0"}], "*)"}], "&&", 
        RowBox[{"(", 
         RowBox[{"\[Tau]T", "=!=", "m"}], ")"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coords", ",", "ttM", ",", "\[Mu]TT", ",", "\[CapitalGamma]M", ",", 
         "grad", ",", "\[Mu]", ",", "\[Nu]", ",", "\[Sigma]", ",", 
         "\[Lambda]", ",", "\[Kappa]", ",", "lgth", ",", "idx", ",", "ii", 
         ",", "invmetricM", ",", "\[CapitalSigma]", ",", "indices", ",", 
         "TensorMatrix", ",", "ChristT", ",", "partialT", ",", "output", ",", 
         "out", ",", "outputindices"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Christoffel", " ", "symbol"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalGamma]M", "=", 
         RowBox[{"TensorComponents", "[", 
          RowBox[{"Christoffel", "[", 
           RowBox[{
            SuperscriptBox["\[Mu]", "-"], ",", 
            SubscriptBox["\[Nu]", "-"], ",", 
            SubscriptBox["\[Sigma]", "-"], ",", "m"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "output", " ", "Tensor", " ", "has", " ", "the", " ", "following", 
          " ", "indices"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"outputindices", "=", 
         RowBox[{"{", 
          RowBox[{"\[Mu]T", ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"Indices", "[", "\[Tau]T", "]"}]}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", "coordinates"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"coords", "=", 
         RowBox[{"Coordinates", "[", "m", "]"}]}], ";", 
        RowBox[{"lgth", "=", 
         RowBox[{"Length", "[", "coords", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", "StartIndex"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"idx", "=", 
         RowBox[{"StartIndex", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", "indices", " ", "of", " ", "\[Tau]T"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "remove", " ", "repeated", " ", "UnderBarred", " ", "indices", " ", 
          "because", " ", "they", " ", "are", " ", "irrelevant", " ", "as", 
          " ", "far", " ", "as", " ", "CovariantD", " ", "is", " ", 
          "concerned"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"indices", "=", 
         RowBox[{"RemoveRepeatedUnderBarredIndices", "[", 
          RowBox[{"Indices", "[", "\[Tau]T", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "extract", " ", "components", " ", "of", " ", "\[Tau]T", " ", "as", 
          " ", "a", " ", "matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"TensorMatrix", "=", 
         RowBox[{"TensorComponents", "[", "\[Tau]T", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"partial", " ", "derivative", " ", "terms"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"partialT", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"TensorMatrix", ",", 
             RowBox[{
             "coords", "\[LeftDoubleBracket]", "\[Sigma]", 
              "\[RightDoubleBracket]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Sigma]", ",", "1", ",", 
             RowBox[{"Length", "[", "coords", "]"}]}], "}"}]}], 
          RowBox[{"(*", 
           RowBox[{",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"(", 
              RowBox[{"Sequence", "@@", "\[Lambda]"}], ")"}], "]"}]}], "*)"}],
           "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Christoffel", " ", "terms"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"ChristT", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ChristT", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"ChristT", ",", 
             RowBox[{
              RowBox[{"Sgn", "[", 
               RowBox[{
               "indices", "\[LeftDoubleBracket]", "\[Sigma]", 
                "\[RightDoubleBracket]"}], "]"}], 
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"TensorContract", "[", 
                 RowBox[{
                  RowBox[{"TensorProduct", "[", 
                   RowBox[{"\[CapitalGamma]M", ",", "TensorMatrix"}], "]"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Which", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sgn", "[", 
                    RowBox[{
                    "indices", "\[LeftDoubleBracket]", "\[Sigma]", 
                    "\[RightDoubleBracket]"}], "]"}], "\[Equal]", "1"}], ",", 
                    "3", ",", 
                    RowBox[{
                    RowBox[{"Sgn", "[", 
                    RowBox[{
                    "indices", "\[LeftDoubleBracket]", "\[Sigma]", 
                    "\[RightDoubleBracket]"}], "]"}], "\[Equal]", 
                    RowBox[{"-", "1"}]}], ",", "1"}], "]"}], ",", 
                    RowBox[{"3", "+", "\[Sigma]"}]}], "}"}], "}"}]}], "]"}], 
                ",", 
                RowBox[{"Which", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Sgn", "[", 
                    RowBox[{
                    "indices", "\[LeftDoubleBracket]", "\[Sigma]", 
                    "\[RightDoubleBracket]"}], "]"}], "\[Equal]", "1"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Sigma]", "+", "1"}], ",", "1", ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", ",", "\[Sigma]"}], "]"}]}], ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "+", "2"}], ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "indices", "]"}], "+", "1"}]}], 
                    "]"}]}]}], "}"}], ",", 
                  RowBox[{
                   RowBox[{"Sgn", "[", 
                    RowBox[{
                    "indices", "\[LeftDoubleBracket]", "\[Sigma]", 
                    "\[RightDoubleBracket]"}], "]"}], "\[Equal]", 
                   RowBox[{"-", "1"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"\[Sigma]", "+", "1"}], ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", ",", "\[Sigma]"}], "]"}]}], ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "+", "2"}], ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "indices", "]"}], "+", "1"}]}], 
                    "]"}]}]}], "}"}]}], "]"}]}], "]"}]}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Sigma]", ",", "1", ",", 
            RowBox[{"Length", "[", "indices", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ChristT", "=", 
         RowBox[{"Plus", "@@", "ChristT"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"partialT", "+", "ChristT"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "return", " ", "Tensor", " ", "by", " ", "prepending", " ", "Del"}],
           "-", 
          RowBox[{
          "index", " ", "\[Mu]T", " ", "and", " ", "Applying", " ", "Del", 
           " ", "to", " ", "TensorName", " ", "and", " ", "replacing", " ", 
           "TensorComponents"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"\[Tau]T", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "iii_"}], ")"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", 
              RowBox[{"Prepend", "[", 
               RowBox[{"iii", ",", "\[Mu]T"}], "]"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", "nnn_"}], ")"}], 
            "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", 
              RowBox[{"Del", "[", 
               RowBox[{"TensorName", "[", "\[Tau]T", "]"}], "]"}]}], ")"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "ccc_"}], ")"}], 
            "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "output"}], ")"}]}]}], 
          "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Covariant", " ", "derivative", " ", 
     StyleBox[
      RowBox[{
       SuperscriptBox["\[Del]", "\[Mu]"], "Tensor"}],
      FontColor->RGBColor[0.5, 0, 0.5]], " ", "using", " ", "the", " ", 
     "metric", " ", "m"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CovariantD", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"(*", 
          RowBox[{"Not", " ", "allow", " ", "OverHatIndices", " ", "for", " ", 
           RowBox[{"now", "."}]}], "*)"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TestIndices", "[", "\[Mu]T", "]"}], "&&", 
           RowBox[{"!", 
            RowBox[{"TestOverHatIndex", "[", "\[Mu]T", "]"}]}]}], ")"}]}], 
        ",", "\[Tau]T_Tensor", ",", "m_Tensor"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"(*", " ", 
        RowBox[{
        "We", " ", "have", " ", "already", " ", "dealt", " ", "with", " ", 
         "scalars"}], " ", "*)"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"!", 
          RowBox[{"TestScalarTensor", "[", "\[Tau]T", "]"}]}], ")"}], "&&", 
        RowBox[{"(*", " ", 
         RowBox[{"check", " ", "m", " ", "is", " ", "a", " ", "Metric"}], " ",
          "*)"}], 
        RowBox[{"(", 
         RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}], "&&", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"\[Del]", " ", "on"}], " ", "\[CapitalGamma]", " ", "is", 
          " ", "not", " ", "a", " ", "correct", " ", 
          RowBox[{"definition", "."}]}], "*)"}], 
        RowBox[{"(*", 
         RowBox[{
         "Do", " ", "not", " ", "allow", " ", "CovariantD", " ", "operator", 
          " ", "on", " ", "a", " ", "Christoffel"}], "*)"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TensorTypeNoPart", "[", "\[Tau]T", "]"}], "=!=", 
          RowBox[{"{", "\"\<ChristoffelSymbols\>\"", "}"}]}], ")"}], "&&", 
        RowBox[{"MatchQ", "[", 
         RowBox[{"\[Mu]T", ",", 
          RowBox[{"SuperMinus", "[", "_", "]"}]}], "]"}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"NewCode", ":", " ", 
           RowBox[{"\[Del]", "g"}]}], "=", "0"}], "*)"}], "&&", 
        RowBox[{"(", 
         RowBox[{"\[Tau]T", "=!=", "m"}], ")"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Sigma]", ",", "\[Mu]TT", ",", "tempT"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tempT", "=", 
         RowBox[{"CovariantD", "[", 
          RowBox[{
           SubscriptBox["\[Sigma]", "-"], ",", "\[Tau]T", ",", "m"}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"\[Tau]T", "/.", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "iii_"}], ")"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", 
              RowBox[{"Prepend", "[", 
               RowBox[{"iii", ",", "\[Mu]T"}], "]"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", "nnn_"}], ")"}], 
            "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", 
              RowBox[{"Del", "[", 
               RowBox[{"TensorName", "[", "\[Tau]T", "]"}], "]"}]}], ")"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "ccc_"}], ")"}], 
            "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", 
              RowBox[{"TensorContract", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{
                  RowBox[{"TensorComponents", "[", 
                   RowBox[{"Metric", "[", 
                    RowBox[{
                    SuperscriptBox["\[Mu]TT", "-"], ",", 
                    SuperscriptBox["\[Sigma]", "-"], ",", "m"}], "]"}], "]"}],
                   ",", 
                  RowBox[{"TensorComponents", "[", "tempT", "]"}]}], "]"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", "3"}], "}"}], "}"}]}], "]"}]}], ")"}]}]}],
           "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"NewCode", ":", " ", 
      StyleBox[
       RowBox[{"\[Del]", "g"}],
       FontColor->RGBColor[0.5, 0, 0.5]]}], 
     StyleBox["=",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox["0",
      FontColor->RGBColor[0.5, 0, 0.5]]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CovariantD", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", "m_Tensor", ",", 
        "m_Tensor"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"(*", " ", 
        RowBox[{
        "We", " ", "have", " ", "already", " ", "dealt", " ", "with", " ", 
         "scalars"}], " ", "*)"}], 
       RowBox[{"(*", " ", 
        RowBox[{"check", " ", "m", " ", "is", " ", "a", " ", "Metric"}], " ", 
        "*)"}], 
       RowBox[{"(", 
        RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}], ")"}]}], ":=", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Utilize", " ", "ZeroTensor", " ", "in", " ", 
        StyleBox[
         RowBox[{"\[Del]", "g"}],
         FontColor->RGBColor[0.5, 0, 0.5]]}], 
       StyleBox["=",
        FontColor->RGBColor[0.5, 0, 0.5]], 
       StyleBox["0",
        FontColor->RGBColor[0.5, 0, 0.5]]}], "*)"}], 
     RowBox[{"ZeroTensor", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "\[Mu]T", "}"}], ",", 
         RowBox[{"Indices", "[", "m", "]"}]}], "]"}], ",", 
       RowBox[{"TensorName", "->", 
        RowBox[{"TensorName", "[", "m", "]"}]}], ",", 
       RowBox[{"Coordinates", "\[Rule]", 
        RowBox[{"Coordinates", "[", "m", "]"}]}], ",", 
       RowBox[{"StartIndex", "->", 
        RowBox[{"StartIndex", "[", "m", "]"}]}], ",", 
       RowBox[{"TooltipDisplay", "->", 
        RowBox[{"TooltipDisplay", "[", "m", "]"}]}], ",", 
       RowBox[{"TensorType", "->", 
        RowBox[{"TensorType", "[", "m", "]"}]}], ",", 
       RowBox[{"TooltipStyle", "->", 
        RowBox[{"TooltipStyle", "[", "m", "]"}]}], ",", 
       RowBox[{"TooltipStyle", "->", 
        RowBox[{"TooltipStyle", "[", "m", "]"}]}], ",", 
       RowBox[{"TensorAssumption", "->", 
        RowBox[{"TensorAssumption", "[", "m", "]"}]}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.5760890361958838`*^9, 
   3.5760892921299334`*^9}, {3.576089327198795*^9, 3.5760893665108643`*^9}, {
   3.5760894467730045`*^9, 3.576089487177076*^9}, {3.576089599746874*^9, 
   3.576089794357215*^9}, {3.5760898355568876`*^9, 3.576089917379031*^9}, {
   3.576089953181094*^9, 3.576090082318121*^9}, {3.576560147053269*^9, 
   3.5765603514136276`*^9}, {3.5765603906008964`*^9, 3.576560411879334*^9}, {
   3.5765604668226304`*^9, 3.576560468913034*^9}, {3.5765932405918536`*^9, 
   3.576593241668256*^9}, {3.5765932876571364`*^9, 3.576593294365148*^9}, {
   3.576593413472658*^9, 3.5765934397421603`*^9}, {3.605905899085953*^9, 
   3.6059059169323845`*^9}, {3.605907375690477*^9, 3.605907376732993*^9}, {
   3.6059074214866805`*^9, 3.605907435022888*^9}, {3.6059074983508615`*^9, 
   3.605907502648427*^9}, {3.6059106918570814`*^9, 3.6059107179519825`*^9}, {
   3.6059108386183357`*^9, 3.605910859590658*^9}, {3.6059116367090964`*^9, 
   3.605911650068802*^9}, {3.605911842169753*^9, 3.605911895881578*^9}, {
   3.6059120020907097`*^9, 3.605912034981715*^9}, 3.6059120952461405`*^9, {
   3.605912172252824*^9, 3.605912231088728*^9}, {3.605912379985015*^9, 
   3.6059124141760397`*^9}, {3.605912547647091*^9, 3.6059125726254745`*^9}, 
   3.605912640557518*^9, {3.6059126921018095`*^9, 3.6059126993344207`*^9}, {
   3.606149316082368*^9, 3.6061493231657734`*^9}, {3.606149361203949*^9, 
   3.6061493833582163`*^9}, {3.6061495021670113`*^9, 
   3.6061496018337126`*^9}, {3.606149696681137*^9, 3.6061496971501637`*^9}, {
   3.6061497349753275`*^9, 3.6061497839071264`*^9}, {3.606149914846616*^9, 
   3.606149946487425*^9}, {3.6061501075506372`*^9, 3.6061501127199335`*^9}, {
   3.6061502607564*^9, 3.606150297869523*^9}, {3.6061503439731603`*^9, 
   3.606150399802354*^9}, {3.606150444232895*^9, 3.6061504505792575`*^9}, {
   3.6061506412691646`*^9, 3.60615079783912*^9}, {3.60615087215137*^9, 
   3.6061509190810547`*^9}, {3.6061510026398335`*^9, 
   3.6061510695636616`*^9}, {3.6061511012804756`*^9, 
   3.6061511022065287`*^9}, {3.606151174042638*^9, 3.6061511979290037`*^9}, {
   3.606151255141276*^9, 3.6061512782155957`*^9}, {3.6061517274972935`*^9, 
   3.606151749276539*^9}, {3.6061517850545855`*^9, 3.606151830330175*^9}, {
   3.606152246977006*^9, 3.6061522732695093`*^9}, 3.6061523568362894`*^9, {
   3.6061619084720783`*^9, 3.6061619096576805`*^9}, {3.606163263240858*^9, 
   3.606163263958459*^9}, {3.606163314471348*^9, 3.6061633160781507`*^9}, {
   3.606163378774661*^9, 3.606163413422322*^9}, 3.6061634632956095`*^9, {
   3.6061634941836634`*^9, 3.6061634946204643`*^9}, {3.6061635412957463`*^9, 
   3.6061636943476152`*^9}, {3.606163895151168*^9, 3.606163937037242*^9}, {
   3.6061640041329594`*^9, 3.606164018765785*^9}, {3.6061643337615385`*^9, 
   3.606164422744095*^9}, {3.6061645384026976`*^9, 3.6061645529731236`*^9}, {
   3.6061654490542974`*^9, 3.6061654690691323`*^9}, {3.6061656900123205`*^9, 
   3.6061657122579594`*^9}, {3.6061657561408367`*^9, 3.606165776280472*^9}, {
   3.6061659695336113`*^9, 3.6061659923564515`*^9}, {3.606166075114597*^9, 
   3.606166187918395*^9}, {3.6061662676657352`*^9, 3.6061662925945787`*^9}, {
   3.606166335837855*^9, 3.6061664592808714`*^9}, {3.6061665321329994`*^9, 
   3.6061665641286554`*^9}, {3.6061666252651634`*^9, 3.606166626559965*^9}, {
   3.6063210736379833`*^9, 3.6063210791355677`*^9}, 3.6063211492396445`*^9, {
   3.6063214202253075`*^9, 3.6063214618209467`*^9}, {3.606321625917968*^9, 
   3.6063216294880223`*^9}, {3.606321667340104*^9, 3.6063217452043004`*^9}, {
   3.6063218135733504`*^9, 3.6063218276655664`*^9}, {3.6063219714327755`*^9, 
   3.6063219994062057`*^9}, {3.606322158748153*^9, 3.6063222015913115`*^9}, {
   3.6063222598307066`*^9, 3.6063223402784424`*^9}, 3.606322462443319*^9, {
   3.6063226653409357`*^9, 3.6063227108891354`*^9}, {3.6063228320104966`*^9, 
   3.606322832784009*^9}, {3.6063229617499895`*^9, 3.606322969966116*^9}, {
   3.6063230880534306`*^9, 3.60632308867344*^9}, {3.606323326792098*^9, 
   3.606323351907984*^9}, {3.6063241585333757`*^9, 3.606324176213147*^9}, {
   3.6063242390986137`*^9, 3.606324282976787*^9}, {3.6063252896207523`*^9, 
   3.606325335455456*^9}, {3.606325382408677*^9, 3.6063254796761713`*^9}, 
   3.6063255205958004`*^9, {3.6063256422796693`*^9, 3.6063256443697014`*^9}, {
   3.6063257654995623`*^9, 3.6063257718131595`*^9}, {3.6063259134153347`*^9, 
   3.6063259413512635`*^9}, {3.6063641741698074`*^9, 3.606364192141835*^9}, {
   3.6063962921905727`*^9, 3.606396292923774*^9}, {3.606397566017028*^9, 
   3.606397636689613*^9}, {3.6063987641059313`*^9, 3.6063987870742846`*^9}, {
   3.6063993176404343`*^9, 3.6063993563175287`*^9}, 3.606399599800769*^9, {
   3.6063996475075016`*^9, 3.6063996743244133`*^9}, {3.606400359189934*^9, 
   3.606400359405937*^9}, {3.6064147318617353`*^9, 3.606414780243503*^9}, {
   3.606414942771799*^9, 3.606414968356262*^9}, {3.606415002285203*^9, 
   3.6064150066924553`*^9}, {3.606415050503961*^9, 3.6064150561282825`*^9}, {
   3.60641510398302*^9, 3.606415107171202*^9}, {3.606415149653632*^9, 
   3.606415271963628*^9}, {3.606415318698301*^9, 3.6064153496960735`*^9}, {
   3.606415439297199*^9, 3.6064154439654655`*^9}, {3.6064155734418716`*^9, 
   3.606415614767235*^9}, {3.606416011403921*^9, 3.6064160367773724`*^9}, {
   3.6064160876492825`*^9, 3.606416106172342*^9}, {3.6064161413863564`*^9, 
   3.606416153926073*^9}, {3.606416201531796*^9, 3.6064162124114184`*^9}, {
   3.6064164226034403`*^9, 3.6064164262046466`*^9}, {3.606416461872687*^9, 
   3.606416519591988*^9}, {3.606416656556822*^9, 3.6064166609770746`*^9}, {
   3.6064168185180855`*^9, 3.6064168709460845`*^9}, {3.606416957848055*^9, 
   3.606416979023266*^9}, {3.6064171656359396`*^9, 3.606417188828266*^9}, {
   3.606417281174548*^9, 3.606417326051115*^9}, {3.6064173998823376`*^9, 
   3.606417433523262*^9}, {3.606417467458203*^9, 3.606417500314082*^9}, {
   3.606417563021669*^9, 3.606417603650993*^9}, {3.60641768716877*^9, 
   3.6064176935111322`*^9}, {3.6064177622060614`*^9, 
   3.6064178086767197`*^9}, {3.6064178503651037`*^9, 3.606417878485712*^9}, {
   3.6064179976875305`*^9, 3.6064180039158864`*^9}, {3.606418123197709*^9, 
   3.606418125106818*^9}, {3.6064182368102074`*^9, 3.606418260005534*^9}, {
   3.6064183038340406`*^9, 3.606418342140232*^9}, {3.606418430367278*^9, 
   3.6064184936949005`*^9}, {3.6064185644959497`*^9, 
   3.6064185666510735`*^9}, {3.606418677719426*^9, 3.606418679805545*^9}, {
   3.606436543470795*^9, 3.6064365573235874`*^9}, {3.6064365990219727`*^9, 
   3.606436622187298*^9}, {3.606436806983867*^9, 3.6064368072418823`*^9}, {
   3.6064369956476583`*^9, 3.6064369958616705`*^9}, {3.6064371207458134`*^9, 
   3.6064371247680435`*^9}, {3.606437206666728*^9, 3.606437213891141*^9}, {
   3.6064373010921288`*^9, 3.606437333845002*^9}, {3.606437504073738*^9, 
   3.606437504289751*^9}, {3.6064379454409833`*^9, 3.606437960092821*^9}, {
   3.60643800237824*^9, 3.6064380077955494`*^9}, 3.606438145670436*^9, {
   3.606438258982917*^9, 3.6064382599669733`*^9}, {3.6064386627170095`*^9, 
   3.6064386728355875`*^9}, 3.6064387767465315`*^9, {3.6064388356599007`*^9, 
   3.606438842335283*^9}, {3.606438893568213*^9, 3.6064389037777967`*^9}, {
   3.6064390608037786`*^9, 3.606439094682716*^9}, {3.60643915822235*^9, 
   3.606439168216922*^9}, {3.60643921800677*^9, 3.6064392821324377`*^9}, {
   3.6064393296501555`*^9, 3.6064393487792497`*^9}, {3.606439485563073*^9, 
   3.6064395051461935`*^9}, {3.6064399730149536`*^9, 
   3.6064399878037996`*^9}, {3.6064400590218735`*^9, 3.606440076553876*^9}, {
   3.606440176433589*^9, 3.606440197594799*^9}, {3.6064402464825954`*^9, 
   3.606440253792013*^9}, {3.606440304795931*^9, 3.6064403077140975`*^9}, {
   3.606440524532499*^9, 3.60644052752067*^9}, {3.6064406171897984`*^9, 
   3.6064406209470134`*^9}, {3.6064407805891447`*^9, 3.606440787295528*^9}, {
   3.6064408236496077`*^9, 3.606440826737784*^9}, {3.606440856834505*^9, 
   3.606440861141752*^9}, {3.606440938633184*^9, 3.6064409772093906`*^9}, {
   3.606441053326744*^9, 3.606441106262772*^9}, 3.606444049039694*^9, 
   3.6064453186513114`*^9, {3.606445356832495*^9, 3.6064453903224106`*^9}, {
   3.6064460612407846`*^9, 3.606446065857049*^9}, {3.6064472620654683`*^9, 
   3.6064472653066535`*^9}, {3.6064473773500624`*^9, 3.60644741524823*^9}, {
   3.6064479502198286`*^9, 3.606447954931098*^9}, {3.6064484225688453`*^9, 
   3.606448439300802*^9}, {3.6064485513762126`*^9, 3.6064485981438875`*^9}, {
   3.6064491456562033`*^9, 3.606449146282239*^9}, {3.6064500206902523`*^9, 
   3.6064500424354963`*^9}, {3.6064501861307154`*^9, 
   3.6064502041757474`*^9}, {3.6064503561234384`*^9, 3.606450386525177*^9}, {
   3.606450434761936*^9, 3.606450439513208*^9}, {3.606451475026436*^9, 
   3.6064514993578277`*^9}, {3.6064516406889114`*^9, 3.606451641669967*^9}, {
   3.606451678449071*^9, 3.6064516793211207`*^9}, {3.6064517315281067`*^9, 
   3.606451759627714*^9}, {3.606451796842843*^9, 3.6064518143328433`*^9}, {
   3.6064519192058415`*^9, 3.6064519258752227`*^9}, {3.606452216699857*^9, 
   3.6064522186629696`*^9}, {3.6064522760802536`*^9, 
   3.6064522873698993`*^9}, {3.6064970666377306`*^9, 3.606497093791284*^9}, {
   3.6065038281633205`*^9, 3.606503840282014*^9}, 3.6065039166513815`*^9, {
   3.6065040202203054`*^9, 3.6065040491359596`*^9}, {3.6065040977297387`*^9, 
   3.606504108380348*^9}, {3.606504661197423*^9, 3.6065046902290745`*^9}, {
   3.6065048228917074`*^9, 3.6065048766026015`*^9}, {3.6065051618482494`*^9, 
   3.6065051665282574`*^9}, {3.6065053048849*^9, 3.6065053281289415`*^9}, {
   3.6065053664738083`*^9, 3.606505366676609*^9}, {3.6065058994799447`*^9, 
   3.606505899916745*^9}, {3.6065060448254004`*^9, 3.6065060450282*^9}, {
   3.606507180334243*^9, 3.606507190269811*^9}, {3.606507227590946*^9, 
   3.606507233061259*^9}, {3.6065075649162397`*^9, 3.60650759935421*^9}, {
   3.6065118524739714`*^9, 3.606511873380167*^9}, {3.6065119107953067`*^9, 
   3.60651192204195*^9}, {3.6065119620362377`*^9, 3.606512020667591*^9}, {
   3.6065120648481183`*^9, 3.6065120652151394`*^9}, {3.606512300743611*^9, 
   3.6065123180115986`*^9}, {3.606513025830083*^9, 3.60651306913056*^9}, {
   3.6065131466389933`*^9, 3.60651315585252*^9}, 3.606514109189048*^9, {
   3.6065143855958576`*^9, 3.6065143962424664`*^9}, {3.6065144404339943`*^9, 
   3.606514443546172*^9}, {3.606514516508345*^9, 3.606514606479491*^9}, {
   3.606514642402546*^9, 3.606514647298826*^9}, {3.60657601305414*^9, 
   3.606576025845872*^9}, {3.6294885962975087`*^9, 3.6294885968975096`*^9}, {
   3.6294887670077477`*^9, 3.6294887811277676`*^9}, 3.629488946017998*^9, 
   3.6294889762180405`*^9, {3.6296799808714633`*^9, 3.6296800186377373`*^9}, {
   3.6296800765780973`*^9, 3.6296800878709183`*^9}, {3.6296851347661448`*^9, 
   3.6296851379193497`*^9}, {3.629685349895347*^9, 3.6296853630081725`*^9}, {
   3.629687834535861*^9, 3.6296878493575363`*^9}, {3.629687948266225*^9, 
   3.629687974576489*^9}, {3.629688037883552*^9, 3.629688063712802*^9}, {
   3.6296883160957127`*^9, 3.629688343615058*^9}, {3.629688397209632*^9, 
   3.629688550367888*^9}, {3.6296886595640845`*^9, 3.6296887226079693`*^9}, {
   3.6296888438827596`*^9, 3.629688845144821*^9}, {3.6296892354808598`*^9, 
   3.629689305209598*^9}, {3.629689337167848*^9, 3.629689419362879*^9}, {
   3.6296919656916075`*^9, 3.6296919761680284`*^9}, {3.629693840199733*^9, 
   3.629693883066039*^9}, {3.629694123954773*^9, 3.629694194523058*^9}, {
   3.6296947833640385`*^9, 3.629694888216888*^9}, {3.629694974957252*^9, 
   3.6296949794912605`*^9}, {3.629695016853715*^9, 3.629695019568119*^9}, {
   3.629695068915369*^9, 3.629695070147771*^9}, {3.629695109662041*^9, 
   3.629695114045649*^9}, {3.629695201142003*^9, 3.629695257094702*^9}, {
   3.62969537974232*^9, 3.6296954018213587`*^9}, {3.629696180423136*^9, 
   3.6296961858685455`*^9}, {3.6296963162037787`*^9, 3.629696339169019*^9}, {
   3.629696377961688*^9, 3.6296963834996977`*^9}, {3.6296965025197077`*^9, 
   3.6296965251135483`*^9}, {3.629696620824117*^9, 3.629696632212137*^9}, {
   3.629696802275838*^9, 3.6296968542465296`*^9}, {3.629696951030902*^9, 
   3.6296970408562603`*^9}, {3.6296971532200594`*^9, 
   3.6296971742090964`*^9}, {3.6296972117497625`*^9, 
   3.6296972119681635`*^9}, {3.6296983718489113`*^9, 3.629698430922616*^9}, {
   3.6297274409048233`*^9, 3.629727464498066*^9}, {3.629727549906616*^9, 
   3.629727575325061*^9}, {3.6298456915444603`*^9, 3.629845701823281*^9}, {
   3.6298466291949453`*^9, 3.629846666829425*^9}, {3.6298469219078183`*^9, 
   3.629846938961754*^9}, {3.6298479732442703`*^9, 3.629847981134386*^9}, {
   3.6298483244007435`*^9, 3.6298483318414574`*^9}, {3.6298495776124363`*^9, 
   3.6298496207215223`*^9}, {3.6298535794568644`*^9, 
   3.6298536651670313`*^9}, {3.6298565207288785`*^9, 3.629856553513338*^9}, {
   3.629856638479088*^9, 3.629856659976926*^9}, {3.629857007221711*^9, 
   3.629857185623915*^9}, {3.629857221652976*^9, 3.6298572354907675`*^9}, {
   3.6298578357671013`*^9, 3.629857837127179*^9}, {3.6298579337247043`*^9, 
   3.6298579347447624`*^9}, {3.6298583272482123`*^9, 3.629858336241727*^9}, {
   3.62985863141861*^9, 3.629858633529731*^9}, {3.6298587849903936`*^9, 
   3.629858787928562*^9}, {3.6298588330311413`*^9, 3.629858860998741*^9}, {
   3.6298589360020313`*^9, 3.6298589428714237`*^9}, {3.629858986492919*^9, 
   3.6298589905491514`*^9}, 3.6298590768890896`*^9, {3.6298591288600616`*^9, 
   3.629859140505728*^9}, {3.6298591782148848`*^9, 3.6298591787819176`*^9}, {
   3.6298602983039503`*^9, 3.6298603530510817`*^9}, {3.6298662871976805`*^9, 
   3.6298662977812347`*^9}, {3.6298663995469913`*^9, 
   3.6298664025379076`*^9}, {3.629867805946912*^9, 3.629867863096182*^9}, {
   3.629867907431799*^9, 3.6298679076657996`*^9}, {3.629867938097679*^9, 
   3.629867942122688*^9}, {3.6299139619990625`*^9, 3.6299139692841744`*^9}, 
   3.671908904118229*^9, 3.6727825694188104`*^9, 3.8369896805153723`*^9, {
   3.83764986288929*^9, 3.8376498671872916`*^9}, {3.837838656273379*^9, 
   3.8378387039192147`*^9}, 3.8472499200590096`*^9, 3.8532237132671375`*^9, 
   3.853223744107195*^9, {3.869790046313202*^9, 3.8697900466362724`*^9}, {
   3.869790100943827*^9, 3.8697901116435556`*^9}, {3.869808600445554*^9, 
   3.8698086072607145`*^9}, {3.870379759221089*^9, 3.870379769386881*^9}, {
   3.870379800772721*^9, 3.870379878527249*^9}, {3.8715995119537926`*^9, 
   3.8715995408576403`*^9}, {3.871599802259035*^9, 3.8715998052356873`*^9}, {
   3.871601058687648*^9, 3.8716011337588415`*^9}, {3.871601315154941*^9, 
   3.8716013639269595`*^9}, 3.8720517480861735`*^9, {3.873342406760987*^9, 
   3.8733424154046345`*^9}, {3.8733424556973977`*^9, 
   3.8733424768360386`*^9}, {3.8757566002331114`*^9, 3.875756751202136*^9}, {
   3.892619954585307*^9, 3.8926199799615965`*^9}, {3.8926200982950354`*^9, 
   3.892620099156139*^9}, {3.8932891244954023`*^9, 3.893289124501398*^9}, {
   3.8950732615688725`*^9, 3.8950732615688725`*^9}, {3.8955490515387244`*^9, 
   3.895549051548718*^9}, {3.895554774826993*^9, 3.8955547748379946`*^9}, {
   3.895555172385603*^9, 3.8955551723955975`*^9}, {3.89555533992622*^9, 
   3.8955553399322157`*^9}, 3.970887626113698*^9, 3.972501946485209*^9, {
   3.975312832501719*^9, 
   3.9753130378471823`*^9}},ExpressionUUID->"7307a0e2-ee1d-4d18-b16b-\
642b8bd73765"]
}, Closed]],

Cell[CellGroupData[{

Cell["CovariantBox", "Subsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.533880012946951*^9, 3.5338800148345547`*^9}, {
   3.5760890087086353`*^9, 
   3.5760890111890397`*^9}},ExpressionUUID->"0e73ee14-ddc6-4094-897f-\
e020160790d0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Box", " ", "on", " ", "scalar", " ", "function", " ", "f"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"=", " ", 
    RowBox[{
     RowBox[{"g", "^", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}], "}"}]}], " ", 
     RowBox[{"\[PartialD]", "_\[Mu]"}], " ", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"g", "^", 
        RowBox[{"{", 
         RowBox[{"1", "/", "2"}], "}"}]}], " ", 
       RowBox[{"g", "^", 
        RowBox[{"{", "\[Mu]\[Nu]", "}"}]}], " ", 
       RowBox[{"\[PartialD]", "_\[Nu]"}], " ", "f"}], " ", ")"}]}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"\[PartialD]", "_\[Mu]"}], " ", 
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"g", "^", 
         RowBox[{"{", "\[Mu]\[Nu]", "}"}]}], " ", 
        RowBox[{"\[PartialD]", "_\[Nu]"}], " ", "f"}], " ", ")"}]}], " ", "+",
      " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[PartialD]", "_\[Mu]"}], " ", "ln", " ", 
        RowBox[{"g", "^", 
         RowBox[{"{", 
          RowBox[{"1", "/", "2"}], "}"}]}]}], ")"}], " ", 
      RowBox[{"g", "^", 
       RowBox[{"{", "\[Mu]\[Nu]", "}"}]}], " ", 
      RowBox[{"\[PartialD]", "_\[Nu]"}], " ", "f"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"\[PartialD]", "_\[Mu]"}], " ", 
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"g", "^", 
         RowBox[{"{", "\[Mu]\[Nu]", "}"}]}], " ", 
        RowBox[{"\[PartialD]", "_\[Nu]"}], " ", "f"}], " ", ")"}]}], " ", "+",
      " ", 
     RowBox[{
      RowBox[{"\[CapitalGamma]", "^", "\[Mu]_"}], 
      RowBox[{"{", "\[Mu]\[Lambda]", "}"}], " ", 
      RowBox[{"g", "^", 
       RowBox[{"{", "\[Lambda]\[Nu]", "}"}]}], " ", 
      RowBox[{"\[PartialD]", "_\[Nu]"}], " ", "f"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CovariantBox", "[", 
       RowBox[{"stuff_", ",", "m_Tensor"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"TestExpressionForm", "[", "stuff", "]"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coords", ",", "grad", ",", "\[Mu]", ",", "\[Nu]", ",", "\[Lambda]", 
         ",", "lgth", ",", "idx", ",", "ii"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coords", "=", 
         RowBox[{"Coordinates", "[", "m", "]"}]}], ";", 
        RowBox[{"lgth", "=", 
         RowBox[{"Length", "[", "coords", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"idx", "=", 
         RowBox[{"StartIndex", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"g", "^", 
           RowBox[{"{", "\[Mu]\[Nu]", "}"}]}], " ", 
          RowBox[{"\[PartialD]", "_\[Nu]"}], " ", "stuff"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"grad", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Metric", "[", 
               RowBox[{
                SuperscriptBox["\[Mu]", "-"], ",", 
                SuperscriptBox["\[Nu]", "-"], ",", "m"}], "]"}], 
              RowBox[{"D", "[", 
               RowBox[{"stuff", ",", 
                RowBox[{"coords", "\[LeftDoubleBracket]", 
                 RowBox[{"\[Nu]", "-", "idx", "+", "1"}], 
                 "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Nu]", ",", "idx", ",", 
               RowBox[{"idx", "+", "lgth", "-", "1"}]}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"\[Mu]", ",", "idx", ",", 
             RowBox[{"idx", "+", "lgth", "-", "1"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"\[PartialD]", "_\[Mu]"}], " ", 
           RowBox[{"grad", "^", "\[Mu]"}]}], " ", "+", " ", 
          RowBox[{
           RowBox[{"\[CapitalGamma]", "^", "\[Mu]_"}], 
           RowBox[{"{", "\[Mu]\[Nu]", "}"}], " ", 
           RowBox[{"grad", "^", "\[Nu]"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"grad", "\[LeftDoubleBracket]", 
              RowBox[{"\[Nu]", "-", "idx", "+", "1"}], 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{"coords", "\[LeftDoubleBracket]", 
              RowBox[{"\[Nu]", "-", "idx", "+", "1"}], 
              "\[RightDoubleBracket]"}]}], "]"}], "+", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"Christoffel", "[", 
               RowBox[{
                SuperscriptBox["\[Mu]", "-"], ",", 
                SubscriptBox["\[Mu]", "-"], ",", 
                SubscriptBox["\[Nu]", "-"], ",", "m"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Mu]", ",", "idx", ",", 
                RowBox[{"idx", "+", "lgth", "-", "1"}]}], "}"}]}], "]"}], 
            RowBox[{"grad", "\[LeftDoubleBracket]", 
             RowBox[{"\[Nu]", "-", "idx", "+", "1"}], 
             "\[RightDoubleBracket]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Nu]", ",", "idx", ",", 
            RowBox[{"idx", "+", "lgth", "-", "1"}]}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    StyleBox[
     RowBox[{"CovariantBox", " ", "on", " ", "Tensor"}],
     FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CovariantBox", "[", 
       RowBox[{"t_Tensor", ",", "m_Tensor"}], "]"}], "/;", 
      RowBox[{"(*", 
       RowBox[{"m", " ", "is", " ", "a", " ", 
        StyleBox["metric",
         FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}], "&&", 
       RowBox[{"(*", 
        RowBox[{
         StyleBox["Coordinates",
          FontColor->RGBColor[1, 0, 1]], 
         StyleBox[" ",
          FontColor->RGBColor[1, 0, 1]], "should", " ", "be", " ", "the", " ", 
         RowBox[{"same", "."}]}], "*)"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Coordinates", "[", "t", "]"}], "===", 
         RowBox[{"Coordinates", "[", "m", "]"}]}], ")"}]}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "tempname", ",", "output", ",", "resumeindices", ",", "\[Mu]"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Extract", " ", "the", " ", 
         StyleBox["TensorName",
          FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tempname", "=", 
         RowBox[{"TensorNameNoPart", "[", "t", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Extract", " ", "the", " ", 
          StyleBox["Indices",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"resumeindices", "=", 
         RowBox[{"Indices", "[", "t", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Operate", " ", "\[Square]"}], "\[Congruent]", 
          RowBox[{
           RowBox[{
            StyleBox[
             SubscriptBox["\[Del]", "\[Mu]"],
             FontColor->RGBColor[1, 0, 1]], 
            RowBox[{
             StyleBox[
              SuperscriptBox["\[Del]", "\[Mu]"],
              FontColor->RGBColor[1, 0, 1]], " ", "on"}]}], " ", "t", " ", 
           "to", " ", "get", " ", 
           StyleBox[
            RowBox[{"\[Square]", "t"}],
            FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"CovariantD", "[", 
          RowBox[{
           RowBox[{"SubMinus", "[", "\[Mu]", "]"}], ",", 
           RowBox[{"CovariantD", "[", 
            RowBox[{
             RowBox[{"SuperMinus", "[", "\[Mu]", "]"}], ",", "t", ",", "m"}], 
            "]"}], ",", "m"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"TestExpressionForm", "[", "output", "]"}], ",", 
          RowBox[{"output", "=", 
           RowBox[{"t", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorComponents", "\[Rule]", " ", "tc___"}], ")"}], 
              "\[Rule]", " ", 
              RowBox[{"TensorComponents", "\[Rule]", " ", "output"}]}], 
             "}"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          StyleBox["Rename",
           FontColor->RGBColor[1, 0, 1]], " ", "as", " ", 
          StyleBox[
           RowBox[{"\[Square]", "t"}],
           FontColor->RGBColor[1, 0, 1]], " ", "and", " ", "recover", " ", 
          "the", " ", "original", 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["indices",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["list",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"output", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", "name_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", 
              RowBox[{"Square", "@@", "tempname"}]}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "idx_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "resumeindices"}], ")"}]}]}], 
          "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.5760890361958838`*^9, 
   3.5760892921299334`*^9}, {3.576089327198795*^9, 3.5760893665108643`*^9}, {
   3.5760894467730045`*^9, 3.576089487177076*^9}, {3.576089599746874*^9, 
   3.576089794357215*^9}, {3.5760898355568876`*^9, 3.576089917379031*^9}, {
   3.576089953181094*^9, 3.576090082318121*^9}, {3.576560147053269*^9, 
   3.5765603514136276`*^9}, {3.5765603906008964`*^9, 3.576560411879334*^9}, {
   3.5765604668226304`*^9, 3.576560468913034*^9}, {3.5765932405918536`*^9, 
   3.576593241668256*^9}, {3.5765932876571364`*^9, 3.576593294365148*^9}, {
   3.576593413472658*^9, 3.5765934397421603`*^9}, {3.605905899085953*^9, 
   3.6059059169323845`*^9}, {3.605907375690477*^9, 3.605907376732993*^9}, {
   3.6059074214866805`*^9, 3.605907435022888*^9}, {3.6059074983508615`*^9, 
   3.605907502648427*^9}, {3.6059106918570814`*^9, 3.6059107179519825`*^9}, {
   3.6059108386183357`*^9, 3.605910859590658*^9}, {3.6059116367090964`*^9, 
   3.605911650068802*^9}, {3.605911842169753*^9, 3.605911895881578*^9}, {
   3.6059120020907097`*^9, 3.605912034981715*^9}, 3.6059120952461405`*^9, {
   3.605912172252824*^9, 3.605912231088728*^9}, {3.605912379985015*^9, 
   3.6059124141760397`*^9}, {3.605912547647091*^9, 3.6059125726254745`*^9}, 
   3.605912640557518*^9, {3.6059126921018095`*^9, 3.6059126993344207`*^9}, {
   3.606149316082368*^9, 3.6061493231657734`*^9}, 3.8273802153389373`*^9, {
   3.8369804274373302`*^9, 3.836980427917673*^9}, {3.836980657173845*^9, 
   3.8369806793575926`*^9}, {3.8369919209732704`*^9, 3.836991954087078*^9}, {
   3.836992939414033*^9, 3.8369930534605656`*^9}, {3.8369931017089777`*^9, 
   3.8369931884849405`*^9}, {3.8369938163772287`*^9, 
   3.8369938464879155`*^9}, {3.8369938942200313`*^9, 3.83699389605641*^9}, {
   3.836994027293441*^9, 3.8369941805586343`*^9}, {3.836995940800383*^9, 
   3.836995975324904*^9}, {3.836996061832777*^9, 3.836996071359956*^9}, {
   3.8369961112260375`*^9, 3.836996116834282*^9}, {3.8369973775029235`*^9, 
   3.836997406334116*^9}, {3.836997533191107*^9, 3.836997537603136*^9}, {
   3.836997586572756*^9, 3.8369976039999657`*^9}, {3.8369976686476393`*^9, 
   3.836997673840048*^9}, {3.83699797920352*^9, 3.8369979902878876`*^9}, {
   3.836998037243683*^9, 3.836998041640744*^9}, {3.8370445404093733`*^9, 
   3.837044546384368*^9}, 3.8370445916947784`*^9, {3.837044690794423*^9, 
   3.837044691844432*^9}, 3.837044730584547*^9, {3.8370454014643717`*^9, 
   3.8370454131147184`*^9}, {3.837649164887122*^9, 3.8376491678951263`*^9}, {
   3.8376493367901144`*^9, 3.8376493478971095`*^9}, {3.837649605271124*^9, 
   3.8376496213861237`*^9}, {3.8381958307244577`*^9, 3.838195846275453*^9}, {
   3.8381958990439453`*^9, 3.8381959101769915`*^9}, {3.8534718775054874`*^9, 
   3.8534719368883*^9}, {3.8534721047050543`*^9, 3.853472109367186*^9}, {
   3.853472147550696*^9, 3.8534721566470985`*^9}, {3.8534721972461205`*^9, 
   3.8534723414449654`*^9}, {3.8534730965719347`*^9, 
   3.8534730997689667`*^9}, {3.853473565466111*^9, 3.8534737045376873`*^9}, {
   3.875756884422923*^9, 3.875757044480401*^9}, {3.8757570781593757`*^9, 
   3.8757571243975334`*^9}, 3.887027305718476*^9, {3.887120676700593*^9, 
   3.887120684045255*^9}, {3.8871208700018797`*^9, 3.8871209649401693`*^9}, {
   3.8926213630353355`*^9, 3.892621490438792*^9}, {3.8926215282388554`*^9, 
   3.8926215889698863`*^9}, {3.892866984651885*^9, 3.8928669882536697`*^9}, {
   3.8955551724025908`*^9, 3.8955551724125843`*^9}, {3.895555838456438*^9, 
   3.8955558384774237`*^9}, 3.9677774520410614`*^9, {3.975313081013192*^9, 
   3.975313139954818*^9}},ExpressionUUID->"2530e695-ff6a-4bf8-a014-\
8709536a94b3"],

Cell[BoxData[""], "Input",ExpressionUUID->"74ccdc3f-0172-4103-b65e-b4fc62e0d23f"]
}, Closed]],

Cell[CellGroupData[{

Cell["GradientSquared", "Subsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.533880012946951*^9, 3.5338800148345547`*^9}, {
   3.5760890087086353`*^9, 3.5760890111890397`*^9}, {3.583789536600904*^9, 
   3.583789562445382*^9}, {3.583789592737115*^9, 
   3.583789617611538*^9}},ExpressionUUID->"c6e974b4-db8f-43a6-b870-\
4241d0d1698a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Del]", "f"}], ")"}], "^", "2"}], " ", "for", " ", "scalar", 
    " ", "function", " ", "f"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "code", " ", "is", " ", "borrowed", " ", "from", " ", 
    "CovariantBox"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"GradientSquared", "[", 
     RowBox[{"stuff_", ",", "m_Tensor"}], "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"TestExpressionForm", "[", "stuff", "]"}], ")"}], "&&", 
      RowBox[{"(", 
       RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}]}], ")"}]}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "coords", ",", "gradu", ",", "gradd", ",", "\[Mu]", ",", "\[Nu]", ",", 
       "\[Lambda]", ",", "lgth", ",", "idx", ",", "ii"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"coords", "=", 
       RowBox[{"Coordinates", "[", "m", "]"}]}], ";", 
      RowBox[{"lgth", "=", 
       RowBox[{"Length", "[", "coords", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"extract", " ", "StartIndex"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"idx", "=", 
       RowBox[{"StartIndex", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"g", "^", 
         RowBox[{"{", "\[Mu]\[Nu]", "}"}]}], " ", 
        RowBox[{"\[PartialD]", "_\[Nu]"}], " ", "stuff"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"gradu", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Metric", "[", 
             RowBox[{
              SuperscriptBox["\[Mu]", "-"], ",", 
              SuperscriptBox["\[Nu]", "-"], ",", "m"}], "]"}], 
            RowBox[{"D", "[", 
             RowBox[{"stuff", ",", 
              RowBox[{"coords", "\[LeftDoubleBracket]", 
               RowBox[{"\[Nu]", "-", "idx", "+", "1"}], 
               "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Nu]", ",", "idx", ",", 
             RowBox[{"idx", "+", "lgth", "-", "1"}]}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\[Mu]", ",", "idx", ",", 
           RowBox[{"idx", "+", "lgth", "-", "1"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"\[PartialD]", "_\[Mu]"}], " ", "stuff"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"gradd", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"stuff", ",", 
           RowBox[{"coords", "\[LeftDoubleBracket]", 
            RowBox[{"\[Nu]", "-", "idx", "+", "1"}], 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]", ",", "idx", ",", 
           RowBox[{"idx", "+", "lgth", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"\[PartialD]", "_\[Mu]"}], " ", "stuff", " ", 
         RowBox[{"g", "^", 
          RowBox[{"{", "\[Mu]\[Nu]", "}"}]}], " ", 
         RowBox[{"\[PartialD]", "_\[Nu]"}], " ", "stuff"}], " ", "=", " ", 
        RowBox[{"gradd", ".", "gradu"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"gradu", ".", "gradd"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.5760890361958838`*^9, 
   3.5760892921299334`*^9}, {3.576089327198795*^9, 3.5760893665108643`*^9}, {
   3.5760894467730045`*^9, 3.576089487177076*^9}, {3.576089599746874*^9, 
   3.576089794357215*^9}, {3.5760898355568876`*^9, 3.576089917379031*^9}, {
   3.576089953181094*^9, 3.576090082318121*^9}, {3.576560147053269*^9, 
   3.5765603514136276`*^9}, {3.5765603906008964`*^9, 3.576560411879334*^9}, {
   3.5765604668226304`*^9, 3.576560468913034*^9}, {3.5765932405918536`*^9, 
   3.576593241668256*^9}, {3.5765932876571364`*^9, 3.576593294365148*^9}, {
   3.576593413472658*^9, 3.5765934397421603`*^9}, {3.5837895835345883`*^9, 
   3.5837896999162455`*^9}, {3.583789732961135*^9, 3.5837897641899214`*^9}, {
   3.5837898029911404`*^9, 3.583789812347676*^9}, {3.5837898853688526`*^9, 
   3.583789939647957*^9}, {3.875757855060691*^9, 3.87575791548322*^9}, 
   3.895555172416582*^9, {3.895555838481423*^9, 3.895555838483421*^9}, {
   3.97531315172322*^9, 
   3.975313161041288*^9}},ExpressionUUID->"c167f52d-6b5f-45f9-88cc-\
e47f81b96e71"]
}, Closed]],

Cell[CellGroupData[{

Cell["InteriorProduct", "Subsection",
 CellChangeTimes->{{3.8901931809672127`*^9, 
  3.8901932130070333`*^9}},ExpressionUUID->"64fc49b5-8c00-4eb5-9ab2-\
6332caaddfbb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"InteriorProduct", "[", 
      RowBox[{
       RowBox[{"X_Tensor", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RankNumber", "[", "X", "]"}], ">", "0"}], ")"}]}], ",", 
       "\[Omega]_Tensor"}], "]"}], "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"RankNumber", "[", "\[Omega]", "]"}], ">", "0"}], ")"}]}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "originalXindices", ",", "original\[Omega]indices", ",", "Xindices", 
        ",", "\[Omega]indices", ",", "length", ",", "length2", ",", 
        "finallength", ",", "newIndicesrep", ",", "newIndices", ",", "i", ",",
         "output", ",", "newTensorName"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"TestDifferentialForm", "[", "\[Omega]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"TestDifferentialVector", "[", "X", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"originalXindices", "=", 
        RowBox[{"Indices", "[", "X", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"original\[Omega]indices", "=", 
        RowBox[{"Indices", "[", "\[Omega]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Xindices", "=", 
        RowBox[{"RemoveUnderBarredIndices", "[", "originalXindices", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"\[Omega]indices", "=", 
        RowBox[{
        "RemoveUnderBarredIndices", "[", "original\[Omega]indices", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"length", "=", 
        RowBox[{"RankNumber", "[", "Xindices", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"length2", "=", 
        RowBox[{"RankNumber", "[", "\[Omega]indices", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"finallength", "=", 
        RowBox[{"Min", "[", 
         RowBox[{"length", ",", "length2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"newIndicesrep", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Xindices", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], "\[Rule]", 
            RowBox[{"\[Omega]indices", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], " ", ")"}],
           ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "finallength"}], "}"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"newIndices", "=", 
        RowBox[{"originalXindices", "/.", "newIndicesrep"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"(", 
           RowBox[{"length", "===", "length2"}], ")"}], ")"}], ",", 
         RowBox[{"output", "=", 
          RowBox[{
           FractionBox["1", 
            RowBox[{"finallength", "!"}]], " ", 
           RowBox[{"TensorsProduct", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Indices", "[", 
               RowBox[{"X", ",", "newIndices"}], "]"}], ",", "\[Omega]"}], 
             "}"}], "]"}]}]}], ",", "True", ",", 
         RowBox[{
          RowBox[{"output", "=", 
           RowBox[{"TensorsProduct", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Indices", "[", 
               RowBox[{"X", ",", "newIndices"}], "]"}], ",", "\[Omega]"}], 
             "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"output", "=", 
           RowBox[{"TensorsProduct", "[", 
            RowBox[{
             RowBox[{
              FractionBox["1", 
               RowBox[{"finallength", "!"}]], " ", "output"}], ",", 
             "Tensor"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"output", "=", 
           RowBox[{"TensorName", "[", 
            RowBox[{"output", ",", 
             RowBox[{"Row", "[", 
              RowBox[{"{", 
               RowBox[{
                SubscriptBox["\"\<\[Iota]\>\"", 
                 RowBox[{"TensorName", "[", "X", "]"}]], ",", 
                RowBox[{"TensorName", "[", "\[Omega]", "]"}]}], "}"}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"output", "=", 
           RowBox[{
           "RemoveRepeatedUnderBarredIndices", "[", "output", "]"}]}]}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"InteriorProduct", "[", 
      RowBox[{
       RowBox[{"X_Tensor", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RankNumber", "[", "X", "]"}], ">", "0"}], ")"}]}], ",", 
       "\[Omega]_Tensor", ",", "Tensor"}], "]"}], "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"RankNumber", "[", "\[Omega]", "]"}], ">", "0"}], ")"}]}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "originalXindices", ",", "original\[Omega]indices", ",", "Xindices", 
        ",", "\[Omega]indices", ",", "length", ",", "length2", ",", 
        "finallength", ",", "newIndicesrep", ",", "newIndices", ",", "i", ",",
         "output", ",", "newTensorName"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"TestDifferentialForm", "[", "\[Omega]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"TestDifferentialVector", "[", "X", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"originalXindices", "=", 
        RowBox[{"Indices", "[", "X", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"original\[Omega]indices", "=", 
        RowBox[{"Indices", "[", "\[Omega]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Xindices", "=", 
        RowBox[{"RemoveUnderBarredIndices", "[", "originalXindices", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"\[Omega]indices", "=", 
        RowBox[{
        "RemoveUnderBarredIndices", "[", "original\[Omega]indices", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"length", "=", 
        RowBox[{"RankNumber", "[", "Xindices", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"length2", "=", 
        RowBox[{"RankNumber", "[", "\[Omega]indices", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"finallength", "=", 
        RowBox[{"Min", "[", 
         RowBox[{"length", ",", "length2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"newIndicesrep", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Xindices", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], "\[Rule]", 
            RowBox[{"\[Omega]indices", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], " ", ")"}],
           ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "finallength"}], "}"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"newIndices", "=", 
        RowBox[{"originalXindices", "/.", "newIndicesrep"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"output", "=", 
        RowBox[{"TensorsProduct", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Indices", "[", 
             RowBox[{"X", ",", "newIndices"}], "]"}], ",", "\[Omega]"}], 
           "}"}], ",", "Tensor"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"output", "=", 
        RowBox[{"TensorsProduct", "[", 
         RowBox[{
          RowBox[{
           FractionBox["1", 
            RowBox[{"finallength", "!"}]], " ", "output"}], ",", "Tensor"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"output", "=", 
        RowBox[{"TensorName", "[", 
         RowBox[{"output", ",", 
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["\"\<\[Iota]\>\"", 
              RowBox[{"TensorName", "[", "X", "]"}]], ",", 
             RowBox[{"TensorName", "[", "\[Omega]", "]"}]}], "}"}], "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"output", "=", 
        RowBox[{
        "RemoveRepeatedUnderBarredIndices", "[", "output", "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Subscript", "[", 
    RowBox[{"Global`\[Iota]", ",", "a_Tensor"}], "]"}], "[", "b_Tensor", 
   "]"}], ":=", 
  RowBox[{"InteriorProduct", "[", 
   RowBox[{"a", ",", "b"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.89019329434483*^9, 3.8901933499660873`*^9}, {
   3.890193525069709*^9, 3.8901935325654325`*^9}, {3.890193757436674*^9, 
   3.890193804003336*^9}, 3.8901944875937843`*^9, {3.8901980199523973`*^9, 
   3.8901980214987545`*^9}, 3.890198202201866*^9, {3.8901982579540644`*^9, 
   3.8901982726732492`*^9}, {3.890198425520746*^9, 3.890198469609847*^9}, {
   3.890198518463782*^9, 3.890198532807666*^9}, 3.8901985631927247`*^9, {
   3.8901991230120907`*^9, 3.890199141179894*^9}, {3.89139980393928*^9, 
   3.891399822484338*^9}, {3.891399945938776*^9, 3.891399992554781*^9}, {
   3.8915672456428695`*^9, 3.891567279438905*^9}, {3.891570437902934*^9, 
   3.8915704760597534`*^9}, {3.891570526577862*^9, 3.891570570141715*^9}, {
   3.8915706028235064`*^9, 3.891570613308096*^9}, {3.891570772260191*^9, 
   3.89157082694309*^9}, {3.8915712791162643`*^9, 3.891571320330065*^9}, {
   3.891571393714176*^9, 3.8915714215221715`*^9}, {3.891571476346086*^9, 
   3.891571476496993*^9}, {3.8915724186152287`*^9, 3.8915724219582124`*^9}, {
   3.891572512785328*^9, 3.89157251417048*^9}, {3.8915734272266245`*^9, 
   3.89157343058657*^9}, 3.8915761008732595`*^9, 3.891579747703946*^9, {
   3.8915798129675255`*^9, 3.891579815823778*^9}, {3.891579900189654*^9, 
   3.891579901709725*^9}, {3.891580054861144*^9, 3.8915800708374147`*^9}, {
   3.8915801861404696`*^9, 3.8915802142703133`*^9}, 3.8915804049180355`*^9, {
   3.8915804407164493`*^9, 3.8915804553724856`*^9}, 3.8915804872295837`*^9, {
   3.891580593806221*^9, 3.8915806080355167`*^9}, {3.891580641572157*^9, 
   3.8915806438357735`*^9}, 3.8915831145139112`*^9, {3.891583153492566*^9, 
   3.891583156356344*^9}, {3.8915842758102317`*^9, 3.8915842776561623`*^9}, {
   3.8915844301763067`*^9, 3.8915845478719893`*^9}, 3.8920073723666143`*^9, {
   3.8920079855825386`*^9, 3.8920079968665285`*^9}, 3.8920118762668285`*^9, {
   3.8920126695782213`*^9, 3.8920127056330276`*^9}, {3.8920127379462166`*^9, 
   3.8920127771773725`*^9}, {3.892013137694544*^9, 3.8920131378964195`*^9}, {
   3.8920132346707582`*^9, 3.8920132371022587`*^9}, 3.892083182192808*^9, {
   3.8920834592048116`*^9, 3.892083571995708*^9}, {3.8920836605630856`*^9, 
   3.892083682284641*^9}, {3.892083725681777*^9, 3.8920837471295004`*^9}, 
   3.8920838094103913`*^9, {3.89315952321809*^9, 3.893159539434247*^9}, {
   3.8931596757225313`*^9, 3.893159690491088*^9}, {3.893159931002372*^9, 
   3.8931599374243093`*^9}, 3.8931599845389404`*^9, 3.893160029193654*^9, {
   3.8931600663140893`*^9, 3.89316012527291*^9}, {3.893160157360823*^9, 
   3.8931601600168715`*^9}, {3.8931602290319495`*^9, 3.893160240120569*^9}, 
   3.893160336917816*^9, {3.8950732615844955`*^9, 3.8950732615844955`*^9}, {
   3.8955490515796995`*^9, 3.895549051586695*^9}, {3.8955556351535015`*^9, 
   3.895555635156499*^9}, {3.895555716323923*^9, 3.895555716327921*^9}, 
   3.89555601947795*^9, {3.8984042359503117`*^9, 3.898404243305689*^9}, {
   3.898404286175402*^9, 3.8984042923798466`*^9}, {3.898404363527941*^9, 
   3.898404365166727*^9}, {3.8984044219436007`*^9, 3.8984044222873135`*^9}, 
   3.8984045013110514`*^9, {3.8984045395969243`*^9, 3.8984045643806753`*^9}, {
   3.898404757046847*^9, 3.8984048603118515`*^9}, 3.898404931130731*^9, {
   3.955770481629141*^9, 3.955770489569879*^9}, 3.955770657300984*^9, {
   3.959931338438497*^9, 3.959931359300459*^9}, {3.975313172516007*^9, 
   3.9753132147491093`*^9}},ExpressionUUID->"5a646ee0-bb50-4ec4-a619-\
8d4711fa672e"]
}, Closed]],

Cell[CellGroupData[{

Cell["ExteriorD", "Subsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.533880012946951*^9, 3.5338800148345547`*^9}, {
   3.5760890087086353`*^9, 3.5760890111890397`*^9}, {3.6061493485872273`*^9, 
   3.6061493494062743`*^9}, {3.6299087800753407`*^9, 
   3.6299087836165466`*^9}, {3.848441886542853*^9, 
   3.848441901542859*^9}},ExpressionUUID->"7503329c-2ee4-4851-b1a9-\
d38c3a66c1d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Input", " ", "a", " ", 
    StyleBox["new",
     FontColor->RGBColor[0.5, 0, 0.5]], 
    StyleBox[" ",
     FontColor->RGBColor[0.5, 0, 0.5]], 
    StyleBox["specified",
     FontColor->RGBColor[0.5, 0, 0.5]], 
    StyleBox[" ",
     FontColor->RGBColor[0.5, 0, 0.5]], 
    StyleBox["index",
     FontColor->RGBColor[0.5, 0, 0.5]], " ", "and", " ", "tensor", " ", "t"}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ExteriorD", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", "t_Tensor"}], 
       "]"}], "/;", 
      RowBox[{"(*", 
       RowBox[{"index", " ", "for", " ", 
        StyleBox["PartialD",
         FontColor->RGBColor[1, 0, 1]], " ", "should", " ", "be", " ", 
        StyleBox["lower",
         FontColor->RGBColor[1, 0, 1]], " ", "one"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sgn", "[", "\[Mu]T", "]"}], "===", 
        RowBox[{"-", "1"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dF", ",", "ddFm", ",", 
         RowBox[{"\[Mu]Ttemp", "=", 
          SubscriptBox[
           RowBox[{"Unique", "[", "\[Alpha]", "]"}], "-"]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"TestDifferentialForm", "[", "t", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          StyleBox["PartialD",
           FontColor->RGBColor[1, 0, 1]], " ", "on", " ", "t"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"dF", "=", 
         RowBox[{"PartialD", "[", 
          RowBox[{"\[Mu]Ttemp", ",", "t"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          StyleBox["Fully",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["AntiSymmetrizeIndices",
           FontColor->RGBColor[1, 0, 1]], " ", "dF"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"ddFm", "=", 
         RowBox[{
          FractionBox["1", 
           RowBox[{
            RowBox[{"RankNumber", "[", "t", "]"}], "!"}]], 
          RowBox[{"TensorComponents", "[", 
           RowBox[{"AntiSymmetrizeIndices", "[", "dF", "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Add", " ", "a", " ", 
          RowBox[{"\[DifferentialD]", " ", "in"}], " ", "the", " ", 
          "TensorName", " ", "and", " ", "change", " ", "the", " ", 
          RowBox[{"TensorComponents", ".", " ", "Prepend"}], " ", "a", " ", 
          "new", " ", 
          RowBox[{"index", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"t", "/.", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "iii_"}], ")"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", 
              RowBox[{"Prepend", "[", 
               RowBox[{"iii", ",", "\[Mu]T"}], "]"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", "nnn_"}], ")"}], 
            "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", 
              RowBox[{"Row", "[", 
               RowBox[{"{", 
                RowBox[{"\"\<\[DifferentialD]\>\"", ",", 
                 RowBox[{"TensorName", "[", "t", "]"}]}], "}"}], "]"}]}], 
             ")"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "ccc_"}], ")"}], 
            "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "ddFm"}], ")"}]}]}], 
          "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ExteriorD", "[", 
      RowBox[{
       RowBox[{"\[Mu]T_", "/;", 
        RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", "t_Tensor", ",", 
       RowBox[{"m_Tensor", "/;", 
        RowBox[{"TestMetricTensor", "[", "m", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"NewIndices", ",", "dFcomp", ",", "\[Alpha]"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NewIndices", "=", 
         RowBox[{"Prepend", "[", 
          RowBox[{
           RowBox[{"RemoveUnderBarredIndices", "[", 
            RowBox[{"Indices", "[", "t", "]"}], "]"}], ",", "\[Mu]T"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dFcomp", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", "NewIndices"}], 
              "]"}], "===", 
             RowBox[{"{", 
              RowBox[{"-", "1"}], "}"}]}], ")"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            FractionBox["1", 
             RowBox[{
              RowBox[{"RankNumber", "[", "t", "]"}], "!"}]], 
            RowBox[{"TensorComponents", "[", 
             RowBox[{"AntiSymmetrizeIndices", "[", 
              RowBox[{"PartialD", "[", 
               RowBox[{"\[Mu]T", ",", "t"}], "]"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
           RowBox[{
            FractionBox["1", 
             RowBox[{
              RowBox[{"RankNumber", "[", "t", "]"}], "!"}]], 
            RowBox[{"TensorComponents", "[", 
             RowBox[{"MoveIndices", "[", 
              RowBox[{
               RowBox[{"AntiSymmetrizeIndices", "[", 
                RowBox[{"PartialD", "[", 
                 RowBox[{
                  SubscriptBox[
                   RowBox[{"Unique", "[", "\[Alpha]", "]"}], "-"], ",", 
                  RowBox[{"LowerAllIndices", "[", 
                   RowBox[{"t", ",", "m"}], "]"}]}], "]"}], "]"}], ",", 
               "NewIndices", ",", "m"}], "]"}], "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"t", "/.", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "iii_"}], ")"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", 
              RowBox[{"Prepend", "[", 
               RowBox[{"iii", ",", "\[Mu]T"}], "]"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", "nnn_"}], ")"}], 
            "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", 
              RowBox[{"Row", "[", 
               RowBox[{"{", 
                RowBox[{"\"\<\[DifferentialD]\>\"", ",", 
                 RowBox[{"TensorName", "[", "t", "]"}]}], "}"}], "]"}]}], 
             ")"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "ccc_"}], ")"}], 
            "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "dFcomp"}], ")"}]}]}], 
          "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     StyleBox["Rename",
      FontColor->RGBColor[0.5, 0, 0.5]], " ", "the", " ", "whole", " ", 
     "bunch", " ", "of", " ", 
     RowBox[{
      StyleBox["indices",
       FontColor->RGBColor[0.5, 0, 0.5]], "."}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ExteriorD", "[", 
       RowBox[{"\[Mu]List_List", ",", "t_Tensor"}], "]"}], "/;", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"The", " ", 
         StyleBox["length",
          FontColor->RGBColor[1, 0, 1]], " ", "of", " ", 
         StyleBox["\[Mu]List",
          FontColor->RGBColor[1, 0, 1]], " ", "should", " ", "be", " ", 
         StyleBox["rank",
          FontColor->RGBColor[1, 0, 1]]}], 
        StyleBox["+",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["1",
         FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", "\[Mu]List", "]"}], "===", 
         RowBox[{
          RowBox[{"RankNumber", "[", "t", "]"}], "+", "1"}]}], ")"}], "&&", 
       RowBox[{"(*", 
        RowBox[{"Also", ",", " ", 
         RowBox[{
         "we", " ", "want", " ", "to", " ", "check", " ", "all", " ", 
          "indices", " ", "in", " ", 
          StyleBox["\[Mu]List",
           FontColor->RGBColor[1, 0, 1]], " ", "are", " ", "OK", " ", "and", 
          " ", 
          StyleBox[
           RowBox[{"lower", "."}],
           FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], 
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Union", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"TestIndices", "[", "#", "]"}], "&"}], "/@", 
            "\[Mu]List"}], "]"}], ")"}], ",", 
         RowBox[{"{", "True", "}"}]}], "]"}], "&&", 
       RowBox[{"(", 
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Union", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", "\[Mu]List"}], 
            "]"}], ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"-", "1"}], "}"}]}], "]"}], ")"}], "&&", 
       RowBox[{"(*", 
        RowBox[{
        "Check", " ", "all", " ", "indices", " ", "in", " ", "\[Mu]List", " ",
          "are", " ", 
         RowBox[{
          StyleBox["abstract",
           FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], 
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"NotAbstractIndex", "[", 
             RowBox[{"#", ",", 
              RowBox[{"Coordinates", "[", "t", "]"}], ",", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"StartIndexNoPart", "[", "t", "]"}]}]}], "]"}], "&"}], 
           "/@", "\[Mu]List"}], "]"}], ",", 
         RowBox[{"{", "False", "}"}]}], "]"}]}]}], ":=", 
     RowBox[{"(*", 
      RowBox[{"Recall", " ", 
       StyleBox["ExteriorD",
        FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
     RowBox[{"ExteriorD", "[", 
      RowBox[{"(*", 
       RowBox[{
        StyleBox["Part",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["1",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], "of", " ", 
        StyleBox["\[Mu]List",
         FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
      RowBox[{
       RowBox[{
       "\[Mu]List", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"t", "/.", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Indices", "\[Rule]", "idx_"}], ")"}], "\[Rule]", 
         RowBox[{"(", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
              RowBox[{"W", "/", " ", 
               StyleBox["Drop",
                FontColor->RGBColor[1, 0, 1]]}], 
              StyleBox[" ",
               FontColor->RGBColor[1, 0, 1]], 
              StyleBox["1",
               FontColor->RGBColor[1, 0, 1]]}], ",", 
             RowBox[{
             "we", " ", "can", " ", "get", " ", "the", " ", "new", " ", 
              "indices", " ", "for", " ", "t"}]}], "*)"}], 
           RowBox[{"Drop", "[", 
            RowBox[{"\[Mu]List", ",", "1"}], "]"}]}], ")"}]}]}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     StyleBox["Rename",
      FontColor->RGBColor[0.5, 0, 0.5]], " ", "the", " ", "whole", " ", 
     "bunch", " ", "of", " ", 
     RowBox[{
      StyleBox["indices",
       FontColor->RGBColor[0.5, 0, 0.5]], "."}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ExteriorD", "[", 
       RowBox[{"\[Mu]List_List", ",", "t_Tensor", ",", 
        RowBox[{"m_Tensor", "/;", 
         RowBox[{"TestMetricTensor", "[", "m", "]"}]}]}], "]"}], "/;", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"The", " ", 
         StyleBox["length",
          FontColor->RGBColor[1, 0, 1]], " ", "of", " ", 
         StyleBox["\[Mu]List",
          FontColor->RGBColor[1, 0, 1]], " ", "should", " ", "be", " ", 
         StyleBox["rank",
          FontColor->RGBColor[1, 0, 1]]}], 
        StyleBox["+",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["1",
         FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", "\[Mu]List", "]"}], "===", 
         RowBox[{
          RowBox[{"RankNumber", "[", "t", "]"}], "+", "1"}]}], ")"}], 
       RowBox[{"(*", 
        RowBox[{"&&", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"check", " ", "t", 
            StyleBox[" ",
             FontColor->RGBColor[1, 0.5, 0.5]], "is", " ", "a", " ", 
            StyleBox["fully",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["anti",
             FontColor->RGBColor[1, 0, 1]]}], 
           StyleBox["-",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[
            RowBox[{"symm", " ", "tensor"}],
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
         RowBox[{"TestDifferentialForm", "[", "t", "]"}]}], "*)"}], "&&", 
       RowBox[{"(*", 
        RowBox[{"Also", ",", " ", 
         RowBox[{
         "we", " ", "want", " ", "to", " ", "check", " ", "all", " ", 
          "indices", " ", "in", " ", 
          StyleBox["\[Mu]List",
           FontColor->RGBColor[1, 0, 1]], " ", "are", " ", "OK", " ", "and", 
          " ", 
          StyleBox[
           RowBox[{"lower", "."}],
           FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], 
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Union", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"TestIndices", "[", "#", "]"}], "&"}], "/@", 
            "\[Mu]List"}], "]"}], ")"}], ",", 
         RowBox[{"{", "True", "}"}]}], "]"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Union", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", "\[Mu]List"}], 
             "]"}], ")"}], ",", 
           RowBox[{"{", 
            RowBox[{"-", "1"}], "}"}]}], "]"}], "||", 
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Union", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", "\[Mu]List"}], 
             "]"}], ")"}], ",", 
           RowBox[{"{", "1", "}"}]}], "]"}]}], ")"}], "&&", 
       RowBox[{"(*", 
        RowBox[{
        "Check", " ", "all", " ", "indices", " ", "in", " ", "\[Mu]List", " ",
          "are", " ", 
         RowBox[{
          StyleBox["abstract",
           FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], 
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"NotAbstractIndex", "[", 
             RowBox[{"#", ",", 
              RowBox[{"Coordinates", "[", "t", "]"}], ",", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"StartIndexNoPart", "[", "t", "]"}]}]}], "]"}], "&"}], 
           "/@", "\[Mu]List"}], "]"}], ",", 
         RowBox[{"{", "False", "}"}]}], "]"}]}]}], ":=", 
     RowBox[{"(*", 
      RowBox[{"Recall", " ", 
       StyleBox["ExteriorD",
        FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
     RowBox[{"ExteriorD", "[", 
      RowBox[{"(*", 
       RowBox[{
        StyleBox["Part",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["1",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], "of", " ", 
        StyleBox["\[Mu]List",
         FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
      RowBox[{
       RowBox[{
       "\[Mu]List", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"t", "/.", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Indices", "\[Rule]", "idx_"}], ")"}], "\[Rule]", 
         RowBox[{"(", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
              RowBox[{"W", "/", " ", 
               StyleBox["Drop",
                FontColor->RGBColor[1, 0, 1]]}], 
              StyleBox[" ",
               FontColor->RGBColor[1, 0, 1]], 
              StyleBox["1",
               FontColor->RGBColor[1, 0, 1]]}], ",", 
             RowBox[{
             "we", " ", "can", " ", "get", " ", "the", " ", "new", " ", 
              "indices", " ", "for", " ", "t"}]}], "*)"}], 
           RowBox[{"Drop", "[", 
            RowBox[{"\[Mu]List", ",", "1"}], "]"}]}], ")"}]}]}], ",", "m"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"ExteriorD", " ", 
     StyleBox[
      RowBox[{"w", "/", "o"}],
      FontColor->RGBColor[0.5, 0, 0.5]], " ", "given", " ", "a", " ", 
     StyleBox["specified",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     RowBox[{
      StyleBox["index",
       FontColor->RGBColor[0.5, 0, 0.5]], ".", "We"}], " ", "will", " ", 
     "generate", " ", "one", " ", 
     StyleBox["Unique",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox["index",
      FontColor->RGBColor[0.5, 0, 0.5]], " ", "for", " ", 
     RowBox[{"user", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ExteriorD", "[", "t_Tensor", "]"}], 
     RowBox[{"(*", 
      RowBox[{"/;", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"check", " ", "t", 
          StyleBox[" ",
           FontColor->RGBColor[1, 0.5, 0.5]], "is", " ", "a", " ", 
          StyleBox["fully",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["anti",
           FontColor->RGBColor[1, 0, 1]]}], 
         StyleBox["-",
          FontColor->RGBColor[1, 0, 1]], 
         StyleBox[
          RowBox[{"symm", " ", "tensor"}],
          FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
       RowBox[{"TestDifferentialForm", "[", "t", "]"}]}], "*)"}], ":=", 
     RowBox[{"(*", 
      RowBox[{"Recall", " ", 
       StyleBox["ExteriorD",
        FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
     RowBox[{"ExteriorD", "[", 
      RowBox[{"(*", 
       RowBox[{"Generate", " ", 
        StyleBox["unique",
         FontColor->RGBColor[1, 0, 1]], " ", "index"}], "*)"}], 
      RowBox[{
       SubscriptBox[
        RowBox[{"Unique", "[", "\[Mu]", "]"}], "-"], ",", "t"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     StyleBox["Shorthand",
      FontColor->RGBColor[0.5, 0, 0.5]], " ", "for", " ", "ExteriorD", " ", 
     RowBox[{"(", 
      RowBox[{"\[DifferentialD]", "Tensor"}], ")"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Tensor", "/:", 
     RowBox[{"\[DifferentialD]", "t_Tensor"}], ":=", 
     RowBox[{"ExteriorD", "[", "t", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     StyleBox["Shorthand",
      FontColor->RGBColor[0.5, 0, 0.5]], " ", "for", " ", "ExteriorD", " ", 
     RowBox[{"w", "/", " ", 
      StyleBox["a",
       FontColor->RGBColor[0.5, 0, 0.5]]}], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox["new",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox["index",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox["for",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox["PartialD",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     RowBox[{"(", 
      StyleBox[
       RowBox[{
        SubscriptBox["\[DifferentialD]", 
         SubscriptBox["\[Mu]T", "-"]], "Tensor"}],
       FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Tensor", "/:", 
    RowBox[{"Dt", "[", 
     RowBox[{"t_Tensor", ",", 
      RowBox[{"SubMinus", "[", 
       RowBox[{"(", 
        RowBox[{"\[Mu]T_Symbol", "|", "\[Mu]T_Integer"}], ")"}], "]"}]}], 
     "]"}], ":=", 
    RowBox[{"ExteriorD", "[", 
     RowBox[{
      SubscriptBox["\[Mu]T", "-"], ",", "t"}], "]"}]}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     StyleBox["Shorthand",
      FontColor->RGBColor[0.5, 0, 0.5]], " ", "for", " ", "ExteriorD", " ", 
     RowBox[{"w", "/", " ", 
      StyleBox["a",
       FontColor->RGBColor[0.5, 0, 0.5]]}], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox["new",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox["indices",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox["List",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox["for",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox["PartialD",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     RowBox[{"(", 
      StyleBox[
       RowBox[{
        SubscriptBox["\[DifferentialD]", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["\[Mu]T", "-"], ",", 
           SubscriptBox["a1", "-"], ",", 
           SubscriptBox["a2", "-"], ",", "..."}], "}"}]], "Tensor"}],
       FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Tensor", "/:", 
     RowBox[{"Dt", "[", 
      RowBox[{"t_Tensor", ",", "list_List"}], "]"}], ":=", 
     RowBox[{"ExteriorD", "[", 
      RowBox[{"list", ",", "t"}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.5760890361958838`*^9, 
   3.5760892921299334`*^9}, {3.576089327198795*^9, 3.5760893665108643`*^9}, {
   3.5760894467730045`*^9, 3.576089487177076*^9}, {3.576089599746874*^9, 
   3.576089794357215*^9}, {3.5760898355568876`*^9, 3.576089917379031*^9}, {
   3.576089953181094*^9, 3.576090082318121*^9}, {3.576560147053269*^9, 
   3.5765603514136276`*^9}, {3.5765603906008964`*^9, 3.576560411879334*^9}, {
   3.5765604668226304`*^9, 3.576560468913034*^9}, {3.5765932405918536`*^9, 
   3.576593241668256*^9}, {3.5765932876571364`*^9, 3.576593294365148*^9}, {
   3.576593413472658*^9, 3.5765934397421603`*^9}, {3.605905899085953*^9, 
   3.6059059169323845`*^9}, {3.605907375690477*^9, 3.605907376732993*^9}, {
   3.6059074214866805`*^9, 3.605907435022888*^9}, {3.6059074983508615`*^9, 
   3.605907502648427*^9}, {3.6059106918570814`*^9, 3.6059107179519825`*^9}, {
   3.6059108386183357`*^9, 3.605910859590658*^9}, {3.6059116367090964`*^9, 
   3.605911650068802*^9}, {3.605911842169753*^9, 3.605911895881578*^9}, {
   3.6059120020907097`*^9, 3.605912034981715*^9}, 3.6059120952461405`*^9, {
   3.605912172252824*^9, 3.605912231088728*^9}, {3.605912379985015*^9, 
   3.6059124141760397`*^9}, {3.605912547647091*^9, 3.6059125726254745`*^9}, 
   3.605912640557518*^9, {3.6059126921018095`*^9, 3.6059126993344207`*^9}, {
   3.606149316082368*^9, 3.6061493231657734`*^9}, {3.606149361203949*^9, 
   3.6061493833582163`*^9}, {3.6061495021670113`*^9, 
   3.6061496018337126`*^9}, {3.606149696681137*^9, 3.6061496971501637`*^9}, {
   3.6061497349753275`*^9, 3.6061497839071264`*^9}, {3.606149914846616*^9, 
   3.606149946487425*^9}, {3.6061501075506372`*^9, 3.6061501127199335`*^9}, {
   3.6061502607564*^9, 3.606150297869523*^9}, {3.6061503439731603`*^9, 
   3.606150399802354*^9}, {3.606150444232895*^9, 3.6061504505792575`*^9}, {
   3.6061506412691646`*^9, 3.60615079783912*^9}, {3.60615087215137*^9, 
   3.6061509190810547`*^9}, {3.6061510026398335`*^9, 
   3.6061510695636616`*^9}, {3.6061511012804756`*^9, 
   3.6061511022065287`*^9}, {3.606151174042638*^9, 3.6061511979290037`*^9}, {
   3.606151255141276*^9, 3.6061512782155957`*^9}, {3.6061517274972935`*^9, 
   3.606151749276539*^9}, {3.6061517850545855`*^9, 3.606151830330175*^9}, {
   3.606152246977006*^9, 3.6061522732695093`*^9}, 3.6061523568362894`*^9, {
   3.6061619084720783`*^9, 3.6061619096576805`*^9}, {3.606163263240858*^9, 
   3.606163263958459*^9}, {3.606163314471348*^9, 3.6061633160781507`*^9}, {
   3.606163378774661*^9, 3.606163413422322*^9}, 3.6061634632956095`*^9, {
   3.6061634941836634`*^9, 3.6061634946204643`*^9}, {3.6061635412957463`*^9, 
   3.6061636943476152`*^9}, {3.606163895151168*^9, 3.606163937037242*^9}, {
   3.6061640041329594`*^9, 3.606164018765785*^9}, {3.6061643337615385`*^9, 
   3.606164422744095*^9}, {3.6061645384026976`*^9, 3.6061645529731236`*^9}, {
   3.6061654490542974`*^9, 3.6061654690691323`*^9}, {3.6061656900123205`*^9, 
   3.6061657122579594`*^9}, {3.6061657561408367`*^9, 3.606165776280472*^9}, {
   3.6061659695336113`*^9, 3.6061659923564515`*^9}, {3.606166075114597*^9, 
   3.606166187918395*^9}, {3.6061662676657352`*^9, 3.6061662925945787`*^9}, {
   3.606166335837855*^9, 3.6061664592808714`*^9}, {3.6061665321329994`*^9, 
   3.6061665641286554`*^9}, {3.6061666252651634`*^9, 3.606166626559965*^9}, {
   3.6063210736379833`*^9, 3.6063210791355677`*^9}, 3.6063211492396445`*^9, {
   3.6063214202253075`*^9, 3.6063214618209467`*^9}, {3.606321625917968*^9, 
   3.6063216294880223`*^9}, {3.606321667340104*^9, 3.6063217452043004`*^9}, {
   3.6063218135733504`*^9, 3.6063218276655664`*^9}, {3.6063219714327755`*^9, 
   3.6063219994062057`*^9}, {3.606322158748153*^9, 3.6063222015913115`*^9}, {
   3.6063222598307066`*^9, 3.6063223402784424`*^9}, 3.606322462443319*^9, {
   3.6063226653409357`*^9, 3.6063227108891354`*^9}, {3.6063228320104966`*^9, 
   3.606322832784009*^9}, {3.6063229617499895`*^9, 3.606322969966116*^9}, {
   3.6063230880534306`*^9, 3.60632308867344*^9}, {3.606323326792098*^9, 
   3.606323351907984*^9}, {3.6063241585333757`*^9, 3.606324176213147*^9}, {
   3.6063242390986137`*^9, 3.606324282976787*^9}, {3.6063252896207523`*^9, 
   3.606325335455456*^9}, {3.606325382408677*^9, 3.6063254796761713`*^9}, 
   3.6063255205958004`*^9, {3.6063256422796693`*^9, 3.6063256443697014`*^9}, {
   3.6063257654995623`*^9, 3.6063257718131595`*^9}, {3.6063259134153347`*^9, 
   3.6063259413512635`*^9}, {3.6063641741698074`*^9, 3.606364192141835*^9}, {
   3.6063962921905727`*^9, 3.606396292923774*^9}, {3.606397566017028*^9, 
   3.606397636689613*^9}, {3.6063987641059313`*^9, 3.6063987870742846`*^9}, {
   3.6063993176404343`*^9, 3.6063993563175287`*^9}, 3.606399599800769*^9, {
   3.6063996475075016`*^9, 3.6063996743244133`*^9}, {3.606400359189934*^9, 
   3.606400359405937*^9}, {3.6064147318617353`*^9, 3.606414780243503*^9}, {
   3.606414942771799*^9, 3.606414968356262*^9}, {3.606415002285203*^9, 
   3.6064150066924553`*^9}, {3.606415050503961*^9, 3.6064150561282825`*^9}, {
   3.60641510398302*^9, 3.606415107171202*^9}, {3.606415149653632*^9, 
   3.606415271963628*^9}, {3.606415318698301*^9, 3.6064153496960735`*^9}, {
   3.606415439297199*^9, 3.6064154439654655`*^9}, {3.6064155734418716`*^9, 
   3.606415614767235*^9}, {3.606416011403921*^9, 3.6064160367773724`*^9}, {
   3.6064160876492825`*^9, 3.606416106172342*^9}, {3.6064161413863564`*^9, 
   3.606416153926073*^9}, {3.606416201531796*^9, 3.6064162124114184`*^9}, {
   3.6064164226034403`*^9, 3.6064164262046466`*^9}, {3.606416461872687*^9, 
   3.606416519591988*^9}, {3.606416656556822*^9, 3.6064166609770746`*^9}, {
   3.6064168185180855`*^9, 3.6064168709460845`*^9}, {3.606416957848055*^9, 
   3.606416979023266*^9}, {3.6064171656359396`*^9, 3.606417188828266*^9}, {
   3.606417281174548*^9, 3.606417326051115*^9}, {3.6064173998823376`*^9, 
   3.606417433523262*^9}, {3.606417467458203*^9, 3.606417500314082*^9}, {
   3.606417563021669*^9, 3.606417603650993*^9}, {3.60641768716877*^9, 
   3.6064176935111322`*^9}, {3.6064177622060614`*^9, 
   3.6064178086767197`*^9}, {3.6064178503651037`*^9, 3.606417878485712*^9}, {
   3.6064179976875305`*^9, 3.6064180039158864`*^9}, {3.606418123197709*^9, 
   3.606418125106818*^9}, {3.6064182368102074`*^9, 3.606418260005534*^9}, {
   3.6064183038340406`*^9, 3.606418342140232*^9}, {3.606418430367278*^9, 
   3.6064184936949005`*^9}, {3.6064185644959497`*^9, 
   3.6064185666510735`*^9}, {3.606418677719426*^9, 3.606418679805545*^9}, {
   3.606436543470795*^9, 3.6064365573235874`*^9}, {3.6064365990219727`*^9, 
   3.606436622187298*^9}, {3.606436806983867*^9, 3.6064368072418823`*^9}, {
   3.6064369956476583`*^9, 3.6064369958616705`*^9}, {3.6064371207458134`*^9, 
   3.6064371247680435`*^9}, {3.606437206666728*^9, 3.606437213891141*^9}, {
   3.6064373010921288`*^9, 3.606437333845002*^9}, {3.606437504073738*^9, 
   3.606437504289751*^9}, {3.6064379454409833`*^9, 3.606437960092821*^9}, {
   3.60643800237824*^9, 3.6064380077955494`*^9}, 3.606438145670436*^9, {
   3.606438258982917*^9, 3.6064382599669733`*^9}, {3.6064386627170095`*^9, 
   3.6064386728355875`*^9}, 3.6064387767465315`*^9, {3.6064388356599007`*^9, 
   3.606438842335283*^9}, {3.606438893568213*^9, 3.6064389037777967`*^9}, {
   3.6064390608037786`*^9, 3.606439094682716*^9}, {3.60643915822235*^9, 
   3.606439168216922*^9}, {3.60643921800677*^9, 3.6064392821324377`*^9}, {
   3.6064393296501555`*^9, 3.6064393487792497`*^9}, {3.606439485563073*^9, 
   3.6064395051461935`*^9}, {3.6064399730149536`*^9, 
   3.6064399878037996`*^9}, {3.6064400590218735`*^9, 3.606440076553876*^9}, {
   3.606440176433589*^9, 3.606440197594799*^9}, {3.6064402464825954`*^9, 
   3.606440253792013*^9}, {3.606440304795931*^9, 3.6064403077140975`*^9}, {
   3.606440524532499*^9, 3.60644052752067*^9}, {3.6064406171897984`*^9, 
   3.6064406209470134`*^9}, {3.6064407805891447`*^9, 3.606440787295528*^9}, {
   3.6064408236496077`*^9, 3.606440826737784*^9}, {3.606440856834505*^9, 
   3.606440861141752*^9}, {3.606440938633184*^9, 3.6064409772093906`*^9}, {
   3.606441053326744*^9, 3.606441106262772*^9}, 3.606444049039694*^9, 
   3.6064453186513114`*^9, {3.606445356832495*^9, 3.6064453903224106`*^9}, {
   3.6064460612407846`*^9, 3.606446065857049*^9}, {3.6064472620654683`*^9, 
   3.6064472653066535`*^9}, {3.6064473773500624`*^9, 3.60644741524823*^9}, {
   3.6064479502198286`*^9, 3.606447954931098*^9}, {3.6064484225688453`*^9, 
   3.606448439300802*^9}, {3.6064485513762126`*^9, 3.6064485981438875`*^9}, {
   3.6064491456562033`*^9, 3.606449146282239*^9}, {3.6064500206902523`*^9, 
   3.6064500424354963`*^9}, {3.6064501861307154`*^9, 
   3.6064502041757474`*^9}, {3.6064503561234384`*^9, 3.606450386525177*^9}, {
   3.606450434761936*^9, 3.606450439513208*^9}, {3.606451475026436*^9, 
   3.6064514993578277`*^9}, {3.6064516406889114`*^9, 3.606451641669967*^9}, {
   3.606451678449071*^9, 3.6064516793211207`*^9}, {3.6064517315281067`*^9, 
   3.606451759627714*^9}, {3.606451796842843*^9, 3.6064518143328433`*^9}, {
   3.6064519192058415`*^9, 3.6064519258752227`*^9}, {3.606452216699857*^9, 
   3.6064522186629696`*^9}, {3.6064522760802536`*^9, 
   3.6064522873698993`*^9}, {3.6064970666377306`*^9, 3.606497093791284*^9}, {
   3.6065038281633205`*^9, 3.606503840282014*^9}, 3.6065039166513815`*^9, {
   3.6065040202203054`*^9, 3.6065040491359596`*^9}, {3.6065040977297387`*^9, 
   3.606504108380348*^9}, {3.606504661197423*^9, 3.6065046902290745`*^9}, {
   3.6065048228917074`*^9, 3.6065048766026015`*^9}, {3.6065051618482494`*^9, 
   3.6065051665282574`*^9}, {3.6065053048849*^9, 3.6065053281289415`*^9}, {
   3.6065053664738083`*^9, 3.606505366676609*^9}, {3.6065058994799447`*^9, 
   3.606505899916745*^9}, {3.6065060448254004`*^9, 3.6065060450282*^9}, {
   3.606507180334243*^9, 3.606507190269811*^9}, {3.606507227590946*^9, 
   3.606507233061259*^9}, {3.6065075649162397`*^9, 3.60650759935421*^9}, {
   3.6065118524739714`*^9, 3.606511873380167*^9}, {3.6065119107953067`*^9, 
   3.60651192204195*^9}, {3.6065119620362377`*^9, 3.606512020667591*^9}, {
   3.6065120648481183`*^9, 3.6065120652151394`*^9}, {3.606512300743611*^9, 
   3.6065123180115986`*^9}, {3.606513025830083*^9, 3.60651306913056*^9}, {
   3.6065131466389933`*^9, 3.60651315585252*^9}, 3.606514109189048*^9, {
   3.6065143855958576`*^9, 3.6065143962424664`*^9}, {3.6065144404339943`*^9, 
   3.606514443546172*^9}, {3.606514516508345*^9, 3.606514606479491*^9}, {
   3.606514642402546*^9, 3.606514647298826*^9}, {3.60657601305414*^9, 
   3.606576025845872*^9}, {3.6294885962975087`*^9, 3.6294885968975096`*^9}, {
   3.6294887670077477`*^9, 3.6294887811277676`*^9}, 3.629488946017998*^9, 
   3.6294889762180405`*^9, {3.6296799808714633`*^9, 3.6296800186377373`*^9}, {
   3.6296800765780973`*^9, 3.6296800878709183`*^9}, {3.6296851347661448`*^9, 
   3.6296851379193497`*^9}, {3.629685349895347*^9, 3.6296853630081725`*^9}, {
   3.629687834535861*^9, 3.6296878493575363`*^9}, {3.629687948266225*^9, 
   3.629687974576489*^9}, {3.629688037883552*^9, 3.629688063712802*^9}, {
   3.6296883160957127`*^9, 3.629688343615058*^9}, {3.629688397209632*^9, 
   3.629688550367888*^9}, {3.6296886595640845`*^9, 3.6296887226079693`*^9}, {
   3.6296888438827596`*^9, 3.629688845144821*^9}, {3.6296892354808598`*^9, 
   3.629689305209598*^9}, {3.629689337167848*^9, 3.629689419362879*^9}, {
   3.6296919656916075`*^9, 3.6296919761680284`*^9}, {3.629693840199733*^9, 
   3.629693883066039*^9}, {3.629694123954773*^9, 3.629694194523058*^9}, {
   3.6296947833640385`*^9, 3.629694888216888*^9}, {3.629694974957252*^9, 
   3.6296949794912605`*^9}, {3.629695016853715*^9, 3.629695019568119*^9}, {
   3.629695068915369*^9, 3.629695070147771*^9}, {3.629695109662041*^9, 
   3.629695114045649*^9}, {3.629695201142003*^9, 3.629695257094702*^9}, {
   3.62969537974232*^9, 3.6296954018213587`*^9}, {3.629696180423136*^9, 
   3.6296961858685455`*^9}, {3.6296963162037787`*^9, 3.629696339169019*^9}, {
   3.629696377961688*^9, 3.6296963834996977`*^9}, {3.6296965025197077`*^9, 
   3.6296965251135483`*^9}, {3.629696620824117*^9, 3.629696632212137*^9}, {
   3.629696802275838*^9, 3.6296968542465296`*^9}, {3.629696951030902*^9, 
   3.6296970408562603`*^9}, {3.6296971532200594`*^9, 
   3.6296971742090964`*^9}, {3.6296972117497625`*^9, 
   3.6296972119681635`*^9}, {3.6296983718489113`*^9, 3.629698430922616*^9}, {
   3.6297274409048233`*^9, 3.629727464498066*^9}, {3.629727549906616*^9, 
   3.629727575325061*^9}, {3.6298456915444603`*^9, 3.629845701823281*^9}, {
   3.6298466291949453`*^9, 3.629846666829425*^9}, {3.6298469219078183`*^9, 
   3.629846938961754*^9}, {3.6298479732442703`*^9, 3.629847981134386*^9}, {
   3.6298483244007435`*^9, 3.6298483318414574`*^9}, {3.6298495776124363`*^9, 
   3.6298496207215223`*^9}, {3.6298535794568644`*^9, 
   3.6298536651670313`*^9}, {3.6298565207288785`*^9, 3.629856553513338*^9}, {
   3.629856638479088*^9, 3.629856659976926*^9}, {3.629857007221711*^9, 
   3.629857185623915*^9}, {3.629857221652976*^9, 3.6298572354907675`*^9}, {
   3.6298578357671013`*^9, 3.629857837127179*^9}, {3.6298579337247043`*^9, 
   3.6298579347447624`*^9}, {3.6298583272482123`*^9, 3.629858336241727*^9}, {
   3.62985863141861*^9, 3.629858633529731*^9}, {3.6298587849903936`*^9, 
   3.629858787928562*^9}, {3.6298588330311413`*^9, 3.629858860998741*^9}, {
   3.6298589360020313`*^9, 3.6298589428714237`*^9}, {3.629858986492919*^9, 
   3.6298589905491514`*^9}, 3.6298590768890896`*^9, {3.6298591288600616`*^9, 
   3.629859140505728*^9}, {3.6298591782148848`*^9, 3.6298591787819176`*^9}, {
   3.6298602983039503`*^9, 3.6298603530510817`*^9}, {3.6298662871976805`*^9, 
   3.6298662977812347`*^9}, {3.6298663995469913`*^9, 
   3.6298664025379076`*^9}, {3.629867805946912*^9, 3.629867863096182*^9}, {
   3.629867907431799*^9, 3.6298679076657996`*^9}, {3.629867938097679*^9, 
   3.629867942122688*^9}, {3.629909176889841*^9, 3.6299091975004773`*^9}, 
   3.629913789766417*^9, {3.6299138340045967`*^9, 3.62991395336893*^9}, {
   3.6299140417827883`*^9, 3.62991407057073*^9}, {3.629914105261263*^9, 
   3.6299141170914445`*^9}, {3.62991463043447*^9, 3.629914631089671*^9}, {
   3.6299146885963717`*^9, 3.6299146937131815`*^9}, {3.629915088830967*^9, 
   3.6299153407597475`*^9}, {3.6299158092601366`*^9, 
   3.6299158115221405`*^9}, {3.629915927193079*^9, 3.62991594200121*^9}, {
   3.629915992793312*^9, 3.629916008839244*^9}, {3.6299175161541896`*^9, 
   3.629917520155297*^9}, {3.8352604732219753`*^9, 3.8352604820549183`*^9}, {
   3.8352605560487156`*^9, 3.8352605661361046`*^9}, {3.8352606134635315`*^9, 
   3.835260705039947*^9}, {3.835260944287466*^9, 3.835260981278107*^9}, {
   3.8352648500877113`*^9, 3.835264945400612*^9}, 3.835265138891713*^9, 
   3.835265250326704*^9, {3.8352654302317057`*^9, 3.835265468734707*^9}, {
   3.8352655060487137`*^9, 3.8352655385707192`*^9}, 3.8352655851567087`*^9, {
   3.8352656489007072`*^9, 3.8352656525567055`*^9}, {3.835265786824703*^9, 
   3.835265797340705*^9}, {3.8352658960417137`*^9, 3.835265912952714*^9}, {
   3.8358344604663134`*^9, 3.8358345415951815`*^9}, {3.835834660938274*^9, 
   3.8358346826122007`*^9}, 3.8358347516523027`*^9, {3.8358347824806023`*^9, 
   3.8358347897211666`*^9}, {3.835835027221261*^9, 3.83583504546306*^9}, 
   3.8358355241242986`*^9, {3.8358537209622617`*^9, 3.8358537218619366`*^9}, {
   3.835853860567198*^9, 3.8358538736692047`*^9}, {3.835853980327199*^9, 
   3.835854096390462*^9}, {3.835854154295315*^9, 3.8358542191043854`*^9}, 
   3.8358543188331223`*^9, 3.8358544858413568`*^9, {3.8358545448720794`*^9, 
   3.835854618507143*^9}, 3.835854670120367*^9, {3.8358550024069624`*^9, 
   3.8358550347031765`*^9}, {3.835855071842867*^9, 3.8358550737479362`*^9}, {
   3.8358554434619637`*^9, 3.835855447220962*^9}, {3.8358554908449535`*^9, 
   3.835855547995963*^9}, {3.8358555928489633`*^9, 3.8358556857759504`*^9}, 
   3.8358608694734063`*^9, {3.835861218022401*^9, 3.835861222666402*^9}, 
   3.8359204809663844`*^9, {3.835922515828598*^9, 3.8359225278335958`*^9}, {
   3.835922952245639*^9, 3.835922965302247*^9}, {3.8359229990234833`*^9, 
   3.835923000831025*^9}, {3.836445921150355*^9, 3.836445927413431*^9}, {
   3.8365264813084908`*^9, 3.836526505542826*^9}, {3.8365274865371704`*^9, 
   3.8365274874911737`*^9}, {3.8374039957093225`*^9, 3.837404033976358*^9}, {
   3.8374042086242533`*^9, 3.8374042355055265`*^9}, {3.8374043572113156`*^9, 
   3.8374043831501446`*^9}, {3.837404437456546*^9, 3.8374044624903917`*^9}, {
   3.83740449461442*^9, 3.8374045284836416`*^9}, {3.8374295136883783`*^9, 
   3.837429532989379*^9}, {3.837429592547739*^9, 3.837429623021738*^9}, {
   3.837429748577462*^9, 3.83742977871146*^9}, {3.8376093050331783`*^9, 
   3.837609322988505*^9}, {3.8376402802354355`*^9, 3.8376402992055955`*^9}, {
   3.8376420561552305`*^9, 3.837642073760215*^9}, {3.8376519822422276`*^9, 
   3.837652028610064*^9}, {3.837652062236641*^9, 3.837652085651631*^9}, {
   3.8381944240614862`*^9, 3.8381944631469693`*^9}, {3.8381945747683415`*^9, 
   3.8381945762084007`*^9}, {3.8381946413935595`*^9, 
   3.8381946436989913`*^9}, {3.838194687583386*^9, 3.838194700899796*^9}, {
   3.838194779023388*^9, 3.8381948081002626`*^9}, {3.838194905251423*^9, 
   3.838194956058038*^9}, {3.838194986065569*^9, 3.8381949953028364`*^9}, {
   3.8381950899579177`*^9, 3.8381950995470543`*^9}, {3.838195158198583*^9, 
   3.838195174793747*^9}, {3.8381952508727427`*^9, 3.8381952736796026`*^9}, {
   3.8381953500940866`*^9, 3.8381953820097623`*^9}, {3.838195468501559*^9, 
   3.8381954918887043`*^9}, {3.8381955357781076`*^9, 
   3.8381955716109304`*^9}, {3.8381956070075502`*^9, 
   3.8381956350348434`*^9}, {3.8381957049801264`*^9, 3.83819570533545*^9}, {
   3.838195738157835*^9, 3.8381957473195305`*^9}, {3.8484419076604977`*^9, 
   3.8484419087386265`*^9}, {3.848442014397646*^9, 3.8484420157414036`*^9}, {
   3.8484425911568623`*^9, 3.848442664071447*^9}, {3.8484426989018383`*^9, 
   3.84844274030744*^9}, {3.8484427917398005`*^9, 3.848442815786748*^9}, 
   3.8484434228326845`*^9, {3.848443486111277*^9, 3.84844349231441*^9}, {
   3.848443601219737*^9, 3.8484436021997232`*^9}, {3.8484534136055975`*^9, 
   3.848453424901634*^9}, {3.848453480789186*^9, 3.8484535098278446`*^9}, {
   3.848453892722439*^9, 3.848453897000801*^9}, {3.8484539628244705`*^9, 
   3.848453965025116*^9}, {3.8484543128130603`*^9, 3.848454324733714*^9}, {
   3.8484544704381456`*^9, 3.848454481537304*^9}, {3.8489649824610057`*^9, 
   3.848965039115215*^9}, {3.84896561115292*^9, 3.8489656520891953`*^9}, {
   3.8489670374554462`*^9, 3.8489670773445735`*^9}, {3.8489671325833683`*^9, 
   3.848967154719345*^9}, 3.848967250273019*^9, {3.848967300592693*^9, 
   3.8489673258721857`*^9}, {3.848972425854159*^9, 3.848972456689865*^9}, {
   3.848972787251534*^9, 3.848972796692314*^9}, {3.8489729181805964`*^9, 
   3.8489729683662124`*^9}, 3.848974080493124*^9, {3.8489741507264996`*^9, 
   3.848974163700632*^9}, {3.8489958497178555`*^9, 3.848995878812834*^9}, {
   3.848995968709449*^9, 3.848995969196148*^9}, {3.848997910887697*^9, 
   3.8489979112684593`*^9}, {3.849521715994841*^9, 3.8495217442550726`*^9}, {
   3.8495220154749055`*^9, 3.8495220279534903`*^9}, {3.8495816418626146`*^9, 
   3.849581657198245*^9}, 3.8495817911661963`*^9, 3.849581824192073*^9, {
   3.855279768745489*^9, 3.8552797859758854`*^9}, {3.8552799614545107`*^9, 
   3.855280005108652*^9}, {3.855280389021513*^9, 3.8552803984856887`*^9}, {
   3.8552804546289988`*^9, 3.85528048605374*^9}, {3.855280549156173*^9, 
   3.8552807246729054`*^9}, 3.8552807602919903`*^9, {3.8552808009510202`*^9, 
   3.855280962198807*^9}, {3.855280996585648*^9, 3.8552810116903563`*^9}, 
   3.85528105797643*^9, {3.8552811079924135`*^9, 3.855281115298916*^9}, {
   3.8552840441236677`*^9, 3.855284105257519*^9}, {3.8552844819112463`*^9, 
   3.855284680846075*^9}, {3.8552847117816424`*^9, 3.85528475782931*^9}, {
   3.8673288038893433`*^9, 3.8673288335845213`*^9}, 3.867328884886866*^9, {
   3.87325321388341*^9, 3.873253217730117*^9}, 3.8732534882187333`*^9, {
   3.8732535669776907`*^9, 3.873253595523494*^9}, {3.8732537956131973`*^9, 
   3.8732537992535644`*^9}, {3.8732538594358497`*^9, 3.873253864003264*^9}, {
   3.875245028156578*^9, 3.8752450926390014`*^9}, {3.8752451380557566`*^9, 
   3.875245139040126*^9}, {3.87575716327925*^9, 3.875757185751695*^9}, {
   3.889602304915575*^9, 3.889602307209561*^9}, {3.889602471652562*^9, 
   3.8896024819295597`*^9}, {3.889602545491559*^9, 3.8896025806145687`*^9}, {
   3.8896026822315598`*^9, 3.889602685287563*^9}, {3.889602925274559*^9, 
   3.8896029372295666`*^9}, {3.8896029722415595`*^9, 
   3.8896030509595585`*^9}, {3.889603096071562*^9, 3.889603131508566*^9}, {
   3.88960318263556*^9, 3.8896031908885593`*^9}, {3.8896032545795593`*^9, 
   3.8896033360605593`*^9}, 3.8896034326115627`*^9, {3.889603536392559*^9, 
   3.8896035478725653`*^9}, {3.8896036003465643`*^9, 3.889603615736559*^9}, {
   3.8896036497715635`*^9, 3.8896036744905653`*^9}, 3.889603834222559*^9, {
   3.8896045386975594`*^9, 3.8896045473945603`*^9}, {3.88960488093356*^9, 
   3.889604967444567*^9}, 3.8896057212865644`*^9, {3.8896063804765596`*^9, 
   3.8896063885525646`*^9}, {3.8896064205655613`*^9, 
   3.8896064522945623`*^9}, {3.8896067030025597`*^9, 3.889606734647565*^9}, {
   3.8896073546055655`*^9, 3.8896074058985596`*^9}, 3.8896075351715603`*^9, {
   3.8902697174065456`*^9, 3.890269720045919*^9}, 3.890269827315936*^9, {
   3.891403834983887*^9, 3.89140385597395*^9}, 3.891406065272501*^9, {
   3.892209882330329*^9, 3.892209922365061*^9}, {3.893157340995318*^9, 
   3.8931573422570715`*^9}, {3.8955547748879995`*^9, 
   3.8955547749090014`*^9}, {3.8955551724265757`*^9, 
   3.8955551724325724`*^9}, {3.8955556351694913`*^9, 3.895555635243953*^9}, {
   3.895555716336913*^9, 3.895555716344909*^9}, 3.959760283983674*^9, {
   3.959821851733672*^9, 3.959821865258765*^9}, {3.959935525968089*^9, 
   3.9599355417994223`*^9}, {3.959935794820619*^9, 3.959935804470138*^9}, {
   3.960344501776495*^9, 3.9603445583115053`*^9}, {3.960344612655274*^9, 
   3.960344647630383*^9}, {3.975313227695765*^9, 
   3.9753133027965727`*^9}},ExpressionUUID->"4ea885f3-5b3b-40e6-892f-\
1255f61a94e7"]
}, Closed]],

Cell[CellGroupData[{

Cell["PotentialForm", "Subsection",
 CellChangeTimes->{{3.867328216488799*^9, 
  3.867328221648931*^9}},ExpressionUUID->"ee5698d3-2006-4985-94f3-\
ce90c4ed802b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PotentialForm", "[", 
    RowBox[{
     RowBox[{"\[Alpha]_Tensor", "/;", 
      RowBox[{"(", 
       RowBox[{"!", 
        RowBox[{"TestScalarTensor", "[", "\[Alpha]", "]"}]}], ")"}]}], ",", 
     RowBox[{"tensor___", "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", "tensor", "}"}], "===", 
          RowBox[{"{", "Tensor", "}"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", "tensor", "}"}], "===", 
          RowBox[{"{", "}"}]}], ")"}]}], ")"}]}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "indices", ",", "t", ",", "rep", ",", "zup", ",", "p", ",", "\[Mu]T", 
        ",", "\[Beta]", ",", "tc", ",", "zp", ",", "zmzp", ",", "cood", ",", 
        "i", ",", "tclist", ",", "tclist2", ",", "rep1", ",", "rep2"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"zp", "=", 
        RowBox[{"OptionValue", "[", "StartingPoint", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"t", "=", 
        RowBox[{"OptionValue", "[", "IntegrationVariable", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cood", "=", 
        RowBox[{"Coordinates", "[", "\[Alpha]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"zp", "===", "Null"}], ")"}], ",", 
         RowBox[{"zp", "=", 
          RowBox[{"TensorComponents", "[", 
           RowBox[{"ZeroTensor", "[", 
            RowBox[{
             RowBox[{"{", 
              SuperscriptBox["i", "-"], "}"}], ",", 
             RowBox[{"Coordinates", "->", "cood"}]}], "]"}], "]"}]}]}], "]"}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"zmzp", "=", 
        RowBox[{"cood", "-", "zp"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"TestDifferentialForm", "[", "\[Alpha]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"indices", "=", 
        RowBox[{"RemoveUnderBarredIndices", "[", 
         RowBox[{"Indices", "[", "\[Alpha]", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rep", "=", 
        RowBox[{"Thread", "[", 
         RowBox[{"cood", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"zp", "+", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"t", " ", "#"}], ")"}], "&"}], "/@", "zmzp"}], 
             ")"}]}], ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"zup", "=", 
        RowBox[{"NonMetricTensor", "[", 
         RowBox[{
          RowBox[{"{", 
           SuperscriptBox[
            RowBox[{"indices", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "-"], "}"}], 
          ",", "zmzp", ",", "\"\<z-z'\>\"", ",", 
          RowBox[{"Coordinates", "\[Rule]", 
           RowBox[{"Coordinates", "[", "\[Alpha]", "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"p", "=", 
        RowBox[{"RankNumber", "[", "\[Alpha]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Mu]T", "=", 
        RowBox[{"TensorsProduct", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Alpha]", "/.", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
             "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{"TensorComponents", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"mx", "/.", "rep"}], ")"}]}], ")"}]}]}], ")"}], " ", 
          "zup"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p", "===", "1"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", "tensor", "}"}], "=!=", 
             RowBox[{"{", "Tensor", "}"}]}], ")"}]}], ")"}], ",", 
         RowBox[{
          RowBox[{"\[Beta]", "=", 
           RowBox[{"Integrate", "[", 
            RowBox[{"\[Mu]T", ",", "t"}], "]"}]}], ";", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Quiet", "[", 
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"{", "\[Beta]", "}"}], ",", 
                 RowBox[{"Integrate", "[", "__", "]"}], ",", "Infinity"}], 
                "]"}], "]"}], "=!=", 
              RowBox[{"{", "}"}]}], ")"}], ",", 
            RowBox[{"\[Beta]", "=", 
             RowBox[{"Inactivate", "[", 
              RowBox[{
               RowBox[{"Replace", "[", 
                RowBox[{"\[Beta]", ",", 
                 RowBox[{"t", "->", 
                  RowBox[{"{", 
                   RowBox[{"t", ",", "0", ",", "1"}], "}"}]}], ",", 
                 RowBox[{"{", "1", "}"}]}], "]"}], ",", "Integrate"}], 
              "]"}]}], ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Quiet", "[", 
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"{", "\[Beta]", "}"}], ",", 
                 RowBox[{"Integrate", "[", "__", "]"}], ",", "Infinity"}], 
                "]"}], "]"}], "===", 
              RowBox[{"{", "}"}]}], ")"}], ",", 
            RowBox[{"\[Beta]", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Beta]", "/.", 
                RowBox[{"t", "->", "1"}]}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"\[Beta]", "/.", 
                RowBox[{"t", "->", "0"}]}], ")"}]}]}]}], "]"}]}], ",", "True",
          ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tc", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Integrate", "[", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["t", 
                  RowBox[{"(", 
                   RowBox[{"p", "-", "1"}], ")"}]], " ", "#"}], ",", "t"}], 
               "]"}], "&"}], ",", 
             RowBox[{"(", 
              RowBox[{"TensorComponents", "[", "\[Mu]T", "]"}], ")"}], ",", 
             RowBox[{"{", 
              RowBox[{"p", "-", "1"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Quiet", "[", 
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"{", "tc", "}"}], ",", 
                 RowBox[{"Integrate", "[", "__", "]"}], ",", "Infinity"}], 
                "]"}], "]"}], "=!=", 
              RowBox[{"{", "}"}]}], ")"}], ",", 
            RowBox[{
             RowBox[{"tc", "=", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Integrate", "[", 
                  RowBox[{
                   RowBox[{
                    SuperscriptBox["t", 
                    RowBox[{"(", 
                    RowBox[{"p", "-", "1"}], ")"}]], " ", "#"}], ",", "t"}], 
                  "]"}], "&"}], ",", 
                RowBox[{"(", 
                 RowBox[{"TensorComponents", "[", "\[Mu]T", "]"}], ")"}], ",", 
                RowBox[{"{", 
                 RowBox[{"p", "-", "1"}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"tclist", "=", 
              RowBox[{"Quiet", "[", 
               RowBox[{"Cases", "[", 
                RowBox[{"tc", ",", 
                 RowBox[{"Integrate", "[", "__", "]"}], ",", "Infinity"}], 
                "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"rep1", "=", 
              RowBox[{"Thread", "[", 
               RowBox[{"tclist", "->", 
                RowBox[{"Inactivate", "[", 
                 RowBox[{
                  RowBox[{"Replace", "[", 
                   RowBox[{"tclist", ",", 
                    RowBox[{"t", "->", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", "0", ",", "1"}], "}"}]}], ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}], ",", "Integrate"}], 
                 "]"}]}], "]"}]}], ";", 
             RowBox[{"tclist2", "=", 
              RowBox[{"Quiet", "[", 
               RowBox[{"DeleteCases", "[", 
                RowBox[{"tc", ",", 
                 RowBox[{"Integrate", "[", "__", "]"}], ",", "Infinity"}], 
                "]"}], "]"}]}], ";", 
             RowBox[{"rep2", "=", 
              RowBox[{"Thread", "[", 
               RowBox[{"tclist2", "->", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"tclist2", "/.", 
                    RowBox[{"t", "->", "1"}]}], ")"}], "-", 
                  RowBox[{"(", 
                   RowBox[{"tclist2", "/.", 
                    RowBox[{"t", "->", "0"}]}], ")"}]}], ")"}]}], "]"}]}], 
             ";", 
             RowBox[{"tc", "=", 
              RowBox[{"(", 
               RowBox[{"tc", "/.", 
                RowBox[{"Join", "[", 
                 RowBox[{"rep1", ",", "rep2"}], "]"}]}], ")"}]}], ";"}], ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Quiet", "[", 
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"{", "tc", "}"}], ",", 
                 RowBox[{"Integrate", "[", "__", "]"}], ",", "Infinity"}], 
                "]"}], "]"}], "===", 
              RowBox[{"{", "}"}]}], ")"}], ",", 
            RowBox[{
             RowBox[{"tc", "=", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"tc", "/.", 
                 RowBox[{"t", "->", "1"}]}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"tc", "/.", 
                 RowBox[{"t", "->", "0"}]}], ")"}]}]}], ";"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Beta]", "=", 
           RowBox[{"TensorName", "[", 
            RowBox[{
             RowBox[{"Indices", "[", 
              RowBox[{"\[Alpha]", ",", 
               RowBox[{"RemoveUnderBarredIndices", "[", 
                RowBox[{"Indices", "[", "\[Mu]T", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"OptionValue", "[", "TensorName", "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Beta]", "=", 
           RowBox[{"\[Beta]", "/.", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
             "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"TensorComponents", "\[Rule]", "tc"}], ")"}]}]}]}]}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], "/;", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"OptionValue", "[", "StartingPoint", "]"}], "===", "Null"}], 
       ")"}], ",", "True", ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"OptionValue", "[", "StartingPoint", "]"}], "=!=", "Null"}], 
       ")"}], ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Dimensions", "[", 
         RowBox[{"Coordinates", "[", "\[Alpha]", "]"}], "]"}], "===", 
        RowBox[{"Dimensions", "[", 
         RowBox[{"OptionValue", "[", "StartingPoint", "]"}], "]"}]}], ")"}]}],
      "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8273977289769225`*^9, 3.8273977812329187`*^9}, 
   3.827397822806463*^9, {3.827397968537464*^9, 3.827397997394462*^9}, {
   3.827398147233434*^9, 3.827398149618436*^9}, {3.8273981980344453`*^9, 
   3.8273982176574335`*^9}, 3.827399388146923*^9, {3.8273994610173683`*^9, 
   3.8273996208470078`*^9}, {3.8273997447970066`*^9, 
   3.8273997674971094`*^9}, {3.827399945547058*^9, 3.8274000345474024`*^9}, {
   3.8274003204670353`*^9, 3.827400320617378*^9}, {3.8274018870534353`*^9, 
   3.8274019128304358`*^9}, {3.8274020115474353`*^9, 3.827402011746435*^9}, {
   3.827402555874447*^9, 3.827402560071436*^9}, {3.827402616403505*^9, 
   3.827402721026507*^9}, {3.8274027657955055`*^9, 3.827402766018505*^9}, {
   3.827402865315505*^9, 3.8274029211545057`*^9}, {3.8274032953502235`*^9, 
   3.8274032997042713`*^9}, 3.8279123514164157`*^9, {3.8293907518052874`*^9, 
   3.829390752908742*^9}, {3.8293909656440907`*^9, 3.829390988110962*^9}, {
   3.829391266781184*^9, 3.8293912737178097`*^9}, {3.83030063830005*^9, 
   3.8303006575925713`*^9}, {3.83030120221494*^9, 3.830301223956378*^9}, {
   3.830301358484892*^9, 3.830301376862209*^9}, {3.830301444355482*^9, 
   3.8303014456592965`*^9}, {3.8364759682785816`*^9, 3.836475971171385*^9}, {
   3.838195988519491*^9, 3.838195993465493*^9}, {3.8516596540964975`*^9, 
   3.8516596578373747`*^9}, {3.8673282336289883`*^9, 3.867328265302905*^9}, {
   3.867329078652602*^9, 3.867329118152673*^9}, {3.8673304344235315`*^9, 
   3.8673305122253447`*^9}, {3.8673305651426754`*^9, 3.867330579402545*^9}, {
   3.867331136774845*^9, 3.8673311960419235`*^9}, 3.867376105145117*^9, 
   3.8673765325427847`*^9, {3.869046352160098*^9, 3.8690463962400303`*^9}, {
   3.8690465078387933`*^9, 3.8690465130491276`*^9}, 3.8690465743585825`*^9, 
   3.8691003254665437`*^9, {3.8692697717517233`*^9, 3.8692697818722167`*^9}, 
   3.887082334919702*^9, {3.8870827317341256`*^9, 3.887082735538089*^9}, {
   3.8871791365292025`*^9, 3.8871791438931603`*^9}, {3.8871791794721327`*^9, 
   3.8871792480546722`*^9}, {3.887181567450526*^9, 3.887181597414977*^9}, {
   3.8871816316367865`*^9, 3.8871816384135933`*^9}, {3.889052479686715*^9, 
   3.8890525324532824`*^9}, {3.889662518444789*^9, 3.8896625389687915`*^9}, {
   3.8914039199506598`*^9, 3.8914039366637554`*^9}, {3.8932891245473714`*^9, 
   3.8932891245503693`*^9}, {3.895073261600118*^9, 3.895073261600118*^9}, {
   3.895549051620682*^9, 3.8955490516286774`*^9}, {3.8955553399432087`*^9, 
   3.895555339946207*^9}, {3.895555635250953*^9, 3.8955556352659416`*^9}, {
   3.898392273491191*^9, 3.8983922977144566`*^9}, {3.8983923649790697`*^9, 
   3.898392417322427*^9}, {3.89839313018328*^9, 3.8983931332642927`*^9}, {
   3.9598183597213306`*^9, 3.959818369603591*^9}, {3.959818605489161*^9, 
   3.959818622114355*^9}, {3.967777452048622*^9, 3.967777452107832*^9}, 
   3.9723773427086287`*^9, 3.9723776830550947`*^9, 3.972378506700919*^9, {
   3.972378641952404*^9, 3.972378643376905*^9}, 3.972421999420703*^9, 
   3.972429156283762*^9, {3.972457815630247*^9, 3.972457820728862*^9}, 
   3.972464340445223*^9, 3.972466463295741*^9, {3.972470882590507*^9, 
   3.9724708955289097`*^9}, 3.9725433846997547`*^9, 3.972940597512404*^9, 
   3.9729409528686123`*^9, 3.9730305761897984`*^9, {3.9732103650069017`*^9, 
   3.973210372438738*^9}, {3.975313318658009*^9, 
   3.975313324353511*^9}},ExpressionUUID->"227748a2-679c-45f6-b405-\
0147348e80ed"]
}, Closed]],

Cell[CellGroupData[{

Cell["LeviCivita", "Subsection",
 CellChangeTimes->{{3.52174375309375*^9, 3.5217437626875*^9}, {
   3.669439370764881*^9, 3.669439374298902*^9}, 3.887015664199131*^9, 
   3.8870157934571705`*^9},ExpressionUUID->"131904c6-bd11-4ab3-96db-\
cf9c959fa90e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"LeviCivita", "[", 
      RowBox[{"\[Nu]I__", ",", "m_Tensor"}], "]"}], "/;", 
     RowBox[{
      RowBox[{"TestMetricTensor", "[", "m", "]"}], "&&", 
      RowBox[{"(", 
       RowBox[{"(*", " ", 
        RowBox[{"check", " ", "space", 
         RowBox[{"(", "time", ")"}], " ", "dimensions"}], " ", "*)"}], 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"{", "\[Nu]I", "}"}], "]"}], "===", 
        RowBox[{"Length", "[", 
         RowBox[{"Coordinates", "[", "m", "]"}], "]"}]}], ")"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Union", "[", 
         RowBox[{"TestIndices", "/@", 
          RowBox[{"{", "\[Nu]I", "}"}]}], "]"}], "===", 
        RowBox[{"{", "True", "}"}]}], ")"}]}]}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "mm", ",", "\[Sigma]", ",", "si", ",", "cooo", ",", "d", ",", 
        "LeviCivitaTemp"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cooo", "=", 
        RowBox[{"Coordinates", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{"Length", "[", "cooo", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"si", "=", 
        RowBox[{"StartIndex", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mm", "=", 
        RowBox[{
         RowBox[{"Power", "[", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"Determinant", "[", "m", "]"}], "]"}], ",", 
           FractionBox["1", "2"]}], "]"}], 
         RowBox[{"LeviCivitaTensor", "[", "d", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"LeviCivita", " ", 
         RowBox[{"w", "/", " ", "lower"}], " ", "indices"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"LeviCivitaTemp", "=", 
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TensorName", "\[Rule]", 
           RowBox[{"OverTilde", "[", "\"\<\[Epsilon]\>\"", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Coordinates", "\[Rule]", "cooo"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", "mm"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SubscriptBox[
               RowBox[{"Unique", "[", "\[Sigma]", "]"}], "-"], "&"}], "/@", 
             RowBox[{"{", "\[Nu]I", "}"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TooltipStyle", "\[Rule]", " ", 
           RowBox[{"TooltipStyle", "[", "m", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TensorAssumption", "\[Rule]", " ", 
           RowBox[{"TensorAssumption", "[", "m", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TensorOperator", "\[Rule]", 
           RowBox[{"TensorOperator", "[", "m", "]"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"MoveIndices", "[", 
        RowBox[{"LeviCivitaTemp", ",", 
         RowBox[{"{", "\[Nu]I", "}"}], ",", "m"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LeviCivita", "[", 
     RowBox[{"\[Nu]I__", ",", "m_Tensor", ",", "Minus"}], "]"}], "/;", 
    RowBox[{
     RowBox[{"TestMetricTensor", "[", "m", "]"}], "&&", 
     RowBox[{"(", 
      RowBox[{"(*", " ", 
       RowBox[{"check", " ", "space", 
        RowBox[{"(", "time", ")"}], " ", "dimensions"}], " ", "*)"}], 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"{", "\[Nu]I", "}"}], "]"}], "===", 
       RowBox[{"Length", "[", 
        RowBox[{"Coordinates", "[", "m", "]"}], "]"}]}], ")"}], "&&", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Union", "[", 
        RowBox[{"TestIndices", "/@", 
         RowBox[{"{", "\[Nu]I", "}"}]}], "]"}], "===", 
       RowBox[{"{", "True", "}"}]}], ")"}]}]}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"LeviCivita", "[", 
      RowBox[{"\[Nu]I", ",", "m"}], "]"}], "/.", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
      "\[RuleDelayed]", 
      RowBox[{"(", 
       RowBox[{"TensorComponents", "\[Rule]", 
        RowBox[{"-", "mx"}]}], ")"}]}]}], ")"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.52174396084375*^9, 3.521743989140625*^9}, {
   3.52174404553125*^9, 3.52174406490625*^9}, {3.52174411178125*^9, 
   3.521744178*^9}, {3.52175753421875*^9, 3.52175753465625*^9}, {
   3.521759735640625*^9, 3.521759758125*^9}, {3.5217868350625*^9, 
   3.521786885078125*^9}, {3.52178704734375*^9, 3.521787116328125*^9}, {
   3.521787178828125*^9, 3.5217871886875*^9}, {3.521787424390625*^9, 
   3.5217874283125*^9}, {3.521787532828125*^9, 3.52178754371875*^9}, 
   3.521910410859375*^9, {3.5219174194375*^9, 3.521917422546875*^9}, {
   3.521917491703125*^9, 3.5219174925*^9}, {3.521917608890625*^9, 
   3.521917617625*^9}, {3.521918314421875*^9, 3.521918316125*^9}, {
   3.521919269328125*^9, 3.5219193048125*^9}, {3.521919497375*^9, 
   3.52191951465625*^9}, {3.521921384*^9, 3.5219213845625*^9}, {
   3.521922223546875*^9, 3.5219222338125*^9}, {3.521955617484375*^9, 
   3.521955648359375*^9}, {3.521990471359375*^9, 3.52199061959375*^9}, {
   3.521990750328125*^9, 3.521990763484375*^9}, {3.532452011949185*^9, 
   3.532452013961588*^9}, {3.532452056362463*^9, 3.5324520586088667`*^9}, {
   3.5324523712334156`*^9, 3.5324523744782214`*^9}, {3.5324524076906796`*^9, 
   3.532452416130295*^9}, {3.6297526960186977`*^9, 3.629752705008212*^9}, {
   3.6299261040969267`*^9, 3.629926110841316*^9}, 3.6694393941659937`*^9, {
   3.669441203316702*^9, 3.669441278031819*^9}, {3.6694413314969053`*^9, 
   3.669441344335925*^9}, {3.6694413927307887`*^9, 3.6694414202318296`*^9}, {
   3.669514862752521*^9, 3.6695148645345235`*^9}, {3.6695149391946507`*^9, 
   3.669514991276733*^9}, {3.669515032105801*^9, 3.66951506111785*^9}, {
   3.6695152519181633`*^9, 3.669515260451182*^9}, {3.6695153013712487`*^9, 
   3.669515312627266*^9}, {3.6695154093496957`*^9, 3.6695154099216995`*^9}, {
   3.6695167123289385`*^9, 3.669516722073496*^9}, {3.6695173941773467`*^9, 
   3.669517413711464*^9}, {3.6695188004335203`*^9, 3.669518824793914*^9}, {
   3.6695194703083725`*^9, 3.6695194811419926`*^9}, {3.6695209914193163`*^9, 
   3.669521009949376*^9}, {3.669521115596419*^9, 3.6695212488830423`*^9}, {
   3.6695213351253843`*^9, 3.6695213791829042`*^9}, {3.669523166945903*^9, 
   3.6695232008429565`*^9}, {3.6695232691576443`*^9, 
   3.6695232946376853`*^9}, {3.669523348301781*^9, 3.6695234515499983`*^9}, {
   3.6695234848580523`*^9, 3.6695234857220545`*^9}, {3.6695235958404326`*^9, 
   3.669523596974471*^9}, {3.6695236354808025`*^9, 3.66952372849792*^9}, {
   3.66952376388914*^9, 3.6695237647051687`*^9}, {3.669523797091816*^9, 
   3.6695238756779413`*^9}, {3.6695239078229923`*^9, 3.6695239452280507`*^9}, 
   3.669524104919151*^9, {3.6695244117364087`*^9, 3.6695244138805313`*^9}, {
   3.66952454961929*^9, 3.669524582457168*^9}, {3.669524667216015*^9, 
   3.669524719319178*^9}, {3.669524760089368*^9, 3.6695248023595705`*^9}, {
   3.6695248594438553`*^9, 3.669524879383955*^9}, {3.6695251507197723`*^9, 
   3.6695252045538516`*^9}, {3.669525319076599*^9, 3.6695255239586067`*^9}, {
   3.669525569509823*^9, 3.6695255843268876`*^9}, {3.669526032181349*^9, 
   3.6695260335224257`*^9}, {3.669526535424133*^9, 3.669526592160378*^9}, {
   3.6695269712790256`*^9, 3.6695270006767073`*^9}, {3.669529384680343*^9, 
   3.669529386685458*^9}, {3.6695306845557566`*^9, 3.669530688418766*^9}, 
   3.6695338215879908`*^9, {3.6696043936661644`*^9, 3.669604394425166*^9}, {
   3.6697730792502522`*^9, 3.669773086852687*^9}, {3.669821997814456*^9, 
   3.66982200572567*^9}, 3.669822439592286*^9, {3.672717485337129*^9, 
   3.6727175397682424`*^9}, {3.6727176071010933`*^9, 3.672717636492775*^9}, {
   3.6727176686836157`*^9, 3.6727177213646293`*^9}, {3.6727177702034225`*^9, 
   3.6727178572564015`*^9}, {3.672717887283119*^9, 3.6727178937694902`*^9}, {
   3.6727179404391594`*^9, 3.6727179406311703`*^9}, {3.672719714402387*^9, 
   3.672719718733203*^9}, {3.6727198336652737`*^9, 3.672719918631877*^9}, 
   3.8745461255666103`*^9, {3.8751413121043615`*^9, 3.8751413393725834`*^9}, {
   3.8757579219918475`*^9, 3.8757579296393824`*^9}, {3.876444672112932*^9, 
   3.876444676274394*^9}, {3.8764447330637302`*^9, 3.8764447358020597`*^9}, {
   3.8764449405673943`*^9, 3.8764450435342684`*^9}, {3.8764450818708706`*^9, 
   3.8764450882886586`*^9}, {3.8764451262864656`*^9, 
   3.8764451363663144`*^9}, {3.876445230399045*^9, 3.876445242317768*^9}, {
   3.8764457029553137`*^9, 3.8764457166656876`*^9}, 3.8870158128732214`*^9, {
   3.895554774930004*^9, 3.8955547749360085`*^9}, {3.8955551724375687`*^9, 
   3.8955551724435654`*^9}, {3.898644319037445*^9, 3.8986443330452805`*^9}, {
   3.9677774521098366`*^9, 3.967777452113846*^9}, {3.975313334012761*^9, 
   3.97531337061668*^9}},ExpressionUUID->"0ca44d64-f283-412b-b161-\
9661e40c02ea"]
}, Closed]],

Cell[CellGroupData[{

Cell["CovariantHodgeDual", "Subsection",
 CellChangeTimes->{{3.52174375309375*^9, 3.5217437626875*^9}, {
  3.669439370764881*^9, 3.669439374298902*^9}, {3.669531774745632*^9, 
  3.669531801052672*^9}},ExpressionUUID->"b2354afd-9df5-4147-9021-\
cf009b24b203"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Implement", " ", "the", " ", "covariant", " ", "Hodge", " ", "Dual", " ", 
    "of", " ", "Tensor", " ", "\[Tau]", " ", "using", " ", "the", " ", 
    "Metric", " ", "m"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "When", " ", "#", " ", "of", " ", "Indices", " ", "of", " ", "\[Tau]", " ",
     "is", " ", "less", " ", "than", " ", "the", " ", "#", " ", "of", " ", 
    "dimensions"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "CovariantHodgeDual", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"CovariantHodgeDual", "[", 
      RowBox[{"\[Nu]I___", ",", 
       RowBox[{"(", 
        RowBox[{"\[Tau]_Tensor", "|", 
         RowBox[{"(", 
          RowBox[{"\[Tau]_", "/;", 
           RowBox[{"TestExpressionForm", "[", "\[Tau]", "]"}]}], ")"}]}], 
        ")"}], ",", "m_Tensor"}], "]"}], "/;", 
     RowBox[{
      RowBox[{"TestMetricTensor", "[", "m", "]"}], "&&", 
      RowBox[{"(", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "\[Tau]", "]"}], "===", "Tensor"}], ")"}], 
         ",", 
         RowBox[{
          RowBox[{"Coordinates", "[", "\[Tau]", "]"}], "===", 
          RowBox[{"Coordinates", "[", "m", "]"}]}], ",", "True", ",", 
         "True"}], "]"}], ")"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"TestIndices", "/@", 
            RowBox[{"{", "\[Nu]I", "}"}]}], "]"}], "===", 
          RowBox[{"{", "True", "}"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"TestIndices", "/@", 
            RowBox[{"{", "\[Nu]I", "}"}]}], "]"}], "===", 
          RowBox[{"{", "}"}]}], ")"}]}], ")"}], 
      RowBox[{"(*", 
       RowBox[{"Not", " ", "allow", " ", "OverHatIndices", " ", "for", " ", 
        RowBox[{"now", "."}]}], "*)"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"TestOverHatIndex", "/@", 
            RowBox[{"{", "\[Nu]I", "}"}]}], "]"}], "===", 
          RowBox[{"{", "False", "}"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"TestOverHatIndex", "/@", 
            RowBox[{"{", "\[Nu]I", "}"}]}], "]"}], "===", 
          RowBox[{"{", "}"}]}], ")"}]}], ")"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"{", "\[Nu]I", "}"}], "]"}], "===", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Coordinates", "[", "m", "]"}], "]"}], "-", 
         RowBox[{"Length", "[", 
          RowBox[{"RemoveUnderBarredIndices", "[", 
           RowBox[{"Indices", "[", "\[Tau]", "]"}], "]"}], "]"}]}]}], 
       ")"}]}]}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "d", ",", "n", ",", "\[CapitalSigma]", ",", "sF", ",", "\[Sigma]", ",",
         "ii"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"d", "=", 
        RowBox[{"CoordinatesDimension", "[", "m", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{"RankNumber", "[", "\[Tau]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[CapitalSigma]", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          SubscriptBox[
           RowBox[{"Unique", "[", "\[Sigma]", "]"}], "-"], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", 
            RowBox[{"(", 
             RowBox[{"d", "-", "n"}], ")"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sF", "=", 
        RowBox[{"NonMetricTensor", "[", 
         RowBox[{"\[CapitalSigma]", ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], 
            RowBox[{"n", " ", 
             RowBox[{"(", 
              RowBox[{"d", "-", "n"}], ")"}]}]], " ", 
           RowBox[{"Power", "[", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"Determinant", "[", "m", "]"}], "]"}], ",", 
             FractionBox["1", "2"]}], "]"}], " ", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"n", "=!=", "0"}], ",", 
             RowBox[{"HodgeDual", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"RaiseAllIndices", "[", 
                 RowBox[{"\[Tau]", ",", "m"}], "]"}], "//", 
                "TensorComponents"}], ")"}], "]"}], ",", 
             RowBox[{"n", "===", "0"}], ",", 
             RowBox[{"HodgeDual", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"\[Tau]", "//", "TensorComponents"}], ")"}], ",", 
               "d"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{"\"\<\[FivePointedStar]\>\"", ",", 
             RowBox[{"TensorName", "[", "\[Tau]", "]"}]}], "}"}], "]"}], ",", 
          RowBox[{"Coordinates", "\[Rule]", 
           RowBox[{"Coordinates", "[", "m", "]"}]}], ",", 
          RowBox[{"StartIndex", "\[Rule]", " ", 
           RowBox[{"StartIndex", "[", "m", "]"}]}], ",", 
          RowBox[{"TooltipStyle", "\[Rule]", " ", 
           RowBox[{"TooltipStyle", "[", "m", "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sF", "=", 
        RowBox[{"MoveIndices", "[", 
         RowBox[{"sF", ",", 
          RowBox[{"{", "\[Nu]I", "}"}], ",", "m"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"TestScalarTensor", "[", "sF", "]"}], ",", 
         RowBox[{"TensorComponents", "[", "sF", "]"}], ",", "True", ",", 
         "sF"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CovariantHodgeDual", "[", 
      RowBox[{"\[Nu]I___", ",", 
       RowBox[{"(", 
        RowBox[{"\[Tau]_Tensor", "|", 
         RowBox[{"(", 
          RowBox[{"\[Tau]_", "/;", 
           RowBox[{"TestExpressionForm", "[", "\[Tau]", "]"}]}], ")"}]}], 
        ")"}], ",", "m_Tensor", ",", "Tensor"}], "]"}], "/;", 
     RowBox[{
      RowBox[{"TestMetricTensor", "[", "m", "]"}], "&&", 
      RowBox[{"(", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "\[Tau]", "]"}], "===", "Tensor"}], ")"}], 
         ",", 
         RowBox[{
          RowBox[{"Coordinates", "[", "\[Tau]", "]"}], "===", 
          RowBox[{"Coordinates", "[", "m", "]"}]}], ",", "True", ",", 
         "True"}], "]"}], ")"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"TestIndices", "/@", 
            RowBox[{"{", "\[Nu]I", "}"}]}], "]"}], "===", 
          RowBox[{"{", "True", "}"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"TestIndices", "/@", 
            RowBox[{"{", "\[Nu]I", "}"}]}], "]"}], "===", 
          RowBox[{"{", "}"}]}], ")"}]}], ")"}], 
      RowBox[{"(*", 
       RowBox[{"Not", " ", "allow", " ", "OverHatIndices", " ", "for", " ", 
        RowBox[{"now", "."}]}], "*)"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"TestOverHatIndex", "/@", 
            RowBox[{"{", "\[Nu]I", "}"}]}], "]"}], "===", 
          RowBox[{"{", "False", "}"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"TestOverHatIndex", "/@", 
            RowBox[{"{", "\[Nu]I", "}"}]}], "]"}], "===", 
          RowBox[{"{", "}"}]}], ")"}]}], ")"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"{", "\[Nu]I", "}"}], "]"}], "===", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Coordinates", "[", "m", "]"}], "]"}], "-", 
         RowBox[{"Length", "[", 
          RowBox[{"RemoveUnderBarredIndices", "[", 
           RowBox[{"Indices", "[", "\[Tau]", "]"}], "]"}], "]"}]}]}], 
       ")"}]}]}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "d", ",", "n", ",", "\[CapitalSigma]", ",", "sF", ",", "\[Sigma]", ",",
         "ii"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"d", "=", 
        RowBox[{"CoordinatesDimension", "[", "m", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{"RankNumber", "[", "\[Tau]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[CapitalSigma]", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          SubscriptBox[
           RowBox[{"Unique", "[", "\[Sigma]", "]"}], "-"], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", 
            RowBox[{"(", 
             RowBox[{"d", "-", "n"}], ")"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sF", "=", 
        RowBox[{"NonMetricTensor", "[", 
         RowBox[{"\[CapitalSigma]", ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], 
            RowBox[{"n", " ", 
             RowBox[{"(", 
              RowBox[{"d", "-", "n"}], ")"}]}]], " ", 
           RowBox[{"Power", "[", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"Determinant", "[", "m", "]"}], "]"}], ",", 
             FractionBox["1", "2"]}], "]"}], " ", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"n", "=!=", "0"}], ",", 
             RowBox[{"HodgeDual", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"RaiseAllIndices", "[", 
                 RowBox[{"\[Tau]", ",", "m"}], "]"}], "//", 
                "TensorComponents"}], ")"}], "]"}], ",", 
             RowBox[{"n", "===", "0"}], ",", 
             RowBox[{"HodgeDual", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"\[Tau]", "//", "TensorComponents"}], ")"}], ",", 
               "d"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{"\"\<\[FivePointedStar]\>\"", ",", 
             RowBox[{"TensorName", "[", "\[Tau]", "]"}]}], "}"}], "]"}], ",", 
          RowBox[{"Coordinates", "\[Rule]", 
           RowBox[{"Coordinates", "[", "m", "]"}]}], ",", 
          RowBox[{"StartIndex", "\[Rule]", " ", 
           RowBox[{"StartIndex", "[", "m", "]"}]}], ",", 
          RowBox[{"TooltipStyle", "\[Rule]", " ", 
           RowBox[{"TooltipStyle", "[", "m", "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sF", "=", 
        RowBox[{"MoveIndices", "[", 
         RowBox[{"sF", ",", 
          RowBox[{"{", "\[Nu]I", "}"}], ",", "m"}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"CovariantHodgeDual", ":", " ", 
     RowBox[{"Automatically", " ", "generate", " ", "indices"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CovariantHodgeDual", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Tau]_Tensor", "|", 
         RowBox[{"(", 
          RowBox[{"\[Tau]_", "/;", 
           RowBox[{"TestExpressionForm", "[", "\[Tau]", "]"}]}], ")"}]}], 
        ")"}], ",", "m_Tensor"}], "]"}], "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"TestMetricTensor", "[", "m", "]"}], "&&", 
       RowBox[{"(", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Head", "[", "\[Tau]", "]"}], "===", "Tensor"}], ")"}], 
          ",", 
          RowBox[{
           RowBox[{"Coordinates", "[", "\[Tau]", "]"}], "===", 
           RowBox[{"Coordinates", "[", "m", "]"}]}], ",", "True", ",", 
          "True"}], "]"}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Coordinates", "[", "m", "]"}], "]"}], ">", 
         RowBox[{"Length", "[", 
          RowBox[{"RemoveUnderBarredIndices", "[", 
           RowBox[{"Indices", "[", "\[Tau]", "]"}], "]"}], "]"}]}], ")"}]}], 
      ")"}]}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Nu]", ",", "l\[Nu]I", ",", "\[Nu]Ilist", ",", "i"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"l\[Nu]I", "=", 
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"Coordinates", "[", "m", "]"}], "]"}], "-", 
          RowBox[{"Length", "[", 
           RowBox[{"RemoveUnderBarredIndices", "[", 
            RowBox[{"Indices", "[", "\[Tau]", "]"}], "]"}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"\[Nu]Ilist", "=", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Indices", "[", "\[Tau]", "]"}], "===", 
            RowBox[{"{", "}"}]}], ")"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            SubscriptBox[
             RowBox[{"Unique", "[", "\[Nu]", "]"}], "-"], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "l\[Nu]I"}], "}"}]}], "]"}], ",", 
          "True", ",", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Head", "[", 
               RowBox[{
                RowBox[{"Indices", "[", "\[Tau]", "]"}], 
                "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "]"}],
               "===", "SuperMinus"}], ")"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              SubscriptBox[
               RowBox[{"Unique", "[", "\[Nu]", "]"}], "-"], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "l\[Nu]I"}], "}"}]}], "]"}], ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"!", 
                RowBox[{"MatchQ", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{"RemoveUnderBarredIndices", "[", 
                    RowBox[{"Indices", "[", "\[Tau]", "]"}], "]"}]}], "]"}], 
                   ")"}], ",", 
                  RowBox[{
                   RowBox[{"{", "1", "}"}], "|", 
                   RowBox[{"{", 
                    RowBox[{"-", "1"}], "}"}]}]}], "]"}]}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Head", "[", 
                 RowBox[{
                  RowBox[{"Indices", "[", "\[Tau]", "]"}], 
                  "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 "]"}], "===", "SubMinus"}], ")"}]}], ")"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              SubscriptBox[
               RowBox[{"Unique", "[", "\[Nu]", "]"}], "-"], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "l\[Nu]I"}], "}"}]}], "]"}], ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"MatchQ", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"Union", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{"RemoveUnderBarredIndices", "[", 
                    RowBox[{"Indices", "[", "\[Tau]", "]"}], "]"}]}], "]"}], 
                  ")"}], ",", 
                 RowBox[{
                  RowBox[{"{", "1", "}"}], "|", 
                  RowBox[{"{", 
                   RowBox[{"-", "1"}], "}"}]}]}], "]"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Head", "[", 
                 RowBox[{
                  RowBox[{"Indices", "[", "\[Tau]", "]"}], 
                  "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 "]"}], "===", "SubMinus"}], ")"}]}], ")"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"Unique", "[", "\[Nu]", "]"}], "-"], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "l\[Nu]I"}], "}"}]}], "]"}]}], 
           "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"CovariantHodgeDual", "[", 
        RowBox[{
         RowBox[{"Sequence", "@@", "\[Nu]Ilist"}], ",", "\[Tau]", ",", "m"}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.52174396084375*^9, 3.521743989140625*^9}, {
   3.52174404553125*^9, 3.52174406490625*^9}, {3.52174411178125*^9, 
   3.521744178*^9}, {3.52175753421875*^9, 3.52175753465625*^9}, {
   3.521759735640625*^9, 3.521759758125*^9}, {3.5217868350625*^9, 
   3.521786885078125*^9}, {3.52178704734375*^9, 3.521787116328125*^9}, {
   3.521787178828125*^9, 3.5217871886875*^9}, {3.521787424390625*^9, 
   3.5217874283125*^9}, {3.521787532828125*^9, 3.52178754371875*^9}, 
   3.521910410859375*^9, {3.5219174194375*^9, 3.521917422546875*^9}, {
   3.521917491703125*^9, 3.5219174925*^9}, {3.521917608890625*^9, 
   3.521917617625*^9}, {3.521918314421875*^9, 3.521918316125*^9}, {
   3.521919269328125*^9, 3.5219193048125*^9}, {3.521919497375*^9, 
   3.52191951465625*^9}, {3.521921384*^9, 3.5219213845625*^9}, {
   3.521922223546875*^9, 3.5219222338125*^9}, {3.521955617484375*^9, 
   3.521955648359375*^9}, {3.521990471359375*^9, 3.52199061959375*^9}, {
   3.521990750328125*^9, 3.521990763484375*^9}, {3.532452011949185*^9, 
   3.532452013961588*^9}, {3.532452056362463*^9, 3.5324520586088667`*^9}, {
   3.5324523712334156`*^9, 3.5324523744782214`*^9}, {3.5324524076906796`*^9, 
   3.532452416130295*^9}, {3.6297526960186977`*^9, 3.629752705008212*^9}, {
   3.6299261040969267`*^9, 3.629926110841316*^9}, 3.6694393941659937`*^9, {
   3.669441203316702*^9, 3.669441278031819*^9}, {3.6694413314969053`*^9, 
   3.669441344335925*^9}, {3.6694413927307887`*^9, 3.6694414202318296`*^9}, {
   3.669514862752521*^9, 3.6695148645345235`*^9}, {3.6695149391946507`*^9, 
   3.669514991276733*^9}, {3.669515032105801*^9, 3.66951506111785*^9}, {
   3.6695152519181633`*^9, 3.669515260451182*^9}, {3.6695153013712487`*^9, 
   3.669515312627266*^9}, {3.6695154093496957`*^9, 3.6695154099216995`*^9}, {
   3.6695167123289385`*^9, 3.669516722073496*^9}, {3.6695173941773467`*^9, 
   3.669517413711464*^9}, {3.6695188004335203`*^9, 3.669518824793914*^9}, {
   3.6695194703083725`*^9, 3.6695194811419926`*^9}, {3.6695209914193163`*^9, 
   3.669521009949376*^9}, {3.669521115596419*^9, 3.6695212488830423`*^9}, {
   3.6695213351253843`*^9, 3.6695213791829042`*^9}, {3.669523166945903*^9, 
   3.6695232008429565`*^9}, {3.6695232691576443`*^9, 
   3.6695232946376853`*^9}, {3.669523348301781*^9, 3.6695234515499983`*^9}, {
   3.6695234848580523`*^9, 3.6695234857220545`*^9}, {3.6695235958404326`*^9, 
   3.669523596974471*^9}, {3.6695236354808025`*^9, 3.66952372849792*^9}, {
   3.66952376388914*^9, 3.6695237647051687`*^9}, {3.669523797091816*^9, 
   3.6695238756779413`*^9}, {3.6695239078229923`*^9, 3.6695239452280507`*^9}, 
   3.669524104919151*^9, {3.6695244117364087`*^9, 3.6695244138805313`*^9}, {
   3.66952454961929*^9, 3.669524582457168*^9}, {3.669524667216015*^9, 
   3.669524719319178*^9}, {3.669524760089368*^9, 3.6695248023595705`*^9}, {
   3.6695248594438553`*^9, 3.669524879383955*^9}, {3.6695251507197723`*^9, 
   3.6695252045538516`*^9}, {3.669525319076599*^9, 3.6695255239586067`*^9}, {
   3.669525569509823*^9, 3.6695255843268876`*^9}, {3.669526032181349*^9, 
   3.6695260335224257`*^9}, {3.669526535424133*^9, 3.669526592160378*^9}, {
   3.6695269712790256`*^9, 3.6695270006767073`*^9}, {3.669529384680343*^9, 
   3.669529386685458*^9}, {3.6695306845557566`*^9, 3.669530688418766*^9}, {
   3.6695318058226805`*^9, 3.669531823131707*^9}, {3.669533835456415*^9, 
   3.6695339005397296`*^9}, {3.669533936684993*^9, 3.66953396919545*^9}, {
   3.6695340091783204`*^9, 3.6695340285067544`*^9}, {3.669830741771064*^9, 
   3.6698307994651723`*^9}, {3.6698309344389105`*^9, 
   3.6698309378351173`*^9}, {3.6698314082453895`*^9, 3.669831435127659*^9}, {
   3.6698315347657585`*^9, 3.669831575556843*^9}, {3.669831730282789*^9, 
   3.6698317690588665`*^9}, {3.669831990722851*^9, 3.669831992423254*^9}, {
   3.6698321001373096`*^9, 3.6698322099587264`*^9}, {3.66983412902682*^9, 
   3.6698341325280285`*^9}, {3.669834177201524*^9, 3.669834198268363*^9}, {
   3.66983457587679*^9, 3.669834586532812*^9}, {3.669834632493704*^9, 
   3.6698346343355074`*^9}, {3.669834842715554*^9, 3.669834880242836*^9}, {
   3.669835317658337*^9, 3.669835373984644*^9}, {3.6698354575753965`*^9, 
   3.66983553262634*^9}, {3.669835615746691*^9, 3.669835678017203*^9}, {
   3.669835764929559*^9, 3.6698358033660307`*^9}, {3.6698359464610915`*^9, 
   3.6698359875119667`*^9}, {3.669836118429405*^9, 3.669836123454015*^9}, {
   3.669836320279518*^9, 3.6698363521483784`*^9}, {3.6698364154788256`*^9, 
   3.6698364507054896`*^9}, 3.6698365488940754`*^9, {3.669836759648582*^9, 
   3.6698367884898343`*^9}, 3.669836823466699*^9, {3.6698369448449173`*^9, 
   3.669837020454655*^9}, {3.669837130225453*^9, 3.669837132565457*^9}, {
   3.669837170736327*^9, 3.669837179971345*^9}, {3.6698372138856063`*^9, 
   3.669837242558258*^9}, {3.669838228307787*^9, 3.6698382743917255`*^9}, {
   3.669838321649411*^9, 3.669838363536687*^9}, {3.6698384048559656`*^9, 
   3.669838461111074*^9}, {3.669843664014793*^9, 3.66984368756914*^9}, {
   3.6698437242762394`*^9, 3.6698437454114485`*^9}, {3.669843781852533*^9, 
   3.669843785200724*^9}, {3.6698439971008444`*^9, 3.6698440027311664`*^9}, {
   3.6698447778700247`*^9, 3.669844789638446*^9}, {3.6698452379616766`*^9, 
   3.669845331539051*^9}, {3.669845374661928*^9, 3.6698453835139456`*^9}, {
   3.6698454362014413`*^9, 3.669845468101299*^9}, 3.669845516344386*^9, {
   3.669845639147397*^9, 3.6698456438294096`*^9}, 3.6698456760996675`*^9, {
   3.6698457134785357`*^9, 3.669845750385002*^9}, 3.66984578471527*^9, {
   3.6698459653337984`*^9, 3.6698459931238613`*^9}, {3.6698460608354034`*^9, 
   3.669846089172859*^9}, {3.672936639578724*^9, 3.6729366842932134`*^9}, {
   3.672936719562086*^9, 3.672936784995222*^9}, {3.82099666852608*^9, 
   3.8209967021311235`*^9}, {3.8209967381592503`*^9, 3.820996754287758*^9}, {
   3.820996980281063*^9, 3.8209970385749607`*^9}, {3.82099706905573*^9, 
   3.8209971059159937`*^9}, {3.8558267305457153`*^9, 
   3.8558267430936337`*^9}, {3.8564785758827395`*^9, 3.856478595744508*^9}, {
   3.8733429336039886`*^9, 3.8733429476352377`*^9}, {3.8733430304806547`*^9, 
   3.8733430420431623`*^9}, {3.8750898578455973`*^9, 
   3.8750898911335325`*^9}, {3.8750899996407146`*^9, 3.875090160030515*^9}, {
   3.8750902078360767`*^9, 3.87509032765077*^9}, {3.875090368047159*^9, 
   3.875090402689825*^9}, {3.8750909090960298`*^9, 3.875090916646381*^9}, {
   3.8750913086502256`*^9, 3.875091354912972*^9}, {3.8750916700618725`*^9, 
   3.8750916790143576`*^9}, {3.8750917157097626`*^9, 3.87509173604652*^9}, {
   3.8750918181189804`*^9, 3.8750918290228524`*^9}, {3.8750918672772937`*^9, 
   3.875091869855706*^9}, 3.875092035782336*^9, {3.8750976732153225`*^9, 
   3.875097674273671*^9}, {3.8750977843538675`*^9, 3.8750977942055855`*^9}, 
   3.8750978662078843`*^9, {3.875097963559353*^9, 3.875097976615369*^9}, {
   3.8750980556155033`*^9, 3.875098059121346*^9}, {3.8750980934945436`*^9, 
   3.875098095454336*^9}, {3.8750981693842716`*^9, 3.8750981771574855`*^9}, {
   3.8750986185725527`*^9, 3.8750986196468897`*^9}, {3.8750986554588394`*^9, 
   3.875098681418127*^9}, {3.875098790741496*^9, 3.8750988158741293`*^9}, 
   3.8750988555464277`*^9, {3.875098890027195*^9, 3.8750989316653605`*^9}, {
   3.8750989921378555`*^9, 3.8750990130899525`*^9}, {3.875099357331004*^9, 
   3.8750993582854176`*^9}, {3.875099590740688*^9, 3.875099611405962*^9}, 
   3.8751007033571963`*^9, 3.87510156681886*^9, 3.8752339386892943`*^9, {
   3.8752426749486947`*^9, 3.8752427092464924`*^9}, {3.875242755398812*^9, 
   3.8752427988096657`*^9}, {3.875242839673733*^9, 3.875242982199119*^9}, {
   3.875243905206646*^9, 3.8752439062222404`*^9}, {3.8752439749695187`*^9, 
   3.875244010885275*^9}, {3.8752440461125264`*^9, 3.87524404790934*^9}, 
   3.875244078184433*^9, {3.8752441119110527`*^9, 3.875244123788869*^9}, {
   3.8752441706751184`*^9, 3.8752442200602813`*^9}, {3.875244257334468*^9, 
   3.875244333388133*^9}, 3.875244587010468*^9, {3.8763633301280813`*^9, 
   3.876363360792363*^9}, {3.87636498410907*^9, 3.8763650355613704`*^9}, {
   3.876365137569307*^9, 3.87636516595022*^9}, {3.8763654477796392`*^9, 
   3.8763654732398715`*^9}, {3.8763655042678623`*^9, 3.876365514817235*^9}, {
   3.8763656982043405`*^9, 3.8763658330870194`*^9}, 3.876366154791814*^9, {
   3.876371325557494*^9, 3.876371353530436*^9}, {3.876541160097032*^9, 
   3.876541162840352*^9}, {3.8765412247734566`*^9, 3.8765412380133543`*^9}, {
   3.8765413631178026`*^9, 3.876541367678012*^9}, {3.876541401277587*^9, 
   3.876541432589427*^9}, {3.8765421866291413`*^9, 3.8765421946618524`*^9}, {
   3.876542309203165*^9, 3.8765423495723777`*^9}, {3.876542410014027*^9, 
   3.876542447821722*^9}, {3.876542489424137*^9, 3.8765424962055063`*^9}, {
   3.876542649247613*^9, 3.8765426556091404`*^9}, {3.876542693226633*^9, 
   3.8765427225787315`*^9}, 3.876542946943364*^9, {3.876972375548497*^9, 
   3.876972402459983*^9}, {3.876973744771781*^9, 3.876973749815794*^9}, 
   3.8769740250454345`*^9, 3.8769758614404745`*^9, {3.876976156465439*^9, 
   3.876976159695912*^9}, {3.876977578825599*^9, 3.876977644684276*^9}, {
   3.8769778761796427`*^9, 3.876977877153044*^9}, 3.876978019278208*^9, {
   3.8781707400509567`*^9, 3.878170754630989*^9}, {3.884775005912468*^9, 
   3.8847750324214735`*^9}, {3.8896624402277856`*^9, 
   3.8896624691057873`*^9}, {3.893289124590345*^9, 3.8932891246283226`*^9}, {
   3.8955547749750104`*^9, 3.8955547749930162`*^9}, {3.8955551724525614`*^9, 
   3.895555172474547*^9}, {3.895555339966194*^9, 3.895555340016163*^9}, {
   3.895555776195301*^9, 3.8955557872407255`*^9}, {3.8955558384934144`*^9, 
   3.895555838522397*^9}, 3.8977358917865224`*^9, 3.8983978026564016`*^9, {
   3.8983980162605467`*^9, 3.8983980407681103`*^9}, {3.8983980832369213`*^9, 
   3.8983980847889647`*^9}, {3.8988306197814336`*^9, 
   3.8988306265370913`*^9}, {3.8988306607013493`*^9, 3.8988306620098305`*^9}, 
   3.959211182742437*^9, {3.9592112141862297`*^9, 3.9592112196011753`*^9}, {
   3.959934949486985*^9, 3.9599349667803926`*^9}, 3.959934998333283*^9, {
   3.9605119065055113`*^9, 3.960511906554257*^9}, {3.967777452121607*^9, 
   3.9677774521336374`*^9}, 3.972502856152017*^9, {3.973765519760079*^9, 
   3.9737655459965897`*^9}, 3.9749544344335055`*^9, {3.975313380262755*^9, 
   3.975313424878525*^9}},ExpressionUUID->"77ee29de-9d0f-4973-bc71-\
a9732e80b77a"]
}, Closed]],

Cell[CellGroupData[{

Cell["FullyAntiSymmetricTensorQ", "Subsection",
 CellChangeTimes->{{3.52174375309375*^9, 3.5217437626875*^9}, {
   3.669439370764881*^9, 3.669439374298902*^9}, {3.669531774745632*^9, 
   3.669531801052672*^9}, 3.960454382154798*^9, 3.960511906561058*^9, 
   3.9737655198137903`*^9},ExpressionUUID->"c498283f-999c-4cb6-8be0-\
22e56dba746b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FullyAntiSymmetricTensorQ", "[", 
   RowBox[{"t_Tensor", "/;", 
    StyleBox[
     RowBox[{"(*", " ", 
      RowBox[{
      "mixed", " ", "indices", " ", "are", " ", "not", " ", "allowed", " ", 
       "in", " ", 
       RowBox[{"FullyAntiSymmetricTensorQ", "."}]}], "*)"}], "Code"], 
    RowBox[{"(*", 
     RowBox[{"All", " ", "of", " ", "them", " ", "should", " ", "be", " ", 
      StyleBox["upper",
       FontColor->RGBColor[1, 0, 1]], 
      StyleBox[" ",
       FontColor->RGBColor[1, 0, 1]], 
      StyleBox["indices",
       FontColor->RGBColor[1, 0, 1]], 
      StyleBox[" ",
       FontColor->RGBColor[1, 0, 1]], "or", " ", 
      StyleBox["lower",
       FontColor->RGBColor[1, 0, 1]], 
      StyleBox[" ",
       FontColor->RGBColor[1, 0, 1]], 
      RowBox[{
       StyleBox["indices",
        FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], 
    RowBox[{"MatchQ", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Union", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
         RowBox[{"RemoveUnderBarredIndices", "[", 
          RowBox[{"Indices", "[", "t", "]"}], "]"}]}], "]"}], ")"}], ",", 
      RowBox[{
       RowBox[{"{", "1", "}"}], "|", 
       RowBox[{"{", 
        RowBox[{"-", "1"}], "}"}]}]}], "]"}]}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{"(", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"check", " ", "t", 
       StyleBox[" ",
        FontColor->RGBColor[1, 0.5, 0.5]], "is", " ", "a", " ", 
       StyleBox["fully",
        FontColor->RGBColor[1, 0, 1]], 
       StyleBox[" ",
        FontColor->RGBColor[1, 0, 1]], 
       StyleBox["anti",
        FontColor->RGBColor[1, 0, 1]]}], 
      StyleBox["-",
       FontColor->RGBColor[1, 0, 1]], 
      StyleBox[
       RowBox[{"symm", " ", "tensor"}],
       FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"TensorSymmetry", "[", "t", "]"}], "\[LeftDoubleBracket]", 
        "1", "\[RightDoubleBracket]"}], "===", 
       RowBox[{"Antisymmetric", "[", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", 
          RowBox[{"RemoveUnderBarredIndices", "[", 
           RowBox[{"Indices", "[", "t", "]"}], "]"}], "]"}], "]"}], "]"}]}], 
      ")"}], "&&", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"RankNumber", "[", "t", "]"}], ">", "1"}], ")"}]}], ")"}], 
   ")"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.52174396084375*^9, 3.521743989140625*^9}, {
   3.52174404553125*^9, 3.52174406490625*^9}, {3.52174411178125*^9, 
   3.521744178*^9}, {3.52175753421875*^9, 3.52175753465625*^9}, {
   3.521759735640625*^9, 3.521759758125*^9}, {3.5217868350625*^9, 
   3.521786885078125*^9}, {3.52178704734375*^9, 3.521787116328125*^9}, {
   3.521787178828125*^9, 3.5217871886875*^9}, {3.521787424390625*^9, 
   3.5217874283125*^9}, {3.521787532828125*^9, 3.52178754371875*^9}, 
   3.521910410859375*^9, {3.5219174194375*^9, 3.521917422546875*^9}, {
   3.521917491703125*^9, 3.5219174925*^9}, {3.521917608890625*^9, 
   3.521917617625*^9}, {3.521918314421875*^9, 3.521918316125*^9}, {
   3.521919269328125*^9, 3.5219193048125*^9}, {3.521919497375*^9, 
   3.52191951465625*^9}, {3.521921384*^9, 3.5219213845625*^9}, {
   3.521922223546875*^9, 3.5219222338125*^9}, {3.521955617484375*^9, 
   3.521955648359375*^9}, {3.521990471359375*^9, 3.52199061959375*^9}, {
   3.521990750328125*^9, 3.521990763484375*^9}, {3.532452011949185*^9, 
   3.532452013961588*^9}, {3.532452056362463*^9, 3.5324520586088667`*^9}, {
   3.5324523712334156`*^9, 3.5324523744782214`*^9}, {3.5324524076906796`*^9, 
   3.532452416130295*^9}, {3.6297526960186977`*^9, 3.629752705008212*^9}, {
   3.6299261040969267`*^9, 3.629926110841316*^9}, 3.6694393941659937`*^9, {
   3.669441203316702*^9, 3.669441278031819*^9}, {3.6694413314969053`*^9, 
   3.669441344335925*^9}, {3.6694413927307887`*^9, 3.6694414202318296`*^9}, {
   3.669514862752521*^9, 3.6695148645345235`*^9}, {3.6695149391946507`*^9, 
   3.669514991276733*^9}, {3.669515032105801*^9, 3.66951506111785*^9}, {
   3.6695152519181633`*^9, 3.669515260451182*^9}, {3.6695153013712487`*^9, 
   3.669515312627266*^9}, {3.6695154093496957`*^9, 3.6695154099216995`*^9}, {
   3.6695167123289385`*^9, 3.669516722073496*^9}, {3.6695173941773467`*^9, 
   3.669517413711464*^9}, {3.6695188004335203`*^9, 3.669518824793914*^9}, {
   3.6695194703083725`*^9, 3.6695194811419926`*^9}, {3.6695209914193163`*^9, 
   3.669521009949376*^9}, {3.669521115596419*^9, 3.6695212488830423`*^9}, {
   3.6695213351253843`*^9, 3.6695213791829042`*^9}, {3.669523166945903*^9, 
   3.6695232008429565`*^9}, {3.6695232691576443`*^9, 
   3.6695232946376853`*^9}, {3.669523348301781*^9, 3.6695234515499983`*^9}, {
   3.6695234848580523`*^9, 3.6695234857220545`*^9}, {3.6695235958404326`*^9, 
   3.669523596974471*^9}, {3.6695236354808025`*^9, 3.66952372849792*^9}, {
   3.66952376388914*^9, 3.6695237647051687`*^9}, {3.669523797091816*^9, 
   3.6695238756779413`*^9}, {3.6695239078229923`*^9, 3.6695239452280507`*^9}, 
   3.669524104919151*^9, {3.6695244117364087`*^9, 3.6695244138805313`*^9}, {
   3.66952454961929*^9, 3.669524582457168*^9}, {3.669524667216015*^9, 
   3.669524719319178*^9}, {3.669524760089368*^9, 3.6695248023595705`*^9}, {
   3.6695248594438553`*^9, 3.669524879383955*^9}, {3.6695251507197723`*^9, 
   3.6695252045538516`*^9}, {3.669525319076599*^9, 3.6695255239586067`*^9}, {
   3.669525569509823*^9, 3.6695255843268876`*^9}, {3.669526032181349*^9, 
   3.6695260335224257`*^9}, {3.669526535424133*^9, 3.669526592160378*^9}, {
   3.6695269712790256`*^9, 3.6695270006767073`*^9}, {3.669529384680343*^9, 
   3.669529386685458*^9}, {3.6695306845557566`*^9, 3.669530688418766*^9}, {
   3.6695318058226805`*^9, 3.669531823131707*^9}, {3.669533835456415*^9, 
   3.6695339005397296`*^9}, {3.669533936684993*^9, 3.66953396919545*^9}, {
   3.6695340091783204`*^9, 3.6695340285067544`*^9}, {3.669830741771064*^9, 
   3.6698307994651723`*^9}, {3.6698309344389105`*^9, 
   3.6698309378351173`*^9}, {3.6698314082453895`*^9, 3.669831435127659*^9}, {
   3.6698315347657585`*^9, 3.669831575556843*^9}, {3.669831730282789*^9, 
   3.6698317690588665`*^9}, {3.669831990722851*^9, 3.669831992423254*^9}, {
   3.6698321001373096`*^9, 3.6698322099587264`*^9}, {3.66983412902682*^9, 
   3.6698341325280285`*^9}, {3.669834177201524*^9, 3.669834198268363*^9}, {
   3.66983457587679*^9, 3.669834586532812*^9}, {3.669834632493704*^9, 
   3.6698346343355074`*^9}, {3.669834842715554*^9, 3.669834880242836*^9}, {
   3.669835317658337*^9, 3.669835373984644*^9}, {3.6698354575753965`*^9, 
   3.66983553262634*^9}, {3.669835615746691*^9, 3.669835678017203*^9}, {
   3.669835764929559*^9, 3.6698358033660307`*^9}, {3.6698359464610915`*^9, 
   3.6698359875119667`*^9}, {3.669836118429405*^9, 3.669836123454015*^9}, {
   3.669836320279518*^9, 3.6698363521483784`*^9}, {3.6698364154788256`*^9, 
   3.6698364507054896`*^9}, 3.6698365488940754`*^9, {3.669836759648582*^9, 
   3.6698367884898343`*^9}, 3.669836823466699*^9, {3.6698369448449173`*^9, 
   3.669837020454655*^9}, {3.669837130225453*^9, 3.669837132565457*^9}, {
   3.669837170736327*^9, 3.669837179971345*^9}, {3.6698372138856063`*^9, 
   3.669837242558258*^9}, {3.669838228307787*^9, 3.6698382743917255`*^9}, {
   3.669838321649411*^9, 3.669838363536687*^9}, {3.6698384048559656`*^9, 
   3.669838461111074*^9}, {3.669843664014793*^9, 3.66984368756914*^9}, {
   3.6698437242762394`*^9, 3.6698437454114485`*^9}, {3.669843781852533*^9, 
   3.669843785200724*^9}, {3.6698439971008444`*^9, 3.6698440027311664`*^9}, {
   3.6698447778700247`*^9, 3.669844789638446*^9}, {3.6698452379616766`*^9, 
   3.669845331539051*^9}, {3.669845374661928*^9, 3.6698453835139456`*^9}, {
   3.6698454362014413`*^9, 3.669845468101299*^9}, 3.669845516344386*^9, {
   3.669845639147397*^9, 3.6698456438294096`*^9}, 3.6698456760996675`*^9, {
   3.6698457134785357`*^9, 3.669845750385002*^9}, 3.66984578471527*^9, {
   3.6698459653337984`*^9, 3.6698459931238613`*^9}, {3.6698460608354034`*^9, 
   3.669846089172859*^9}, {3.672936639578724*^9, 3.6729366842932134`*^9}, {
   3.672936719562086*^9, 3.672936784995222*^9}, {3.82099666852608*^9, 
   3.8209967021311235`*^9}, {3.8209967381592503`*^9, 3.820996754287758*^9}, {
   3.820996980281063*^9, 3.8209970385749607`*^9}, {3.82099706905573*^9, 
   3.8209971059159937`*^9}, {3.8558267305457153`*^9, 
   3.8558267430936337`*^9}, {3.8564785758827395`*^9, 3.856478595744508*^9}, {
   3.8733429336039886`*^9, 3.8733429476352377`*^9}, {3.8733430304806547`*^9, 
   3.8733430420431623`*^9}, {3.8750898578455973`*^9, 
   3.8750898911335325`*^9}, {3.8750899996407146`*^9, 3.875090160030515*^9}, {
   3.8750902078360767`*^9, 3.87509032765077*^9}, {3.875090368047159*^9, 
   3.875090402689825*^9}, {3.8750909090960298`*^9, 3.875090916646381*^9}, {
   3.8750913086502256`*^9, 3.875091354912972*^9}, {3.8750916700618725`*^9, 
   3.8750916790143576`*^9}, {3.8750917157097626`*^9, 3.87509173604652*^9}, {
   3.8750918181189804`*^9, 3.8750918290228524`*^9}, {3.8750918672772937`*^9, 
   3.875091869855706*^9}, 3.875092035782336*^9, {3.8750976732153225`*^9, 
   3.875097674273671*^9}, {3.8750977843538675`*^9, 3.8750977942055855`*^9}, 
   3.8750978662078843`*^9, {3.875097963559353*^9, 3.875097976615369*^9}, {
   3.8750980556155033`*^9, 3.875098059121346*^9}, {3.8750980934945436`*^9, 
   3.875098095454336*^9}, {3.8750981693842716`*^9, 3.8750981771574855`*^9}, {
   3.8750986185725527`*^9, 3.8750986196468897`*^9}, {3.8750986554588394`*^9, 
   3.875098681418127*^9}, {3.875098790741496*^9, 3.8750988158741293`*^9}, 
   3.8750988555464277`*^9, {3.875098890027195*^9, 3.8750989316653605`*^9}, {
   3.8750989921378555`*^9, 3.8750990130899525`*^9}, {3.875099357331004*^9, 
   3.8750993582854176`*^9}, {3.875099590740688*^9, 3.875099611405962*^9}, 
   3.8751007033571963`*^9, 3.87510156681886*^9, 3.8752339386892943`*^9, {
   3.8752426749486947`*^9, 3.8752427092464924`*^9}, {3.875242755398812*^9, 
   3.8752427988096657`*^9}, {3.875242839673733*^9, 3.875242982199119*^9}, {
   3.875243905206646*^9, 3.8752439062222404`*^9}, {3.8752439749695187`*^9, 
   3.875244010885275*^9}, {3.8752440461125264`*^9, 3.87524404790934*^9}, 
   3.875244078184433*^9, {3.8752441119110527`*^9, 3.875244123788869*^9}, {
   3.8752441706751184`*^9, 3.8752442200602813`*^9}, {3.875244257334468*^9, 
   3.875244333388133*^9}, 3.875244587010468*^9, {3.8763633301280813`*^9, 
   3.876363360792363*^9}, {3.87636498410907*^9, 3.8763650355613704`*^9}, {
   3.876365137569307*^9, 3.87636516595022*^9}, {3.8763654477796392`*^9, 
   3.8763654732398715`*^9}, {3.8763655042678623`*^9, 3.876365514817235*^9}, {
   3.8763656982043405`*^9, 3.8763658330870194`*^9}, 3.876366154791814*^9, {
   3.876371325557494*^9, 3.876371353530436*^9}, {3.876541160097032*^9, 
   3.876541162840352*^9}, {3.8765412247734566`*^9, 3.8765412380133543`*^9}, {
   3.8765413631178026`*^9, 3.876541367678012*^9}, {3.876541401277587*^9, 
   3.876541432589427*^9}, {3.8765421866291413`*^9, 3.8765421946618524`*^9}, {
   3.876542309203165*^9, 3.8765423495723777`*^9}, {3.876542410014027*^9, 
   3.876542447821722*^9}, {3.876542489424137*^9, 3.8765424962055063`*^9}, {
   3.876542649247613*^9, 3.8765426556091404`*^9}, {3.876542693226633*^9, 
   3.8765427225787315`*^9}, 3.876542946943364*^9, {3.876972375548497*^9, 
   3.876972402459983*^9}, {3.876973744771781*^9, 3.876973749815794*^9}, 
   3.8769740250454345`*^9, 3.8769758614404745`*^9, {3.876976156465439*^9, 
   3.876976159695912*^9}, {3.876977578825599*^9, 3.876977644684276*^9}, {
   3.8769778761796427`*^9, 3.876977877153044*^9}, 3.876978019278208*^9, {
   3.8781707400509567`*^9, 3.878170754630989*^9}, {3.884775005912468*^9, 
   3.8847750324214735`*^9}, {3.8896624402277856`*^9, 
   3.8896624691057873`*^9}, {3.893289124590345*^9, 3.8932891246283226`*^9}, {
   3.8955547749750104`*^9, 3.8955547749930162`*^9}, {3.8955551724525614`*^9, 
   3.895555172474547*^9}, {3.895555339966194*^9, 3.895555340016163*^9}, {
   3.895555776195301*^9, 3.8955557872407255`*^9}, {3.8955558384934144`*^9, 
   3.895555838522397*^9}, 3.8977358917865224`*^9, 3.8983978026564016`*^9, {
   3.8983980162605467`*^9, 3.8983980407681103`*^9}, {3.8983980832369213`*^9, 
   3.8983980847889647`*^9}, {3.8988306197814336`*^9, 
   3.8988306265370913`*^9}, {3.8988306607013493`*^9, 3.8988306620098305`*^9}, 
   3.959211182742437*^9, {3.9592112141862297`*^9, 3.9592112196011753`*^9}, {
   3.959934949486985*^9, 3.9599349667803926`*^9}, 3.959934998333283*^9, {
   3.960454398165515*^9, 3.960454399239558*^9}, {3.960511906563986*^9, 
   3.960511906565117*^9}, {3.960954728183886*^9, 3.960954849136086*^9}, {
   3.973765519817669*^9, 3.973765519821465*^9}, {3.975313435010076*^9, 
   3.975313469045274*^9}},ExpressionUUID->"1167dfc8-e366-42d0-a062-\
056d2a5d8da3"]
}, Closed]],

Cell[CellGroupData[{

Cell["LieD", "Subsection",
 CellChangeTimes->{{3.52174375309375*^9, 3.5217437626875*^9}, {
   3.669439370764881*^9, 3.669439374298902*^9}, {3.7181131427585125`*^9, 
   3.7181131460241966`*^9}, {3.718873428731206*^9, 3.7188734353831544`*^9}, {
   3.7277791595451746`*^9, 3.7277791625376096`*^9}, {3.727779261292117*^9, 
   3.7277792645777283`*^9}, {3.891519169148469*^9, 3.8915191708686686`*^9}, 
   3.973765345179551*^9},ExpressionUUID->"516e681d-1beb-42c7-806f-\
b844a71db486"],

Cell[TextData[{
 "LieD takes the Lie Derivative of a tensor along a vector field \[Xi].\n\
Right now, it only takes the Lie Derivative of a metric: ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Subscript", "[", 
       RowBox[{"\[Sterling]", ",", " ", "\[Xi]"}], "]"}], " ", "g"}], ")"}], 
    "\[Mu]\[Nu]"], TraditionalForm]],ExpressionUUID->
  "91c6fbcd-3c4e-46fd-833c-7ebfdca2d780"]
}], "Text",
 CellChangeTimes->{{3.7181132097147055`*^9, 3.718113264109483*^9}, {
   3.7181143852731085`*^9, 3.7181143974866204`*^9}, {3.7181151783546247`*^9, 
   3.7181152155867205`*^9}, {3.7181669623574867`*^9, 
   3.7181669718634157`*^9}, {3.718168163546671*^9, 3.718168165734876*^9}, {
   3.7181702710162296`*^9, 3.7181703112290707`*^9}, {3.718175343109828*^9, 
   3.7181753757743816`*^9}, {3.727779196807187*^9, 3.7277792331568756`*^9}, {
   3.727779273802723*^9, 3.727779325513347*^9}, {3.727787561066987*^9, 
   3.7277875629627943`*^9}, {3.7277878087273006`*^9, 3.727787832905507*^9}, {
   3.727787941322445*^9, 3.7277879597307673`*^9}, 
   3.9737653452431192`*^9},ExpressionUUID->"393f2f94-1803-4e23-b0dd-\
9cd1deb87029"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"LieD", "[", 
      RowBox[{"\[Xi]_Tensor", ",", "m_Tensor", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Quiet", "[", 
        RowBox[{"TestMetricTensor", "[", "m", "]"}], "]"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Dimensions", "[", 
          RowBox[{"TensorComponents", "[", "\[Xi]", "]"}], "]"}], "===", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Coordinates", "[", "\[Xi]", "]"}], "]"}], "}"}], "===", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Coordinates", "[", "m", "]"}], "]"}], "}"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"StartIndex", "[", "\[Xi]", "]"}], "===", 
         RowBox[{"StartIndex", "[", "m", "]"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{"(*", " ", 
         RowBox[{
         "either", " ", "both", " ", "upper", " ", "or", " ", "lower", " ", 
          "indices"}], " ", "*)"}], 
        RowBox[{
         RowBox[{"Times", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
            RowBox[{"Indices", "[", "m", "]"}]}], ")"}]}], "===", "1"}], 
        ")"}], "&&", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{"TestOneVector", "[", "\[Xi]", "]"}], ")"}]}], ")"}]}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "Vec", ",", "\[Alpha]", ",", "\[Mu]", ",", "\[Nu]", ",", "pd\[Xi]", 
        ",", "pdg", ",", "g\[Mu]\[Nu]", ",", "g\[Mu]\[Nu]T", ",", "L1", ",", 
        "L2", ",", "temp", ",", "idxl"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "make", " ", "sure", " ", "we", " ", "have", " ", "a", " ", "vector"}],
        " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Vec", "=", 
        RowBox[{"RaiseAllIndices", "[", 
         RowBox[{"\[Xi]", ",", "m"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "make", " ", "sure", " ", "we", " ", "lowered", " ", "the", " ", 
         "indices", " ", "on", " ", "g"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"g\[Mu]\[Nu]", "=", 
        RowBox[{"Metric", "[", 
         RowBox[{
          SubscriptBox["\[Mu]", "-"], ",", 
          SubscriptBox["\[Nu]", "-"], ",", "m"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"g\[Mu]\[Nu]T", "=", 
        RowBox[{"TensorComponents", "[", "g\[Mu]\[Nu]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Construct", " ", "Partial", " ", "Derivative", " ", "of", " ", 
         "\[Xi]"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"pd\[Xi]", "=", 
        RowBox[{"TensorComponents", "[", 
         RowBox[{"PartialD", "[", 
          RowBox[{
           SubscriptBox["\[Mu]", "-"], ",", "Vec", ",", "m"}], "]"}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Construct", " ", "Partial", " ", "Derivative", " ", "of", " ", 
         SubscriptBox["g", "\[Mu]\[Nu]"]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"pdg", "=", 
        RowBox[{"TensorComponents", "[", 
         RowBox[{"PartialD", "[", 
          RowBox[{
           SubscriptBox["\[Alpha]", "-"], ",", "g\[Mu]\[Nu]", ",", "m"}], 
          "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         SuperscriptBox["\[Xi]", "\[Sigma]"], 
         RowBox[{
          SubscriptBox["\[PartialD]", "\[Sigma]"], 
          SubscriptBox["g", "\[Mu]\[Nu]"]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"L1", "=", 
        RowBox[{"TensorContract", "[", 
         RowBox[{
          RowBox[{"TensorProduct", "[", 
           RowBox[{
            RowBox[{"TensorComponents", "[", "Vec", "]"}], ",", "pdg"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", 
           RowBox[{"{", "\[Mu]"}]], 
          SuperscriptBox["\[Xi]", "\[Sigma]"]}], 
         SubscriptBox["g", 
          RowBox[{
           RowBox[{"\[Nu]", "}"}], "\[Sigma]"}]]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"L2", "=", 
        RowBox[{"TensorContract", "[", 
         RowBox[{
          RowBox[{"TensorProduct", "[", 
           RowBox[{"pd\[Xi]", ",", "g\[Mu]\[Nu]T"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"2", ",", "4"}], "}"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"...", " ", "remember", " ", "to", " ", "symmetrize"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"L2", "=", 
        RowBox[{
         RowBox[{"Transpose", "[", "L2", "]"}], "+", "L2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"temp", "=", 
        RowBox[{"m", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", "tn_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", 
              RowBox[{"Row", "[", 
               RowBox[{"{", 
                RowBox[{"\"\<\[Sterling]\>\"", ",", 
                 RowBox[{"Column", "[", 
                  RowBox[{"{", 
                   RowBox[{"Null", ",", 
                    RowBox[{"TensorName", "[", "\[Xi]", "]"}]}], "}"}], "]"}],
                  ",", 
                 RowBox[{"TensorName", "[", "m", "]"}]}], "}"}], "]"}]}], 
             ")"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorType", "\[Rule]", "tn_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorType", "\[Rule]", "\"\<LieD\>\""}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"L1", "+", "L2"}], ")"}], "//", 
                RowBox[{"OptionValue", "[", "LieDerivativeOperator", "]"}]}], 
               ")"}]}], ")"}]}]}], "\[IndentingNewLine]", "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}], "=!=", 
           "Null"}], ")"}], ",", 
         RowBox[{"temp", "=", 
          RowBox[{"TooltipDisplay", "[", 
           RowBox[{"temp", ",", 
            RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], "]"}]}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
           RowBox[{"{", "}"}]}], ")"}], ",", 
         RowBox[{"temp", "=", 
          RowBox[{"TooltipStyle", "[", 
           RowBox[{"temp", ",", 
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], "]"}]}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "Indices", "]"}], "=!=", "Null"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
               RowBox[{"OptionValue", "[", "Indices", "]"}]}], ")"}], "===", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
               RowBox[{"Indices", "[", "m", "]"}]}], ")"}]}], ")"}]}], ")"}], 
         ",", 
         RowBox[{"temp", "=", 
          RowBox[{"MoveIndices", "[", 
           RowBox[{"temp", ",", 
            RowBox[{"OptionValue", "[", "Indices", "]"}], ",", "m"}], "]"}]}],
          ",", "True", ",", 
         RowBox[{"temp", "=", 
          RowBox[{"MoveIndices", "[", 
           RowBox[{"temp", ",", 
            RowBox[{"Indices", "[", "m", "]"}], ",", "m"}], "]"}]}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   StyleBox[
    RowBox[{"LieD", " ", "on", " ", "General", " ", "Tensor"}],
    FontColor->RGBColor[0.5, 0, 0.5]], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"LieD", "[", 
      RowBox[{"\[Xi]1_Tensor", ",", "t_Tensor", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"Quiet", "[", 
         RowBox[{"TestMetricTensor", "[", "t", "]"}], "]"}]}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Dimensions", "[", 
          RowBox[{"TensorComponents", "[", "\[Xi]1", "]"}], "]"}], "===", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Coordinates", "[", "\[Xi]1", "]"}], "]"}], "}"}], "===", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Coordinates", "[", "t", "]"}], "]"}], "}"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"StartIndex", "[", "\[Xi]1", "]"}], "===", 
         RowBox[{"StartIndex", "[", "t", "]"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"TensorTypeNoPart", "[", "t", "]"}], ",", 
           RowBox[{"(*", 
            RowBox[{
            "We", " ", "have", " ", "already", " ", "cover", " ", "the", " ", 
             "Metric", " ", "one", " ", "and", " ", "Christoffel", " ", "is", 
             " ", "not", " ", "a", " ", 
             RowBox[{"Tensor", ".", " ", "Check"}], " ", "if", " ", "t", " ", 
             "is", " ", 
             StyleBox["not",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox["\"\<Metric\>\"",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox["or",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 1]], 
             RowBox[{
              StyleBox["\"\<ChristoffelSymbols\>\"",
               FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], 
           RowBox[{"(", 
            RowBox[{"\"\<Metric\>\"", "|", "\"\<ChristoffelSymbols\>\""}], 
            ")"}]}], "]"}], "===", 
         RowBox[{"{", "}"}]}], ")"}], "&&", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Since", " ", "user", " ", 
          RowBox[{"didn", "'"}], "t", " ", "input", " ", "the", " ", 
          "metric"}], ",", " ", 
         RowBox[{
         "we", " ", "only", " ", "allow", " ", "them", " ", "to", " ", "be", 
          " ", "vector", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"w", "/", " ", 
              StyleBox["upper",
               FontColor->RGBColor[1, 0, 1]]}], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox["index",
              FontColor->RGBColor[1, 0, 1]]}], ")"}], "."}]}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{"TestOneVector", "[", "\[Xi]1", "]"}], ")"}]}], ")"}]}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Xi]", ",", "name", ",", "cs", ",", "si", ",", "indices", ",", 
        "rank", ",", "pdT", ",", "\[Sigma]", ",", "pd\[Xi]\[Sigma]down", ",", 
        "pd\[Xi]\[Sigma]up", ",", "Tpd\[Xi]\[Sigma]down", ",", 
        "Tpd\[Xi]\[Sigma]up", ",", "LieDT", ",", "tempT", ",", "i", ",", 
        "\[Gamma]", ",", "output"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Extract", " ", "the", " ", 
        StyleBox["TensorName",
         FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"name", "=", 
        RowBox[{"TensorName", "[", "\[Xi]1", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Extract", " ", "the", " ", 
         StyleBox["Coordinates",
          FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"cs", "=", 
        RowBox[{"Coordinates", "[", "\[Xi]1", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Extract", " ", "the", " ", 
         StyleBox["StartIndex",
          FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"si", "=", 
        RowBox[{"StartIndex", "[", "\[Xi]1", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Declare", " ", "a", " ", "function", " ", "we", " ", "can", " ", 
         "change", " ", "the", " ", "name", " ", "of", " ", "Killing", " ", 
         RowBox[{"vector", "'"}], "s", " ", 
         RowBox[{"index", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Xi]", "[", "\[Gamma]_", "]"}], ":=", 
        RowBox[{"NonMetricTensor", "[", 
         RowBox[{
          RowBox[{"{", "\[Gamma]", "}"}], ",", 
          RowBox[{"TensorComponents", "[", "\[Xi]1", "]"}], ",", "name", ",", 
          RowBox[{"Coordinates", "\[Rule]", "cs"}], ",", 
          RowBox[{"StartIndex", "\[Rule]", "si"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Extract", " ", "the", " ", 
         StyleBox["Indices",
          FontColor->RGBColor[1, 0, 1]], 
         StyleBox[" ",
          FontColor->RGBColor[1, 0, 1]], 
         StyleBox["list",
          FontColor->RGBColor[1, 0, 1]], 
         StyleBox[" ",
          FontColor->RGBColor[1, 0, 1]], 
         StyleBox["of",
          FontColor->RGBColor[1, 0, 1]], 
         StyleBox[" ",
          FontColor->RGBColor[1, 0, 1]], 
         StyleBox["t",
          FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"indices", "=", 
        RowBox[{"Indices", "[", "t", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        StyleBox["RankNumber",
         FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"rank", "=", 
        RowBox[{"RankNumber", "[", "t", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        StyleBox[
         FormBox[
          RowBox[{
           SubscriptBox["\[PartialD]", "\[Sigma]"], 
           SubscriptBox[
            SuperscriptBox["T", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Mu]", "1"], "..."}], 
              SubscriptBox["\[Mu]", "N"]}]], 
            RowBox[{
             RowBox[{
              SubscriptBox["\[Nu]", "1"], "..."}], 
             SubscriptBox["\[Nu]", "M"]}]]}],
          TraditionalForm],
         FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"pdT", "=", 
        RowBox[{"PartialD", "[", 
         RowBox[{
          SubscriptBox["\[Sigma]", "-"], ",", "t"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        StyleBox[
         RowBox[{
          SubscriptBox["\[PartialD]", "\[Sigma]"], 
          SuperscriptBox["\[Xi]", "\[Gamma]"]}],
         FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"pd\[Xi]\[Sigma]down", "=", 
        RowBox[{"PartialD", "[", 
         RowBox[{
          SubscriptBox["\[Sigma]", "-"], ",", 
          RowBox[{"\[Xi]", "[", 
           SuperscriptBox["\[Gamma]", "-"], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        StyleBox[
         RowBox[{
          SubscriptBox["\[PartialD]", "\[Gamma]"], 
          SuperscriptBox["\[Xi]", "\[Sigma]"]}],
         FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"pd\[Xi]\[Sigma]up", "=", 
        RowBox[{"PartialD", "[", 
         RowBox[{
          SubscriptBox["\[Gamma]", "-"], ",", 
          RowBox[{"\[Xi]", "[", 
           SuperscriptBox["\[Sigma]", "-"], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        StyleBox[
         RowBox[{
          SubscriptBox[
           SuperscriptBox["T", 
            RowBox[{
             RowBox[{
              SubscriptBox["\[Mu]", "1"], "..."}], 
             SubscriptBox["\[Mu]", "N"]}]], 
           RowBox[{
            RowBox[{
             SubscriptBox["\[Nu]", "1"], "..."}], 
            SubscriptBox["\[Nu]", "M"]}]], 
          RowBox[{
           SubscriptBox["\[PartialD]", "\[Sigma]"], 
           SuperscriptBox["\[Xi]", "\[Gamma]"]}]}],
         FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Tpd\[Xi]\[Sigma]down", "=", 
        RowBox[{"TensorsProduct", "[", 
         RowBox[{"{", 
          RowBox[{"t", ",", "pd\[Xi]\[Sigma]down"}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        StyleBox[
         RowBox[{
          SubscriptBox[
           SuperscriptBox["T", 
            RowBox[{
             RowBox[{
              SubscriptBox["\[Mu]", "1"], "..."}], 
             SubscriptBox["\[Mu]", "N"]}]], 
           RowBox[{
            RowBox[{
             SubscriptBox["\[Nu]", "1"], "..."}], 
            SubscriptBox["\[Nu]", "M"]}]], 
          RowBox[{
           SubscriptBox["\[PartialD]", "\[Gamma]"], 
           SuperscriptBox["\[Xi]", "\[Sigma]"]}]}],
         FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Tpd\[Xi]\[Sigma]up", "=", 
        RowBox[{"TensorsProduct", "[", 
         RowBox[{"{", 
          RowBox[{"t", ",", "pd\[Xi]\[Sigma]up"}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Sum", " ", "the", " ", 
         StyleBox[
          SuperscriptBox["\[Xi]", "\[Sigma]"],
          FontColor->RGBColor[1, 0, 1]], 
         StyleBox[
          RowBox[{
           SubscriptBox["\[PartialD]", "\[Sigma]"], 
           SubscriptBox[
            SuperscriptBox["T", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Mu]", "1"], "..."}], 
              SubscriptBox["\[Mu]", "N"]}]], 
            RowBox[{
             RowBox[{
              SubscriptBox["\[Nu]", "1"], "..."}], 
             SubscriptBox["\[Nu]", "M"]}]]}],
          FontColor->RGBColor[1, 0, 1]], " ", 
         RowBox[{"first", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"LieDT", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TensorsProduct", "[", 
           RowBox[{
            RowBox[{"\[Xi]", "[", 
             SuperscriptBox["\[Sigma]", "-"], "]"}], " ", "pdT"}], "]"}], "//",
           "TensorComponents"}], ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Sum", " ", "the", " ", "rest", " ", "of", " ", 
         RowBox[{"terms", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"Which", "[", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"If", " ", "i"}], "-", 
            RowBox[{
            "th", " ", "index", " ", "of", " ", "\"\<T's\>\"", " ", "indices",
              " ", "list", " ", "is", " ", "an", " ", 
             StyleBox["upper",
              FontColor->RGBColor[1, 0, 1]], " ", 
             RowBox[{"index", "."}]}]}], "*)"}], 
          RowBox[{
           RowBox[{
            RowBox[{"Sgn", "[", 
             RowBox[{
             "indices", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "]"}], "===", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"replace", " ", "the", " ", "i"}], "-", 
             RowBox[{"th", " ", "index", " ", 
              RowBox[{"w", "/", " ", "\[Sigma]"}], " ", "and", " ", "replace",
               " ", "\[Gamma]", " ", 
              RowBox[{"w", "/", "the"}], " ", "i"}], "-", 
             RowBox[{"th", " ", "index"}]}], "*)"}], 
           RowBox[{
            RowBox[{"tempT", "=", 
             RowBox[{"Tpd\[Xi]\[Sigma]down", "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"indices", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], 
                 "\[Rule]", "\[Sigma]"}], ",", 
                RowBox[{"\[Gamma]", "\[Rule]", 
                 RowBox[{"indices", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
               "}"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{
              "Since", " ", "we", " ", "will", " ", "operate", " ", 
               "TensorComponents", " ", "at", " ", "the", " ", "end"}], ",", 
              " ", 
              RowBox[{
              "we", " ", "should", " ", "make", " ", "sure", " ", "the", " ", 
               "indices", " ", "order", " ", "are", " ", "consistent", " ", 
               "for", " ", "every", " ", 
               RowBox[{"term", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"tempT", "=", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"SwapIndices", "[", 
                RowBox[{"tempT", ",", "indices"}], "]"}], "//", 
               "TensorComponents"}], ")"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"For", " ", "upper", " ", "index"}], ",", " ", 
              RowBox[{"we", " ", "should", " ", 
               StyleBox["subtract",
                FontColor->RGBColor[1, 0, 1]], " ", 
               RowBox[{"it", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"LieDT", "=", 
             RowBox[{"LieDT", "-", "tempT"}]}]}], ",", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"If", " ", "i"}], "-", 
             RowBox[{
             "th", " ", "index", " ", "of", " ", "\"\<T's\>\"", " ", 
              "indices", " ", "list", " ", "is", " ", "an", " ", 
              StyleBox["lower",
               FontColor->RGBColor[1, 0, 1]], " ", 
              RowBox[{"index", "."}]}]}], "*)"}], 
           RowBox[{
            RowBox[{"Sgn", "[", 
             RowBox[{
             "indices", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "]"}], "===", 
            RowBox[{"-", "1"}]}], ",", 
           RowBox[{
            RowBox[{"tempT", "=", 
             RowBox[{"Tpd\[Xi]\[Sigma]up", "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"indices", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], 
                 "\[Rule]", "\[Sigma]"}], ",", 
                RowBox[{"\[Gamma]", "\[Rule]", 
                 RowBox[{"indices", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
               "}"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"tempT", "=", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"SwapIndices", "[", 
                RowBox[{"tempT", ",", "indices"}], "]"}], "//", 
               "TensorComponents"}], ")"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"For", " ", "upper", " ", "index"}], ",", " ", 
              RowBox[{"we", " ", "should", " ", "do", " ", 
               StyleBox["plus",
                FontColor->RGBColor[1, 0, 1]], 
               StyleBox[" ",
                FontColor->RGBColor[1, 0, 1]], 
               RowBox[{"w", "/", " ", 
                RowBox[{"it", "."}]}]}]}], "*)"}], 
            RowBox[{"LieDT", "=", 
             RowBox[{"LieDT", "+", "tempT"}]}]}]}], "]"}], ",", 
         RowBox[{"(*", 
          RowBox[{
          "Run", " ", "through", " ", "all", " ", "the", " ", "indices"}], 
          "*)"}], 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "rank"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"output", "=", 
        RowBox[{"t", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", "tn_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", 
              RowBox[{"Row", "[", 
               RowBox[{"{", 
                RowBox[{"\"\<\[Sterling]\>\"", ",", 
                 RowBox[{"Column", "[", 
                  RowBox[{"{", 
                   RowBox[{"Null", ",", 
                    RowBox[{"TensorName", "[", "\[Xi]1", "]"}]}], "}"}], 
                  "]"}], ",", 
                 RowBox[{"TensorName", "[", "t", "]"}]}], "}"}], "]"}]}], 
             ")"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorType", "\[Rule]", "tn_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorType", "\[Rule]", "\"\<LieD\>\""}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "idx_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", 
              RowBox[{"Which", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"OptionValue", "[", "Indices", "]"}], "=!=", 
                   "Null"}], "&&", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{"OptionValue", "[", "Indices", "]"}]}], ")"}], "===", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{"Indices", "[", "t", "]"}]}], ")"}]}], ")"}]}], 
                 ")"}], ",", 
                RowBox[{"OptionValue", "[", "Indices", "]"}], ",", "True", 
                ",", "indices"}], "]"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"LieDT", "//", 
                RowBox[{"OptionValue", "[", "LieDerivativeOperator", "]"}]}], 
               ")"}]}], ")"}]}]}], "\[IndentingNewLine]", "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}], "=!=", 
           "Null"}], ")"}], ",", 
         RowBox[{"output", "=", 
          RowBox[{"TooltipDisplay", "[", 
           RowBox[{"output", ",", 
            RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], "]"}]}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
           RowBox[{"{", "}"}]}], ")"}], ",", 
         RowBox[{"output", "=", 
          RowBox[{"TooltipStyle", "[", 
           RowBox[{"output", ",", 
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], "]"}]}]}], 
        "]"}], ";", "\[IndentingNewLine]", "output"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"LieD", " ", "for", " ", "ExpressionForm"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LieD", "[", 
     RowBox[{
      RowBox[{"\[Xi]1_Tensor", "/;", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Dimensions", "[", 
           RowBox[{"TensorComponents", "[", "\[Xi]1", "]"}], "]"}], "===", 
          RowBox[{"{", 
           RowBox[{"Length", "[", 
            RowBox[{"Coordinates", "[", "\[Xi]1", "]"}], "]"}], "}"}]}], 
         ")"}], "&&", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Since", " ", "user", " ", 
           RowBox[{"didn", "'"}], "t", " ", "input", " ", "the", " ", 
           "metric"}], ",", " ", 
          RowBox[{
          "we", " ", "only", " ", "allow", " ", "them", " ", "to", " ", "be", 
           " ", "vector", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"w", "/", " ", 
               StyleBox["upper",
                FontColor->RGBColor[1, 0, 1]]}], 
              StyleBox[" ",
               FontColor->RGBColor[1, 0, 1]], 
              StyleBox["index",
               FontColor->RGBColor[1, 0, 1]]}], ")"}], "."}]}]}], "*)"}], 
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"Indices", "[", "\[Xi]1", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"SuperMinus", "[", "_", "]"}], "}"}]}], "]"}]}]}], ",", 
      RowBox[{"stuff_", "/;", 
       RowBox[{"TestExpressionForm", "[", "stuff", "]"}]}], ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"LieD", "[", 
      RowBox[{"\[Xi]1", ",", 
       RowBox[{"NonMetricTensor", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", "stuff", ",", "stuff", ",", 
         RowBox[{"Coordinates", "\[Rule]", 
          RowBox[{"Coordinates", "[", "\[Xi]1", "]"}]}], ",", 
         RowBox[{"StartIndex", "\[Rule]", 
          RowBox[{"StartIndex", "[", "\[Xi]1", "]"}]}]}], "]"}], ",", 
       "opts"}], "]"}], "//", "TensorComponents"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Subscript", "[", 
    RowBox[{"Global`\[Sterling]", ",", "a_Tensor"}], "]"}], "[", "b_Tensor", 
   "]"}], ":=", 
  RowBox[{"LieD", "[", 
   RowBox[{"a", ",", "b"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.52174396084375*^9, 3.521743989140625*^9}, {
   3.52174404553125*^9, 3.52174406490625*^9}, {3.52174411178125*^9, 
   3.521744178*^9}, {3.52175753421875*^9, 3.52175753465625*^9}, {
   3.521759735640625*^9, 3.521759758125*^9}, {3.5217868350625*^9, 
   3.521786885078125*^9}, {3.52178704734375*^9, 3.521787116328125*^9}, {
   3.521787178828125*^9, 3.5217871886875*^9}, {3.521787424390625*^9, 
   3.5217874283125*^9}, {3.521787532828125*^9, 3.52178754371875*^9}, 
   3.521910410859375*^9, {3.5219174194375*^9, 3.521917422546875*^9}, {
   3.521917491703125*^9, 3.5219174925*^9}, {3.521917608890625*^9, 
   3.521917617625*^9}, {3.521918314421875*^9, 3.521918316125*^9}, {
   3.521919269328125*^9, 3.5219193048125*^9}, {3.521919497375*^9, 
   3.52191951465625*^9}, {3.521921384*^9, 3.5219213845625*^9}, {
   3.521922223546875*^9, 3.5219222338125*^9}, {3.521955617484375*^9, 
   3.521955648359375*^9}, {3.521990471359375*^9, 3.52199061959375*^9}, {
   3.521990750328125*^9, 3.521990763484375*^9}, {3.532452011949185*^9, 
   3.532452013961588*^9}, {3.532452056362463*^9, 3.5324520586088667`*^9}, {
   3.5324523712334156`*^9, 3.5324523744782214`*^9}, {3.5324524076906796`*^9, 
   3.532452416130295*^9}, {3.6297526960186977`*^9, 3.629752705008212*^9}, {
   3.6299261040969267`*^9, 3.629926110841316*^9}, 3.6694393941659937`*^9, {
   3.669441203316702*^9, 3.669441278031819*^9}, {3.6694413314969053`*^9, 
   3.669441344335925*^9}, {3.6694413927307887`*^9, 3.6694414202318296`*^9}, {
   3.669514862752521*^9, 3.6695148645345235`*^9}, {3.6695149391946507`*^9, 
   3.669514991276733*^9}, {3.669515032105801*^9, 3.66951506111785*^9}, {
   3.6695152519181633`*^9, 3.669515260451182*^9}, {3.6695153013712487`*^9, 
   3.669515312627266*^9}, {3.6695154093496957`*^9, 3.6695154099216995`*^9}, {
   3.6695167123289385`*^9, 3.669516722073496*^9}, {3.6695173941773467`*^9, 
   3.669517413711464*^9}, {3.6695188004335203`*^9, 3.669518824793914*^9}, {
   3.6695194703083725`*^9, 3.6695194811419926`*^9}, {3.6695209914193163`*^9, 
   3.669521009949376*^9}, {3.669521115596419*^9, 3.6695212488830423`*^9}, {
   3.6695213351253843`*^9, 3.6695213791829042`*^9}, {3.669523166945903*^9, 
   3.6695232008429565`*^9}, {3.6695232691576443`*^9, 
   3.6695232946376853`*^9}, {3.669523348301781*^9, 3.6695234515499983`*^9}, {
   3.6695234848580523`*^9, 3.6695234857220545`*^9}, {3.6695235958404326`*^9, 
   3.669523596974471*^9}, {3.6695236354808025`*^9, 3.66952372849792*^9}, {
   3.66952376388914*^9, 3.6695237647051687`*^9}, {3.669523797091816*^9, 
   3.6695238756779413`*^9}, {3.6695239078229923`*^9, 3.6695239452280507`*^9}, 
   3.669524104919151*^9, {3.6695244117364087`*^9, 3.6695244138805313`*^9}, {
   3.66952454961929*^9, 3.669524582457168*^9}, {3.669524667216015*^9, 
   3.669524719319178*^9}, {3.669524760089368*^9, 3.6695248023595705`*^9}, {
   3.6695248594438553`*^9, 3.669524879383955*^9}, {3.6695251507197723`*^9, 
   3.6695252045538516`*^9}, {3.669525319076599*^9, 3.6695255239586067`*^9}, {
   3.669525569509823*^9, 3.6695255843268876`*^9}, {3.669526032181349*^9, 
   3.6695260335224257`*^9}, {3.669526535424133*^9, 3.669526592160378*^9}, {
   3.6695269712790256`*^9, 3.6695270006767073`*^9}, {3.669529384680343*^9, 
   3.669529386685458*^9}, {3.6695306845557566`*^9, 3.669530688418766*^9}, 
   3.6695338215879908`*^9, {3.6696043936661644`*^9, 3.669604394425166*^9}, {
   3.6697730792502522`*^9, 3.669773086852687*^9}, {3.669821997814456*^9, 
   3.66982200572567*^9}, 3.669822439592286*^9, {3.672717485337129*^9, 
   3.6727175397682424`*^9}, {3.6727176071010933`*^9, 3.672717636492775*^9}, {
   3.6727176686836157`*^9, 3.6727177213646293`*^9}, {3.6727177702034225`*^9, 
   3.6727178572564015`*^9}, {3.672717887283119*^9, 3.6727178937694902`*^9}, {
   3.6727179404391594`*^9, 3.6727179406311703`*^9}, {3.672719714402387*^9, 
   3.672719718733203*^9}, {3.6727198336652737`*^9, 3.672719918631877*^9}, {
   3.718113152795261*^9, 3.7181131936108465`*^9}, {3.718120008664604*^9, 
   3.7181200362640686`*^9}, {3.718120083644309*^9, 3.718120084142719*^9}, {
   3.7181201654003277`*^9, 3.7181202146220803`*^9}, {3.718120257514296*^9, 
   3.7181203600643024`*^9}, {3.718120416774328*^9, 3.7181204439284606`*^9}, {
   3.718120536272476*^9, 3.718120566018412*^9}, {3.7181206683107376`*^9, 
   3.7181206878104663`*^9}, {3.718120853577713*^9, 3.718120898589381*^9}, {
   3.718121337528339*^9, 3.718121483084839*^9}, {3.71812163923243*^9, 
   3.718121681989288*^9}, {3.718121850222268*^9, 3.7181218503891525`*^9}, {
   3.7181219781023026`*^9, 3.718122044575076*^9}, {3.718122111517206*^9, 
   3.718122127839568*^9}, {3.7181675623891754`*^9, 3.718167579643383*^9}, {
   3.718167890730296*^9, 3.718167925898554*^9}, {3.7181680170534754`*^9, 
   3.718168019226018*^9}, {3.7181681770793886`*^9, 3.7181681806114984`*^9}, {
   3.718168213068512*^9, 3.718168241881523*^9}, {3.718168354431093*^9, 
   3.7181683671608443`*^9}, {3.718168522595014*^9, 3.7181685240174723`*^9}, {
   3.7181685665341315`*^9, 3.7181685916153936`*^9}, {3.718168627541527*^9, 
   3.7181686285518384`*^9}, {3.7181686869782743`*^9, 3.718168723302059*^9}, {
   3.7181688624713755`*^9, 3.718168864987712*^9}, {3.7181690228007035`*^9, 
   3.718169162996397*^9}, {3.7181692591219144`*^9, 3.718169420287557*^9}, {
   3.7181695331034083`*^9, 3.7181696882869735`*^9}, {3.718169747473213*^9, 
   3.718169774785277*^9}, {3.718169805784819*^9, 3.7181698277390833`*^9}, {
   3.718169912045196*^9, 3.718169914685809*^9}, {3.7181699598061514`*^9, 
   3.718169970324886*^9}, {3.718174849977064*^9, 3.718174901960864*^9}, {
   3.7181749447138357`*^9, 3.7181751333396473`*^9}, {3.7181751964131765`*^9, 
   3.718175299958202*^9}, {3.7181757489809313`*^9, 3.718175751121794*^9}, {
   3.7181761529552455`*^9, 3.718176156643181*^9}, {3.718177761323681*^9, 
   3.71817776185317*^9}, {3.7181779797531166`*^9, 3.718178001182824*^9}, {
   3.718178432801987*^9, 3.7181784336636972`*^9}, {3.7181785165633006`*^9, 
   3.7181785212720814`*^9}, 3.718180370619824*^9, {3.7277838546352525`*^9, 
   3.727783858169075*^9}, {3.727787467829364*^9, 3.727787495938246*^9}, {
   3.7277875756934986`*^9, 3.7277875792397604`*^9}, {3.7277876707418776`*^9, 
   3.72778770219399*^9}, {3.7277877584258285`*^9, 3.7277877915109577`*^9}, {
   3.7277878424043903`*^9, 3.7277878811264715`*^9}, 3.7277879383036757`*^9, {
   3.727788719881564*^9, 3.7277888261798315`*^9}, {3.727788912849109*^9, 
   3.7277889371845922`*^9}, {3.7277897311974845`*^9, 3.727789744827913*^9}, {
   3.7277899581351657`*^9, 3.7277900115452623`*^9}, {3.727790077297223*^9, 
   3.727790118143917*^9}, {3.7277904370689335`*^9, 3.72779068173335*^9}, {
   3.727790720372624*^9, 3.727790938406535*^9}, {3.7277909992197423`*^9, 
   3.7277910652090855`*^9}, {3.727791099381648*^9, 3.727791151586588*^9}, {
   3.72779119753117*^9, 3.727791333775207*^9}, {3.7277913649255753`*^9, 
   3.7277913932071843`*^9}, {3.727791440834066*^9, 3.727791443680626*^9}, {
   3.7277914802625117`*^9, 3.7277914963036475`*^9}, {3.727791596706025*^9, 
   3.727791632429778*^9}, {3.727791703379794*^9, 3.7277917697057447`*^9}, {
   3.7277921266899767`*^9, 3.727792128011541*^9}, {3.727836859594427*^9, 
   3.7278369493787804`*^9}, {3.727837606489853*^9, 3.727837664283385*^9}, {
   3.8407724493806095`*^9, 3.8407724507755156`*^9}, {3.840772521269809*^9, 
   3.840772561838919*^9}, 3.8407726113251805`*^9, {3.8407728203563204`*^9, 
   3.84077282884037*^9}, 3.840843520814411*^9, {3.84084355110458*^9, 
   3.840843606524502*^9}, 3.840843761720167*^9, 3.841219815037341*^9, {
   3.8412199088308015`*^9, 3.8412199564753337`*^9}, 3.8412200195293245`*^9, {
   3.8412200801236506`*^9, 3.8412201213506517`*^9}, {3.841220183972626*^9, 
   3.8412202704844627`*^9}, 3.841220343688476*^9, {3.841220471045478*^9, 
   3.8412204903984747`*^9}, {3.841220529820326*^9, 3.841220567276322*^9}, {
   3.8412206264934783`*^9, 3.8412206932614803`*^9}, {3.841220740020477*^9, 
   3.84122080573448*^9}, {3.841220850295054*^9, 3.841220894031576*^9}, {
   3.841220976430519*^9, 3.841221021565101*^9}, {3.8412212208717117`*^9, 
   3.8412212232887144`*^9}, {3.8412213151185365`*^9, 3.841221324693531*^9}, {
   3.841221715926469*^9, 3.8412217329239254`*^9}, {3.8412218195935717`*^9, 
   3.8412218202325735`*^9}, {3.841226222717462*^9, 3.8412262692575893`*^9}, {
   3.8412263374674025`*^9, 3.8412263447273617`*^9}, {3.841226450257053*^9, 
   3.841226452257242*^9}, {3.841226547637249*^9, 3.841226551347434*^9}, {
   3.8412267888636456`*^9, 3.8412268012802477`*^9}, {3.841226840088232*^9, 
   3.8412268426033783`*^9}, {3.841374778582284*^9, 3.8413748016048827`*^9}, {
   3.8413753509883113`*^9, 3.84137537446701*^9}, {3.8413754110980825`*^9, 
   3.8413754476306753`*^9}, {3.841375509218422*^9, 3.841375509386316*^9}, {
   3.8420741494651003`*^9, 3.8420741518869762`*^9}, {3.8430836490387526`*^9, 
   3.8430836892697897`*^9}, {3.8430840639774747`*^9, 3.843084097224845*^9}, {
   3.843084254078519*^9, 3.843084260616461*^9}, {3.843086139184486*^9, 
   3.843086144770327*^9}, 3.843086184585873*^9, {3.843086217684342*^9, 
   3.843086243060648*^9}, {3.8430863073994794`*^9, 3.843086324017996*^9}, {
   3.843086532412168*^9, 3.8430867154697385`*^9}, {3.8430867910647645`*^9, 
   3.843086797299054*^9}, {3.843087303135919*^9, 3.843087311531622*^9}, {
   3.8430876200860806`*^9, 3.843087626335846*^9}, {3.8430876717690125`*^9, 
   3.843087676128538*^9}, {3.8436218755549107`*^9, 3.843621884625325*^9}, {
   3.843953052171285*^9, 3.8439531331712875`*^9}, 3.8439531721087875`*^9, {
   3.843953210718161*^9, 3.843953242780662*^9}, {3.843953634960122*^9, 
   3.8439537080877857`*^9}, {3.8439537473534126`*^9, 
   3.8439539996823697`*^9}, {3.843954491581495*^9, 3.8439544928621845`*^9}, {
   3.8439545398116083`*^9, 3.8439545756232285`*^9}, {3.8439546084683695`*^9, 
   3.843954608765242*^9}, 3.8439546695440016`*^9, {3.8442942786848307`*^9, 
   3.8442942986589727`*^9}, {3.8442946485304184`*^9, 
   3.8442946507184362`*^9}, {3.8442948322958527`*^9, 
   3.8442948760817065`*^9}, {3.85328641394878*^9, 3.8532865362047644`*^9}, {
   3.8532865748668537`*^9, 3.853286694413516*^9}, {3.853286743393367*^9, 
   3.853286749694873*^9}, 3.8532867861129436`*^9, {3.853847887666399*^9, 
   3.853847895511449*^9}, {3.8538479472965136`*^9, 3.8538479898018494`*^9}, {
   3.853848030766468*^9, 3.8538481828965836`*^9}, {3.8538482474062223`*^9, 
   3.8538483979264755`*^9}, {3.85384879156872*^9, 3.8538488519287004`*^9}, {
   3.8538492581988363`*^9, 3.8538493734266167`*^9}, {3.8538494113188033`*^9, 
   3.8538494194888043`*^9}, {3.8538494615583715`*^9, 
   3.8538496452858953`*^9}, {3.8538496764885683`*^9, 
   3.8538496796187243`*^9}, {3.8538817293317723`*^9, 
   3.8538817302567725`*^9}, {3.8538817720547733`*^9, 3.853881804218772*^9}, {
   3.853881836292774*^9, 3.8538818993967733`*^9}, {3.8538820639457726`*^9, 
   3.853882065684772*^9}, {3.8538820985157733`*^9, 3.853882100741773*^9}, {
   3.853882140864772*^9, 3.853882144872773*^9}, {3.853970712805137*^9, 
   3.853970732138238*^9}, {3.8544129154059143`*^9, 3.8544129270583553`*^9}, {
   3.8544129963198357`*^9, 3.854413094881153*^9}, 3.8667065585405755`*^9, {
   3.8667155560354743`*^9, 3.8667155839816008`*^9}, {3.8667156231715536`*^9, 
   3.8667156242570257`*^9}, {3.8667159553250885`*^9, 3.866715968924334*^9}, {
   3.86671612478946*^9, 3.8667161259866066`*^9}, {3.866716187133911*^9, 
   3.8667162073638673`*^9}, {3.866716300228763*^9, 3.8667163365646706`*^9}, {
   3.8667163985941477`*^9, 3.866716399908143*^9}, {3.866716466572727*^9, 
   3.866716470528139*^9}, 3.866716504410533*^9, {3.8667165547048407`*^9, 
   3.866716576164322*^9}, 3.8667167314087124`*^9, {3.866717009105966*^9, 
   3.8667170223047967`*^9}, 3.866717183030675*^9, {3.8667172263819847`*^9, 
   3.8667172268975773`*^9}, {3.8667172704239807`*^9, 
   3.8667173329869967`*^9}, {3.866718656007507*^9, 3.866718679139799*^9}, {
   3.8667187176826735`*^9, 3.866718731626344*^9}, {3.866718827560895*^9, 
   3.8667189527415085`*^9}, 3.8667189838148117`*^9, {3.86671901690086*^9, 
   3.866719023981798*^9}, {3.866719064613601*^9, 3.866719065457305*^9}, {
   3.8667570290153775`*^9, 3.8667570496241226`*^9}, {3.86675712173438*^9, 
   3.8667571523418026`*^9}, {3.866771319815587*^9, 3.866771362730858*^9}, 
   3.866771483019455*^9, {3.8673139292955604`*^9, 3.8673140150998287`*^9}, {
   3.867314105599106*^9, 3.867314111348889*^9}, {3.8673141484914265`*^9, 
   3.867314155028867*^9}, {3.8673145737130547`*^9, 3.867314580540806*^9}, {
   3.8673146323803644`*^9, 3.867314706524504*^9}, {3.867315001827664*^9, 
   3.867315005587598*^9}, {3.867315061217061*^9, 3.8673151452667155`*^9}, {
   3.8673151833863354`*^9, 3.867315198296013*^9}, {3.867315275930767*^9, 
   3.867315286935861*^9}, {3.867315430442907*^9, 3.867315431247837*^9}, {
   3.8673156579963818`*^9, 3.867315698876066*^9}, {3.8673158182770147`*^9, 
   3.8673158471546636`*^9}, {3.8673158801749144`*^9, 3.8673158971210365`*^9}, 
   3.867315946916399*^9, {3.86731791029901*^9, 3.86731791062388*^9}, {
   3.8673179759683933`*^9, 3.8673179764255333`*^9}, 3.867372718912263*^9, {
   3.868529352230481*^9, 3.8685293537484713`*^9}, {3.8685294797567043`*^9, 
   3.8685294829925385`*^9}, {3.868529686646577*^9, 3.8685297026132135`*^9}, {
   3.868529737990218*^9, 3.8685298355806713`*^9}, {3.868530005093338*^9, 
   3.868530015128569*^9}, 3.868530050205814*^9, {3.868530101614198*^9, 
   3.8685301210795813`*^9}, {3.8685301641965904`*^9, 3.868530186902213*^9}, 
   3.868530229111146*^9, {3.86853027181614*^9, 3.868530302056173*^9}, 
   3.868530336445647*^9, 3.868530405649912*^9, {3.8685304435865345`*^9, 
   3.868530488395812*^9}, {3.868530577150242*^9, 3.8685305779158444`*^9}, {
   3.8685356669633317`*^9, 3.868535681781576*^9}, {3.8685357423895626`*^9, 
   3.868535763974206*^9}, 3.868537042471571*^9, {3.8685755353648205`*^9, 
   3.868575541432276*^9}, 3.86857687824716*^9, {3.8685769207889214`*^9, 
   3.868576933469455*^9}, {3.8685769868380694`*^9, 3.868577029227231*^9}, {
   3.8685770604909487`*^9, 3.8685770965591516`*^9}, {3.8685783681600904`*^9, 
   3.868578395844706*^9}, {3.8685788179449863`*^9, 3.868578853081208*^9}, {
   3.868578976975403*^9, 3.868578982270752*^9}, {3.8686020777834673`*^9, 
   3.8686021428444185`*^9}, {3.8686021903320837`*^9, 
   3.8686022142500906`*^9}, {3.8686022534652653`*^9, 3.868602254604102*^9}, {
   3.8686098373126893`*^9, 3.8686098408620358`*^9}, {3.8686115952638397`*^9, 
   3.868611611240094*^9}, {3.8691007751399565`*^9, 3.8691007766510267`*^9}, {
   3.8691755328545475`*^9, 3.869175543308442*^9}, {3.8692874025353785`*^9, 
   3.869287408255878*^9}, {3.8692874389547997`*^9, 3.8692874470488415`*^9}, {
   3.875757942517582*^9, 3.875758070239147*^9}, {3.884766776729697*^9, 
   3.8847668433293138`*^9}, {3.8848100735157237`*^9, 3.884810074532093*^9}, {
   3.8893334152283845`*^9, 3.8893336236380615`*^9}, {3.8893336838900366`*^9, 
   3.8893337733458395`*^9}, 3.889333849911951*^9, 3.8893339224133387`*^9, {
   3.8893340065579042`*^9, 3.889334022528113*^9}, {3.8896665886477823`*^9, 
   3.8896666190858235`*^9}, {3.8901927393306956`*^9, 3.890192804136893*^9}, {
   3.8901981801311736`*^9, 3.8901981821218605`*^9}, {3.8915191806843243`*^9, 
   3.891519184144026*^9}, {3.8915192220876703`*^9, 3.8915192292980275`*^9}, {
   3.8915871135033135`*^9, 3.891587141515642*^9}, {3.893209424350897*^9, 
   3.893209435677486*^9}, {3.893209471988702*^9, 3.893209535509034*^9}, {
   3.8932095880251827`*^9, 3.8932096267468843`*^9}, {3.8932097430886393`*^9, 
   3.893209758962556*^9}, 3.8932098249559894`*^9, {3.8950732616313677`*^9, 
   3.895073261646992*^9}, {3.895549051703639*^9, 3.8955490517246265`*^9}, {
   3.8955551724895377`*^9, 3.8955551725075264`*^9}, {3.895555838535388*^9, 
   3.8955558385493793`*^9}, {3.8955560194939394`*^9, 
   3.8955560195189266`*^9}, {3.967777452142903*^9, 3.967777452170513*^9}, {
   3.972612315961177*^9, 3.972612316737278*^9}, {3.9737653452533627`*^9, 
   3.973765345366622*^9}, {3.975313487829445*^9, 3.975313503991085*^9}, {
   3.975313539410824*^9, 3.975313557811297*^9}, {3.975313590186513*^9, 
   3.975313627010741*^9}},ExpressionUUID->"58101c3d-e202-45e2-8fee-\
0723b2d713ba"]
}, Closed]],

Cell[CellGroupData[{

Cell["LieBracket", "Subsection",
 CellChangeTimes->{
  3.867372724341937*^9},ExpressionUUID->"5a6f0069-2e6b-4d53-b6f4-\
b774d3db0b81"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LieBracket", "[", 
     RowBox[{"\[Xi]1_Tensor", ",", "\[Xi]2_Tensor", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Dimensions", "[", 
        RowBox[{"TensorComponents", "[", "\[Xi]1", "]"}], "]"}], "===", 
       RowBox[{"{", 
        RowBox[{"Length", "[", 
         RowBox[{"Coordinates", "[", "\[Xi]1", "]"}], "]"}], "}"}], "===", 
       RowBox[{"{", 
        RowBox[{"Length", "[", 
         RowBox[{"Coordinates", "[", "\[Xi]2", "]"}], "]"}], "}"}]}], ")"}], "&&", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"StartIndex", "[", "\[Xi]1", "]"}], "===", 
       RowBox[{"StartIndex", "[", "\[Xi]1", "]"}]}], ")"}], "&&", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Since", " ", "user", " ", 
        RowBox[{"didn", "'"}], "t", " ", "input", " ", "the", " ", "metric"}],
        ",", " ", 
       RowBox[{
       "we", " ", "only", " ", "allow", " ", "them", " ", "to", " ", "be", 
        " ", "vector", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"w", "/", " ", 
            StyleBox["upper",
             FontColor->RGBColor[1, 0, 1]]}], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["index",
            FontColor->RGBColor[1, 0, 1]]}], ")"}], "."}]}]}], "*)"}], 
     RowBox[{"TestOneVector", "[", "\[Xi]1", "]"}], "&&", 
     RowBox[{"TestOneVector", "[", "\[Xi]2", "]"}], "&&", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"{", "opts", "}"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"LieBracketOperator", "|", "LieDerivativeOperator"}], 
                ")"}], "\[Rule]", "a_"}], ")"}], "\[Rule]", "a"}]}], "]"}], 
          "]"}], "===", "0"}], ")"}], "||", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"{", "opts", "}"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"LieBracketOperator", "|", "LieDerivativeOperator"}], 
                ")"}], "\[Rule]", "a_"}], ")"}], "\[Rule]", "a"}]}], "]"}], 
          "]"}], "===", "1"}], ")"}]}], ")"}]}]}], ":=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"{", "opts", "}"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"LieBracketOperator", "\[Rule]", "a_"}], ")"}], "\[Rule]", 
          "LieBracketOperator"}]}], "]"}], "===", 
       RowBox[{"{", "LieBracketOperator", "}"}]}], ")"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Sequence", "@@", 
        RowBox[{"List", "[", 
         RowBox[{"\[Xi]1", ",", "\[Xi]2", ",", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", "opts", "}"}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"LieBracketOperator", "\[Rule]", 
                 RowBox[{"OptionValue", "[", "LieBracketOperator", "]"}]}], 
                ")"}], "\[Rule]", "Nothing"}], "}"}]}], ")"}]}], ",", 
          RowBox[{"(", 
           RowBox[{"LieDerivativeOperator", "\[Rule]", 
            RowBox[{"OptionValue", "[", "LieBracketOperator", "]"}]}], 
           ")"}]}], "]"}]}], ")"}], "//", "LieD"}], ",", "True", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Sequence", "@@", 
        RowBox[{"List", "[", 
         RowBox[{"\[Xi]1", ",", "\[Xi]2", ",", "opts"}], "]"}]}], ")"}], "//",
       "LieD"}]}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LieBracket", "[", 
     RowBox[{
      RowBox[{"stuff1_", "/;", 
       RowBox[{"TestExpressionForm", "[", "stuff1", "]"}]}], ",", "stuff2_", 
      ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LieBracket", "[", 
    RowBox[{"stuff1_", ",", 
     RowBox[{"stuff2_", "/;", 
      RowBox[{"TestExpressionForm", "[", "stuff2", "]"}]}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "0"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.52174396084375*^9, 3.521743989140625*^9}, {
   3.52174404553125*^9, 3.52174406490625*^9}, {3.52174411178125*^9, 
   3.521744178*^9}, {3.52175753421875*^9, 3.52175753465625*^9}, {
   3.521759735640625*^9, 3.521759758125*^9}, {3.5217868350625*^9, 
   3.521786885078125*^9}, {3.52178704734375*^9, 3.521787116328125*^9}, {
   3.521787178828125*^9, 3.5217871886875*^9}, {3.521787424390625*^9, 
   3.5217874283125*^9}, {3.521787532828125*^9, 3.52178754371875*^9}, 
   3.521910410859375*^9, {3.5219174194375*^9, 3.521917422546875*^9}, {
   3.521917491703125*^9, 3.5219174925*^9}, {3.521917608890625*^9, 
   3.521917617625*^9}, {3.521918314421875*^9, 3.521918316125*^9}, {
   3.521919269328125*^9, 3.5219193048125*^9}, {3.521919497375*^9, 
   3.52191951465625*^9}, {3.521921384*^9, 3.5219213845625*^9}, {
   3.521922223546875*^9, 3.5219222338125*^9}, {3.521955617484375*^9, 
   3.521955648359375*^9}, {3.521990471359375*^9, 3.52199061959375*^9}, {
   3.521990750328125*^9, 3.521990763484375*^9}, {3.532452011949185*^9, 
   3.532452013961588*^9}, {3.532452056362463*^9, 3.5324520586088667`*^9}, {
   3.5324523712334156`*^9, 3.5324523744782214`*^9}, {3.5324524076906796`*^9, 
   3.532452416130295*^9}, {3.6297526960186977`*^9, 3.629752705008212*^9}, {
   3.6299261040969267`*^9, 3.629926110841316*^9}, 3.6694393941659937`*^9, {
   3.669441203316702*^9, 3.669441278031819*^9}, {3.6694413314969053`*^9, 
   3.669441344335925*^9}, {3.6694413927307887`*^9, 3.6694414202318296`*^9}, {
   3.669514862752521*^9, 3.6695148645345235`*^9}, {3.6695149391946507`*^9, 
   3.669514991276733*^9}, {3.669515032105801*^9, 3.66951506111785*^9}, {
   3.6695152519181633`*^9, 3.669515260451182*^9}, {3.6695153013712487`*^9, 
   3.669515312627266*^9}, {3.6695154093496957`*^9, 3.6695154099216995`*^9}, {
   3.6695167123289385`*^9, 3.669516722073496*^9}, {3.6695173941773467`*^9, 
   3.669517413711464*^9}, {3.6695188004335203`*^9, 3.669518824793914*^9}, {
   3.6695194703083725`*^9, 3.6695194811419926`*^9}, {3.6695209914193163`*^9, 
   3.669521009949376*^9}, {3.669521115596419*^9, 3.6695212488830423`*^9}, {
   3.6695213351253843`*^9, 3.6695213791829042`*^9}, {3.669523166945903*^9, 
   3.6695232008429565`*^9}, {3.6695232691576443`*^9, 
   3.6695232946376853`*^9}, {3.669523348301781*^9, 3.6695234515499983`*^9}, {
   3.6695234848580523`*^9, 3.6695234857220545`*^9}, {3.6695235958404326`*^9, 
   3.669523596974471*^9}, {3.6695236354808025`*^9, 3.66952372849792*^9}, {
   3.66952376388914*^9, 3.6695237647051687`*^9}, {3.669523797091816*^9, 
   3.6695238756779413`*^9}, {3.6695239078229923`*^9, 3.6695239452280507`*^9}, 
   3.669524104919151*^9, {3.6695244117364087`*^9, 3.6695244138805313`*^9}, {
   3.66952454961929*^9, 3.669524582457168*^9}, {3.669524667216015*^9, 
   3.669524719319178*^9}, {3.669524760089368*^9, 3.6695248023595705`*^9}, {
   3.6695248594438553`*^9, 3.669524879383955*^9}, {3.6695251507197723`*^9, 
   3.6695252045538516`*^9}, {3.669525319076599*^9, 3.6695255239586067`*^9}, {
   3.669525569509823*^9, 3.6695255843268876`*^9}, {3.669526032181349*^9, 
   3.6695260335224257`*^9}, {3.669526535424133*^9, 3.669526592160378*^9}, {
   3.6695269712790256`*^9, 3.6695270006767073`*^9}, {3.669529384680343*^9, 
   3.669529386685458*^9}, {3.6695306845557566`*^9, 3.669530688418766*^9}, 
   3.6695338215879908`*^9, {3.6696043936661644`*^9, 3.669604394425166*^9}, {
   3.6697730792502522`*^9, 3.669773086852687*^9}, {3.669821997814456*^9, 
   3.66982200572567*^9}, 3.669822439592286*^9, {3.672717485337129*^9, 
   3.6727175397682424`*^9}, {3.6727176071010933`*^9, 3.672717636492775*^9}, {
   3.6727176686836157`*^9, 3.6727177213646293`*^9}, {3.6727177702034225`*^9, 
   3.6727178572564015`*^9}, {3.672717887283119*^9, 3.6727178937694902`*^9}, {
   3.6727179404391594`*^9, 3.6727179406311703`*^9}, {3.672719714402387*^9, 
   3.672719718733203*^9}, {3.6727198336652737`*^9, 3.672719918631877*^9}, {
   3.718113152795261*^9, 3.7181131936108465`*^9}, {3.718120008664604*^9, 
   3.7181200362640686`*^9}, {3.718120083644309*^9, 3.718120084142719*^9}, {
   3.7181201654003277`*^9, 3.7181202146220803`*^9}, {3.718120257514296*^9, 
   3.7181203600643024`*^9}, {3.718120416774328*^9, 3.7181204439284606`*^9}, {
   3.718120536272476*^9, 3.718120566018412*^9}, {3.7181206683107376`*^9, 
   3.7181206878104663`*^9}, {3.718120853577713*^9, 3.718120898589381*^9}, {
   3.718121337528339*^9, 3.718121483084839*^9}, {3.71812163923243*^9, 
   3.718121681989288*^9}, {3.718121850222268*^9, 3.7181218503891525`*^9}, {
   3.7181219781023026`*^9, 3.718122044575076*^9}, {3.718122111517206*^9, 
   3.718122127839568*^9}, {3.7181675623891754`*^9, 3.718167579643383*^9}, {
   3.718167890730296*^9, 3.718167925898554*^9}, {3.7181680170534754`*^9, 
   3.718168019226018*^9}, {3.7181681770793886`*^9, 3.7181681806114984`*^9}, {
   3.718168213068512*^9, 3.718168241881523*^9}, {3.718168354431093*^9, 
   3.7181683671608443`*^9}, {3.718168522595014*^9, 3.7181685240174723`*^9}, {
   3.7181685665341315`*^9, 3.7181685916153936`*^9}, {3.718168627541527*^9, 
   3.7181686285518384`*^9}, {3.7181686869782743`*^9, 3.718168723302059*^9}, {
   3.7181688624713755`*^9, 3.718168864987712*^9}, {3.7181690228007035`*^9, 
   3.718169162996397*^9}, {3.7181692591219144`*^9, 3.718169420287557*^9}, {
   3.7181695331034083`*^9, 3.7181696882869735`*^9}, {3.718169747473213*^9, 
   3.718169774785277*^9}, {3.718169805784819*^9, 3.7181698277390833`*^9}, {
   3.718169912045196*^9, 3.718169914685809*^9}, {3.7181699598061514`*^9, 
   3.718169970324886*^9}, {3.718174849977064*^9, 3.718174901960864*^9}, {
   3.7181749447138357`*^9, 3.7181751333396473`*^9}, {3.7181751964131765`*^9, 
   3.718175299958202*^9}, {3.7181757489809313`*^9, 3.718175751121794*^9}, {
   3.7181761529552455`*^9, 3.718176156643181*^9}, {3.718177761323681*^9, 
   3.71817776185317*^9}, {3.7181779797531166`*^9, 3.718178001182824*^9}, {
   3.718178432801987*^9, 3.7181784336636972`*^9}, {3.7181785165633006`*^9, 
   3.7181785212720814`*^9}, 3.718180370619824*^9, {3.7277838546352525`*^9, 
   3.727783858169075*^9}, {3.727787467829364*^9, 3.727787495938246*^9}, {
   3.7277875756934986`*^9, 3.7277875792397604`*^9}, {3.7277876707418776`*^9, 
   3.72778770219399*^9}, {3.7277877584258285`*^9, 3.7277877915109577`*^9}, {
   3.7277878424043903`*^9, 3.7277878811264715`*^9}, 3.7277879383036757`*^9, {
   3.727788719881564*^9, 3.7277888261798315`*^9}, {3.727788912849109*^9, 
   3.7277889371845922`*^9}, {3.7277897311974845`*^9, 3.727789744827913*^9}, {
   3.7277899581351657`*^9, 3.7277900115452623`*^9}, {3.727790077297223*^9, 
   3.727790118143917*^9}, {3.7277904370689335`*^9, 3.72779068173335*^9}, {
   3.727790720372624*^9, 3.727790938406535*^9}, {3.7277909992197423`*^9, 
   3.7277910652090855`*^9}, {3.727791099381648*^9, 3.727791151586588*^9}, {
   3.72779119753117*^9, 3.727791333775207*^9}, {3.7277913649255753`*^9, 
   3.7277913932071843`*^9}, {3.727791440834066*^9, 3.727791443680626*^9}, {
   3.7277914802625117`*^9, 3.7277914963036475`*^9}, {3.727791596706025*^9, 
   3.727791632429778*^9}, {3.727791703379794*^9, 3.7277917697057447`*^9}, {
   3.7277921266899767`*^9, 3.727792128011541*^9}, {3.727836859594427*^9, 
   3.7278369493787804`*^9}, {3.727837606489853*^9, 3.727837664283385*^9}, {
   3.8407724493806095`*^9, 3.8407724507755156`*^9}, {3.840772521269809*^9, 
   3.840772561838919*^9}, 3.8407726113251805`*^9, {3.8407728203563204`*^9, 
   3.84077282884037*^9}, 3.840843520814411*^9, {3.84084355110458*^9, 
   3.840843606524502*^9}, 3.840843761720167*^9, 3.841219815037341*^9, {
   3.8412199088308015`*^9, 3.8412199564753337`*^9}, 3.8412200195293245`*^9, {
   3.8412200801236506`*^9, 3.8412201213506517`*^9}, {3.841220183972626*^9, 
   3.8412202704844627`*^9}, 3.841220343688476*^9, {3.841220471045478*^9, 
   3.8412204903984747`*^9}, {3.841220529820326*^9, 3.841220567276322*^9}, {
   3.8412206264934783`*^9, 3.8412206932614803`*^9}, {3.841220740020477*^9, 
   3.84122080573448*^9}, {3.841220850295054*^9, 3.841220894031576*^9}, {
   3.841220976430519*^9, 3.841221021565101*^9}, {3.8412212208717117`*^9, 
   3.8412212232887144`*^9}, {3.8412213151185365`*^9, 3.841221324693531*^9}, {
   3.841221715926469*^9, 3.8412217329239254`*^9}, {3.8412218195935717`*^9, 
   3.8412218202325735`*^9}, {3.841226222717462*^9, 3.8412262692575893`*^9}, {
   3.8412263374674025`*^9, 3.8412263447273617`*^9}, {3.841226450257053*^9, 
   3.841226452257242*^9}, {3.841226547637249*^9, 3.841226551347434*^9}, {
   3.8412267888636456`*^9, 3.8412268012802477`*^9}, {3.841226840088232*^9, 
   3.8412268426033783`*^9}, {3.841374778582284*^9, 3.8413748016048827`*^9}, {
   3.8413753509883113`*^9, 3.84137537446701*^9}, {3.8413754110980825`*^9, 
   3.8413754476306753`*^9}, {3.841375509218422*^9, 3.841375509386316*^9}, {
   3.8420741494651003`*^9, 3.8420741518869762`*^9}, {3.8430836490387526`*^9, 
   3.8430836892697897`*^9}, {3.8430840639774747`*^9, 3.843084097224845*^9}, {
   3.843084254078519*^9, 3.843084260616461*^9}, {3.843086139184486*^9, 
   3.843086144770327*^9}, 3.843086184585873*^9, {3.843086217684342*^9, 
   3.843086243060648*^9}, {3.8430863073994794`*^9, 3.843086324017996*^9}, {
   3.843086532412168*^9, 3.8430867154697385`*^9}, {3.8430867910647645`*^9, 
   3.843086797299054*^9}, {3.843087303135919*^9, 3.843087311531622*^9}, {
   3.8430876200860806`*^9, 3.843087626335846*^9}, {3.8430876717690125`*^9, 
   3.843087676128538*^9}, {3.8436218755549107`*^9, 3.843621884625325*^9}, {
   3.843953052171285*^9, 3.8439531331712875`*^9}, 3.8439531721087875`*^9, {
   3.843953210718161*^9, 3.843953242780662*^9}, {3.843953634960122*^9, 
   3.8439537080877857`*^9}, {3.8439537473534126`*^9, 
   3.8439539996823697`*^9}, {3.843954491581495*^9, 3.8439544928621845`*^9}, {
   3.8439545398116083`*^9, 3.8439545756232285`*^9}, {3.8439546084683695`*^9, 
   3.843954608765242*^9}, 3.8439546695440016`*^9, {3.8442942786848307`*^9, 
   3.8442942986589727`*^9}, {3.8442946485304184`*^9, 
   3.8442946507184362`*^9}, {3.8442948322958527`*^9, 
   3.8442948760817065`*^9}, {3.85328641394878*^9, 3.8532865362047644`*^9}, {
   3.8532865748668537`*^9, 3.853286694413516*^9}, {3.853286743393367*^9, 
   3.853286749694873*^9}, 3.8532867861129436`*^9, {3.853847887666399*^9, 
   3.853847895511449*^9}, {3.8538479472965136`*^9, 3.8538479898018494`*^9}, {
   3.853848030766468*^9, 3.8538481828965836`*^9}, {3.8538482474062223`*^9, 
   3.8538483979264755`*^9}, {3.85384879156872*^9, 3.8538488519287004`*^9}, {
   3.8538492581988363`*^9, 3.8538493734266167`*^9}, {3.8538494113188033`*^9, 
   3.8538494194888043`*^9}, {3.8538494615583715`*^9, 
   3.8538496452858953`*^9}, {3.8538496764885683`*^9, 
   3.8538496796187243`*^9}, {3.8538817293317723`*^9, 
   3.8538817302567725`*^9}, {3.8538817720547733`*^9, 3.853881804218772*^9}, {
   3.853881836292774*^9, 3.8538818993967733`*^9}, {3.8538820639457726`*^9, 
   3.853882065684772*^9}, {3.8538820985157733`*^9, 3.853882100741773*^9}, {
   3.853882140864772*^9, 3.853882144872773*^9}, {3.853970712805137*^9, 
   3.853970732138238*^9}, {3.8544129154059143`*^9, 3.8544129270583553`*^9}, {
   3.8544129963198357`*^9, 3.854413094881153*^9}, 3.8667065585405755`*^9, {
   3.8667155560354743`*^9, 3.8667155839816008`*^9}, {3.8667156231715536`*^9, 
   3.8667156242570257`*^9}, {3.8667159553250885`*^9, 3.866715968924334*^9}, {
   3.86671612478946*^9, 3.8667161259866066`*^9}, {3.866716187133911*^9, 
   3.8667162073638673`*^9}, {3.866716300228763*^9, 3.8667163365646706`*^9}, {
   3.8667163985941477`*^9, 3.866716399908143*^9}, {3.866716466572727*^9, 
   3.866716470528139*^9}, 3.866716504410533*^9, {3.8667165547048407`*^9, 
   3.866716576164322*^9}, 3.8667167314087124`*^9, {3.866717009105966*^9, 
   3.8667170223047967`*^9}, 3.866717183030675*^9, {3.8667172263819847`*^9, 
   3.8667172268975773`*^9}, {3.8667172704239807`*^9, 
   3.8667173329869967`*^9}, {3.866718656007507*^9, 3.866718679139799*^9}, {
   3.8667187176826735`*^9, 3.866718731626344*^9}, {3.866718827560895*^9, 
   3.8667189527415085`*^9}, 3.8667189838148117`*^9, {3.86671901690086*^9, 
   3.866719023981798*^9}, {3.866719064613601*^9, 3.866719065457305*^9}, {
   3.8667570290153775`*^9, 3.8667570496241226`*^9}, {3.86675712173438*^9, 
   3.8667571523418026`*^9}, {3.866771319815587*^9, 3.866771362730858*^9}, 
   3.866771483019455*^9, {3.8673139292955604`*^9, 3.8673140150998287`*^9}, {
   3.867314105599106*^9, 3.867314111348889*^9}, {3.8673141484914265`*^9, 
   3.867314155028867*^9}, {3.8673145737130547`*^9, 3.867314580540806*^9}, {
   3.8673146323803644`*^9, 3.867314706524504*^9}, {3.867315001827664*^9, 
   3.867315005587598*^9}, {3.867315061217061*^9, 3.8673151452667155`*^9}, {
   3.8673151833863354`*^9, 3.867315198296013*^9}, {3.867315275930767*^9, 
   3.867315286935861*^9}, {3.867315430442907*^9, 3.867315431247837*^9}, {
   3.8673156579963818`*^9, 3.867315698876066*^9}, {3.8673158182770147`*^9, 
   3.8673158471546636`*^9}, {3.8673158801749144`*^9, 3.8673158971210365`*^9}, 
   3.867315946916399*^9, {3.86731791029901*^9, 3.86731791062388*^9}, {
   3.8673179759683933`*^9, 3.8673179764255333`*^9}, 3.867372718912263*^9, {
   3.8685207354568048`*^9, 3.8685207551603146`*^9}, 3.8685210132313423`*^9, {
   3.868582405641487*^9, 3.8685824175699167`*^9}, {3.868582695247071*^9, 
   3.8685827102954335`*^9}, {3.8685829336203713`*^9, 3.868582984949568*^9}, {
   3.8685830238690844`*^9, 3.868583053723572*^9}, {3.868583089579219*^9, 
   3.868583108339407*^9}, {3.868583249329068*^9, 3.8685832977776384`*^9}, {
   3.8686050115025916`*^9, 3.868605015860901*^9}, {3.8686052864670544`*^9, 
   3.8686052921621313`*^9}, {3.8686055937058306`*^9, 3.868605600871408*^9}, {
   3.8686058416617117`*^9, 3.868605843165784*^9}, {3.8691779591860023`*^9, 
   3.8691779661535935`*^9}, {3.8757580806309233`*^9, 3.87575809057111*^9}, {
   3.8847690854301567`*^9, 3.884769091298715*^9}, {3.884769936355911*^9, 
   3.8847699461449594`*^9}, {3.890192840075426*^9, 3.8901928525864983`*^9}, {
   3.895555838555376*^9, 3.895555838557375*^9}, {3.8955560195239244`*^9, 
   3.8955560195269213`*^9}, {3.9737653453765707`*^9, 3.973765345377967*^9}, 
   3.9753136406194696`*^9},ExpressionUUID->"d180cf2c-a79b-4f69-aea8-\
e633c963da59"]
}, Closed]],

Cell[CellGroupData[{

Cell["CoordinateTransformation", "Subsection",
 CellChangeTimes->{
  3.5766860166362686`*^9},ExpressionUUID->"6b8fdb4f-3e2d-4c25-9e87-\
ef1a7343b3cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "JacobianComponents", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   StyleBox[
    RowBox[{
    "This", " ", "piece", " ", "is", " ", "supposed", " ", "to", " ", "not", 
     " ", "include", " ", "in", " ", "the", " ", "official", " ", 
     RowBox[{"version", "."}]}],
    FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"JacobianComponents", "[", 
      RowBox[{"ct", ":", 
       RowBox[{"{", 
        RowBox[{"Repeated", "[", 
         RowBox[{"Rule", "[", 
          RowBox[{"_Symbol", ",", "_"}], "]"}], "]"}], "}"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coords", ",", "rhs", ",", "lgth", ",", "jacobcomp", ",", "jacobm", 
         ",", "i", ",", "j", ",", "row", ",", "col"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"lgth", "=", 
         RowBox[{"Length", "[", "ct", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"coords", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "&"}],
           "/@", "ct"}]}], ";", 
        RowBox[{"rhs", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "&"}],
           "/@", "ct"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"jacobcomp", "[", 
          RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
           "rhs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           RowBox[{"(*", 
            RowBox[{
            "index", " ", "of", " ", "\[Xi]", " ", "should", " ", "represent",
              " ", "column"}], "*)"}], ",", 
           RowBox[{
           "coords", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], 
          RowBox[{"(*", 
           RowBox[{
           "index", " ", "of", " ", "x", " ", "should", " ", "represent", " ",
             "row"}], "*)"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"jacobm", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"jacobcomp", "[", 
            RowBox[{"row", ",", "col"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"row", ",", "1", ",", "lgth"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"col", ",", "1", ",", "lgth"}], "}"}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"JacobianComponents", "[", 
      RowBox[{
       RowBox[{"ct", ":", 
        RowBox[{"{", 
         RowBox[{"Repeated", "[", 
          RowBox[{"Rule", "[", 
           RowBox[{"_Symbol", ",", "_"}], "]"}], "]"}], "}"}]}], ",", 
       RowBox[{"newcoords", ":", 
        RowBox[{"{", 
         RowBox[{"Repeated", "[", "_Symbol", "]"}], "}"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coords", ",", "rhs", ",", "lgth", ",", "lgthrhs", ",", "jacobcomp", 
         ",", "jacobm", ",", "i", ",", "j", ",", "row", ",", "col"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"lgth", "=", 
         RowBox[{"Length", "[", "ct", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"lgthrhs", "=", 
         RowBox[{"Length", "[", "newcoords", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rhs", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "&"}],
           "/@", "ct"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"jacobcomp", "[", 
          RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
           "rhs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           RowBox[{"(*", 
            RowBox[{
            "index", " ", "of", " ", "\[Xi]", " ", "should", " ", "represent",
              " ", "column"}], "*)"}], ",", 
           RowBox[{
           "newcoords", "\[LeftDoubleBracket]", "j", 
            "\[RightDoubleBracket]"}]}], 
          RowBox[{"(*", 
           RowBox[{
           "index", " ", "of", " ", "x", " ", "should", " ", "represent", " ",
             "row"}], "*)"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"jacobm", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"jacobcomp", "[", 
            RowBox[{"row", ",", "col"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"row", ",", "1", ",", "lgthrhs"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"col", ",", "1", ",", "lgth"}], "}"}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8273977289769225`*^9, 3.8273977812329187`*^9}, 
   3.827397822806463*^9, {3.827397968537464*^9, 3.827397997394462*^9}, {
   3.827398147233434*^9, 3.827398149618436*^9}, {3.8273981980344453`*^9, 
   3.8273982176574335`*^9}, 3.827399388146923*^9, {3.8273994610173683`*^9, 
   3.8273996208470078`*^9}, {3.8273997447970066`*^9, 
   3.8273997674971094`*^9}, {3.827399945547058*^9, 3.8274000345474024`*^9}, {
   3.8274003204670353`*^9, 3.827400320617378*^9}, {3.8274018870534353`*^9, 
   3.8274019128304358`*^9}, {3.8274020115474353`*^9, 3.827402011746435*^9}, {
   3.827402555874447*^9, 3.827402560071436*^9}, {3.827402616403505*^9, 
   3.827402721026507*^9}, {3.8274027657955055`*^9, 3.827402766018505*^9}, {
   3.827402865315505*^9, 3.8274029211545057`*^9}, {3.8274032953502235`*^9, 
   3.8274032997042713`*^9}, 3.8279123514164157`*^9, {3.8293907518052874`*^9, 
   3.829390752908742*^9}, {3.8293909656440907`*^9, 3.829390988110962*^9}, {
   3.829391266781184*^9, 3.8293912737178097`*^9}, {3.83030063830005*^9, 
   3.8303006575925713`*^9}, {3.83030120221494*^9, 3.830301223956378*^9}, {
   3.830301358484892*^9, 3.830301376862209*^9}, {3.830301444355482*^9, 
   3.8303014456592965`*^9}, {3.8364759682785816`*^9, 3.836475971171385*^9}, {
   3.838195988519491*^9, 3.838195993465493*^9}, {3.8516596540964975`*^9, 
   3.8516596578373747`*^9}, {3.8955547750370197`*^9, 3.895554775047022*^9}, {
   3.974881023384342*^9, 3.974881032183172*^9}, {3.975313655182744*^9, 
   3.9753136842380323`*^9}},ExpressionUUID->"d82d687a-8264-4ab2-8e90-\
126ea1a0db20"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "Compute", " ", "Jacobians", " ", "for", " ", "coordinate", " ", 
     "transformations"}],
    FontColor->RGBColor[0.5, 0, 0.5]], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Enter", " ", "r"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", " ", "\[Rule]", " ", 
       RowBox[{"f1", "[", 
        RowBox[{"x", ",", "y", ",", "z", ",", "..."}], "]"}]}], ",", " ", 
      RowBox[{"y", " ", "\[Rule]", " ", 
       RowBox[{"f2", "[", 
        RowBox[{"x", ",", "y", ",", "z", ",", "..."}], "]"}]}], ",", " ", 
      RowBox[{"z", " ", "\[Rule]", " ", 
       RowBox[{"f3", "[", 
        RowBox[{"x", ",", "y", ",", "z", ",", "..."}], "]"}]}], ",", " ", 
      "..."}], "}"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"returns", " ", 
    RowBox[{"Union", "[", 
     RowBox[{"r", ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dx", " ", "\[Rule]", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[PartialD]", "f1"}], "/", 
              RowBox[{"\[PartialD]", "x"}]}], ")"}], 
            RowBox[{"\[DifferentialD]", "x"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[PartialD]", "f1"}], "/", 
              RowBox[{"\[PartialD]", "y"}]}], ")"}], 
            RowBox[{"\[DifferentialD]", "y"}]}], " ", "+"}], " ", "..."}]}], 
        ",", " ", 
        RowBox[{"dy", " ", "\[Rule]", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[PartialD]", "f2"}], "/", 
              RowBox[{"\[PartialD]", "x"}]}], ")"}], 
            RowBox[{"\[DifferentialD]", "x"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[PartialD]", "f2"}], "/", 
              RowBox[{"\[PartialD]", "y"}]}], ")"}], 
            RowBox[{"\[DifferentialD]", "y"}]}], " ", "+"}], " ", "..."}]}]}],
        "}"}]}], " ", "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"\[Del]", " ", "transform"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"CoordinateTransformation", "[", 
      RowBox[{"ct", ":", 
       RowBox[{"{", 
        RowBox[{"Repeated", "[", 
         RowBox[{"Rule", "[", 
          RowBox[{"_Symbol", ",", "_"}], "]"}], "]"}], "}"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coords", ",", "rhs", ",", "jacob", ",", "i", ",", "j", ",", "ds", 
         ",", "R", ",", "lgth", ",", "dlist", ",", "drhs", ",", "dellist", 
         ",", "delrhs", ",", "delR", ",", "jacobm", ",", "invjacobm"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coords", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "&"}],
           "/@", "ct"}]}], ";", 
        RowBox[{"rhs", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "&"}],
           "/@", "ct"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"dx", " ", "\[Rule]", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"dx", "'"}], "/", "dx"}], ")"}], " ", "dx"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"jacob", "[", "i_", "]"}], ":=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{
              "rhs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "coords", "\[LeftDoubleBracket]", "j", 
               "\[RightDoubleBracket]"}]}], "]"}], 
            RowBox[{"\[DifferentialD]", 
             RowBox[{
             "coords", "\[LeftDoubleBracket]", "j", 
              "\[RightDoubleBracket]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "coords", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ds", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[DifferentialD]", 
              RowBox[{
              "coords", "\[LeftDoubleBracket]", "#", 
               "\[RightDoubleBracket]"}]}], "\[Rule]", 
             RowBox[{"jacob", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", 
            RowBox[{"Length", "[", "coords", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"R", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"ds", ",", "ct"}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"lgth", "=", 
         RowBox[{"Length", "[", "ct", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Extract", " ", 
          StyleBox["coordinates",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"coords", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "&"}],
           "/@", "ct"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Generate", " ", "a", " ", 
          StyleBox["list",
           FontColor->RGBColor[1, 0, 1]], " ", "with", " ", 
          RowBox[{"\[DifferentialD]", " ", "in"}], " ", "front", " ", "of", 
          " ", 
          RowBox[{"coordinates", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"dlist", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"\[DifferentialD]", 
            RowBox[{
            "coords", "\[LeftDoubleBracket]", "#", 
             "\[RightDoubleBracket]"}]}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "lgth"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Generate", " ", 
          StyleBox["Jacobian",
           FontColor->RGBColor[1, 0, 1]], " ", "as", " ", 
          StyleBox["d",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["*",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["d",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["matrix",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          RowBox[{
           StyleBox["form",
            FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"jacobm", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Coefficient", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "dlist", "\[LeftDoubleBracket]", "a", "\[RightDoubleBracket]"}],
               "/.", "R"}], ",", 
             RowBox[{
             "dlist", "\[LeftDoubleBracket]", "b", 
              "\[RightDoubleBracket]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "1", ",", "lgth"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"b", ",", "1", ",", "lgth"}], "}"}]}], "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"Generate", " ", 
          StyleBox["inverse",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["Jacobian",
           FontColor->RGBColor[1, 0, 1]], " ", "as", " ", "d", "*", "d", " ", 
          "matrix", " ", 
          RowBox[{"form", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"invjacobm", "=", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"Inverse", "[", "jacobm", "]"}], "]"}], "//", 
          "Simplify"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dellist", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Del]", 
            RowBox[{
            "coords", "\[LeftDoubleBracket]", "#", 
             "\[RightDoubleBracket]"}]}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "lgth"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"delR", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"dellist", "\[Rule]", 
           RowBox[{"invjacobm", ".", "dellist"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"R", ",", "delR"}], "}"}], "]"}]}]}], "\[IndentingNewLine]",
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Enter", " ", "r"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", " ", "\[Rule]", " ", 
        RowBox[{"f1", "[", 
         RowBox[{
          RowBox[{"x", "'"}], ",", 
          RowBox[{"y", "'"}], ",", 
          RowBox[{"z", "'"}], ",", "..."}], "]"}]}], ",", " ", 
       RowBox[{"y", " ", "\[Rule]", " ", 
        RowBox[{"f2", "[", 
         RowBox[{
          RowBox[{"x", "'"}], ",", 
          RowBox[{"y", "'"}], ",", 
          RowBox[{"z", "'"}], ",", "..."}], "]"}]}], ",", " ", 
       RowBox[{"z", " ", "\[Rule]", " ", 
        RowBox[{"f3", "[", 
         RowBox[{
          RowBox[{"x", "'"}], ",", 
          RowBox[{"y", "'"}], ",", 
          RowBox[{"z", "'"}], ",", "..."}], "]"}]}], ",", " ", "..."}], 
      "}"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"i", ".", "e", ".", " ", "allow"}], " ", "for", " ", "different",
      " ", "names", " ", "on", " ", "the", " ", "RHS", " ", "than", " ", 
     "the", " ", "previous"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"returns", " ", 
     RowBox[{"Union", "[", 
      RowBox[{"r", ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"dx", " ", "\[Rule]", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[PartialD]", "f1"}], "/", 
               RowBox[{"\[PartialD]", 
                RowBox[{"x", "'"}]}]}], ")"}], 
             RowBox[{"\[DifferentialD]", 
              RowBox[{"x", "'"}]}]}], " ", "+", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[PartialD]", "f1"}], "/", 
               RowBox[{"\[PartialD]", 
                RowBox[{"y", "'"}]}]}], ")"}], 
             RowBox[{"\[DifferentialD]", 
              RowBox[{"y", "'"}]}]}], " ", "+"}], " ", "..."}]}], ",", " ", 
         RowBox[{"dy", " ", "\[Rule]", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[PartialD]", "f2"}], "/", 
               RowBox[{"\[PartialD]", 
                RowBox[{"x", "'"}]}]}], ")"}], 
             RowBox[{"\[DifferentialD]", 
              RowBox[{"x", "'"}]}]}], " ", "+", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[PartialD]", "f2"}], "/", 
               RowBox[{"\[PartialD]", 
                RowBox[{"y", "'"}]}]}], ")"}], 
             RowBox[{"\[DifferentialD]", 
              RowBox[{"y", "'"}]}]}], " ", "+"}], " ", "..."}]}]}], "}"}]}], 
      " ", "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"\[Del]", " ", "transform"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CoordinateTransformation", "[", 
      RowBox[{
       RowBox[{"ct", ":", 
        RowBox[{"{", 
         RowBox[{"Repeated", "[", 
          RowBox[{"Rule", "[", 
           RowBox[{"_Symbol", ",", "_"}], "]"}], "]"}], "}"}]}], ",", 
       RowBox[{"newcoords", ":", 
        RowBox[{"{", 
         RowBox[{"Repeated", "[", "_Symbol", "]"}], "}"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coords", ",", "rhs", ",", "jacob", ",", "i", ",", "j", ",", "ds", 
         ",", "R", ",", "lgth", ",", "lgthrhs", ",", "dlist", ",", "drhs", 
         ",", "dellist", ",", "delrhs", ",", "delR", ",", "jacobm", ",", 
         "invjacobm"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "extract", " ", "coordinates", " ", "and", " ", "transformation", " ",
          "rules"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coords", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "&"}],
           "/@", "ct"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rhs", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "&"}],
           "/@", "ct"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"jacob", "[", "i_", "]"}], ":=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{
              "rhs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "newcoords", "\[LeftDoubleBracket]", "j", 
               "\[RightDoubleBracket]"}]}], "]"}], 
            RowBox[{"\[DifferentialD]", 
             RowBox[{
             "newcoords", "\[LeftDoubleBracket]", "j", 
              "\[RightDoubleBracket]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "newcoords", "]"}]}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"ds", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[DifferentialD]", 
              RowBox[{
              "coords", "\[LeftDoubleBracket]", "#", 
               "\[RightDoubleBracket]"}]}], "\[Rule]", 
             RowBox[{"jacob", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", 
            RowBox[{"Length", "[", "coords", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"R", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"ds", ",", "ct"}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"lgth", "=", 
         RowBox[{"Length", "[", "ct", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"lgthrhs", "=", 
         RowBox[{"Length", "[", "newcoords", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"New", " ", 
          RowBox[{
           StyleBox["Dimension",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[":",
            FontColor->RGBColor[1, 0, 1]], " ", 
           RowBox[{"length", " ", "of", " ", 
            RowBox[{"newcoords", ".", " ", "Right"}], " ", "now", " ", 
            RowBox[{"it", "'"}], "s", " ", "might", " ", "be", " ", 
            RowBox[{"redundent", ".", " ", "Since"}], " ", "this", " ", 
            "piece", " ", "of", " ", "code", " ", "do", " ", "not", " ", 
            "cover", " ", "induced", " ", 
            RowBox[{"tensor", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Generate", " ", 
          StyleBox["inverse",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["Jacobian",
           FontColor->RGBColor[1, 0, 1]], " ", "as", " ", "d", "*", "d", " ", 
          "matrix", " ", 
          RowBox[{"form", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"lgth", "===", "lgthrhs"}], ")"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Generate", " ", "a", " ", 
            StyleBox["list",
             FontColor->RGBColor[1, 0, 1]], " ", "with", " ", 
            RowBox[{"\[DifferentialD]", " ", "in"}], " ", "front", " ", "of", 
            " ", 
            RowBox[{"coordinates", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"dlist", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"\[DifferentialD]", 
               RowBox[{
               "coords", "\[LeftDoubleBracket]", "#", 
                "\[RightDoubleBracket]"}]}], "&"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "lgth"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Generate", " ", "a", " ", 
             StyleBox["list",
              FontColor->RGBColor[1, 0, 1]], " ", "with", " ", 
             RowBox[{"\[DifferentialD]", " ", "in"}], " ", "front", " ", "of",
              " ", 
             RowBox[{"newcoords", "."}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"drhs", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"\[DifferentialD]", 
               RowBox[{
               "newcoords", "\[LeftDoubleBracket]", "#", 
                "\[RightDoubleBracket]"}]}], "&"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "lgthrhs"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Generate", " ", 
             StyleBox["Jacobian",
              FontColor->RGBColor[1, 0, 1]], " ", "as", " ", 
             StyleBox["d",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox["*",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox["d",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox["matrix",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 1]], 
             RowBox[{
              StyleBox["form",
               FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"jacobm", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Coefficient", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "dlist", "\[LeftDoubleBracket]", "a", 
                  "\[RightDoubleBracket]"}], "/.", "R"}], ",", 
                RowBox[{
                "drhs", "\[LeftDoubleBracket]", "b", 
                 "\[RightDoubleBracket]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "1", ",", "lgth"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"b", ",", "1", ",", "lgthrhs"}], "}"}]}], "]"}]}], ";", 
           RowBox[{"invjacobm", "=", 
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{"Inverse", "[", "jacobm", "]"}], "]"}], "//", 
             "Simplify"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"dellist", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Del]", 
               RowBox[{
               "coords", "\[LeftDoubleBracket]", "#", 
                "\[RightDoubleBracket]"}]}], "&"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "lgth"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"delrhs", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Del]", 
               RowBox[{
               "newcoords", "\[LeftDoubleBracket]", "#", 
                "\[RightDoubleBracket]"}]}], "&"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "lgthrhs"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"delR", "=", 
            RowBox[{"Thread", "[", 
             RowBox[{"dellist", "\[Rule]", 
              RowBox[{"invjacobm", ".", "delrhs"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"R", ",", "delR"}], "}"}], "]"}]}], ",", 
          RowBox[{"(", 
           RowBox[{"lgth", "=!=", "lgthrhs"}], ")"}], ",", "R"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "CoordinateTransformation", " ", "to", " ", "one", " ", "with", " ", 
     "the", " ", 
     StyleBox["same",
      FontColor->RGBColor[0.5, 0, 0.5]], " ", "symbols", " ", 
     RowBox[{"(", 
      StyleBox[
       RowBox[{
       "Other", " ", "than", " ", "Metric", " ", "and", " ", "Christoffel"}],
       FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CoordinateTransformation", "[", 
       RowBox[{
        RowBox[{"t_Tensor", "/;", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"TensorTypeNoPart", "[", "t", "]"}], ",", 
            RowBox[{"(", 
             RowBox[{"\"\<Metric\>\"", "|", "\"\<ChristoffelSymbols\>\""}], 
             ")"}]}], "]"}], "===", 
          RowBox[{"{", "}"}]}]}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Shouldn", "'"}], "t", " ", "be", " ", "Metric", " ", "or", 
          " ", "Christoffel"}], "*)"}], "\[IndentingNewLine]", ",", 
        RowBox[{"ct", ":", 
         RowBox[{"{", 
          RowBox[{"Repeated", "[", 
           RowBox[{"Rule", "[", 
            RowBox[{"_Symbol", ",", "_"}], "]"}], "]"}], "}"}]}], ",", 
        RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"(*", " ", 
        RowBox[{"check", " ", "same", " ", "coordinates"}], " ", "*)"}], 
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "&"}],
           "/@", "ct"}], "]"}], "===", 
        RowBox[{"Sort", "[", 
         RowBox[{"Coordinates", "[", "t", "]"}], "]"}]}], ")"}]}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "coords", ",", "lgth", ",", "jacobm", ",", "invjacobm", ",", 
          "jacobT", ",", "invjacobT", ",", "R", ",", "dlist", ",", "drhs", 
          ",", "lgthrhs", ",", "indices", ",", "idxl", ",", " ", "newm", ",", 
          "name", ",", "si", ",", "m", ",", "mx", ",", "tensorproduct", ",", 
          "allindices", ",", "j", ",", "s", ",", "l"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"indices", "=", 
          RowBox[{"RemoveUnderBarredIndices", "[", 
           RowBox[{"Indices", "[", "t", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           StyleBox["Rank",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["number",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[":",
             FontColor->RGBColor[1, 0, 1]], " ", 
            RowBox[{"indices", " ", 
             RowBox[{"list", "'"}], "s", " ", "length"}]}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"idxl", "=", 
          RowBox[{"Length", "[", "indices", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           StyleBox["Dimension",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[":",
            FontColor->RGBColor[1, 0, 1]], " ", 
           RowBox[{
           "length", " ", "of", " ", "coordinates", " ", "transformation", 
            " ", "list"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"lgth", "=", 
          RowBox[{"Length", "[", "ct", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Extract", " ", 
           StyleBox["old",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["coordinates",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"coords", "=", 
          RowBox[{"Coordinates", "[", "t", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Generate", " ", "a", " ", 
           StyleBox["list",
            FontColor->RGBColor[1, 0, 1]], " ", "with", " ", 
           RowBox[{"\[DifferentialD]", " ", "in"}], " ", "front", " ", "of", 
           " ", 
           RowBox[{"coordinates", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"dlist", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"\[DifferentialD]", 
             RowBox[{
             "coords", "\[LeftDoubleBracket]", "#", 
              "\[RightDoubleBracket]"}]}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", "lgth"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"R", ":", " ", 
           RowBox[{"Jacobian", " ", "replacement", " ", "rule", " ", 
            RowBox[{"list", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"R", "=", 
          RowBox[{"CoordinateTransformation", "[", "ct", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Generate", " ", 
           StyleBox["Jacobian",
            FontColor->RGBColor[1, 0, 1]], " ", "as", " ", 
           StyleBox["d",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["*",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["d",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["matrix",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["form",
             FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"jacobm", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Coefficient", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "dlist", "\[LeftDoubleBracket]", "a", 
                "\[RightDoubleBracket]"}], "/.", "R"}], ",", 
              RowBox[{
              "dlist", "\[LeftDoubleBracket]", "b", 
               "\[RightDoubleBracket]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "1", ",", "lgth"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", "1", ",", "lgth"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Generate", " ", 
           StyleBox["inverse",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["Jacobian",
            FontColor->RGBColor[1, 0, 1]], " ", "as", " ", "d", "*", "d", " ",
            "matrix", " ", 
           RowBox[{"form", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"invjacobm", "=", 
          RowBox[{"Transpose", "[", 
           RowBox[{"Inverse", "[", "jacobm", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           StyleBox["New",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["tensor",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[":",
             FontColor->RGBColor[1, 0, 1]], " ", 
            RowBox[{"Inherit", " ", "property", " ", "form", " ", "old", " ", 
             RowBox[{"one", "."}]}]}]}], "*)"}], 
         StyleBox["\[IndentingNewLine]",
          FontColor->GrayLevel[0.5]], 
         RowBox[{"newm", "=", "t"}], ";", 
         StyleBox["\[IndentingNewLine]",
          FontColor->GrayLevel[0.5]], 
         StyleBox["\[IndentingNewLine]",
          FontColor->GrayLevel[0.5]], 
         RowBox[{
          StyleBox["(*",
           FontColor->GrayLevel[0.5]], 
          RowBox[{
           StyleBox["Extract",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["tensor",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["components",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->GrayLevel[0.5]], 
           StyleBox["and",
            FontColor->GrayLevel[0.5]], 
           StyleBox[" ",
            FontColor->GrayLevel[0.5]], 
           StyleBox["perform",
            FontColor->GrayLevel[0.5]], 
           StyleBox[" ",
            FontColor->GrayLevel[0.5]], 
           StyleBox["it",
            FontColor->GrayLevel[0.5]], 
           StyleBox[" ",
            FontColor->GrayLevel[0.5]], 
           StyleBox["in",
            FontColor->GrayLevel[0.5]], 
           StyleBox[" ",
            FontColor->GrayLevel[0.5]], 
           StyleBox["new",
            FontColor->GrayLevel[0.5]], 
           StyleBox[" ",
            FontColor->GrayLevel[0.5]], 
           StyleBox[
            RowBox[{"coord", ".", " ", "We"}],
            FontColor->GrayLevel[0.5]], 
           StyleBox[" ",
            FontColor->GrayLevel[0.5]], 
           StyleBox[
            RowBox[{"haven", "'"}],
            FontColor->GrayLevel[0.5]], 
           StyleBox["t",
            FontColor->GrayLevel[0.5]], 
           StyleBox[" ",
            FontColor->GrayLevel[0.5]], 
           StyleBox["contract",
            FontColor->GrayLevel[0.5]], 
           StyleBox[" ",
            FontColor->GrayLevel[0.5]], 
           StyleBox["with",
            FontColor->GrayLevel[0.5]], 
           StyleBox[" ",
            FontColor->GrayLevel[0.5]], 
           StyleBox["Jacobians",
            FontColor->GrayLevel[0.5]], 
           StyleBox[" ",
            FontColor->GrayLevel[0.5]], 
           StyleBox[
            RowBox[{"yet", "."}],
            FontColor->GrayLevel[0.5]]}], 
          StyleBox["*)",
           FontColor->GrayLevel[0.5]]}], "\[IndentingNewLine]", 
         RowBox[{"mx", "=", 
          RowBox[{
           RowBox[{"TensorComponents", "[", "t", "]"}], "/.", "ct"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            StyleBox["\"\<Do\>\"",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["for",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["idxl",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[
             RowBox[{"(", 
              RowBox[{"rank", " ", "number"}], ")"}],
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            RowBox[{
             StyleBox["times",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[":",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 1]], "\[IndentingNewLine]", 
             RowBox[{
             "Contract", " ", "with", " ", "Jacobians", " ", "by", " ", 
              RowBox[{"hand", ".", " ", 
               StyleBox["If",
                FontColor->RGBColor[1, 0, 1]]}], " ", "current", " ", 
              "executed", " ", "index", " ", "is", " ", "an", " ", 
              StyleBox["upper",
               FontColor->RGBColor[1, 0, 1]], 
              StyleBox[" ",
               FontColor->RGBColor[1, 0, 1]], 
              StyleBox["index",
               FontColor->RGBColor[1, 0, 1]]}]}]}], ",", " ", 
           RowBox[{"contract", " ", "with", " ", "an", " ", 
            StyleBox["inverse",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            RowBox[{
             StyleBox["Jacobian",
              FontColor->RGBColor[1, 0, 1]], ".", " ", "If"}], " ", 
            RowBox[{"it", "'"}], "s", " ", "a", " ", 
            StyleBox["lower",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["index",
             FontColor->RGBColor[1, 0, 1]]}], ",", " ", 
           RowBox[{"contract", " ", "with", " ", "a", " ", 
            RowBox[{
             StyleBox["Jacobian",
              FontColor->RGBColor[1, 0, 1]], "."}]}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Which", "[", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"If", " ", 
               RowBox[{"it", "'"}], "s", " ", "upper", " ", "index"}], ",", 
              " ", 
              RowBox[{"and", " ", "in", " ", "coordinate", " ", "basis"}]}], 
             "*)"}], 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Sgn", "[", 
                RowBox[{
                "indices", "\[LeftDoubleBracket]", "s", 
                 "\[RightDoubleBracket]"}], "]"}], "===", "1"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"OverHatSgn", "[", 
                 RowBox[{
                 "indices", "\[LeftDoubleBracket]", "s", 
                  "\[RightDoubleBracket]"}], "]"}], "===", 
                RowBox[{"-", "1"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"mx", "=", 
              RowBox[{"Which", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"s", "<", "idxl"}], ",", 
                RowBox[{"Transpose", "[", 
                 RowBox[{
                  RowBox[{"TensorContract", "[", 
                   RowBox[{
                    RowBox[{"TensorProduct", "[", 
                    RowBox[{"mx", ",", 
                    RowBox[{"(*", 
                    RowBox[{"Contract", " ", 
                    RowBox[{"w", "/", " ", 
                    StyleBox["inverse",
                    FontColor->RGBColor[1, 0, 1]]}], 
                    StyleBox[" ",
                    FontColor->RGBColor[1, 0, 1]], 
                    StyleBox["jacobian",
                    FontColor->RGBColor[1, 0, 1]]}], "*)"}], "invjacobm"}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{"idxl", "+", "1"}]}], "}"}], "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"s", "-", "1"}]}], "]"}]}], ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"s", "+", "1"}], ",", "idxl"}], "]"}]}], ",", 
                    "s"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{"Least", " ", "index", " ", 
                  RowBox[{"doesn", "'"}], "t", " ", "need", " ", "a", " ", 
                  RowBox[{"Transpose", "."}]}], "*)"}], 
                RowBox[{"s", "===", "idxl"}], ",", 
                RowBox[{"TensorContract", "[", 
                 RowBox[{
                  RowBox[{"TensorProduct", "[", 
                   RowBox[{"mx", ",", 
                    RowBox[{"(*", 
                    RowBox[{"Contract", " ", 
                    RowBox[{"w", "/", " ", 
                    StyleBox["inverse",
                    FontColor->RGBColor[1, 0, 1]]}], 
                    StyleBox[" ",
                    FontColor->RGBColor[1, 0, 1]], 
                    StyleBox["jacobian",
                    FontColor->RGBColor[1, 0, 1]]}], "*)"}], "invjacobm"}], 
                   "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{"idxl", "+", "1"}]}], "}"}], "}"}]}], "]"}]}], 
               "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"If", " ", 
                RowBox[{"it", "'"}], "s", " ", "lower", " ", "index"}], ",", 
               " ", 
               RowBox[{"and", " ", "in", " ", "coordinate", " ", "basis"}]}], 
              "*)"}], 
             RowBox[{
              RowBox[{
               RowBox[{"Sgn", "[", 
                RowBox[{
                "indices", "\[LeftDoubleBracket]", "s", 
                 "\[RightDoubleBracket]"}], "]"}], "===", 
               RowBox[{"-", "1"}]}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"OverHatSgn", "[", 
                 RowBox[{
                 "indices", "\[LeftDoubleBracket]", "s", 
                  "\[RightDoubleBracket]"}], "]"}], "===", 
                RowBox[{"-", "1"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"mx", "=", 
              RowBox[{"Which", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"s", "<", "idxl"}], ",", 
                RowBox[{"Transpose", "[", 
                 RowBox[{
                  RowBox[{"TensorContract", "[", 
                   RowBox[{
                    RowBox[{"TensorProduct", "[", 
                    RowBox[{"mx", ",", 
                    RowBox[{"(*", 
                    RowBox[{"Contract", " ", 
                    RowBox[{"w", "/", 
                    StyleBox[" ",
                    FontColor->RGBColor[1, 0, 1]], 
                    StyleBox["jacobian",
                    FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], "jacobm"}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{"idxl", "+", "1"}]}], "}"}], "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"s", "-", "1"}]}], "]"}]}], ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"s", "+", "1"}], ",", "idxl"}], "]"}]}], ",", 
                    "s"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{"Least", " ", "index", " ", 
                  RowBox[{"doesn", "'"}], "t", " ", "need", " ", "a", " ", 
                  RowBox[{"Transpose", "."}]}], "*)"}], 
                RowBox[{"s", "===", "idxl"}], ",", 
                RowBox[{"TensorContract", "[", 
                 RowBox[{
                  RowBox[{"TensorProduct", "[", 
                   RowBox[{"mx", ",", 
                    RowBox[{"(*", 
                    RowBox[{"Contract", " ", 
                    RowBox[{"w", "/", 
                    StyleBox[" ",
                    FontColor->RGBColor[1, 0, 1]], 
                    StyleBox["jacobian",
                    FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], "jacobm"}], 
                   "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{"idxl", "+", "1"}]}], "}"}], "}"}]}], "]"}]}], 
               "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "1", ",", "idxl"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Determine", " ", "the", " ", "output", " ", 
           StyleBox["TensorName",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"name", "=", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"If", " ", "OptionValue", " ", "is", " ", "an", " ", 
              RowBox[{"integer", ".", " ", "That"}], " ", "is"}], ",", " ", 
             RowBox[{"user", " ", 
              RowBox[{"didn", "'"}], "t", " ", "specified", " ", 
              RowBox[{"it", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"OptionValue", "[", "TensorName", "]"}], ",", 
              "_Integer"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Inherit", " ", "from", " ", "old", " ", 
              RowBox[{"tensor", "."}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"TensorName", "[", "t", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"If", " ", "user", " ", "specified", " ", 
              RowBox[{"it", "."}]}], "*)"}], "\[IndentingNewLine]", "True", 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Specify", " ", "it", " ", "to", " ", "be", " ", 
              RowBox[{"OptionValue", "."}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"OptionValue", "[", "TensorName", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Determine", " ", "the", " ", "output", " ", 
           StyleBox["StartIndex",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"si", "=", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "If", " ", "OptionValue", " ", "is", " ", "\"\<not\>\"", " ", 
              "an", " ", 
              RowBox[{"integer", ".", " ", "That"}], " ", "is"}], ",", " ", 
             RowBox[{"user", " ", 
              RowBox[{"didn", "'"}], "t", " ", "specified", " ", 
              RowBox[{"it", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"OptionValue", "[", "StartIndex", "]"}], ",", 
               "_Integer"}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Inherit", " ", "from", " ", "old", " ", 
              RowBox[{"tensor", "."}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"StartIndex", "[", "t", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"If", " ", "user", " ", "specified", " ", 
              RowBox[{"it", "."}]}], "*)"}], "\[IndentingNewLine]", "True", 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Specify", " ", "it", " ", "to", " ", "be", " ", 
              RowBox[{"OptionValue", "."}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"OptionValue", "[", "StartIndex", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "Replace", " ", "new", " ", "Tensor", " ", "with", " ", "new", " ", 
            StyleBox["TensorComponents",
             FontColor->RGBColor[1, 0, 1]]}], 
           StyleBox[",",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["TensorName",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], "and", 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            RowBox[{
             StyleBox["StartIndex",
              FontColor->RGBColor[1, 0, 1]], "."}]}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"newm", "=", 
          RowBox[{"newm", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorComponents", "\[Rule]", "m_"}], ")"}], 
              "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"TensorComponents", "\[Rule]", "mx"}], "//", 
                RowBox[{
                "OptionValue", "[", "CoordinateTransformationOperator", 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorName", "\[Rule]", "tn_"}], ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"TensorName", "\[Rule]", "name"}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"StartIndex", "\[Rule]", "st_"}], ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"StartIndex", "\[Rule]", "si"}], ")"}]}]}], 
            "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Determine", " ", "the", " ", "output", " ", 
           StyleBox["Indices",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Default", " ", "value", " ", "is", " ", "a", " ", "null", " ", 
            RowBox[{"list", ".", " ", 
             RowBox[{"Search", ":", " ", 
              RowBox[{
              "\"\<Options[CoordinateTransformation]\>\"", 
               "\[IndentingNewLine]", "User", " ", "should", " ", "input", 
               " ", "a", " ", "list", " ", 
               RowBox[{"w", "/", " ", "its"}], " ", "length", " ", "equals", 
               " ", "to", " ", "the", " ", "rank", " ", "of", " ", 
               RowBox[{"tensor", "."}]}]}]}]}], "\[IndentingNewLine]", "*)"}],
           "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "If", " ", "user", " ", "input", " ", "a", " ", "proper", " ", 
            StyleBox["new",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["indices",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["list",
             FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"OptionValue", "[", "Indices", "]"}], "]"}], "===", 
            "idxl"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Make", " ", "it", " ", "become", " ", 
             RowBox[{"OptionValue", "."}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"indices", "=", 
            RowBox[{"OptionValue", "[", "Indices", "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"newm", "=", 
          RowBox[{"newm", "/.", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "idx_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "indices"}], ")"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           StyleBox["TooltipDisplay",
            FontColor->RGBColor[1, 0, 1]], " ", "and", " ", 
           StyleBox["TooltipStyle",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}], "=!=", 
            "Null"}], ",", 
           RowBox[{"newm", "=", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"TooltipDisplayNoPart", "[", "newm", "]"}], "===", 
                RowBox[{"{", "}"}]}], ")"}], ",", 
              RowBox[{"Append", "[", 
               RowBox[{"newm", ",", 
                RowBox[{"TooltipDisplay", "\[Rule]", 
                 RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}]}], 
               "]"}], ",", "True", ",", 
              RowBox[{"newm", "/.", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"TooltipDisplay", "\[Rule]", "td_"}], ")"}], 
                "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"TooltipDisplay", "\[Rule]", 
                  RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], 
                 ")"}]}]}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
            RowBox[{"{", 
             RowBox[{"(*", "Small", "*)"}], "}"}]}], ",", 
           RowBox[{"newm", "=", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"TooltipStyleNoPart", "[", "newm", "]"}], "===", 
                RowBox[{"{", "}"}]}], ")"}], ",", 
              RowBox[{"Append", "[", 
               RowBox[{"newm", ",", 
                RowBox[{"TooltipStyle", "\[Rule]", 
                 RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}]}], "]"}],
               ",", "True", ",", 
              RowBox[{"newm", "/.", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"TooltipStyle", "\[Rule]", "tts_"}], ")"}], 
                "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"TooltipStyle", "\[Rule]", 
                  RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], 
                 ")"}]}]}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          StyleBox[
           RowBox[{"Final", " ", "output"}],
           FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
         "newm"}]}], "\[IndentingNewLine]", "]"}], 
      RowBox[{"(*", 
       RowBox[{"Check", " ", "the", " ", "OptionValue", " ", "for", " ", 
        StyleBox["indices",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["list",
         FontColor->RGBColor[1, 0, 1]], " ", "is", " ", 
        RowBox[{"OK", ".", " ", 
         RowBox[{"It", "'"}]}], "s", " ", "should", " ", "be", " ", "a", " ", 
        StyleBox["list",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["with",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["same",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["sign",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["of",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["original",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["indices",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["list",
         FontColor->RGBColor[1, 0, 1]], " ", "or", " ", "a", " ", 
        StyleBox["null",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["list",
         FontColor->RGBColor[1, 0, 1]]}], "*)"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
            RowBox[{"OptionValue", "[", "Indices", "]"}]}], ")"}], "===", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
            RowBox[{"Indices", "[", "t", "]"}]}], ")"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
           RowBox[{"OptionValue", "[", "Indices", "]"}]}], "===", 
          RowBox[{"{", "}"}]}], ")"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "CoordinateTransformation", " ", "to", " ", "one", " ", "with", " ", 
     StyleBox["different",
      FontColor->RGBColor[0.5, 0, 0.5]], " ", "symbols", " ", 
     RowBox[{"(", 
      StyleBox[
       RowBox[{
       "Other", " ", "than", " ", "Metric", " ", "and", " ", "Christoffel"}],
       FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CoordinateTransformation", "[", 
       RowBox[{
        RowBox[{"t_Tensor", "/;", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"TensorTypeNoPart", "[", "t", "]"}], ",", 
            RowBox[{"(", 
             RowBox[{"\"\<Metric\>\"", "|", "\"\<ChristoffelSymbols\>\""}], 
             ")"}]}], "]"}], "===", 
          RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", ",", 
        RowBox[{"ct", ":", 
         RowBox[{"{", 
          RowBox[{"Repeated", "[", 
           RowBox[{"Rule", "[", 
            RowBox[{"_Symbol", ",", "_"}], "]"}], "]"}], "}"}]}], ",", 
        RowBox[{"newcoords", ":", 
         RowBox[{"{", 
          RowBox[{"Repeated", "[", "_Symbol", "]"}], "}"}]}], ",", 
        RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{"check", " ", "same", " ", "coordinates"}], " ", "*)"}], 
         RowBox[{
          RowBox[{"Sort", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "&"}], "/@", "ct"}], "]"}], "===", 
          RowBox[{"Sort", "[", 
           RowBox[{"Coordinates", "[", "t", "]"}], "]"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", "ct", "]"}], "===", 
          RowBox[{"Length", "[", "newcoords", "]"}]}], ")"}]}], ")"}]}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "coords", ",", "lgth", ",", "jacobm", ",", "invjacobm", ",", 
          "jacobT", ",", "invjacobT", ",", "R", ",", "dlist", ",", "drhs", 
          ",", "lgthrhs", ",", "indices", ",", "idxl", ",", "newm", ",", 
          "name", ",", "si", ",", "m", ",", "mx", ",", "tensorproduct", ",", 
          "allindices", ",", "j", ",", "s", ",", "l"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"indices", "=", 
          RowBox[{"RemoveUnderBarredIndices", "[", 
           RowBox[{"Indices", "[", "t", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           StyleBox["Rank",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["number",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[":",
             FontColor->RGBColor[1, 0, 1]], " ", 
            RowBox[{"indices", " ", 
             RowBox[{"list", "'"}], "s", " ", "length"}]}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"idxl", "=", 
          RowBox[{"Length", "[", "indices", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           StyleBox["Dimension",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[":",
            FontColor->RGBColor[1, 0, 1]], " ", 
           RowBox[{
           "length", " ", "of", " ", "coordinates", " ", "transformation", 
            " ", "list"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"lgth", "=", 
          RowBox[{"Length", "[", "ct", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"lgthrhs", "=", 
          RowBox[{"Length", "[", "newcoords", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Extract", " ", 
           StyleBox["old",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["coordinates",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"coords", "=", 
          RowBox[{"Coordinates", "[", "t", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Generate", " ", "a", " ", 
           StyleBox["list",
            FontColor->RGBColor[1, 0, 1]], " ", "with", " ", 
           RowBox[{"\[DifferentialD]", " ", "in"}], " ", "front", " ", "of", 
           " ", 
           RowBox[{"coordinates", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"dlist", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"\[DifferentialD]", 
             RowBox[{
             "coords", "\[LeftDoubleBracket]", "#", 
              "\[RightDoubleBracket]"}]}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", "lgth"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Generate", " ", "a", " ", 
           StyleBox["list",
            FontColor->RGBColor[1, 0, 1]], " ", "with", " ", 
           RowBox[{"\[DifferentialD]", " ", "in"}], " ", "front", " ", "of", 
           " ", 
           RowBox[{"newcoords", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"drhs", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"\[DifferentialD]", 
             RowBox[{
             "newcoords", "\[LeftDoubleBracket]", "#", 
              "\[RightDoubleBracket]"}]}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", "lgthrhs"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"R", ":", " ", 
           RowBox[{"Jacobian", " ", "replacement", " ", "rule", " ", 
            RowBox[{"list", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"R", "=", 
          RowBox[{"CoordinateTransformation", "[", 
           RowBox[{"ct", ",", "newcoords"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Generate", " ", 
           StyleBox["Jacobian",
            FontColor->RGBColor[1, 0, 1]], " ", "as", " ", 
           StyleBox["d",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["*",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["d",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["matrix",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["form",
             FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"jacobm", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Coefficient", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "dlist", "\[LeftDoubleBracket]", "a", 
                "\[RightDoubleBracket]"}], "/.", "R"}], ",", 
              RowBox[{
              "drhs", "\[LeftDoubleBracket]", "b", 
               "\[RightDoubleBracket]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "1", ",", "lgth"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", "1", ",", "lgthrhs"}], "}"}]}], "]"}]}], ";", 
         RowBox[{"(*", 
          RowBox[{"Generate", " ", 
           StyleBox["inverse",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["Jacobian",
            FontColor->RGBColor[1, 0, 1]], " ", "as", " ", "d", "*", "d", " ",
            "matrix", " ", 
           RowBox[{"form", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"invjacobm", "=", 
          RowBox[{"Transpose", "[", 
           RowBox[{"Inverse", "[", "jacobm", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           StyleBox["New",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["tensor",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[":",
             FontColor->RGBColor[1, 0, 1]], " ", 
            RowBox[{"Inherit", " ", "property", " ", "form", " ", "old", " ", 
             RowBox[{"one", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"newm", "=", "t"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           StyleBox["Extract",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["tensor",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["components",
            FontColor->RGBColor[1, 0, 1]], " ", "and", " ", "perform", " ", 
           "it", " ", "in", " ", "new", " ", 
           RowBox[{"coord", ".", " ", "We"}], " ", 
           RowBox[{"haven", "'"}], "t", " ", "contract", " ", "with", " ", 
           "Jacobians", " ", 
           RowBox[{"yet", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"mx", "=", 
          RowBox[{
           RowBox[{"TensorComponents", "[", "t", "]"}], "/.", "ct"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            StyleBox["\"\<Do\>\"",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["for",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["idxl",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[
             RowBox[{"(", 
              RowBox[{"rank", " ", "number"}], ")"}],
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            RowBox[{
             StyleBox["times",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[":",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 1]], "\[IndentingNewLine]", 
             RowBox[{
             "Contract", " ", "with", " ", "Jacobians", " ", "by", " ", 
              RowBox[{"hand", ".", " ", 
               StyleBox["If",
                FontColor->RGBColor[1, 0, 1]]}], " ", "current", " ", 
              "executed", " ", "index", " ", "is", " ", "an", " ", 
              StyleBox["upper",
               FontColor->RGBColor[1, 0, 1]], 
              StyleBox[" ",
               FontColor->RGBColor[1, 0, 1]], 
              StyleBox["index",
               FontColor->RGBColor[1, 0, 1]]}]}]}], ",", " ", 
           RowBox[{"contract", " ", "with", " ", "an", " ", 
            StyleBox["inverse",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            RowBox[{
             StyleBox["Jacobian",
              FontColor->RGBColor[1, 0, 1]], ".", " ", "If"}], " ", 
            RowBox[{"it", "'"}], "s", " ", "a", " ", 
            StyleBox["lower",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["index",
             FontColor->RGBColor[1, 0, 1]]}], ",", " ", 
           RowBox[{"contract", " ", "with", " ", "a", " ", 
            RowBox[{
             StyleBox["Jacobian",
              FontColor->RGBColor[1, 0, 1]], "."}]}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Which", "[", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"If", " ", 
               RowBox[{"it", "'"}], "s", " ", "upper", " ", "index"}], ",", 
              " ", 
              RowBox[{"and", " ", "in", " ", "coordinate", " ", "basis"}]}], 
             "*)"}], 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Sgn", "[", 
                RowBox[{
                "indices", "\[LeftDoubleBracket]", "s", 
                 "\[RightDoubleBracket]"}], "]"}], "===", "1"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"OverHatSgn", "[", 
                 RowBox[{
                 "indices", "\[LeftDoubleBracket]", "s", 
                  "\[RightDoubleBracket]"}], "]"}], "===", 
                RowBox[{"-", "1"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"mx", "=", 
              RowBox[{"Which", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"s", "<", "idxl"}], ",", 
                RowBox[{"Transpose", "[", 
                 RowBox[{
                  RowBox[{"TensorContract", "[", 
                   RowBox[{
                    RowBox[{"TensorProduct", "[", 
                    RowBox[{"mx", ",", 
                    RowBox[{"(*", 
                    RowBox[{"Contract", " ", 
                    RowBox[{"w", "/", " ", 
                    StyleBox["inverse",
                    FontColor->RGBColor[1, 0, 1]]}], 
                    StyleBox[" ",
                    FontColor->RGBColor[1, 0, 1]], 
                    StyleBox["jacobian",
                    FontColor->RGBColor[1, 0, 1]]}], "*)"}], "invjacobm"}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{"idxl", "+", "1"}]}], "}"}], "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"s", "-", "1"}]}], "]"}]}], ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"s", "+", "1"}], ",", "idxl"}], "]"}]}], ",", 
                    "s"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{"Least", " ", "index", " ", 
                  RowBox[{"doesn", "'"}], "t", " ", "need", " ", "a", " ", 
                  RowBox[{"Transpose", "."}]}], "*)"}], 
                RowBox[{"s", "===", "idxl"}], ",", 
                RowBox[{"TensorContract", "[", 
                 RowBox[{
                  RowBox[{"TensorProduct", "[", 
                   RowBox[{"mx", ",", 
                    RowBox[{"(*", 
                    RowBox[{"Contract", " ", 
                    RowBox[{"w", "/", " ", 
                    StyleBox["inverse",
                    FontColor->RGBColor[1, 0, 1]]}], 
                    StyleBox[" ",
                    FontColor->RGBColor[1, 0, 1]], 
                    StyleBox["jacobian",
                    FontColor->RGBColor[1, 0, 1]]}], "*)"}], "invjacobm"}], 
                   "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{"idxl", "+", "1"}]}], "}"}], "}"}]}], "]"}]}], 
               "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"If", " ", 
                RowBox[{"it", "'"}], "s", " ", "lower", " ", "index"}], ",", 
               " ", 
               RowBox[{"and", " ", "in", " ", "coordinate", " ", "basis"}]}], 
              "*)"}], 
             RowBox[{
              RowBox[{
               RowBox[{"Sgn", "[", 
                RowBox[{
                "indices", "\[LeftDoubleBracket]", "s", 
                 "\[RightDoubleBracket]"}], "]"}], "===", 
               RowBox[{"-", "1"}]}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"OverHatSgn", "[", 
                 RowBox[{
                 "indices", "\[LeftDoubleBracket]", "s", 
                  "\[RightDoubleBracket]"}], "]"}], "===", 
                RowBox[{"-", "1"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"mx", "=", 
              RowBox[{"Which", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"s", "<", "idxl"}], ",", 
                RowBox[{"Transpose", "[", 
                 RowBox[{
                  RowBox[{"TensorContract", "[", 
                   RowBox[{
                    RowBox[{"TensorProduct", "[", 
                    RowBox[{"mx", ",", 
                    RowBox[{"(*", 
                    RowBox[{"Contract", " ", 
                    RowBox[{"w", "/", 
                    StyleBox[" ",
                    FontColor->RGBColor[1, 0, 1]], 
                    StyleBox["jacobian",
                    FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], "jacobm"}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{"idxl", "+", "1"}]}], "}"}], "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"s", "-", "1"}]}], "]"}]}], ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"s", "+", "1"}], ",", "idxl"}], "]"}]}], ",", 
                    "s"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{"Least", " ", "index", " ", 
                  RowBox[{"doesn", "'"}], "t", " ", "need", " ", "a", " ", 
                  RowBox[{"Transpose", "."}]}], "*)"}], 
                RowBox[{"s", "===", "idxl"}], ",", 
                RowBox[{"TensorContract", "[", 
                 RowBox[{
                  RowBox[{"TensorProduct", "[", 
                   RowBox[{"mx", ",", 
                    RowBox[{"(*", 
                    RowBox[{"Contract", " ", 
                    RowBox[{"w", "/", 
                    StyleBox[" ",
                    FontColor->RGBColor[1, 0, 1]], 
                    StyleBox["jacobian",
                    FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], "jacobm"}], 
                   "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{"idxl", "+", "1"}]}], "}"}], "}"}]}], "]"}]}], 
               "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "1", ",", "idxl"}], "}"}]}], "]"}], ";", 
         StyleBox["\[IndentingNewLine]",
          FontColor->RGBColor[0.6, 0.4, 0.2]], 
         StyleBox["\[IndentingNewLine]",
          FontColor->RGBColor[0.6, 0.4, 0.2]], 
         RowBox[{"(*", 
          RowBox[{"Determine", " ", "the", " ", "output", " ", 
           StyleBox["TensorName",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"name", "=", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"If", " ", "OptionValue", " ", "is", " ", "an", " ", 
              RowBox[{"integer", ".", " ", "That"}], " ", "is"}], ",", " ", 
             RowBox[{"user", " ", 
              RowBox[{"didn", "'"}], "t", " ", "specified", " ", 
              RowBox[{"it", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"OptionValue", "[", "TensorName", "]"}], ",", 
              "_Integer"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Inherit", " ", "from", " ", "old", " ", 
              RowBox[{"tensor", "."}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"TensorName", "[", "t", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"If", " ", "user", " ", "specified", " ", 
              RowBox[{"it", "."}]}], "*)"}], "\[IndentingNewLine]", "True", 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Specify", " ", "it", " ", "to", " ", "be", " ", 
              RowBox[{"OptionValue", "."}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"OptionValue", "[", "TensorName", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Determine", " ", "the", " ", "output", " ", 
           StyleBox["StartIndex",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"si", "=", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "If", " ", "OptionValue", " ", "is", " ", "\"\<not\>\"", " ", 
              "an", " ", 
              RowBox[{"integer", ".", " ", "That"}], " ", "is"}], ",", " ", 
             RowBox[{"user", " ", 
              RowBox[{"didn", "'"}], "t", " ", "specified", " ", 
              RowBox[{"it", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"OptionValue", "[", "StartIndex", "]"}], ",", 
               "_Integer"}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Inherit", " ", "from", " ", "old", " ", 
              RowBox[{"tensor", "."}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"StartIndex", "[", "t", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"If", " ", "user", " ", "specified", " ", 
              RowBox[{"it", "."}]}], "*)"}], "\[IndentingNewLine]", "True", 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Specify", " ", "it", " ", "to", " ", "be", " ", 
              RowBox[{"OptionValue", "."}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"OptionValue", "[", "StartIndex", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "Replace", " ", "new", " ", "Tensor", " ", "with", " ", "new", " ", 
            StyleBox["TensorComponents",
             FontColor->RGBColor[1, 0, 1]]}], 
           StyleBox[",",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["TensorName",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[",",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["  ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["StartIndex",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], "and", 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            RowBox[{
             StyleBox["Coordinates",
              FontColor->RGBColor[1, 0, 1]], "."}]}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"newm", "=", 
          RowBox[{"newm", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorComponents", "\[Rule]", "m_"}], ")"}], 
              "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"TensorComponents", "\[Rule]", "mx"}], "//", 
                RowBox[{
                "OptionValue", "[", "CoordinateTransformationOperator", 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorName", "\[Rule]", "tn_"}], ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"TensorName", "\[Rule]", "name"}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"StartIndex", "\[Rule]", "st_"}], ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"StartIndex", "\[Rule]", "si"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Coordinates", "\[Rule]", "coords"}], ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"Coordinates", "\[Rule]", "newcoords"}], ")"}]}]}], 
            "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Determine", " ", "the", " ", "output", " ", 
           StyleBox["Indices",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Default", " ", "value", " ", "is", " ", "a", " ", "null", " ", 
            RowBox[{"list", ".", " ", 
             RowBox[{"Search", ":", " ", 
              RowBox[{
              "\"\<Options[CoordinateTransformation]\>\"", 
               "\[IndentingNewLine]", "User", " ", "should", " ", "input", 
               " ", "a", " ", "list", " ", 
               RowBox[{"w", "/", " ", "its"}], " ", "length", " ", "equals", 
               " ", "to", " ", "the", " ", "rank", " ", "of", " ", 
               RowBox[{"tensor", "."}]}]}]}]}], "\[IndentingNewLine]", "*)"}],
           "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "If", " ", "user", " ", "input", " ", "a", " ", "proper", " ", 
            StyleBox["new",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["indices",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["list",
             FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"OptionValue", "[", "Indices", "]"}], "]"}], "===", 
            "idxl"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Make", " ", "it", " ", "become", " ", 
             RowBox[{"OptionValue", "."}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"indices", "=", 
            RowBox[{"OptionValue", "[", "Indices", "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"newm", "=", 
          RowBox[{"newm", "/.", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "idx_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "indices"}], ")"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           StyleBox["TooltipDisplay",
            FontColor->RGBColor[1, 0, 1]], " ", "and", " ", 
           StyleBox["TooltipStyle",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}], "=!=", 
            "Null"}], ",", 
           RowBox[{"newm", "=", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"TooltipDisplayNoPart", "[", "newm", "]"}], "===", 
                RowBox[{"{", "}"}]}], ")"}], ",", 
              RowBox[{"Append", "[", 
               RowBox[{"newm", ",", 
                RowBox[{"TooltipDisplay", "\[Rule]", 
                 RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}]}], 
               "]"}], ",", "True", ",", 
              RowBox[{"newm", "/.", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"TooltipDisplay", "\[Rule]", "td_"}], ")"}], 
                "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"TooltipDisplay", "\[Rule]", 
                  RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], 
                 ")"}]}]}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
            RowBox[{"{", 
             RowBox[{"(*", "Small", "*)"}], "}"}]}], ",", 
           RowBox[{"newm", "=", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"TooltipStyleNoPart", "[", "newm", "]"}], "===", 
                RowBox[{"{", "}"}]}], ")"}], ",", 
              RowBox[{"Append", "[", 
               RowBox[{"newm", ",", 
                RowBox[{"TooltipStyle", "\[Rule]", 
                 RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}]}], "]"}],
               ",", "True", ",", 
              RowBox[{"newm", "/.", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"TooltipStyle", "\[Rule]", "tts_"}], ")"}], 
                "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"TooltipStyle", "\[Rule]", 
                  RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], 
                 ")"}]}]}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          StyleBox[
           RowBox[{"Final", " ", "output"}],
           FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
         "newm"}]}], "\[IndentingNewLine]", "]"}], 
      RowBox[{"(*", 
       RowBox[{"Check", " ", "the", " ", "OptionValue", " ", "for", " ", 
        StyleBox["indices",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["list",
         FontColor->RGBColor[1, 0, 1]], " ", "is", " ", 
        RowBox[{"OK", ".", " ", 
         RowBox[{"It", "'"}]}], "s", " ", "should", " ", "be", " ", "a", " ", 
        StyleBox["list",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["with",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["same",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["sign",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["of",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["original",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["indices",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["list",
         FontColor->RGBColor[1, 0, 1]], " ", "or", " ", "a", " ", 
        StyleBox["null",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["list",
         FontColor->RGBColor[1, 0, 1]]}], "*)"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
            RowBox[{"OptionValue", "[", "Indices", "]"}]}], ")"}], "===", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
            RowBox[{"Indices", "[", "t", "]"}]}], ")"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
           RowBox[{"OptionValue", "[", "Indices", "]"}]}], "===", 
          RowBox[{"{", "}"}]}], ")"}]}], ")"}]}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5766860372595043`*^9, 3.5766861748361464`*^9}, {
   3.576686207081403*^9, 3.5766862542090855`*^9}, {3.5766863122567873`*^9, 
   3.576686315220793*^9}, {3.5857176653762712`*^9, 3.5857176751106887`*^9}, {
   3.61152555817948*^9, 3.611525594725541*^9}, {3.6115257192804546`*^9, 
   3.611525732531658*^9}, {3.611525762862624*^9, 3.611525785828477*^9}, {
   3.6115259642452183`*^9, 3.6115259702438107`*^9}, 3.611526048675515*^9, {
   3.611526127082219*^9, 3.6115261313572855`*^9}, {3.6115263381834626`*^9, 
   3.611526346402089*^9}, {3.6115264737210445`*^9, 3.611526481127158*^9}, {
   3.631213472477243*^9, 3.6312135552955914`*^9}, {3.791373775114976*^9, 
   3.791373800937765*^9}, {3.827912458977579*^9, 3.8279124893122497`*^9}, 
   3.8279125450697765`*^9, 3.827913639048354*^9, {3.827914718023213*^9, 
   3.827914730632867*^9}, {3.827914870702771*^9, 3.827914960902944*^9}, {
   3.827915351823187*^9, 3.8279153931428566`*^9}, {3.827915642433074*^9, 
   3.8279156464329634`*^9}, {3.82791627429735*^9, 3.8279163192212067`*^9}, {
   3.827916355209874*^9, 3.827916370600563*^9}, {3.827917825959632*^9, 
   3.8279178423658814`*^9}, {3.827918040476101*^9, 3.827918044022971*^9}, {
   3.8279181179761066`*^9, 3.82791821128867*^9}, {3.827918251788662*^9, 
   3.827918328788662*^9}, {3.8279184441949153`*^9, 3.8279185396011715`*^9}, {
   3.8279186345542946`*^9, 3.82791864131993*^9}, {3.8279194569343395`*^9, 
   3.827919457653086*^9}, {3.828007628885556*^9, 3.8280076434338474`*^9}, {
   3.828007749253744*^9, 3.8280078751287394`*^9}, {3.828008054352151*^9, 
   3.828008069180266*^9}, {3.8280082376977882`*^9, 3.82800860148306*^9}, {
   3.8280086479381714`*^9, 3.828008651016302*^9}, {3.828008723724004*^9, 
   3.8280088660110054`*^9}, {3.828008926760992*^9, 3.8280093348951244`*^9}, {
   3.828009573477728*^9, 3.8280095949621134`*^9}, {3.8280098804844666`*^9, 
   3.828009946828231*^9}, {3.828009994250104*^9, 3.828010006312604*^9}, {
   3.8280100497813463`*^9, 3.8280100658125925`*^9}, {3.8280102095938864`*^9, 
   3.828010220968896*^9}, {3.828010286437642*^9, 3.8280102981876326`*^9}, {
   3.8280104289845123`*^9, 3.8280104612188873`*^9}, {3.8280105411251373`*^9, 
   3.828010667871298*^9}, {3.82801077959798*^9, 3.8280107801292305`*^9}, {
   3.828010919035491*^9, 3.828010952958317*^9}, {3.82804844772398*^9, 
   3.828048455025243*^9}, {3.8280490947247577`*^9, 3.8280491014928956`*^9}, {
   3.8283347921167855`*^9, 3.8283348422773747`*^9}, {3.8283356085788507`*^9, 
   3.8283356762278814`*^9}, {3.8283357193846874`*^9, 
   3.8283357206350765`*^9}, {3.8283359069903383`*^9, 3.828335910564749*^9}, {
   3.8284050988122187`*^9, 3.828405105674838*^9}, {3.828405161364459*^9, 
   3.828405173132292*^9}, {3.8284057004486313`*^9, 3.828405705774969*^9}, {
   3.8284058840786133`*^9, 3.828405895197787*^9}, {3.828406178988365*^9, 
   3.828406179188297*^9}, {3.8284065953612185`*^9, 3.8284066275426598`*^9}, {
   3.828406658493745*^9, 3.8284066720878067`*^9}, {3.828406705927764*^9, 
   3.828406767391438*^9}, {3.8284068701982136`*^9, 3.828406871094491*^9}, {
   3.828406905914282*^9, 3.8284069213375745`*^9}, {3.828407093838346*^9, 
   3.8284070960230455`*^9}, {3.8284072219822025`*^9, 
   3.8284072572474604`*^9}, {3.8284074029942303`*^9, 3.828407431551361*^9}, {
   3.828407771142164*^9, 3.828407771955371*^9}, {3.828407931286438*^9, 
   3.828407997698243*^9}, {3.8284080289012165`*^9, 3.828408047567336*^9}, 
   3.8284081459472895`*^9, {3.8284091606634893`*^9, 3.8284092026975565`*^9}, {
   3.8284092360643215`*^9, 3.828409299543207*^9}, {3.828409645328205*^9, 
   3.8284096470153437`*^9}, 3.8284104947108383`*^9, {3.8284105674692583`*^9, 
   3.82841065933626*^9}, {3.828410726234258*^9, 3.8284107903222494`*^9}, {
   3.82841083106426*^9, 3.8284108336632504`*^9}, {3.8284109386012487`*^9, 
   3.8284109496472483`*^9}, {3.8284109944622617`*^9, 3.828411015127249*^9}, {
   3.8284111857740593`*^9, 3.8284112637016187`*^9}, {3.8284112937912083`*^9, 
   3.828411320087208*^9}, {3.8284113900795603`*^9, 3.8284114495335503`*^9}, {
   3.828411522816216*^9, 3.828411577628216*^9}, {3.8284149339317055`*^9, 
   3.82841493430671*^9}, 3.8284149992172737`*^9, {3.8284366762758217`*^9, 
   3.828436681216711*^9}, {3.828436759726048*^9, 3.8284367755873733`*^9}, {
   3.828436807652364*^9, 3.8284368188164196`*^9}, {3.8284369342234297`*^9, 
   3.828436935595989*^9}, {3.8284370464740257`*^9, 3.8284370588472137`*^9}, 
   3.828437151583248*^9, {3.828437181986457*^9, 3.8284372359951067`*^9}, 
   3.828437451812648*^9, {3.8284377119283333`*^9, 3.8284377326463313`*^9}, {
   3.828437806991333*^9, 3.8284378510863323`*^9}, {3.8284380781833434`*^9, 
   3.8284381947583323`*^9}, {3.828438707743333*^9, 3.828438713790333*^9}, {
   3.828438796107334*^9, 3.8284388049023333`*^9}, {3.8285203769505787`*^9, 
   3.8285204279302626`*^9}, 3.8285205184534707`*^9, {3.828520654747607*^9, 
   3.828520664853598*^9}, 3.8285207315746174`*^9, 3.8287569156916804`*^9, {
   3.828758477195223*^9, 3.8287584775153885`*^9}, {3.8287585606378455`*^9, 
   3.8287586189276147`*^9}, {3.8287586636255884`*^9, 
   3.8287586645655155`*^9}, {3.8287587196575174`*^9, 3.828758737925274*^9}, {
   3.8287587752876277`*^9, 3.8287587755174265`*^9}, {3.8287595652551394`*^9, 
   3.828759616555873*^9}, 3.828760338961844*^9, {3.8294293741559253`*^9, 
   3.829429379235951*^9}, {3.8294340344975643`*^9, 3.8294340690221605`*^9}, {
   3.829434904204796*^9, 3.829434949352758*^9}, {3.8297301092794385`*^9, 
   3.829730140545044*^9}, 3.829730781060157*^9, 3.829731048702461*^9, {
   3.8302989739089756`*^9, 3.8302990014292603`*^9}, {3.8302990947410173`*^9, 
   3.8302991006550846`*^9}, {3.830299244366228*^9, 3.830299249246187*^9}, 
   3.8302993390795903`*^9, {3.830299561541435*^9, 3.830299563139207*^9}, 
   3.830340510819064*^9, {3.830341541182828*^9, 3.8303415415628843`*^9}, {
   3.830341589393078*^9, 3.83034175264839*^9}, 3.830341899988552*^9, {
   3.8303424614368095`*^9, 3.830342485601101*^9}, {3.8309048380244346`*^9, 
   3.8309049067245274`*^9}, {3.8309213201904173`*^9, 3.83092134733004*^9}, {
   3.8309213993803463`*^9, 3.830921399980441*^9}, {3.8309214412300787`*^9, 
   3.83092146427032*^9}, {3.830921505548376*^9, 3.8309215220899634`*^9}, 
   3.8309215817102127`*^9, {3.8309216287152233`*^9, 3.830921637890333*^9}, {
   3.8309476225822287`*^9, 3.8309476338164616`*^9}, {3.8309477980337276`*^9, 
   3.8309478205443945`*^9}, 3.830948429337406*^9, 3.830948536618656*^9, {
   3.830948568728038*^9, 3.83094859572886*^9}, {3.8309486422601023`*^9, 
   3.830948661619489*^9}, {3.8309487134944773`*^9, 3.830948736088661*^9}, {
   3.8309489362008524`*^9, 3.830948946107094*^9}, {3.8309490481852283`*^9, 
   3.830949059403986*^9}, {3.8309492549977245`*^9, 3.830949271294591*^9}, {
   3.8309493579712152`*^9, 3.8309493602837133`*^9}, {3.8309494207084975`*^9, 
   3.8309494771148295`*^9}, {3.8309495361148243`*^9, 3.830949541505448*^9}, {
   3.8309495736929617`*^9, 3.8309496405054474`*^9}, {3.8309499148034906`*^9, 
   3.8309499321785*^9}, 3.8309499812100673`*^9, {3.8309500115382013`*^9, 
   3.8309501195424337`*^9}, {3.830950328533402*^9, 3.830950328799038*^9}, {
   3.8309504088526993`*^9, 3.830950411139549*^9}, {3.8309507072394104`*^9, 
   3.83095070775941*^9}, {3.8309509282641344`*^9, 3.830950932468195*^9}, 
   3.831014826573057*^9, {3.83102868742659*^9, 3.8310286875338182`*^9}, {
   3.831028719731634*^9, 3.8310288508437653`*^9}, {3.8310292222166805`*^9, 
   3.831029223186657*^9}, {3.831029269024783*^9, 3.8310293048463297`*^9}, {
   3.8310293471867056`*^9, 3.831029382015969*^9}, {3.8310294261667013`*^9, 
   3.831029579696822*^9}, {3.831029750416043*^9, 3.8310298665162516`*^9}, {
   3.8310300483061385`*^9, 3.831030072975895*^9}, {3.8310303025861096`*^9, 
   3.8310303357760143`*^9}, {3.831030915036426*^9, 3.8310309501218896`*^9}, {
   3.831031066135521*^9, 3.831031129906371*^9}, 3.831031356536313*^9, {
   3.831031540423958*^9, 3.8310315444712205`*^9}, {3.83103196086119*^9, 
   3.8310320092539015`*^9}, {3.831032092565593*^9, 3.8310321100639725`*^9}, {
   3.8310322155587687`*^9, 3.8310322410664635`*^9}, {3.8310322784847455`*^9, 
   3.83103233050632*^9}, {3.831032364236226*^9, 3.831032378521075*^9}, {
   3.831032434536276*^9, 3.831032509066171*^9}, {3.831032663906209*^9, 
   3.831032688305134*^9}, {3.8310327754365253`*^9, 3.8310327838165383`*^9}, {
   3.8310328254766393`*^9, 3.8310328438161945`*^9}, {3.8310328834161944`*^9, 
   3.831032961776224*^9}, {3.8310332380135903`*^9, 3.8310332465244727`*^9}, {
   3.831033420284458*^9, 3.831033430388455*^9}, {3.8310334658289557`*^9, 
   3.831033472473857*^9}, {3.831033542176526*^9, 3.831033543396283*^9}, 
   3.831033739041902*^9, {3.8310341364697294`*^9, 3.831034172686021*^9}, {
   3.83103422829503*^9, 3.8310342306206484`*^9}, 3.831262232717558*^9, {
   3.831262269070448*^9, 3.831262289977763*^9}, {3.8312623364235067`*^9, 
   3.8312623517407694`*^9}, {3.8312624001235137`*^9, 3.831262452915802*^9}, {
   3.8312629883779125`*^9, 3.8312629911676874`*^9}, {3.8312630237831354`*^9, 
   3.831263040647483*^9}, {3.8312680223474417`*^9, 3.831268060897149*^9}, {
   3.8316777313690643`*^9, 3.8316777343985205`*^9}, {3.8318637657998734`*^9, 
   3.8318637927879753`*^9}, 3.8318643815838184`*^9, {3.831864564783893*^9, 
   3.831864594203931*^9}, {3.831865108424187*^9, 3.831865167464185*^9}, {
   3.8318652013939333`*^9, 3.831865233554014*^9}, {3.833962504338353*^9, 
   3.833962547582133*^9}, {3.833963009299059*^9, 3.833963029328559*^9}, {
   3.83396319352419*^9, 3.8339632206927223`*^9}, {3.833965885496167*^9, 
   3.833965886453918*^9}, {3.8339659350555477`*^9, 3.833965949903954*^9}, {
   3.8339667707638855`*^9, 3.833966788452899*^9}, {3.833967604781613*^9, 
   3.8339676517916126`*^9}, {3.833969285621872*^9, 3.833969316975874*^9}, {
   3.833969582125883*^9, 3.8339695847408743`*^9}, {3.83396990022988*^9, 
   3.8339699058828735`*^9}, {3.8339699784468765`*^9, 
   3.8339699863398733`*^9}, {3.833972613034884*^9, 3.833972644322872*^9}, {
   3.833972839904875*^9, 3.833972863545876*^9}, {3.833972940100874*^9, 
   3.8339729681845737`*^9}, 3.833973016978561*^9, {3.8339730546345625`*^9, 
   3.8339730556525745`*^9}, {3.834180272513849*^9, 3.834180336335994*^9}, {
   3.834180805546956*^9, 3.834180812339955*^9}, {3.834457257887797*^9, 
   3.8344573310596733`*^9}, {3.8344574676356373`*^9, 3.834457467996637*^9}, {
   3.8344576376120844`*^9, 3.8344576482821984`*^9}, {3.834460213821*^9, 
   3.834460215672103*^9}, 3.8346283508222275`*^9, {3.8346283895746064`*^9, 
   3.8346284029610076`*^9}, 3.8346284370614023`*^9, {3.8346327977895436`*^9, 
   3.834632798799369*^9}, {3.8346328440642424`*^9, 3.834632845264633*^9}, {
   3.835242907414958*^9, 3.8352429666850004`*^9}, {3.8364791035191293`*^9, 
   3.8364791121190343`*^9}, {3.83647920253152*^9, 3.8364792036038857`*^9}, {
   3.837837965698539*^9, 3.8378379680020175`*^9}, {3.8378382110275173`*^9, 
   3.8378382123691273`*^9}, {3.8381960890654964`*^9, 3.8381960894090242`*^9}, 
   3.838196171737731*^9, {3.838196247984604*^9, 3.838196253612496*^9}, {
   3.838887523338541*^9, 3.8388875771233654`*^9}, {3.838887624362226*^9, 
   3.838887655556985*^9}, {3.8388892098186026`*^9, 3.838889244194047*^9}, {
   3.838891540789715*^9, 3.838891544365509*^9}, {3.838892674002588*^9, 
   3.8388927518105397`*^9}, {3.838892803126495*^9, 3.8388928756638455`*^9}, {
   3.8388930475408263`*^9, 3.838893058755906*^9}, {3.8388930964436593`*^9, 
   3.8388931431848297`*^9}, {3.838893175499895*^9, 3.838893215866125*^9}, 
   3.838893845317069*^9, 3.838893940671934*^9, {3.838894200894449*^9, 
   3.8388942570408125`*^9}, {3.838894332755803*^9, 3.8388943329476857`*^9}, {
   3.838941180885867*^9, 3.838941194607026*^9}, {3.8389412251394434`*^9, 
   3.838941226837389*^9}, {3.8392805313168406`*^9, 3.839280547482416*^9}, {
   3.8392806874069877`*^9, 3.8392809452520313`*^9}, {3.8392810079104924`*^9, 
   3.83928101055124*^9}, {3.839281089654049*^9, 3.839281163118766*^9}, {
   3.839281239265699*^9, 3.8392812413058434`*^9}, {3.839281425844615*^9, 
   3.839281427944659*^9}, 3.8392815210860915`*^9, {3.839281964145401*^9, 
   3.8392819659280005`*^9}, {3.8392822074073315`*^9, 
   3.8392822080716205`*^9}, {3.839282729827943*^9, 3.8392827557113123`*^9}, {
   3.839282896593066*^9, 3.839282897097958*^9}, {3.839283111736799*^9, 
   3.8392831306866255`*^9}, {3.839283262465818*^9, 3.8392832784952354`*^9}, {
   3.83928420339861*^9, 3.839284224475358*^9}, {3.839284396394966*^9, 
   3.8392844085226*^9}, {3.8392844516223345`*^9, 3.8392844702421885`*^9}, {
   3.8392845558335457`*^9, 3.8392845584913993`*^9}, {3.8392846224409676`*^9, 
   3.839284628860804*^9}, {3.839284674890489*^9, 3.8392846978552947`*^9}, {
   3.8392852121318064`*^9, 3.8392852151814604`*^9}, 3.8392852580466638`*^9, {
   3.839285477495301*^9, 3.839285479184744*^9}, {3.839285678193797*^9, 
   3.8392856976085386`*^9}, {3.839285756387545*^9, 3.839285785183031*^9}, {
   3.851658978203777*^9, 3.851658994940258*^9}, {3.851659126095993*^9, 
   3.851659622122744*^9}, {3.851659776168416*^9, 3.8516599101628704`*^9}, {
   3.851659986489764*^9, 3.8516600124995203`*^9}, {3.85166005248201*^9, 
   3.851660060595397*^9}, {3.8516601313099756`*^9, 3.8516604069253397`*^9}, {
   3.851660482317264*^9, 3.8516604832712617`*^9}, {3.851660887323453*^9, 
   3.8516608901663084`*^9}, {3.8517341400636377`*^9, 3.851734186078158*^9}, {
   3.851734223643094*^9, 3.85173435830378*^9}, {3.8517344200828123`*^9, 
   3.851734472910993*^9}, {3.8517349363695*^9, 3.851734971646268*^9}, {
   3.8517350177415247`*^9, 3.851735104863488*^9}, {3.851735151683819*^9, 
   3.8517352117430077`*^9}, {3.8517353069438043`*^9, 
   3.8517353397954493`*^9}, {3.8517354904365554`*^9, 3.851735561383322*^9}, {
   3.851736070593397*^9, 3.851736105319126*^9}, {3.8517432952231894`*^9, 
   3.851743327325602*^9}, {3.8517434950515137`*^9, 3.8517434954695144`*^9}, {
   3.8517440713349266`*^9, 3.851744075232585*^9}, 3.8517480227824287`*^9, {
   3.851748115684579*^9, 3.851748123175583*^9}, 3.851748218518067*^9, {
   3.851748284162365*^9, 3.851748358822221*^9}, {3.851748391625774*^9, 
   3.8517486061179605`*^9}, {3.851748673340125*^9, 3.851748735689648*^9}, {
   3.8517488229570475`*^9, 3.85174883721066*^9}, {3.8519387674936323`*^9, 
   3.851938767668525*^9}, {3.851940258107381*^9, 3.8519402585091352`*^9}, {
   3.8519402947399745`*^9, 3.851940377746262*^9}, {3.851946340395294*^9, 
   3.85194638382277*^9}, {3.851946477093151*^9, 3.851946563588671*^9}, {
   3.8519466712617035`*^9, 3.8519466882778206`*^9}, {3.851946738077052*^9, 
   3.851946826228301*^9}, 3.851946873052717*^9, {3.851946923411469*^9, 
   3.8519472542320647`*^9}, 3.8519475491628857`*^9, {3.8519849413919263`*^9, 
   3.851984957049289*^9}, {3.852001517456498*^9, 3.8520015509011993`*^9}, {
   3.85200243434173*^9, 3.8520024688293777`*^9}, {3.852003061147726*^9, 
   3.852003074099679*^9}, {3.852004534219987*^9, 3.852004607489092*^9}, {
   3.8520082970798283`*^9, 3.852008307267228*^9}, {3.8540818416427555`*^9, 
   3.854081857122717*^9}, {3.8540818924229403`*^9, 3.854081892602889*^9}, {
   3.8599318563534193`*^9, 3.8599319353334403`*^9}, {3.8599319703592615`*^9, 
   3.859932047793455*^9}, {3.8599321050834837`*^9, 3.8599321154134912`*^9}, 
   3.8599321490735636`*^9, 3.859932990773585*^9, {3.8599330220337305`*^9, 
   3.859933046733574*^9}, {3.8599335174036903`*^9, 3.8599335451936464`*^9}, {
   3.865122271908385*^9, 3.8651222746271276`*^9}, {3.865122378517753*^9, 
   3.8651223860958834`*^9}, 3.865122429705253*^9, {3.8651225482540607`*^9, 
   3.865122657410304*^9}, {3.8651227171603107`*^9, 3.865122778160304*^9}, {
   3.865123148929227*^9, 3.8651232932023582`*^9}, {3.8651233588742285`*^9, 
   3.8651233681086*^9}, {3.8651234497179813`*^9, 3.8651234680929756`*^9}, {
   3.8651242046230936`*^9, 3.8651242126074753`*^9}, {3.8651244893447638`*^9, 
   3.865124491922883*^9}, {3.8651246302967834`*^9, 3.8651246413749027`*^9}, {
   3.8651248838471093`*^9, 3.865124885284616*^9}, {3.865124942463504*^9, 
   3.865124993418477*^9}, {3.865125465319874*^9, 3.8651255279627037`*^9}, {
   3.865125719141808*^9, 3.8651257385930653`*^9}, {3.865126334131736*^9, 
   3.8651263443877373`*^9}, 3.8651264539967237`*^9, {3.86546474902944*^9, 
   3.865464768736432*^9}, {3.8654827408866777`*^9, 3.8654828285760202`*^9}, {
   3.8654833888761053`*^9, 3.8654833933961964`*^9}, {3.865484093594002*^9, 
   3.8654841164539404`*^9}, {3.869287959062497*^9, 3.8692880345388403`*^9}, {
   3.869288076060412*^9, 3.8692881171983852`*^9}, {3.8692881814279604`*^9, 
   3.869288223067765*^9}, {3.869288253155406*^9, 3.8692882618770647`*^9}, {
   3.8692884764527645`*^9, 3.8692884966623898`*^9}, {3.8692885273945723`*^9, 
   3.8692885439404373`*^9}, {3.8692888136673517`*^9, 3.869288880667324*^9}, {
   3.8733425546472316`*^9, 3.8733425678816004`*^9}, {3.875757246963869*^9, 
   3.875757357706275*^9}, {3.8757594395132036`*^9, 3.875759444000308*^9}, {
   3.887260802724476*^9, 3.8872608153676753`*^9}, {3.8872609073875027`*^9, 
   3.8872609226032295`*^9}, {3.8872609562524853`*^9, 
   3.8872610418740244`*^9}, {3.8872610860867677`*^9, 3.8872611335278587`*^9}, 
   3.8890738325792713`*^9, {3.8950732616938667`*^9, 3.8950732617563653`*^9}, {
   3.8955490518555946`*^9, 3.895549051923224*^9}, {3.8983839823857994`*^9, 
   3.8983840203975215`*^9}, {3.8983841520479345`*^9, 
   3.8983841549072256`*^9}, {3.898384329375219*^9, 3.898384357374138*^9}, {
   3.967777452187965*^9, 3.9677774523081675`*^9}, 3.970797770249814*^9, 
   3.9707982274981833`*^9, 3.970798393043811*^9, 3.9707997820644484`*^9, {
   3.970800817660363*^9, 3.9708008180445557`*^9}, {3.97531369409086*^9, 
   3.975313904020756*^9}},ExpressionUUID->"b3e7bd08-1c18-4283-aced-\
4e7fd0095136"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Coordinate", " ", "transform", " ", "a", " ", "metric"}],
    FontColor->RGBColor[0.5, 0, 0.5]], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Enter", " ", "r"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", " ", "\[Rule]", " ", 
       RowBox[{"f1", "[", 
        RowBox[{"x", ",", "y", ",", "z", ",", "..."}], "]"}]}], ",", " ", 
      RowBox[{"y", " ", "\[Rule]", " ", 
       RowBox[{"f2", "[", 
        RowBox[{"x", ",", "y", ",", "z", ",", "..."}], "]"}]}], ",", " ", 
      RowBox[{"z", " ", "\[Rule]", " ", 
       RowBox[{"f3", "[", 
        RowBox[{"x", ",", "y", ",", "z", ",", "..."}], "]"}]}], ",", " ", 
      "..."}], "}"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CoordinateTransformation", "[", 
       RowBox[{"mt_Tensor", ",", 
        RowBox[{"ct", ":", 
         RowBox[{"{", 
          RowBox[{"Repeated", "[", 
           RowBox[{"Rule", "[", 
            RowBox[{"_Symbol", ",", "_"}], "]"}], "]"}], "}"}]}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{"check", " ", "Metric"}], " ", "*)"}], 
         RowBox[{"Quiet", "[", 
          RowBox[{"TestMetricTensor", "[", "mt", "]"}], "]"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{"check", " ", "same", " ", "coordinates"}], " ", "*)"}], 
         RowBox[{
          RowBox[{"Sort", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "&"}], "/@", "ct"}], "]"}], "===", 
          RowBox[{"Sort", "[", 
           RowBox[{"Coordinates", "[", "mt", "]"}], "]"}]}], ")"}], 
        RowBox[{"(*", 
         RowBox[{"No", " ", "OverHat", " ", "Indices"}], "*)"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"OverHatSgn", "[", "#", "]"}], "&"}], "/@", 
             RowBox[{"Indices", "[", "mt", "]"}]}], ",", "1"}], "]"}], "===", 
          RowBox[{"{", "}"}]}], ")"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coords", ",", "i", ",", "j", ",", "ds2", ",", "si", ",", "op", ",", 
         "name", ",", "output", ",", "MetricOp", ",", "ChrOp", ",", "RiemOp", 
         ",", "RicciOp", ",", "RicciSOp"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"extract", " ", "coordinates"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coords", "=", 
         RowBox[{"Coordinates", "[", "mt", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "extract", " ", "StartIndex", " ", "so", " ", "we", " ", "know", " ",
           "what", " ", "to", " ", "sum", " ", "over", " ", "below"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"si", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"OptionValue", "[", "StartIndex", "]"}], ",", 
              "_Integer"}], "]"}]}], ",", 
           RowBox[{"(*", 
            RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
           RowBox[{"StartIndex", "[", "mt", "]"}], ",", "True", ",", 
           RowBox[{"OptionValue", "[", "StartIndex", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "extract", " ", "metric", " ", "in", " ", "the", " ", "form", " ", 
          "of", " ", "coordinate", " ", "differentials"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"ds2", "=", 
         RowBox[{"ToExpressionForm", "[", 
          RowBox[{"Metric", "[", 
           RowBox[{
            RowBox[{"SubMinus", "[", "i", "]"}], ",", 
            RowBox[{"SubMinus", "[", "j", "]"}], ",", "mt"}], "]"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Apply", " ", "CoordinateTransformation"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"op", "=", 
         RowBox[{
         "OptionValue", "[", "CoordinateTransformationOperator", "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"MetricOp", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"OptionValue", "[", "MetricOperator", "]"}], "=!=", 
             "Simplify"}], ")"}], ",", 
           RowBox[{"OptionValue", "[", "MetricOperator", "]"}], ",", "True", 
           ",", "op"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ChrOp", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"OptionValue", "[", "ChristoffelOperator", "]"}], "=!=", 
             "Simplify"}], ")"}], ",", 
           RowBox[{"OptionValue", "[", "ChristoffelOperator", "]"}], ",", 
           "True", ",", "op"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"RiemOp", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"OptionValue", "[", "RiemannOperator", "]"}], "=!=", 
             "Simplify"}], ")"}], ",", 
           RowBox[{"OptionValue", "[", "RiemannOperator", "]"}], ",", "True", 
           ",", "op"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"RicciOp", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"OptionValue", "[", "RicciOperator", "]"}], "=!=", 
             "Simplify"}], ")"}], ",", 
           RowBox[{"OptionValue", "[", "RicciOperator", "]"}], ",", "True", 
           ",", "op"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"RicciSOp", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"OptionValue", "[", "RicciScalarOperator", "]"}], "=!=", 
             "Simplify"}], ")"}], ",", 
           RowBox[{"OptionValue", "[", "RicciScalarOperator", "]"}], ",", 
           "True", ",", "op"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Change", " ", "Name", " ", "for", " ", "Metric"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"name", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"OptionValue", "[", "TensorName", "]"}], ",", 
             "_Integer"}], "]"}], ",", 
           RowBox[{"TensorName", "[", "mt", "]"}], ",", "True", ",", 
           RowBox[{"OptionValue", "[", "TensorName", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ds2", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"ds2", "/.", 
            RowBox[{"CoordinateTransformation", "[", "ct", "]"}]}], ")"}], "//",
           "op"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Re", "-", 
          RowBox[{
          "compute", " ", "Metric", " ", "using", " ", "new", " ", 
           "coordinates"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "ensure", " ", "the", " ", "StartIndex", " ", "and", " ", 
          "TensorName", " ", "are", " ", "brought", " ", "over"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"ds2", "=", 
         RowBox[{"Metric", "[", 
          RowBox[{
           SubscriptBox["i", "-"], ",", 
           SubscriptBox["j", "-"], ",", "ds2", ",", 
           RowBox[{"Coordinates", "\[Rule]", "coords"}], ",", 
           RowBox[{"StartIndex", "\[Rule]", "si"}], ",", 
           RowBox[{"TensorName", "\[Rule]", "name"}], ",", 
           RowBox[{"(*", 
            RowBox[{"20251029", " ", 
             RowBox[{"WH", ":", " ", 
              RowBox[{"Geometrical", " ", 
               RowBox[{"objects", "'"}], " ", "Opertator"}]}]}], "*)"}], 
           RowBox[{"MetricOperator", "->", "MetricOp"}], ",", 
           RowBox[{"ChristoffelOperator", "->", "ChrOp"}], ",", 
           RowBox[{"RiemannOperator", "->", "RiemOp"}], ",", 
           RowBox[{"RicciOperator", "->", "RicciOp"}], ",", 
           RowBox[{"RicciScalarOperator", "->", "RicciSOp"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "output", " ", "with", " ", "the", " ", "same", " ", "indices"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         StyleBox[
          RowBox[{"Change", " ", "Indices", " ", "for", " ", "Metric"}],
          FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Default", " ", "OptionValue", " ", "of", " ", "Indices", " ", "is",
            " ", 
           RowBox[{"{", "}"}]}], ",", " ", 
          RowBox[{
          "whose", " ", "length", " ", "is", " ", "0.", " ", "If", " ", 
           "user", " ", "input", " ", "correctly"}], ",", " ", 
          RowBox[{"change", " ", "it", " ", "for", " ", 
           RowBox[{"them", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"OptionValue", "[", "Indices", "]"}], "]"}], "===", 
             "2"}], ")"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Metric", "[", 
            RowBox[{
             RowBox[{"Sequence", "@@", 
              RowBox[{"OptionValue", "[", "Indices", "]"}]}], ",", "ds2", ",", 
             RowBox[{"TooltipStyle", "\[Rule]", " ", 
              RowBox[{"TooltipStyle", "[", "mt", "]"}]}]}], "]"}], ",", 
           "True", ",", 
           RowBox[{"Metric", "[", 
            RowBox[{
             RowBox[{"Sequence", "@@", 
              RowBox[{"Indices", "[", "mt", "]"}]}], ",", "ds2", ",", 
             RowBox[{"TooltipStyle", "\[Rule]", " ", 
              RowBox[{"TooltipStyle", "[", "mt", "]"}]}]}], "]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          StyleBox["TooltipDisplay",
           FontColor->RGBColor[1, 0, 1]], " ", "and", " ", 
          StyleBox["TooltipStyle",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}], "=!=", 
            "Null"}], ")"}], ",", 
          RowBox[{"output", "=", 
           RowBox[{"TooltipDisplay", "[", 
            RowBox[{"output", ",", 
             RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], "]"}]}]}],
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
            RowBox[{"{", 
             RowBox[{"(*", "Small", "*)"}], "}"}]}], ")"}], ",", 
          RowBox[{"output", "=", 
           RowBox[{"TooltipStyle", "[", 
            RowBox[{"output", ",", 
             RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], "]"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", "output"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Enter", " ", "r"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", " ", "\[Rule]", " ", 
        RowBox[{"f1", "[", 
         RowBox[{
          RowBox[{"x", "'"}], ",", 
          RowBox[{"y", "'"}], ",", 
          RowBox[{"z", "'"}], ",", "..."}], "]"}]}], ",", " ", 
       RowBox[{"y", " ", "\[Rule]", " ", 
        RowBox[{"f2", "[", 
         RowBox[{
          RowBox[{"x", "'"}], ",", 
          RowBox[{"y", "'"}], ",", 
          RowBox[{"z", "'"}], ",", "..."}], "]"}]}], ",", " ", 
       RowBox[{"z", " ", "\[Rule]", " ", 
        RowBox[{"f3", "[", 
         RowBox[{
          RowBox[{"x", "'"}], ",", 
          RowBox[{"y", "'"}], ",", 
          RowBox[{"z", "'"}], ",", "..."}], "]"}]}], ",", " ", "..."}], 
      "}"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"i", ".", "e", ".", " ", "allow"}], " ", "for", " ", "different",
      " ", "names", " ", "on", " ", "the", " ", "RHS", " ", "than", " ", 
     "the", " ", "previous"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CoordinateTransformation", "[", 
       RowBox[{"mt_Tensor", ",", 
        RowBox[{"ct", ":", 
         RowBox[{"{", 
          RowBox[{"Repeated", "[", 
           RowBox[{"Rule", "[", 
            RowBox[{"_Symbol", ",", "_"}], "]"}], "]"}], "}"}]}], ",", 
        RowBox[{"newcoords", ":", 
         RowBox[{"{", 
          RowBox[{"Repeated", "[", "_Symbol", "]"}], "}"}]}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{"check", " ", "Metric"}], " ", "*)"}], 
         RowBox[{"Quiet", "[", 
          RowBox[{"TestMetricTensor", "[", "mt", "]"}], "]"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{"check", " ", "same", " ", "coordinates"}], " ", "*)"}], 
         RowBox[{
          RowBox[{"Sort", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "&"}], "/@", "ct"}], "]"}], "===", 
          RowBox[{"Sort", "[", 
           RowBox[{"Coordinates", "[", "mt", "]"}], "]"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"OverHatSgn", "[", "#", "]"}], "&"}], "/@", 
             RowBox[{"Indices", "[", "mt", "]"}]}], ",", "1"}], "]"}], "===", 
          RowBox[{"{", "}"}]}], ")"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coords", ",", "i", ",", "j", ",", "ds2", ",", "si", ",", "op", ",", 
         "name", ",", "output", ",", "MetricOp", ",", "ChrOp", ",", "RiemOp", 
         ",", "RicciOp", ",", "RicciSOp"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"extract", " ", "coordinates"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coords", "=", 
         RowBox[{"Coordinates", "[", "mt", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "extract", " ", "StartIndex", " ", "so", " ", "we", " ", "know", " ",
           "what", " ", "to", " ", "sum", " ", "over", " ", "below"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"si", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"OptionValue", "[", "StartIndex", "]"}], ",", 
              "_Integer"}], "]"}]}], ",", 
           RowBox[{"(*", 
            RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
           RowBox[{"StartIndex", "[", "mt", "]"}], ",", "True", ",", 
           RowBox[{"OptionValue", "[", "StartIndex", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "extract", " ", "metric", " ", "in", " ", "the", " ", "form", " ", 
          "of", " ", "coordinate", " ", "differentials"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"ds2", "=", 
         RowBox[{"ToExpressionForm", "[", 
          RowBox[{"Metric", "[", 
           RowBox[{
            RowBox[{"SubMinus", "[", "i", "]"}], ",", 
            RowBox[{"SubMinus", "[", "j", "]"}], ",", "mt"}], "]"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Apply", " ", "CoordinateTransformation"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"op", "=", 
         RowBox[{
         "OptionValue", "[", "CoordinateTransformationOperator", "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Geometrical", " ", 
          RowBox[{"objects", "'"}], " ", "Opertator"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"MetricOp", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"OptionValue", "[", "MetricOperator", "]"}], "=!=", 
             "Simplify"}], ")"}], ",", 
           RowBox[{"OptionValue", "[", "MetricOperator", "]"}], ",", "True", 
           ",", "op"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ChrOp", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"OptionValue", "[", "ChristoffelOperator", "]"}], "=!=", 
             "Simplify"}], ")"}], ",", 
           RowBox[{"OptionValue", "[", "ChristoffelOperator", "]"}], ",", 
           "True", ",", "op"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"RiemOp", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"OptionValue", "[", "RiemannOperator", "]"}], "=!=", 
             "Simplify"}], ")"}], ",", 
           RowBox[{"OptionValue", "[", "RiemannOperator", "]"}], ",", "True", 
           ",", "op"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"RicciOp", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"OptionValue", "[", "RicciOperator", "]"}], "=!=", 
             "Simplify"}], ")"}], ",", 
           RowBox[{"OptionValue", "[", "RicciOperator", "]"}], ",", "True", 
           ",", "op"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"RicciSOp", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"OptionValue", "[", "RicciScalarOperator", "]"}], "=!=", 
             "Simplify"}], ")"}], ",", 
           RowBox[{"OptionValue", "[", "RicciScalarOperator", "]"}], ",", 
           "True", ",", "op"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Change", " ", "Name", " ", "for", " ", "Metric"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"name", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"OptionValue", "[", "TensorName", "]"}], ",", 
             "_Integer"}], "]"}], ",", 
           RowBox[{"TensorName", "[", "mt", "]"}], ",", "True", ",", 
           RowBox[{"OptionValue", "[", "TensorName", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ds2", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"ds2", "/.", 
            RowBox[{"CoordinateTransformation", "[", 
             RowBox[{"ct", ",", "newcoords"}], "]"}]}], ")"}], "//", "op"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Re", "-", 
          RowBox[{
          "compute", " ", "Metric", " ", "using", " ", "new", " ", 
           "coordinates"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"ensure", " ", "new", " ", "coordinates"}], ",", " ", 
          RowBox[{
          "StartIndex", " ", "and", " ", "TensorName", " ", "are", " ", 
           "brought", " ", "over"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"ds2", "=", 
         RowBox[{"Metric", "[", 
          RowBox[{
           SubscriptBox["i", "-"], ",", 
           SubscriptBox["j", "-"], ",", "ds2", ",", 
           RowBox[{"Coordinates", "\[Rule]", "newcoords"}], ",", 
           RowBox[{"StartIndex", "\[Rule]", "si"}], ",", 
           RowBox[{"TensorName", "\[Rule]", "name"}], ",", 
           RowBox[{"(*", 
            RowBox[{"20251029", " ", 
             RowBox[{"WH", ":", " ", 
              RowBox[{"Geometrical", " ", 
               RowBox[{"objects", "'"}], " ", "Opertator"}]}]}], "*)"}], 
           RowBox[{"MetricOperator", "->", "MetricOp"}], ",", 
           RowBox[{"ChristoffelOperator", "->", "ChrOp"}], ",", 
           RowBox[{"RiemannOperator", "->", "RiemOp"}], ",", 
           RowBox[{"RicciOperator", "->", "RicciOp"}], ",", 
           RowBox[{"RicciScalarOperator", "->", "RicciSOp"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "output", " ", "with", " ", "the", " ", "same", " ", "indices"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         StyleBox[
          RowBox[{"Change", " ", "Indices", " ", "for", " ", "Metric"}],
          FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Default", " ", "OptionValue", " ", "of", " ", "Indices", " ", "is",
            " ", 
           RowBox[{"{", "}"}]}], ",", " ", 
          RowBox[{
          "whose", " ", "length", " ", "is", " ", "0.", " ", "If", " ", 
           "user", " ", "input", " ", "correctly"}], ",", " ", 
          RowBox[{"change", " ", "it", " ", "for", " ", 
           RowBox[{"them", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"OptionValue", "[", "Indices", "]"}], "]"}], "===", 
            "2"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Metric", "[", 
            RowBox[{
             RowBox[{"Sequence", "@@", 
              RowBox[{"OptionValue", "[", "Indices", "]"}]}], ",", "ds2", ",", 
             RowBox[{"TooltipStyle", "\[Rule]", " ", 
              RowBox[{"TooltipStyle", "[", "mt", "]"}]}]}], "]"}], ",", 
           "True", ",", 
           RowBox[{"Metric", "[", 
            RowBox[{
             RowBox[{"Sequence", "@@", 
              RowBox[{"Indices", "[", "mt", "]"}]}], ",", "ds2", ",", 
             RowBox[{"TooltipStyle", "\[Rule]", " ", 
              RowBox[{"TooltipStyle", "[", "mt", "]"}]}]}], "]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          StyleBox["TooltipDisplay",
           FontColor->RGBColor[1, 0, 1]], " ", "and", " ", 
          StyleBox["TooltipStyle",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}], "=!=", 
           "Null"}], ",", 
          RowBox[{"output", "=", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"TooltipDisplayNoPart", "[", "output", "]"}], "===", 
               RowBox[{"{", "}"}]}], ")"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{"output", ",", 
               RowBox[{"TooltipDisplay", "\[Rule]", 
                RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}]}], 
              "]"}], ",", "True", ",", 
             RowBox[{"output", "/.", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"TooltipDisplay", "\[Rule]", "td_"}], ")"}], 
               "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"TooltipDisplay", "\[Rule]", 
                 RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], 
                ")"}]}]}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
           RowBox[{"{", 
            RowBox[{"(*", "Small", "*)"}], "}"}]}], ",", 
          RowBox[{"output", "=", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"TooltipStyleNoPart", "[", "output", "]"}], "===", 
               RowBox[{"{", "}"}]}], ")"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{"output", ",", 
               RowBox[{"TooltipStyle", "\[Rule]", 
                RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}]}], "]"}], 
             ",", "True", ",", 
             RowBox[{"output", "/.", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"TooltipStyle", "\[Rule]", "tts_"}], ")"}], "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"TooltipStyle", "\[Rule]", 
                 RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], 
                ")"}]}]}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "output"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Induced", " ", 
     RowBox[{"Tensor", ":", " ", 
      RowBox[{"Check", " ", "the", " ", 
       RowBox[{"dimensions", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    StyleBox[
     RowBox[{"Induced", " ", "Tensor", " ", 
      RowBox[{"(", 
       RowBox[{
       "Other", " ", "than", " ", "Metric", " ", "and", " ", "Christoffel"}], 
       ")"}], " ", "without", " ", 
      RowBox[{"OverHat", ".", " ", "Mixed"}], " ", 
      RowBox[{"Position", "."}]}],
     FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CoordinateTransformation", "[", 
       RowBox[{
        RowBox[{"t_Tensor", "/;", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"TensorTypeNoPart", "[", "t", "]"}], ",", 
            RowBox[{"(", 
             RowBox[{"\"\<Metric\>\"", "|", "\"\<ChristoffelSymbols\>\""}], 
             ")"}]}], "]"}], "===", 
          RowBox[{"{", "}"}]}]}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Shouldn", "'"}], "t", " ", "be", " ", "Metric", " ", "or", 
          " ", "Christoffel"}], "*)"}], "\[IndentingNewLine]", ",", 
        RowBox[{"ct", ":", 
         RowBox[{"{", 
          RowBox[{"Repeated", "[", 
           RowBox[{"Rule", "[", 
            RowBox[{"_Symbol", ",", "_"}], "]"}], "]"}], "}"}]}], ",", 
        RowBox[{"newcoords", ":", 
         RowBox[{"{", 
          RowBox[{"Repeated", "[", "_Symbol", "]"}], "}"}]}], ",", 
        RowBox[{"AmbientSpaceMetric_Tensor", "/;", 
         RowBox[{"TestMetricTensor", "[", "AmbientSpaceMetric", "]"}]}], ",", 
        RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], "/;", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"(*", " ", 
         RowBox[{"check", " ", "same", " ", "coordinates"}], " ", "*)"}], 
        RowBox[{
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "&"}], "/@", "ct"}], "]"}], "===", 
         RowBox[{"Sort", "[", 
          RowBox[{"Coordinates", "[", "t", "]"}], "]"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"OverHatSgn", "[", "#", "]"}], "&"}], "/@", 
            RowBox[{"Indices", "[", "t", "]"}]}], ",", "1"}], "]"}], "===", 
         RowBox[{"{", "}"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", "ct", "]"}], ">", 
         RowBox[{"Length", "[", "newcoords", "]"}]}], ")"}]}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coords", ",", "lgth", ",", "jacobm", ",", " ", "R", ",", "dlist", 
         ",", "drhs", ",", "lgthrhs", ",", "indices", ",", "idxl", ",", " ", 
         "newt", ",", "name", ",", "si", ",", "tensorproduct", ",", 
         "allindices", ",", "hyperm", ",", "InvInducedT", ",", "tempidxlist", 
         ",", "Q", ",", "W", ",", "m", ",", "mx", ",", "l", ",", "j", ",", 
         "lowerindices"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"indices", "=", 
         RowBox[{"RemoveUnderBarredIndices", "[", 
          RowBox[{"Indices", "[", "t", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          StyleBox["Rank",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          RowBox[{
           StyleBox["number",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[":",
            FontColor->RGBColor[1, 0, 1]], " ", 
           RowBox[{"indices", " ", 
            RowBox[{"list", "'"}], "s", " ", "length"}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"idxl", "=", 
         RowBox[{"Length", "[", "indices", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          StyleBox["Dimension",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[":",
           FontColor->RGBColor[1, 0, 1]], " ", 
          RowBox[{
          "length", " ", "of", " ", "coordinates", " ", "transformation", " ",
            "list"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"lgth", "=", 
         RowBox[{"Length", "[", "ct", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"New", " ", 
          RowBox[{
           StyleBox["Dimension",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[":",
            FontColor->RGBColor[1, 0, 1]], " ", 
           RowBox[{"length", " ", "of", " ", 
            RowBox[{"newcoords", ".", " ", "Right"}], " ", "now", " ", 
            RowBox[{"it", "'"}], "s", " ", "might", " ", "be", " ", 
            RowBox[{"redundent", ".", " ", "Since"}], " ", "this", " ", 
            "piece", " ", "of", " ", "code", " ", "do", " ", "not", " ", 
            "cover", " ", "induced", " ", 
            RowBox[{"tensor", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"lgthrhs", "=", 
         RowBox[{"Length", "[", "newcoords", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Extract", " ", 
          StyleBox["old",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["coordinates",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"coords", "=", 
         RowBox[{"Coordinates", "[", "t", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Generate", " ", "a", " ", 
          StyleBox["list",
           FontColor->RGBColor[1, 0, 1]], " ", "with", " ", 
          RowBox[{"\[DifferentialD]", " ", "in"}], " ", "front", " ", "of", 
          " ", 
          RowBox[{"coordinates", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"dlist", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"\[DifferentialD]", 
            RowBox[{
            "coords", "\[LeftDoubleBracket]", "#", 
             "\[RightDoubleBracket]"}]}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "lgth"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Generate", " ", "a", " ", 
          StyleBox["list",
           FontColor->RGBColor[1, 0, 1]], " ", "with", " ", 
          RowBox[{"\[DifferentialD]", " ", "in"}], " ", "front", " ", "of", 
          " ", 
          RowBox[{"newcoords", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"drhs", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"\[DifferentialD]", 
            RowBox[{
            "newcoords", "\[LeftDoubleBracket]", "#", 
             "\[RightDoubleBracket]"}]}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "lgthrhs"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"R", ":", " ", 
          RowBox[{"Jacobian", " ", "replacement", " ", "rule", " ", 
           RowBox[{"list", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"R", "=", 
         RowBox[{"CoordinateTransformation", "[", 
          RowBox[{"ct", ",", "newcoords"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Generate", " ", 
           StyleBox["Jacobian",
            FontColor->RGBColor[1, 0, 1]], " ", "as", " ", 
           StyleBox["d",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["*",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["n",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["matrix",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["form",
             FontColor->RGBColor[1, 0, 1]], ".", " ", "n"}]}], "\[LessEqual]",
           "d"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"jacobm", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Coefficient", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "dlist", "\[LeftDoubleBracket]", "a", "\[RightDoubleBracket]"}],
               "/.", "R"}], ",", 
             RowBox[{
             "drhs", "\[LeftDoubleBracket]", "b", "\[RightDoubleBracket]"}]}],
             "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"b", ",", "1", ",", "lgthrhs"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "1", ",", "lgth"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Determine", " ", "the", " ", "output", " ", 
          StyleBox["Indices",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Default", " ", "value", " ", "is", " ", "a", " ", "null", " ", 
           RowBox[{"list", ".", " ", 
            RowBox[{"Search", ":", " ", 
             RowBox[{
             "\"\<Options[CoordinateTransformation]\>\"", 
              "\[IndentingNewLine]", "User", " ", "should", " ", "input", " ",
               "a", " ", "list", " ", 
              RowBox[{"w", "/", " ", "its"}], " ", "length", " ", "equals", 
              " ", "to", " ", "the", " ", "rank", " ", "of", " ", 
              RowBox[{"tensor", "."}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "If", " ", "user", " ", "input", " ", "a", " ", "proper", " ", 
           StyleBox["new",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["indices",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["list",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"OptionValue", "[", "Indices", "]"}], "]"}], "===", 
           "idxl"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Make", " ", "it", " ", "become", " ", 
            RowBox[{"OptionValue", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"indices", "=", 
           RowBox[{"OptionValue", "[", "Indices", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Lower", " ", "all", " ", "indices", " ", "of", " ", "tensor", " ", 
          "\"\<t\>\""}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"newt", "=", 
         RowBox[{"LowerAllIndices", "[", 
          RowBox[{
           RowBox[{"t", "/.", "ct"}], ",", "AmbientSpaceMetric"}], "]"}]}], 
        ";", 
        StyleBox["\[IndentingNewLine]",
         FontColor->RGBColor[0.6, 0.4, 0.2]], 
        StyleBox["\[IndentingNewLine]",
         FontColor->RGBColor[0.6, 0.4, 0.2]], 
        RowBox[{"(*", 
         RowBox[{
         "prepare", " ", "new", " ", "matrix", " ", "and", " ", "indices"}], 
         "*)"}], 
        StyleBox["\[IndentingNewLine]",
         FontColor->RGBColor[0.6, 0.4, 0.2]], 
        RowBox[{"mx", "=", 
         RowBox[{"TensorComponents", "[", "newt", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Since", " ", "we", " ", "have", " ", "lower", " ", "all", " ", 
           "indices"}], ",", " ", 
          RowBox[{
          "we", " ", "should", " ", "inherit", " ", "the", " ", "indices", 
           " ", "list", " ", "but", " ", "all", " ", 
           RowBox[{"w", "/", " ", 
            StyleBox["SubMinus",
             FontColor->RGBColor[1, 0, 1]]}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"allindices", "=", 
         RowBox[{
          RowBox[{
           SubscriptBox[
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "-"],
            "&"}], "/@", "indices"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"project", " ", "into", " ", "the", " ", 
          RowBox[{"hypersurface", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           StyleBox["\"\<Do\>\"",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["for",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["idxl",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[
            RowBox[{"(", 
             RowBox[{"rank", " ", "number"}], ")"}],
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["times",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[":",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], "\[IndentingNewLine]", 
            RowBox[{"Contract", " ", "with", " ", "Jacobians", " ", "by", " ", 
             RowBox[{"hand", ".", " ", "All"}], " ", "indices", " ", "are", 
             " ", 
             StyleBox["lower",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox["indices",
              FontColor->RGBColor[1, 0, 1]]}]}]}], ",", " ", 
          RowBox[{"so", " ", "contract", " ", "with", " ", 
           RowBox[{
            StyleBox["Jacobians",
             FontColor->RGBColor[1, 0, 1]], "."}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"TensorProduct", " ", "with", " ", "a", " ", 
           StyleBox["Jacobian",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"mx", "=", 
            RowBox[{"TensorProduct", "[", 
             RowBox[{"mx", ",", "jacobm"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Join", " ", "Current", " ", "indices", " ", "list", " ", "with", 
             " ", 
             RowBox[{"Jacobians", "'"}], " ", 
             RowBox[{"indices", "."}]}], "*)"}], 
           RowBox[{"allindices", "=", 
            RowBox[{"Join", "[", 
             RowBox[{
              StyleBox[
               RowBox[{"(", 
                RowBox[{"allindices", "//", "RemoveUnderBarredIndices"}], 
                ")"}], "Code"], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"SubMinus", "[", 
                 RowBox[{"Unique", "[", "j", "]"}], "]"}], ",", 
                RowBox[{"SuperMinus", "[", 
                 RowBox[{
                  RowBox[{
                  "indices", "\[LeftDoubleBracket]", "l", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Execute", " ", "the", " ", 
             RowBox[{"contraction", ".", " ", "The"}], " ", "inner", " ", 
             "contraction", " ", "will", " ", "be", " ", "taken", " ", "care",
              " ", "by", " ", "code", " ", 
             RowBox[{"here", ":", " ", 
              RowBox[{
              "Search", " ", 
               "\"\<\!\(\*StyleBox[\"Einstein\",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\"summation\",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\":\",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\"Repeated\",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\"indices\",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\"are\",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\"summed\",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\"over\",FontColor->RGBColor[0.5, 0, 0.5]]\)\>\"", 
               "\"\<\>"}]}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"newt", "=", 
            RowBox[{"newt", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Indices", "\[Rule]", "xxx_"}], ")"}], "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"Indices", "\[Rule]", "allindices"}], ")"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"TensorComponents", "\[Rule]", "xxxxx_"}], ")"}], 
                "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"TensorComponents", "\[Rule]", "mx"}], ")"}]}]}], 
              "}"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "extract", " ", "the", " ", "new", " ", "tensor", " ", 
             "components"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"mx", "=", 
            RowBox[{"TensorComponents", "[", "newt", "]"}]}], ";", 
           RowBox[{"allindices", "=", 
            RowBox[{"Indices", "[", "newt", "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"l", ",", "1", ",", "idxl"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"generate", " ", 
          StyleBox["induced",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["inverse",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["metric",
           FontColor->RGBColor[1, 0, 1]], " ", 
          SuperscriptBox["H", "AB"]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Recall", " ", "Metric", " ", "coordinate", " ", "transformation", 
          " ", 
          RowBox[{"code", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"InvInducedT", "=", 
         RowBox[{"CoordinateTransformation", "[", 
          RowBox[{"AmbientSpaceMetric", ",", "ct", ",", "newcoords", ",", 
           RowBox[{"Indices", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              SuperscriptBox["Q", "-"], ",", 
              SuperscriptBox["W", "-"]}], "}"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Recover", "/", "Raise"}], " ", "those", " ", "indices", 
          " ", "which", " ", "lower", " ", "at", " ", "the", " ", 
          RowBox[{"beginning", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"newt", "=", 
         RowBox[{"MoveIndices", "[", 
          RowBox[{"newt", ",", "indices", ",", "InvInducedT"}], "]"}]}], ";", 
        " ", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Determine", " ", "the", " ", "output", " ", 
          StyleBox["TensorName",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"name", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"OptionValue", "[", "TensorName", "]"}], ",", 
             "_Integer"}], "]"}], ",", 
           RowBox[{"TensorName", "[", "t", "]"}], ",", "True", ",", 
           RowBox[{"OptionValue", "[", "TensorName", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Determine", " ", "the", " ", "output", " ", 
          StyleBox["StartIndex",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"si", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"OptionValue", "[", "StartIndex", "]"}], ",", 
              "_Integer"}], "]"}]}], ",", 
           RowBox[{"StartIndex", "[", "t", "]"}], ",", "True", ",", 
           RowBox[{"OptionValue", "[", "StartIndex", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Replace", " ", "new", " ", "Tensor", " ", "with", " ", "new", " ", 
           StyleBox["TensorComponents",
            FontColor->RGBColor[1, 0, 1]]}], 
          StyleBox[",",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["TensorName",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[",",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["  ",
           FontColor->RGBColor[1, 0, 1]], 
          RowBox[{
           StyleBox["StartIndex",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], "and", 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["Coordinates",
             FontColor->RGBColor[1, 0, 1]], "."}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"newt", "=", 
         RowBox[{"newt", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
             "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"TensorComponents", "\[Rule]", "mx"}], "//", 
               RowBox[{
               "OptionValue", "[", "CoordinateTransformationOperator", 
                "]"}]}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorName", "\[Rule]", "tn_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"TensorName", "\[Rule]", "name"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"StartIndex", "\[Rule]", "st_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"StartIndex", "\[Rule]", "si"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Coordinates", "\[Rule]", "xxxxxx_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"Coordinates", "\[Rule]", "newcoords"}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Indices", "\[Rule]", "idx_"}], ")"}], "\[RuleDelayed]",
              " ", 
             RowBox[{"(", 
              RowBox[{"Indices", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"idx", "//", "RemoveRepeatedUnderBarredIndices"}], 
                ")"}]}], ")"}]}]}], "\[IndentingNewLine]", "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          StyleBox["TooltipDisplay",
           FontColor->RGBColor[1, 0, 1]], " ", "and", " ", 
          StyleBox["TooltipStyle",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}], "=!=", 
           "Null"}], ",", 
          RowBox[{"newt", "=", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"TooltipDisplayNoPart", "[", "newt", "]"}], "===", 
               RowBox[{"{", "}"}]}], ")"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{"newt", ",", 
               RowBox[{"TooltipDisplay", "\[Rule]", 
                RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}]}], 
              "]"}], ",", "True", ",", 
             RowBox[{"newt", "/.", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"TooltipDisplay", "\[Rule]", "td_"}], ")"}], 
               "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"TooltipDisplay", "\[Rule]", 
                 RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], 
                ")"}]}]}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
           RowBox[{"{", 
            RowBox[{"(*", "Small", "*)"}], "}"}]}], ",", 
          RowBox[{"newt", "=", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"TooltipStyleNoPart", "[", "newt", "]"}], "===", 
               RowBox[{"{", "}"}]}], ")"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{"newt", ",", 
               RowBox[{"TooltipStyle", "\[Rule]", 
                RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}]}], "]"}], 
             ",", "True", ",", 
             RowBox[{"newt", "/.", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"TooltipStyle", "\[Rule]", "tts_"}], ")"}], "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"TooltipStyle", "\[Rule]", 
                 RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], 
                ")"}]}]}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         StyleBox[
          RowBox[{"Final", " ", "output"}],
          FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
        "newt"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    StyleBox[
     RowBox[{"Induced", " ", "Tensor", " ", 
      RowBox[{"(", 
       RowBox[{
       "Other", " ", "than", " ", "Metric", " ", "and", " ", "Christoffel"}], 
       ")"}], " ", "with", " ", 
      RowBox[{"OverHat", ".", " ", "Mixed"}], " ", 
      RowBox[{"Position", "."}]}],
     FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CoordinateTransformation", "[", 
       RowBox[{
        RowBox[{"t_Tensor", "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"TensorTypeNoPart", "[", "t", "]"}], ",", 
             RowBox[{"(", 
              RowBox[{"\"\<Metric\>\"", "|", "\"\<ChristoffelSymbols\>\""}], 
              ")"}]}], "]"}], "===", 
           RowBox[{"{", "}"}]}], ")"}]}], 
        RowBox[{"(*", 
         RowBox[{"S", 
          RowBox[{"houldn", "'"}], "t", " ", "be", " ", "Metric", " ", "or", 
          " ", "Christoffel"}], "*)"}], "\[IndentingNewLine]", ",", 
        RowBox[{"ct", ":", 
         RowBox[{"{", 
          RowBox[{"Repeated", "[", 
           RowBox[{"Rule", "[", 
            RowBox[{"_Symbol", ",", "_"}], "]"}], "]"}], "}"}]}], ",", 
        RowBox[{"newcoords", ":", 
         RowBox[{"{", 
          RowBox[{"Repeated", "[", "_Symbol", "]"}], "}"}]}], ",", 
        RowBox[{"AmbientSpaceMetric_Tensor", "/;", 
         RowBox[{"TestMetricTensor", "[", "AmbientSpaceMetric", "]"}]}], ",", 
        RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], "/;", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"(*", " ", 
         RowBox[{"check", " ", "same", " ", "coordinates"}], " ", "*)"}], 
        RowBox[{
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "&"}], "/@", "ct"}], "]"}], "===", 
         RowBox[{"Sort", "[", 
          RowBox[{"Coordinates", "[", "t", "]"}], "]"}]}], ")"}], "&&", 
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"OverHatSgn", "[", "#", "]"}], "&"}], "/@", 
             RowBox[{"Indices", "[", "t", "]"}]}], ",", "1"}], "]"}], "===", 
          RowBox[{"{", "}"}]}], ")"}]}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", "ct", "]"}], ">", 
         RowBox[{"Length", "[", "newcoords", "]"}]}], ")"}]}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coords", ",", "lgth", ",", "jacobm", ",", " ", "R", ",", "dlist", 
         ",", "drhs", ",", "lgthrhs", ",", "indices", ",", "idxl", ",", " ", 
         "newt", ",", "name", ",", "si", ",", "tensorproduct", ",", 
         "allindices", ",", "hyperm", ",", "InvInducedT", ",", "tempidxlist", 
         ",", "Q", ",", "W", ",", "m", ",", "mx", ",", "l", ",", "j", ",", 
         "lowerindices"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"indices", "=", 
         RowBox[{"RemoveUnderBarredIndices", "[", 
          RowBox[{"Indices", "[", "t", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          StyleBox["Rank",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          RowBox[{
           StyleBox["number",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[":",
            FontColor->RGBColor[1, 0, 1]], " ", 
           RowBox[{"indices", " ", 
            RowBox[{"list", "'"}], "s", " ", "length"}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"idxl", "=", 
         RowBox[{"Length", "[", "indices", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          StyleBox["Dimension",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[":",
           FontColor->RGBColor[1, 0, 1]], " ", 
          RowBox[{
          "length", " ", "of", " ", "coordinates", " ", "transformation", " ",
            "list"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"lgth", "=", 
         RowBox[{"Length", "[", "ct", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"New", " ", 
          RowBox[{
           StyleBox["Dimension",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[":",
            FontColor->RGBColor[1, 0, 1]], " ", 
           RowBox[{"length", " ", "of", " ", 
            RowBox[{"newcoords", ".", " ", "Right"}], " ", "now", " ", 
            RowBox[{"it", "'"}], "s", " ", "might", " ", "be", " ", 
            RowBox[{"redundent", ".", " ", "Since"}], " ", "this", " ", 
            "piece", " ", "of", " ", "code", " ", "do", " ", "not", " ", 
            "cover", " ", "induced", " ", 
            RowBox[{"tensor", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"lgthrhs", "=", 
         RowBox[{"Length", "[", "newcoords", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Extract", " ", 
          StyleBox["old",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["coordinates",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"coords", "=", 
         RowBox[{"Coordinates", "[", "t", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Generate", " ", "a", " ", 
          StyleBox["list",
           FontColor->RGBColor[1, 0, 1]], " ", "with", " ", 
          RowBox[{"\[DifferentialD]", " ", "in"}], " ", "front", " ", "of", 
          " ", 
          RowBox[{"coordinates", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"dlist", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"\[DifferentialD]", 
            RowBox[{
            "coords", "\[LeftDoubleBracket]", "#", 
             "\[RightDoubleBracket]"}]}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "lgth"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Generate", " ", "a", " ", 
          StyleBox["list",
           FontColor->RGBColor[1, 0, 1]], " ", "with", " ", 
          RowBox[{"\[DifferentialD]", " ", "in"}], " ", "front", " ", "of", 
          " ", 
          RowBox[{"newcoords", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"drhs", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"\[DifferentialD]", 
            RowBox[{
            "newcoords", "\[LeftDoubleBracket]", "#", 
             "\[RightDoubleBracket]"}]}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "lgthrhs"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"R", ":", " ", 
          RowBox[{"Jacobian", " ", "replacement", " ", "rule", " ", 
           RowBox[{"list", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"R", "=", 
         RowBox[{"CoordinateTransformation", "[", 
          RowBox[{"ct", ",", "newcoords"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Generate", " ", 
           StyleBox["Jacobian",
            FontColor->RGBColor[1, 0, 1]], " ", "as", " ", 
           StyleBox["d",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["*",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["n",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["matrix",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["form",
             FontColor->RGBColor[1, 0, 1]], ".", " ", "n"}]}], "\[LessEqual]",
           "d"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"jacobm", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Coefficient", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "dlist", "\[LeftDoubleBracket]", "a", "\[RightDoubleBracket]"}],
               "/.", "R"}], ",", 
             RowBox[{
             "drhs", "\[LeftDoubleBracket]", "b", "\[RightDoubleBracket]"}]}],
             "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "1", ",", "lgth"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"b", ",", "1", ",", "lgthrhs"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Determine", " ", "the", " ", "output", " ", 
          StyleBox["Indices",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Default", " ", "value", " ", "is", " ", "a", " ", "null", " ", 
           RowBox[{"list", ".", " ", 
            RowBox[{"Search", ":", " ", 
             RowBox[{
             "\"\<Options[CoordinateTransformation]\>\"", 
              "\[IndentingNewLine]", "User", " ", "should", " ", "input", " ",
               "a", " ", "list", " ", 
              RowBox[{"w", "/", " ", "its"}], " ", "length", " ", "equals", 
              " ", "to", " ", "the", " ", "rank", " ", "of", " ", 
              RowBox[{"tensor", "."}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "If", " ", "user", " ", "input", " ", "a", " ", "proper", " ", 
           StyleBox["new",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["indices",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["list",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"OptionValue", "[", "Indices", "]"}], "]"}], "===", 
           "idxl"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Make", " ", "it", " ", "become", " ", 
            RowBox[{"OptionValue", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"indices", "=", 
           RowBox[{"OptionValue", "[", "Indices", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Lower", " ", "all", " ", "indices", " ", "of", " ", "tensor", " ", 
          "\"\<t\>\""}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"allindices", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"OverHatSgn", "[", "#", "]"}], "===", 
               RowBox[{"-", "1"}]}], ")"}], ",", 
             SubscriptBox[
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "-"], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"OverHatSgn", "[", "#", "]"}], "===", 
               RowBox[{"+", "1"}]}], ")"}], ",", "#"}], "]"}], "&"}], "/@", 
          "indices"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"newt", "=", 
         RowBox[{"MoveIndices", "[", 
          RowBox[{
           RowBox[{"t", "/.", "ct"}], ",", "allindices", ",", 
           "AmbientSpaceMetric"}], "]"}]}], ";", "\[IndentingNewLine]", 
        StyleBox["\[IndentingNewLine]",
         FontColor->RGBColor[0.6, 0.4, 0.2]], 
        RowBox[{"(*", 
         RowBox[{
         "prepare", " ", "new", " ", "matrix", " ", "and", " ", "indices"}], 
         "*)"}], 
        StyleBox["\[IndentingNewLine]",
         FontColor->RGBColor[0.6, 0.4, 0.2]], 
        RowBox[{"mx", "=", 
         RowBox[{"TensorComponents", "[", "newt", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Since", " ", "we", " ", "have", " ", "lower", " ", "all", " ", 
           "indices"}], ",", " ", 
          RowBox[{
          "we", " ", "should", " ", "inherit", " ", "the", " ", "indices", 
           " ", "list", " ", "but", " ", "all", " ", 
           RowBox[{"w", "/", " ", 
            StyleBox["SubMinus",
             FontColor->RGBColor[1, 0, 1]]}]}]}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"project", " ", "into", " ", "the", " ", 
          RowBox[{"hypersurface", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           StyleBox["\"\<Do\>\"",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["for",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["idxl",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[
            RowBox[{"(", 
             RowBox[{"rank", " ", "number"}], ")"}],
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["times",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[":",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], "\[IndentingNewLine]", 
            RowBox[{"Contract", " ", "with", " ", "Jacobians", " ", "by", " ", 
             RowBox[{"hand", ".", " ", 
              StyleBox["If",
               FontColor->RGBColor[1, 0, 1]]}], " ", "current", " ", 
             "executed", " ", "index", " ", "is", " ", "an", " ", 
             StyleBox["upper",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox["index",
              FontColor->RGBColor[1, 0, 1]]}]}]}], ",", " ", 
          RowBox[{"contract", " ", "with", " ", "an", " ", 
           StyleBox["inverse",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["Jacobian",
             FontColor->RGBColor[1, 0, 1]], ".", " ", "If"}], " ", 
           RowBox[{"it", "'"}], "s", " ", "a", " ", 
           StyleBox["lower",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["index",
            FontColor->RGBColor[1, 0, 1]]}], ",", " ", 
          RowBox[{"contract", " ", "with", " ", "a", " ", 
           RowBox[{
            StyleBox["Jacobian",
             FontColor->RGBColor[1, 0, 1]], "."}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"If", " ", 
             RowBox[{"it", "'"}], "s", " ", "in", " ", "coordinate", " ", 
             "basis"}], "*)"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"OverHatSgn", "[", 
               RowBox[{
               "indices", "\[LeftDoubleBracket]", "s", 
                "\[RightDoubleBracket]"}], "]"}], "===", 
              RowBox[{"-", "1"}]}], ")"}], ",", "\[IndentingNewLine]", 
            RowBox[{"mx", "=", 
             RowBox[{"Which", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"s", "<", "idxl"}], ",", 
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"TensorContract", "[", 
                  RowBox[{
                   RowBox[{"TensorProduct", "[", 
                    RowBox[{"mx", ",", 
                    RowBox[{"(*", 
                    RowBox[{"Contract", " ", 
                    RowBox[{"w", "/", 
                    StyleBox[" ",
                    FontColor->RGBColor[1, 0, 1]], 
                    StyleBox["jacobian",
                    FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], "jacobm"}], 
                    "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{"idxl", "+", "1"}]}], "}"}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"s", "-", "1"}]}], "]"}]}], ",", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"s", "+", "1"}], ",", "idxl"}], "]"}]}], ",", 
                   "s"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{"Least", " ", "index", " ", 
                 RowBox[{"doesn", "'"}], "t", " ", "need", " ", "a", " ", 
                 RowBox[{"Transpose", "."}]}], "*)"}], 
               RowBox[{"s", "===", "idxl"}], ",", 
               RowBox[{"TensorContract", "[", 
                RowBox[{
                 RowBox[{"TensorProduct", "[", 
                  RowBox[{"mx", ",", 
                   RowBox[{"(*", 
                    RowBox[{"Contract", " ", 
                    RowBox[{"w", "/", 
                    StyleBox[" ",
                    FontColor->RGBColor[1, 0, 1]], 
                    StyleBox["jacobian",
                    FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], "jacobm"}], 
                  "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"s", ",", 
                    RowBox[{"idxl", "+", "1"}]}], "}"}], "}"}]}], "]"}]}], 
              "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", "1", ",", "idxl"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"generate", " ", 
          StyleBox["induced",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["inverse",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["metric",
           FontColor->RGBColor[1, 0, 1]], " ", 
          SuperscriptBox["H", "AB"]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Recall", " ", "Metric", " ", "coordinate", " ", "transformation", 
          " ", 
          RowBox[{"code", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"InvInducedT", "=", 
         RowBox[{"CoordinateTransformation", "[", 
          RowBox[{"AmbientSpaceMetric", ",", "ct", ",", "newcoords", ",", 
           RowBox[{"Indices", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              SuperscriptBox["Q", "-"], ",", 
              SuperscriptBox["W", "-"]}], "}"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Recover", "/", "Raise"}], " ", "those", " ", "indices", 
          " ", "which", " ", "lower", " ", "at", " ", "the", " ", 
          RowBox[{"beginning", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"newt", "=", 
         RowBox[{"MoveIndices", "[", 
          RowBox[{
           RowBox[{"newt", "/.", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorComponents", "\[Rule]", "mmm_"}], ")"}], 
             "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"TensorComponents", "\[Rule]", "mx"}], ")"}]}]}], ",", 
           "indices", ",", "InvInducedT"}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Determine", " ", "the", " ", "output", " ", 
          StyleBox["TensorName",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"name", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"OptionValue", "[", "TensorName", "]"}], ",", 
             "_Integer"}], "]"}], ",", 
           RowBox[{"TensorName", "[", "t", "]"}], ",", "True", ",", 
           RowBox[{"OptionValue", "[", "TensorName", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Determine", " ", "the", " ", "output", " ", 
          StyleBox["StartIndex",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"si", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"OptionValue", "[", "StartIndex", "]"}], ",", 
              "_Integer"}], "]"}]}], ",", 
           RowBox[{"StartIndex", "[", "t", "]"}], ",", "True", ",", 
           RowBox[{"OptionValue", "[", "StartIndex", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Replace", " ", "new", " ", "Tensor", " ", "with", " ", "new", " ", 
           StyleBox["TensorComponents",
            FontColor->RGBColor[1, 0, 1]]}], 
          StyleBox[",",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["TensorName",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[",",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["  ",
           FontColor->RGBColor[1, 0, 1]], 
          RowBox[{
           StyleBox["StartIndex",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], "and", 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["Coordinates",
             FontColor->RGBColor[1, 0, 1]], "."}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"newt", "=", 
         RowBox[{"newt", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
             "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"TensorComponents", "\[Rule]", "mx"}], "//", 
               RowBox[{
               "OptionValue", "[", "CoordinateTransformationOperator", 
                "]"}]}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorName", "\[Rule]", "tn_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"TensorName", "\[Rule]", "name"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"StartIndex", "\[Rule]", "st_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"StartIndex", "\[Rule]", "si"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Coordinates", "\[Rule]", "xxxxxx_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"Coordinates", "\[Rule]", "newcoords"}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Indices", "\[Rule]", "idx_"}], ")"}], "\[RuleDelayed]",
              " ", 
             RowBox[{"(", 
              RowBox[{"Indices", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"idx", "//", "RemoveRepeatedUnderBarredIndices"}], 
                ")"}]}], ")"}]}]}], "\[IndentingNewLine]", "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          StyleBox["TooltipDisplay",
           FontColor->RGBColor[1, 0, 1]], " ", "and", " ", 
          StyleBox["TooltipStyle",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}], "=!=", 
           "Null"}], ",", 
          RowBox[{"newt", "=", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"TooltipDisplayNoPart", "[", "newt", "]"}], "===", 
               RowBox[{"{", "}"}]}], ")"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{"newt", ",", 
               RowBox[{"TooltipDisplay", "\[Rule]", 
                RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}]}], 
              "]"}], ",", "True", ",", 
             RowBox[{"newt", "/.", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"TooltipDisplay", "\[Rule]", "td_"}], ")"}], 
               "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"TooltipDisplay", "\[Rule]", 
                 RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], 
                ")"}]}]}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
           RowBox[{"{", 
            RowBox[{"(*", "Small", "*)"}], "}"}]}], ",", 
          RowBox[{"newt", "=", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"TooltipStyleNoPart", "[", "newt", "]"}], "===", 
               RowBox[{"{", "}"}]}], ")"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{"newt", ",", 
               RowBox[{"TooltipStyle", "\[Rule]", 
                RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}]}], "]"}], 
             ",", "True", ",", 
             RowBox[{"newt", "/.", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"TooltipStyle", "\[Rule]", "tts_"}], ")"}], "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"TooltipStyle", "\[Rule]", 
                 RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], 
                ")"}]}]}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         StyleBox[
          RowBox[{"Final", " ", "output"}],
          FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
        "newt"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Induced", " ", "Tensor", " ", "with", " ", "all", " ", "lower", " ", 
     "indices"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    StyleBox[
     RowBox[{"Induced", " ", "Tensor", " ", 
      RowBox[{"(", 
       RowBox[{
       "Other", " ", "than", " ", "Metric", " ", "and", " ", "Christoffel"}], 
       ")"}], " ", "without", " ", 
      RowBox[{"OverHat", ".", " ", "AllLowerIndices", "."}]}],
     FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CoordinateTransformation", "[", 
       RowBox[{
        RowBox[{"t_Tensor", "/;", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"TensorTypeNoPart", "[", "t", "]"}], ",", 
            RowBox[{"(", 
             RowBox[{"\"\<Metric\>\"", "|", "\"\<ChristoffelSymbols\>\""}], 
             ")"}]}], "]"}], "===", 
          RowBox[{"{", "}"}]}]}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Shouldn", "'"}], "t", " ", "be", " ", "Metric", " ", "or", 
          " ", "Christoffel"}], "*)"}], "\[IndentingNewLine]", ",", 
        RowBox[{"ct", ":", 
         RowBox[{"{", 
          RowBox[{"Repeated", "[", 
           RowBox[{"Rule", "[", 
            RowBox[{"_Symbol", ",", "_"}], "]"}], "]"}], "}"}]}], ",", 
        RowBox[{"newcoords", ":", 
         RowBox[{"{", 
          RowBox[{"Repeated", "[", "_Symbol", "]"}], "}"}]}], ",", 
        RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], "/;", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"(*", " ", 
         RowBox[{"check", " ", "same", " ", "coordinates"}], " ", "*)"}], 
        RowBox[{
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "&"}], "/@", "ct"}], "]"}], "===", 
         RowBox[{"Sort", "[", 
          RowBox[{"Coordinates", "[", "t", "]"}], "]"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"OverHatSgn", "[", "#", "]"}], "&"}], "/@", 
            RowBox[{"Indices", "[", "t", "]"}]}], ",", "1"}], "]"}], "===", 
         RowBox[{"{", "}"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", "ct", "]"}], ">", 
         RowBox[{"Length", "[", "newcoords", "]"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
            RowBox[{"Indices", "[", "t", "]"}]}], "]"}], "===", 
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"-", "1"}], "}"}], ")"}]}], "||", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
            RowBox[{"Indices", "[", "t", "]"}]}], "]"}], "===", 
          RowBox[{"(", 
           RowBox[{"{", "}"}], ")"}]}]}], ")"}]}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coords", ",", "lgth", ",", "jacobm", ",", " ", "R", ",", "dlist", 
         ",", "drhs", ",", "lgthrhs", ",", "indices", ",", "idxl", ",", " ", 
         "newt", ",", "name", ",", "si", ",", "tensorproduct", ",", 
         "allindices", ",", "hyperm", ",", "InvInducedT", ",", "tempidxlist", 
         ",", "Q", ",", "W", ",", "m", ",", "mx", ",", "l", ",", "j", ",", 
         "lowerindices"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"indices", "=", 
         RowBox[{"RemoveUnderBarredIndices", "[", 
          RowBox[{"Indices", "[", "t", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          StyleBox["Rank",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          RowBox[{
           StyleBox["number",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[":",
            FontColor->RGBColor[1, 0, 1]], " ", 
           RowBox[{"indices", " ", 
            RowBox[{"list", "'"}], "s", " ", "length"}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"idxl", "=", 
         RowBox[{"Length", "[", "indices", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          StyleBox["Dimension",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[":",
           FontColor->RGBColor[1, 0, 1]], " ", 
          RowBox[{
          "length", " ", "of", " ", "coordinates", " ", "transformation", " ",
            "list"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"lgth", "=", 
         RowBox[{"Length", "[", "ct", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"New", " ", 
          RowBox[{
           StyleBox["Dimension",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[":",
            FontColor->RGBColor[1, 0, 1]], " ", 
           RowBox[{"length", " ", "of", " ", 
            RowBox[{"newcoords", ".", " ", "Right"}], " ", "now", " ", 
            RowBox[{"it", "'"}], "s", " ", "might", " ", "be", " ", 
            RowBox[{"redundent", ".", " ", "Since"}], " ", "this", " ", 
            "piece", " ", "of", " ", "code", " ", "do", " ", "not", " ", 
            "cover", " ", "induced", " ", 
            RowBox[{"tensor", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"lgthrhs", "=", 
         RowBox[{"Length", "[", "newcoords", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Extract", " ", 
          StyleBox["old",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["coordinates",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"coords", "=", 
         RowBox[{"Coordinates", "[", "t", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Generate", " ", "a", " ", 
          StyleBox["list",
           FontColor->RGBColor[1, 0, 1]], " ", "with", " ", 
          RowBox[{"\[DifferentialD]", " ", "in"}], " ", "front", " ", "of", 
          " ", 
          RowBox[{"coordinates", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"dlist", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"\[DifferentialD]", 
            RowBox[{
            "coords", "\[LeftDoubleBracket]", "#", 
             "\[RightDoubleBracket]"}]}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "lgth"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Generate", " ", "a", " ", 
          StyleBox["list",
           FontColor->RGBColor[1, 0, 1]], " ", "with", " ", 
          RowBox[{"\[DifferentialD]", " ", "in"}], " ", "front", " ", "of", 
          " ", 
          RowBox[{"newcoords", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"drhs", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"\[DifferentialD]", 
            RowBox[{
            "newcoords", "\[LeftDoubleBracket]", "#", 
             "\[RightDoubleBracket]"}]}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "lgthrhs"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"R", ":", " ", 
          RowBox[{"Jacobian", " ", "replacement", " ", "rule", " ", 
           RowBox[{"list", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"R", "=", 
         RowBox[{"CoordinateTransformation", "[", 
          RowBox[{"ct", ",", "newcoords"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Generate", " ", 
           StyleBox["Jacobian",
            FontColor->RGBColor[1, 0, 1]], " ", "as", " ", 
           StyleBox["d",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["*",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["n",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["matrix",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["form",
             FontColor->RGBColor[1, 0, 1]], ".", " ", "n"}]}], "\[LessEqual]",
           "d"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"jacobm", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Coefficient", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "dlist", "\[LeftDoubleBracket]", "a", "\[RightDoubleBracket]"}],
               "/.", "R"}], ",", 
             RowBox[{
             "drhs", "\[LeftDoubleBracket]", "b", "\[RightDoubleBracket]"}]}],
             "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"b", ",", "1", ",", "lgthrhs"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "1", ",", "lgth"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Determine", " ", "the", " ", "output", " ", 
          StyleBox["Indices",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Default", " ", "value", " ", "is", " ", "a", " ", "null", " ", 
           RowBox[{"list", ".", " ", 
            RowBox[{"Search", ":", " ", 
             RowBox[{
             "\"\<Options[CoordinateTransformation]\>\"", 
              "\[IndentingNewLine]", "User", " ", "should", " ", "input", " ",
               "a", " ", "list", " ", 
              RowBox[{"w", "/", " ", "its"}], " ", "length", " ", "equals", 
              " ", "to", " ", "the", " ", "rank", " ", "of", " ", 
              RowBox[{"tensor", "."}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "If", " ", "user", " ", "input", " ", "a", " ", "proper", " ", 
           StyleBox["new",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["indices",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["list",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"OptionValue", "[", "Indices", "]"}], "]"}], "===", 
             "idxl"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
                RowBox[{"OptionValue", "[", "Indices", "]"}]}], "]"}], "===", 
              RowBox[{"(", 
               RowBox[{"{", 
                RowBox[{"-", "1"}], "}"}], ")"}]}], "||", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
                RowBox[{"OptionValue", "[", "Indices", "]"}]}], "]"}], "===", 
              RowBox[{"(", 
               RowBox[{"{", "}"}], ")"}]}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Make", " ", "it", " ", "become", " ", 
            RowBox[{"OptionValue", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"indices", "=", 
           RowBox[{"OptionValue", "[", "Indices", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newt", "=", 
         RowBox[{"t", "/.", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"TensorComponents", "\[Rule]", "mxx_"}], ")"}], 
           "\[RuleDelayed]", 
           RowBox[{"(", 
            RowBox[{"TensorComponents", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"mxx", "/.", "ct"}], ")"}]}], ")"}]}]}]}], ";", 
        StyleBox["\[IndentingNewLine]",
         FontColor->RGBColor[0.6, 0.4, 0.2]], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "prepare", " ", "new", " ", "matrix", " ", "and", " ", "indices"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"mx", "=", 
         RowBox[{"TensorComponents", "[", "newt", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Since", " ", "we", " ", "have", " ", "lower", " ", "all", " ", 
           "indices"}], ",", " ", 
          RowBox[{
          "we", " ", "should", " ", "inherit", " ", "the", " ", "indices", 
           " ", "list", " ", "but", " ", "all", " ", 
           RowBox[{"w", "/", " ", 
            StyleBox["SubMinus",
             FontColor->RGBColor[1, 0, 1]]}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"allindices", "=", "indices"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"project", " ", "into", " ", "the", " ", 
          RowBox[{"hypersurface", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           StyleBox["\"\<Do\>\"",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["for",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["idxl",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[
            RowBox[{"(", 
             RowBox[{"rank", " ", "number"}], ")"}],
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["times",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[":",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], "\[IndentingNewLine]", 
            RowBox[{"Contract", " ", "with", " ", "Jacobians", " ", "by", " ", 
             RowBox[{"hand", ".", " ", "All"}], " ", "indices", " ", "are", 
             " ", 
             StyleBox["lower",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox["indices",
              FontColor->RGBColor[1, 0, 1]]}]}]}], ",", " ", 
          RowBox[{"so", " ", "contract", " ", "with", " ", 
           RowBox[{
            StyleBox["Jacobians",
             FontColor->RGBColor[1, 0, 1]], "."}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"TensorProduct", " ", "with", " ", "a", " ", 
           StyleBox["Jacobian",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"mx", "=", 
            RowBox[{"TensorProduct", "[", 
             RowBox[{"mx", ",", "jacobm"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Join", " ", "Current", " ", "indices", " ", "list", " ", "with", 
             " ", 
             RowBox[{"Jacobians", "'"}], " ", 
             RowBox[{"indices", "."}]}], "*)"}], 
           RowBox[{"allindices", "=", 
            RowBox[{"Join", "[", 
             RowBox[{
              StyleBox[
               RowBox[{"(", 
                RowBox[{"allindices", "//", "RemoveUnderBarredIndices"}], 
                ")"}], "Code"], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"SubMinus", "[", 
                 RowBox[{"Unique", "[", "j", "]"}], "]"}], ",", 
                RowBox[{"SuperMinus", "[", 
                 RowBox[{
                  RowBox[{
                  "indices", "\[LeftDoubleBracket]", "l", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Execute", " ", "the", " ", 
             RowBox[{"contraction", ".", " ", "The"}], " ", "inner", " ", 
             "contraction", " ", "will", " ", "be", " ", "taken", " ", "care",
              " ", "by", " ", "code", " ", 
             RowBox[{"here", ":", " ", 
              RowBox[{
              "Search", " ", 
               "\"\<\!\(\*StyleBox[\"Einstein\",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\"summation\",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\":\",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\"Repeated\",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\"indices\",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\"are\",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\"summed\",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\"over\",FontColor->RGBColor[0.5, 0, 0.5]]\)\>\"", 
               "\"\<\>"}]}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"newt", "=", 
            RowBox[{"newt", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Indices", "\[Rule]", "xxx_"}], ")"}], "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"Indices", "\[Rule]", "allindices"}], ")"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"TensorComponents", "\[Rule]", "xxxxx_"}], ")"}], 
                "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"TensorComponents", "\[Rule]", "mx"}], ")"}]}]}], 
              "}"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "extract", " ", "the", " ", "new", " ", "tensor", " ", 
             "components"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"mx", "=", 
            RowBox[{"TensorComponents", "[", "newt", "]"}]}], ";", 
           RowBox[{"allindices", "=", 
            RowBox[{"Indices", "[", "newt", "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"l", ",", "1", ",", "idxl"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Determine", " ", "the", " ", "output", " ", 
          StyleBox["TensorName",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"name", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"OptionValue", "[", "TensorName", "]"}], ",", 
             "_Integer"}], "]"}], ",", 
           RowBox[{"TensorName", "[", "t", "]"}], ",", "True", ",", 
           RowBox[{"OptionValue", "[", "TensorName", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Determine", " ", "the", " ", "output", " ", 
          StyleBox["StartIndex",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"si", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"OptionValue", "[", "StartIndex", "]"}], ",", 
              "_Integer"}], "]"}]}], ",", 
           RowBox[{"StartIndex", "[", "t", "]"}], ",", "True", ",", 
           RowBox[{"OptionValue", "[", "StartIndex", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Replace", " ", "new", " ", "Tensor", " ", "with", " ", "new", " ", 
           StyleBox["TensorComponents",
            FontColor->RGBColor[1, 0, 1]]}], 
          StyleBox[",",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["TensorName",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[",",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["  ",
           FontColor->RGBColor[1, 0, 1]], 
          RowBox[{
           StyleBox["StartIndex",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], "and", 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["Coordinates",
             FontColor->RGBColor[1, 0, 1]], "."}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"newt", "=", 
         RowBox[{"newt", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
             "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"TensorComponents", "\[Rule]", "mx"}], "//", 
               RowBox[{
               "OptionValue", "[", "CoordinateTransformationOperator", 
                "]"}]}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorName", "\[Rule]", "tn_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"TensorName", "\[Rule]", "name"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"StartIndex", "\[Rule]", "st_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"StartIndex", "\[Rule]", "si"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Coordinates", "\[Rule]", "xxxxxx_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"Coordinates", "\[Rule]", "newcoords"}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Indices", "\[Rule]", "idx_"}], ")"}], "->", " ", 
             RowBox[{"(", 
              RowBox[{"Indices", "\[Rule]", "indices"}], ")"}]}]}], 
           "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          StyleBox["TooltipDisplay",
           FontColor->RGBColor[1, 0, 1]], " ", "and", " ", 
          StyleBox["TooltipStyle",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}], "=!=", 
           "Null"}], ",", 
          RowBox[{"newt", "=", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"TooltipDisplayNoPart", "[", "newt", "]"}], "===", 
               RowBox[{"{", "}"}]}], ")"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{"newt", ",", 
               RowBox[{"TooltipDisplay", "\[Rule]", 
                RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}]}], 
              "]"}], ",", "True", ",", 
             RowBox[{"newt", "/.", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"TooltipDisplay", "\[Rule]", "td_"}], ")"}], 
               "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"TooltipDisplay", "\[Rule]", 
                 RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], 
                ")"}]}]}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
           RowBox[{"{", 
            RowBox[{"(*", "Small", "*)"}], "}"}]}], ",", 
          RowBox[{"newt", "=", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"TooltipStyleNoPart", "[", "newt", "]"}], "===", 
               RowBox[{"{", "}"}]}], ")"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{"newt", ",", 
               RowBox[{"TooltipStyle", "\[Rule]", 
                RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}]}], "]"}], 
             ",", "True", ",", 
             RowBox[{"newt", "/.", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"TooltipStyle", "\[Rule]", "tts_"}], ")"}], "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"TooltipStyle", "\[Rule]", 
                 RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], 
                ")"}]}]}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         StyleBox[
          RowBox[{"Final", " ", "output"}],
          FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
        "newt"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    StyleBox[
     RowBox[{"Induced", " ", "Tensor", " ", 
      RowBox[{"(", 
       RowBox[{
       "Other", " ", "than", " ", "Metric", " ", "and", " ", "Christoffel"}], 
       ")"}], " ", "with", " ", 
      RowBox[{"OverHat", ".", " ", "AllLowerIndices", "."}]}],
     FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CoordinateTransformation", "[", 
       RowBox[{
        RowBox[{"t_Tensor", "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"TensorTypeNoPart", "[", "t", "]"}], ",", 
             RowBox[{"(", 
              RowBox[{"\"\<Metric\>\"", "|", "\"\<ChristoffelSymbols\>\""}], 
              ")"}]}], "]"}], "===", 
           RowBox[{"{", "}"}]}], ")"}]}], 
        RowBox[{"(*", 
         RowBox[{"S", 
          RowBox[{"houldn", "'"}], "t", " ", "be", " ", "Metric", " ", "or", 
          " ", "Christoffel"}], "*)"}], "\[IndentingNewLine]", ",", 
        RowBox[{"ct", ":", 
         RowBox[{"{", 
          RowBox[{"Repeated", "[", 
           RowBox[{"Rule", "[", 
            RowBox[{"_Symbol", ",", "_"}], "]"}], "]"}], "}"}]}], ",", 
        RowBox[{"newcoords", ":", 
         RowBox[{"{", 
          RowBox[{"Repeated", "[", "_Symbol", "]"}], "}"}]}], ",", 
        RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], "/;", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"(*", " ", 
         RowBox[{"check", " ", "same", " ", "coordinates"}], " ", "*)"}], 
        RowBox[{
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "&"}], "/@", "ct"}], "]"}], "===", 
         RowBox[{"Sort", "[", 
          RowBox[{"Coordinates", "[", "t", "]"}], "]"}]}], ")"}], "&&", 
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"OverHatSgn", "[", "#", "]"}], "&"}], "/@", 
             RowBox[{"Indices", "[", "t", "]"}]}], ",", "1"}], "]"}], "===", 
          RowBox[{"{", "}"}]}], ")"}]}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", "ct", "]"}], ">", 
         RowBox[{"Length", "[", "newcoords", "]"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
            RowBox[{"Indices", "[", "t", "]"}]}], "]"}], "===", 
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"-", "1"}], "}"}], ")"}]}], "||", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
            RowBox[{"Indices", "[", "t", "]"}]}], "]"}], "===", 
          RowBox[{"(", 
           RowBox[{"{", "}"}], ")"}]}]}], ")"}]}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coords", ",", "lgth", ",", "jacobm", ",", " ", "R", ",", "dlist", 
         ",", "drhs", ",", "lgthrhs", ",", "indices", ",", "idxl", ",", " ", 
         "newt", ",", "name", ",", "si", ",", "tensorproduct", ",", 
         "allindices", ",", "hyperm", ",", "InvInducedT", ",", "tempidxlist", 
         ",", "Q", ",", "W", ",", "m", ",", "mx", ",", "l", ",", "j", ",", 
         "lowerindices"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"indices", "=", 
         RowBox[{"RemoveUnderBarredIndices", "[", 
          RowBox[{"Indices", "[", "t", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          StyleBox["Rank",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          RowBox[{
           StyleBox["number",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[":",
            FontColor->RGBColor[1, 0, 1]], " ", 
           RowBox[{"indices", " ", 
            RowBox[{"list", "'"}], "s", " ", "length"}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"idxl", "=", 
         RowBox[{"Length", "[", "indices", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          StyleBox["Dimension",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[":",
           FontColor->RGBColor[1, 0, 1]], " ", 
          RowBox[{
          "length", " ", "of", " ", "coordinates", " ", "transformation", " ",
            "list"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"lgth", "=", 
         RowBox[{"Length", "[", "ct", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"New", " ", 
          RowBox[{
           StyleBox["Dimension",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[":",
            FontColor->RGBColor[1, 0, 1]], " ", 
           RowBox[{"length", " ", "of", " ", 
            RowBox[{"newcoords", ".", " ", "Right"}], " ", "now", " ", 
            RowBox[{"it", "'"}], "s", " ", "might", " ", "be", " ", 
            RowBox[{"redundent", ".", " ", "Since"}], " ", "this", " ", 
            "piece", " ", "of", " ", "code", " ", "do", " ", "not", " ", 
            "cover", " ", "induced", " ", 
            RowBox[{"tensor", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"lgthrhs", "=", 
         RowBox[{"Length", "[", "newcoords", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Extract", " ", 
          StyleBox["old",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["coordinates",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"coords", "=", 
         RowBox[{"Coordinates", "[", "t", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Generate", " ", "a", " ", 
          StyleBox["list",
           FontColor->RGBColor[1, 0, 1]], " ", "with", " ", 
          RowBox[{"\[DifferentialD]", " ", "in"}], " ", "front", " ", "of", 
          " ", 
          RowBox[{"coordinates", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"dlist", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"\[DifferentialD]", 
            RowBox[{
            "coords", "\[LeftDoubleBracket]", "#", 
             "\[RightDoubleBracket]"}]}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "lgth"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Generate", " ", "a", " ", 
          StyleBox["list",
           FontColor->RGBColor[1, 0, 1]], " ", "with", " ", 
          RowBox[{"\[DifferentialD]", " ", "in"}], " ", "front", " ", "of", 
          " ", 
          RowBox[{"newcoords", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"drhs", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"\[DifferentialD]", 
            RowBox[{
            "newcoords", "\[LeftDoubleBracket]", "#", 
             "\[RightDoubleBracket]"}]}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "lgthrhs"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"R", ":", " ", 
          RowBox[{"Jacobian", " ", "replacement", " ", "rule", " ", 
           RowBox[{"list", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"R", "=", 
         RowBox[{"CoordinateTransformation", "[", 
          RowBox[{"ct", ",", "newcoords"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Generate", " ", 
           StyleBox["Jacobian",
            FontColor->RGBColor[1, 0, 1]], " ", "as", " ", 
           StyleBox["d",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["*",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["n",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["matrix",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["form",
             FontColor->RGBColor[1, 0, 1]], ".", " ", "n"}]}], "\[LessEqual]",
           "d"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"jacobm", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Coefficient", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "dlist", "\[LeftDoubleBracket]", "a", "\[RightDoubleBracket]"}],
               "/.", "R"}], ",", 
             RowBox[{
             "drhs", "\[LeftDoubleBracket]", "b", "\[RightDoubleBracket]"}]}],
             "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "1", ",", "lgth"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"b", ",", "1", ",", "lgthrhs"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Determine", " ", "the", " ", "output", " ", 
          StyleBox["Indices",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Default", " ", "value", " ", "is", " ", "a", " ", "null", " ", 
           RowBox[{"list", ".", " ", 
            RowBox[{"Search", ":", " ", 
             RowBox[{
             "\"\<Options[CoordinateTransformation]\>\"", 
              "\[IndentingNewLine]", "User", " ", "should", " ", "input", " ",
               "a", " ", "list", " ", 
              RowBox[{"w", "/", " ", "its"}], " ", "length", " ", "equals", 
              " ", "to", " ", "the", " ", "rank", " ", "of", " ", 
              RowBox[{"tensor", "."}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "If", " ", "user", " ", "input", " ", "a", " ", "proper", " ", 
           StyleBox["new",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["indices",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["list",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"OptionValue", "[", "Indices", "]"}], "]"}], "===", 
             "idxl"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
                RowBox[{"OptionValue", "[", "Indices", "]"}]}], "]"}], "===", 
              RowBox[{"(", 
               RowBox[{"{", 
                RowBox[{"-", "1"}], "}"}], ")"}]}], "||", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
                RowBox[{"OptionValue", "[", "Indices", "]"}]}], "]"}], "===", 
              RowBox[{"(", 
               RowBox[{"{", "}"}], ")"}]}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Make", " ", "it", " ", "become", " ", 
            RowBox[{"OptionValue", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"indices", "=", 
           RowBox[{"OptionValue", "[", "Indices", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Lower", " ", "all", " ", "indices", " ", "of", " ", "tensor", " ", 
          "\"\<t\>\""}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"allindices", "=", "indices"}], ";", "\[IndentingNewLine]", 
        RowBox[{"newt", "=", 
         RowBox[{"t", "/.", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"TensorComponents", "\[Rule]", "mxx_"}], ")"}], 
           "\[RuleDelayed]", 
           RowBox[{"(", 
            RowBox[{"TensorComponents", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"mxx", "/.", "ct"}], ")"}]}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        StyleBox["\[IndentingNewLine]",
         FontColor->RGBColor[0.6, 0.4, 0.2]], 
        RowBox[{"(*", 
         RowBox[{
         "prepare", " ", "new", " ", "matrix", " ", "and", " ", "indices"}], 
         "*)"}], 
        StyleBox["\[IndentingNewLine]",
         FontColor->RGBColor[0.6, 0.4, 0.2]], 
        RowBox[{"mx", "=", 
         RowBox[{"TensorComponents", "[", "newt", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Since", " ", "we", " ", "have", " ", "lower", " ", "all", " ", 
           "indices"}], ",", " ", 
          RowBox[{
          "we", " ", "should", " ", "inherit", " ", "the", " ", "indices", 
           " ", "list", " ", "but", " ", "all", " ", 
           RowBox[{"w", "/", " ", 
            StyleBox["SubMinus",
             FontColor->RGBColor[1, 0, 1]]}]}]}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"project", " ", "into", " ", "the", " ", 
          RowBox[{"hypersurface", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           StyleBox["\"\<Do\>\"",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["for",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["idxl",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[
            RowBox[{"(", 
             RowBox[{"rank", " ", "number"}], ")"}],
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["times",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[":",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], "\[IndentingNewLine]", 
            RowBox[{"Contract", " ", "with", " ", "Jacobians", " ", "by", " ", 
             RowBox[{"hand", ".", " ", 
              StyleBox["If",
               FontColor->RGBColor[1, 0, 1]]}], " ", "current", " ", 
             "executed", " ", "index", " ", "is", " ", "an", " ", 
             StyleBox["upper",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox["index",
              FontColor->RGBColor[1, 0, 1]]}]}]}], ",", " ", 
          RowBox[{"contract", " ", "with", " ", "an", " ", 
           StyleBox["inverse",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["Jacobian",
             FontColor->RGBColor[1, 0, 1]], ".", " ", "If"}], " ", 
           RowBox[{"it", "'"}], "s", " ", "a", " ", 
           StyleBox["lower",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["index",
            FontColor->RGBColor[1, 0, 1]]}], ",", " ", 
          RowBox[{"contract", " ", "with", " ", "a", " ", 
           RowBox[{
            StyleBox["Jacobian",
             FontColor->RGBColor[1, 0, 1]], "."}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"If", " ", 
             RowBox[{"it", "'"}], "s", " ", "in", " ", "coordinate", " ", 
             "basis"}], "*)"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"OverHatSgn", "[", 
               RowBox[{
               "indices", "\[LeftDoubleBracket]", "s", 
                "\[RightDoubleBracket]"}], "]"}], "===", 
              RowBox[{"-", "1"}]}], ")"}], ",", "\[IndentingNewLine]", 
            RowBox[{"mx", "=", 
             RowBox[{"Which", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"s", "<", "idxl"}], ",", 
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"TensorContract", "[", 
                  RowBox[{
                   RowBox[{"TensorProduct", "[", 
                    RowBox[{"mx", ",", 
                    RowBox[{"(*", 
                    RowBox[{"Contract", " ", 
                    RowBox[{"w", "/", 
                    StyleBox[" ",
                    FontColor->RGBColor[1, 0, 1]], 
                    StyleBox["jacobian",
                    FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], "jacobm"}], 
                    "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{"idxl", "+", "1"}]}], "}"}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"s", "-", "1"}]}], "]"}]}], ",", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"s", "+", "1"}], ",", "idxl"}], "]"}]}], ",", 
                   "s"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{"Least", " ", "index", " ", 
                 RowBox[{"doesn", "'"}], "t", " ", "need", " ", "a", " ", 
                 RowBox[{"Transpose", "."}]}], "*)"}], 
               RowBox[{"s", "===", "idxl"}], ",", 
               RowBox[{"TensorContract", "[", 
                RowBox[{
                 RowBox[{"TensorProduct", "[", 
                  RowBox[{"mx", ",", 
                   RowBox[{"(*", 
                    RowBox[{"Contract", " ", 
                    RowBox[{"w", "/", 
                    StyleBox[" ",
                    FontColor->RGBColor[1, 0, 1]], 
                    StyleBox["jacobian",
                    FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], "jacobm"}], 
                  "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"s", ",", 
                    RowBox[{"idxl", "+", "1"}]}], "}"}], "}"}]}], "]"}]}], 
              "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", "1", ",", "idxl"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Determine", " ", "the", " ", "output", " ", 
          StyleBox["TensorName",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"name", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"OptionValue", "[", "TensorName", "]"}], ",", 
             "_Integer"}], "]"}], ",", 
           RowBox[{"TensorName", "[", "t", "]"}], ",", "True", ",", 
           RowBox[{"OptionValue", "[", "TensorName", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Determine", " ", "the", " ", "output", " ", 
          StyleBox["StartIndex",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"si", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"OptionValue", "[", "StartIndex", "]"}], ",", 
              "_Integer"}], "]"}]}], ",", 
           RowBox[{"StartIndex", "[", "t", "]"}], ",", "True", ",", 
           RowBox[{"OptionValue", "[", "StartIndex", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Replace", " ", "new", " ", "Tensor", " ", "with", " ", "new", " ", 
           StyleBox["TensorComponents",
            FontColor->RGBColor[1, 0, 1]]}], 
          StyleBox[",",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["TensorName",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[",",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["  ",
           FontColor->RGBColor[1, 0, 1]], 
          RowBox[{
           StyleBox["StartIndex",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], "and", 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["Coordinates",
             FontColor->RGBColor[1, 0, 1]], "."}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"newt", "=", 
         RowBox[{"newt", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
             "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"TensorComponents", "\[Rule]", "mx"}], "//", 
               RowBox[{
               "OptionValue", "[", "CoordinateTransformationOperator", 
                "]"}]}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorName", "\[Rule]", "tn_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"TensorName", "\[Rule]", "name"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"StartIndex", "\[Rule]", "st_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"StartIndex", "\[Rule]", "si"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Coordinates", "\[Rule]", "xxxxxx_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"Coordinates", "\[Rule]", "newcoords"}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Indices", "\[Rule]", "idx_"}], ")"}], "->", " ", 
             RowBox[{"(", 
              RowBox[{"Indices", "\[Rule]", 
               RowBox[{"(", "indices", ")"}]}], ")"}]}]}], 
           "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          StyleBox["TooltipDisplay",
           FontColor->RGBColor[1, 0, 1]], " ", "and", " ", 
          StyleBox["TooltipStyle",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}], "=!=", 
           "Null"}], ",", 
          RowBox[{"newt", "=", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"TooltipDisplayNoPart", "[", "newt", "]"}], "===", 
               RowBox[{"{", "}"}]}], ")"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{"newt", ",", 
               RowBox[{"TooltipDisplay", "\[Rule]", 
                RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}]}], 
              "]"}], ",", "True", ",", 
             RowBox[{"newt", "/.", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"TooltipDisplay", "\[Rule]", "td_"}], ")"}], 
               "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"TooltipDisplay", "\[Rule]", 
                 RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], 
                ")"}]}]}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"newt", "=", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"TooltipStyleNoPart", "[", "newt", "]"}], "===", 
               RowBox[{"{", "}"}]}], ")"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{"newt", ",", 
               RowBox[{"TooltipStyle", "\[Rule]", 
                RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}]}], "]"}], 
             ",", "True", ",", 
             RowBox[{"newt", "/.", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"TooltipStyle", "\[Rule]", "tts_"}], ")"}], "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"TooltipStyle", "\[Rule]", 
                 RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], 
                ")"}]}]}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         StyleBox[
          RowBox[{"Final", " ", "output"}],
          FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
        "newt"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"CoordinateTransformation", " ", "for", " ", 
     StyleBox["Christoffel",
      FontColor->RGBColor[0.5, 0, 0.5]]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CoordinateTransformation", "[", 
       RowBox[{
        RowBox[{"chr_Tensor", "/;", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"TensorTypeNoPart", "[", "chr", "]"}], ",", 
            "\"\<ChristoffelSymbols\>\""}], "]"}], "=!=", 
          RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", ",", 
        RowBox[{"ct", ":", 
         RowBox[{"{", 
          RowBox[{"Repeated", "[", 
           RowBox[{"Rule", "[", 
            RowBox[{"_Symbol", ",", "_"}], "]"}], "]"}], "}"}]}], ",", 
        RowBox[{"newcoords", ":", 
         RowBox[{"{", 
          RowBox[{"Repeated", "[", "_Symbol", "]"}], "}"}]}], ",", 
        RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{"check", " ", "same", " ", "coordinates"}], " ", "*)"}], 
         RowBox[{
          RowBox[{"Sort", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "&"}], "/@", "ct"}], "]"}], "===", 
          RowBox[{"Sort", "[", 
           RowBox[{"Coordinates", "[", "chr", "]"}], "]"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RankNumber", "[", "chr", "]"}], "===", "3"}], ")"}], 
        RowBox[{"(*", 
         RowBox[{"No", " ", "OverHat", " ", "Indices"}], "*)"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"OverHatSgn", "[", "#", "]"}], "&"}], "/@", 
             RowBox[{"Indices", "[", "chr", "]"}]}], ",", "1"}], "]"}], "===", 
          RowBox[{"{", "}"}]}], ")"}], 
        RowBox[{"(*", 
         RowBox[{
         "nduced", " ", "Christoffel", " ", "is", " ", "not", " ", "allowed", 
          " ", "in", " ", "this", " ", 
          RowBox[{"code", "."}]}], "*)"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Dimensions", "[", 
           RowBox[{"Coordinates", "[", "chr", "]"}], "]"}], "===", 
          RowBox[{"Dimensions", "[", "newcoords", "]"}]}], ")"}]}], ")"}]}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "coords", ",", "lgth", ",", "jacobm", ",", "jacobT", ",", 
          "invjacobT", ",", "R", ",", "dlist", ",", "drhs", ",", "lgthrhs", 
          ",", "indices", ",", "idxl", ",", "newchr", ",", "name", ",", "si", 
          ",", "cps", ",", "grandom", ",", "DoubleD", ",", "Secondterm", ",", 
          "kk", ",", "Firstterm", ",", "disp", ",", "i", ",", "j", ",", "k", 
          ",", "l", ",", "hessian", ",", "invjacobm"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          StyleBox["Indices",
           FontColor->RGBColor[1, 0, 1]], " ", "of", " ", "input", " ", 
          "Christoffel"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"indices", "=", 
          RowBox[{"RemoveUnderBarredIndices", "[", 
           RowBox[{"Indices", "[", "chr", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           StyleBox["RankNumber",
            FontColor->RGBColor[1, 0, 1]], ":", " ", 
           RowBox[{
            RowBox[{"Christoffel", " ", "is", " ", "a", " ", "rank"}], "-", 
            RowBox[{"3", " ", 
             RowBox[{"array", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"idxl", "=", "3"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Determine", " ", "the", " ", "output", " ", 
           StyleBox[
            RowBox[{"Indices", "."}],
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"OptionValue", "[", "Indices", "]"}], "]"}], "===", 
            "idxl"}], ",", "\[IndentingNewLine]", 
           RowBox[{"indices", "=", 
            RowBox[{"OptionValue", "[", "Indices", "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           StyleBox["Dimension",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[":",
            FontColor->RGBColor[1, 0, 1]], " ", 
           RowBox[{
           "length", " ", "of", " ", "coordinates", " ", "transformation", 
            " ", "list"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"lgth", "=", 
          RowBox[{"Length", "[", "ct", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"New", " ", 
           RowBox[{
            StyleBox["Dimension",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[":",
             FontColor->RGBColor[1, 0, 1]], " ", 
            RowBox[{"length", " ", "of", " ", 
             RowBox[{"newcoords", ".", " ", "Right"}], " ", "now", " ", 
             RowBox[{"it", "'"}], "s", " ", "might", " ", "be", " ", 
             RowBox[{"redundent", ".", " ", "Since"}], " ", "this", " ", 
             "piece", " ", "of", " ", "code", " ", "do", " ", "not", " ", 
             "cover", " ", "induced", " ", 
             RowBox[{"Christoffel", "."}]}]}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"lgthrhs", "=", 
          RowBox[{"Length", "[", "newcoords", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Extract", " ", 
           StyleBox["old",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["coordinates",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"coords", "=", 
          RowBox[{"Coordinates", "[", "chr", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Generate", " ", "a", " ", 
           StyleBox["list",
            FontColor->RGBColor[1, 0, 1]], " ", "with", " ", 
           RowBox[{"\[DifferentialD]", " ", "in"}], " ", "front", " ", "of", 
           " ", 
           RowBox[{"coordinates", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"dlist", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"\[DifferentialD]", 
             RowBox[{
             "coords", "\[LeftDoubleBracket]", "#", 
              "\[RightDoubleBracket]"}]}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", "lgth"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Generate", " ", "a", " ", 
           StyleBox["list",
            FontColor->RGBColor[1, 0, 1]], " ", "with", " ", 
           RowBox[{"\[DifferentialD]", " ", "in"}], " ", "front", " ", "of", 
           " ", 
           RowBox[{"newcoords", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"drhs", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"\[DifferentialD]", 
             RowBox[{
             "newcoords", "\[LeftDoubleBracket]", "#", 
              "\[RightDoubleBracket]"}]}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", "lgthrhs"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"R", ":", " ", 
           RowBox[{"Jacobian", " ", "replacement", " ", "rule", " ", 
            RowBox[{"list", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"R", "=", 
          RowBox[{"CoordinateTransformation", "[", 
           RowBox[{"ct", ",", "newcoords"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Generate", " ", 
           StyleBox["Jacobian",
            FontColor->RGBColor[1, 0, 1]], " ", "as", " ", 
           StyleBox["d",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["*",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["d",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["matrix",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["form",
             FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"jacobm", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Coefficient", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "dlist", "\[LeftDoubleBracket]", "a", 
                "\[RightDoubleBracket]"}], "/.", "R"}], ",", 
              RowBox[{
              "drhs", "\[LeftDoubleBracket]", "b", 
               "\[RightDoubleBracket]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", "1", ",", "lgthrhs"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "1", ",", "lgth"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Generate", " ", 
           StyleBox["Jacobian",
            FontColor->RGBColor[1, 0, 1]], " ", "as", " ", "a", " ", 
           StyleBox["Tensor",
            FontColor->RGBColor[1, 0, 1]], " ", 
           RowBox[{"object", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"jacobT", "=", 
          RowBox[{"NonMetricTensor", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "-"], ",", 
              SuperscriptBox["k", "-"]}], "}"}], ",", "jacobm", ",", 
            "\"\<J\>\"", ",", 
            RowBox[{"Coordinates", "\[Rule]", "newcoords"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Generate", " ", 
           StyleBox["Hessian",
            FontColor->RGBColor[1, 0, 1]], " ", "as", " ", "a", " ", 
           StyleBox["Tensor",
            FontColor->RGBColor[1, 0, 1]], " ", "object", " ", "by", " ", 
           "utilize", " ", 
           RowBox[{
           "\"\<\!\(\*StyleBox[\"PartialD\",FontColor->RGBColor[1, 0, 1]]\)\>\
\"", ".", " ", "Search"}], " ", 
           RowBox[{
           "\"\<\!\(\*StyleBox[\"Derivative\",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\"for\",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\"Tensor\",FontColor->RGBColor[0.5, 0, 0.5]]\)\>\"", 
            "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"hessian", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"jacobT", ",", 
              RowBox[{
              "newcoords", "\[LeftDoubleBracket]", "\[Sigma]", 
               "\[RightDoubleBracket]"}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\[Sigma]", ",", "1", ",", "lgthrhs"}], "}"}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"#", ",", "0", ",", 
                   RowBox[{"lgthrhs", "-", "1"}]}], "}"}], "&"}], "/@", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "k"}], "}"}]}], ")"}]}], "]"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Generate", " ", 
           StyleBox["inverse",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["Jacobian",
            FontColor->RGBColor[1, 0, 1]], " ", "as", " ", "d", "*", "d", " ",
            "matrix", " ", 
           RowBox[{"form", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"invjacobm", "=", 
          RowBox[{"Inverse", "[", "jacobm", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Contract", " ", 
           StyleBox["inverse",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["Jacobian",
            FontColor->RGBColor[1, 0, 1]], "  ", "and", " ", 
           StyleBox["Hessian",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], "by", " ", 
           RowBox[{"hand", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Secondterm", "=", 
          RowBox[{"NonMetricTensor", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["k", "-"], ",", 
              SuperscriptBox["l", "-"], ",", 
              SubscriptBox["j", "-"], ",", 
              SubscriptBox["i", "-"], ",", 
              SuperscriptBox["k", "-"]}], "}"}], ",", 
            RowBox[{"TensorProduct", "[", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"{", 
               RowBox[{"invjacobm", ",", "hessian"}], "}"}]}], "]"}], ",", 
            "\"\<S\>\"", ",", 
            RowBox[{"Coordinates", "\[Rule]", "newcoords"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "The", " ", "first", " ", "term", " ", "is", " ", "the", " ", "one",
            " ", "transform", " ", "like", " ", "a", " ", "normal", " ", 
           RowBox[{"tensor", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Firstterm", "=", 
          RowBox[{"CoordinateTransformation", "[", 
           RowBox[{
            RowBox[{"chr", "/.", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
               "TensorType", "\[Rule]", "\"\<ChristoffelSymbols\>\""}], ")"}],
               "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"TensorType", "\[Rule]", "Null"}], ")"}]}]}], ",", 
            "ct", ",", "newcoords", ",", 
            RowBox[{"Indices", "\[Rule]", "indices"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Sum", " ", "them", " ", 
           RowBox[{"up", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"cps", "=", 
          RowBox[{
           RowBox[{"TensorComponents", "[", 
            RowBox[{"Firstterm", "+", "Secondterm"}], "]"}], "//", 
           RowBox[{
           "OptionValue", "[", "CoordinateTransformationOperator", "]"}]}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Determine", " ", "the", " ", "output", " ", 
           StyleBox["TensorName",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"name", "=", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"OptionValue", "[", "TensorName", "]"}], ",", 
              "_Integer"}], "]"}], ",", 
            RowBox[{"TensorName", "[", "chr", "]"}], ",", "True", ",", 
            RowBox[{"OptionValue", "[", "TensorName", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Determine", " ", "the", " ", "output", " ", 
           StyleBox["StartIndex",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"si", "=", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"OptionValue", "[", "StartIndex", "]"}], ",", 
               "_Integer"}], "]"}]}], ",", 
            RowBox[{"StartIndex", "[", "chr", "]"}], ",", "True", ",", 
            RowBox[{"OptionValue", "[", "StartIndex", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Determine", " ", "the", " ", "output", " ", 
           StyleBox["TooltipDisplay",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"disp", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Row", "[", 
                RowBox[{"{", 
                 RowBox[{"\"\<\[CapitalGamma]\>\"", ",", 
                  RowBox[{"Column", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "newcoords", "\[LeftDoubleBracket]", "\[Mu]s", 
                    "\[RightDoubleBracket]"}], ",", "Null"}], "}"}], "]"}], 
                  ",", 
                  RowBox[{"Column", "[", 
                   RowBox[{"{", 
                    RowBox[{"Null", ",", 
                    RowBox[{
                    "newcoords", "\[LeftDoubleBracket]", "\[Alpha]s", 
                    "\[RightDoubleBracket]"}]}], "}"}], "]"}], ",", 
                  RowBox[{"Column", "[", 
                   RowBox[{"{", 
                    RowBox[{"Null", ",", 
                    RowBox[{
                    "newcoords", "\[LeftDoubleBracket]", "\[Beta]s", 
                    "\[RightDoubleBracket]"}]}], "}"}], "]"}]}], "}"}], "]"}],
                "\[Rule]", 
               RowBox[{"cps", "\[LeftDoubleBracket]", 
                RowBox[{"\[Mu]s", ",", "\[Alpha]s", ",", "\[Beta]s"}], 
                "\[RightDoubleBracket]"}]}], ")"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Mu]s", ",", "1", ",", "lgthrhs"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Alpha]s", ",", "1", ",", "lgthrhs"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Beta]s", ",", "1", ",", "lgthrhs"}], "}"}]}], "]"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Only", " ", "display", " ", 
           StyleBox["nonzero",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["components",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"disp", "=", 
          RowBox[{"Select", "[", 
           RowBox[{"disp", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Flatten", "[", 
                 RowBox[{"Cases", "[", 
                  RowBox[{
                   RowBox[{"{", "#", "}"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Row", "[", "__", "]"}], "\[Rule]", "cc_"}], 
                    ")"}], "\[Rule]", "cc"}]}], "]"}], "]"}], 
                "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "=!=",
                "0"}], ")"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Inherit", " ", "old", " ", "chr", " ", "array", " ", "and", " ", 
           "replace", " ", 
           RowBox[{"w", "/", " ", "new"}], " ", 
           RowBox[{"property", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"newchr", "=", 
          RowBox[{"chr", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorName", "\[Rule]", "tn_"}], ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"TensorName", "\[Rule]", "name"}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"StartIndex", "\[Rule]", "st_"}], ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"StartIndex", "\[Rule]", "si"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
              "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"TensorComponents", "\[Rule]", "cps"}], ")"}]}], ",", 
             " ", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Coordinates", "\[Rule]", "coords"}], ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"Coordinates", "\[Rule]", "newcoords"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Indices", "\[Rule]", "idx_"}], ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"Indices", "\[Rule]", "indices"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TooltipDisplay", "\[Rule]", "dp_"}], ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"TooltipDisplay", "\[Rule]", "disp"}], ")"}]}]}], 
            "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           StyleBox["TooltipDisplay",
            FontColor->RGBColor[1, 0, 1]], " ", "and", " ", 
           StyleBox["TooltipStyle",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}], "=!=", 
            "Null"}], ",", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"TooltipDisplayNoPart", "[", "newchr", "]"}], "===", 
               RowBox[{"{", "}"}]}], ")"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{"newchr", ",", 
               RowBox[{"TooltipDisplay", "\[Rule]", 
                RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}]}], "]"}], 
             ",", "True", ",", 
             RowBox[{"newchr", "=", 
              RowBox[{"newchr", "/.", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"TooltipDisplay", "\[Rule]", "td_"}], ")"}], 
                "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"TooltipDisplay", "\[Rule]", 
                  RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], 
                 ")"}]}]}]}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"newchr", "=", 
            RowBox[{"newchr", "/.", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TooltipStyle", "\[Rule]", "tts_"}], ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"TooltipStyle", "\[Rule]", 
                RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], 
               ")"}]}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"TooltipStyleNoPart", "[", "newchr", "]"}], "===", 
               RowBox[{"{", "}"}]}], ")"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{"newchr", ",", 
               RowBox[{"TooltipStyle", "\[Rule]", 
                RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}]}], "]"}], 
             ",", "True", ",", 
             RowBox[{"newchr", "=", 
              RowBox[{"newchr", "/.", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"TooltipStyle", "\[Rule]", "tts_"}], ")"}], 
                "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"TooltipStyle", "\[Rule]", 
                  RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], 
                 ")"}]}]}]}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          StyleBox[
           RowBox[{"Final", " ", "output"}],
           FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
         "newchr"}]}], "\[IndentingNewLine]", "]"}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "check", " ", "if", " ", "user", " ", "input", " ", "new", " ", 
         "indices", " ", "list"}], ",", " ", 
        RowBox[{"they", " ", "are", " ", 
         RowBox[{"proper", ".", " ", "Or"}], " ", "it", " ", "should", " ", 
         "be", " ", "default", " ", "one", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Null", " ", "list"}], ")"}], "."}]}]}], "*)"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
            RowBox[{"OptionValue", "[", "Indices", "]"}]}], ")"}], "===", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
            RowBox[{"Indices", "[", "chr", "]"}]}], ")"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
           RowBox[{"OptionValue", "[", "Indices", "]"}]}], "===", 
          RowBox[{"{", "}"}]}], ")"}]}], ")"}]}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5766860372595043`*^9, 3.5766861748361464`*^9}, {
   3.576686207081403*^9, 3.5766862542090855`*^9}, {3.5766863122567873`*^9, 
   3.576686315220793*^9}, {3.5857176653762712`*^9, 3.5857176751106887`*^9}, {
   3.61152555817948*^9, 3.611525594725541*^9}, {3.6115257192804546`*^9, 
   3.611525732531658*^9}, {3.611525762862624*^9, 3.611525785828477*^9}, {
   3.6115259642452183`*^9, 3.6115259702438107`*^9}, 3.611526048675515*^9, {
   3.611526127082219*^9, 3.6115261313572855`*^9}, {3.6115263381834626`*^9, 
   3.611526346402089*^9}, {3.6115264737210445`*^9, 3.611526481127158*^9}, {
   3.631213472477243*^9, 3.6312135552955914`*^9}, {3.791373775114976*^9, 
   3.791373800937765*^9}, {3.791373845939101*^9, 3.7913738521218815`*^9}, {
   3.791373883418435*^9, 3.7913739122953753`*^9}, {3.791374077604042*^9, 
   3.7913740859229364`*^9}, {3.7913742842108393`*^9, 3.791374381056077*^9}, {
   3.7913744440610085`*^9, 3.7913744524976625`*^9}, {3.7913745766614137`*^9, 
   3.7913746033916826`*^9}, {3.7913750795520983`*^9, 
   3.7913751275068636`*^9}, {3.791375169984248*^9, 3.7913754744698925`*^9}, {
   3.791375549255173*^9, 3.7913755893242836`*^9}, {3.7913757000156403`*^9, 
   3.7913757849045725`*^9}, {3.791375822180374*^9, 3.791375833831088*^9}, {
   3.7913760032939596`*^9, 3.791376022463707*^9}, {3.791376152831176*^9, 
   3.791376173181718*^9}, {3.791376312073864*^9, 3.791376393969635*^9}, {
   3.791376761430072*^9, 3.791376766372392*^9}, {3.791376823485746*^9, 
   3.791376823721032*^9}, {3.7913769724436283`*^9, 3.7913769730038176`*^9}, {
   3.791377007726359*^9, 3.791377034933732*^9}, {3.791378096082344*^9, 
   3.791378121287795*^9}, {3.791378351938716*^9, 3.7913784424713683`*^9}, {
   3.813531869316082*^9, 3.8135318754866095`*^9}, {3.8135321987328243`*^9, 
   3.8135322688580503`*^9}, {3.813532612839867*^9, 3.813532641067562*^9}, {
   3.8302991722508783`*^9, 3.8302991971752295`*^9}, {3.831262773437828*^9, 
   3.8312627946575546`*^9}, {3.831262885929614*^9, 3.83126295941741*^9}, {
   3.8312630445574408`*^9, 3.8312630452274733`*^9}, {3.831263269887483*^9, 
   3.8312632746378884`*^9}, {3.831263900667856*^9, 3.83126392199778*^9}, {
   3.8312640000175867`*^9, 3.831264019377539*^9}, {3.8312642944556017`*^9, 
   3.83126429756776*^9}, {3.8312651495381556`*^9, 3.831265271938054*^9}, {
   3.8312653524080353`*^9, 3.831265390347721*^9}, {3.8312654470632105`*^9, 
   3.831265453538062*^9}, {3.8312655604847045`*^9, 3.831265632828084*^9}, {
   3.831265677608101*^9, 3.8312657207479196`*^9}, 3.8312658567079782`*^9, {
   3.8312659127557898`*^9, 3.8312659306872306`*^9}, {3.83126599174815*^9, 
   3.831266061408039*^9}, {3.8312661524553366`*^9, 3.8312661614747543`*^9}, 
   3.831266266595829*^9, {3.8312664417517304`*^9, 3.831266452901108*^9}, {
   3.8312665496405935`*^9, 3.8312665504586477`*^9}, 3.831267667876541*^9, {
   3.831267817266686*^9, 3.831267850897955*^9}, {3.831268008162943*^9, 
   3.83126800840481*^9}, {3.831268070797202*^9, 3.8312680939423895`*^9}, {
   3.8316769466830792`*^9, 3.831676948680995*^9}, {3.8316773995174656`*^9, 
   3.83167740797581*^9}, 3.832239670727999*^9, 3.832240540193565*^9, {
   3.83397304067356*^9, 3.8339730627705727`*^9}, {3.8339739546125712`*^9, 
   3.8339739683865705`*^9}, {3.833974013848563*^9, 3.833974029292571*^9}, {
   3.8339746251335607`*^9, 3.83397463138557*^9}, {3.8339747355895615`*^9, 
   3.8339747481965604`*^9}, {3.833974859509572*^9, 3.8339748636765604`*^9}, {
   3.8339749020545645`*^9, 3.8339749137625713`*^9}, 3.834180361240376*^9, {
   3.8341804215463667`*^9, 3.8341804826634245`*^9}, {3.834180643074933*^9, 
   3.834180791744959*^9}, 3.8344569848822765`*^9, {3.834461959265718*^9, 
   3.834461980551714*^9}, {3.8344623632354026`*^9, 3.8344623726371145`*^9}, {
   3.834632805079589*^9, 3.834632805369529*^9}, {3.8346328506516705`*^9, 
   3.8346328515892024`*^9}, 3.8346409452956944`*^9, 3.8346410073811364`*^9, {
   3.8346410402057204`*^9, 3.8346411198162208`*^9}, {3.834641164386244*^9, 
   3.834641208056117*^9}, {3.8346413387079678`*^9, 3.834641365438099*^9}, {
   3.8346415043608437`*^9, 3.8346416707958107`*^9}, {3.8346417024758277`*^9, 
   3.834641729106323*^9}, 3.8346417784985933`*^9, {3.8346420553885183`*^9, 
   3.834642059735894*^9}, {3.834642163215891*^9, 3.8346421857950325`*^9}, 
   3.8346422969459443`*^9, 3.8346424544659023`*^9, {3.834642527595927*^9, 
   3.8346425677759295`*^9}, {3.834642621335927*^9, 3.834642660466186*^9}, {
   3.8346427619559884`*^9, 3.8346428423142495`*^9}, {3.8346429206659594`*^9, 
   3.834642982155967*^9}, {3.834643051771033*^9, 3.834643075138304*^9}, {
   3.83464312169599*^9, 3.8346431570861025`*^9}, {3.8346431900060205`*^9, 
   3.8346431943361645`*^9}, {3.8346432511965218`*^9, 
   3.8346433281061287`*^9}, {3.834643423366362*^9, 3.8346434247560844`*^9}, {
   3.8346435017661133`*^9, 3.834643502226549*^9}, {3.8346436921211205`*^9, 
   3.8346436957065125`*^9}, {3.834643758258899*^9, 3.8346437778384132`*^9}, {
   3.834643910946554*^9, 3.8346439332361393`*^9}, {3.8346441239361553`*^9, 
   3.834644134182126*^9}, {3.8346441643466015`*^9, 3.8346441816164074`*^9}, 
   3.8346442578064933`*^9, {3.834644330146165*^9, 3.834644385886299*^9}, {
   3.8346444260361595`*^9, 3.8346444799887905`*^9}, {3.834644540926159*^9, 
   3.834644560236623*^9}, {3.834644603531491*^9, 3.8346446064156685`*^9}, {
   3.8346447991466894`*^9, 3.83464481476143*^9}, {3.834644855491501*^9, 
   3.8346448875466967`*^9}, {3.8346449296262236`*^9, 3.834644983426652*^9}, {
   3.834645153303463*^9, 3.8346451571989517`*^9}, {3.83464525774662*^9, 
   3.834645292972023*^9}, {3.834659316768429*^9, 3.834659324768429*^9}, {
   3.834659626472149*^9, 3.8346596282221365`*^9}, {3.8346596803940134`*^9, 
   3.834659743581521*^9}, {3.8346615976567926`*^9, 3.8346616108914986`*^9}, {
   3.8346623758241253`*^9, 3.8346623779143295`*^9}, {3.83466275668042*^9, 
   3.834662764132884*^9}, {3.834662872991097*^9, 3.834662886644603*^9}, {
   3.8346630353970356`*^9, 3.834663040064489*^9}, {3.834663154236847*^9, 
   3.834663156172061*^9}, {3.8346632002709827`*^9, 3.83466321623462*^9}, {
   3.8346633478489656`*^9, 3.8346635616846848`*^9}, {3.8346636246446304`*^9, 
   3.834663698516676*^9}, {3.834663809844703*^9, 3.8346638125045633`*^9}, {
   3.8346639922043304`*^9, 3.834664020231512*^9}, {3.834664053594386*^9, 
   3.834664057514188*^9}, {3.8346641299422474`*^9, 3.8346641355602026`*^9}, {
   3.834664279721854*^9, 3.834664280311626*^9}, {3.83466432149695*^9, 
   3.834664321671835*^9}, {3.834664382531965*^9, 3.8346644399022274`*^9}, {
   3.834664501002262*^9, 3.834664534621837*^9}, 3.8346645888022785`*^9, {
   3.834664667584591*^9, 3.8346646739109936`*^9}, 3.8346647186123285`*^9, {
   3.8346649361019945`*^9, 3.83466494293187*^9}, {3.835230876615305*^9, 
   3.8352308812053065`*^9}, {3.8352312426263385`*^9, 3.835231263599336*^9}, 
   3.83523274359801*^9, 3.8352355385790834`*^9, {3.835236122579385*^9, 
   3.8352361380815697`*^9}, 3.8352408516950192`*^9, {3.835241002024505*^9, 
   3.8352410219647503`*^9}, {3.8352410761647573`*^9, 
   3.8352411025269384`*^9}, {3.835241721204963*^9, 3.835241775414659*^9}, {
   3.8352418324448214`*^9, 3.8352418352346992`*^9}, {3.8352418690216584`*^9, 
   3.8352418916046104`*^9}, {3.8352430574647636`*^9, 3.835243133425039*^9}, {
   3.8352431855587187`*^9, 3.835243205214796*^9}, {3.835243410115445*^9, 
   3.835243449774908*^9}, 3.8352436927148457`*^9, {3.835260427327055*^9, 
   3.8352604593310194`*^9}, {3.836478841347335*^9, 3.836478844105544*^9}, {
   3.8364792695423393`*^9, 3.8364792729594707`*^9}, {3.836479438933189*^9, 
   3.8364794439554005`*^9}, {3.836528590183087*^9, 3.836528596458969*^9}, {
   3.8365292101953654`*^9, 3.8365292104563646`*^9}, {3.8365293059976087`*^9, 
   3.836529310161163*^9}, {3.837835229956184*^9, 3.837835291611537*^9}, {
   3.8378378536207695`*^9, 3.8378378598553658`*^9}, 3.8378379187679663`*^9, {
   3.8378383971560125`*^9, 3.8378384055885706`*^9}, 3.8381787595840764`*^9, {
   3.8381792461695576`*^9, 3.8381792526642027`*^9}, 3.8381821502569027`*^9, {
   3.838196329220991*^9, 3.838196366412893*^9}, {3.8381964728524733`*^9, 
   3.8381965193576775`*^9}, {3.838196562572216*^9, 3.8381966226125317`*^9}, {
   3.8381967179027476`*^9, 3.83819680095301*^9}, {3.838941430833702*^9, 
   3.838941433273188*^9}, {3.8389414736534853`*^9, 3.838941480219411*^9}, {
   3.8389415643949904`*^9, 3.8389415836430416`*^9}, {3.8389416516763315`*^9, 
   3.8389416520422907`*^9}, {3.8389417464591*^9, 3.8389417470229487`*^9}, {
   3.838941782078619*^9, 3.838941799560769*^9}, 3.8389418582413216`*^9, {
   3.8389418908555727`*^9, 3.8389419098786163`*^9}, 3.8389419625588913`*^9, {
   3.8389420072221684`*^9, 3.838942023059643*^9}, 3.838942118839542*^9, {
   3.8389422875808764`*^9, 3.838942292656728*^9}, {3.838942465955798*^9, 
   3.8389425497289095`*^9}, {3.8519474446226397`*^9, 3.8519474689081783`*^9}, 
   3.851947657755291*^9, {3.8519846352386665`*^9, 3.8519846504732904`*^9}, {
   3.8519847173031654`*^9, 3.8519847746268835`*^9}, {3.851984835806229*^9, 
   3.8519848594586744`*^9}, {3.8519849207816105`*^9, 
   3.8519849222547064`*^9}, {3.851984987345701*^9, 3.851984991797963*^9}, {
   3.8519854168016357`*^9, 3.8519854176181335`*^9}, {3.851985619818688*^9, 
   3.8519856584009404`*^9}, {3.8519857933984814`*^9, 3.85198586818945*^9}, {
   3.851995440082447*^9, 3.8519954402625957`*^9}, {3.8520003550651927`*^9, 
   3.85200037884506*^9}, {3.852000444985998*^9, 3.852000592147633*^9}, {
   3.852001260268153*^9, 3.852001288840613*^9}, {3.852001567651076*^9, 
   3.85200159708597*^9}, {3.8520016281553907`*^9, 3.852001660087246*^9}, {
   3.8520020262326803`*^9, 3.85200207164746*^9}, {3.8520021532818995`*^9, 
   3.85200215977687*^9}, {3.852002257110978*^9, 3.852002258781122*^9}, {
   3.852002335670207*^9, 3.8520023650950546`*^9}, {3.852002472854662*^9, 
   3.8520024931294746`*^9}, {3.852002543898943*^9, 3.8520026758379354`*^9}, 
   3.8520029504156837`*^9, {3.852003038920529*^9, 3.852003039155536*^9}, {
   3.852003221413771*^9, 3.852003222193513*^9}, {3.852003688801026*^9, 
   3.852003689245734*^9}, {3.8520044834370694`*^9, 3.8520044913399096`*^9}, 
   3.852004596473931*^9, {3.8520047513625917`*^9, 3.8520047559426823`*^9}, {
   3.8520050416464043`*^9, 3.852005076571128*^9}, 3.852005561627511*^9, {
   3.8520056939379826`*^9, 3.85200570949446*^9}, {3.8520057759692173`*^9, 
   3.85200577937274*^9}, {3.852005878800118*^9, 3.852005896778963*^9}, 
   3.852005953033114*^9, {3.8520069260281925`*^9, 3.8520069884478393`*^9}, {
   3.85200724148831*^9, 3.8520072447824845`*^9}, {3.8520073030263815`*^9, 
   3.8520073903808427`*^9}, {3.8520074509227095`*^9, 
   3.8520074608742204`*^9}, {3.8520075627756796`*^9, 
   3.8520075846790094`*^9}, {3.852007700012619*^9, 3.8520077082539425`*^9}, {
   3.8520077475205393`*^9, 3.8520078049219666`*^9}, {3.8520078940324287`*^9, 
   3.852007925193779*^9}, {3.8520081917401185`*^9, 3.852008307599712*^9}, {
   3.852008391974231*^9, 3.852008580979924*^9}, {3.8520086147662163`*^9, 
   3.8520087190369277`*^9}, 3.8532183413869658`*^9, {3.854079284182682*^9, 
   3.854079380952521*^9}, {3.854079428922762*^9, 3.8540794425223026`*^9}, {
   3.854079477872908*^9, 3.8540795416323805`*^9}, {3.8540795809028273`*^9, 
   3.8540795852125497`*^9}, {3.854079661622464*^9, 3.8540796849325013`*^9}, {
   3.8540797521427517`*^9, 3.8540797862127934`*^9}, {3.854080214244691*^9, 
   3.8540802199065905`*^9}, {3.85408067567531*^9, 3.8540806886427865`*^9}, {
   3.8540808393914876`*^9, 3.8540808514728518`*^9}, {3.85408096824259*^9, 
   3.8540809785825105`*^9}, {3.854081014292982*^9, 3.8540810210983295`*^9}, {
   3.8540822468311057`*^9, 3.8540822475411277`*^9}, {3.8540822854510555`*^9, 
   3.8540823107010717`*^9}, {3.859932162165827*^9, 3.8599322481655917`*^9}, {
   3.8599330632035866`*^9, 3.859933103363799*^9}, {3.859933456912382*^9, 
   3.8599334804736323`*^9}, 3.8599335112639112`*^9, {3.8651224726271276`*^9, 
   3.8651224881896367`*^9}, {3.8655603232181425`*^9, 
   3.8655603449357166`*^9}, {3.866757276796852*^9, 3.866757284230239*^9}, {
   3.8667573251342516`*^9, 3.866757331830942*^9}, 3.8667600594699836`*^9, {
   3.8667600928889527`*^9, 3.8667600941940765`*^9}, 3.8667602550662622`*^9, {
   3.866760315970516*^9, 3.8667603168734627`*^9}, 3.866760351739221*^9, {
   3.866760553766507*^9, 3.866760553896491*^9}, {3.8667607644698286`*^9, 
   3.8667608162114105`*^9}, {3.866761021201997*^9, 3.8667610384894876`*^9}, {
   3.8667612539089365`*^9, 3.866761269138236*^9}, {3.8667613114839106`*^9, 
   3.8667613175460825`*^9}, {3.8667613727309275`*^9, 3.866761374335284*^9}, {
   3.866761478381152*^9, 3.8667614914684916`*^9}, {3.8667615582659807`*^9, 
   3.86676156164209*^9}, {3.866762028965324*^9, 3.8667621232927685`*^9}, {
   3.8667622020437737`*^9, 3.866762204580702*^9}, 3.866762792618925*^9, {
   3.8667628278761187`*^9, 3.8667628601315174`*^9}, {3.8673079628872156`*^9, 
   3.8673080458647776`*^9}, {3.867310107723305*^9, 3.8673101225724306`*^9}, {
   3.8673101568780828`*^9, 3.8673101570459766`*^9}, {3.867310202514511*^9, 
   3.867310209903311*^9}, 3.867310245339754*^9, 3.8673110459173374`*^9, {
   3.8757573654731493`*^9, 3.8757578106694517`*^9}, {3.875759448173336*^9, 
   3.8757594699397273`*^9}, 3.887259797022865*^9, 3.887259938599162*^9, 
   3.8872600205346575`*^9, {3.8872601135883245`*^9, 3.887260114738619*^9}, {
   3.887260292224229*^9, 3.88726031661516*^9}, {3.8872604715338783`*^9, 
   3.887260503120411*^9}, {3.8872623528139877`*^9, 3.8872623549576654`*^9}, {
   3.88726240196175*^9, 3.887262402917159*^9}, {3.8872624611122932`*^9, 
   3.8872624630760784`*^9}, 3.895073261787615*^9, 3.8955490520311565`*^9, {
   3.895555172541506*^9, 3.8955551726204605`*^9}, {3.8972547247446156`*^9, 
   3.8972547320403323`*^9}, {3.8972547730623674`*^9, 3.897254776630147*^9}, {
   3.897276987865556*^9, 3.8972769941306562`*^9}, {3.8972770382582183`*^9, 
   3.8972771216973343`*^9}, {3.8972773002156973`*^9, 3.897277300549489*^9}, {
   3.897277363197585*^9, 3.8972773924232583`*^9}, {3.897277525575749*^9, 
   3.8972775270988054`*^9}, {3.898384401869528*^9, 3.8983844158430395`*^9}, {
   3.967777452333681*^9, 3.9677774525847597`*^9}, {3.968835773664036*^9, 
   3.968835795696796*^9}, {3.968835960899575*^9, 3.968835983107712*^9}, {
   3.9688368663869343`*^9, 3.968836885121311*^9}, 3.9706298480928793`*^9, 
   3.970630324977743*^9, {3.970642039431889*^9, 3.970642055455494*^9}, {
   3.9706939821477623`*^9, 3.9706939979107037`*^9}, {3.970788931054195*^9, 
   3.9707889549840317`*^9}, 3.9708019839977922`*^9, 3.973764536762854*^9, {
   3.9753139357895184`*^9, 3.975314269487372*^9}, {3.9753143134975853`*^9, 
   3.975314386446661*^9}},ExpressionUUID->"af284ae8-289c-4c91-bc16-\
2f323eb155c6"]
}, Closed]],

Cell[CellGroupData[{

Cell["ZeroTensor", "Subsection",
 CellChangeTimes->{3.970886868362135*^9, 
  3.970886903775113*^9},ExpressionUUID->"e3140512-8040-4b78-a8b2-\
e77f9199e91d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ZeroTensor", "[", 
   RowBox[{"indices_List", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"NonMetricTensor", "[", 
   RowBox[{"indices", ",", 
    RowBox[{"Normal", "[", 
     RowBox[{"SymmetrizedArray", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"OptionValue", "[", "Coordinates", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"RankNumber", "[", "indices", "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"ZeroSymmetric", "[", "All", "]"}]}], "]"}], "]"}], ",", 
    RowBox[{"OptionValue", "[", "TensorName", "]"}], ",", 
    RowBox[{"Coordinates", "\[Rule]", 
     RowBox[{"OptionValue", "[", "Coordinates", "]"}]}], ",", 
    RowBox[{"StartIndex", "->", 
     RowBox[{"OptionValue", "[", "StartIndex", "]"}]}], ",", 
    RowBox[{"TooltipDisplay", "->", 
     RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], ",", 
    RowBox[{"TensorType", "->", 
     RowBox[{"OptionValue", "[", "TensorType", "]"}]}], ",", 
    RowBox[{"TooltipStyle", "->", 
     RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], ",", 
    RowBox[{"TensorAssumption", "->", 
     RowBox[{"OptionValue", "[", "TensorAssumption", "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.5760890361958838`*^9, 
   3.5760892921299334`*^9}, {3.576089327198795*^9, 3.5760893665108643`*^9}, {
   3.5760894467730045`*^9, 3.576089487177076*^9}, {3.576089599746874*^9, 
   3.576089794357215*^9}, {3.5760898355568876`*^9, 3.576089917379031*^9}, {
   3.576089953181094*^9, 3.576090082318121*^9}, {3.576560147053269*^9, 
   3.5765603514136276`*^9}, {3.5765603906008964`*^9, 3.576560411879334*^9}, {
   3.5765604668226304`*^9, 3.576560468913034*^9}, {3.5765932405918536`*^9, 
   3.576593241668256*^9}, {3.5765932876571364`*^9, 3.576593294365148*^9}, {
   3.576593413472658*^9, 3.5765934397421603`*^9}, {3.5837895835345883`*^9, 
   3.5837896999162455`*^9}, {3.583789732961135*^9, 3.5837897641899214`*^9}, {
   3.5837898029911404`*^9, 3.583789812347676*^9}, {3.5837898853688526`*^9, 
   3.583789939647957*^9}, {3.629763483304508*^9, 3.629763563401334*^9}, {
   3.6326179475223174`*^9, 3.6326179682978544`*^9}, {3.6326188774302964`*^9, 
   3.632618942045817*^9}, {3.844900612864136*^9, 3.8449006410808396`*^9}, {
   3.844900830504729*^9, 3.844900834935007*^9}, {3.844900933070919*^9, 
   3.8449009335186443`*^9}, {3.845519758647561*^9, 3.8455197656636577`*^9}, {
   3.8552692108635197`*^9, 3.8552692359430957`*^9}, {3.869789450147613*^9, 
   3.8697894649601*^9}, {3.8697897648047676`*^9, 3.8697898113081326`*^9}, {
   3.877048249565341*^9, 3.877048249940361*^9}, {3.8847714439909678`*^9, 
   3.884771463526497*^9}, {3.8865696363752375`*^9, 3.8865696456015406`*^9}, {
   3.8865709348867865`*^9, 3.8865709493098817`*^9}, {3.886571029011668*^9, 
   3.8865711098433933`*^9}, {3.8865711415568123`*^9, 3.886571221987591*^9}, {
   3.8865712792427473`*^9, 3.886571306594387*^9}, {3.8865713371215377`*^9, 
   3.8865714251931553`*^9}, {3.8865716577922697`*^9, 
   3.8865716593503084`*^9}, {3.8865717229593024`*^9, 3.886571732413467*^9}, {
   3.8865717736060305`*^9, 3.886571776470789*^9}, {3.886571821174187*^9, 
   3.8865718263649797`*^9}, {3.8865718581323643`*^9, 
   3.8865721163794327`*^9}, {3.8865721517885704`*^9, 3.886572211297825*^9}, {
   3.886572488928479*^9, 3.8865724895910697`*^9}, {3.8865726869268227`*^9, 
   3.886572699405741*^9}, {3.8865728198130307`*^9, 3.886572823013053*^9}, 
   3.8865728757325*^9, {3.8865729178195143`*^9, 3.8865729881391706`*^9}, {
   3.886573172602474*^9, 3.886573172865312*^9}, {3.886573299311857*^9, 
   3.8865733886803017`*^9}, 3.8865736908089437`*^9, {3.8865737656012077`*^9, 
   3.8865737730276213`*^9}, {3.8865738297164164`*^9, 3.8865738360195265`*^9}, 
   3.8865742829090977`*^9, {3.8865746463813815`*^9, 3.886574658755741*^9}, {
   3.8865749416487617`*^9, 3.8865749551124516`*^9}, {3.8867346888245454`*^9, 
   3.886734688843537*^9}, {3.8867377505656157`*^9, 3.886737849562188*^9}, {
   3.8867385640730906`*^9, 3.886738583824981*^9}, {3.8867386222324376`*^9, 
   3.8867386781277514`*^9}, {3.8867388690413775`*^9, 3.886738954774979*^9}, {
   3.886738990838873*^9, 3.8867390072857904`*^9}, 3.8867397517307873`*^9, 
   3.886739840287139*^9, 3.88673999530371*^9, 3.8867400476224427`*^9, {
   3.8869078564161425`*^9, 3.886907897012661*^9}, {3.887112625403908*^9, 
   3.8871126262901936`*^9}, {3.88711302324362*^9, 3.8871130307036085`*^9}, {
   3.895555838564371*^9, 3.8955558385673685`*^9}, {3.970886882908885*^9, 
   3.970886899923313*^9}, 3.970887031366228*^9, 3.970887150199112*^9, 
   3.970887513731308*^9},ExpressionUUID->"3d994c47-c5b5-42e9-ba7b-\
35164662c5b3"]
}, Closed]],

Cell[CellGroupData[{

Cell["ZeroTensorQ", "Subsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.533880012946951*^9, 3.5338800148345547`*^9}, {
   3.5760890087086353`*^9, 3.5760890111890397`*^9}, {3.583789536600904*^9, 
   3.583789562445382*^9}, {3.583789592737115*^9, 3.583789617611538*^9}, {
   3.629763445553209*^9, 3.629763458802249*^9}, 
   3.973765546004636*^9},ExpressionUUID->"a00f9896-4f06-4a88-8e52-\
0ee43a61bd0b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "ZeroTensorQ", " ", "returns", " ", "True", " ", "if", " ", "every", " ", 
    "component", " ", "of", " ", "the", " ", "input", " ", "Tensor", " ", 
    "is", " ", "zero", " ", "and", " ", "False", " ", "otherwise"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ZeroTensorQ", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"stuff_Tensor", "|", "stuff_Times", "|", "stuff_Plus"}], 
         ")"}], "/;", 
        RowBox[{"!", 
         RowBox[{"TestExpressionForm", "[", "stuff", "]"}]}]}], ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "stuffop", ",", "stuffopTorF", ",", "TIZop", ",", "TIZopTorF", ",", 
         RowBox[{"tensorcomp", "=", 
          RowBox[{"Normal", "[", 
           RowBox[{"TensorComponents", "[", "stuff", "]"}], "]"}]}]}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"stuff", "'"}], "s", " ", "TensorOperator"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"stuffop", "=", 
         RowBox[{"TensorOperator", "[", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"{", "stuff", "}"}], ",", 
             RowBox[{"Tensor", "[", "___", "]"}], ",", "Infinity"}], "]"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"stuff", "'"}], "s", " ", "TensorOperator", " ", "is", " ", 
          "Simplify", " ", "or", " ", "not", " ", 
          RowBox[{"Simplify", ".", " ", "True"}], " ", "for", " ", "not", " ", 
          RowBox[{"Simplify", ".", " ", "False"}], " ", "for", " ", 
          "Simplify"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"stuffopTorF", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"stuffop", "=!=", "Simplify"}], ")"}], ",", "True", ",", 
           "True", ",", "False"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"TIZop", "=", 
         RowBox[{"OptionValue", "[", "ZeroTensorQOperator", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"stuff", "'"}], "s", " ", "TensorOperator", " ", "is", " ", 
          "Simplify", " ", "or", " ", "not", " ", 
          RowBox[{"Simplify", ".", " ", "True"}], " ", "for", " ", "not", " ", 
          RowBox[{"Simplify", ".", " ", "False"}], " ", "for", " ", 
          "Simplify"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"TIZopTorF", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"TIZop", "=!=", "Simplify"}], ")"}], ",", "True", ",", 
           "True", ",", "False"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"non", "-", "scalar"}], " ", "*)"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Head", "[", "tensorcomp", "]"}], "===", "List"}], ")"}], 
          ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TIZopTorF", "===", "True"}], ")"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Union", "[", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Flatten", "[", "tensorcomp", "]"}], "//", "TIZop"}],
                 ")"}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"(", 
               RowBox[{"TIZopTorF", "===", "False"}], ")"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Which", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"stuffopTorF", "===", "True"}], ")"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Union", "[", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Flatten", "[", "tensorcomp", "]"}], "//", 
                   "stuffop"}], ")"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"(", 
                 RowBox[{"stuffopTorF", "===", "False"}], ")"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Union", "[", 
                 RowBox[{"Simplify", "[", 
                  RowBox[{"Flatten", "[", "tensorcomp", "]"}], "]"}], "]"}]}],
                "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
            "===", 
            RowBox[{"{", "0", "}"}]}], ")"}], ",", "\[IndentingNewLine]", 
          "True", ",", 
          RowBox[{"(", 
           RowBox[{"(*", " ", 
            RowBox[{"scalar", " ", "case"}], " ", "*)"}], 
           RowBox[{
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TIZopTorF", "===", "True"}], ")"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Simplify", "[", 
               RowBox[{"tensorcomp", ",", "TIZop"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"(", 
               RowBox[{"TIZopTorF", "===", "False"}], ")"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Which", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"stuffopTorF", "===", "True"}], ")"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"(", 
                 RowBox[{"tensorcomp", "//", "stuffop"}], ")"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"(", 
                 RowBox[{"stuffopTorF", "===", "False"}], ")"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Simplify", "[", "tensorcomp", "]"}]}], 
               "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], "===",
             "0"}], ")"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    StyleBox[
     RowBox[{"ZeroTensorQ", " ", "for", " ", "List"}],
     FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Now", " ", "we", " ", "allow", " ", "it", " ", "to", " ", "input", " ", 
     "a", " ", 
     StyleBox["List",
      FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ZeroTensorQ", "[", 
      RowBox[{"stuff_List", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Union", "[", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Flatten", "[", "stuff", "]"}], "//", 
          RowBox[{"OptionValue", "[", "ZeroTensorQOperator", "]"}]}], ")"}], 
        "]"}], "===", 
       RowBox[{"{", "0", "}"}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    StyleBox[
     RowBox[{"ZeroTensorQ", " ", "for", " ", "ExpressionForm"}],
     FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ZeroTensorQ", "[", 
      RowBox[{
       RowBox[{"stuff_", "/;", 
        RowBox[{"TestExpressionForm", "[", "stuff", "]"}]}], ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"stuff", "//", 
         RowBox[{"OptionValue", "[", "ZeroTensorQOperator", "]"}]}], ")"}], "===",
        "0"}], ")"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.5760890361958838`*^9, 
   3.5760892921299334`*^9}, {3.576089327198795*^9, 3.5760893665108643`*^9}, {
   3.5760894467730045`*^9, 3.576089487177076*^9}, {3.576089599746874*^9, 
   3.576089794357215*^9}, {3.5760898355568876`*^9, 3.576089917379031*^9}, {
   3.576089953181094*^9, 3.576090082318121*^9}, {3.576560147053269*^9, 
   3.5765603514136276`*^9}, {3.5765603906008964`*^9, 3.576560411879334*^9}, {
   3.5765604668226304`*^9, 3.576560468913034*^9}, {3.5765932405918536`*^9, 
   3.576593241668256*^9}, {3.5765932876571364`*^9, 3.576593294365148*^9}, {
   3.576593413472658*^9, 3.5765934397421603`*^9}, {3.5837895835345883`*^9, 
   3.5837896999162455`*^9}, {3.583789732961135*^9, 3.5837897641899214`*^9}, {
   3.5837898029911404`*^9, 3.583789812347676*^9}, {3.5837898853688526`*^9, 
   3.583789939647957*^9}, {3.629763483304508*^9, 3.629763563401334*^9}, {
   3.6326179475223174`*^9, 3.6326179682978544`*^9}, {3.6326188774302964`*^9, 
   3.632618942045817*^9}, {3.844900612864136*^9, 3.8449006410808396`*^9}, {
   3.844900830504729*^9, 3.844900834935007*^9}, {3.844900933070919*^9, 
   3.8449009335186443`*^9}, {3.845519758647561*^9, 3.8455197656636577`*^9}, {
   3.8552692108635197`*^9, 3.8552692359430957`*^9}, {3.869789450147613*^9, 
   3.8697894649601*^9}, {3.8697897648047676`*^9, 3.8697898113081326`*^9}, {
   3.877048249565341*^9, 3.877048249940361*^9}, {3.8847714439909678`*^9, 
   3.884771463526497*^9}, {3.8865696363752375`*^9, 3.8865696456015406`*^9}, {
   3.8865709348867865`*^9, 3.8865709493098817`*^9}, {3.886571029011668*^9, 
   3.8865711098433933`*^9}, {3.8865711415568123`*^9, 3.886571221987591*^9}, {
   3.8865712792427473`*^9, 3.886571306594387*^9}, {3.8865713371215377`*^9, 
   3.8865714251931553`*^9}, {3.8865716577922697`*^9, 
   3.8865716593503084`*^9}, {3.8865717229593024`*^9, 3.886571732413467*^9}, {
   3.8865717736060305`*^9, 3.886571776470789*^9}, {3.886571821174187*^9, 
   3.8865718263649797`*^9}, {3.8865718581323643`*^9, 
   3.8865721163794327`*^9}, {3.8865721517885704`*^9, 3.886572211297825*^9}, {
   3.886572488928479*^9, 3.8865724895910697`*^9}, {3.8865726869268227`*^9, 
   3.886572699405741*^9}, {3.8865728198130307`*^9, 3.886572823013053*^9}, 
   3.8865728757325*^9, {3.8865729178195143`*^9, 3.8865729881391706`*^9}, {
   3.886573172602474*^9, 3.886573172865312*^9}, {3.886573299311857*^9, 
   3.8865733886803017`*^9}, 3.8865736908089437`*^9, {3.8865737656012077`*^9, 
   3.8865737730276213`*^9}, {3.8865738297164164`*^9, 3.8865738360195265`*^9}, 
   3.8865742829090977`*^9, {3.8865746463813815`*^9, 3.886574658755741*^9}, {
   3.8865749416487617`*^9, 3.8865749551124516`*^9}, {3.8867346888245454`*^9, 
   3.886734688843537*^9}, {3.8867377505656157`*^9, 3.886737849562188*^9}, {
   3.8867385640730906`*^9, 3.886738583824981*^9}, {3.8867386222324376`*^9, 
   3.8867386781277514`*^9}, {3.8867388690413775`*^9, 3.886738954774979*^9}, {
   3.886738990838873*^9, 3.8867390072857904`*^9}, 3.8867397517307873`*^9, 
   3.886739840287139*^9, 3.88673999530371*^9, 3.8867400476224427`*^9, {
   3.8869078564161425`*^9, 3.886907897012661*^9}, {3.887112625403908*^9, 
   3.8871126262901936`*^9}, {3.88711302324362*^9, 3.8871130307036085`*^9}, {
   3.895555838564371*^9, 3.8955558385673685`*^9}, {3.97376554600825*^9, 
   3.9737655642241488`*^9}, {3.975314402714952*^9, 
   3.9753144206873293`*^9}},ExpressionUUID->"2f5af4b6-2f92-465b-ae16-\
6ac60fd229f1"]
}, Closed]],

Cell[CellGroupData[{

Cell["TensorEquations", "Subsection",
 CellChangeTimes->{{3.52174375309375*^9, 3.5217437626875*^9}, {
  3.669439370764881*^9, 3.669439374298902*^9}, {3.7181131427585125`*^9, 
  3.7181131460241966`*^9}, {3.718873428731206*^9, 3.7188734353831544`*^9}, {
  3.7277791595451746`*^9, 3.7277791625376096`*^9}, {3.727779261292117*^9, 
  3.7277792645777283`*^9}, {3.8494974093622155`*^9, 
  3.8494974165099134`*^9}},ExpressionUUID->"bbfd1ab0-1e50-42bd-8f51-\
869014502f0a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   StyleBox["TensorEquations",
    FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"TensorEquations", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
         "t_Tensor", "|", "t_Times", "|", "t_Plus", "|", 
          "t_NonCommutativeMultiply"}], ")"}], ",", "0"}], "]"}], "/;", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "If", " ", "head", " ", "is", " ", "Times", " ", "or", " ", "Plus"}], 
        ",", " ", 
        RowBox[{
        "there", " ", "should", " ", "be", " ", "Tensor", " ", "inside", " ", 
         "it"}]}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"!", 
        RowBox[{"TestExpressionForm", "[", "t", "]"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"comp", "=", 
         RowBox[{"Normal", "[", 
          RowBox[{"TensorComponents", "[", "t", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"(*", "DeleteDuplicates", "*)"}], 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "comp", "]"}], "=!=", "List"}], ")"}], ",", 
         RowBox[{"(", 
          RowBox[{"comp", "\[Equal]", "0"}], ")"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "comp", "]"}], "===", "List"}], ")"}], ",", 
         RowBox[{
          RowBox[{"DeleteDuplicates", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "\[Equal]", "0"}], ")"}], "&"}], "/@", 
            RowBox[{"Flatten", "[", "comp", "]"}]}], "]"}], "/.", 
          RowBox[{"(*", 
           RowBox[{"Remove", " ", "redundent", " ", "True", " ", 
            RowBox[{"result", "."}]}], "*)"}], 
          RowBox[{"True", "\[Rule]", "Nothing"}]}]}], "]"}]}], "]"}]}], ";"}],
    "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{"TensorEquations", " ", "Table", " ", "algorithm"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"TensorEquations", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
         "LHSt_Tensor", "|", "LHSt_Times", "|", "LHSt_Plus", "|", 
          "LHSt_NonCommutativeMultiply"}], ")"}], ",", 
        RowBox[{"(", 
         RowBox[{
         "RHSt_Tensor", "|", "RHSt_Times", "|", "RHSt_Plus", "|", 
          "RHSt_NonCommutativeMultiply"}], ")"}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"TestExpressionForm", "[", "LHSt", "]"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"TestExpressionForm", "[", "RHSt", "]"}]}], ")"}]}]}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "indicesFlatten", ",", "indicesDeleteDuplicates", ",", "indices", ",",
          "idx", ",", "IndicesRange", ",", "Eqns", ",", "LHStContract", ",", 
         "RHStContract", ",", "IndicesCoordSi", ",", "IndicesCoordSiLength", 
         ",", "dimRep", ",", "SiRep", ",", "outputform"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"outputform", "=", 
         RowBox[{"OptionValue", "[", "OutputForm", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"LHStContract", "=", 
         RowBox[{"ContractTensors", "[", "LHSt", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"RHStContract", "=", 
         RowBox[{"ContractTensors", "[", "RHSt", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"indicesFlatten", "=", 
         RowBox[{"RemoveUnderBarredIndices", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"{", "LHStContract", "}"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Indices", "->", "idx_"}], ")"}], "->", "idx"}], ",", 
             "Infinity"}], "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"indicesDeleteDuplicates", "=", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{
           RowBox[{"#", "&"}], "/@", "indicesFlatten"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"indices", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "&"}],
           "/@", "indicesDeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"IndicesCoordSi", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"{", "LHStContract", "}"}], ",", 
            RowBox[{
             RowBox[{"Tensor", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Indices", "->", "idx_"}], ")"}], ",", 
               RowBox[{"(", 
                RowBox[{"Coordinates", "->", "coods_"}], ")"}], ",", 
               RowBox[{"(", 
                RowBox[{"StartIndex", "->", "si_"}], ")"}], ",", "___"}], 
              "]"}], "->", 
             RowBox[{"{", 
              RowBox[{"idx", ",", "coods", ",", "si"}], "}"}]}], ",", 
            "Infinity"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"IndicesCoordSiLength", "=", 
         RowBox[{"Length", "[", "IndicesCoordSi", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dimRep", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "->", 
                RowBox[{"Length", "[", 
                 RowBox[{"IndicesCoordSi", "\[LeftDoubleBracket]", 
                  RowBox[{"ii", ",", "2"}], "\[RightDoubleBracket]"}], 
                 "]"}]}], ")"}], "&"}], "/@", 
             RowBox[{"IndicesCoordSi", "\[LeftDoubleBracket]", 
              RowBox[{"ii", ",", "1", ",", "All", ",", "1"}], 
              "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"ii", ",", "1", ",", "IndicesCoordSiLength"}], "}"}]}], 
           "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SiRep", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "->", 
                RowBox[{"IndicesCoordSi", "\[LeftDoubleBracket]", 
                 RowBox[{"ii", ",", "3"}], "\[RightDoubleBracket]"}]}], ")"}],
               "&"}], "/@", 
             RowBox[{"IndicesCoordSi", "\[LeftDoubleBracket]", 
              RowBox[{"ii", ",", "1", ",", "All", ",", "1"}], 
              "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"ii", ",", "1", ",", "IndicesCoordSiLength"}], "}"}]}], 
           "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"IndicesRange", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#", ",", 
             RowBox[{"(", 
              RowBox[{"#", "/.", "SiRep"}], ")"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "/.", "dimRep"}], ")"}], "+", 
              RowBox[{"(", 
               RowBox[{"#", "/.", "SiRep"}], ")"}], "-", "1"}]}], "}"}], 
           "&"}], "/@", "indices"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Eqns", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"LHStContract", "==", "RHStContract"}], ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"Sequence", "@@", "IndicesRange"}], "]"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Eqns", "=", 
         RowBox[{"Eqns", "/.", 
          RowBox[{"NonCommutativeMultiply", "->", "Times"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"20251127", " ", 
          RowBox[{"WH", ":", " ", 
           RowBox[{"OutputForms", " ", "for", " ", "TensorEquations"}]}]}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"outputform", "===", "BooleanQ"}], ")"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{"Flatten", "[", "Eqns", "]"}], "]"}], "===", 
              RowBox[{"{", "True", "}"}]}], ")"}], ",", "True", ",", 
            "False"}], "]"}], ",", 
          RowBox[{"(", 
           RowBox[{"outputform", "===", "Flatten"}], ")"}], ",", 
          RowBox[{"DeleteDuplicates", "[", 
           RowBox[{"Flatten", "[", "Eqns", "]"}], "]"}], ",", 
          RowBox[{"(", 
           RowBox[{"outputform", "===", "Tensor"}], ")"}], ",", 
          RowBox[{"Indices", "[", 
           RowBox[{
            RowBox[{"TensorName", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ExtractTheFirstTensor", "[", "LHSt", "]"}], "/.", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"TensorComponents", "->", "tc_"}], ")"}], "->", 
                RowBox[{"(", 
                 RowBox[{"TensorComponents", "->", "Eqns"}], ")"}]}]}], ",", 
              RowBox[{"(", 
               RowBox[{"Row", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"TensorName", "[", "LHSt", "]"}], ",", "\"\<==\>\"",
                   ",", 
                  RowBox[{"TensorName", "[", "RHSt", "]"}]}], "}"}], "]"}], 
               ")"}]}], "]"}], ",", "indicesDeleteDuplicates"}], "]"}], ",", 
          "True", ",", 
          RowBox[{"{", 
           RowBox[{"indicesDeleteDuplicates", ",", "Eqns"}], "}"}]}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorEquations", "[", 
      RowBox[{"LHSt_", ",", "RHSt_"}], "]"}], "/;", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"TestExpressionForm", "[", "LHSt", "]"}], ")"}], "&&", 
      RowBox[{"(", 
       RowBox[{"TestExpressionForm", "[", "RHSt", "]"}], ")"}]}]}], ":=", 
    RowBox[{"(", 
     RowBox[{"LHSt", "\[Equal]", "RHSt"}], ")"}]}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{"TensorEquations", " ", "For", " ", "Equal"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TensorEquations", "[", 
     RowBox[{"tEq_Equal", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"TensorEquations", "[", 
     RowBox[{
      RowBox[{"tEq", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      ",", 
      RowBox[{"tEq", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
      ",", 
      RowBox[{"OutputForm", "->", 
       RowBox[{"OptionValue", "[", "OutputForm", "]"}]}]}], "]"}]}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"TensorEquations", " ", "for", " ", "List"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TensorEquations", "[", 
     RowBox[{"tEqList_List", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"OptionValue", "[", "OutputForm", "]"}], "===", "List"}], 
       ")"}], ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"TensorEquations", "[", 
          RowBox[{"#", ",", 
           RowBox[{"OutputForm", "->", "List"}]}], "]"}], "&"}], "/@", 
        "tEqList"}], ")"}], ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"OptionValue", "[", "OutputForm", "]"}], "===", "Flatten"}], 
       ")"}], ",", 
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"TensorEquations", "[", 
            RowBox[{"#", ",", 
             RowBox[{"OutputForm", "->", "Flatten"}]}], "]"}], "&"}], "/@", 
          "tEqList"}], ")"}], "]"}], "]"}], ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"OptionValue", "[", "OutputForm", "]"}], "===", "Tensor"}], 
       ")"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"TensorEquations", "[", 
         RowBox[{"#", ",", 
          RowBox[{"OutputForm", "->", "Tensor"}]}], "]"}], "&"}], "/@", 
       "tEqList"}], ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"OptionValue", "[", "OutputForm", "]"}], "===", "BooleanQ"}], 
       ")"}], ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Union", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"TensorEquations", "[", 
            RowBox[{"#", ",", 
             RowBox[{"OutputForm", "->", "BooleanQ"}]}], "]"}], "&"}], "/@", 
          "tEqList"}], "]"}], "===", 
        RowBox[{"{", "True", "}"}]}], ")"}]}], "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.52174396084375*^9, 3.521743989140625*^9}, {
   3.52174404553125*^9, 3.52174406490625*^9}, {3.52174411178125*^9, 
   3.521744178*^9}, {3.52175753421875*^9, 3.52175753465625*^9}, {
   3.521759735640625*^9, 3.521759758125*^9}, {3.5217868350625*^9, 
   3.521786885078125*^9}, {3.52178704734375*^9, 3.521787116328125*^9}, {
   3.521787178828125*^9, 3.5217871886875*^9}, {3.521787424390625*^9, 
   3.5217874283125*^9}, {3.521787532828125*^9, 3.52178754371875*^9}, 
   3.521910410859375*^9, {3.5219174194375*^9, 3.521917422546875*^9}, {
   3.521917491703125*^9, 3.5219174925*^9}, {3.521917608890625*^9, 
   3.521917617625*^9}, {3.521918314421875*^9, 3.521918316125*^9}, {
   3.521919269328125*^9, 3.5219193048125*^9}, {3.521919497375*^9, 
   3.52191951465625*^9}, {3.521921384*^9, 3.5219213845625*^9}, {
   3.521922223546875*^9, 3.5219222338125*^9}, {3.521955617484375*^9, 
   3.521955648359375*^9}, {3.521990471359375*^9, 3.52199061959375*^9}, {
   3.521990750328125*^9, 3.521990763484375*^9}, {3.532452011949185*^9, 
   3.532452013961588*^9}, {3.532452056362463*^9, 3.5324520586088667`*^9}, {
   3.5324523712334156`*^9, 3.5324523744782214`*^9}, {3.5324524076906796`*^9, 
   3.532452416130295*^9}, {3.6297526960186977`*^9, 3.629752705008212*^9}, {
   3.6299261040969267`*^9, 3.629926110841316*^9}, 3.6694393941659937`*^9, {
   3.669441203316702*^9, 3.669441278031819*^9}, {3.6694413314969053`*^9, 
   3.669441344335925*^9}, {3.6694413927307887`*^9, 3.6694414202318296`*^9}, {
   3.669514862752521*^9, 3.6695148645345235`*^9}, {3.6695149391946507`*^9, 
   3.669514991276733*^9}, {3.669515032105801*^9, 3.66951506111785*^9}, {
   3.6695152519181633`*^9, 3.669515260451182*^9}, {3.6695153013712487`*^9, 
   3.669515312627266*^9}, {3.6695154093496957`*^9, 3.6695154099216995`*^9}, {
   3.6695167123289385`*^9, 3.669516722073496*^9}, {3.6695173941773467`*^9, 
   3.669517413711464*^9}, {3.6695188004335203`*^9, 3.669518824793914*^9}, {
   3.6695194703083725`*^9, 3.6695194811419926`*^9}, {3.6695209914193163`*^9, 
   3.669521009949376*^9}, {3.669521115596419*^9, 3.6695212488830423`*^9}, {
   3.6695213351253843`*^9, 3.6695213791829042`*^9}, {3.669523166945903*^9, 
   3.6695232008429565`*^9}, {3.6695232691576443`*^9, 
   3.6695232946376853`*^9}, {3.669523348301781*^9, 3.6695234515499983`*^9}, {
   3.6695234848580523`*^9, 3.6695234857220545`*^9}, {3.6695235958404326`*^9, 
   3.669523596974471*^9}, {3.6695236354808025`*^9, 3.66952372849792*^9}, {
   3.66952376388914*^9, 3.6695237647051687`*^9}, {3.669523797091816*^9, 
   3.6695238756779413`*^9}, {3.6695239078229923`*^9, 3.6695239452280507`*^9}, 
   3.669524104919151*^9, {3.6695244117364087`*^9, 3.6695244138805313`*^9}, {
   3.66952454961929*^9, 3.669524582457168*^9}, {3.669524667216015*^9, 
   3.669524719319178*^9}, {3.669524760089368*^9, 3.6695248023595705`*^9}, {
   3.6695248594438553`*^9, 3.669524879383955*^9}, {3.6695251507197723`*^9, 
   3.6695252045538516`*^9}, {3.669525319076599*^9, 3.6695255239586067`*^9}, {
   3.669525569509823*^9, 3.6695255843268876`*^9}, {3.669526032181349*^9, 
   3.6695260335224257`*^9}, {3.669526535424133*^9, 3.669526592160378*^9}, {
   3.6695269712790256`*^9, 3.6695270006767073`*^9}, {3.669529384680343*^9, 
   3.669529386685458*^9}, {3.6695306845557566`*^9, 3.669530688418766*^9}, 
   3.6695338215879908`*^9, {3.6696043936661644`*^9, 3.669604394425166*^9}, {
   3.6697730792502522`*^9, 3.669773086852687*^9}, {3.669821997814456*^9, 
   3.66982200572567*^9}, 3.669822439592286*^9, {3.672717485337129*^9, 
   3.6727175397682424`*^9}, {3.6727176071010933`*^9, 3.672717636492775*^9}, {
   3.6727176686836157`*^9, 3.6727177213646293`*^9}, {3.6727177702034225`*^9, 
   3.6727178572564015`*^9}, {3.672717887283119*^9, 3.6727178937694902`*^9}, {
   3.6727179404391594`*^9, 3.6727179406311703`*^9}, {3.672719714402387*^9, 
   3.672719718733203*^9}, {3.6727198336652737`*^9, 3.672719918631877*^9}, {
   3.718113152795261*^9, 3.7181131936108465`*^9}, {3.718120008664604*^9, 
   3.7181200362640686`*^9}, {3.718120083644309*^9, 3.718120084142719*^9}, {
   3.7181201654003277`*^9, 3.7181202146220803`*^9}, {3.718120257514296*^9, 
   3.7181203600643024`*^9}, {3.718120416774328*^9, 3.7181204439284606`*^9}, {
   3.718120536272476*^9, 3.718120566018412*^9}, {3.7181206683107376`*^9, 
   3.7181206878104663`*^9}, {3.718120853577713*^9, 3.718120898589381*^9}, {
   3.718121337528339*^9, 3.718121483084839*^9}, {3.71812163923243*^9, 
   3.718121681989288*^9}, {3.718121850222268*^9, 3.7181218503891525`*^9}, {
   3.7181219781023026`*^9, 3.718122044575076*^9}, {3.718122111517206*^9, 
   3.718122127839568*^9}, {3.7181675623891754`*^9, 3.718167579643383*^9}, {
   3.718167890730296*^9, 3.718167925898554*^9}, {3.7181680170534754`*^9, 
   3.718168019226018*^9}, {3.7181681770793886`*^9, 3.7181681806114984`*^9}, {
   3.718168213068512*^9, 3.718168241881523*^9}, {3.718168354431093*^9, 
   3.7181683671608443`*^9}, {3.718168522595014*^9, 3.7181685240174723`*^9}, {
   3.7181685665341315`*^9, 3.7181685916153936`*^9}, {3.718168627541527*^9, 
   3.7181686285518384`*^9}, {3.7181686869782743`*^9, 3.718168723302059*^9}, {
   3.7181688624713755`*^9, 3.718168864987712*^9}, {3.7181690228007035`*^9, 
   3.718169162996397*^9}, {3.7181692591219144`*^9, 3.718169420287557*^9}, {
   3.7181695331034083`*^9, 3.7181696882869735`*^9}, {3.718169747473213*^9, 
   3.718169774785277*^9}, {3.718169805784819*^9, 3.7181698277390833`*^9}, {
   3.718169912045196*^9, 3.718169914685809*^9}, {3.7181699598061514`*^9, 
   3.718169970324886*^9}, {3.718174849977064*^9, 3.718174901960864*^9}, {
   3.7181749447138357`*^9, 3.7181751333396473`*^9}, {3.7181751964131765`*^9, 
   3.718175299958202*^9}, {3.7181757489809313`*^9, 3.718175751121794*^9}, {
   3.7181761529552455`*^9, 3.718176156643181*^9}, {3.718177761323681*^9, 
   3.71817776185317*^9}, {3.7181779797531166`*^9, 3.718178001182824*^9}, {
   3.718178432801987*^9, 3.7181784336636972`*^9}, {3.7181785165633006`*^9, 
   3.7181785212720814`*^9}, 3.718180370619824*^9, {3.7277838546352525`*^9, 
   3.727783858169075*^9}, {3.727787467829364*^9, 3.727787495938246*^9}, {
   3.7277875756934986`*^9, 3.7277875792397604`*^9}, {3.7277876707418776`*^9, 
   3.72778770219399*^9}, {3.7277877584258285`*^9, 3.7277877915109577`*^9}, {
   3.7277878424043903`*^9, 3.7277878811264715`*^9}, 3.7277879383036757`*^9, {
   3.727788719881564*^9, 3.7277888261798315`*^9}, {3.727788912849109*^9, 
   3.7277889371845922`*^9}, {3.7277897311974845`*^9, 3.727789744827913*^9}, {
   3.7277899581351657`*^9, 3.7277900115452623`*^9}, {3.727790077297223*^9, 
   3.727790118143917*^9}, {3.7277904370689335`*^9, 3.72779068173335*^9}, {
   3.727790720372624*^9, 3.727790938406535*^9}, {3.7277909992197423`*^9, 
   3.7277910652090855`*^9}, {3.727791099381648*^9, 3.727791151586588*^9}, {
   3.72779119753117*^9, 3.727791333775207*^9}, {3.7277913649255753`*^9, 
   3.7277913932071843`*^9}, {3.727791440834066*^9, 3.727791443680626*^9}, {
   3.7277914802625117`*^9, 3.7277914963036475`*^9}, {3.727791596706025*^9, 
   3.727791632429778*^9}, {3.727791703379794*^9, 3.7277917697057447`*^9}, {
   3.7277921266899767`*^9, 3.727792128011541*^9}, {3.727836859594427*^9, 
   3.7278369493787804`*^9}, {3.727837606489853*^9, 3.727837664283385*^9}, {
   3.8407724493806095`*^9, 3.8407724507755156`*^9}, {3.840772521269809*^9, 
   3.840772561838919*^9}, 3.8407726113251805`*^9, {3.8407728203563204`*^9, 
   3.84077282884037*^9}, 3.840843520814411*^9, {3.84084355110458*^9, 
   3.840843606524502*^9}, 3.840843761720167*^9, 3.841219815037341*^9, {
   3.8412199088308015`*^9, 3.8412199564753337`*^9}, 3.8412200195293245`*^9, {
   3.8412200801236506`*^9, 3.8412201213506517`*^9}, {3.841220183972626*^9, 
   3.8412202704844627`*^9}, 3.841220343688476*^9, {3.841220471045478*^9, 
   3.8412204903984747`*^9}, {3.841220529820326*^9, 3.841220567276322*^9}, {
   3.8412206264934783`*^9, 3.8412206932614803`*^9}, {3.841220740020477*^9, 
   3.84122080573448*^9}, {3.841220850295054*^9, 3.841220894031576*^9}, {
   3.841220976430519*^9, 3.841221021565101*^9}, {3.8412212208717117`*^9, 
   3.8412212232887144`*^9}, {3.8412213151185365`*^9, 3.841221324693531*^9}, {
   3.841221715926469*^9, 3.8412217329239254`*^9}, {3.8412218195935717`*^9, 
   3.8412218202325735`*^9}, {3.841226222717462*^9, 3.8412262692575893`*^9}, {
   3.8412263374674025`*^9, 3.8412263447273617`*^9}, {3.841226450257053*^9, 
   3.841226452257242*^9}, {3.841226547637249*^9, 3.841226551347434*^9}, {
   3.8412267888636456`*^9, 3.8412268012802477`*^9}, {3.841226840088232*^9, 
   3.8412268426033783`*^9}, {3.841374778582284*^9, 3.8413748016048827`*^9}, {
   3.8413753509883113`*^9, 3.84137537446701*^9}, {3.8413754110980825`*^9, 
   3.8413754476306753`*^9}, {3.841375509218422*^9, 3.841375509386316*^9}, {
   3.8420741494651003`*^9, 3.8420741518869762`*^9}, {3.8430836490387526`*^9, 
   3.8430836892697897`*^9}, {3.8430840639774747`*^9, 3.843084097224845*^9}, {
   3.843084254078519*^9, 3.843084260616461*^9}, {3.843086139184486*^9, 
   3.843086144770327*^9}, 3.843086184585873*^9, {3.843086217684342*^9, 
   3.843086243060648*^9}, {3.8430863073994794`*^9, 3.843086324017996*^9}, {
   3.843086532412168*^9, 3.8430867154697385`*^9}, {3.8430867910647645`*^9, 
   3.843086797299054*^9}, {3.843087303135919*^9, 3.843087311531622*^9}, {
   3.8430876200860806`*^9, 3.843087626335846*^9}, {3.8430876717690125`*^9, 
   3.843087676128538*^9}, {3.8436218755549107`*^9, 3.843621884625325*^9}, {
   3.843953052171285*^9, 3.8439531331712875`*^9}, 3.8439531721087875`*^9, {
   3.843953210718161*^9, 3.843953242780662*^9}, {3.843953634960122*^9, 
   3.8439537080877857`*^9}, {3.8439537473534126`*^9, 
   3.8439539996823697`*^9}, {3.843954491581495*^9, 3.8439544928621845`*^9}, {
   3.8439545398116083`*^9, 3.8439545756232285`*^9}, {3.8439546084683695`*^9, 
   3.843954608765242*^9}, 3.8439546695440016`*^9, {3.8442942786848307`*^9, 
   3.8442942986589727`*^9}, {3.8442946485304184`*^9, 
   3.8442946507184362`*^9}, {3.8442948322958527`*^9, 3.8442948760817065`*^9}, 
   3.8494974055819693`*^9, {3.8494974439011073`*^9, 3.849497469232937*^9}, 
   3.849498807918336*^9, {3.8494989041605053`*^9, 3.849498917006427*^9}, 
   3.8494994869228063`*^9, {3.8495224371441317`*^9, 3.8495224556921625`*^9}, {
   3.8495240820795927`*^9, 3.8495240913336377`*^9}, {3.8495256785111856`*^9, 
   3.8495257730866847`*^9}, {3.849525804563687*^9, 3.849525818832687*^9}, {
   3.8495751243561454`*^9, 3.849575175020314*^9}, {3.8495761199604163`*^9, 
   3.849576149146634*^9}, {3.849576180096719*^9, 3.8495761805374513`*^9}, {
   3.8495762325623136`*^9, 3.8495763337605724`*^9}, {3.8495765806739206`*^9, 
   3.849576581809227*^9}, 3.8495768444806547`*^9, 3.849576932488044*^9, {
   3.8495779369829893`*^9, 3.8495779514302177`*^9}, {3.849578014197403*^9, 
   3.849578014895976*^9}, {3.8495784173706245`*^9, 3.849578426658496*^9}, 
   3.8496746816447744`*^9, {3.850114684456916*^9, 3.8501146891472316`*^9}, {
   3.850114744147259*^9, 3.850114778206957*^9}, {3.8501148339673586`*^9, 
   3.850114866230935*^9}, {3.8552860224834337`*^9, 3.8552861155461764`*^9}, {
   3.875758119064145*^9, 3.8757581534635124`*^9}, {3.8847700925418625`*^9, 
   3.8847700969157248`*^9}, {3.8847701892682724`*^9, 3.88477018993957*^9}, {
   3.884770625948062*^9, 3.8847707575311513`*^9}, {3.8853754990368237`*^9, 
   3.8853755164340982`*^9}, 3.88542507241416*^9, 3.8854254808705816`*^9, {
   3.8870270881831913`*^9, 3.887027094090424*^9}, {3.8871202027756996`*^9, 
   3.8871202327426343`*^9}, {3.8915848179678693`*^9, 
   3.8915848469271636`*^9}, {3.8915849087498255`*^9, 
   3.8915849234387784`*^9}, {3.8915849964233656`*^9, 3.891585045885871*^9}, 
   3.891585336959988*^9, {3.891586855025494*^9, 3.891586871288495*^9}, 
   3.8920087263740225`*^9, {3.895555838573365*^9, 3.895555838588356*^9}, {
   3.8974394851866407`*^9, 3.89743952209593*^9}, {3.8974395788959775`*^9, 
   3.8974395881512833`*^9}, {3.8974398779739237`*^9, 
   3.8974398895659885`*^9}, {3.897439927918388*^9, 3.89743993972712*^9}, {
   3.972540616576666*^9, 3.972540619854286*^9}, 3.972547730013009*^9, {
   3.972547929111981*^9, 3.972547930069261*^9}, {3.9725486382623863`*^9, 
   3.972548638819295*^9}, {3.972548826406107*^9, 3.972548828133657*^9}, 
   3.973033016678586*^9, {3.973033294321652*^9, 3.973033311689786*^9}, 
   3.973033350357911*^9, 3.973054210557234*^9, 3.9731092402396507`*^9, 
   3.973109621331974*^9, 3.973221621392416*^9, 3.9732218631852503`*^9, 
   3.9732222453887672`*^9, 3.973222568605617*^9, {3.9737448374209843`*^9, 
   3.973744841687573*^9}, {3.9737455074792757`*^9, 3.9737455085524273`*^9}, {
   3.9737455393159437`*^9, 3.9737455502275753`*^9}, 3.973745735601626*^9, {
   3.973763279219801*^9, 3.9737632846643677`*^9}, {3.973765274264579*^9, 
   3.9737652849679737`*^9}, {3.9753144309875097`*^9, 
   3.9753144853008747`*^9}},ExpressionUUID->"6bd51a80-bab0-48e3-b098-\
59a9caf39d3f"]
}, Closed]],

Cell[CellGroupData[{

Cell["TensorDivision", "Subsection",
 CellChangeTimes->{{3.8871119254294667`*^9, 
  3.887111926352727*^9}},ExpressionUUID->"8a45d202-28be-4482-b50b-\
e26fefc3992b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "TensorDivision", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Adjust", " ", "the", " ", "output", " ", "of", " ", 
    RowBox[{"TensorDivision", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TensorDivision", "[", 
      RowBox[{"(*", 
       RowBox[{"LHS", " ", "is", " ", 
        RowBox[{"numerator", "."}]}], "*)"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"LHSt_Tensor", "|", "LHSt_Times", "|", "LHSt_Plus"}], ")"}], 
       ",", 
       RowBox[{"(*", 
        RowBox[{"RHS", " ", "is", " ", 
         RowBox[{"denominator", "."}]}], "*)"}], 
       RowBox[{"(", 
        RowBox[{"RHSt_Tensor", "|", "RHSt_Times", "|", "RHSt_Plus"}], ")"}], 
       ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"!", 
        RowBox[{"TestExpressionForm", "[", "LHSt", "]"}]}], ")"}], "&&", 
      RowBox[{"(", 
       RowBox[{"!", 
        RowBox[{"TestExpressionForm", "[", "RHSt", "]"}]}], ")"}]}]}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "stuffop", ",", "stuffopTorF", ",", "TDop", ",", "TDopTorF", ",", "op",
         ",", "LHScomp", ",", "RHScomp", ",", "NonTrivialcompN", ",", 
        "EquilityList", ",", "\[Kappa]", ",", "solnst", ",", "solns", ",", 
        "solnsFlatten", ",", "solnsUnion", ",", "soln", ",", 
        RowBox[{"LHSttemp", "=", "LHSt"}], ",", 
        RowBox[{"RHSttemp", "=", "RHSt"}], ",", 
        RowBox[{"rank", "=", 
         RowBox[{"RankNumber", "[", "LHSt", "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Head", "[", "LHSt", "]"}], "===", "Times"}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Head", "[", "LHSt", "]"}], "===", "Plus"}], ")"}]}], 
          ")"}], ",", 
         RowBox[{"LHSttemp", "=", 
          RowBox[{"TensorsProduct", "[", 
           RowBox[{"LHSt", ",", " ", "Tensor"}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Head", "[", "RHSt", "]"}], "===", "Times"}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Head", "[", "RHSt", "]"}], "===", "Plus"}], ")"}]}], 
          ")"}], ",", 
         RowBox[{"RHSttemp", "=", 
          RowBox[{"TensorsProduct", "[", 
           RowBox[{"RHSt", ",", " ", "Tensor"}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"stuff", "'"}], "s", " ", "TensorOperator"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"stuffop", "=", 
        RowBox[{"TensorOperator", "[", "LHSttemp", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"stuff", "'"}], "s", " ", "TensorOperator", " ", "is", " ", 
         "Simplify", " ", "or", " ", "not", " ", 
         RowBox[{"Simplify", ".", " ", "True"}], " ", "for", " ", "not", " ", 
         RowBox[{"Simplify", ".", " ", "False"}], " ", "for", " ", 
         "Simplify"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"stuffopTorF", "=", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"stuffop", "=!=", "Simplify"}], ")"}], ",", "True", ",", 
          "True", ",", "False"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"TDop", "=", 
        RowBox[{"OptionValue", "[", "TensorDivisionOperator", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"stuff", "'"}], "s", " ", "TensorOperator", " ", "is", " ", 
         "Simplify", " ", "or", " ", "not", " ", 
         RowBox[{"Simplify", ".", " ", "True"}], " ", "for", " ", "not", " ", 
         RowBox[{"Simplify", ".", " ", "False"}], " ", "for", " ", 
         "Simplify"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"TDopTorF", "=", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"TDop", "=!=", "Simplify"}], ")"}], ",", "True", ",", 
          "True", ",", "False"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"op", "=", 
        RowBox[{"Which", "[", 
         RowBox[{
         "TDopTorF", ",", "TDop", ",", "stuffopTorF", ",", "stuffop", ",", 
          "True", ",", "TDop"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"LHScomp", "=", 
        RowBox[{
         RowBox[{"LHSttemp", "//", "TensorComponents"}], "//", "op"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"RHScomp", "=", 
        RowBox[{
         RowBox[{"RHSttemp", "//", "TensorComponents"}], "//", "op"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ComponentRankNumber", "[", "LHScomp", "]"}], "=!=", "0"}],
           ")"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NonTrivialcompN", "=", 
           RowBox[{"Length", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Flatten", "[", "LHScomp", "]"}], ")"}], "/.", 
             RowBox[{"{", 
              RowBox[{"0", "\[Rule]", "Nothing"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"EquilityList", "=", 
           RowBox[{"MapThread", "[", 
            RowBox[{"Equal", ",", 
             RowBox[{"{", 
              RowBox[{"LHScomp", ",", 
               RowBox[{"\[Kappa]", " ", "RHScomp"}]}], "}"}], ",", "rank"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"solnst", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Solve", "[", 
               RowBox[{"#", ",", "\[Kappa]"}], "]"}], "&"}], ",", 
             "EquilityList", ",", 
             RowBox[{"{", "rank", "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"solns", "=", 
           RowBox[{"solnst", "//", "op"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"solnsFlatten", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"solns", "/.", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"{", "}"}], "}"}], "->", 
                  RowBox[{"{", 
                   RowBox[{
                   "{", " ", "\"\<\!\(\*FractionBox[\(0\), \(0\)]\)\>\"", 
                    "}"}], "}"}]}], ")"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"rank", "+", "2"}]}], "}"}]}], "]"}], ")"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"{", "}"}], "\[Rule]", "\[Infinity]"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Kappa]", "\[Rule]", "soln___"}], "}"}], 
               "\[RuleDelayed]", " ", "soln"}]}], "}"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"solnsUnion", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"solnsFlatten", "//", "Flatten"}], ")"}], "//", 
              "Union"}], ")"}], "/.", 
            RowBox[{
            "\"\<\!\(\*FractionBox[\(0\), \(0\)]\)\>\"", "\[Rule]", " ", 
             "Nothing"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"solnsFlatten", "//", "Flatten"}], ")"}], "/.", 
                   RowBox[{
                   "\"\<\!\(\*FractionBox[\(0\), \(0\)]\)\>\"", "\[Rule]", 
                    " ", "Nothing"}]}], ")"}], "]"}], "===", 
                "NonTrivialcompN"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "[", "solnsUnion", "]"}], "===", "1"}], 
               ")"}]}], ")"}], ",", 
            RowBox[{
            "solnsUnion", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], ",", "True", ",", 
            RowBox[{"LHSt", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
                "\[Rule]", " ", 
                RowBox[{"(", 
                 RowBox[{"TensorComponents", "\[Rule]", 
                  RowBox[{"(", 
                   RowBox[{"solnsFlatten", "/.", 
                    RowBox[{
                    RowBox[{
                    "{", "\"\<\!\(\*FractionBox[\(0\), \(0\)]\)\>\"", "}"}], 
                    "->", "\"\<\!\(\*FractionBox[\(0\), \(0\)]\)\>\""}]}], 
                   ")"}]}], ")"}]}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"TensorName", "\[Rule]", "tn_"}], ")"}], "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"TensorName", "\[Rule]", 
                  FractionBox[
                   RowBox[{"TensorName", "[", "LHSttemp", "]"}], 
                   RowBox[{"TensorName", "[", "RHSttemp", "]"}]]}], ")"}]}]}],
               "}"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ComponentRankNumber", "[", "LHScomp", "]"}], "===", "0"}],
           ")"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Solve", "[", 
            RowBox[{
             RowBox[{"LHScomp", "\[Equal]", 
              RowBox[{"\[Kappa]", " ", "RHScomp"}]}], ",", "\[Kappa]"}], 
            "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"\[Kappa]", "\[Rule]", "soln___"}], "}"}], "}"}], 
             "\[RuleDelayed]", " ", 
             RowBox[{"(", 
              RowBox[{"soln", "//", "op"}], ")"}]}], "}"}]}], ")"}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8871119361462755`*^9, 3.887112017758164*^9}, {
   3.887112059357123*^9, 3.8871120696216364`*^9}, {3.88711241770765*^9, 
   3.887112445876791*^9}, {3.887112582185009*^9, 3.887112702840073*^9}, {
   3.8871129900373397`*^9, 3.8871130189340277`*^9}, {3.887113057012743*^9, 
   3.8871130743167067`*^9}, {3.8871131336605434`*^9, 3.887113239356813*^9}, {
   3.887115220908261*^9, 3.88711524157168*^9}, {3.887115892180296*^9, 
   3.88711590965677*^9}, {3.88711682362072*^9, 3.887117032868149*^9}, {
   3.8871174974391575`*^9, 3.8871175466390905`*^9}, {3.887117970683464*^9, 
   3.887117994987946*^9}, 3.8871180563472786`*^9, {3.8871181482343864`*^9, 
   3.887118186361709*^9}, {3.887118254808637*^9, 3.887118278337125*^9}, {
   3.8871183114336557`*^9, 3.8871183291161585`*^9}, {3.8871186542222023`*^9, 
   3.8871186637410035`*^9}, {3.8871187327013226`*^9, 3.887118737630596*^9}, {
   3.8871187818694715`*^9, 3.887118792820798*^9}, {3.887118860908371*^9, 
   3.887118871768297*^9}, {3.8871189579324584`*^9, 3.8871189784586177`*^9}, {
   3.8871190340130568`*^9, 3.8871190358183994`*^9}, {3.887119185263136*^9, 
   3.887119220339895*^9}, {3.8871573933804483`*^9, 3.8871574147169876`*^9}, 
   3.887157511275786*^9, 3.887158080238427*^9, {3.889047248117734*^9, 
   3.889047275391917*^9}, {3.889047319056067*^9, 3.889047323695837*^9}, {
   3.889047462529028*^9, 3.8890475118222685`*^9}, {3.889048426055933*^9, 
   3.8890484430084143`*^9}, {3.889334404741991*^9, 3.889334435877804*^9}, {
   3.8893345115578957`*^9, 3.8893345442125607`*^9}, 3.891584860939592*^9, {
   3.895073261803241*^9, 3.895073261803241*^9}, {3.8955395758777876`*^9, 
   3.895539616135646*^9}, {3.895555838594351*^9, 3.8955558385983496`*^9}, {
   3.9533409285000887`*^9, 3.953340936842648*^9}, 3.953341100872147*^9, 
   3.953341381543809*^9, {3.9599323152019672`*^9, 3.9599323221620607`*^9}, {
   3.959932357065592*^9, 3.9599323778823023`*^9}, {3.97531449403176*^9, 
   3.975314498421639*^9}},ExpressionUUID->"c48cf425-f1a2-4462-9c2a-\
870af9587f71"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
GeodesicSystem, GeodesicLagrangians, GeodesicHamiltonianDynamics\
\>", "Subsection",
 CellChangeTimes->{{3.52174375309375*^9, 3.5217437626875*^9}, {
  3.669439370764881*^9, 3.669439374298902*^9}, {3.7181131427585125`*^9, 
  3.7181131460241966`*^9}, {3.718873428731206*^9, 3.7188734353831544`*^9}, {
  3.796244559633416*^9, 
  3.7962445602198296`*^9}},ExpressionUUID->"3dc93e88-18fc-4b08-a0f2-\
3b0ced8ffdbc"],

Cell["\<\
GeodesicSystem takes as input
{Metric Tensor, AffineParameter, NonAffineParameter}
and produces as output:
{Lagrangian for geodesic motion in affine parameter form, 
Lag. non-affine parameter form, 
Geodesic equations in affine parameter,
Geodesic equations in non-affine parameter forms}\
\>", "Text",
 CellChangeTimes->{{3.7181132097147055`*^9, 3.718113264109483*^9}, {
  3.7181143852731085`*^9, 3.7181143974866204`*^9}, {3.7181151783546247`*^9, 
  3.7181152155867205`*^9}, {3.7181669623574867`*^9, 3.7181669718634157`*^9}, {
  3.718168163546671*^9, 3.718168165734876*^9}, {3.7181702710162296`*^9, 
  3.7181703112290707`*^9}, {3.718175343109828*^9, 
  3.7181753757743816`*^9}},ExpressionUUID->"e2214c72-9e0d-4f3b-a15d-\
6117c612dd78"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Geodesic", " ", "equations"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"GeodesicSystem", "[", 
       RowBox[{"m_Tensor", ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
      RowBox[{"TestMetricTensor", "[", "m", "]"}]}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mm", ",", "ss", ",", "\[Sigma]", ",", "\[Mu]", ",", "\[Nu]", ",", 
          "si", ",", "cooo", ",", "d", ",", "cc", ",", "coo\[Lambda]", ",", 
          "coot", ",", "a\[Lambda]", ",", "ct", ",", "comehere", ",", 
          "L\[Lambda]", ",", "Lt", ",", "output", ",", "xdot\[Lambda]", ",", 
          "xdotdot\[Lambda]", ",", "xdot\[Lambda]a", ",", "a", ",", "b", ",", 
          "xdot\[Lambda]b", ",", "i", ",", "Chr\[Lambda]", ",", 
          "Chrxdotxdot\[Lambda]", ",", "xdott", ",", "xdotdott", ",", 
          "xdotta", ",", "xdottb", ",", "Chrt", ",", "Chrxdotxdott", ",", 
          "GeodesicEqs\[Lambda]LHS", ",", "GeodesicEqs\[Lambda]", ",", 
          "GeodesicEqstLHS", ",", "GeodesicEqstRHS", ",", "GeodesicEqst", ",",
           "tpos"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"extract", " ", "affine", " ", "and", " ", "non"}], "-", 
          RowBox[{
          "affine", " ", "parameter", " ", "for", " ", "solving", " ", 
           "geodesic", " ", "eqn"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"a\[Lambda]", "=", 
          RowBox[{"OptionValue", "[", "AffineParameter", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"cooo", "=", 
          RowBox[{"Coordinates", "[", "m", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"non", "-", 
           RowBox[{"affine", " ", "parameter"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"ct", "=", 
          RowBox[{"Intersection", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"OptionValue", "[", "NonAffineParameter", "]"}], "}"}], 
            ",", "cooo"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "if", " ", "input", " ", "NonAffineParameter", " ", "is", " ", 
            "one", " ", "of", " ", "the", " ", "coordinates"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "ct", "]"}], "===", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"coot", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Which", "[", 
               RowBox[{
                RowBox[{"#", "===", 
                 RowBox[{
                 "ct", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], ",", 
                RowBox[{
                "ct", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{"#", "=!=", 
                 RowBox[{
                 "ct", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], ",", 
                RowBox[{"#", "/.", 
                 RowBox[{"#", "\[Rule]", 
                  RowBox[{"#", "[", 
                   RowBox[{
                   "ct", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}]}]}]}], "]"}], "&"}], "/@",
              "cooo"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "if", " ", "input", " ", "NonAffineParameter", " ", "is", " ", 
             "not", " ", "one", " ", "of", " ", "the", " ", "coordinates"}], 
            " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"ct", "===", 
            RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"coot", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "/.", 
                RowBox[{"#", "\[Rule]", 
                 RowBox[{"#", "[", 
                  RowBox[{"OptionValue", "[", "NonAffineParameter", "]"}], 
                  "]"}]}]}], ")"}], "&"}], "/@", "cooo"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ct", "=", 
          RowBox[{"OptionValue", "[", "NonAffineParameter", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "coordinates", " ", "as", " ", "a", " ", "function", " ", "of", " ",
            "affine", " ", "parameter"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"coo\[Lambda]", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "/.", 
              RowBox[{"#", "\[Rule]", 
               RowBox[{"#", "[", "a\[Lambda]", "]"}]}]}], ")"}], "&"}], "/@", 
           "cooo"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"d", "=", 
          RowBox[{"Length", "[", "cooo", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"xdot\[Lambda]", "=", 
          RowBox[{"D", "[", 
           RowBox[{"coo\[Lambda]", ",", "a\[Lambda]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"xdotdot\[Lambda]", "=", 
          RowBox[{"D", "[", 
           RowBox[{"xdot\[Lambda]", ",", "a\[Lambda]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"xdot\[Lambda]a", "=", 
          RowBox[{"NonMetricTensor", "[", 
           RowBox[{
            RowBox[{"{", 
             SuperscriptBox["a", "-"], "}"}], ",", "xdot\[Lambda]", ",", 
            "\"\<\!\(\*OverscriptBox[\(x\), \(.\)]\)\>\"", ",", 
            RowBox[{"Coordinates", "->", "coo\[Lambda]"}], ",", 
            RowBox[{"StartIndex", "->", 
             RowBox[{"StartIndex", "[", "m", "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"xdot\[Lambda]b", "=", 
          RowBox[{"(", 
           RowBox[{"xdot\[Lambda]a", "/.", 
            RowBox[{"{", 
             RowBox[{"a", "->", "b"}], "}"}]}], ")"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Chr\[Lambda]", "=", 
          RowBox[{
           RowBox[{"Christoffel", "[", 
            RowBox[{
             SuperscriptBox["i", "-"], ",", 
             SubscriptBox["a", "-"], ",", 
             SubscriptBox["b", "-"], ",", "m"}], "]"}], "/.", 
           RowBox[{"Thread", "[", 
            RowBox[{"Rule", "[", 
             RowBox[{"cooo", ",", "coo\[Lambda]"}], "]"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Chrxdotxdot\[Lambda]", "=", 
          RowBox[{"TensorsProduct", "[", 
           RowBox[{
           "Chr\[Lambda]", " ", "xdot\[Lambda]a", " ", "xdot\[Lambda]b"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"GeodesicEqs\[Lambda]LHS", "=", 
          RowBox[{"xdotdot\[Lambda]", "+", 
           RowBox[{"TensorComponents", "[", "Chrxdotxdot\[Lambda]", "]"}]}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"GeodesicEqs\[Lambda]", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "==", "0"}], ")"}], "&"}], "/@", 
           "GeodesicEqs\[Lambda]LHS"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"xdott", "=", 
          RowBox[{"D", "[", 
           RowBox[{"coot", ",", "ct"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"xdotdott", "=", 
          RowBox[{"D", "[", 
           RowBox[{"xdott", ",", "ct"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"xdotta", "=", 
          RowBox[{"NonMetricTensor", "[", 
           RowBox[{
            RowBox[{"{", 
             SuperscriptBox["a", "-"], "}"}], ",", "xdott", ",", 
            "\"\<\!\(\*OverscriptBox[\(x\), \(.\)]\)\>\"", ",", 
            RowBox[{"Coordinates", "->", "coot"}], ",", 
            RowBox[{"StartIndex", "->", 
             RowBox[{"StartIndex", "[", "m", "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"xdottb", "=", 
          RowBox[{"(", 
           RowBox[{"xdotta", "/.", 
            RowBox[{"{", 
             RowBox[{"a", "->", "b"}], "}"}]}], ")"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Chrt", "=", 
          RowBox[{
           RowBox[{"Christoffel", "[", 
            RowBox[{
             SuperscriptBox["i", "-"], ",", 
             SubscriptBox["a", "-"], ",", 
             SubscriptBox["b", "-"], ",", "m"}], "]"}], "/.", 
           RowBox[{"Thread", "[", 
            RowBox[{"Rule", "[", 
             RowBox[{"cooo", ",", "coot"}], "]"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Chrxdotxdott", "=", 
          RowBox[{"TensorsProduct", "[", 
           RowBox[{"Chrt", " ", "xdotta", " ", "xdottb"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "construct", " ", "affine", " ", "parameter", " ", "Lagrangian"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"L\[Lambda]", "=", 
          RowBox[{
           RowBox[{"TensorComponents", "[", 
            RowBox[{"Metric", "[", 
             RowBox[{
              RowBox[{"SubMinus", "[", "\[Mu]", "]"}], ",", 
              RowBox[{"SubMinus", "[", "\[Nu]", "]"}], ",", "m"}], "]"}], 
            "]"}], "/.", 
           RowBox[{"Thread", "[", 
            RowBox[{"Rule", "[", 
             RowBox[{"cooo", ",", "coo\[Lambda]"}], "]"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"L\[Lambda]", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}], 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"L\[Lambda]", "\[LeftDoubleBracket]", 
               RowBox[{"\[Mu]", ",", "\[Nu]"}], "\[RightDoubleBracket]"}], 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{"coo\[Lambda]", ",", "a\[Lambda]"}], "]"}], 
               "\[LeftDoubleBracket]", "\[Mu]", "\[RightDoubleBracket]"}], 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{"coo\[Lambda]", ",", "a\[Lambda]"}], "]"}], 
               "\[LeftDoubleBracket]", "\[Nu]", "\[RightDoubleBracket]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"\[Mu]", ",", "1", ",", "d"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Nu]", ",", "1", ",", "d"}], "}"}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"construct", " ", "non"}], "-", 
           RowBox[{"affine", " ", "parameter", " ", "Lagrangian"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Lt", "=", 
          RowBox[{
           RowBox[{"TensorComponents", "[", 
            RowBox[{"Metric", "[", 
             RowBox[{
              RowBox[{"SubMinus", "[", "\[Mu]", "]"}], ",", 
              RowBox[{"SubMinus", "[", "\[Nu]", "]"}], ",", "m"}], "]"}], 
            "]"}], "/.", 
           RowBox[{"Thread", "[", 
            RowBox[{"Rule", "[", 
             RowBox[{"cooo", ",", "coot"}], "]"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Lt", "=", 
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Lt", "\[LeftDoubleBracket]", 
                 RowBox[{"\[Mu]", ",", "\[Nu]"}], "\[RightDoubleBracket]"}], 
                RowBox[{
                 RowBox[{"D", "[", 
                  RowBox[{"coot", ",", "ct"}], "]"}], "\[LeftDoubleBracket]", 
                 "\[Mu]", "\[RightDoubleBracket]"}], 
                RowBox[{
                 RowBox[{"D", "[", 
                  RowBox[{"coot", ",", "ct"}], "]"}], "\[LeftDoubleBracket]", 
                 "\[Nu]", "\[RightDoubleBracket]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Mu]", ",", "1", ",", "d"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Nu]", ",", "1", ",", "d"}], "}"}]}], "]"}], "]"}], 
            ",", 
            RowBox[{"1", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"GeodesicEqstLHS", "=", 
          RowBox[{"xdotdott", "+", 
           RowBox[{"TensorComponents", "[", "Chrxdotxdott", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"GeodesicEqstRHS", "=", 
          RowBox[{
           RowBox[{"TensorComponents", "[", "xdotta", "]"}], 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"Log", "[", "Lt", "]"}], ",", "ct"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"GeodesicEqst", "=", 
          RowBox[{"Thread", "[", 
           RowBox[{"(", 
            RowBox[{"GeodesicEqstLHS", "==", "GeodesicEqstRHS"}], ")"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"tpos", "=", 
               RowBox[{"Position", "[", 
                RowBox[{"coot", ",", "ct", ",", 
                 RowBox[{"{", "1", "}"}]}], "]"}]}], ")"}], "=!=", 
             RowBox[{"{", "}"}]}], ")"}], ",", 
           RowBox[{"GeodesicEqst", "=", 
            RowBox[{"Drop", "[", 
             RowBox[{"GeodesicEqst", ",", 
              RowBox[{
              "tpos", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"output", ":", " ", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", "1", ")"}], " ", "Lag", " ", "in", " ", "affine", 
             " ", "parameter", " ", "form"}]}], ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", "2", ")"}], " ", "Lag", " ", "in", " ", "non"}], 
             "-", 
             RowBox[{"affine", " ", "parameter", " ", "form"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", "3", ")"}], " ", "Geodesic", " ", "Equations", " ", 
             "in", " ", "affine", " ", "parameter", " ", "form"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"(", "4", ")"}], " ", "Geodesic", " ", "Equations", " ",
               "in", " ", "non"}], "-", 
             RowBox[{"affine", " ", "parameter", " ", "form"}]}]}]}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
          "L\[Lambda]", ",", "Lt", ",", "GeodesicEqs\[Lambda]", ",", 
           "GeodesicEqst"}], "}"}]}]}], "\[IndentingNewLine]", "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Head", "[", 
           RowBox[{"OptionValue", "[", "AffineParameter", "]"}], "]"}], "===",
           "Symbol"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Head", "[", 
           RowBox[{"OptionValue", "[", "NonAffineParameter", "]"}], "]"}], "===",
           "Symbol"}], ")"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"GeodesicSystemVariationalMethods", "[", 
       RowBox[{"m_Tensor", ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
      RowBox[{"TestMetricTensor", "[", "m", "]"}]}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mm", ",", "ss", ",", "\[Sigma]", ",", "\[Mu]", ",", "\[Nu]", ",", 
          "si", ",", "cooo", ",", "d", ",", "cc", ",", "coo\[Lambda]", ",", 
          "coot", ",", "a\[Lambda]", ",", "ct", ",", "comehere", ",", 
          "L\[Lambda]", ",", "Lt", ",", "output"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"extract", " ", "affine", " ", "and", " ", "non"}], "-", 
          RowBox[{
          "affine", " ", "parameter", " ", "for", " ", "solving", " ", 
           "geodesic", " ", "eqn"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"a\[Lambda]", "=", 
          RowBox[{"OptionValue", "[", "AffineParameter", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"cooo", "=", 
          RowBox[{"Coordinates", "[", "m", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"non", "-", 
           RowBox[{"affine", " ", "parameter"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"ct", "=", 
          RowBox[{"Intersection", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"OptionValue", "[", "NonAffineParameter", "]"}], "}"}], 
            ",", "cooo"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "if", " ", "input", " ", "NonAffineParameter", " ", "is", " ", 
            "one", " ", "of", " ", "the", " ", "coordinates"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "ct", "]"}], "===", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"coot", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Which", "[", 
               RowBox[{
                RowBox[{"#", "===", 
                 RowBox[{
                 "ct", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], ",", 
                RowBox[{
                "ct", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{"#", "=!=", 
                 RowBox[{
                 "ct", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], ",", 
                RowBox[{"#", "/.", 
                 RowBox[{"#", "\[Rule]", 
                  RowBox[{"#", "[", 
                   RowBox[{
                   "ct", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}]}]}]}], "]"}], "&"}], "/@",
              "cooo"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "if", " ", "input", " ", "NonAffineParameter", " ", "is", " ", 
             "not", " ", "one", " ", "of", " ", "the", " ", "coordinates"}], 
            " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"ct", "===", 
            RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"coot", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "/.", 
                RowBox[{"#", "\[Rule]", 
                 RowBox[{"#", "[", 
                  RowBox[{"OptionValue", "[", "NonAffineParameter", "]"}], 
                  "]"}]}]}], ")"}], "&"}], "/@", "cooo"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ct", "=", 
          RowBox[{"OptionValue", "[", "NonAffineParameter", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "coordinates", " ", "as", " ", "a", " ", "function", " ", "of", " ",
            "affine", " ", "parameter"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"coo\[Lambda]", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "/.", 
              RowBox[{"#", "\[Rule]", 
               RowBox[{"#", "[", "a\[Lambda]", "]"}]}]}], ")"}], "&"}], "/@", 
           "cooo"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"d", "=", 
          RowBox[{"Length", "[", "cooo", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "construct", " ", "affine", " ", "parameter", " ", "Lagrangian"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"L\[Lambda]", "=", 
          RowBox[{
           RowBox[{"TensorComponents", "[", 
            RowBox[{"Metric", "[", 
             RowBox[{
              RowBox[{"SubMinus", "[", "\[Mu]", "]"}], ",", 
              RowBox[{"SubMinus", "[", "\[Nu]", "]"}], ",", "m"}], "]"}], 
            "]"}], "/.", 
           RowBox[{"Thread", "[", 
            RowBox[{"Rule", "[", 
             RowBox[{"cooo", ",", "coo\[Lambda]"}], "]"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"L\[Lambda]", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}], 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"L\[Lambda]", "\[LeftDoubleBracket]", 
               RowBox[{"\[Mu]", ",", "\[Nu]"}], "\[RightDoubleBracket]"}], 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{"coo\[Lambda]", ",", "a\[Lambda]"}], "]"}], 
               "\[LeftDoubleBracket]", "\[Mu]", "\[RightDoubleBracket]"}], 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{"coo\[Lambda]", ",", "a\[Lambda]"}], "]"}], 
               "\[LeftDoubleBracket]", "\[Nu]", "\[RightDoubleBracket]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"\[Mu]", ",", "1", ",", "d"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Nu]", ",", "1", ",", "d"}], "}"}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"construct", " ", "non"}], "-", 
           RowBox[{"affine", " ", "parameter", " ", "Lagrangian"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Lt", "=", 
          RowBox[{
           RowBox[{"TensorComponents", "[", 
            RowBox[{"Metric", "[", 
             RowBox[{
              RowBox[{"SubMinus", "[", "\[Mu]", "]"}], ",", 
              RowBox[{"SubMinus", "[", "\[Nu]", "]"}], ",", "m"}], "]"}], 
            "]"}], "/.", 
           RowBox[{"Thread", "[", 
            RowBox[{"Rule", "[", 
             RowBox[{"cooo", ",", "coot"}], "]"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Lt", "=", 
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Lt", "\[LeftDoubleBracket]", 
                RowBox[{"\[Mu]", ",", "\[Nu]"}], "\[RightDoubleBracket]"}], 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{"coot", ",", "ct"}], "]"}], "\[LeftDoubleBracket]", 
                "\[Mu]", "\[RightDoubleBracket]"}], 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{"coot", ",", "ct"}], "]"}], "\[LeftDoubleBracket]", 
                "\[Nu]", "\[RightDoubleBracket]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Mu]", ",", "1", ",", "d"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Nu]", ",", "1", ",", "d"}], "}"}]}], "]"}], ",", 
            RowBox[{"1", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"output", ":", " ", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", "1", ")"}], " ", "Lag", " ", "in", " ", "affine", 
             " ", "parameter", " ", "form"}]}], ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Lag", " ", "in", " ", "non"}], "-", 
             RowBox[{"affine", " ", "parameter", " ", "form"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", "2", ")"}], " ", "Geodesic", " ", "Equations", " ", 
             "in", " ", "affine", " ", "parameter", " ", "form"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"(", "3", ")"}], " ", "Geodesic", " ", "Equations", " ",
               "in", " ", "non"}], "-", 
             RowBox[{"affine", " ", "parameter", " ", "form"}]}]}]}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"L\[Lambda]", ",", "Lt", ",", 
           RowBox[{"EulerEquations", "[", 
            RowBox[{"L\[Lambda]", ",", "coo\[Lambda]", ",", "a\[Lambda]"}], 
            "]"}], ",", 
           RowBox[{"EulerEquations", "[", 
            RowBox[{"Lt", ",", 
             RowBox[{"Complement", "[", 
              RowBox[{"coot", ",", 
               RowBox[{"{", "ct", "}"}]}], "]"}], ",", "ct"}], "]"}]}], 
          "}"}]}]}], "\[IndentingNewLine]", "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Head", "[", 
           RowBox[{"OptionValue", "[", "AffineParameter", "]"}], "]"}], "===",
           "Symbol"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Head", "[", 
           RowBox[{"OptionValue", "[", "NonAffineParameter", "]"}], "]"}], "===",
           "Symbol"}], ")"}]}], ")"}]}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.52174396084375*^9, 3.521743989140625*^9}, {
   3.52174404553125*^9, 3.52174406490625*^9}, {3.52174411178125*^9, 
   3.521744178*^9}, {3.52175753421875*^9, 3.52175753465625*^9}, {
   3.521759735640625*^9, 3.521759758125*^9}, {3.5217868350625*^9, 
   3.521786885078125*^9}, {3.52178704734375*^9, 3.521787116328125*^9}, {
   3.521787178828125*^9, 3.5217871886875*^9}, {3.521787424390625*^9, 
   3.5217874283125*^9}, {3.521787532828125*^9, 3.52178754371875*^9}, 
   3.521910410859375*^9, {3.5219174194375*^9, 3.521917422546875*^9}, {
   3.521917491703125*^9, 3.5219174925*^9}, {3.521917608890625*^9, 
   3.521917617625*^9}, {3.521918314421875*^9, 3.521918316125*^9}, {
   3.521919269328125*^9, 3.5219193048125*^9}, {3.521919497375*^9, 
   3.52191951465625*^9}, {3.521921384*^9, 3.5219213845625*^9}, {
   3.521922223546875*^9, 3.5219222338125*^9}, {3.521955617484375*^9, 
   3.521955648359375*^9}, {3.521990471359375*^9, 3.52199061959375*^9}, {
   3.521990750328125*^9, 3.521990763484375*^9}, {3.532452011949185*^9, 
   3.532452013961588*^9}, {3.532452056362463*^9, 3.5324520586088667`*^9}, {
   3.5324523712334156`*^9, 3.5324523744782214`*^9}, {3.5324524076906796`*^9, 
   3.532452416130295*^9}, {3.6297526960186977`*^9, 3.629752705008212*^9}, {
   3.6299261040969267`*^9, 3.629926110841316*^9}, 3.6694393941659937`*^9, {
   3.669441203316702*^9, 3.669441278031819*^9}, {3.6694413314969053`*^9, 
   3.669441344335925*^9}, {3.6694413927307887`*^9, 3.6694414202318296`*^9}, {
   3.669514862752521*^9, 3.6695148645345235`*^9}, {3.6695149391946507`*^9, 
   3.669514991276733*^9}, {3.669515032105801*^9, 3.66951506111785*^9}, {
   3.6695152519181633`*^9, 3.669515260451182*^9}, {3.6695153013712487`*^9, 
   3.669515312627266*^9}, {3.6695154093496957`*^9, 3.6695154099216995`*^9}, {
   3.6695167123289385`*^9, 3.669516722073496*^9}, {3.6695173941773467`*^9, 
   3.669517413711464*^9}, {3.6695188004335203`*^9, 3.669518824793914*^9}, {
   3.6695194703083725`*^9, 3.6695194811419926`*^9}, {3.6695209914193163`*^9, 
   3.669521009949376*^9}, {3.669521115596419*^9, 3.6695212488830423`*^9}, {
   3.6695213351253843`*^9, 3.6695213791829042`*^9}, {3.669523166945903*^9, 
   3.6695232008429565`*^9}, {3.6695232691576443`*^9, 
   3.6695232946376853`*^9}, {3.669523348301781*^9, 3.6695234515499983`*^9}, {
   3.6695234848580523`*^9, 3.6695234857220545`*^9}, {3.6695235958404326`*^9, 
   3.669523596974471*^9}, {3.6695236354808025`*^9, 3.66952372849792*^9}, {
   3.66952376388914*^9, 3.6695237647051687`*^9}, {3.669523797091816*^9, 
   3.6695238756779413`*^9}, {3.6695239078229923`*^9, 3.6695239452280507`*^9}, 
   3.669524104919151*^9, {3.6695244117364087`*^9, 3.6695244138805313`*^9}, {
   3.66952454961929*^9, 3.669524582457168*^9}, {3.669524667216015*^9, 
   3.669524719319178*^9}, {3.669524760089368*^9, 3.6695248023595705`*^9}, {
   3.6695248594438553`*^9, 3.669524879383955*^9}, {3.6695251507197723`*^9, 
   3.6695252045538516`*^9}, {3.669525319076599*^9, 3.6695255239586067`*^9}, {
   3.669525569509823*^9, 3.6695255843268876`*^9}, {3.669526032181349*^9, 
   3.6695260335224257`*^9}, {3.669526535424133*^9, 3.669526592160378*^9}, {
   3.6695269712790256`*^9, 3.6695270006767073`*^9}, {3.669529384680343*^9, 
   3.669529386685458*^9}, {3.6695306845557566`*^9, 3.669530688418766*^9}, 
   3.6695338215879908`*^9, {3.6696043936661644`*^9, 3.669604394425166*^9}, {
   3.6697730792502522`*^9, 3.669773086852687*^9}, {3.669821997814456*^9, 
   3.66982200572567*^9}, 3.669822439592286*^9, {3.672717485337129*^9, 
   3.6727175397682424`*^9}, {3.6727176071010933`*^9, 3.672717636492775*^9}, {
   3.6727176686836157`*^9, 3.6727177213646293`*^9}, {3.6727177702034225`*^9, 
   3.6727178572564015`*^9}, {3.672717887283119*^9, 3.6727178937694902`*^9}, {
   3.6727179404391594`*^9, 3.6727179406311703`*^9}, {3.672719714402387*^9, 
   3.672719718733203*^9}, {3.6727198336652737`*^9, 3.672719918631877*^9}, {
   3.718113152795261*^9, 3.7181131936108465`*^9}, {3.718120008664604*^9, 
   3.7181200362640686`*^9}, {3.718120083644309*^9, 3.718120084142719*^9}, {
   3.7181201654003277`*^9, 3.7181202146220803`*^9}, {3.718120257514296*^9, 
   3.7181203600643024`*^9}, {3.718120416774328*^9, 3.7181204439284606`*^9}, {
   3.718120536272476*^9, 3.718120566018412*^9}, {3.7181206683107376`*^9, 
   3.7181206878104663`*^9}, {3.718120853577713*^9, 3.718120898589381*^9}, {
   3.718121337528339*^9, 3.718121483084839*^9}, {3.71812163923243*^9, 
   3.718121681989288*^9}, {3.718121850222268*^9, 3.7181218503891525`*^9}, {
   3.7181219781023026`*^9, 3.718122044575076*^9}, {3.718122111517206*^9, 
   3.718122127839568*^9}, {3.7181675623891754`*^9, 3.718167579643383*^9}, {
   3.718167890730296*^9, 3.718167925898554*^9}, {3.7181680170534754`*^9, 
   3.718168019226018*^9}, {3.7181681770793886`*^9, 3.7181681806114984`*^9}, {
   3.718168213068512*^9, 3.718168241881523*^9}, {3.718168354431093*^9, 
   3.7181683671608443`*^9}, {3.718168522595014*^9, 3.7181685240174723`*^9}, {
   3.7181685665341315`*^9, 3.7181685916153936`*^9}, {3.718168627541527*^9, 
   3.7181686285518384`*^9}, {3.7181686869782743`*^9, 3.718168723302059*^9}, {
   3.7181688624713755`*^9, 3.718168864987712*^9}, {3.7181690228007035`*^9, 
   3.718169162996397*^9}, {3.7181692591219144`*^9, 3.718169420287557*^9}, {
   3.7181695331034083`*^9, 3.7181696882869735`*^9}, {3.718169747473213*^9, 
   3.718169774785277*^9}, {3.718169805784819*^9, 3.7181698277390833`*^9}, {
   3.718169912045196*^9, 3.718169914685809*^9}, {3.7181699598061514`*^9, 
   3.718169970324886*^9}, {3.718174849977064*^9, 3.718174901960864*^9}, {
   3.7181749447138357`*^9, 3.7181751333396473`*^9}, {3.7181751964131765`*^9, 
   3.718175299958202*^9}, {3.7181757489809313`*^9, 3.718175751121794*^9}, {
   3.7181761529552455`*^9, 3.718176156643181*^9}, {3.718177761323681*^9, 
   3.71817776185317*^9}, {3.7181779797531166`*^9, 3.718178001182824*^9}, {
   3.718178432801987*^9, 3.7181784336636972`*^9}, {3.7181785165633006`*^9, 
   3.7181785212720814`*^9}, 3.718180370619824*^9, 3.8955551726274557`*^9, 
   3.9668970148059464`*^9, {3.966897051857573*^9, 3.966897054027402*^9}, 
   3.966897109086606*^9, {3.9671616274736156`*^9, 3.967161654681234*^9}, {
   3.967162488209757*^9, 3.96716249917795*^9}, {3.967162542460404*^9, 
   3.967162544902912*^9}, 3.967164488735114*^9, {3.9677774525907745`*^9, 
   3.967777452596529*^9}, {3.967858282491803*^9, 3.967858282659686*^9}, 
   3.975314545032481*^9, {3.975819348363361*^9, 
   3.9758193633711643`*^9}},ExpressionUUID->"774edf3d-4b55-4145-849b-\
051d46c6a79d"],

Cell["\<\
GeodesicLagrangians takes as input
{Metric Tensor, AffineParameter, NonAffineParameter}
and produces as output:
{Lagrangian for geodesic motion in affine parameter form, 
Lag. non-affine parameter form}
That is, it is GeodesicSystem, except it does not compute the geodesic \
equations.\
\>", "Text",
 CellChangeTimes->{{3.7181132097147055`*^9, 3.718113264109483*^9}, {
  3.7181143852731085`*^9, 3.7181143974866204`*^9}, {3.7181151783546247`*^9, 
  3.7181152155867205`*^9}, {3.7181669623574867`*^9, 3.7181669718634157`*^9}, {
  3.718168163546671*^9, 3.718168165734876*^9}, {3.7181702710162296`*^9, 
  3.7181703112290707`*^9}, {3.718175343109828*^9, 3.7181753757743816`*^9}, {
  3.718873468850099*^9, 
  3.7188735320314307`*^9}},ExpressionUUID->"1b74c357-bac8-4f82-b251-\
cefd17cf0c45"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GeodesicLagrangians", "[", 
     RowBox[{"m_Tensor", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
    RowBox[{"TestMetricTensor", "[", "m", "]"}]}], ":=", 
   RowBox[{
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "mm", ",", "ss", ",", "\[Sigma]", ",", "\[Mu]", ",", "\[Nu]", ",", 
        "si", ",", "cooo", ",", "d", ",", "cc", ",", "coo\[Lambda]", ",", 
        "coot", ",", "a\[Lambda]", ",", "ct", ",", "comehere", ",", 
        "L\[Lambda]", ",", "Lt", ",", "output"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"extract", " ", "affine", " ", "and", " ", "non"}], "-", 
        RowBox[{
        "affine", " ", "parameter", " ", "for", " ", "solving", " ", 
         "geodesic", " ", "eqn"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"a\[Lambda]", "=", 
        RowBox[{"OptionValue", "[", "AffineParameter", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cooo", "=", 
        RowBox[{"Coordinates", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"non", "-", 
         RowBox[{"affine", " ", "parameter"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ct", "=", 
        RowBox[{"Intersection", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"OptionValue", "[", "NonAffineParameter", "]"}], "}"}], 
          ",", "cooo"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "if", " ", "input", " ", "NonAffineParameter", " ", "is", " ", "one",
           " ", "of", " ", "the", " ", "coordinates"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "ct", "]"}], "===", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"coot", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"#", "===", 
               RowBox[{
               "ct", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
               ",", 
              RowBox[{
              "ct", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"#", "=!=", 
               RowBox[{
               "ct", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
               ",", 
              RowBox[{"#", "/.", 
               RowBox[{"#", "\[Rule]", 
                RowBox[{"#", "[", 
                 RowBox[{
                 "ct", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                  "]"}]}]}]}], "]"}], "&"}], "/@", "cooo"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "if", " ", "input", " ", "NonAffineParameter", " ", "is", " ", 
           "not", " ", "one", " ", "of", " ", "the", " ", "coordinates"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"ct", "===", 
          RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"coot", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "/.", 
              RowBox[{"#", "\[Rule]", 
               RowBox[{"#", "[", 
                RowBox[{"OptionValue", "[", "NonAffineParameter", "]"}], 
                "]"}]}]}], ")"}], "&"}], "/@", "cooo"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ct", "=", 
        RowBox[{"OptionValue", "[", "NonAffineParameter", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "coordinates", " ", "as", " ", "a", " ", "function", " ", "of", " ", 
         "affine", " ", "parameter"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"coo\[Lambda]", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#", "/.", 
            RowBox[{"#", "\[Rule]", 
             RowBox[{"#", "[", "a\[Lambda]", "]"}]}]}], ")"}], "&"}], "/@", 
         "cooo"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{"Length", "[", "cooo", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "construct", " ", "affine", " ", "parameter", " ", "Lagrangian"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"L\[Lambda]", "=", 
        RowBox[{
         RowBox[{"TensorComponents", "[", 
          RowBox[{"Metric", "[", 
           RowBox[{
            RowBox[{"SubMinus", "[", "\[Mu]", "]"}], ",", 
            RowBox[{"SubMinus", "[", "\[Nu]", "]"}], ",", "m"}], "]"}], "]"}],
          "/.", 
         RowBox[{"Thread", "[", 
          RowBox[{"Rule", "[", 
           RowBox[{"cooo", ",", "coo\[Lambda]"}], "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"L\[Lambda]", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "2"}], ")"}], 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"L\[Lambda]", "\[LeftDoubleBracket]", 
             RowBox[{"\[Mu]", ",", "\[Nu]"}], "\[RightDoubleBracket]"}], 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"coo\[Lambda]", ",", "a\[Lambda]"}], "]"}], 
             "\[LeftDoubleBracket]", "\[Mu]", "\[RightDoubleBracket]"}], 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"coo\[Lambda]", ",", "a\[Lambda]"}], "]"}], 
             "\[LeftDoubleBracket]", "\[Nu]", "\[RightDoubleBracket]"}]}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"\[Mu]", ",", "1", ",", "d"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Nu]", ",", "1", ",", "d"}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"construct", " ", "non"}], "-", 
         RowBox[{"affine", " ", "parameter", " ", "Lagrangian"}]}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Lt", "=", 
        RowBox[{
         RowBox[{"TensorComponents", "[", 
          RowBox[{"Metric", "[", 
           RowBox[{
            RowBox[{"SubMinus", "[", "\[Mu]", "]"}], ",", 
            RowBox[{"SubMinus", "[", "\[Nu]", "]"}], ",", "m"}], "]"}], "]"}],
          "/.", 
         RowBox[{"Thread", "[", 
          RowBox[{"Rule", "[", 
           RowBox[{"cooo", ",", "coot"}], "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Lt", "=", 
        RowBox[{"Power", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Lt", "\[LeftDoubleBracket]", 
              RowBox[{"\[Mu]", ",", "\[Nu]"}], "\[RightDoubleBracket]"}], 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"coot", ",", "ct"}], "]"}], "\[LeftDoubleBracket]", 
              "\[Mu]", "\[RightDoubleBracket]"}], 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"coot", ",", "ct"}], "]"}], "\[LeftDoubleBracket]", 
              "\[Nu]", "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Mu]", ",", "1", ",", "d"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Nu]", ",", "1", ",", "d"}], "}"}]}], "]"}], ",", 
          RowBox[{"1", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"output", ":", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", "1", ")"}], " ", "Lag", " ", "in", " ", "affine", " ",
            "parameter", " ", "form"}]}], ",", " ", 
         RowBox[{
          RowBox[{"Lag", " ", "in", " ", "non"}], "-", 
          RowBox[{"affine", " ", "parameter", " ", "form"}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"L\[Lambda]", ",", "Lt"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"OptionValue", "[", "AffineParameter", "]"}], "]"}], "===", 
        "Symbol"}], ")"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"OptionValue", "[", "NonAffineParameter", "]"}], "]"}], "===",
         "Symbol"}], ")"}]}], ")"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.52174396084375*^9, 3.521743989140625*^9}, {
   3.52174404553125*^9, 3.52174406490625*^9}, {3.52174411178125*^9, 
   3.521744178*^9}, {3.52175753421875*^9, 3.52175753465625*^9}, {
   3.521759735640625*^9, 3.521759758125*^9}, {3.5217868350625*^9, 
   3.521786885078125*^9}, {3.52178704734375*^9, 3.521787116328125*^9}, {
   3.521787178828125*^9, 3.5217871886875*^9}, {3.521787424390625*^9, 
   3.5217874283125*^9}, {3.521787532828125*^9, 3.52178754371875*^9}, 
   3.521910410859375*^9, {3.5219174194375*^9, 3.521917422546875*^9}, {
   3.521917491703125*^9, 3.5219174925*^9}, {3.521917608890625*^9, 
   3.521917617625*^9}, {3.521918314421875*^9, 3.521918316125*^9}, {
   3.521919269328125*^9, 3.5219193048125*^9}, {3.521919497375*^9, 
   3.52191951465625*^9}, {3.521921384*^9, 3.5219213845625*^9}, {
   3.521922223546875*^9, 3.5219222338125*^9}, {3.521955617484375*^9, 
   3.521955648359375*^9}, {3.521990471359375*^9, 3.52199061959375*^9}, {
   3.521990750328125*^9, 3.521990763484375*^9}, {3.532452011949185*^9, 
   3.532452013961588*^9}, {3.532452056362463*^9, 3.5324520586088667`*^9}, {
   3.5324523712334156`*^9, 3.5324523744782214`*^9}, {3.5324524076906796`*^9, 
   3.532452416130295*^9}, {3.6297526960186977`*^9, 3.629752705008212*^9}, {
   3.6299261040969267`*^9, 3.629926110841316*^9}, 3.6694393941659937`*^9, {
   3.669441203316702*^9, 3.669441278031819*^9}, {3.6694413314969053`*^9, 
   3.669441344335925*^9}, {3.6694413927307887`*^9, 3.6694414202318296`*^9}, {
   3.669514862752521*^9, 3.6695148645345235`*^9}, {3.6695149391946507`*^9, 
   3.669514991276733*^9}, {3.669515032105801*^9, 3.66951506111785*^9}, {
   3.6695152519181633`*^9, 3.669515260451182*^9}, {3.6695153013712487`*^9, 
   3.669515312627266*^9}, {3.6695154093496957`*^9, 3.6695154099216995`*^9}, {
   3.6695167123289385`*^9, 3.669516722073496*^9}, {3.6695173941773467`*^9, 
   3.669517413711464*^9}, {3.6695188004335203`*^9, 3.669518824793914*^9}, {
   3.6695194703083725`*^9, 3.6695194811419926`*^9}, {3.6695209914193163`*^9, 
   3.669521009949376*^9}, {3.669521115596419*^9, 3.6695212488830423`*^9}, {
   3.6695213351253843`*^9, 3.6695213791829042`*^9}, {3.669523166945903*^9, 
   3.6695232008429565`*^9}, {3.6695232691576443`*^9, 
   3.6695232946376853`*^9}, {3.669523348301781*^9, 3.6695234515499983`*^9}, {
   3.6695234848580523`*^9, 3.6695234857220545`*^9}, {3.6695235958404326`*^9, 
   3.669523596974471*^9}, {3.6695236354808025`*^9, 3.66952372849792*^9}, {
   3.66952376388914*^9, 3.6695237647051687`*^9}, {3.669523797091816*^9, 
   3.6695238756779413`*^9}, {3.6695239078229923`*^9, 3.6695239452280507`*^9}, 
   3.669524104919151*^9, {3.6695244117364087`*^9, 3.6695244138805313`*^9}, {
   3.66952454961929*^9, 3.669524582457168*^9}, {3.669524667216015*^9, 
   3.669524719319178*^9}, {3.669524760089368*^9, 3.6695248023595705`*^9}, {
   3.6695248594438553`*^9, 3.669524879383955*^9}, {3.6695251507197723`*^9, 
   3.6695252045538516`*^9}, {3.669525319076599*^9, 3.6695255239586067`*^9}, {
   3.669525569509823*^9, 3.6695255843268876`*^9}, {3.669526032181349*^9, 
   3.6695260335224257`*^9}, {3.669526535424133*^9, 3.669526592160378*^9}, {
   3.6695269712790256`*^9, 3.6695270006767073`*^9}, {3.669529384680343*^9, 
   3.669529386685458*^9}, {3.6695306845557566`*^9, 3.669530688418766*^9}, 
   3.6695338215879908`*^9, {3.6696043936661644`*^9, 3.669604394425166*^9}, {
   3.6697730792502522`*^9, 3.669773086852687*^9}, {3.669821997814456*^9, 
   3.66982200572567*^9}, 3.669822439592286*^9, {3.672717485337129*^9, 
   3.6727175397682424`*^9}, {3.6727176071010933`*^9, 3.672717636492775*^9}, {
   3.6727176686836157`*^9, 3.6727177213646293`*^9}, {3.6727177702034225`*^9, 
   3.6727178572564015`*^9}, {3.672717887283119*^9, 3.6727178937694902`*^9}, {
   3.6727179404391594`*^9, 3.6727179406311703`*^9}, {3.672719714402387*^9, 
   3.672719718733203*^9}, {3.6727198336652737`*^9, 3.672719918631877*^9}, {
   3.718113152795261*^9, 3.7181131936108465`*^9}, {3.718120008664604*^9, 
   3.7181200362640686`*^9}, {3.718120083644309*^9, 3.718120084142719*^9}, {
   3.7181201654003277`*^9, 3.7181202146220803`*^9}, {3.718120257514296*^9, 
   3.7181203600643024`*^9}, {3.718120416774328*^9, 3.7181204439284606`*^9}, {
   3.718120536272476*^9, 3.718120566018412*^9}, {3.7181206683107376`*^9, 
   3.7181206878104663`*^9}, {3.718120853577713*^9, 3.718120898589381*^9}, {
   3.718121337528339*^9, 3.718121483084839*^9}, {3.71812163923243*^9, 
   3.718121681989288*^9}, {3.718121850222268*^9, 3.7181218503891525`*^9}, {
   3.7181219781023026`*^9, 3.718122044575076*^9}, {3.718122111517206*^9, 
   3.718122127839568*^9}, {3.7181675623891754`*^9, 3.718167579643383*^9}, {
   3.718167890730296*^9, 3.718167925898554*^9}, {3.7181680170534754`*^9, 
   3.718168019226018*^9}, {3.7181681770793886`*^9, 3.7181681806114984`*^9}, {
   3.718168213068512*^9, 3.718168241881523*^9}, {3.718168354431093*^9, 
   3.7181683671608443`*^9}, {3.718168522595014*^9, 3.7181685240174723`*^9}, {
   3.7181685665341315`*^9, 3.7181685916153936`*^9}, {3.718168627541527*^9, 
   3.7181686285518384`*^9}, {3.7181686869782743`*^9, 3.718168723302059*^9}, {
   3.7181688624713755`*^9, 3.718168864987712*^9}, {3.7181690228007035`*^9, 
   3.718169162996397*^9}, {3.7181692591219144`*^9, 3.718169420287557*^9}, {
   3.7181695331034083`*^9, 3.7181696882869735`*^9}, {3.718169747473213*^9, 
   3.718169774785277*^9}, {3.718169805784819*^9, 3.7181698277390833`*^9}, {
   3.718169912045196*^9, 3.718169914685809*^9}, {3.7181699598061514`*^9, 
   3.718169970324886*^9}, {3.718174849977064*^9, 3.718174901960864*^9}, {
   3.7181749447138357`*^9, 3.7181751333396473`*^9}, {3.7181751964131765`*^9, 
   3.718175299958202*^9}, {3.7181757489809313`*^9, 3.718175751121794*^9}, {
   3.7181761529552455`*^9, 3.718176156643181*^9}, {3.718177761323681*^9, 
   3.71817776185317*^9}, {3.7181779797531166`*^9, 3.718178001182824*^9}, {
   3.718178432801987*^9, 3.7181784336636972`*^9}, {3.7181785165633006`*^9, 
   3.7181785212720814`*^9}, 3.718180370619824*^9, {3.718873830380347*^9, 
   3.718873835202129*^9}, {3.7188738658095665`*^9, 3.7188738773171687`*^9}, 
   3.8955551726324525`*^9, 
   3.96689700041796*^9},ExpressionUUID->"5d23b930-244c-4440-9bb2-\
85e665a9cfe2"],

Cell["\<\
GeodesicHamiltonianDynamics takes as input
{Metric Tensor, {coordinates \[Rule] momenta}, AffineParameter}
and produces as output:
{Hamiltonian for geodesic motion in affine parameter form, 
{x-dot = \[PartialD]H/\[PartialD]p,p-dot = -\[PartialD]H/\[PartialD]x}}.\
\>", "Text",
 CellChangeTimes->{{3.7181132097147055`*^9, 3.718113264109483*^9}, {
  3.7181143852731085`*^9, 3.7181143974866204`*^9}, {3.7181151783546247`*^9, 
  3.7181152155867205`*^9}, {3.7181669623574867`*^9, 3.7181669718634157`*^9}, {
  3.718168163546671*^9, 3.718168165734876*^9}, {3.7181702710162296`*^9, 
  3.7181703112290707`*^9}, {3.718175343109828*^9, 3.7181753757743816`*^9}, {
  3.718873468850099*^9, 3.7188735320314307`*^9}, {3.79523642171525*^9, 
  3.795236452723382*^9}, {3.7952365062913537`*^9, 3.7952365067526426`*^9}, {
  3.795236578273012*^9, 3.795236625209828*^9}, {3.7962386295423265`*^9, 
  3.7962386329016805`*^9}, {3.796243853750134*^9, 
  3.7962439114898167`*^9}},ExpressionUUID->"a487075c-68f8-446d-88be-\
4ec5655f4d49"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GeodesicHamiltonianDynamics", "[", 
     RowBox[{"m_Tensor", ",", "cp_List", ",", "a\[Lambda]_Symbol"}], "]"}], "/;", 
    RowBox[{
     RowBox[{"TestMetricTensor", "[", "m", "]"}], "&&", 
     RowBox[{"(*", " ", 
      RowBox[{
      "list", " ", "of", " ", "Rules", " ", "relating", " ", "coords", " ", 
       "to", " ", "momenta"}], " ", "*)"}], 
     RowBox[{"MatchQ", "[", 
      RowBox[{
       RowBox[{"cp", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"Repeated", "[", 
        RowBox[{"Rule", "[", 
         RowBox[{"lhs_", ",", "rhs_"}], "]"}], "]"}]}], "]"}], "&&", 
     RowBox[{"(*", " ", 
      RowBox[{
      "lhs", " ", "of", " ", "Rules", " ", "in", " ", "cp", " ", "should", 
       " ", "be", " ", "the", " ", "coordinates", " ", "of", " ", "m"}], " ", 
      "*)"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Union", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"(", 
           RowBox[{"cp", "/.", 
            RowBox[{
             RowBox[{"Rule", "[", 
              RowBox[{"lhs_", ",", "rhs_"}], "]"}], "\[Rule]", "lhs"}]}], 
           ")"}], "]"}], ",", 
         RowBox[{"Coordinates", "[", "m", "]"}]}], "]"}], "===", 
       RowBox[{"Sort", "[", 
        RowBox[{"Coordinates", "[", "m", "]"}], "]"}]}], ")"}], "&&", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Affine", " ", "Parameter", " ", "should", " ", "not", " ", "be", " ", 
       "coordinate"}], " ", "*)"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Intersection", "[", 
        RowBox[{
         RowBox[{"Coordinates", "[", "m", "]"}], ",", 
         RowBox[{"{", "a\[Lambda]", "}"}]}], "]"}], "===", 
       RowBox[{"{", "}"}]}], ")"}]}]}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "mm", ",", "ss", ",", "\[Sigma]", ",", "\[Mu]", ",", "\[Nu]", ",", "si",
        ",", "cooo", ",", "d", ",", "cc", ",", "coo\[Lambda]", ",", 
       "p\[Lambda]", ",", "coot", ",", "ct", ",", "comehere", ",", 
       "H\[Lambda]", ",", "g\[Mu]\[Nu]", ",", "Lt", ",", "output", ",", 
       "coo\[Lambda]Eqn", ",", "p\[Lambda]Eqn"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"extract", " ", "affine", " ", "and", " ", "non"}], "-", 
       RowBox[{
       "affine", " ", "parameter", " ", "for", " ", "solving", " ", 
        "geodesic", " ", "eqn"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cooo", "=", 
       RowBox[{"Coordinates", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "coordinates", " ", "as", " ", "a", " ", "function", " ", "of", " ", 
        "affine", " ", "parameter"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"coo\[Lambda]", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", "/.", 
           RowBox[{"#", "\[Rule]", 
            RowBox[{"#", "[", "a\[Lambda]", "]"}]}]}], ")"}], "&"}], "/@", 
        "cooo"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "momentum", " ", "as", " ", "a", " ", "function", " ", "of", " ", 
        "affine", " ", "parameter"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"p\[Lambda]", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", "/.", 
           RowBox[{"#", "\[Rule]", 
            RowBox[{"#", "[", "a\[Lambda]", "]"}]}]}], ")"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"cooo", "/.", "cp"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"Length", "[", "cooo", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "construct", " ", "affine", " ", "parameter", " ", "Hamiltonian"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"g\[Mu]\[Nu]", "=", 
       RowBox[{
        RowBox[{"TensorComponents", "[", 
         RowBox[{"Metric", "[", 
          RowBox[{
           RowBox[{"SuperMinus", "[", "\[Mu]", "]"}], ",", 
           RowBox[{"SuperMinus", "[", "\[Nu]", "]"}], ",", "m"}], "]"}], 
         "]"}], "/.", 
        RowBox[{"Thread", "[", 
         RowBox[{"Rule", "[", 
          RowBox[{"cooo", ",", "coo\[Lambda]"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"H\[Lambda]", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "2"}], ")"}], 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"g\[Mu]\[Nu]", "\[LeftDoubleBracket]", 
            RowBox[{"\[Mu]", ",", "\[Nu]"}], "\[RightDoubleBracket]"}], 
           RowBox[{
           "p\[Lambda]", "\[LeftDoubleBracket]", "\[Mu]", 
            "\[RightDoubleBracket]"}], 
           RowBox[{
           "p\[Lambda]", "\[LeftDoubleBracket]", "\[Nu]", 
            "\[RightDoubleBracket]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Mu]", ",", "1", ",", "d"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Nu]", ",", "1", ",", "d"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        SuperscriptBox[
         OverscriptBox["x", "."], "\[Mu]"], " ", "=", " ", 
        RowBox[{
         SuperscriptBox["g", "\[Mu]\[Nu]"], 
         SubscriptBox["p", "\[Nu]"]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"coo\[Lambda]Eqn", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{
             "coo\[Lambda]", "\[LeftDoubleBracket]", "#", 
              "\[RightDoubleBracket]"}], ",", "a\[Lambda]"}], "]"}], 
           "\[Equal]", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"g\[Mu]\[Nu]", "\[LeftDoubleBracket]", 
               RowBox[{"#", ",", "\[Nu]"}], "\[RightDoubleBracket]"}], 
              RowBox[{
              "p\[Lambda]", "\[LeftDoubleBracket]", "\[Nu]", 
               "\[RightDoubleBracket]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Nu]", ",", "1", ",", "d"}], "}"}]}], "]"}]}], ")"}], 
         "&"}], "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", "d"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        SubscriptBox[
         OverscriptBox["p", "."], "\[Mu]"], " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"-", " ", 
           RowBox[{"\[PartialD]", "H"}]}], "/", 
          RowBox[{"\[PartialD]", 
           SuperscriptBox["x", "\[Mu]"]}]}], " ", "=", " ", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}]}], 
          RowBox[{
           SubscriptBox["\[PartialD]", "\[Mu]"], 
           SuperscriptBox["g", "\[Alpha]\[Beta]"]}], " ", 
          SubscriptBox["p", "\[Alpha]"], " ", 
          SubscriptBox["p", "\[Beta]"]}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"p\[Lambda]Eqn", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{
             "p\[Lambda]", "\[LeftDoubleBracket]", "#", 
              "\[RightDoubleBracket]"}], ",", "a\[Lambda]"}], "]"}], 
           "\[Equal]", 
           RowBox[{"-", 
            RowBox[{"D", "[", 
             RowBox[{"H\[Lambda]", ",", 
              RowBox[{
              "coo\[Lambda]", "\[LeftDoubleBracket]", "#", 
               "\[RightDoubleBracket]"}]}], "]"}]}]}], ")"}], "&"}], "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", "d"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"output", ":", " ", "Hamiltonian"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xdot", " ", "eqns"}], ",", " ", 
          RowBox[{"pdot", " ", "eqns"}]}], "}"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"H\[Lambda]", ",", 
        RowBox[{"Join", "[", 
         RowBox[{"coo\[Lambda]Eqn", ",", "p\[Lambda]Eqn"}], "]"}]}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.52174396084375*^9, 3.521743989140625*^9}, {
   3.52174404553125*^9, 3.52174406490625*^9}, {3.52174411178125*^9, 
   3.521744178*^9}, {3.52175753421875*^9, 3.52175753465625*^9}, {
   3.521759735640625*^9, 3.521759758125*^9}, {3.5217868350625*^9, 
   3.521786885078125*^9}, {3.52178704734375*^9, 3.521787116328125*^9}, {
   3.521787178828125*^9, 3.5217871886875*^9}, {3.521787424390625*^9, 
   3.5217874283125*^9}, {3.521787532828125*^9, 3.52178754371875*^9}, 
   3.521910410859375*^9, {3.5219174194375*^9, 3.521917422546875*^9}, {
   3.521917491703125*^9, 3.5219174925*^9}, {3.521917608890625*^9, 
   3.521917617625*^9}, {3.521918314421875*^9, 3.521918316125*^9}, {
   3.521919269328125*^9, 3.5219193048125*^9}, {3.521919497375*^9, 
   3.52191951465625*^9}, {3.521921384*^9, 3.5219213845625*^9}, {
   3.521922223546875*^9, 3.5219222338125*^9}, {3.521955617484375*^9, 
   3.521955648359375*^9}, {3.521990471359375*^9, 3.52199061959375*^9}, {
   3.521990750328125*^9, 3.521990763484375*^9}, {3.532452011949185*^9, 
   3.532452013961588*^9}, {3.532452056362463*^9, 3.5324520586088667`*^9}, {
   3.5324523712334156`*^9, 3.5324523744782214`*^9}, {3.5324524076906796`*^9, 
   3.532452416130295*^9}, {3.6297526960186977`*^9, 3.629752705008212*^9}, {
   3.6299261040969267`*^9, 3.629926110841316*^9}, 3.6694393941659937`*^9, {
   3.669441203316702*^9, 3.669441278031819*^9}, {3.6694413314969053`*^9, 
   3.669441344335925*^9}, {3.6694413927307887`*^9, 3.6694414202318296`*^9}, {
   3.669514862752521*^9, 3.6695148645345235`*^9}, {3.6695149391946507`*^9, 
   3.669514991276733*^9}, {3.669515032105801*^9, 3.66951506111785*^9}, {
   3.6695152519181633`*^9, 3.669515260451182*^9}, {3.6695153013712487`*^9, 
   3.669515312627266*^9}, {3.6695154093496957`*^9, 3.6695154099216995`*^9}, {
   3.6695167123289385`*^9, 3.669516722073496*^9}, {3.6695173941773467`*^9, 
   3.669517413711464*^9}, {3.6695188004335203`*^9, 3.669518824793914*^9}, {
   3.6695194703083725`*^9, 3.6695194811419926`*^9}, {3.6695209914193163`*^9, 
   3.669521009949376*^9}, {3.669521115596419*^9, 3.6695212488830423`*^9}, {
   3.6695213351253843`*^9, 3.6695213791829042`*^9}, {3.669523166945903*^9, 
   3.6695232008429565`*^9}, {3.6695232691576443`*^9, 
   3.6695232946376853`*^9}, {3.669523348301781*^9, 3.6695234515499983`*^9}, {
   3.6695234848580523`*^9, 3.6695234857220545`*^9}, {3.6695235958404326`*^9, 
   3.669523596974471*^9}, {3.6695236354808025`*^9, 3.66952372849792*^9}, {
   3.66952376388914*^9, 3.6695237647051687`*^9}, {3.669523797091816*^9, 
   3.6695238756779413`*^9}, {3.6695239078229923`*^9, 3.6695239452280507`*^9}, 
   3.669524104919151*^9, {3.6695244117364087`*^9, 3.6695244138805313`*^9}, {
   3.66952454961929*^9, 3.669524582457168*^9}, {3.669524667216015*^9, 
   3.669524719319178*^9}, {3.669524760089368*^9, 3.6695248023595705`*^9}, {
   3.6695248594438553`*^9, 3.669524879383955*^9}, {3.6695251507197723`*^9, 
   3.6695252045538516`*^9}, {3.669525319076599*^9, 3.6695255239586067`*^9}, {
   3.669525569509823*^9, 3.6695255843268876`*^9}, {3.669526032181349*^9, 
   3.6695260335224257`*^9}, {3.669526535424133*^9, 3.669526592160378*^9}, {
   3.6695269712790256`*^9, 3.6695270006767073`*^9}, {3.669529384680343*^9, 
   3.669529386685458*^9}, {3.6695306845557566`*^9, 3.669530688418766*^9}, 
   3.6695338215879908`*^9, {3.6696043936661644`*^9, 3.669604394425166*^9}, {
   3.6697730792502522`*^9, 3.669773086852687*^9}, {3.669821997814456*^9, 
   3.66982200572567*^9}, 3.669822439592286*^9, {3.672717485337129*^9, 
   3.6727175397682424`*^9}, {3.6727176071010933`*^9, 3.672717636492775*^9}, {
   3.6727176686836157`*^9, 3.6727177213646293`*^9}, {3.6727177702034225`*^9, 
   3.6727178572564015`*^9}, {3.672717887283119*^9, 3.6727178937694902`*^9}, {
   3.6727179404391594`*^9, 3.6727179406311703`*^9}, {3.672719714402387*^9, 
   3.672719718733203*^9}, {3.6727198336652737`*^9, 3.672719918631877*^9}, {
   3.718113152795261*^9, 3.7181131936108465`*^9}, {3.718120008664604*^9, 
   3.7181200362640686`*^9}, {3.718120083644309*^9, 3.718120084142719*^9}, {
   3.7181201654003277`*^9, 3.7181202146220803`*^9}, {3.718120257514296*^9, 
   3.7181203600643024`*^9}, {3.718120416774328*^9, 3.7181204439284606`*^9}, {
   3.718120536272476*^9, 3.718120566018412*^9}, {3.7181206683107376`*^9, 
   3.7181206878104663`*^9}, {3.718120853577713*^9, 3.718120898589381*^9}, {
   3.718121337528339*^9, 3.718121483084839*^9}, {3.71812163923243*^9, 
   3.718121681989288*^9}, {3.718121850222268*^9, 3.7181218503891525`*^9}, {
   3.7181219781023026`*^9, 3.718122044575076*^9}, {3.718122111517206*^9, 
   3.718122127839568*^9}, {3.7181675623891754`*^9, 3.718167579643383*^9}, {
   3.718167890730296*^9, 3.718167925898554*^9}, {3.7181680170534754`*^9, 
   3.718168019226018*^9}, {3.7181681770793886`*^9, 3.7181681806114984`*^9}, {
   3.718168213068512*^9, 3.718168241881523*^9}, {3.718168354431093*^9, 
   3.7181683671608443`*^9}, {3.718168522595014*^9, 3.7181685240174723`*^9}, {
   3.7181685665341315`*^9, 3.7181685916153936`*^9}, {3.718168627541527*^9, 
   3.7181686285518384`*^9}, {3.7181686869782743`*^9, 3.718168723302059*^9}, {
   3.7181688624713755`*^9, 3.718168864987712*^9}, {3.7181690228007035`*^9, 
   3.718169162996397*^9}, {3.7181692591219144`*^9, 3.718169420287557*^9}, {
   3.7181695331034083`*^9, 3.7181696882869735`*^9}, {3.718169747473213*^9, 
   3.718169774785277*^9}, {3.718169805784819*^9, 3.7181698277390833`*^9}, {
   3.718169912045196*^9, 3.718169914685809*^9}, {3.7181699598061514`*^9, 
   3.718169970324886*^9}, {3.718174849977064*^9, 3.718174901960864*^9}, {
   3.7181749447138357`*^9, 3.7181751333396473`*^9}, {3.7181751964131765`*^9, 
   3.718175299958202*^9}, {3.7181757489809313`*^9, 3.718175751121794*^9}, {
   3.7181761529552455`*^9, 3.718176156643181*^9}, {3.718177761323681*^9, 
   3.71817776185317*^9}, {3.7181779797531166`*^9, 3.718178001182824*^9}, {
   3.718178432801987*^9, 3.7181784336636972`*^9}, {3.7181785165633006`*^9, 
   3.7181785212720814`*^9}, 3.718180370619824*^9, {3.718873830380347*^9, 
   3.718873835202129*^9}, {3.7188738658095665`*^9, 3.7188738773171687`*^9}, {
   3.795236633054888*^9, 3.795236637487018*^9}, {3.795237058500819*^9, 
   3.7952370721195955`*^9}, {3.795238295820283*^9, 3.795238335710862*^9}, {
   3.796238945540854*^9, 3.7962389458769197`*^9}, {3.7962435477699513`*^9, 
   3.7962435896731133`*^9}, {3.7962436264189253`*^9, 3.796243633625187*^9}, {
   3.796243669561882*^9, 3.796243841658557*^9}, {3.7962439686220517`*^9, 
   3.7962440093348923`*^9}, {3.7962440542451525`*^9, 3.796244108444075*^9}, {
   3.7962441540377183`*^9, 3.796244194236745*^9}, {3.79624422817227*^9, 
   3.7962444052771587`*^9}, {3.7962456028887367`*^9, 3.796245651655817*^9}, {
   3.796245708618054*^9, 3.79624573899321*^9}, {3.796245891659901*^9, 
   3.796245912316416*^9}, {3.796245998749711*^9, 3.796246089724656*^9}, {
   3.796246294738079*^9, 3.7962463249560823`*^9}, {3.7962463643883657`*^9, 
   3.796246369747878*^9}, {3.796246423605193*^9, 3.7962465442497487`*^9}, {
   3.796246690078211*^9, 3.796246720302842*^9}, {3.7962469650530725`*^9, 
   3.7962469862386737`*^9}, {3.7962471295630054`*^9, 3.796247135951657*^9}, {
   3.7962471723875256`*^9, 3.7962471802348495`*^9}, 
   3.8955551726374493`*^9},ExpressionUUID->"2326bf4b-94b0-4d6a-94dc-\
818f699c4d72"]
}, Closed]],

Cell[CellGroupData[{

Cell["SphericalHarmonicYTensor", "Subsection",
 CellChangeTimes->{{3.884211086191988*^9, 3.8842110935365057`*^9}, 
   3.8854228740812063`*^9},ExpressionUUID->"7281337e-90c7-4b6f-8c1b-\
99b585cc5ebe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "SphericalHarmonicYTensor", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"SphericalHarmonicYTensor", "[", 
      RowBox[{
      "l_", ",", "m_", ",", "\[Theta]_Symbol", ",", "\[Phi]_Symbol", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "g", ",", "i", ",", "j", ",", "Y", ",", "k", ",", "result", ",", 
          "tempidx"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"g", "=", 
          RowBox[{"Metric", "[", 
           RowBox[{
            SubscriptBox["i", "-"], ",", 
            SubscriptBox["j", "-"], ",", 
            RowBox[{"(", "\[NoBreak]", GridBox[{
               {"1", "0"},
               {"0", 
                SuperscriptBox[
                 RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}
              }], "\[NoBreak]", ")"}], ",", 
            RowBox[{"Coordinates", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}]}], ",", 
            RowBox[{"TensorName", "\[Rule]", "\"\<g\>\""}], ",", 
            RowBox[{"StartIndex", "\[Rule]", "1"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Y", "=", 
          RowBox[{"NonMetricTensor", "[", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{"SphericalHarmonicY", "[", 
             RowBox[{"l", ",", "m", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
            ",", 
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{"\"\<Y\>\"", ",", 
               RowBox[{"Column", "[", 
                RowBox[{"{", 
                 RowBox[{"m", ",", "l"}], "}"}], "]"}]}], "}"}], "]"}], ",", 
            RowBox[{"Coordinates", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}]}], ",", 
            RowBox[{"StartIndex", "\[Rule]", "1"}], ",", 
            RowBox[{"TensorAssumption", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"0", "\[LessEqual]", " ", "\[Phi]", "\[LessEqual]", 
                RowBox[{"2", "Pi"}]}], ",", 
               RowBox[{
               "0", "\[LessEqual]", "\[Theta]", "\[LessEqual]", "Pi"}]}], 
              "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}], "=!=", 
            "Null"}], ",", 
           RowBox[{"Y", "=", 
            RowBox[{"TooltipDisplay", "[", 
             RowBox[{"Y", ",", 
              RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], 
             "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"Y", "=", 
            RowBox[{"TooltipStyle", "[", 
             RowBox[{"Y", ",", 
              RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], "]"}]}]}], 
          "]"}], ";", "\[IndentingNewLine]", "Y"}]}], "\[IndentingNewLine]", 
       "]"}], "/;", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Element", "[", 
            RowBox[{"l", ",", "Complexes"}], "]"}], "===", "True"}], ")"}], "||", 
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"Head", "[", "l", "]"}], ",", 
           RowBox[{"(", 
            RowBox[{"Symbol", "|", "Plus", "|", "Times"}], ")"}]}], "]"}]}], 
        ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Element", "[", 
            RowBox[{"m", ",", "Complexes"}], "]"}], "===", "True"}], ")"}], "||", 
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"Head", "[", "m", "]"}], ",", 
           RowBox[{"(", 
            RowBox[{"Symbol", "|", "Plus", "|", "Times"}], ")"}]}], "]"}]}], 
        ")"}]}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SphericalHarmonicYTensor", "[", 
      RowBox[{"l_", ",", "m_", ",", 
       RowBox[{"g_Tensor", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestMetricTensor", "[", "g", "]"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Dimensions", "[", "g", "]"}], "===", 
            RowBox[{"{", 
             RowBox[{"2", ",", "2"}], "}"}]}], ")"}], "&&", 
          RowBox[{"ZeroTensorQ", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"g", "-", 
              RowBox[{"Ricci", "[", 
               RowBox[{
                SubscriptBox[
                 RowBox[{"Unique", "[", "i", "]"}], "-"], ",", 
                SubscriptBox[
                 RowBox[{"Unique", "[", "j", "]"}], "-"], ",", "g"}], "]"}]}],
              ")"}], "//", "Simplify"}], "]"}]}], ")"}]}], ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "coord", ",", "i", ",", "j", ",", "Y", ",", "k", ",", "result", ",", 
          "tempidx", ",", "FS", ",", "FSlist"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"coord", "=", 
          RowBox[{"Coordinates", "[", "g", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Y", "=", 
          RowBox[{"NonMetricTensor", "[", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{"SphericalHarmonicY", "[", 
             RowBox[{"l", ",", "m", ",", 
              RowBox[{"Sequence", "@@", "coord"}]}], "]"}], ",", 
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{"\"\<Y\>\"", ",", 
               RowBox[{"Column", "[", 
                RowBox[{"{", 
                 RowBox[{"m", ",", "l"}], "}"}], "]"}]}], "}"}], "]"}], ",", 
            RowBox[{"Coordinates", "\[Rule]", "coord"}], ",", 
            RowBox[{"StartIndex", "\[Rule]", "1"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Y", "=", 
          RowBox[{"TooltipDisplay", "[", 
           RowBox[{"Y", ",", 
            RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Y", "=", 
          RowBox[{"TooltipStyle", "[", 
           RowBox[{"Y", ",", 
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], "]"}]}], ";",
          "\[IndentingNewLine]", "Y"}]}], "\[IndentingNewLine]", "]"}], "/;", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Element", "[", 
            RowBox[{"l", ",", "Complexes"}], "]"}], "===", "True"}], ")"}], "||", 
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"Head", "[", "l", "]"}], ",", 
           RowBox[{"(", 
            RowBox[{"Symbol", "|", "Plus", "|", "Times"}], ")"}]}], "]"}]}], 
        ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Element", "[", 
            RowBox[{"m", ",", "Complexes"}], "]"}], "===", "True"}], ")"}], "||", 
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"Head", "[", "m", "]"}], ",", 
           RowBox[{"(", 
            RowBox[{"Symbol", "|", "Plus", "|", "Times"}], ")"}]}], "]"}]}], 
        ")"}]}]}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8842111799679384`*^9, 3.884211208663726*^9}, {
   3.8842113327198052`*^9, 3.884211349708627*^9}, {3.8842120618296947`*^9, 
   3.8842120711925664`*^9}, {3.884212102090336*^9, 3.8842121449134693`*^9}, {
   3.884212220385887*^9, 3.884212287902378*^9}, 3.884212364732334*^9, {
   3.8842124479732265`*^9, 3.884212474087426*^9}, {3.8842125872596455`*^9, 
   3.8842126004813623`*^9}, {3.884212721113248*^9, 3.8842128053821273`*^9}, {
   3.8842128533406825`*^9, 3.8842128556062346`*^9}, {3.884212919019755*^9, 
   3.884212971543861*^9}, {3.884213341240335*^9, 3.8842134408385954`*^9}, {
   3.8842134714576373`*^9, 3.884213479215489*^9}, {3.8842135287050447`*^9, 
   3.8842135509518585`*^9}, {3.8842137270656085`*^9, 3.884213803120216*^9}, {
   3.8842153165278273`*^9, 3.8842153243590126`*^9}, {3.884216057538616*^9, 
   3.8842160840764046`*^9}, {3.8842161708415847`*^9, 3.884216190713771*^9}, {
   3.884216285793537*^9, 3.8842163504480495`*^9}, 3.8842171224519215`*^9, {
   3.8842171526988573`*^9, 3.8842172051628532`*^9}, {3.8842172925236835`*^9, 
   3.884217355577456*^9}, {3.884217387817747*^9, 3.884217559106192*^9}, 
   3.8842176247605553`*^9, {3.8842176652323236`*^9, 3.8842176691119366`*^9}, {
   3.8842180067846823`*^9, 3.8842181160125628`*^9}, {3.8842187297934227`*^9, 
   3.884218732504753*^9}, {3.884218769097356*^9, 3.8842187758324037`*^9}, {
   3.8842198970105605`*^9, 3.8842198975552254`*^9}, {3.8847725583453474`*^9, 
   3.884772694357439*^9}, {3.8847730879350386`*^9, 3.8847731814856796`*^9}, {
   3.8847733733150434`*^9, 3.884773411463228*^9}, {3.884773713220128*^9, 
   3.8847737559787064`*^9}, {3.8847742769732823`*^9, 
   3.8847743371864786`*^9}, {3.8847745701966186`*^9, 3.884774585388344*^9}, {
   3.8847771389883747`*^9, 3.884777248808498*^9}, {3.8847773323381205`*^9, 
   3.8847773657724657`*^9}, {3.884777433537753*^9, 3.8847774623712406`*^9}, {
   3.88477774915334*^9, 3.8847777945223017`*^9}, {3.8847778311500263`*^9, 
   3.8847778567222977`*^9}, {3.884777894084848*^9, 3.8847780996136293`*^9}, {
   3.884778213493109*^9, 3.8847782247188997`*^9}, {3.884778276048366*^9, 
   3.8847783034797277`*^9}, 3.884778563193598*^9, 3.8847786246010637`*^9, {
   3.8847786570848303`*^9, 3.884778681450074*^9}, {3.8847787174242096`*^9, 
   3.884778737568679*^9}, {3.884778789361764*^9, 3.884778807209193*^9}, {
   3.884778989654413*^9, 3.8847790337839985`*^9}, {3.8847790876765347`*^9, 
   3.884779090051464*^9}, {3.8847791344562144`*^9, 3.8847791905151544`*^9}, {
   3.8847794384306984`*^9, 3.8847794472939796`*^9}, {3.884808910539687*^9, 
   3.884808993629153*^9}, {3.8848092468668528`*^9, 3.8848092584097037`*^9}, 
   3.884809531350893*^9, {3.8853770548177433`*^9, 3.8853770800476036`*^9}, {
   3.8853788852282257`*^9, 3.8853788997772565`*^9}, {3.8853797146679535`*^9, 
   3.8853797212509594`*^9}, 3.885380034450748*^9, {3.8853801942724185`*^9, 
   3.885380227359583*^9}, {3.885380313793097*^9, 3.8853803198183784`*^9}, {
   3.885382727483036*^9, 3.8853827346196365`*^9}, {3.885384569036267*^9, 
   3.8853846127591195`*^9}, {3.885384651395302*^9, 3.8853847685720725`*^9}, {
   3.8853876735131207`*^9, 3.8853876795713844`*^9}, {3.8853887475957575`*^9, 
   3.885388783458391*^9}, {3.8853895956652217`*^9, 3.8853896048391438`*^9}, 
   3.8854228714338207`*^9, 3.8854233759921265`*^9, {3.8870186844190083`*^9, 
   3.8870186996410522`*^9}, 3.8955551726414475`*^9, {3.9677774525985336`*^9, 
   3.9677774526055126`*^9}, 3.97376554602164*^9, {3.975314622052629*^9, 
   3.9753146375978003`*^9}},ExpressionUUID->"9f06ca08-8f2d-4be0-a5fd-\
c759237e39e4"]
}, Closed]],

Cell[CellGroupData[{

Cell["VectorSphericalHarmonic", "Subsection",
 CellChangeTimes->{{3.884211086191988*^9, 
  3.8842110935365057`*^9}},ExpressionUUID->"4375b8ad-6ca0-4d8e-a4f4-\
b57cc6e2c0cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "VectorSphericalHarmonic", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"VectorSphericalHarmonic", "[", 
      RowBox[{
       RowBox[{"idx_", "/;", 
        RowBox[{"(", 
         RowBox[{"TestIndices", "[", "idx", "]"}], ")"}]}], ",", "l_", ",", 
       "m_", ",", "\[Theta]_Symbol", ",", "\[Phi]_Symbol", ",", 
       RowBox[{"VectorType_", "/;", 
        RowBox[{"MatchQ", "[", 
         RowBox[{"VectorType", ",", 
          RowBox[{"(", 
           RowBox[{"\"\<Gradient\>\"", "|", "\"\<Curl\>\""}], ")"}]}], 
         "]"}]}], ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "g", ",", "i", ",", "j", ",", "result", ",", "norm", ",", "tempidx", 
          ",", "FS", ",", "FSlist", ",", "ltemp", ",", "mtemp"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"norm", "=", 
          RowBox[{"OptionValue", "[", "Normalize", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"FSlist", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"0", "\[LessEqual]", " ", "\[Phi]", "\[LessEqual]", 
             RowBox[{"2", "Pi"}]}], ",", 
            RowBox[{"0", "\[LessEqual]", "\[Theta]", "\[LessEqual]", "Pi"}]}],
            "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"IntegerQ", "[", "l", "]"}]}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"FSlist", ",", 
             RowBox[{"l", "\[Element]", "NonNegativeIntegers"}]}], "]"}]}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"IntegerQ", "[", "m", "]"}]}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"FSlist", ",", 
             RowBox[{"m", "\[Element]", "Integers"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"IntegerQ", "[", "l", "]"}], "&&", 
              RowBox[{"IntegerQ", "[", "m", "]"}]}], ")"}]}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"FSlist", ",", 
             RowBox[{
              RowBox[{"-", "l"}], "\[LessEqual]", "m", "\[LessEqual]", 
              "l"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "We", " ", "find", " ", "that", " ", "it", " ", "took", " ", "too",
             " ", "long", " ", "time", " ", "to", " ", "calculate", " ", "a", 
            " ", "good", " ", "form", " ", "of", " ", 
            RowBox[{"VectorSphericalHarmonic", ".", 
             RowBox[{"That", "'"}]}], " ", "s", " ", "why", " ", "we", " ", 
            "want", " ", "to", " ", "save", " ", "the", " ", "result", " ", 
            RowBox[{"directly", ".", " ", "See"}], " ", "Wei"}], "-", 
           RowBox[{
           "Hao", " ", "test", " ", "notebook", " ", "part", " ", "2."}]}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"result", "=", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"VectorType", "===", "\"\<Gradient\>\""}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Head", "[", "idx", "]"}], "===", "SuperMinus"}], 
              ")"}]}], ",", 
            RowBox[{"NonMetricTensor", "[", 
             RowBox[{
              RowBox[{"{", 
               SuperscriptBox["tempidx", "-"], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"mtemp", " ", 
                  RowBox[{"Cot", "[", "\[Theta]", "]"}], " ", 
                  RowBox[{"SphericalHarmonicY", "[", 
                   RowBox[{
                   "ltemp", ",", "mtemp", ",", "\[Theta]", ",", "\[Phi]"}], 
                   "]"}]}], "+", 
                 RowBox[{
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Phi]"}]], " ", 
                  SqrtBox[
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ltemp", "-", "mtemp"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", "ltemp", "+", "mtemp"}], ")"}]}]], " ", 
                  RowBox[{"SphericalHarmonicY", "[", 
                   RowBox[{"ltemp", ",", 
                    RowBox[{"1", "+", "mtemp"}], ",", "\[Theta]", ",", 
                    "\[Phi]"}], "]"}]}]}], ",", 
                RowBox[{"\[ImaginaryI]", " ", "mtemp", " ", 
                 SuperscriptBox[
                  RowBox[{"Csc", "[", "\[Theta]", "]"}], "2"], " ", 
                 RowBox[{"SphericalHarmonicY", "[", 
                  RowBox[{
                  "ltemp", ",", "mtemp", ",", "\[Theta]", ",", "\[Phi]"}], 
                  "]"}]}]}], "}"}], ",", 
              RowBox[{"Del", "[", 
               RowBox[{"Row", "[", 
                RowBox[{"{", 
                 RowBox[{"\"\<Y\>\"", ",", 
                  RowBox[{"Column", "[", 
                   RowBox[{"{", 
                    RowBox[{"mtemp", ",", "ltemp"}], "}"}], "]"}]}], "}"}], 
                "]"}], "]"}], ",", 
              RowBox[{"Coordinates", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}]}], ",", 
              RowBox[{"StartIndex", "\[Rule]", "1"}], ",", 
              RowBox[{"TensorAssumption", "\[Rule]", " ", "FSlist"}]}], "]"}],
             ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"VectorType", "===", "\"\<Curl\>\""}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Head", "[", "idx", "]"}], "===", "SuperMinus"}], 
              ")"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"NonMetricTensor", "[", 
             RowBox[{
              RowBox[{"{", 
               SuperscriptBox["tempidx", "-"], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[ImaginaryI]", " ", "mtemp", " ", 
                 RowBox[{"Csc", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"SphericalHarmonicY", "[", 
                  RowBox[{
                  "ltemp", ",", "mtemp", ",", "\[Theta]", ",", "\[Phi]"}], 
                  "]"}]}], ",", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"Csc", "[", "\[Theta]", "]"}]}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"mtemp", " ", 
                    RowBox[{"Cot", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"SphericalHarmonicY", "[", 
                    RowBox[{
                    "ltemp", ",", "mtemp", ",", "\[Theta]", ",", "\[Phi]"}], 
                    "]"}]}], "+", 
                   RowBox[{
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Phi]"}]], " ", 
                    RowBox[{"\[Sqrt]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ltemp", "-", "mtemp"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", "ltemp", "+", "mtemp"}], ")"}]}], 
                    ")"}]}], " ", 
                    RowBox[{"SphericalHarmonicY", "[", 
                    RowBox[{"ltemp", ",", 
                    RowBox[{"1", "+", "mtemp"}], ",", "\[Theta]", ",", 
                    "\[Phi]"}], "]"}]}]}], ")"}]}]}], "}"}], ",", 
              RowBox[{"Row", "[", 
               RowBox[{"{", 
                RowBox[{"\"\<\[FivePointedStar]\>\"", ",", 
                 RowBox[{"Row", "[", 
                  RowBox[{"{", 
                   RowBox[{"\"\<\[DifferentialD]\>\"", ",", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Y\>\"", ",", 
                    RowBox[{"Column", "[", 
                    RowBox[{"{", 
                    RowBox[{"mtemp", ",", "ltemp"}], "}"}], "]"}]}], "}"}], 
                    "]"}]}], "}"}], "]"}]}], "}"}], "]"}], ",", 
              RowBox[{"Coordinates", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}]}], ",", 
              RowBox[{"StartIndex", "\[Rule]", "1"}], ",", 
              RowBox[{"TensorAssumption", "\[Rule]", " ", "FSlist"}]}], "]"}],
             ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"VectorType", "===", "\"\<Gradient\>\""}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Head", "[", "idx", "]"}], "===", "SubMinus"}], 
              ")"}]}], ",", 
            RowBox[{"NonMetricTensor", "[", 
             RowBox[{
              RowBox[{"{", 
               SubscriptBox["tempidx", "-"], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"mtemp", " ", 
                  RowBox[{"Cot", "[", "\[Theta]", "]"}], " ", 
                  RowBox[{"SphericalHarmonicY", "[", 
                   RowBox[{
                   "ltemp", ",", "mtemp", ",", "\[Theta]", ",", "\[Phi]"}], 
                   "]"}]}], "+", 
                 RowBox[{
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Phi]"}]], " ", 
                  SqrtBox[
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ltemp", "-", "mtemp"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", "ltemp", "+", "mtemp"}], ")"}]}]], " ", 
                  RowBox[{"SphericalHarmonicY", "[", 
                   RowBox[{"ltemp", ",", 
                    RowBox[{"1", "+", "mtemp"}], ",", "\[Theta]", ",", 
                    "\[Phi]"}], "]"}]}]}], ",", 
                RowBox[{"\[ImaginaryI]", " ", "mtemp", " ", 
                 RowBox[{"SphericalHarmonicY", "[", 
                  RowBox[{
                  "ltemp", ",", "mtemp", ",", "\[Theta]", ",", "\[Phi]"}], 
                  "]"}]}]}], "}"}], ",", 
              RowBox[{"Del", "[", 
               RowBox[{"Row", "[", 
                RowBox[{"{", 
                 RowBox[{"\"\<Y\>\"", ",", 
                  RowBox[{"Column", "[", 
                   RowBox[{"{", 
                    RowBox[{"mtemp", ",", "ltemp"}], "}"}], "]"}]}], "}"}], 
                "]"}], "]"}], ",", 
              RowBox[{"Coordinates", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}]}], ",", 
              RowBox[{"StartIndex", "\[Rule]", "1"}], ",", 
              RowBox[{"TensorAssumption", "\[Rule]", "FSlist"}]}], "]"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"VectorType", "===", "\"\<Curl\>\""}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Head", "[", "idx", "]"}], "===", "SubMinus"}], 
              ")"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"NonMetricTensor", "[", 
             RowBox[{
              RowBox[{"{", 
               SubscriptBox["tempidx", "-"], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[ImaginaryI]", " ", "mtemp", " ", 
                 RowBox[{"Csc", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"SphericalHarmonicY", "[", 
                  RowBox[{
                  "ltemp", ",", "mtemp", ",", "\[Theta]", ",", "\[Phi]"}], 
                  "]"}]}], ",", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"Sin", "[", "\[Theta]", "]"}]}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"mtemp", " ", 
                    RowBox[{"Cot", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"SphericalHarmonicY", "[", 
                    RowBox[{
                    "ltemp", ",", "mtemp", ",", "\[Theta]", ",", "\[Phi]"}], 
                    "]"}]}], "+", 
                   RowBox[{
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Phi]"}]], " ", 
                    RowBox[{"\[Sqrt]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ltemp", "-", "mtemp"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", "ltemp", "+", "mtemp"}], ")"}]}], 
                    ")"}]}], " ", 
                    RowBox[{"SphericalHarmonicY", "[", 
                    RowBox[{"ltemp", ",", 
                    RowBox[{"1", "+", "mtemp"}], ",", "\[Theta]", ",", 
                    "\[Phi]"}], "]"}]}]}], ")"}]}]}], "}"}], ",", 
              RowBox[{"Row", "[", 
               RowBox[{"{", 
                RowBox[{"\"\<\[FivePointedStar]\>\"", ",", 
                 RowBox[{"Row", "[", 
                  RowBox[{"{", 
                   RowBox[{"\"\<\[DifferentialD]\>\"", ",", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Y\>\"", ",", 
                    RowBox[{"Column", "[", 
                    RowBox[{"{", 
                    RowBox[{"mtemp", ",", "ltemp"}], "}"}], "]"}]}], "}"}], 
                    "]"}]}], "}"}], "]"}]}], "}"}], "]"}], ",", 
              RowBox[{"Coordinates", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}]}], ",", 
              RowBox[{"StartIndex", "\[Rule]", "1"}], ",", 
              RowBox[{"TensorAssumption", "\[Rule]", " ", "FSlist"}]}], 
             "]"}]}], "]"}]}], ";", 
         RowBox[{"result", "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Which", "[", 
               RowBox[{
                RowBox[{"norm", "===", "True"}], ",", 
                RowBox[{"(", 
                 RowBox[{"result", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"TensorComponents", "\[Rule]", " ", "comp_"}], 
                    ")"}], "\[RuleDelayed]", " ", 
                    RowBox[{"(", 
                    RowBox[{"TensorComponents", "\[Rule]", 
                    RowBox[{
                    FractionBox["1", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"l", " ", 
                    RowBox[{"(", 
                    RowBox[{"l", "+", "1"}], ")"}]}], "]"}]], "  ", 
                    "comp"}]}], ")"}]}], "}"}]}], ")"}], ",", "True", ",", 
                " ", "result"}], "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{"tempidx", "\[Rule]", 
                RowBox[{
                "idx", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], " ", "}"}]}], ")"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ltemp", "\[Rule]", " ", "l"}], ",", 
              RowBox[{"mtemp", "\[Rule]", " ", "m"}]}], "}"}]}], ")"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}], "=!=", 
            "Null"}], ",", 
           RowBox[{"result", "=", 
            RowBox[{"TooltipDisplay", "[", 
             RowBox[{"result", ",", 
              RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], 
             "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"result", "=", 
            RowBox[{"TooltipStyle", "[", 
             RowBox[{"result", ",", 
              RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], "]"}]}]}], 
          "]"}], ";", "\[IndentingNewLine]", "result"}]}], 
       "\[IndentingNewLine]", "]"}], "/;", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"IntegerQ", "[", "l", "]"}], "||", 
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"Head", "[", "l", "]"}], ",", 
           RowBox[{"(", 
            RowBox[{"Symbol", "|", "Plus", "|", "Times"}], ")"}]}], "]"}]}], 
        ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"IntegerQ", "[", "m", "]"}], "||", 
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"Head", "[", "m", "]"}], ",", 
           RowBox[{"(", 
            RowBox[{"Symbol", "|", "Plus", "|", "Times"}], ")"}]}], "]"}]}], 
        ")"}], "&&", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"IntegerQ", "[", "l", "]"}], "&&", 
           RowBox[{"IntegerQ", "[", "m", "]"}]}], ")"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"l", "\[GreaterEqual]", "0"}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "l"}], "\[LessEqual]", "m", "\[LessEqual]", "l"}], 
           ")"}]}], ",", "True", ",", "True"}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"VectorSphericalHarmonic", "[", 
      RowBox[{
       RowBox[{"idx_", "/;", 
        RowBox[{"(", 
         RowBox[{"TestIndices", "[", "idx", "]"}], ")"}]}], ",", "l_", ",", 
       "m_", ",", 
       RowBox[{"g_Tensor", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestMetricTensor", "[", "g", "]"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Dimensions", "[", "g", "]"}], "===", 
            RowBox[{"{", 
             RowBox[{"2", ",", "2"}], "}"}]}], ")"}], "&&", 
          RowBox[{"ZeroTensorQ", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"g", "-", 
              RowBox[{"Ricci", "[", 
               RowBox[{
                SubscriptBox[
                 RowBox[{"Unique", "[", "iiiii", "]"}], "-"], ",", 
                SubscriptBox[
                 RowBox[{"Unique", "[", "jjjjj", "]"}], "-"], ",", "g"}], 
               "]"}]}], ")"}], "//", "Simplify"}], "]"}]}], ")"}]}], ",", 
       RowBox[{"VectorType_", "/;", 
        RowBox[{"MatchQ", "[", 
         RowBox[{"VectorType", ",", 
          RowBox[{"(", 
           RowBox[{"\"\<Gradient\>\"", "|", "\"\<Curl\>\""}], ")"}]}], 
         "]"}]}], ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "coord", ",", "result", ",", "norm", ",", "tempidx", ",", "FS", ",", 
          "FSlist", ",", "\[Theta]", ",", "\[Phi]", ",", "ltemp", ",", 
          "mtemp"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"norm", "=", 
          RowBox[{"OptionValue", "[", "Normalize", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"coord", "=", 
          RowBox[{"Coordinates", "[", "g", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Theta]", "=", 
          RowBox[{
          "coord", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"\[Phi]", "=", 
          RowBox[{
          "coord", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"result", "=", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"VectorType", "===", "\"\<Gradient\>\""}], ")"}], ",", 
            RowBox[{"NonMetricTensor", "[", 
             RowBox[{
              RowBox[{"{", 
               SuperscriptBox["tempidx", "-"], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"mtemp", " ", 
                  RowBox[{"Cot", "[", "\[Theta]", "]"}], " ", 
                  RowBox[{"SphericalHarmonicY", "[", 
                   RowBox[{
                   "ltemp", ",", "mtemp", ",", "\[Theta]", ",", "\[Phi]"}], 
                   "]"}]}], "+", 
                 RowBox[{
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Phi]"}]], " ", 
                  SqrtBox[
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ltemp", "-", "mtemp"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", "ltemp", "+", "mtemp"}], ")"}]}]], " ", 
                  RowBox[{"SphericalHarmonicY", "[", 
                   RowBox[{"ltemp", ",", 
                    RowBox[{"1", "+", "mtemp"}], ",", "\[Theta]", ",", 
                    "\[Phi]"}], "]"}]}]}], ",", 
                RowBox[{"\[ImaginaryI]", " ", "mtemp", " ", 
                 SuperscriptBox[
                  RowBox[{"Csc", "[", "\[Theta]", "]"}], "2"], " ", 
                 RowBox[{"SphericalHarmonicY", "[", 
                  RowBox[{
                  "ltemp", ",", "mtemp", ",", "\[Theta]", ",", "\[Phi]"}], 
                  "]"}]}]}], "}"}], ",", 
              RowBox[{"Del", "[", 
               RowBox[{"Row", "[", 
                RowBox[{"{", 
                 RowBox[{"\"\<Y\>\"", ",", 
                  RowBox[{"Column", "[", 
                   RowBox[{"{", 
                    RowBox[{"mtemp", ",", "ltemp"}], "}"}], "]"}]}], "}"}], 
                "]"}], "]"}], ",", 
              RowBox[{"Coordinates", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}]}], ",", 
              RowBox[{"StartIndex", "\[Rule]", "1"}]}], "]"}], ",", 
            RowBox[{"(", 
             RowBox[{"VectorType", "===", "\"\<Curl\>\""}], ")"}], ",", 
            RowBox[{"NonMetricTensor", "[", 
             RowBox[{
              RowBox[{"{", 
               SuperscriptBox["tempidx", "-"], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[ImaginaryI]", " ", "mtemp", " ", 
                 RowBox[{"Csc", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"SphericalHarmonicY", "[", 
                  RowBox[{
                  "ltemp", ",", "mtemp", ",", "\[Theta]", ",", "\[Phi]"}], 
                  "]"}]}], ",", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"Csc", "[", "\[Theta]", "]"}]}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"mtemp", " ", 
                    RowBox[{"Cot", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"SphericalHarmonicY", "[", 
                    RowBox[{
                    "ltemp", ",", "mtemp", ",", "\[Theta]", ",", "\[Phi]"}], 
                    "]"}]}], "+", 
                   RowBox[{
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Phi]"}]], " ", 
                    RowBox[{"\[Sqrt]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ltemp", "-", "mtemp"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", "ltemp", "+", "mtemp"}], ")"}]}], 
                    ")"}]}], " ", 
                    RowBox[{"SphericalHarmonicY", "[", 
                    RowBox[{"ltemp", ",", 
                    RowBox[{"1", "+", "mtemp"}], ",", "\[Theta]", ",", 
                    "\[Phi]"}], "]"}]}]}], ")"}]}]}], "}"}], ",", 
              RowBox[{"Row", "[", 
               RowBox[{"{", 
                RowBox[{"\"\<\[FivePointedStar]\>\"", ",", 
                 RowBox[{"\"\<d\>\"", "[", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<Y\>\"", ",", 
                    RowBox[{"Column", "[", 
                    RowBox[{"{", 
                    RowBox[{"mtemp", ",", "ltemp"}], "}"}], "]"}]}], "}"}], 
                   "]"}], "]"}]}], "}"}], "]"}], ",", 
              RowBox[{"Coordinates", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}]}], ",", 
              RowBox[{"StartIndex", "\[Rule]", "1"}]}], "]"}]}], "]"}]}], ";", 
         RowBox[{"result", "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MoveIndices", "[", 
               RowBox[{
                RowBox[{"Which", "[", 
                 RowBox[{
                  RowBox[{"norm", "===", "True"}], ",", 
                  RowBox[{"(", 
                   RowBox[{"result", "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"TensorComponents", "\[Rule]", " ", "comp_"}], 
                    ")"}], "\[RuleDelayed]", " ", 
                    RowBox[{"(", 
                    RowBox[{"TensorComponents", "\[Rule]", 
                    RowBox[{
                    FractionBox["1", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"l", " ", 
                    RowBox[{"(", 
                    RowBox[{"l", "+", "1"}], ")"}]}], "]"}]], "  ", 
                    "comp"}]}], ")"}]}], "}"}]}], ")"}], ",", "True", ",", 
                  " ", "result"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"tempidx", "//", 
                  RowBox[{
                  "idx", "\[LeftDoubleBracket]", "0", 
                   "\[RightDoubleBracket]"}]}], "}"}], ",", "g"}], "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{"tempidx", "\[Rule]", 
                RowBox[{
                "idx", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], " ", "}"}]}], ")"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ltemp", "\[Rule]", " ", "l"}], ",", 
              RowBox[{"mtemp", "\[Rule]", " ", "m"}]}], "}"}]}], ")"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"!", 
                RowBox[{"IntegerQ", "[", "l", "]"}]}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"!", 
                RowBox[{"IntegerQ", "[", "m", "]"}]}], ")"}]}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"FSlist", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"0", "\[LessEqual]", " ", "\[Phi]", "\[LessEqual]", 
                RowBox[{"2", "Pi"}]}], ",", 
               RowBox[{
               "0", "\[LessEqual]", "\[Theta]", "\[LessEqual]", "Pi"}]}], 
              "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"IntegerQ", "[", "l", "]"}]}], ",", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"FSlist", ",", 
                RowBox[{"l", "\[Element]", "NonNegativeIntegers"}]}], "]"}]}],
              "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"IntegerQ", "[", "m", "]"}]}], ",", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"FSlist", ",", 
                RowBox[{"m", "\[Element]", "Integers"}]}], "]"}]}], "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"IntegerQ", "[", "l", "]"}], "&&", 
                 RowBox[{"IntegerQ", "[", "m", "]"}]}], ")"}]}], ",", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"FSlist", ",", 
                RowBox[{
                 RowBox[{"-", "l"}], "\[LessEqual]", "m", "\[LessEqual]", 
                 "l"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"FS", "=", 
             RowBox[{
              RowBox[{"FullSimplify", "[", 
               RowBox[{"#", ",", 
                RowBox[{"Evaluate", "[", "FSlist", "]"}]}], "]"}], "&"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"result", "=", "result"}]}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}], "=!=", 
            "Null"}], ",", 
           RowBox[{"result", "=", 
            RowBox[{"TooltipDisplay", "[", 
             RowBox[{"result", ",", 
              RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], 
             "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"result", "=", 
            RowBox[{"TooltipStyle", "[", 
             RowBox[{"result", ",", 
              RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], "]"}]}]}], 
          "]"}], ";", "\[IndentingNewLine]", "result"}]}], 
       "\[IndentingNewLine]", "]"}], "/;", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"IntegerQ", "[", "l", "]"}], "||", 
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"Head", "[", "l", "]"}], ",", 
           RowBox[{"(", 
            RowBox[{"Symbol", "|", "Plus", "|", "Times"}], ")"}]}], "]"}]}], 
        ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"IntegerQ", "[", "m", "]"}], "||", 
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"Head", "[", "m", "]"}], ",", 
           RowBox[{"(", 
            RowBox[{"Symbol", "|", "Plus", "|", "Times"}], ")"}]}], "]"}]}], 
        ")"}], "&&", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"IntegerQ", "[", "l", "]"}], "&&", 
           RowBox[{"IntegerQ", "[", "m", "]"}]}], ")"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"l", "\[GreaterEqual]", "0"}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "l"}], "\[LessEqual]", "m", "\[LessEqual]", "l"}], 
           ")"}]}], ",", "True", ",", "True"}], "]"}]}]}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8842111799679384`*^9, 3.884211208663726*^9}, {
   3.8842113327198052`*^9, 3.884211349708627*^9}, {3.8842120618296947`*^9, 
   3.8842120711925664`*^9}, {3.884212102090336*^9, 3.8842121449134693`*^9}, {
   3.884212220385887*^9, 3.884212287902378*^9}, 3.884212364732334*^9, {
   3.8842124479732265`*^9, 3.884212474087426*^9}, {3.8842125872596455`*^9, 
   3.8842126004813623`*^9}, {3.884212721113248*^9, 3.8842128053821273`*^9}, {
   3.8842128533406825`*^9, 3.8842128556062346`*^9}, {3.884212919019755*^9, 
   3.884212971543861*^9}, {3.884213341240335*^9, 3.8842134408385954`*^9}, {
   3.8842134714576373`*^9, 3.884213479215489*^9}, {3.8842135287050447`*^9, 
   3.8842135509518585`*^9}, {3.8842137270656085`*^9, 3.884213803120216*^9}, {
   3.8842153165278273`*^9, 3.8842153243590126`*^9}, {3.884216057538616*^9, 
   3.8842160840764046`*^9}, {3.8842161708415847`*^9, 3.884216190713771*^9}, {
   3.884216285793537*^9, 3.8842163504480495`*^9}, 3.8842171224519215`*^9, {
   3.8842171526988573`*^9, 3.8842172051628532`*^9}, {3.8842172925236835`*^9, 
   3.884217355577456*^9}, {3.884217387817747*^9, 3.884217559106192*^9}, 
   3.8842176247605553`*^9, {3.8842176652323236`*^9, 3.8842176691119366`*^9}, {
   3.8842180067846823`*^9, 3.8842181160125628`*^9}, {3.8842187297934227`*^9, 
   3.884218732504753*^9}, {3.884218769097356*^9, 3.8842187758324037`*^9}, {
   3.8842198970105605`*^9, 3.8842198975552254`*^9}, {3.8847725583453474`*^9, 
   3.884772694357439*^9}, {3.8847730879350386`*^9, 3.8847731814856796`*^9}, {
   3.8847733733150434`*^9, 3.884773411463228*^9}, {3.884773713220128*^9, 
   3.8847737559787064`*^9}, {3.8847742769732823`*^9, 
   3.8847743371864786`*^9}, {3.8847745701966186`*^9, 3.884774585388344*^9}, {
   3.8847771389883747`*^9, 3.884777248808498*^9}, {3.8847773323381205`*^9, 
   3.8847773657724657`*^9}, {3.884777433537753*^9, 3.8847774623712406`*^9}, {
   3.88477774915334*^9, 3.8847777945223017`*^9}, {3.8847778311500263`*^9, 
   3.8847778567222977`*^9}, {3.884777894084848*^9, 3.8847780996136293`*^9}, {
   3.884778213493109*^9, 3.8847782247188997`*^9}, {3.884778276048366*^9, 
   3.8847783034797277`*^9}, 3.884778563193598*^9, 3.8847786246010637`*^9, {
   3.8847786570848303`*^9, 3.884778681450074*^9}, {3.8847787174242096`*^9, 
   3.884778737568679*^9}, {3.884778789361764*^9, 3.884778807209193*^9}, {
   3.884778989654413*^9, 3.8847790337839985`*^9}, {3.8847790876765347`*^9, 
   3.884779090051464*^9}, {3.8847791344562144`*^9, 3.8847791905151544`*^9}, {
   3.8847794384306984`*^9, 3.8847794472939796`*^9}, {3.884808910539687*^9, 
   3.884808993629153*^9}, {3.8848092468668528`*^9, 3.8848092584097037`*^9}, 
   3.884809531350893*^9, {3.8853770548177433`*^9, 3.8853770800476036`*^9}, {
   3.8853788852282257`*^9, 3.8853788997772565`*^9}, {3.8853797146679535`*^9, 
   3.8853797212509594`*^9}, 3.885380034450748*^9, {3.8853801942724185`*^9, 
   3.885380227359583*^9}, {3.885380313793097*^9, 3.8853803198183784`*^9}, {
   3.885382727483036*^9, 3.8853827346196365`*^9}, {3.885384569036267*^9, 
   3.8853846127591195`*^9}, {3.885384651395302*^9, 3.8853847685720725`*^9}, {
   3.8853876735131207`*^9, 3.8853876795713844`*^9}, {3.8853887475957575`*^9, 
   3.885388783458391*^9}, {3.8853895956652217`*^9, 3.8853896048391438`*^9}, {
   3.8854383951490545`*^9, 3.8854383971406994`*^9}, 3.8859637166042895`*^9, {
   3.8859858592724957`*^9, 3.885985863780736*^9}, 3.8859859757145605`*^9, {
   3.885986143564756*^9, 3.885986242604554*^9}, {3.8859869157516174`*^9, 
   3.885986924516262*^9}, {3.886043716667695*^9, 3.886043723940254*^9}, 
   3.886116295880954*^9, {3.887018559591035*^9, 3.88701859518428*^9}, {
   3.8870186306190505`*^9, 3.8870186385618443`*^9}, {3.8922100563046684`*^9, 
   3.892210147318981*^9}, {3.8922101815943794`*^9, 3.8922101875457277`*^9}, {
   3.8922103663401184`*^9, 3.8922103952288847`*^9}, {3.8955547752305737`*^9, 
   3.895554775261554*^9}, {3.8955551726514406`*^9, 3.8955551726584353`*^9}, {
   3.9677774526145363`*^9, 3.9677774527035456`*^9}, {3.97376554602929*^9, 
   3.973765546036525*^9}, {3.975314644507444*^9, 
   3.975314703191743*^9}},ExpressionUUID->"50c6e264-7529-47c9-b7ad-\
c8dfe917b77a"]
}, Closed]],

Cell[CellGroupData[{

Cell["ElectromagneticStressEnergyTensor", "Subsection",
 CellChangeTimes->{
  3.8955460780113373`*^9},ExpressionUUID->"a55d1c18-3c45-4e1f-9386-\
d993b2e4baea"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ElectromagneticStressEnergyTensor", "[", 
    RowBox[{
     RowBox[{"\[Mu]T1_", "/;", 
      RowBox[{"(*", 
       RowBox[{"Not", " ", "allow", " ", "OverHatIndices", " ", "for", " ", 
        RowBox[{"now", "."}]}], "*)"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"TestIndices", "[", "\[Mu]T1", "]"}], "&&", 
        RowBox[{"!", 
         RowBox[{"TestOverHatIndex", "[", "\[Mu]T1", "]"}]}]}], ")"}]}], ",", 
     RowBox[{"\[Mu]T2_", "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"TestIndices", "[", "\[Mu]T2", "]"}], "&&", 
        RowBox[{"!", 
         RowBox[{"TestOverHatIndex", "[", "\[Mu]T2", "]"}]}]}], ")"}]}], ",", 
     "F_Tensor", ",", 
     RowBox[{"m_Tensor", "/;", 
      RowBox[{"TestMetricTensor", "[", "m", "]"}]}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Tup", ",", "\[Mu]", ",", "\[Nu]", ",", "\[Alpha]", ",", "\[Beta]"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Tup", "=", 
       RowBox[{"RemoveUnderBarredIndices", "[", 
        RowBox[{"TensorsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"OptionValue", "[", "MetricSignature", "]"}], "===", 
               "\"\<MostlyMinus\>\""}], ")"}], ",", " ", 
             RowBox[{"-", "1"}], ",", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"OptionValue", "[", "MetricSignature", "]"}], "===", 
               "\"\<MostlyPlus\>\""}], ")"}], ",", " ", "1"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"TensorsProduct", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"MoveIndices", "[", 
                 RowBox[{"F", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    SuperscriptBox["\[Mu]", "-"], ",", 
                    SuperscriptBox["\[Alpha]", "-"]}], "}"}], ",", "m"}], 
                 "]"}], ",", " ", 
                RowBox[{"MoveIndices", "[", 
                 RowBox[{"F", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    SuperscriptBox["\[Nu]", "-"], ",", 
                    SubscriptBox["\[Alpha]", "-"]}], "}"}], ",", "m"}], 
                 "]"}]}], "}"}], "]"}], "-", 
             RowBox[{"TensorsProduct", "[", 
              RowBox[{"{", 
               RowBox[{
                FractionBox["1", "4"], ",", 
                RowBox[{"Metric", "[", 
                 RowBox[{
                  SuperscriptBox["\[Mu]", "-"], ",", 
                  SuperscriptBox["\[Nu]", "-"], ",", "m"}], "]"}], ",", 
                RowBox[{"MoveIndices", "[", 
                 RowBox[{"F", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    SubscriptBox["\[Alpha]", "-"], ",", 
                    SubscriptBox["\[Beta]", "-"]}], "}"}], ",", "m"}], "]"}], 
                ",", " ", 
                RowBox[{"MoveIndices", "[", 
                 RowBox[{"F", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    SuperscriptBox["\[Alpha]", "-"], ",", 
                    SuperscriptBox["\[Beta]", "-"]}], "}"}], ",", "m"}], 
                 "]"}]}], "}"}], "]"}]}], ")"}]}], ",", "Tensor", ",", 
          RowBox[{"TensorName", "\[Rule]", " ", "\"\<T\>\""}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"MoveIndices", "[", 
       RowBox[{"Tup", ",", 
        RowBox[{"{", 
         RowBox[{"\[Mu]T1", ",", "\[Mu]T2"}], "}"}], ",", "m"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8955464645924206`*^9, 3.8955464677672596`*^9}, {
   3.895554775272547*^9, 3.895554775275545*^9}, 3.895555172662923*^9, 
   3.8966132596299334`*^9, 3.8974732966612697`*^9, 3.972502956718216*^9, 
   3.97372493086867*^9, {3.974949779756571*^9, 3.974949796953413*^9}, {
   3.975314712732429*^9, 
   3.975314725747637*^9}},ExpressionUUID->"e76f6b7f-8058-4fc4-8e18-\
32647377a312"]
}, Closed]],

Cell[CellGroupData[{

Cell["Ideal Magnetohydrodynamics (iMHD) in 4D", "Subsection",
 CellChangeTimes->{{3.6712529656246877`*^9, 3.6712529992017484`*^9}, 
   3.6712918765546055`*^9, {3.671306355705207*^9, 3.6713063567529087`*^9}, {
   3.671973284907233*^9, 3.671973287294138*^9}, 
   3.6728125969265647`*^9},ExpressionUUID->"9aeb1f18-2f1d-4f6e-b2d8-\
2c04ed42fe68"],

Cell[CellGroupData[{

Cell["Description (Reference only, no code)", "Subsubsection",
 CellChangeTimes->{{3.6712939383165674`*^9, 3.6712939602890015`*^9}, {
  3.6713264163476667`*^9, 
  3.671326425672784*^9}},ExpressionUUID->"5db8945c-3ed2-4319-93e6-\
ef131d7ea38b"],

Cell[TextData[{
 "The primary goal of these functions in ",
 StyleBox["TensoriaCalc",
  FontSlant->"Italic"],
 " pre-pended with \[OpenCurlyDoubleQuote]MHD\[CloseCurlyDoubleQuote] is to \
implement the partial differential equations (PDEs) of ideal \
magnetohydrodynamics (MHD) in a user-specified 4-dimensional (4D) curved \
spacetime. "
}], "Text",
 CellChangeTimes->{{3.6712939736745253`*^9, 3.671293991572858*^9}, {
   3.6712969404506416`*^9, 3.6712970253866053`*^9}, {3.6712997216015625`*^9, 
   3.6712999242607985`*^9}, {3.6713002674192395`*^9, 3.67130026770004*^9}, {
   3.671301138554565*^9, 3.6713011412789707`*^9}, {3.6713025332643924`*^9, 
   3.671302583890283*^9}, {3.6713063610760164`*^9, 3.671306370954634*^9}, {
   3.6713172720006523`*^9, 3.671317305271164*^9}, 3.67205765272163*^9, {
   3.672615347021308*^9, 3.67261535107387*^9}, 
   3.6728041921198864`*^9},ExpressionUUID->"550153cc-829c-4cab-b436-\
a3dffadefa9f"],

Cell[TextData[{
 StyleBox["\[OpenCurlyDoubleQuote]Frozen-in\[CloseCurlyDoubleQuote] condition",
  FontWeight->"Bold"],
 "\tIdeal MHD describes Maxwell's equations coupled to an \
electromagnetic-current-carrying perfect fluid plasma, in such a way that the \
latter's number density current ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["n", "\[Mu]"], TraditionalForm]],ExpressionUUID->
  "bd22dff8-97b3-423c-96b0-cf43139db58e"],
 " is always orthogonal to the electromagnetic field strength ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["F", "\[Mu]\[Nu]"], TraditionalForm]],ExpressionUUID->
  "c6c53874-c0a3-4f1f-8742-9d7ec219c9ea"],
 ", i.e., ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["n", "\[Mu]"], 
     SubscriptBox["F", "\[Mu]\[Nu]"]}], "=", "0"}], TraditionalForm]],
  ExpressionUUID->"d80b0ee4-adcb-4704-bad1-9358954411c1"],
 "."
}], "Text",
 CellChangeTimes->{{3.6712939736745253`*^9, 3.671293991572858*^9}, {
   3.6712969404506416`*^9, 3.6712970253866053`*^9}, {3.6712997216015625`*^9, 
   3.6712999242607985`*^9}, {3.6713002674192395`*^9, 3.67130026770004*^9}, {
   3.671301138554565*^9, 3.6713011412789707`*^9}, {3.6713025332643924`*^9, 
   3.671302583890283*^9}, {3.6713063610760164`*^9, 3.671306370954634*^9}, {
   3.6713172720006523`*^9, 3.671317305271164*^9}, 3.67205765272163*^9, {
   3.672615347021308*^9, 3.67261535107387*^9}, {3.6728041921198864`*^9, 
   3.672804202689913*^9}, {3.6728477815841436`*^9, 3.6728477818411584`*^9}, {
   3.67284786194174*^9, 
   3.6728478793117332`*^9}},ExpressionUUID->"06625af5-e892-4986-a9e0-\
3fcb55cd4351"],

Cell[TextData[{
 StyleBox["Fields",
  FontWeight->"Bold"],
 "\t\tThe fundamental degrees of freedom in 4D MHD are 3 scalar fields, which \
we will denote here as {",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["\[CapitalPhi]", "I"], "=", " ", 
     SubscriptBox["\[CapitalPhi]", "I"]}], ",", 
    RowBox[{"I", "=", "1"}], ",", "2", ",", "3"}], TraditionalForm]],
  ExpressionUUID->"8f9bafb6-fee1-48c5-9fea-1ba50ba535f7"],
 "}."
}], "Text",
 CellChangeTimes->{{3.6712939736745253`*^9, 3.671293991572858*^9}, {
  3.6712969404506416`*^9, 3.6712970253866053`*^9}, {3.6712997216015625`*^9, 
  3.6712999847107153`*^9}, {3.6713011559638033`*^9, 3.6713011566044044`*^9}, {
  3.6713025903862963`*^9, 3.6713025945993032`*^9}, {3.6720577776285486`*^9, 
  3.6720577874011984`*^9}, {3.6728478276507783`*^9, 
  3.6728478418005877`*^9}},ExpressionUUID->"4fe5a98c-8d34-40fb-a0f9-\
d95ece083cf3"],

Cell[TextData[{
 "From the first two scalar fields, we build the electromagnetic tensor from \
the wedge product of their associated 1-forms: ",
 Cell[BoxData[
  FormBox["F", TraditionalForm]],ExpressionUUID->
  "6309e498-ec00-42d3-ac4a-baf3195abf55"],
 " = \[DifferentialD]",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalPhi]", "1"], TraditionalForm]],ExpressionUUID->
  "43663510-bd6c-473b-986e-e7cb02bfdef5"],
 "\[Wedge] \[DifferentialD]",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalPhi]", "2"], TraditionalForm]],ExpressionUUID->
  "ea8b0a16-82e1-4a11-9332-48810fd61099"],
 ", or in components,\n\t ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["F", "\[Mu]\[Nu]"], TraditionalForm]],ExpressionUUID->
  "c9d7bfeb-49cb-44fc-bfa6-dd71d383400c"],
 " = ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[PartialD]", 
    RowBox[{"[", "\[Mu]"}]], TraditionalForm]],ExpressionUUID->
  "594cf7d7-8801-4fad-9064-b58c963965ac"],
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalPhi]", "1"], TraditionalForm]],ExpressionUUID->
  "7f2da032-a3d7-47a4-afaf-d38ba42596ba"],
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[PartialD]", 
    RowBox[{"\[Nu]", "]"}]], TraditionalForm]],ExpressionUUID->
  "14f866d0-47f6-4443-b36d-74e55f68d28f"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[CapitalPhi]", "2"], "\[Congruent]", " "}], 
   TraditionalForm]],ExpressionUUID->"97a8f05d-248e-4809-ae61-77c2bf8ba289"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[PartialD]", "\[Mu]"], 
      SuperscriptBox["\[CapitalPhi]", "1"]}], 
     RowBox[{
      SubscriptBox["\[PartialD]", "\[Nu]"], 
      SuperscriptBox["\[CapitalPhi]", "2"]}]}], "-", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[PartialD]", "\[Nu]"], 
      SuperscriptBox["\[CapitalPhi]", "1"]}], 
     RowBox[{
      SubscriptBox["\[PartialD]", "\[Mu]"], 
      SuperscriptBox["\[CapitalPhi]", "2"]}]}]}], TraditionalForm]],
  ExpressionUUID->"f19e4706-bd18-49b5-af67-35a5807f25da"],
 "."
}], "Text",
 CellChangeTimes->{{3.6712939736745253`*^9, 3.671293991572858*^9}, {
  3.6712969404506416`*^9, 3.6712970253866053`*^9}, {3.6712997216015625`*^9, 
  3.6713002470684023`*^9}, {3.6713002953152914`*^9, 3.6713003548108*^9}, {
  3.6713022457043276`*^9, 3.671302250464336*^9}, {3.6716554243959045`*^9, 
  3.6716554267284403`*^9}},ExpressionUUID->"484f6c56-4b94-4e41-89a3-\
11bbf52411f1"],

Cell[TextData[{
 "The third scalar field enters in the plasma current,\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["n", "\[Mu]"], "=", 
    SuperscriptBox[
     OverscriptBox["\[Epsilon]", "~"], 
     RowBox[{"\[Mu]", " ", "\[Alpha]\[Beta]\[Gamma]"}]]}], TraditionalForm]],
  ExpressionUUID->"cd674a85-66b2-4ce9-bab3-629d7bd08397"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[PartialD]", "\[Alpha]"], 
    SuperscriptBox["\[CapitalPhi]", "1"]}], TraditionalForm]],ExpressionUUID->
  "a59f03a2-7da9-4b74-afb0-aa9593f51668"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[PartialD]", "\[Beta]"], 
    SuperscriptBox["\[CapitalPhi]", "2"]}], TraditionalForm]],ExpressionUUID->
  "0735f634-a893-4d34-9214-b56f304d042c"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[PartialD]", "\[Gamma]"], 
    SuperscriptBox["\[CapitalPhi]", "3"]}], TraditionalForm]],ExpressionUUID->
  "ae1caf8e-9548-48ee-b207-3f60ca278584"],
 ".\nBecause of the anti-symmetric properties of the covariant Levi-Civita \
tensor ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    OverscriptBox["\[Epsilon]", "~"], 
    RowBox[{"\[Mu]", " ", "\[Alpha]\[Beta]\[Gamma]"}]], TraditionalForm]],
  ExpressionUUID->"1853f0d9-d4b6-4b03-a51f-0562dfee9b8b"],
 ", we can see directly that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["n", "\[Mu]"], 
     RowBox[{
      SubscriptBox["\[PartialD]", "\[Mu]"], 
      SuperscriptBox["\[CapitalPhi]", "I"]}]}], "=", "0"}], TraditionalForm]],
  ExpressionUUID->"caf1167a-56f1-43d5-81c5-a822aa77ae70"],
 ", and hence ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["n", "\[Mu]"], 
     SubscriptBox["F", "\[Mu]\[Nu]"]}], "=", "0"}], TraditionalForm]],
  ExpressionUUID->"c8243cb4-0f69-4efe-bce5-e9e2b1779d17"],
 ", as already advertised."
}], "Text",
 CellChangeTimes->{{3.6712939736745253`*^9, 3.671293991572858*^9}, {
  3.6712969404506416`*^9, 3.6712970253866053`*^9}, {3.6712997216015625`*^9, 
  3.6713002470684023`*^9}, {3.6713002953152914`*^9, 3.671300453483987*^9}, {
  3.671301168251836*^9, 3.671301219523346*^9}, {3.671302283501396*^9, 
  3.671302285156999*^9}, {3.6713064349874682`*^9, 3.6713065040065913`*^9}, {
  3.671325910470871*^9, 3.6713259156956806`*^9}, {3.671655439988644*^9, 
  3.6716554446362157`*^9}, {3.672847949864769*^9, 
  3.672847998587556*^9}},ExpressionUUID->"9a4d30a7-e9b1-49e7-ad9a-\
e04e4ad3649c"],

Cell[TextData[{
 StyleBox["Action",
  FontWeight->"Bold"],
 "\tThe action for MHD is\n\t",
 Cell[BoxData[
  FormBox[
   SubscriptBox["S", "MHD"], TraditionalForm]],ExpressionUUID->
  "da779efb-c03e-4cee-9737-89b65bed5c43"],
 " ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Congruent]", " ", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[DifferentialD]", "4"], 
       SuperscriptBox[
        RowBox[{"x", "(", 
         RowBox[{"|", "g", "|"}], ")"}], 
        RowBox[{"1", "/", "2"}]]}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          SubscriptBox["\[Rho]", "0"], "[", 
          RowBox[{
           SubscriptBox["\[Sigma]", "g"], 
           RowBox[{
            SuperscriptBox["n", "2"], "/", "2"}]}], "]"}]}], "-", 
        RowBox[{
         FractionBox["1", "4"], 
         SubscriptBox["F", "\[Mu]\[Nu]"], 
         SuperscriptBox["F", "\[Mu]\[Nu]"]}]}], ")"}]}]}]}], 
   TraditionalForm]],ExpressionUUID->"88832433-85a0-48b6-93c8-cea521bc8246"],
 ", \t(Eq. 0)\nwhere ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Rho]", "0"], TraditionalForm]],ExpressionUUID->
  "081b1362-ca0f-44c7-8f2e-654b02f1f06c"],
 " depends on spacetime solely through the plasma current squared ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["n", "2"], " "}], TraditionalForm]],ExpressionUUID->
  "ac71e382-fcde-4f1d-8046-2b6a88e8d0b7"],
 "\[Congruent] ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["n", "\[Mu]"], 
    SuperscriptBox["n", "\[Mu]"]}], TraditionalForm]],ExpressionUUID->
  "ee9cfb10-d739-408e-9989-8683446bdef1"],
 "; the \n\t",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Sigma]", "g"], TraditionalForm]],ExpressionUUID->
  "7fa876e4-85a5-4270-a110-991c15ef0237"],
 "=+1 \tif you use ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Eta]", "\[Mu]\[Nu]"], "=", 
    RowBox[{"diag", "[", 
     RowBox[{
      RowBox[{"+", "1"}], ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}]}], "]"}]}], TraditionalForm]],ExpressionUUID->
  "ecbe931b-43b9-47a7-aadf-6a40be46be5a"],
 ", \tand \n\t",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Sigma]", "g"], TraditionalForm]],ExpressionUUID->
  "88ef3c17-e3f6-4ecc-a418-f36a57e109da"],
 "=-1 \t\tif you use ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Eta]", "\[Mu]\[Nu]"], "=", 
    RowBox[{"diag", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}]}], "]"}]}], TraditionalForm]],ExpressionUUID->
  "587517c8-a071-408b-af76-0200afc2a44c"],
 ". "
}], "Text",
 CellChangeTimes->{{3.6712939736745253`*^9, 3.671293991572858*^9}, {
   3.6712969404506416`*^9, 3.6712970253866053`*^9}, {3.6712997216015625`*^9, 
   3.6713002470684023`*^9}, {3.6713002953152914`*^9, 3.671300453483987*^9}, {
   3.671301168251836*^9, 3.6713013179499617`*^9}, {3.671301439298715*^9, 
   3.6713015211602836`*^9}, {3.6713021050902667`*^9, 
   3.6713021175900917`*^9}, {3.671302187410219*^9, 3.671302230187499*^9}, {
   3.6713022613933554`*^9, 3.6713022747623806`*^9}, {3.6713026394845953`*^9, 
   3.6713026552222257`*^9}, {3.6713163754068813`*^9, 
   3.6713163767344017`*^9}, {3.6713168451540966`*^9, 3.6713168531742196`*^9}, 
   3.6713254673688707`*^9, {3.6713261628766065`*^9, 3.671326165437511*^9}, 
   3.671416946336981*^9, {3.6716553861103163`*^9, 3.671655395090454*^9}, {
   3.672000174407357*^9, 3.672000252570828*^9}, {3.6720577487456045`*^9, 
   3.6720577601732807`*^9}, {3.6721992727423687`*^9, 
   3.6721992897763424`*^9}, {3.6726338051713476`*^9, 3.672633841555118*^9}, {
   3.6728042174099483`*^9, 3.6728042322774773`*^9}, {3.6733611839717145`*^9, 
   3.673361208718671*^9}},ExpressionUUID->"737bb917-bcee-448c-8c61-\
0e630eff150f"],

Cell[TextData[{
 "See https://arxiv.org/abs/1410.5843 and http://arxiv.org/abs/1412.3135 for \
a discussion of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["S", "MHD"], TraditionalForm]],ExpressionUUID->
  "5bcddd49-1367-49b8-ac72-3e6d53d2dc78"],
 " as a special case of string fluids. The ",
 Cell[BoxData[
  FormBox[
   RowBox[{"-", 
    SubscriptBox["\[Rho]", "0"]}], TraditionalForm]],ExpressionUUID->
  "b3365926-e120-4052-9d47-ac239a5804e4"],
 " describes the plasma and the ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{"1", "/", "4"}], ")"}]}], 
    SuperscriptBox["F", "2"]}], TraditionalForm]],ExpressionUUID->
  "571689af-7c14-4d7a-84ae-9e382a2ad43b"],
 " portion is the Maxwell action. Note that, by allowing ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Rho]", "0"], TraditionalForm]],ExpressionUUID->
  "2205f59f-5a1e-4683-8f54-c9e678681944"],
 " to depend on spacetime solely through ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["n", "2"], TraditionalForm]],ExpressionUUID->
  "3e01f928-01c7-441b-a7aa-c4b1bce97ea4"],
 ", we are not taking into account the additional conserved charges that \
might be present; for a field theoretic discussion; see, for e.g., arXiv: \
1107.0731."
}], "Text",
 CellChangeTimes->{{3.6712939736745253`*^9, 3.671293991572858*^9}, {
   3.6712969404506416`*^9, 3.6712970253866053`*^9}, {3.6712997216015625`*^9, 
   3.6713002470684023`*^9}, {3.6713002953152914`*^9, 3.671300453483987*^9}, {
   3.671301168251836*^9, 3.6713013179499617`*^9}, {3.671301439298715*^9, 
   3.6713015211602836`*^9}, {3.6713021050902667`*^9, 
   3.6713021175900917`*^9}, {3.671302187410219*^9, 3.671302230187499*^9}, {
   3.6713022613933554`*^9, 3.6713022747623806`*^9}, {3.6713026394845953`*^9, 
   3.6713026552222257`*^9}, {3.6713163754068813`*^9, 
   3.6713163767344017`*^9}, {3.6713168451540966`*^9, 3.6713168531742196`*^9}, 
   3.6713254673688707`*^9, {3.6713261628766065`*^9, 3.671326165437511*^9}, 
   3.671416946336981*^9, {3.6716553861103163`*^9, 3.671655395090454*^9}, {
   3.672000174407357*^9, 3.672000252570828*^9}, {3.6720577487456045`*^9, 
   3.6720577601732807`*^9}, {3.6721992727423687`*^9, 
   3.6721992897763424`*^9}, {3.6726338051713476`*^9, 3.672633841555118*^9}, {
   3.673286561825926*^9, 3.6732866350221124`*^9}, {3.6733139956381245`*^9, 
   3.67331400411861*^9}},ExpressionUUID->"cda8c66d-f29b-4fb2-8ec7-\
df06179942fe"],

Cell[TextData[{
 StyleBox["iMHD Equations",
  FontWeight->"Bold"],
 ".\tIf we first define \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["P", "\[Alpha]\[Beta]"], "\[Congruent]", 
    RowBox[{
     SubscriptBox["\[Del]", "\[Sigma]"], 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[Sigma]", "g"], 
       RowBox[{
        RowBox[{
         SubscriptBox["\[Rho]", "0"], "'"}], "[", 
        RowBox[{
         SubscriptBox["\[Sigma]", "g"], 
         RowBox[{
          SuperscriptBox["n", "2"], "/", "2"}]}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["\[Del]", 
         RowBox[{"[", "\[Sigma]"}]], 
        SubscriptBox["\[CapitalPhi]", "1"]}], " ", 
       RowBox[{
        SuperscriptBox["\[Del]", "\[Alpha]"], 
        SubscriptBox["\[CapitalPhi]", "2"]}], " ", 
       RowBox[{
        SuperscriptBox["\[Del]", 
         RowBox[{"\[Beta]", "]"}]], 
        SubscriptBox["\[CapitalPhi]", "3"]}]}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"d112b565-42f8-4db3-918f-441d6de9c07f"],
 ",\nthe Maxwell\[CloseCurlyQuote]s equations part of MHD are\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[Del]", "\[Sigma]"], 
      SuperscriptBox["\[CapitalPhi]", "1"]}], 
     RowBox[{
      SubscriptBox["\[Del]", "\[Mu]"], 
      SuperscriptBox["F", "\[Mu]\[Sigma]"]}]}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Del]", "\[Alpha]"], 
      SuperscriptBox["\[CapitalPhi]", "1"]}], 
     RowBox[{
      SubscriptBox["\[Del]", "\[Beta]"], 
      SuperscriptBox["\[CapitalPhi]", "3"]}], 
     SuperscriptBox["P", "\[Alpha]\[Beta]"]}]}], TraditionalForm]],
  ExpressionUUID->"d12bc89e-9b4d-40bd-b2ef-6485ce5f4ddb"],
 "\t(Eq. 1)\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[Del]", "\[Sigma]"], 
      SuperscriptBox["\[CapitalPhi]", "2"]}], 
     RowBox[{
      SubscriptBox["\[Del]", "\[Mu]"], 
      SuperscriptBox["F", "\[Mu]\[Sigma]"]}]}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Del]", "\[Alpha]"], 
      SuperscriptBox["\[CapitalPhi]", "2"]}], 
     RowBox[{
      SubscriptBox["\[Del]", "\[Beta]"], 
      SuperscriptBox["\[CapitalPhi]", "3"]}], 
     SuperscriptBox["P", "\[Alpha]\[Beta]"]}]}], TraditionalForm]],
  ExpressionUUID->"c7ec35d4-e5a4-4567-a77c-eee0f0f84683"],
 "\t(Eq. 2)\nwhile the plasma portion of MHD reads\n\t0 = ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["F", "\[Alpha]\[Beta]"], 
    SuperscriptBox["P", "\[Alpha]\[Beta]"]}], TraditionalForm]],
  ExpressionUUID->"b3e22f0e-0452-4a52-b615-3530714f79ea"],
 "\t\t\t\t(Eq. 3)"
}], "Text",
 CellChangeTimes->{{3.6712939736745253`*^9, 3.671293991572858*^9}, {
   3.6712969404506416`*^9, 3.6712970253866053`*^9}, {3.6712997216015625`*^9, 
   3.6713002470684023`*^9}, {3.6713002953152914`*^9, 3.671300453483987*^9}, {
   3.671301168251836*^9, 3.6713013179499617`*^9}, {3.671301439298715*^9, 
   3.67130161042527*^9}, {3.671301642739733*^9, 3.67130189913665*^9}, {
   3.6713020725946083`*^9, 3.671302080791623*^9}, {3.671302294196416*^9, 
   3.671302299942226*^9}, {3.671302701437313*^9, 3.671302707921325*^9}, {
   3.671308035066533*^9, 3.671308035066533*^9}, {3.671311462510113*^9, 
   3.671311462510113*^9}, {3.6713168260038023`*^9, 3.671316842011548*^9}, 
   3.6713172420976934`*^9, {3.671916353600253*^9, 3.671916353600253*^9}, {
   3.672000264598516*^9, 3.672000264598516*^9}, {3.6720658484648476`*^9, 
   3.672065853317422*^9}, {3.672199241914605*^9, 3.672199252737224*^9}, 
   3.672633787858714*^9},ExpressionUUID->"7365e31d-053a-4341-847b-\
9d20c90a79a6"],

Cell[TextData[{
 "Note that, ",
 StyleBox["Force-Free-Electrodynamics",
  FontSlant->"Italic"],
 " (FFE) \n\t",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Del]", "\[Sigma]"], TraditionalForm]],ExpressionUUID->
  "40540c97-d284-4ce6-baf9-dfafda2aae49"],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"T", "[", "EM", "]"}], "\[Sigma]\[Alpha]"], TraditionalForm]],
  ExpressionUUID->"49495f34-0125-499a-adf7-110428497e99"],
 " = ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Sigma]", "g"], TraditionalForm]],ExpressionUUID->
  "0f425b4a-2f13-45c2-af9b-768c5490aa75"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Del]", "\[Mu]"], 
     SuperscriptBox["F", "\[Mu]\[Sigma]"]}], 
    SubscriptBox["F", "\[Sigma]\[Alpha]"]}], TraditionalForm]],ExpressionUUID->
  "f5df8c90-6771-4fab-b581-fec05ad0494f"],
 ",\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[Del]", 
       RowBox[{"[", "\[Alpha]"}]], 
      SubscriptBox["F", 
       RowBox[{"\[Beta]\[Gamma]", "]"}]]}], "=", "0"}], ","}], 
   TraditionalForm]],ExpressionUUID->"524c1cae-c551-40ae-94a2-89ad1bc354d7"],
 "\n(i.e., where the electromagnetic current becomes orthogonal to the \
Maxwell tensor) is the limit where Eq. 3 is neglected and the \
right-hand-sides of Eq. 1 and Eq. 2 are set to zero."
}], "Text",
 CellChangeTimes->{{3.6712939736745253`*^9, 3.671293991572858*^9}, {
   3.6712969404506416`*^9, 3.6712970253866053`*^9}, {3.6712997216015625`*^9, 
   3.6713002470684023`*^9}, {3.6713002953152914`*^9, 3.671300453483987*^9}, {
   3.671301168251836*^9, 3.6713013179499617`*^9}, {3.671301439298715*^9, 
   3.6713015211602836`*^9}, {3.6713021050902667`*^9, 
   3.6713021175900917`*^9}, {3.671302187410219*^9, 3.671302230187499*^9}, {
   3.6713022613933554`*^9, 3.6713022747623806`*^9}, {3.6713026394845953`*^9, 
   3.6713026552222257`*^9}, {3.6713163754068813`*^9, 
   3.6713163767344017`*^9}, {3.6713168451540966`*^9, 
   3.6713168531742196`*^9}, {3.6713254673688707`*^9, 3.671325587440387*^9}, {
   3.671325641949685*^9, 3.671325673935543*^9}, {3.6713262351501374`*^9, 
   3.671326276096711*^9}, {3.6720578277743187`*^9, 3.672057856699763*^9}, {
   3.672065866985132*^9, 3.6720659248185205`*^9}, {3.6726338705178776`*^9, 
   3.6726338737439833`*^9}, {3.6726339216357756`*^9, 
   3.6726339453866234`*^9}, {3.6727105453318057`*^9, 3.672710565891543*^9}, 
   3.673661973765536*^9},ExpressionUUID->"2910b6b4-dd90-4a69-8a52-\
32d0f911eefa"],

Cell[TextData[{
 StyleBox["Credit",
  FontWeight->"Bold"],
 "\t\tIf you use MHDSystem for scientific research, please cite the URL \
http://www.stargazing.net/yizen/MHD.html; and the paper at \
http://arxiv.org/abs/1605.08786, during the course of which MHDSystem was \
developed."
}], "Text",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQvW3qVqaCqNeOt0I+sYDoFdl9pYVAWihepwFEMzgY
XywC0lEGj4SKgfQ9sVcSIPpSzXodEM3Fz9EGosXS9s0A0cL9L5eDaG5F1U0g
uvyx0m8QzfFo0x8Q3aKQy1oCpP/9P8oFouOmreED0TmpEQIg+lzje1sQXSnz
3B5E67C+/VQFpC0axD+D6Jh3S3SrgbTp5KV6IPrU2ezkeiC9TDyvCERfSrar
BNE/3tvWgui3Z1MOg2gnieYTINrieMWfJ9GvHUtTxBieAmmTtviXL4B0kOGs
DyC6ZNIFx38xrx23nTN3AtFuESYeINoiXscbRKvP09qkHPvasbV9zxYQ7Vq/
w+lL3GvHvVLfvEE0ANAtp6Y=
  "],ExpressionUUID->"0b80b6e4-d06c-4784-8abe-4917f26d885e"]
}, Closed]],

Cell[CellGroupData[{

Cell["MHDSystem", "Subsubsection",
 CellChangeTimes->{{3.6712917467837687`*^9, 
  3.671291759353691*^9}},ExpressionUUID->"865bec23-b795-4f79-abb2-\
692dba52b506"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MHDSystem", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ph1_", ",", "ph2_", ",", "ph3_"}], "}"}], ",", "rho_Function",
       ",", "gBH_Tensor", ",", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], "/;", 
    RowBox[{"TestMetricTensor", "[", "gBH", "]"}]}], ":=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "MHDRules", ",", "\[Rho]0", ",", "nT", ",", "q123", ",", "n", ",", 
        "\[Alpha]1", ",", "\[Alpha]2", ",", "\[Alpha]3", ",", "\[Zeta]", ",", 
        "F\[Mu]\[Nu]", ",", "F\[Mu]\[Nu]T", ",", "LHS1", ",", "LHS2", ",", 
        "RHS1", ",", "RHS2", ",", "RHS3", ",", "\[CapitalPhi]1", ",", 
        "\[CapitalPhi]2", ",", "\[CapitalPhi]3", ",", "x0", ",", "x1", ",", 
        "x2", ",", "x3", ",", "si", ",", "\[Sigma]", ",", "\[Rho]", ",", 
        "\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]", ",", "X", ",", "Y", ",", 
        "Z", ",", "\[Mu]", ",", "\[Nu]", ",", "\[Beta]1", ",", "\[Gamma]1", 
        ",", "q123T", ",", "q1", ",", "q2", ",", "q3", ",", "q1T", ",", "q2T",
         ",", "q3T", ",", "\[Rho]0q123T", ",", "\[Rho]0q123", ",", "P", ",", 
        "PT", ",", "divF", ",", "divFT", ",", "F2", ",", "MaxwellT", ",", 
        "PlasmaT", ",", "coords", ",", "Opr", ",", "gsgn", ",", "TotalT"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "metric", " ", "signature", " ", "converted", " ", "to", " ", "sign", 
        " ", "of", " ", "eta_", "00"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"gsgn", "=", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OptionValue", "[", "MetricSignature", "]"}], "===", 
            "\"\<MostlyMinus\>\""}], ")"}], ",", "1", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OptionValue", "[", "MetricSignature", "]"}], "===", 
            "\"\<MostlyPlus\>\""}], ")"}], ",", 
          RowBox[{"-", "1"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"gradients", " ", "of", " ", "X", " ", "Y", " ", "Z"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"coords", "=", 
        RowBox[{"Coordinates", "[", 
         RowBox[{"UniqueIndices", "[", "gBH", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Replacement", " ", "rules"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"MHDRules", "=", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[CapitalPhi]1", "\[Rule]", 
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"Evaluate", "[", "coords", "]"}], ",", "ph1"}], "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"\[CapitalPhi]2", "\[Rule]", 
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"Evaluate", "[", "coords", "]"}], ",", "ph2"}], "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"\[CapitalPhi]3", "\[Rule]", 
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"Evaluate", "[", "coords", "]"}], ",", "ph3"}], "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"\[Rho]0", "\[Rule]", "rho"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Opr", " ", "acts", " ", "on", " ", "output"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Opr", "=", 
        RowBox[{"OptionValue", "[", "MHDOperator", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"si", "=", 
        RowBox[{"StartIndex", "[", "gBH", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"q1T", "[", "\[Sigma]_", "]"}], "=", 
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TensorType", "\[Rule]", "\"\<Gradient\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TensorName", " ", "\[Rule]", 
           RowBox[{
           "Del", "[", 
            "\"\<\!\(\*SubscriptBox[\(\[CapitalPhi]\), \(1\)]\)\>\"", "]"}]}],
           ",", "\[IndentingNewLine]", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"{", 
            SubscriptBox["\[Sigma]", "-"], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"\[CapitalPhi]1", "[", 
                   RowBox[{"Sequence", "@@", "coords"}], "]"}], ",", "#"}], 
                 "]"}], "&"}], "/@", "coords"}], ")"}], "/.", "MHDRules"}], 
            ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Coordinates", "\[Rule]", "coords"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"q1", "[", "\[Rho]_", "]"}], ":=", 
        RowBox[{"MoveIndices", "[", 
         RowBox[{
          RowBox[{"q1T", "[", "\[Alpha]", "]"}], ",", 
          RowBox[{"{", "\[Rho]", "}"}], ",", 
          RowBox[{"UniqueIndices", "[", "gBH", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"q2T", "[", "\[Sigma]_", "]"}], "=", 
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TensorType", "\[Rule]", "\"\<Gradient\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TensorName", " ", "\[Rule]", 
           RowBox[{
           "Del", "[", 
            "\"\<\!\(\*SubscriptBox[\(\[CapitalPhi]\), \(2\)]\)\>\"", "]"}]}],
           ",", "\[IndentingNewLine]", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"{", 
            SubscriptBox["\[Sigma]", "-"], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"\[CapitalPhi]2", "[", 
                   RowBox[{"Sequence", "@@", "coords"}], "]"}], ",", "#"}], 
                 "]"}], "&"}], "/@", "coords"}], ")"}], "/.", "MHDRules"}], 
            ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Coordinates", "\[Rule]", "coords"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"q2", "[", "\[Rho]_", "]"}], ":=", 
        RowBox[{"MoveIndices", "[", 
         RowBox[{
          RowBox[{"q2T", "[", "\[Sigma]", "]"}], ",", 
          RowBox[{"{", "\[Rho]", "}"}], ",", 
          RowBox[{"UniqueIndices", "[", "gBH", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"q3T", "[", "\[Sigma]_", "]"}], "=", 
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TensorType", "\[Rule]", "\"\<Gradient\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TensorName", " ", "\[Rule]", 
           RowBox[{
           "Del", "[", 
            "\"\<\!\(\*SubscriptBox[\(\[CapitalPhi]\), \(3\)]\)\>\"", "]"}]}],
           ",", "\[IndentingNewLine]", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"{", 
            SubscriptBox["\[Sigma]", "-"], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"\[CapitalPhi]3", "[", 
                   RowBox[{"Sequence", "@@", "coords"}], "]"}], ",", "#"}], 
                 "]"}], "&"}], "/@", "coords"}], ")"}], "/.", "MHDRules"}], 
            ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Coordinates", "\[Rule]", "coords"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"q3", "[", "\[Rho]_", "]"}], ":=", 
        RowBox[{"MoveIndices", "[", 
         RowBox[{
          RowBox[{"q3T", "[", "\[Sigma]", "]"}], ",", 
          RowBox[{"{", "\[Rho]", "}"}], ",", 
          RowBox[{"UniqueIndices", "[", "gBH", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Maxwell", " ", "tensor", " ", "and", " ", "its", " ", "divergence"}],
         " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"F\[Mu]\[Nu]T", "[", 
         RowBox[{"\[Sigma]_", ",", "\[Rho]_"}], "]"}], "=", 
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TensorType", "\[Rule]", "\"\<Maxwell\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
          "TensorName", " ", "\[Rule]", 
           "\"\<\!\(\*StyleBox[\"F\",FontSlant->\"Italic\"]\)\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["\[Sigma]", "-"], ",", 
             SubscriptBox["\[Rho]", "-"]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", 
           RowBox[{"Normal", "[", 
            RowBox[{"TensorWedge", "[", 
             RowBox[{
              RowBox[{"TensorComponents", "[", 
               RowBox[{"q1", "[", 
                SubscriptBox["\[Alpha]", "-"], "]"}], "]"}], ",", 
              RowBox[{"TensorComponents", "[", 
               RowBox[{"q2", "[", 
                SubscriptBox["\[Beta]", "-"], "]"}], "]"}]}], "]"}], "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Coordinates", "\[Rule]", "coords"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"F\[Mu]\[Nu]", "[", 
         RowBox[{"\[Alpha]_", ",", "\[Beta]_"}], "]"}], ":=", 
        RowBox[{"MoveIndices", "[", 
         RowBox[{
          RowBox[{"F\[Mu]\[Nu]T", "[", 
           RowBox[{"\[Sigma]", ",", "\[Rho]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]", ",", "\[Beta]"}], "}"}], ",", 
          RowBox[{"UniqueIndices", "[", "gBH", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"maxwell", " ", "stress", " ", "tensor"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"F2", "=", 
        RowBox[{"TensorContract", "[", 
         RowBox[{
          RowBox[{"TensorProduct", "[", 
           RowBox[{
            RowBox[{"TensorComponents", "[", 
             RowBox[{"F\[Mu]\[Nu]", "[", 
              RowBox[{
               SubscriptBox["\[Alpha]", "-"], ",", 
               SubscriptBox["\[Beta]", "-"]}], "]"}], "]"}], ",", 
            RowBox[{"TensorComponents", "[", 
             RowBox[{"F\[Mu]\[Nu]", "[", 
              RowBox[{
               SuperscriptBox["\[Alpha]", "-"], ",", 
               SuperscriptBox["\[Beta]", "-"]}], "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "3"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "4"}], "}"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"F2", "=", 
        RowBox[{"Opr", "[", 
         RowBox[{"gsgn", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"TensorContract", "[", 
              RowBox[{
               RowBox[{"TensorProduct", "[", 
                RowBox[{
                 RowBox[{"TensorComponents", "[", 
                  RowBox[{"F\[Mu]\[Nu]", "[", 
                   RowBox[{
                    SubscriptBox["\[Alpha]", "-"], ",", 
                    SubscriptBox["\[Beta]", "-"]}], "]"}], "]"}], ",", 
                 RowBox[{"TensorComponents", "[", 
                  RowBox[{"F\[Mu]\[Nu]", "[", 
                   RowBox[{
                    SubscriptBox["\[Alpha]", "-"], ",", 
                    SuperscriptBox["\[Beta]", "-"]}], "]"}], "]"}]}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "4"}], "}"}], "}"}]}], "]"}]}], "+", 
            RowBox[{
             FractionBox["1", "4"], 
             RowBox[{"TensorComponents", "[", 
              RowBox[{"Metric", "[", 
               RowBox[{
                SubscriptBox["\[Alpha]", "-"], ",", 
                SubscriptBox["\[Beta]", "-"], ",", "gBH"}], "]"}], "]"}], 
             "F2"}]}], ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MaxwellT", "[", 
         RowBox[{"\[Sigma]_", ",", "\[Rho]_"}], "]"}], "=", 
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TensorType", "\[Rule]", "\"\<MHDMaxwell\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
          "TensorName", " ", "\[Rule]", 
           "\"\<\!\(\*StyleBox[\"T\",FontSlant->\"Italic\"]\)[EM]\>\""}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["\[Sigma]", "-"], ",", 
             SubscriptBox["\[Rho]", "-"]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", "F2"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Coordinates", "\[Rule]", "coords"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "dX", " ", "\[Wedge]", " ", "dY", " ", "\[Wedge]", " ", "dZ"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"q123T", "[", 
         RowBox[{"\[Alpha]1_", ",", "\[Alpha]2_", ",", "\[Alpha]3_"}], "]"}], 
        "=", 
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TensorType", "\[Rule]", "\"\<3-Form\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TensorName", " ", "\[Rule]", 
           RowBox[{
           "OverTilde", "[", 
            "\"\<\!\(\*StyleBox[\"n\",FontSlant->\"Italic\"]\)\>\"", "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["\[Alpha]1", "-"], ",", 
             SubscriptBox["\[Alpha]2", "-"], ",", 
             SubscriptBox["\[Alpha]3", "-"]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", 
           RowBox[{"Normal", "[", 
            RowBox[{"TensorWedge", "[", 
             RowBox[{
              RowBox[{"TensorComponents", "[", 
               RowBox[{"q1", "[", 
                SubscriptBox["\[Beta]", "-"], "]"}], "]"}], ",", 
              RowBox[{"TensorComponents", "[", 
               RowBox[{"q2", "[", 
                SubscriptBox["\[Beta]", "-"], "]"}], "]"}], ",", 
              RowBox[{"TensorComponents", "[", 
               RowBox[{"q3", "[", 
                SubscriptBox["\[Beta]", "-"], "]"}], "]"}]}], "]"}], "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Coordinates", "\[Rule]", "coords"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"q123", "[", 
         RowBox[{"\[Alpha]_", ",", "\[Beta]_", ",", "\[Gamma]_"}], "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Mu]1", ",", "\[Mu]2", ",", "\[Mu]3"}], "}"}], ",", 
          RowBox[{"MoveIndices", "[", 
           RowBox[{
            RowBox[{"q123T", "[", 
             RowBox[{"\[Mu]1", ",", "\[Mu]2", ",", "\[Mu]3"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]"}], "}"}], 
            ",", 
            RowBox[{"UniqueIndices", "[", "gBH", "]"}]}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Plasma", " ", "current"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nT", "[", "\[Mu]_", "]"}], "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"CovariantHodgeDual", "[", 
             RowBox[{
              SuperscriptBox["\[Mu]", "-"], ",", 
              RowBox[{"q123", "[", 
               RowBox[{
                SubscriptBox["\[Alpha]", "-"], ",", 
                SubscriptBox["\[Beta]", "-"], ",", 
                SubscriptBox["\[Gamma]", "-"]}], "]"}], ",", 
              RowBox[{"UniqueIndices", "[", "gBH", "]"}]}], "]"}], "//", 
            "Opr"}], ")"}], "/.", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"TensorName", "\[Rule]", "name_"}], ")"}], "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
            "TensorName", "\[Rule]", 
             "\"\<\!\(\*StyleBox[\"n\",FontSlant->\"Italic\"]\)\>\""}], 
            ")"}]}]}], ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"n", "[", "\[Mu]_", "]"}], ":=", 
        RowBox[{"MoveIndices", "[", 
         RowBox[{
          RowBox[{"nT", "[", "\[Sigma]", "]"}], ",", 
          RowBox[{"{", "\[Mu]", "}"}], ",", 
          RowBox[{"UniqueIndices", "[", "gBH", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Construct", " ", 
         SuperscriptBox["P", "\[Beta]\[Gamma]"], " ", "in", " ", "the", " ", 
         "notes"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Rho]0q123T", "[", 
         RowBox[{"\[Alpha]_", ",", "\[Beta]_", ",", "\[Gamma]_"}], "]"}], "=", 
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TensorType", "\[Rule]", "\"\<3-Form\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
          "TensorName", " ", "\[Rule]", 
           "\"\<\!\(\*StyleBox[\"P\",FontSlant->\"Italic\"]\)\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             SuperscriptBox["\[Alpha]", "-"], ",", 
             SuperscriptBox["\[Beta]", "-"], ",", 
             SuperscriptBox["\[Gamma]", "-"]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", 
           RowBox[{
            RowBox[{"Opr", "[", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"gsgn", " ", 
                 RowBox[{
                  RowBox[{"\[Rho]0", "'"}], "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "/", "2"}], ")"}], "gsgn", " ", 
                   RowBox[{
                    RowBox[{"TensorComponents", "[", 
                    RowBox[{"n", "[", 
                    SubscriptBox["\[Sigma]", "-"], "]"}], "]"}], ".", 
                    RowBox[{"TensorComponents", "[", 
                    RowBox[{"n", "[", 
                    SuperscriptBox["\[Sigma]", "-"], "]"}], "]"}]}]}], 
                  "]"}]}], ")"}], "/.", "MHDRules"}], ")"}], "]"}], 
            RowBox[{"TensorComponents", "[", 
             RowBox[{"q123", "[", 
              RowBox[{
               SuperscriptBox["\[Alpha]1", "-"], ",", 
               SuperscriptBox["\[Beta]1", "-"], ",", 
               SuperscriptBox["\[Gamma]1", "-"]}], "]"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Coordinates", "\[Rule]", "coords"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Rho]0q123", "[", 
         RowBox[{"\[Alpha]_", ",", "\[Beta]_", ",", "\[Gamma]_"}], "]"}], ":=", 
        RowBox[{"MoveIndices", "[", 
         RowBox[{
          RowBox[{"\[Rho]0q123T", "[", 
           RowBox[{"\[Alpha]1", ",", "\[Alpha]2", ",", "\[Alpha]3"}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]"}], "}"}], ",", 
          RowBox[{"UniqueIndices", "[", "gBH", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PT", "[", 
         RowBox[{"\[Beta]_", ",", "\[Gamma]_"}], "]"}], "=", 
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TensorType", "\[Rule]", "\"\<2-Form\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
          "TensorName", " ", "\[Rule]", 
           "\"\<\!\(\*StyleBox[\"P\",FontSlant->\"Italic\"]\)\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             SuperscriptBox["\[Beta]", "-"], ",", 
             SuperscriptBox["\[Gamma]", "-"]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", 
           RowBox[{"TensorComponents", "[", 
            RowBox[{"CovariantD", "[", 
             RowBox[{
              SubscriptBox["\[Sigma]", "-"], ",", 
              RowBox[{"\[Rho]0q123", "[", 
               RowBox[{
                SuperscriptBox["\[Sigma]", "-"], ",", 
                SuperscriptBox["\[Beta]1", "-"], ",", 
                SuperscriptBox["\[Gamma]1", "-"]}], "]"}], ",", 
              RowBox[{"UniqueIndices", "[", "gBH", "]"}]}], "]"}], "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Coordinates", "\[Rule]", "coords"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{"\[Beta]_", ",", "\[Gamma]_"}], "]"}], ":=", 
        RowBox[{"MoveIndices", "[", 
         RowBox[{
          RowBox[{"Opr", "[", 
           RowBox[{"PT", "[", 
            RowBox[{"\[Alpha]1", ",", "\[Alpha]2"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Beta]", ",", "\[Gamma]"}], "}"}], ",", 
          RowBox[{"UniqueIndices", "[", "gBH", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "perfect", " ", "fluid", " ", "stress", " ", "tensor", " ", "of", " ",
          "plasma"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"F2", "=", 
        RowBox[{"Opr", "[", 
         RowBox[{
          RowBox[{"TensorComponents", "[", 
           RowBox[{"n", "[", 
            SubscriptBox["\[Sigma]", "-"], "]"}], "]"}], ".", 
          RowBox[{"TensorComponents", "[", 
           RowBox[{"n", "[", 
            SuperscriptBox["\[Sigma]", "-"], "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"F2", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gsgn", " ", 
            RowBox[{"TensorComponents", "[", 
             RowBox[{"Metric", "[", 
              RowBox[{
               SuperscriptBox["\[Alpha]", "-"], ",", 
               SuperscriptBox["\[Beta]", "-"], ",", 
               RowBox[{"UniqueIndices", "[", "gBH", "]"}]}], "]"}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Rho]0", "[", 
               RowBox[{"gsgn", " ", 
                RowBox[{"F2", "/", "2"}]}], "]"}], "-", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Rho]0", "'"}], "[", 
                RowBox[{"gsgn", " ", 
                 RowBox[{"F2", "/", "2"}]}], "]"}], "gsgn", " ", "F2"}]}], 
             ")"}]}], "+", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Rho]0", "'"}], "[", 
             RowBox[{"gsgn", " ", 
              RowBox[{"F2", "/", "2"}]}], "]"}], 
            RowBox[{"TensorProduct", "[", 
             RowBox[{
              RowBox[{"TensorComponents", "[", 
               RowBox[{"n", "[", 
                SuperscriptBox["\[Mu]", "-"], "]"}], "]"}], ",", 
              RowBox[{"TensorComponents", "[", 
               RowBox[{"n", "[", 
                SuperscriptBox["\[Nu]", "-"], "]"}], "]"}]}], "]"}]}]}], 
          ")"}], "/.", "MHDRules"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PlasmaT", "[", 
         RowBox[{"\[Sigma]_", ",", "\[Rho]_"}], "]"}], "=", 
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TensorType", "\[Rule]", "\"\<MHDPlasma\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
          "TensorName", " ", "\[Rule]", 
           "\"\<\!\(\*StyleBox[\"T\",FontSlant->\"Italic\"]\)[Plasma]\>\""}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             SuperscriptBox["\[Sigma]", "-"], ",", 
             SuperscriptBox["\[Rho]", "-"]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", 
           RowBox[{"Opr", "[", "F2", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Coordinates", "\[Rule]", "coords"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"total", " ", "stress", " ", "tensor"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"TotalT", "[", 
         RowBox[{"\[Sigma]_", ",", "\[Rho]_"}], "]"}], "=", 
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TensorType", "\[Rule]", "\"\<MHDMaxwellPlasma\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
          "TensorName", " ", "\[Rule]", 
           "\"\<\!\(\*StyleBox[\"T\",FontSlant->\"Italic\"]\)[Total]\>\""}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             SuperscriptBox["\[Sigma]", "-"], ",", 
             SuperscriptBox["\[Rho]", "-"]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "remember", " ", "we", " ", "defined", " ", "photon", " ", 
            "T\[Mu]\[Nu]", " ", "with", " ", "both", " ", "lower", " ", 
            "indices", " ", "and", " ", "plasma", " ", "with", " ", "both", 
            " ", "upper"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", 
           RowBox[{
            RowBox[{"TensorComponents", "[", 
             RowBox[{"RaiseAllIndices", "[", 
              RowBox[{
               RowBox[{"MaxwellT", "[", 
                RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}], ",", 
               RowBox[{"UniqueIndices", "[", "gBH", "]"}]}], "]"}], "]"}], 
            "+", 
            RowBox[{"TensorComponents", "[", 
             RowBox[{"PlasmaT", "[", 
              RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Coordinates", "\[Rule]", "coords"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"EM", " ", "current"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"divFT", "[", "\[Mu]_", "]"}], "=", 
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TensorType", "\[Rule]", "\"\<MaxwellCurrent\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
          "TensorName", " ", "\[Rule]", 
           "\"\<\!\(\*StyleBox[\"J\",FontSlant->\"Italic\"]\)\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"{", 
            SubscriptBox["\[Mu]", "-"], "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"TensorComponents", "[", 
              RowBox[{"CovariantD", "[", 
               RowBox[{
                SuperscriptBox["\[Sigma]", "-"], ",", 
                RowBox[{"F\[Mu]\[Nu]", "[", 
                 RowBox[{
                  SubscriptBox["\[Sigma]", "-"], ",", 
                  SubscriptBox["\[Rho]", "-"]}], "]"}], ",", 
                RowBox[{"UniqueIndices", "[", "gBH", "]"}]}], "]"}], "]"}], "//",
              "Opr"}], ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Coordinates", "\[Rule]", "coords"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"divF", "[", "\[Rho]_", "]"}], ":=", 
        RowBox[{"MoveIndices", "[", 
         RowBox[{
          RowBox[{"divFT", "[", "\[Alpha]", "]"}], ",", 
          RowBox[{"{", "\[Rho]", "}"}], ",", 
          RowBox[{"UniqueIndices", "[", "gBH", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"EOM", " ", 
          RowBox[{"I", " ", ":", " ", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[Del]", "\[Sigma]"], "\[Zeta]"}], " ", 
            RowBox[{
             SubscriptBox["\[Del]", "\[Mu]"], 
             SuperscriptBox["F", "\[Mu]\[Sigma]"]}]}]}]}], " ", "=", " ", 
         RowBox[{
          SubscriptBox["q1", "\[Alpha]"], " ", 
          SubscriptBox["q3", "\[Beta]"], " ", 
          SuperscriptBox["P", "\[Alpha]\[Beta]"]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"LHS1", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"TensorComponents", "[", 
             RowBox[{"q1", "[", 
              SubscriptBox["\[Sigma]", "-"], "]"}], "]"}], ".", 
            RowBox[{"TensorComponents", "[", 
             RowBox[{"divF", "[", 
              SuperscriptBox["\[Rho]", "-"], "]"}], "]"}]}], ")"}], "//", 
          "Opr"}], ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"RHS1", "=", 
        RowBox[{"Opr", "[", 
         RowBox[{"TensorContract", "[", 
          RowBox[{
           RowBox[{"TensorProduct", "[", 
            RowBox[{
             RowBox[{"TensorComponents", "[", 
              RowBox[{"q1", "[", 
               SubscriptBox["\[Sigma]", "-"], "]"}], "]"}], ",", 
             RowBox[{"TensorComponents", "[", 
              RowBox[{"q3", "[", 
               SubscriptBox["\[Sigma]", "-"], "]"}], "]"}], ",", 
             RowBox[{"TensorComponents", "[", 
              RowBox[{"P", "[", 
               RowBox[{
                SuperscriptBox["\[Sigma]", "-"], ",", 
                SuperscriptBox["\[Rho]", "-"]}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "3"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "4"}], "}"}]}], "}"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"EOM", " ", 
          RowBox[{"II", " ", ":", " ", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[Del]", "\[Sigma]"], "Y"}], " ", 
            RowBox[{
             SubscriptBox["\[Del]", "\[Mu]"], 
             SuperscriptBox["F", "\[Mu]\[Sigma]"]}]}]}]}], " ", "=", " ", 
         RowBox[{
          SubscriptBox["q2", "\[Alpha]"], " ", 
          SubscriptBox["q3", "\[Beta]"], " ", 
          SuperscriptBox["P", "\[Alpha]\[Beta]"]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"LHS2", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TensorComponents", "[", 
            RowBox[{"q2", "[", 
             SubscriptBox["\[Sigma]", "-"], "]"}], "]"}], ".", 
           RowBox[{"TensorComponents", "[", 
            RowBox[{"divF", "[", 
             SuperscriptBox["\[Rho]", "-"], "]"}], "]"}]}], ")"}], "//", 
         "Opr"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"RHS2", "=", 
        RowBox[{"Opr", "[", 
         RowBox[{"TensorContract", "[", 
          RowBox[{
           RowBox[{"TensorProduct", "[", 
            RowBox[{
             RowBox[{"TensorComponents", "[", 
              RowBox[{"q2", "[", 
               SubscriptBox["\[Sigma]", "-"], "]"}], "]"}], ",", 
             RowBox[{"TensorComponents", "[", 
              RowBox[{"q3", "[", 
               SubscriptBox["\[Sigma]", "-"], "]"}], "]"}], ",", 
             RowBox[{"TensorComponents", "[", 
              RowBox[{"P", "[", 
               RowBox[{
                SuperscriptBox["\[Sigma]", "-"], ",", 
                SuperscriptBox["\[Rho]", "-"]}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "3"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "4"}], "}"}]}], "}"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"EOM", " ", 
          RowBox[{"III", " ", ":", " ", "0"}]}], " ", "=", " ", 
         RowBox[{
          SubscriptBox["q2", "\[Alpha]"], " ", 
          SubscriptBox["q3", "\[Beta]"], " ", 
          SuperscriptBox["P", "\[Alpha]\[Beta]"]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"RHS3", "=", 
        RowBox[{"Opr", "[", 
         RowBox[{"TensorContract", "[", 
          RowBox[{
           RowBox[{"TensorProduct", "[", 
            RowBox[{
             RowBox[{"TensorComponents", "[", 
              RowBox[{"F\[Mu]\[Nu]", "[", 
               RowBox[{
                SubscriptBox["\[Sigma]", "-"], ",", 
                SubscriptBox["\[Rho]", "-"]}], "]"}], "]"}], ",", 
             RowBox[{"TensorComponents", "[", 
              RowBox[{"P", "[", 
               RowBox[{
                SuperscriptBox["\[Sigma]", "-"], ",", 
                SuperscriptBox["\[Rho]", "-"]}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "3"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "4"}], "}"}]}], "}"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "output", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"MHDSystem", "[", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"3", " ", "scalars"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"MHDScalarFunction1", "\[Rule]", "ph1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MHDScalarFunction2", "\[Rule]", "ph2"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MHDScalarFunction3", "\[Rule]", "ph3"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MHD1FormTensor1", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"q1T", "[", 
            RowBox[{"Unique", "[", "\[Sigma]", "]"}], "]"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MHD1FormTensor2", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"q2T", "[", 
            RowBox[{"Unique", "[", "\[Sigma]", "]"}], "]"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MHD1FormTensor3", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"q3T", "[", 
            RowBox[{"Unique", "[", "\[Sigma]", "]"}], "]"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MHD3FormTensor", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"q123T", "[", 
            RowBox[{
             RowBox[{"Unique", "[", "\[Alpha]1", "]"}], ",", 
             RowBox[{"Unique", "[", "\[Alpha]2", "]"}], ",", 
             RowBox[{"Unique", "[", "\[Alpha]3", "]"}]}], "]"}], ")"}]}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"MHDMaxwellTensor", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"F\[Mu]\[Nu]T", "[", 
            RowBox[{
             RowBox[{"Unique", "[", "\[Sigma]", "]"}], ",", 
             RowBox[{"Unique", "[", "\[Rho]", "]"}]}], "]"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MHDPlasmaCurrentTensor", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"nT", "[", 
            RowBox[{"Unique", "[", "\[Mu]", "]"}], "]"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MHDRank2PTensor", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"PT", "[", 
            RowBox[{
             RowBox[{"Unique", "[", "\[Beta]", "]"}], ",", 
             RowBox[{"Unique", "[", "\[Gamma]", "]"}]}], "]"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MHDMaxwellCurrentTensor", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"divFT", "[", 
            RowBox[{"Unique", "[", "\[Rho]", "]"}], "]"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MHDEquationsList", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"eq", " ", "1"}], ":", " ", 
              RowBox[{"{", 
               RowBox[{"LHS", ",", "RHS"}], "}"}]}], " ", "*)"}], 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"LHS1", ",", "RHS1"}], "}"}], ",", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"eq", " ", "2"}], ":", " ", 
               RowBox[{"{", 
                RowBox[{"LHS", ",", "RHS"}], "}"}]}], " ", "*)"}], 
             RowBox[{"{", 
              RowBox[{"LHS2", ",", "RHS2"}], "}"}], ",", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"eq", " ", "3"}], ":", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"LHS", "=", "0"}], ",", "RHS"}], "}"}]}], " ", 
              "*)"}], 
             RowBox[{"{", 
              RowBox[{"0", ",", "RHS3"}], "}"}]}], "}"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"stress", " ", "tensors"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"MHDMaxwellStressTensor", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"MaxwellT", "[", 
            RowBox[{
             RowBox[{"Unique", "[", "\[Sigma]", "]"}], ",", 
             RowBox[{"Unique", "[", "\[Rho]", "]"}]}], "]"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MHDPlasmaStressTensor", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"PlasmaT", "[", 
            RowBox[{
             RowBox[{"Unique", "[", "\[Sigma]", "]"}], ",", 
             RowBox[{"Unique", "[", "\[Rho]", "]"}]}], "]"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MHDTotalStressTensor", "\[Rule]", 
          RowBox[{"TotalT", "[", 
           RowBox[{
            RowBox[{"Unique", "[", "\[Sigma]", "]"}], ",", 
            RowBox[{"Unique", "[", "\[Rho]", "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MHDPlasmaEnergyDensityOperator", "\[Rule]", "rho"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"MHD", " ", "Lagrangian"}], " ", "-", "\[Rho]0", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "4"}], ")"}], 
            RowBox[{"F", "^", "2"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"MHDLagrangianDensity", "\[Rule]", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Rho]0", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "/", "2"}], ")"}], "gsgn", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"TensorComponents", "[", 
                    RowBox[{"n", "[", 
                    SubscriptBox["\[Sigma]", "-"], "]"}], "]"}], ".", 
                   RowBox[{"TensorComponents", "[", 
                    RowBox[{"n", "[", 
                    SuperscriptBox["\[Sigma]", "-"], "]"}], "]"}]}], ")"}]}], 
                "//", "Opr"}], "]"}], "/.", "MHDRules"}], ")"}]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "4"}], ")"}], 
            RowBox[{"TensorContract", "[", 
             RowBox[{
              RowBox[{"TensorProduct", "[", 
               RowBox[{
                RowBox[{"TensorComponents", "[", 
                 RowBox[{"F\[Mu]\[Nu]", "[", 
                  RowBox[{
                   SubscriptBox[
                    RowBox[{"Unique", "[", "\[Sigma]", "]"}], "-"], ",", 
                   SubscriptBox[
                    RowBox[{"Unique", "[", "\[Rho]", "]"}], "-"]}], "]"}], 
                 "]"}], ",", 
                RowBox[{"TensorComponents", "[", 
                 RowBox[{"F\[Mu]\[Nu]", "[", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"Unique", "[", "\[Sigma]", "]"}], "-"], ",", 
                   SuperscriptBox[
                    RowBox[{"Unique", "[", "\[Rho]", "]"}], "-"]}], "]"}], 
                 "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "3"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "4"}], "}"}]}], "}"}]}], "]"}]}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"store", " ", "metric", " ", "info", " ", "too"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"MHDMetricTensor", "\[Rule]", 
          RowBox[{"UniqueIndices", "[", "gBH", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Coordinates", "\[Rule]", 
          RowBox[{"Coordinates", "[", 
           RowBox[{"UniqueIndices", "[", "gBH", "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MetricSignature", "\[Rule]", 
          RowBox[{"OptionValue", "[", "MetricSignature", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"OptionValue", "[", "MetricSignature", "]"}], "===", 
        "\"\<MostlyMinus\>\""}], ")"}], "||", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"OptionValue", "[", "MetricSignature", "]"}], "===", 
        "\"\<MostlyPlus\>\""}], ")"}]}], ")"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6698407509849577`*^9, 3.6698408131231823`*^9}, {
   3.669840872347288*^9, 3.6698409488818502`*^9}, {3.669840991774727*^9, 
   3.669841033699402*^9}, {3.6698419414843903`*^9, 3.6698419624920273`*^9}, {
   3.669844135719773*^9, 3.669844146429385*^9}, {3.6698441850648756`*^9, 
   3.669844242456984*^9}, {3.6698442807508526`*^9, 3.669844349794979*^9}, {
   3.669844444602553*^9, 3.6698445620849667`*^9}, {3.6698446255136824`*^9, 
   3.6698446259816837`*^9}, {3.6698446774140253`*^9, 
   3.6698446785060277`*^9}, {3.6698448410975957`*^9, 
   3.6698448884506965`*^9}, {3.6698449486940107`*^9, 3.669844980673071*^9}, {
   3.6698450434029026`*^9, 3.6698450679501467`*^9}, 3.6698497394799695`*^9, {
   3.6698497866486673`*^9, 3.6698498110510635`*^9}, {3.669850009369406*^9, 
   3.6698501202347474`*^9}, {3.6699951003821154`*^9, 
   3.6699951056424165`*^9}, {3.6700152867878075`*^9, 
   3.6700155764745617`*^9}, {3.670015610588749*^9, 3.670015619500365*^9}, {
   3.670015688032091*^9, 3.6700157284663663`*^9}, {3.670015764421632*^9, 
   3.670015840169986*^9}, 3.670015932904459*^9, {3.6700160562011747`*^9, 
   3.6700160572045774`*^9}, {3.670016122696644*^9, 3.6700161250250483`*^9}, {
   3.6700161619991264`*^9, 3.670016418179453*^9}, {3.6700164525571203`*^9, 
   3.670016461968338*^9}, {3.6700165114424562`*^9, 3.6700166079154744`*^9}, {
   3.670016764585868*^9, 3.670016836804602*^9}, {3.670016880763682*^9, 
   3.6700169664870434`*^9}, {3.6700170094099264`*^9, 
   3.6700170622300243`*^9}, {3.670017100500495*^9, 3.670017244388363*^9}, {
   3.670017363001262*^9, 3.6700173953593225`*^9}, {3.670017462672247*^9, 
   3.670017476121673*^9}, {3.6700175294839745`*^9, 3.670017541837601*^9}, 
   3.670017575207465*^9, {3.6700176084221263`*^9, 3.670017646195198*^9}, {
   3.670017737480567*^9, 3.6700177522929935`*^9}, {3.6700178028644886`*^9, 
   3.6700178056130934`*^9}, {3.670017840849758*^9, 3.6700178473589697`*^9}, {
   3.670017880056429*^9, 3.670017962184577*^9}, {3.670018073504243*^9, 
   3.6700181574050417`*^9}, {3.670018298935869*^9, 3.670018391996192*^9}, {
   3.670018474341902*^9, 3.670018496033142*^9}, {3.6700198295079913`*^9, 
   3.670019850108429*^9}, {3.6700200865048394`*^9, 3.6700200955293555`*^9}, {
   3.6700201634792423`*^9, 3.6700201767249994`*^9}, {3.670020222450615*^9, 
   3.6700202303600674`*^9}, {3.6700203037302637`*^9, 3.670020312014738*^9}, {
   3.67002160862269*^9, 3.6700219383065467`*^9}, {3.670021970975415*^9, 
   3.6700220613285832`*^9}, {3.670022148355561*^9, 3.6700222543946257`*^9}, {
   3.670022314136043*^9, 3.670022475157253*^9}, {3.670022632842272*^9, 
   3.6700226385836*^9}, {3.6700226826761227`*^9, 3.670022910527155*^9}, {
   3.6700229916547947`*^9, 3.6700230300119886`*^9}, {3.670023065992047*^9, 
   3.670023079549822*^9}, {3.6700231136807747`*^9, 3.6700231230233088`*^9}, {
   3.670023186021912*^9, 3.6700232414570827`*^9}, {3.6700233199825745`*^9, 
   3.670023365143157*^9}, {3.67002350785632*^9, 3.670023512767601*^9}, {
   3.6700242405522275`*^9, 3.6700242438014135`*^9}, {3.670024287679923*^9, 
   3.6700242878359323`*^9}, {3.6700307649379253`*^9, 3.670030793394918*^9}, {
   3.6700312099092374`*^9, 3.670031213504408*^9}, {3.6702619445939174`*^9, 
   3.6702619736270037`*^9}, {3.6702620996385703`*^9, 
   3.6702621139110003`*^9}, {3.6702663908732367`*^9, 3.670266421699106*^9}, {
   3.670278065955389*^9, 3.6702780759854174`*^9}, {3.6702785090017376`*^9, 
   3.670278541310362*^9}, {3.670279388636643*^9, 3.6702794147881994`*^9}, {
   3.670279541262638*^9, 3.6702795520292535`*^9}, {3.6702796236673512`*^9, 
   3.670279624217383*^9}, {3.6702827119484987`*^9, 3.6702827127435*^9}, 
   3.670282982704276*^9, {3.670283460474086*^9, 3.6702834750611115`*^9}, {
   3.6702835325737185`*^9, 3.6702835327737193`*^9}, {3.6702839522574463`*^9, 
   3.670283953087448*^9}, {3.6702839856815014`*^9, 3.670284002932531*^9}, {
   3.670285440438506*^9, 3.670285441450564*^9}, {3.670285621430858*^9, 
   3.6702857053406577`*^9}, {3.670285747482068*^9, 3.670285820685255*^9}, {
   3.670641278882371*^9, 3.670641300855426*^9}, 3.671153638476224*^9, {
   3.671153803524514*^9, 3.671153804538516*^9}, {3.6711538519469995`*^9, 
   3.6711538529766006`*^9}, {3.6711539744228144`*^9, 
   3.6711540720321856`*^9}, {3.671154210357629*^9, 3.671154237735677*^9}, {
   3.6711553279119406`*^9, 3.671155328486949*^9}, {3.6711557160209007`*^9, 
   3.6711557519100504`*^9}, {3.6711559593857374`*^9, 
   3.6711559599307456`*^9}, {3.6711560522321634`*^9, 
   3.6711560776825542`*^9}, {3.671160567619633*^9, 3.6711605752697506`*^9}, {
   3.6711606330031376`*^9, 3.6711606431582937`*^9}, {3.6711623442717776`*^9, 
   3.6711623637685156`*^9}, {3.6712331143792067`*^9, 
   3.6712331149146075`*^9}, {3.67123328825992*^9, 3.6712332939053307`*^9}, {
   3.671233324332985*^9, 3.6712333444059205`*^9}, {3.671234162724057*^9, 
   3.6712341640656595`*^9}, {3.6713117260442896`*^9, 
   3.6713118538070493`*^9}, {3.671311908576447*^9, 3.6713120679373302`*^9}, {
   3.671312258693669*^9, 3.671312390041202*^9}, {3.671312526540651*^9, 
   3.671312528976755*^9}, {3.6713125783172426`*^9, 3.671312583561352*^9}, {
   3.6713126199232163`*^9, 3.6713126446873603`*^9}, {3.6713126855189323`*^9, 
   3.67131280735098*^9}, {3.6713128500021553`*^9, 3.6713128506729565`*^9}, {
   3.671312946557827*^9, 3.671312948757431*^9}, {3.6713130460576043`*^9, 
   3.6713130512624135`*^9}, {3.6713130848574734`*^9, 3.671313177276537*^9}, {
   3.6713132363976417`*^9, 3.6713133067451663`*^9}, {3.6713133912683177`*^9, 
   3.6713134378077*^9}, {3.6713134755055676`*^9, 3.671313523195552*^9}, {
   3.6713135539140067`*^9, 3.6713136616836243`*^9}, {3.6713141886895947`*^9, 
   3.671314206986129*^9}, {3.6713142729172583`*^9, 3.671314320244461*^9}, {
   3.671314382803979*^9, 3.671314406338523*^9}, {3.6713144460288997`*^9, 
   3.6713144519214106`*^9}, {3.671314509247419*^9, 3.6713145662951264`*^9}, {
   3.6713146150466185`*^9, 3.671314641993169*^9}, {3.671316434765293*^9, 
   3.671316560927231*^9}, {3.6713173719371877`*^9, 3.671317383674868*^9}, {
   3.671318481327589*^9, 3.6713185032388296`*^9}, {3.6713205092302103`*^9, 
   3.6713205274902515`*^9}, {3.671327960855012*^9, 3.671328006898153*^9}, {
   3.671328077771554*^9, 3.6713280786915655`*^9}, {3.671328346906844*^9, 
   3.671328403260105*^9}, {3.671328435040474*^9, 3.6713284944061975`*^9}, {
   3.6713285296141777`*^9, 3.6713285925975037`*^9}, {3.6713286580032825`*^9, 
   3.671328686873643*^9}, {3.6713287203990974`*^9, 3.6713287849524355`*^9}, {
   3.6713301291127234`*^9, 3.6713302473541813`*^9}, {3.671330431919444*^9, 
   3.6713305348185244`*^9}, {3.6713305852967997`*^9, 
   3.6713306000119867`*^9}, {3.67133080351445*^9, 3.6713308764378576`*^9}, {
   3.6713310103645735`*^9, 3.671331010989581*^9}, {3.6713326189264183`*^9, 
   3.6713326527543397`*^9}, {3.6713326854197855`*^9, 3.671333033889147*^9}, {
   3.671333325567628*^9, 3.6713334467342186`*^9}, 3.6713336281141233`*^9, {
   3.67133369078738*^9, 3.671333723340295*^9}, {3.6713350232097397`*^9, 
   3.6713350950648537`*^9}, {3.6713351291324053`*^9, 3.671335152509943*^9}, {
   3.6713352182375484`*^9, 3.6713352954251633`*^9}, {3.671375299692408*^9, 
   3.671375328640455*^9}, {3.6713755396827817`*^9, 3.6713755841368523`*^9}, {
   3.6713769595887375`*^9, 3.671376982868069*^9}, {3.671377029893759*^9, 
   3.6713772568907423`*^9}, 3.6713782071427402`*^9, 3.6713788972695937`*^9, {
   3.671379022134815*^9, 3.671379030218828*^9}, {3.671379583515187*^9, 
   3.671379628909272*^9}, {3.671412711183956*^9, 3.671412754202117*^9}, {
   3.671412788105138*^9, 3.6714128563311863`*^9}, {3.6716698852061872`*^9, 
   3.671669904196023*^9}, {3.6716803067832537`*^9, 3.6716803262702956`*^9}, {
   3.671681989201393*^9, 3.671682059816351*^9}, {3.671682226044402*^9, 
   3.671682248227848*^9}, {3.6716827737980146`*^9, 3.6716827838032355`*^9}, {
   3.671683631343897*^9, 3.6716836607069592`*^9}, {3.671683694308832*^9, 
   3.671683764773095*^9}, {3.671685378758671*^9, 3.6716854558755507`*^9}, {
   3.671685717341633*^9, 3.671685721293841*^9}, {3.67168605969421*^9, 
   3.671686062020015*^9}, {3.6716865682840405`*^9, 3.671686731939052*^9}, {
   3.671686792320012*^9, 3.6716869603382215`*^9}, {3.671716178056795*^9, 
   3.6717162204942226`*^9}, {3.671717455510002*^9, 3.671717469571807*^9}, {
   3.671729201402174*^9, 3.6717292439842567`*^9}, {3.671738743906927*^9, 
   3.671738744741929*^9}, {3.6717387965862207`*^9, 3.6717388041322565`*^9}, {
   3.6717388965915847`*^9, 3.6717389575517855`*^9}, {3.671739046023117*^9, 
   3.6717390819162316`*^9}, {3.671739145066948*^9, 3.6717391540759697`*^9}, {
   3.671739433517739*^9, 3.671739448788816*^9}, 3.671739657649922*^9, 
   3.6717396912850113`*^9, {3.6717397274651127`*^9, 3.6717397690257444`*^9}, {
   3.671739859526066*^9, 3.6717398816706333`*^9}, {3.6717401507134266`*^9, 
   3.6717401616264687`*^9}, {3.671742582834978*^9, 3.671742616200077*^9}, {
   3.6717426484541445`*^9, 3.67174266430518*^9}, {3.6717448154864273`*^9, 
   3.671744819904636*^9}, {3.671747331643324*^9, 3.6717473509173756`*^9}, {
   3.6717474311453514`*^9, 3.671747431394952*^9}, {3.671759379283369*^9, 
   3.6717594050569177`*^9}, 3.6719023749869566`*^9, {3.6719104918126836`*^9, 
   3.6719104997168016`*^9}, {3.671910663331614*^9, 3.671910792732334*^9}, {
   3.67191416198909*^9, 3.671914248367917*^9}, {3.6719142784358788`*^9, 
   3.671914298441186*^9}, {3.671985860082047*^9, 3.67198588930231*^9}, {
   3.671986163107979*^9, 3.6719862021990623`*^9}, {3.6719863230490193`*^9, 
   3.6719864088835974`*^9}, 3.671986638141303*^9, 3.6719866718560724`*^9, {
   3.671987044801633*^9, 3.6719871425822334`*^9}, {3.6719879462385225`*^9, 
   3.6719879468353233`*^9}, {3.671988053078989*^9, 3.671988054790595*^9}, {
   3.671988228607614*^9, 3.6719882313778195`*^9}, {3.6719938740389967`*^9, 
   3.671993910774098*^9}, {3.671993951181409*^9, 3.6719939653572197`*^9}, {
   3.6719940048624797`*^9, 3.6719940336181245`*^9}, {3.6719940665560083`*^9, 
   3.671994086730162*^9}, {3.6719942545847626`*^9, 3.671994285251517*^9}, {
   3.671994331025135*^9, 3.671994427561657*^9}, {3.6719944627366686`*^9, 
   3.6719945605932655`*^9}, {3.6719946985661573`*^9, 
   3.6719947273488035`*^9}, {3.6719948157108574`*^9, 
   3.6719948401022525`*^9}, {3.671995850760059*^9, 3.6719958532342005`*^9}, {
   3.6719960395018544`*^9, 3.6719960932969313`*^9}, {3.671996258959407*^9, 
   3.6719963108823767`*^9}, {3.6719963661735387`*^9, 
   3.6719964078369217`*^9}, {3.67199702007594*^9, 3.671997050416675*^9}, {
   3.671997097806386*^9, 3.67199722673576*^9}, {3.6720574581761417`*^9, 
   3.6720574788739595`*^9}, {3.672057528817227*^9, 3.6720575718453875`*^9}, {
   3.6720579223707714`*^9, 3.672057924285801*^9}, {3.67206040778795*^9, 
   3.672060422495676*^9}, {3.672079391745922*^9, 3.6720793932090054`*^9}, {
   3.6720799971475487`*^9, 3.6720800204498816`*^9}, {3.6721538363500133`*^9, 
   3.6721538393156214`*^9}, {3.672154064684695*^9, 3.6721541003794684`*^9}, {
   3.672154132264433*^9, 3.672154140751649*^9}, 3.672156374947054*^9, {
   3.6721566432286744`*^9, 3.672156654968855*^9}, {3.672156804531152*^9, 
   3.6721568419417267`*^9}, {3.6721568980750885`*^9, 3.672156898520096*^9}, {
   3.672156959688535*^9, 3.672156966046133*^9}, {3.672157070870243*^9, 
   3.6721570932330866`*^9}, {3.6721572800284557`*^9, 
   3.6721572949711847`*^9}, {3.672157354399598*^9, 3.672157392890189*^9}, {
   3.672157455198646*^9, 3.672157459411211*^9}, 3.6721575371474047`*^9, {
   3.672157594018278*^9, 3.672157618381152*^9}, {3.6721578326944447`*^9, 
   3.672157835714491*^9}, {3.672157972029084*^9, 3.672157992824404*^9}, {
   3.6722325937310085`*^9, 3.672232600466112*^9}, {3.672233281204068*^9, 
   3.672233324647235*^9}, {3.6722599024334993`*^9, 3.6722599694053297`*^9}, 
   3.672260828582472*^9, {3.672260862013384*^9, 3.6722608817595134`*^9}, {
   3.672535133197075*^9, 3.6725351401292887`*^9}, {3.6727109677763033`*^9, 
   3.672710974758817*^9}, {3.672711620427865*^9, 3.672711621467881*^9}, {
   3.672711690671444*^9, 3.6727116931639824`*^9}, {3.6727119200224667`*^9, 
   3.6727119293151093`*^9}, {3.6727124484568567`*^9, 
   3.6727124519768715`*^9}, {3.672712792202832*^9, 3.6727127927353334`*^9}, {
   3.672802452532505*^9, 3.6728024564225645`*^9}, {3.8757581684051456`*^9, 
   3.875758196765579*^9}, 3.8955551726779127`*^9, {3.967777452723688*^9, 
   3.9677774528141165`*^9}, {3.974949779785141*^9, 
   3.9749497969654226`*^9}},ExpressionUUID->"be69bc0c-f23e-42f8-b5d2-\
e67fb1a31db0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Appearance", " ", "of", " ", "MHDSystem"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"MHDSystem", "/:", 
    RowBox[{"Format", "[", 
     RowBox[{"MHDSystem", "[", "\[IndentingNewLine]", 
      RowBox[{"xxx___", ",", "\[IndentingNewLine]", 
       RowBox[{"MHDScalarFunction1", "\[Rule]", "ph1_"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"MHDScalarFunction2", "\[Rule]", "ph2_"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"MHDScalarFunction3", "\[Rule]", "ph3_"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"MetricSignature", "\[Rule]", "ss_"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"MHDPlasmaEnergyDensityOperator", "\[Rule]", "rho_"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"MHDMetricTensor", "\[Rule]", "ggg_"}]}], 
      "\[IndentingNewLine]", "]"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "sg", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"metric", " ", "signature"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sg", "=", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"ss", "===", "\"\<MostlyMinus\>\""}], ",", "\"\<+\>\"", ",", 
          RowBox[{"ss", "===", "\"\<MostlyPlus\>\""}], ",", "\"\<-\>\""}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"MHDSystem", "[", 
        RowBox[{"MatrixForm", "[", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"ph1", ",", "ph2", ",", "ph3", ",", 
              RowBox[{
              "\"\<\!\(\*SuperscriptBox[StyleBox[\"n\",FontSlant->\"Italic\"],\
 \"\[Mu]\"]\)\>\"", "\[Rule]", 
               RowBox[{"TensorComponents", "[", "nnnT", "]"}]}]}], "}"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "\"\<\!\(\*SubscriptBox[StyleBox[\"F\",FontSlant->\"Italic\"], \
\"\[Mu]\[Nu]\"]\)\>\"", "\[Rule]", 
               RowBox[{"MatrixForm", "[", 
                RowBox[{"TensorComponents", "[", "F\[Mu]\[Nu]TT", "]"}], 
                "]"}]}], ",", 
              RowBox[{
              "\"\<\!\(\*SuperscriptBox[StyleBox[\"J\",FontSlant->\"Italic\"],\
 \"\[Mu]\"]\)\>\"", "\[Rule]", 
               RowBox[{"TensorComponents", "[", "MaxJTT", "]"}]}]}], "}"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "\"\<\!\(\*StyleBox[\"T\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\"[\",FontSlant->\"Italic\"]\)EM\!\(\*SubscriptBox[StyleBox[\"]\",\
FontSlant->\"Italic\"], \"\[Mu]\[Nu]\"]\)\>\"", "\[Rule]", 
               RowBox[{"MatrixForm", "[", 
                RowBox[{"TensorComponents", "[", "MaxTT", "]"}], "]"}]}], ",", 
              RowBox[{
              "\"\<\!\(\*StyleBox[\"T\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\"[\",FontSlant->\"Italic\"]\)Plasma\!\(\*SubscriptBox[StyleBox[\"]\"\
,FontSlant->\"Italic\"], \"\[Mu]\[Nu]\"]\)\>\"", "\[Rule]", 
               RowBox[{"MatrixForm", "[", 
                RowBox[{"TensorComponents", "[", "PlasmaTT", "]"}], "]"}]}]}],
              "}"}], ","}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
          "\"\<Ideal MHD/Maxwell's equation 1: \!\(\*SubscriptBox[\(\[Del]\), \
\(\[Sigma]\)]\)\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(1\)]\) \
\!\(\*SubscriptBox[\(\[Del]\), \
\(\[Mu]\)]\)\!\(\*SuperscriptBox[StyleBox[\"F\",FontSlant->\"Italic\"], \"\
\[Mu]\[Sigma]\"]\) = \!\(\*SubscriptBox[\(\[Del]\), \
\(\[Alpha]\)]\)\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(1\)]\) \
\!\(\*SubscriptBox[\(\[Del]\), \(\[Beta]\)]\)\!\(\*SuperscriptBox[\(\
\[CapitalPhi]\), \(3\)]\) \
\!\(\*SuperscriptBox[StyleBox[\"P\",FontSlant->\"Italic\"], \"\[Alpha]\[Beta]\
\"]\)\>\"", ",", "\[IndentingNewLine]", 
           "\"\<Ideal MHD/Maxwell's equation 2: \
\!\(\*SubscriptBox[\(\[Del]\), \(\[Sigma]\)]\)\!\(\*SuperscriptBox[\(\
\[CapitalPhi]\), \(2\)]\) \!\(\*SubscriptBox[\(\[Del]\), \
\(\[Mu]\)]\)\!\(\*SuperscriptBox[StyleBox[\"F\",FontSlant->\"Italic\"], \"\
\[Mu]\[Sigma]\"]\) = \!\(\*SubscriptBox[\(\[Del]\), \
\(\[Alpha]\)]\)\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(2\)]\) \
\!\(\*SubscriptBox[\(\[Del]\), \(\[Beta]\)]\)\!\(\*SuperscriptBox[\(\
\[CapitalPhi]\), \(3\)]\) \
\!\(\*SuperscriptBox[StyleBox[\"P\",FontSlant->\"Italic\"], \"\[Alpha]\[Beta]\
\"]\)\>\"", ",", "\[IndentingNewLine]", 
           "\"\<Ideal MHD/Plasma equation: 0 = \
\!\(\*SubscriptBox[StyleBox[\"F\",FontSlant->\"Italic\"], \
\"\[Alpha]\[Beta]\"]\) \
\!\(\*SuperscriptBox[StyleBox[\"P\",FontSlant->\"Italic\"], \"\[Alpha]\[Beta]\
\"]\)\>\"", ",", "\[IndentingNewLine]", 
           RowBox[{
           "\"\<With \
\!\(\*SuperscriptBox[StyleBox[\"P\",FontSlant->\"Italic\"], \"\[Alpha]\[Beta]\
\"]\) \[Congruent] \>\"", "<>", "sg", "<>", 
            "\"\<\!\(\*SubscriptBox[\(\[Del]\), \
\(\[Sigma]\)]\)\!\(\*StyleBox[\"(\",FontSize->16]\)\!\(\*SubscriptBox[\(\[Rho]\
\), \(0\)]\)[\>\"", "<>", "sg", "<>", 
            "\"\<\!\(\*SuperscriptBox[StyleBox[\"n\",FontSlant->\"Italic\"], \
\"2\"]\)/2] \!\(\*SuperscriptBox[\(\[Del]\), \
\([\[Sigma]\)]\)\!\(\*SubscriptBox[\(\[CapitalPhi]\), \
\(1\)]\)\!\(\*SuperscriptBox[\(\[Del]\), \(\[Alpha]\)]\)\!\(\*SubscriptBox[\(\
\[CapitalPhi]\), \(2\)]\)\!\(\*SuperscriptBox[\(\[Del]\), \
\(\(\[Beta]\)\(]\)\)]\)\!\(\*SubscriptBox[\(\[CapitalPhi]\), \
\(3\)]\)\!\(\*StyleBox[\")\",FontSize->16]\)\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<Scalar fields : \>\"", ",", 
              RowBox[{"MatrixForm", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                 "\"\<\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(1\)]\)\>\"", 
                  "\[Rule]", "ph1"}], ",", 
                 RowBox[{
                 "\"\<\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(2\)]\)\>\"", 
                  "\[Rule]", "ph2"}], ",", 
                 RowBox[{
                 "\"\<\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(3\)]\)\>\"", 
                  "\[Rule]", "ph3"}]}], "}"}], "]"}]}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<Plasma energy density : \>\"", ",", 
              RowBox[{
               RowBox[{
               "\"\< \!\(\*SubscriptBox[\(\[Rho]\), \(0\)]\)[\>\"", "<>", 
                "sg", "<>", 
                "\"\<\!\(\*SuperscriptBox[StyleBox[\"n\",FontSlant->\"Italic\"\
], \"2\"]\)/2]\>\""}], "\[Rule]", 
               RowBox[{"rho", "[", 
                RowBox[{
                "sg", "<>", 
                 "\"\<\!\(\*StyleBox[SuperscriptBox[StyleBox[\"n\",FontSlant->\
\"Italic\"], \
\"2\"],FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"/\",FontSlant->\"Italic\"]\)\!\
\(\*StyleBox[\"2\",FontSlant->\"Italic\"]\)\>\""}], "]"}]}]}], "}"}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "\"\<\!\(\*SubscriptBox[\(g\), \(\[Mu]\[Nu]\)]\)\>\"", "\[Rule]", 
              RowBox[{"MatrixForm", "[", 
               RowBox[{"TensorComponents", "[", "ggg", "]"}], "]"}]}], ",", 
             RowBox[{"Coordinates", "\[Rule]", 
              RowBox[{"Coordinates", "[", "ggg", "]"}]}]}], "}"}]}], "}"}], 
         "]"}], "]"}]}]}], "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6698407509849577`*^9, 3.6698408131231823`*^9}, {
   3.669840872347288*^9, 3.6698409488818502`*^9}, {3.669840991774727*^9, 
   3.669841033699402*^9}, {3.6698419414843903`*^9, 3.6698419624920273`*^9}, {
   3.669844135719773*^9, 3.669844146429385*^9}, {3.6698441850648756`*^9, 
   3.669844242456984*^9}, {3.6698442807508526`*^9, 3.669844349794979*^9}, {
   3.669844444602553*^9, 3.6698445620849667`*^9}, {3.6698446255136824`*^9, 
   3.6698446259816837`*^9}, {3.6698446774140253`*^9, 
   3.6698446785060277`*^9}, {3.6698448410975957`*^9, 
   3.6698448884506965`*^9}, {3.6698449486940107`*^9, 3.669844980673071*^9}, {
   3.6698450434029026`*^9, 3.6698450679501467`*^9}, 3.6698497394799695`*^9, {
   3.6698497866486673`*^9, 3.6698498110510635`*^9}, {3.669850009369406*^9, 
   3.6698501202347474`*^9}, {3.6699951003821154`*^9, 
   3.6699951056424165`*^9}, {3.6700152867878075`*^9, 
   3.6700155764745617`*^9}, {3.670015610588749*^9, 3.670015619500365*^9}, {
   3.670015688032091*^9, 3.6700157284663663`*^9}, {3.670015764421632*^9, 
   3.670015840169986*^9}, 3.670015932904459*^9, {3.6700160562011747`*^9, 
   3.6700160572045774`*^9}, {3.670016122696644*^9, 3.6700161250250483`*^9}, {
   3.6700161619991264`*^9, 3.670016418179453*^9}, {3.6700164525571203`*^9, 
   3.670016461968338*^9}, {3.6700165114424562`*^9, 3.6700166079154744`*^9}, {
   3.670016764585868*^9, 3.670016836804602*^9}, {3.670016880763682*^9, 
   3.6700169664870434`*^9}, {3.6700170094099264`*^9, 
   3.6700170622300243`*^9}, {3.670017100500495*^9, 3.670017244388363*^9}, {
   3.670017363001262*^9, 3.6700173953593225`*^9}, {3.670017462672247*^9, 
   3.670017476121673*^9}, {3.6700175294839745`*^9, 3.670017541837601*^9}, 
   3.670017575207465*^9, {3.6700176084221263`*^9, 3.670017646195198*^9}, {
   3.670017737480567*^9, 3.6700177522929935`*^9}, {3.6700178028644886`*^9, 
   3.6700178056130934`*^9}, {3.670017840849758*^9, 3.6700178473589697`*^9}, {
   3.670017880056429*^9, 3.670017962184577*^9}, {3.670018073504243*^9, 
   3.6700181574050417`*^9}, {3.670018298935869*^9, 3.670018391996192*^9}, {
   3.670018474341902*^9, 3.670018496033142*^9}, {3.6700198295079913`*^9, 
   3.670019850108429*^9}, {3.6700200865048394`*^9, 3.6700200955293555`*^9}, {
   3.6700201634792423`*^9, 3.6700201767249994`*^9}, {3.670020222450615*^9, 
   3.6700202303600674`*^9}, {3.6700203037302637`*^9, 3.670020312014738*^9}, {
   3.67002160862269*^9, 3.6700219383065467`*^9}, {3.670021970975415*^9, 
   3.6700220613285832`*^9}, {3.670022148355561*^9, 3.6700222543946257`*^9}, {
   3.670022314136043*^9, 3.670022475157253*^9}, {3.670022632842272*^9, 
   3.6700226385836*^9}, {3.6700226826761227`*^9, 3.670022910527155*^9}, {
   3.6700229916547947`*^9, 3.6700230300119886`*^9}, {3.670023065992047*^9, 
   3.670023079549822*^9}, {3.6700231136807747`*^9, 3.6700231230233088`*^9}, {
   3.670023186021912*^9, 3.6700232414570827`*^9}, {3.6700233199825745`*^9, 
   3.670023365143157*^9}, {3.67002350785632*^9, 3.670023512767601*^9}, {
   3.6700242405522275`*^9, 3.6700242438014135`*^9}, {3.670024287679923*^9, 
   3.6700242878359323`*^9}, {3.6700307649379253`*^9, 3.670030793394918*^9}, {
   3.6700312099092374`*^9, 3.670031213504408*^9}, {3.6702619445939174`*^9, 
   3.6702619736270037`*^9}, {3.6702620996385703`*^9, 
   3.6702621139110003`*^9}, {3.6702663908732367`*^9, 3.670266421699106*^9}, {
   3.670278065955389*^9, 3.6702780759854174`*^9}, {3.6702785090017376`*^9, 
   3.670278541310362*^9}, {3.670279388636643*^9, 3.6702794147881994`*^9}, {
   3.670279541262638*^9, 3.6702795520292535`*^9}, {3.6702796236673512`*^9, 
   3.670279624217383*^9}, {3.6702827119484987`*^9, 3.6702827127435*^9}, 
   3.670282982704276*^9, {3.670283460474086*^9, 3.6702834750611115`*^9}, {
   3.6702835325737185`*^9, 3.6702835327737193`*^9}, {3.6702839522574463`*^9, 
   3.670283953087448*^9}, {3.6702839856815014`*^9, 3.670284002932531*^9}, {
   3.670285440438506*^9, 3.670285441450564*^9}, {3.670285621430858*^9, 
   3.6702857053406577`*^9}, {3.670285747482068*^9, 3.670285820685255*^9}, {
   3.670641278882371*^9, 3.670641300855426*^9}, 3.671153638476224*^9, {
   3.671153803524514*^9, 3.671153804538516*^9}, {3.6711538519469995`*^9, 
   3.6711538529766006`*^9}, {3.6711539744228144`*^9, 
   3.6711540720321856`*^9}, {3.671154210357629*^9, 3.671154237735677*^9}, {
   3.6711553279119406`*^9, 3.671155328486949*^9}, {3.6711557160209007`*^9, 
   3.6711557519100504`*^9}, {3.6711559593857374`*^9, 
   3.6711559599307456`*^9}, {3.6711560522321634`*^9, 
   3.6711560776825542`*^9}, {3.671160567619633*^9, 3.6711605752697506`*^9}, {
   3.6711606330031376`*^9, 3.6711606431582937`*^9}, {3.6711623442717776`*^9, 
   3.6711623637685156`*^9}, {3.6712331143792067`*^9, 
   3.6712331149146075`*^9}, {3.67123328825992*^9, 3.6712332939053307`*^9}, {
   3.671233324332985*^9, 3.6712333444059205`*^9}, {3.671234162724057*^9, 
   3.6712341640656595`*^9}, {3.6713117260442896`*^9, 
   3.6713118538070493`*^9}, {3.671311908576447*^9, 3.6713120679373302`*^9}, {
   3.671312258693669*^9, 3.671312390041202*^9}, {3.671312526540651*^9, 
   3.671312528976755*^9}, {3.6713125783172426`*^9, 3.671312583561352*^9}, {
   3.6713126199232163`*^9, 3.6713126446873603`*^9}, {3.6713126855189323`*^9, 
   3.67131280735098*^9}, {3.6713128500021553`*^9, 3.6713128506729565`*^9}, {
   3.671312946557827*^9, 3.671312948757431*^9}, {3.6713130460576043`*^9, 
   3.6713130512624135`*^9}, {3.6713130848574734`*^9, 3.671313177276537*^9}, {
   3.6713132363976417`*^9, 3.6713133067451663`*^9}, {3.6713133912683177`*^9, 
   3.6713134378077*^9}, {3.6713134755055676`*^9, 3.671313523195552*^9}, {
   3.6713135539140067`*^9, 3.6713136616836243`*^9}, {3.6713141886895947`*^9, 
   3.671314206986129*^9}, {3.6713142729172583`*^9, 3.671314320244461*^9}, {
   3.671314382803979*^9, 3.671314406338523*^9}, {3.6713144460288997`*^9, 
   3.6713144519214106`*^9}, {3.671314509247419*^9, 3.6713145662951264`*^9}, {
   3.6713146150466185`*^9, 3.671314641993169*^9}, {3.671316434765293*^9, 
   3.671316560927231*^9}, {3.6713173719371877`*^9, 3.671317383674868*^9}, {
   3.671318481327589*^9, 3.6713185032388296`*^9}, {3.6713205092302103`*^9, 
   3.6713205274902515`*^9}, {3.671327960855012*^9, 3.671328006898153*^9}, {
   3.671328077771554*^9, 3.6713280786915655`*^9}, {3.671328346906844*^9, 
   3.671328403260105*^9}, {3.671328435040474*^9, 3.6713284944061975`*^9}, {
   3.6713285296141777`*^9, 3.6713285925975037`*^9}, {3.6713286580032825`*^9, 
   3.671328686873643*^9}, {3.6713287203990974`*^9, 3.6713287849524355`*^9}, {
   3.6713301291127234`*^9, 3.6713302473541813`*^9}, {3.671330431919444*^9, 
   3.6713305348185244`*^9}, {3.6713305852967997`*^9, 
   3.6713306000119867`*^9}, {3.67133080351445*^9, 3.6713308764378576`*^9}, {
   3.6713310103645735`*^9, 3.671331010989581*^9}, {3.6713326189264183`*^9, 
   3.6713326527543397`*^9}, {3.6713326854197855`*^9, 3.671333033889147*^9}, {
   3.671333325567628*^9, 3.6713334467342186`*^9}, 3.6713336281141233`*^9, {
   3.67133369078738*^9, 3.671333723340295*^9}, {3.6713350232097397`*^9, 
   3.6713350950648537`*^9}, {3.6713351291324053`*^9, 3.671335152509943*^9}, {
   3.6713352182375484`*^9, 3.6713352954251633`*^9}, {3.671375299692408*^9, 
   3.671375328640455*^9}, {3.6713755396827817`*^9, 3.6713755841368523`*^9}, {
   3.6713769595887375`*^9, 3.671376982868069*^9}, {3.671377029893759*^9, 
   3.6713772568907423`*^9}, 3.6713782071427402`*^9, 3.6713788972695937`*^9, {
   3.671379022134815*^9, 3.671379030218828*^9}, {3.671379583515187*^9, 
   3.671379628909272*^9}, {3.671412711183956*^9, 3.671412754202117*^9}, {
   3.671412788105138*^9, 3.6714128563311863`*^9}, {3.6716698852061872`*^9, 
   3.671669904196023*^9}, {3.6716803067832537`*^9, 3.6716803262702956`*^9}, {
   3.671681989201393*^9, 3.671682059816351*^9}, {3.671682226044402*^9, 
   3.671682248227848*^9}, {3.6716827737980146`*^9, 3.6716827838032355`*^9}, {
   3.671683631343897*^9, 3.6716836607069592`*^9}, {3.671683694308832*^9, 
   3.671683764773095*^9}, {3.671685378758671*^9, 3.6716854558755507`*^9}, {
   3.671685717341633*^9, 3.671685721293841*^9}, {3.67168605969421*^9, 
   3.671686062020015*^9}, {3.6716865682840405`*^9, 3.671686731939052*^9}, {
   3.671686792320012*^9, 3.6716869603382215`*^9}, {3.671716178056795*^9, 
   3.6717162204942226`*^9}, {3.671717455510002*^9, 3.671717469571807*^9}, {
   3.671729201402174*^9, 3.6717292439842567`*^9}, {3.671738743906927*^9, 
   3.671738744741929*^9}, {3.6717387965862207`*^9, 3.6717388041322565`*^9}, {
   3.6717388965915847`*^9, 3.6717389575517855`*^9}, {3.671739046023117*^9, 
   3.6717390819162316`*^9}, {3.671739145066948*^9, 3.6717391540759697`*^9}, {
   3.671739433517739*^9, 3.671739448788816*^9}, 3.671739657649922*^9, 
   3.6717396912850113`*^9, {3.6717397274651127`*^9, 3.6717397690257444`*^9}, {
   3.671739859526066*^9, 3.6717398816706333`*^9}, {3.6717401507134266`*^9, 
   3.6717401616264687`*^9}, {3.671742582834978*^9, 3.671742616200077*^9}, {
   3.6717426484541445`*^9, 3.67174266430518*^9}, {3.6717448154864273`*^9, 
   3.671744819904636*^9}, {3.671747331643324*^9, 3.6717473509173756`*^9}, {
   3.6717474311453514`*^9, 3.671747431394952*^9}, {3.671759379283369*^9, 
   3.6717594050569177`*^9}, {3.6719023749869566`*^9, 3.6719024250485573`*^9}, 
   3.671911322863121*^9, {3.67191147518095*^9, 3.6719114790923586`*^9}, {
   3.6719120628572145`*^9, 3.6719121030219183`*^9}, {3.671912928036829*^9, 
   3.6719129761193404`*^9}, {3.671913044901679*^9, 3.6719130987500067`*^9}, 
   3.671914466066261*^9, {3.672000111820778*^9, 3.6720001412774625`*^9}, {
   3.672057170871729*^9, 3.6720571777768345`*^9}, {3.6720572267500873`*^9, 
   3.6720574117979293`*^9}, {3.6720581974574966`*^9, 3.672058269968611*^9}, {
   3.672060080562924*^9, 3.672060088633048*^9}, {3.6720602748859086`*^9, 
   3.6720603202591057`*^9}, {3.672060449116085*^9, 3.672060636126457*^9}, {
   3.6720607300879*^9, 3.6720607401830554`*^9}, {3.6721491576113987`*^9, 
   3.672149197466469*^9}, {3.672149342720563*^9, 3.672149421863228*^9}, {
   3.6721494537807903`*^9, 3.672149455935794*^9}, {3.672149510183656*^9, 
   3.672149523668858*^9}, {3.6721495582443657`*^9, 3.6721496328054357`*^9}, {
   3.672158045357711*^9, 3.6721581261264515`*^9}, {3.6721581970650406`*^9, 
   3.672158212435277*^9}, {3.672158329304572*^9, 3.6721583525049286`*^9}, {
   3.672158418495942*^9, 3.67215844309132*^9}, 3.6722608297945414`*^9, {
   3.6722608632444544`*^9, 3.672260883167594*^9}, {3.9749497798016686`*^9, 
   3.974949796968531*^9}},ExpressionUUID->"e7aa6d7e-597e-4268-9cea-\
38b386020295"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"old", " ", "code"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"MHDSystem", "/:", 
     RowBox[{"Format", "[", 
      RowBox[{"MHDSystem", "[", "\[IndentingNewLine]", 
       RowBox[{"xxx___", ",", "\[IndentingNewLine]", 
        RowBox[{"MHDScalar1", "\[Rule]", "ph1_"}], ",", "\[IndentingNewLine]", 
        RowBox[{"MHDScalar2", "\[Rule]", "ph2_"}], ",", "\[IndentingNewLine]", 
        RowBox[{"MHDScalar3", "\[Rule]", "ph3_"}], ",", "\[IndentingNewLine]", 
        RowBox[{"MHDMaxwellTensor", "\[Rule]", "F\[Mu]\[Nu]TT_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"MHDMaxwellStressTensor", "\[Rule]", "MaxTT_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"MHDMaxwellCurrentTensor", "\[Rule]", "MaxJTT_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"MHDPlasmaStressTensor", "\[Rule]", "PlasmaTT_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"MHDEquationsList", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"l1_", ",", "r1_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"l2_", ",", "r2_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "r3_"}], "}"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"MHDPlasmaCurrentTensor", "\[Rule]", "nnnT_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"MHDMetricTensor", "\[Rule]", "ggg_"}]}], 
       "\[IndentingNewLine]", "]"}], "]"}], ":=", 
     RowBox[{"MHDSystem", "[", 
      RowBox[{"MatrixForm", "[", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ph1", ",", "ph2", ",", "ph3", ",", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[StyleBox[\"n\",FontSlant->\"Italic\"], \
\"\[Mu]\"]\)\>\"", "\[Rule]", 
             RowBox[{"TensorComponents", "[", "nnnT", "]"}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "\"\<\!\(\*SubscriptBox[StyleBox[\"F\",FontSlant->\"Italic\"], \"\
\[Mu]\[Nu]\"]\)\>\"", "\[Rule]", 
             RowBox[{"MatrixForm", "[", 
              RowBox[{"TensorComponents", "[", "F\[Mu]\[Nu]TT", "]"}], 
              "]"}]}], ",", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[StyleBox[\"J\",FontSlant->\"Italic\"], \
\"\[Mu]\"]\)\>\"", "\[Rule]", 
             RowBox[{"TensorComponents", "[", "MaxJTT", "]"}]}]}], "}"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "\"\<\!\(\*StyleBox[\"T\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\
\"[\",FontSlant->\"Italic\"]\)EM\!\(\*SubscriptBox[StyleBox[\"]\",FontSlant->\
\"Italic\"], \"\[Mu]\[Nu]\"]\)\>\"", "\[Rule]", 
             RowBox[{"MatrixForm", "[", 
              RowBox[{"TensorComponents", "[", "MaxTT", "]"}], "]"}]}], ",", 
            RowBox[{
            "\"\<\!\(\*StyleBox[\"T\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\
\"[\",FontSlant->\"Italic\"]\)Plasma\!\(\*SubscriptBox[StyleBox[\"]\",\
FontSlant->\"Italic\"], \"\[Mu]\[Nu]\"]\)\>\"", "\[Rule]", 
             RowBox[{"MatrixForm", "[", 
              RowBox[{"TensorComponents", "[", "PlasmaTT", "]"}], "]"}]}]}], 
           "}"}], ","}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Ideal MHD/Maxwell's equation 1: \
\!\(\*SubscriptBox[\(\[Del]\), \(\[Sigma]\)]\)\!\(\*SuperscriptBox[\(\
\[CapitalPhi]\), \(1\)]\) \!\(\*SubscriptBox[\(\[Del]\), \
\(\[Mu]\)]\)\!\(\*SuperscriptBox[StyleBox[\"F\",FontSlant->\"Italic\"], \"\
\[Mu]\[Sigma]\"]\) = \!\(\*SubscriptBox[\(\[Del]\), \
\(\[Alpha]\)]\)\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(1\)]\) \
\!\(\*SubscriptBox[\(\[Del]\), \(\[Beta]\)]\)\!\(\*SuperscriptBox[\(\
\[CapitalPhi]\), \(3\)]\) \
\!\(\*SuperscriptBox[StyleBox[\"P\",FontSlant->\"Italic\"], \"\[Alpha]\[Beta]\
\"]\)\>\"", ",", 
             RowBox[{"l1", "==", "r1"}]}], "}"}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Ideal MHD/Maxwell's equation 2: \
\!\(\*SubscriptBox[\(\[Del]\), \(\[Sigma]\)]\)\!\(\*SuperscriptBox[\(\
\[CapitalPhi]\), \(2\)]\) \!\(\*SubscriptBox[\(\[Del]\), \
\(\[Mu]\)]\)\!\(\*SuperscriptBox[StyleBox[\"F\",FontSlant->\"Italic\"], \"\
\[Mu]\[Sigma]\"]\) = \!\(\*SubscriptBox[\(\[Del]\), \
\(\[Alpha]\)]\)\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(2\)]\) \
\!\(\*SubscriptBox[\(\[Del]\), \(\[Beta]\)]\)\!\(\*SuperscriptBox[\(\
\[CapitalPhi]\), \(3\)]\) \
\!\(\*SuperscriptBox[StyleBox[\"P\",FontSlant->\"Italic\"], \"\[Alpha]\[Beta]\
\"]\)\>\"", ",", 
             RowBox[{"l2", "==", "r2"}]}], "}"}], "]"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Ideal MHD/Plasma equation: 0 = \
\!\(\*SubscriptBox[StyleBox[\"F\",FontSlant->\"Italic\"], \
\"\[Alpha]\[Beta]\"]\) \
\!\(\*SuperscriptBox[StyleBox[\"P\",FontSlant->\"Italic\"], \"\[Alpha]\[Beta]\
\"]\)\>\"", ",", 
             RowBox[{"0", "==", "r3"}]}], "}"}], "]"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "\"\<\!\(\*SubscriptBox[StyleBox[\"g\",FontSlant->\"Italic\"], \"\
\[Mu]\[Nu]\"]\)\>\"", "\[Rule]", 
            RowBox[{"MatrixForm", "[", 
             RowBox[{"TensorComponents", "[", "ggg", "]"}], "]"}]}], ",", 
           RowBox[{"Coordinates", "\[Rule]", 
            RowBox[{"Coordinates", "[", "ggg", "]"}]}]}], "}"}]}], "}"}], 
       "]"}], "]"}]}], ";"}], " ", "*)"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6698407509849577`*^9, 3.6698408131231823`*^9}, {
   3.669840872347288*^9, 3.6698409488818502`*^9}, {3.669840991774727*^9, 
   3.669841033699402*^9}, {3.6698419414843903`*^9, 3.6698419624920273`*^9}, {
   3.669844135719773*^9, 3.669844146429385*^9}, {3.6698441850648756`*^9, 
   3.669844242456984*^9}, {3.6698442807508526`*^9, 3.669844349794979*^9}, {
   3.669844444602553*^9, 3.6698445620849667`*^9}, {3.6698446255136824`*^9, 
   3.6698446259816837`*^9}, {3.6698446774140253`*^9, 
   3.6698446785060277`*^9}, {3.6698448410975957`*^9, 
   3.6698448884506965`*^9}, {3.6698449486940107`*^9, 3.669844980673071*^9}, {
   3.6698450434029026`*^9, 3.6698450679501467`*^9}, 3.6698497394799695`*^9, {
   3.6698497866486673`*^9, 3.6698498110510635`*^9}, {3.669850009369406*^9, 
   3.6698501202347474`*^9}, {3.6699951003821154`*^9, 
   3.6699951056424165`*^9}, {3.6700152867878075`*^9, 
   3.6700155764745617`*^9}, {3.670015610588749*^9, 3.670015619500365*^9}, {
   3.670015688032091*^9, 3.6700157284663663`*^9}, {3.670015764421632*^9, 
   3.670015840169986*^9}, 3.670015932904459*^9, {3.6700160562011747`*^9, 
   3.6700160572045774`*^9}, {3.670016122696644*^9, 3.6700161250250483`*^9}, {
   3.6700161619991264`*^9, 3.670016418179453*^9}, {3.6700164525571203`*^9, 
   3.670016461968338*^9}, {3.6700165114424562`*^9, 3.6700166079154744`*^9}, {
   3.670016764585868*^9, 3.670016836804602*^9}, {3.670016880763682*^9, 
   3.6700169664870434`*^9}, {3.6700170094099264`*^9, 
   3.6700170622300243`*^9}, {3.670017100500495*^9, 3.670017244388363*^9}, {
   3.670017363001262*^9, 3.6700173953593225`*^9}, {3.670017462672247*^9, 
   3.670017476121673*^9}, {3.6700175294839745`*^9, 3.670017541837601*^9}, 
   3.670017575207465*^9, {3.6700176084221263`*^9, 3.670017646195198*^9}, {
   3.670017737480567*^9, 3.6700177522929935`*^9}, {3.6700178028644886`*^9, 
   3.6700178056130934`*^9}, {3.670017840849758*^9, 3.6700178473589697`*^9}, {
   3.670017880056429*^9, 3.670017962184577*^9}, {3.670018073504243*^9, 
   3.6700181574050417`*^9}, {3.670018298935869*^9, 3.670018391996192*^9}, {
   3.670018474341902*^9, 3.670018496033142*^9}, {3.6700198295079913`*^9, 
   3.670019850108429*^9}, {3.6700200865048394`*^9, 3.6700200955293555`*^9}, {
   3.6700201634792423`*^9, 3.6700201767249994`*^9}, {3.670020222450615*^9, 
   3.6700202303600674`*^9}, {3.6700203037302637`*^9, 3.670020312014738*^9}, {
   3.67002160862269*^9, 3.6700219383065467`*^9}, {3.670021970975415*^9, 
   3.6700220613285832`*^9}, {3.670022148355561*^9, 3.6700222543946257`*^9}, {
   3.670022314136043*^9, 3.670022475157253*^9}, {3.670022632842272*^9, 
   3.6700226385836*^9}, {3.6700226826761227`*^9, 3.670022910527155*^9}, {
   3.6700229916547947`*^9, 3.6700230300119886`*^9}, {3.670023065992047*^9, 
   3.670023079549822*^9}, {3.6700231136807747`*^9, 3.6700231230233088`*^9}, {
   3.670023186021912*^9, 3.6700232414570827`*^9}, {3.6700233199825745`*^9, 
   3.670023365143157*^9}, {3.67002350785632*^9, 3.670023512767601*^9}, {
   3.6700242405522275`*^9, 3.6700242438014135`*^9}, {3.670024287679923*^9, 
   3.6700242878359323`*^9}, {3.6700307649379253`*^9, 3.670030793394918*^9}, {
   3.6700312099092374`*^9, 3.670031213504408*^9}, {3.6702619445939174`*^9, 
   3.6702619736270037`*^9}, {3.6702620996385703`*^9, 
   3.6702621139110003`*^9}, {3.6702663908732367`*^9, 3.670266421699106*^9}, {
   3.670278065955389*^9, 3.6702780759854174`*^9}, {3.6702785090017376`*^9, 
   3.670278541310362*^9}, {3.670279388636643*^9, 3.6702794147881994`*^9}, {
   3.670279541262638*^9, 3.6702795520292535`*^9}, {3.6702796236673512`*^9, 
   3.670279624217383*^9}, {3.6702827119484987`*^9, 3.6702827127435*^9}, 
   3.670282982704276*^9, {3.670283460474086*^9, 3.6702834750611115`*^9}, {
   3.6702835325737185`*^9, 3.6702835327737193`*^9}, {3.6702839522574463`*^9, 
   3.670283953087448*^9}, {3.6702839856815014`*^9, 3.670284002932531*^9}, {
   3.670285440438506*^9, 3.670285441450564*^9}, {3.670285621430858*^9, 
   3.6702857053406577`*^9}, {3.670285747482068*^9, 3.670285820685255*^9}, {
   3.670641278882371*^9, 3.670641300855426*^9}, 3.671153638476224*^9, {
   3.671153803524514*^9, 3.671153804538516*^9}, {3.6711538519469995`*^9, 
   3.6711538529766006`*^9}, {3.6711539744228144`*^9, 
   3.6711540720321856`*^9}, {3.671154210357629*^9, 3.671154237735677*^9}, {
   3.6711553279119406`*^9, 3.671155328486949*^9}, {3.6711557160209007`*^9, 
   3.6711557519100504`*^9}, {3.6711559593857374`*^9, 
   3.6711559599307456`*^9}, {3.6711560522321634`*^9, 
   3.6711560776825542`*^9}, {3.671160567619633*^9, 3.6711605752697506`*^9}, {
   3.6711606330031376`*^9, 3.6711606431582937`*^9}, {3.6711623442717776`*^9, 
   3.6711623637685156`*^9}, {3.6712331143792067`*^9, 
   3.6712331149146075`*^9}, {3.67123328825992*^9, 3.6712332939053307`*^9}, {
   3.671233324332985*^9, 3.6712333444059205`*^9}, {3.671234162724057*^9, 
   3.6712341640656595`*^9}, {3.6713117260442896`*^9, 
   3.6713118538070493`*^9}, {3.671311908576447*^9, 3.6713120679373302`*^9}, {
   3.671312258693669*^9, 3.671312390041202*^9}, {3.671312526540651*^9, 
   3.671312528976755*^9}, {3.6713125783172426`*^9, 3.671312583561352*^9}, {
   3.6713126199232163`*^9, 3.6713126446873603`*^9}, {3.6713126855189323`*^9, 
   3.67131280735098*^9}, {3.6713128500021553`*^9, 3.6713128506729565`*^9}, {
   3.671312946557827*^9, 3.671312948757431*^9}, {3.6713130460576043`*^9, 
   3.6713130512624135`*^9}, {3.6713130848574734`*^9, 3.671313177276537*^9}, {
   3.6713132363976417`*^9, 3.6713133067451663`*^9}, {3.6713133912683177`*^9, 
   3.6713134378077*^9}, {3.6713134755055676`*^9, 3.671313523195552*^9}, {
   3.6713135539140067`*^9, 3.6713136616836243`*^9}, {3.6713141886895947`*^9, 
   3.671314206986129*^9}, {3.6713142729172583`*^9, 3.671314320244461*^9}, {
   3.671314382803979*^9, 3.671314406338523*^9}, {3.6713144460288997`*^9, 
   3.6713144519214106`*^9}, {3.671314509247419*^9, 3.6713145662951264`*^9}, {
   3.6713146150466185`*^9, 3.671314641993169*^9}, {3.671316434765293*^9, 
   3.671316560927231*^9}, {3.6713173719371877`*^9, 3.671317383674868*^9}, {
   3.671318481327589*^9, 3.6713185032388296`*^9}, {3.6713205092302103`*^9, 
   3.6713205274902515`*^9}, {3.671327960855012*^9, 3.671328006898153*^9}, {
   3.671328077771554*^9, 3.6713280786915655`*^9}, {3.671328346906844*^9, 
   3.671328403260105*^9}, {3.671328435040474*^9, 3.6713284944061975`*^9}, {
   3.6713285296141777`*^9, 3.6713285925975037`*^9}, {3.6713286580032825`*^9, 
   3.671328686873643*^9}, {3.6713287203990974`*^9, 3.6713287849524355`*^9}, {
   3.6713301291127234`*^9, 3.6713302473541813`*^9}, {3.671330431919444*^9, 
   3.6713305348185244`*^9}, {3.6713305852967997`*^9, 
   3.6713306000119867`*^9}, {3.67133080351445*^9, 3.6713308764378576`*^9}, {
   3.6713310103645735`*^9, 3.671331010989581*^9}, {3.6713326189264183`*^9, 
   3.6713326527543397`*^9}, {3.6713326854197855`*^9, 3.671333033889147*^9}, {
   3.671333325567628*^9, 3.6713334467342186`*^9}, 3.6713336281141233`*^9, {
   3.67133369078738*^9, 3.671333723340295*^9}, {3.6713350232097397`*^9, 
   3.6713350950648537`*^9}, {3.6713351291324053`*^9, 3.671335152509943*^9}, {
   3.6713352182375484`*^9, 3.6713352954251633`*^9}, {3.671375299692408*^9, 
   3.671375328640455*^9}, {3.6713755396827817`*^9, 3.6713755841368523`*^9}, {
   3.6713769595887375`*^9, 3.671376982868069*^9}, {3.671377029893759*^9, 
   3.6713772568907423`*^9}, 3.6713782071427402`*^9, 3.6713788972695937`*^9, {
   3.671379022134815*^9, 3.671379030218828*^9}, {3.671379583515187*^9, 
   3.671379628909272*^9}, {3.671412711183956*^9, 3.671412754202117*^9}, {
   3.671412788105138*^9, 3.6714128563311863`*^9}, {3.6716698852061872`*^9, 
   3.671669904196023*^9}, {3.6716803067832537`*^9, 3.6716803262702956`*^9}, {
   3.671681989201393*^9, 3.671682059816351*^9}, {3.671682226044402*^9, 
   3.671682248227848*^9}, {3.6716827737980146`*^9, 3.6716827838032355`*^9}, {
   3.671683631343897*^9, 3.6716836607069592`*^9}, {3.671683694308832*^9, 
   3.671683764773095*^9}, {3.671685378758671*^9, 3.6716854558755507`*^9}, {
   3.671685717341633*^9, 3.671685721293841*^9}, {3.67168605969421*^9, 
   3.671686062020015*^9}, {3.6716865682840405`*^9, 3.671686731939052*^9}, {
   3.671686792320012*^9, 3.6716869603382215`*^9}, {3.671716178056795*^9, 
   3.6717162204942226`*^9}, {3.671717455510002*^9, 3.671717469571807*^9}, {
   3.671729201402174*^9, 3.6717292439842567`*^9}, {3.671738743906927*^9, 
   3.671738744741929*^9}, {3.6717387965862207`*^9, 3.6717388041322565`*^9}, {
   3.6717388965915847`*^9, 3.6717389575517855`*^9}, {3.671739046023117*^9, 
   3.6717390819162316`*^9}, {3.671739145066948*^9, 3.6717391540759697`*^9}, {
   3.671739433517739*^9, 3.671739448788816*^9}, 3.671739657649922*^9, 
   3.6717396912850113`*^9, {3.6717397274651127`*^9, 3.6717397690257444`*^9}, {
   3.671739859526066*^9, 3.6717398816706333`*^9}, {3.6717401507134266`*^9, 
   3.6717401616264687`*^9}, {3.671742582834978*^9, 3.671742616200077*^9}, {
   3.6717426484541445`*^9, 3.67174266430518*^9}, {3.6717448154864273`*^9, 
   3.671744819904636*^9}, {3.671747331643324*^9, 3.6717473509173756`*^9}, {
   3.6717474311453514`*^9, 3.671747431394952*^9}, {3.671759379283369*^9, 
   3.6717594050569177`*^9}, {3.6719023749869566`*^9, 3.6719024250485573`*^9}, 
   3.671911322863121*^9},ExpressionUUID->"8d79a8a5-7ec4-4e96-b4c8-\
b15d70013b23"]
}, Closed]],

Cell[CellGroupData[{

Cell["MHDScalar", "Subsubsection",
 CellChangeTimes->{{3.6712917467837687`*^9, 3.6712917814391313`*^9}, {
  3.671291989975409*^9, 3.6712920251686726`*^9}, {3.6712948275859375`*^9, 
  3.671294844060867*^9}, {3.6713194430010953`*^9, 
  3.6713194439188976`*^9}},ExpressionUUID->"6b883a84-a833-4032-b90f-\
01b764466ccc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "scalars", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"MHDScalar", "[", 
      RowBox[{"1", ",", "mm_MHDSystem"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "xx", "}"}], ",", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"mm", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"MHDScalarFunction1", "\[Rule]", "xx_"}], ")"}], 
           "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDScalar", "[", 
      RowBox[{"2", ",", "mm_MHDSystem"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "xx", "}"}], ",", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"mm", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"MHDScalarFunction2", "\[Rule]", "xx_"}], ")"}], 
           "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDScalar", "[", 
      RowBox[{"3", ",", "mm_MHDSystem"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "xx", "}"}], ",", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"mm", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"MHDScalarFunction3", "\[Rule]", "xx_"}], ")"}], 
           "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"1", "-", 
     RowBox[{"forms", "/", "vectors"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDScalar", "[", 
      RowBox[{
       RowBox[{"\[Mu]T_", "/;", 
        RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", "1", ",", 
       "mm_MHDSystem"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Alpha]", ",", "xx"}], "}"}], ",", 
       RowBox[{"MoveIndices", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"mm", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"MHD1FormTensor1", "\[Rule]", "xx_"}], ")"}], 
             "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", "\[Mu]T", "}"}], ",", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"mm", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"MHDMetricTensor", "\[Rule]", "xx_"}], ")"}], 
             "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDScalar", "[", 
      RowBox[{
       RowBox[{"\[Mu]T_", "/;", 
        RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", "2", ",", 
       "mm_MHDSystem"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Alpha]", ",", "xx"}], "}"}], ",", 
       RowBox[{"MoveIndices", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"mm", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"MHD1FormTensor2", "\[Rule]", "xx_"}], ")"}], 
             "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", "\[Mu]T", "}"}], ",", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"mm", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"MHDMetricTensor", "\[Rule]", "xx_"}], ")"}], 
             "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDScalar", "[", 
      RowBox[{
       RowBox[{"\[Mu]T_", "/;", 
        RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", "3", ",", 
       "mm_MHDSystem"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Alpha]", ",", "xx"}], "}"}], ",", 
       RowBox[{"MoveIndices", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"mm", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"MHD1FormTensor3", "\[Rule]", "xx_"}], ")"}], 
             "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", "\[Mu]T", "}"}], ",", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"mm", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"MHDMetricTensor", "\[Rule]", "xx_"}], ")"}], 
             "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}]}], 
      "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.671319027734232*^9, 3.671319027749832*^9}, {
   3.6713190656093225`*^9, 3.6713191567849135`*^9}, {3.6713191897201796`*^9, 
   3.671319290158579*^9}, {3.671319353327314*^9, 3.671319396723198*^9}, {
   3.6713817105197372`*^9, 3.6713817218947725`*^9}, {3.6716839677836056`*^9, 
   3.6716839724206157`*^9}, 3.6721575443550158`*^9, {3.6721575952732973`*^9, 
   3.67215761953117*^9}, {3.6722608389090624`*^9, 3.672260876852233*^9}, {
   3.895554775321517*^9, 
   3.8955547753265142`*^9}},ExpressionUUID->"bd12b7be-8b0d-43d8-912f-\
7a4b2aecd725"]
}, Closed]],

Cell[CellGroupData[{

Cell["MHD3Form", "Subsubsection",
 CellChangeTimes->{{3.67131945597293*^9, 
  3.6713194752303767`*^9}},ExpressionUUID->"e87a704e-ca4f-4e56-bc1a-\
70782c9b0a2c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MHD3Form", "[", 
    RowBox[{
     RowBox[{"\[Mu]T_", "/;", 
      RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", 
     RowBox[{"\[Nu]T_", "/;", 
      RowBox[{"TestIndices", "[", "\[Nu]T", "]"}]}], ",", 
     RowBox[{"\[Gamma]T_", "/;", 
      RowBox[{"TestIndices", "[", "\[Gamma]T", "]"}]}], ",", "mm_MHDSystem"}],
     "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "xx"}], "}"}], ",", 
     RowBox[{"MoveIndices", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"mm", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"MHD3FormTensor", "\[Rule]", "xx_"}], ")"}], 
           "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Mu]T", ",", "\[Nu]T", ",", "\[Gamma]T"}], "}"}], ",", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"mm", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"MHDMetricTensor", "\[Rule]", "xx_"}], ")"}], 
           "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.671319027734232*^9, 3.671319027749832*^9}, {
   3.6713190656093225`*^9, 3.6713191567849135`*^9}, {3.6713191897201796`*^9, 
   3.671319290158579*^9}, {3.671319353327314*^9, 3.671319396723198*^9}, {
   3.671320060937481*^9, 3.6713200640646896`*^9}, {3.671320120148004*^9, 
   3.6713201531446695`*^9}, {3.67132018377633*^9, 3.671320233640031*^9}, {
   3.6713204707071257`*^9, 3.671320521037039*^9}, {3.67132057253094*^9, 
   3.6713205737497425`*^9}, 3.671683978752929*^9, {3.895554775334509*^9, 
   3.895554775338506*^9}},ExpressionUUID->"2cea03de-e41a-4d25-89fa-\
b6ed5552e8a1"]
}, Closed]],

Cell[CellGroupData[{

Cell["MHDPlasmaCurrent", "Subsubsection",
 CellChangeTimes->{{3.67131945597293*^9, 
  3.671319472420971*^9}},ExpressionUUID->"0b6fed30-3634-43ee-80c8-\
2ecafdd0e265"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MHDPlasmaCurrent", "[", 
    RowBox[{
     RowBox[{"\[Mu]T_", "/;", 
      RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", "mm_MHDSystem"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "xx", "}"}], ",", 
     RowBox[{"MoveIndices", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"mm", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"MHDPlasmaCurrentTensor", "\[Rule]", "xx_"}], ")"}], 
           "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", "\[Mu]T", "}"}], ",", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"mm", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"MHDMetricTensor", "\[Rule]", "xx_"}], ")"}], 
           "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.671319027734232*^9, 3.671319027749832*^9}, {
   3.6713190656093225`*^9, 3.6713191567849135`*^9}, {3.6713191897201796`*^9, 
   3.671319290158579*^9}, {3.671319353327314*^9, 3.671319396723198*^9}, {
   3.671320060937481*^9, 3.6713200640646896`*^9}, {3.671320120148004*^9, 
   3.6713201531446695`*^9}, 3.6713203381120396`*^9, 3.6713203776117315`*^9, 
   3.6716839812985353`*^9, {3.671901818149008*^9, 3.671901818352808*^9}, 
   3.8955547753465014`*^9},ExpressionUUID->"27725eec-53c5-41b7-850c-\
df20b3c08fa2"]
}, Closed]],

Cell[CellGroupData[{

Cell["MHDMaxwell", "Subsubsection",
 CellChangeTimes->{{3.67131945597293*^9, 3.671319472420971*^9}, {
  3.6719017418984957`*^9, 
  3.671901745072509*^9}},ExpressionUUID->"293f512d-0167-44ba-99c9-\
f7fe9e66e44b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MHDMaxwell", "[", 
    RowBox[{
     RowBox[{"\[Mu]T_", "/;", 
      RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", 
     RowBox[{"\[Nu]T_", "/;", 
      RowBox[{"TestIndices", "[", "\[Nu]T", "]"}]}], ",", "mm_MHDSystem"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "xx", "}"}], ",", 
     RowBox[{"MoveIndices", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"mm", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"MHDMaxwellTensor", "\[Rule]", "xx_"}], ")"}], 
           "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}], ",", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"mm", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"MHDMetricTensor", "\[Rule]", "xx_"}], ")"}], 
           "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.671319027734232*^9, 3.671319027749832*^9}, {
   3.6713190656093225`*^9, 3.6713191567849135`*^9}, {3.6713191897201796`*^9, 
   3.671319290158579*^9}, {3.671319353327314*^9, 3.671319396723198*^9}, {
   3.671320060937481*^9, 3.6713200640646896`*^9}, {3.671320120148004*^9, 
   3.6713201531446695`*^9}, 3.6713203381120396`*^9, 3.6713203776117315`*^9, 
   3.6716839812985353`*^9, {3.6719017509607368`*^9, 3.671901820696019*^9}, {
   3.895554775354497*^9, 
   3.895554775356496*^9}},ExpressionUUID->"1a414918-ee66-4e6f-ad5a-\
be0b8c63c99c"]
}, Closed]],

Cell[CellGroupData[{

Cell["MHDMaxwellCurrent", "Subsubsection",
 CellChangeTimes->{{3.6712917467837687`*^9, 3.6712917814391313`*^9}, {
  3.6712918250647116`*^9, 3.671291851675561*^9}, {3.6713205405498753`*^9, 
  3.671320542500879*^9}},ExpressionUUID->"b9a4af75-3a33-450a-9c0f-\
4ce1c0791806"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MHDMaxwellCurrent", "[", 
    RowBox[{
     RowBox[{"\[Mu]T_", "/;", 
      RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", "mm_MHDSystem"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "xx", "}"}], ",", 
     RowBox[{"MoveIndices", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"mm", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"MHDMaxwellCurrentTensor", "\[Rule]", "xx_"}], ")"}], 
           "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", "\[Mu]T", "}"}], ",", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"mm", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"MHDMetricTensor", "\[Rule]", "xx_"}], ")"}], 
           "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.671319027734232*^9, 3.671319027749832*^9}, {
   3.6713190656093225`*^9, 3.6713191567849135`*^9}, {3.6713191897201796`*^9, 
   3.671319290158579*^9}, {3.671319353327314*^9, 3.671319396723198*^9}, {
   3.671320060937481*^9, 3.6713200640646896`*^9}, {3.671320120148004*^9, 
   3.6713201531446695`*^9}, {3.6713205464704885`*^9, 
   3.6713205473284903`*^9}, {3.671379414641571*^9, 3.671379416667574*^9}, 
   3.671683986327546*^9, {3.671901878412259*^9, 3.6719018786356597`*^9}, 
   3.8955547753644905`*^9},ExpressionUUID->"f80df394-c6f8-48b0-bd29-\
6b0999066c15"]
}, Closed]],

Cell[CellGroupData[{

Cell["MHDRank2P", "Subsubsection",
 CellChangeTimes->{{3.6712917467837687`*^9, 3.6712917814391313`*^9}, {
  3.6712918250647116`*^9, 3.671291851675561*^9}, {3.6713205405498753`*^9, 
  3.671320542500879*^9}, {3.671320662454723*^9, 
  3.671320664487726*^9}},ExpressionUUID->"b0b8d692-4957-467d-ae1e-\
aa214d3370e1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MHDRank2P", "[", 
    RowBox[{
     RowBox[{"\[Mu]T_", "/;", 
      RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", 
     RowBox[{"\[Nu]T_", "/;", 
      RowBox[{"TestIndices", "[", "\[Nu]T", "]"}]}], ",", "mm_MHDSystem"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "xx", "}"}], ",", 
     RowBox[{"MoveIndices", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"mm", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"MHDRank2PTensor", "\[Rule]", "xx_"}], ")"}], 
           "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}], ",", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"mm", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"MHDMetricTensor", "\[Rule]", "xx_"}], ")"}], 
           "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.671319027734232*^9, 3.671319027749832*^9}, {
  3.6713190656093225`*^9, 3.6713191567849135`*^9}, {3.6713191897201796`*^9, 
  3.671319290158579*^9}, {3.671319353327314*^9, 3.671319396723198*^9}, {
  3.671320060937481*^9, 3.6713200640646896`*^9}, {3.671320120148004*^9, 
  3.6713201531446695`*^9}, {3.6713205464704885`*^9, 3.6713205473284903`*^9}, {
  3.6713206807925572`*^9, 3.6713207087614145`*^9}, {3.6716839894791527`*^9, 
  3.6716840006539755`*^9}, {3.6719021034720726`*^9, 3.6719021040240746`*^9}, {
  3.895554775372487*^9, 
  3.895554775374485*^9}},ExpressionUUID->"cca260ae-8eb8-43cf-b070-\
73050e196e5f"]
}, Closed]],

Cell[CellGroupData[{

Cell["MHDEquations", "Subsubsection",
 CellChangeTimes->{{3.6712917467837687`*^9, 3.6712917814391313`*^9}, {
  3.671291949032036*^9, 3.67129195723645*^9}, {3.671759690104679*^9, 
  3.671759693174185*^9}},ExpressionUUID->"1de083d4-2870-4c02-8d71-\
5d6c7c6e7e6d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "remember", " ", "we", " ", "have", " ", "ordered", " ", "the", " ", 
    "eqns", " ", "from", " ", "left", " ", "to", " ", "right", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"eq", ".", " ", "1"}], ",", " ", "2", ",", " ", 
      RowBox[{"3", " ", "in", " ", "Description", " ", "above"}]}], ")"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MHDEquations", "[", "mm_MHDSystem", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "xx", "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Equal", "@@", "#"}], ")"}], "&"}], "/@", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"mm", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"MHDEquationsList", "\[Rule]", "xx_"}], ")"}], 
           "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6713194925206084`*^9, 3.6713195365221214`*^9}, {
  3.6713197986800923`*^9, 3.671319837413413*^9}, {3.671319908367972*^9, 
  3.671319920020796*^9}, {3.671319960429677*^9, 3.6713199897783375`*^9}, {
  3.6717594135802336`*^9, 3.6717594193916445`*^9}, {3.671902199088857*^9, 
  3.6719021993414583`*^9}, {3.6727131990613623`*^9, 
  3.6727131993263626`*^9}},ExpressionUUID->"d5943ebb-12da-48aa-ba02-\
3d505a60df87"]
}, Closed]],

Cell[CellGroupData[{

Cell["MHDEnergyMomentumShearStress", "Subsubsection",
 CellChangeTimes->{{3.6712917467837687`*^9, 3.6712917814391313`*^9}, {
   3.671291949032036*^9, 3.67129195723645*^9}, {3.6712968576832933`*^9, 
   3.671296920383006*^9}, {3.671320850508881*^9, 3.6713208819661403`*^9}, {
   3.6713822787618303`*^9, 3.6713822873288484`*^9}, {3.6719082728413897`*^9, 
   3.6719082779503*^9}, 
   3.6719951735673256`*^9},ExpressionUUID->"34826003-b078-4f6c-9e5e-\
6c618ecc57de"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MHDEnergyMomentumShearStress", "[", 
     RowBox[{
      RowBox[{"\[Mu]T_", "/;", 
       RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", 
      RowBox[{"\[Nu]T_", "/;", 
       RowBox[{"TestIndices", "[", "\[Nu]T", "]"}]}], ",", "ss_String", ",", 
      "mm_MHDSystem"}], "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ss", "===", "\"\<Maxwell\>\""}], ")"}], "||", 
      RowBox[{"(", 
       RowBox[{"ss", "===", "\"\<Photons\>\""}], ")"}], "||", 
      RowBox[{"(", 
       RowBox[{"ss", "===", "\"\<EM\>\""}], ")"}], "||", 
      RowBox[{"(", 
       RowBox[{"ss", "===", "\"\<Electromagnetic\>\""}], ")"}], "||", 
      RowBox[{"(", 
       RowBox[{"ss", "===", "\"\<Plasma\>\""}], ")"}], "||", 
      RowBox[{"(", 
       RowBox[{"ss", "===", "\"\<Total\>\""}], ")"}]}], ")"}]}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "xx", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"ss", "===", "\"\<Maxwell\>\""}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{"ss", "===", "\"\<Photons\>\""}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{"ss", "===", "\"\<EM\>\""}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{"ss", "===", "\"\<Electromagnetic\>\""}], ")"}]}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"MoveIndices", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"mm", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"MHDMaxwellStressTensor", "\[Rule]", "xx_"}], ")"}], 
             "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}], ",", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"mm", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"MHDMetricTensor", "\[Rule]", "xx_"}], ")"}], 
             "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{"ss", "===", "\"\<Plasma\>\""}], ")"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"MoveIndices", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"mm", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"MHDPlasmaStressTensor", "\[Rule]", "xx_"}], ")"}], 
             "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}], ",", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"mm", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"MHDMetricTensor", "\[Rule]", "xx_"}], ")"}], 
             "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{"ss", "===", "\"\<Total\>\""}], ")"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"MoveIndices", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"mm", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"MHDTotalStressTensor", "\[Rule]", "xx_"}], ")"}], 
             "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}], ",", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"mm", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"MHDMetricTensor", "\[Rule]", "xx_"}], ")"}], 
             "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.671413101592453*^9, 3.6714131015949535`*^9}, {
   3.671413146783147*^9, 3.6714131653084316`*^9}, {3.6719022155273247`*^9, 
   3.671902218455936*^9}, {3.6719024827607923`*^9, 3.6719027523435783`*^9}, {
   3.671902784010708*^9, 3.671902816521225*^9}, {3.671902847200535*^9, 
   3.6719028537069664`*^9}, {3.6719951061834717`*^9, 3.67199510825559*^9}, 
   3.6719951415674953`*^9, {3.6725949044347167`*^9, 3.672594921445549*^9}, 
   3.672713241781448*^9, {3.8955547753874764`*^9, 
   3.8955547753904753`*^9}},ExpressionUUID->"ca54feb2-d00e-4f7e-b100-\
a65454a219b4"]
}, Closed]],

Cell[CellGroupData[{

Cell["MHDPlasmaEnergyDensity", "Subsubsection",
 CellChangeTimes->{{3.6712917467837687`*^9, 3.6712917814391313`*^9}, {
   3.671291949032036*^9, 3.67129195723645*^9}, {3.6712968576832933`*^9, 
   3.671296920383006*^9}, {3.6713024921211157`*^9, 3.671302495647722*^9}, {
   3.6716553379120765`*^9, 3.67165534204714*^9}, {3.6719161658473687`*^9, 
   3.6719161711799507`*^9}, 3.6719974442492013`*^9, {3.672059703046625*^9, 
   3.6720597124242687`*^9}},ExpressionUUID->"9fe1b10e-8538-43de-b21f-\
03b7c5eb1687"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "extract", " ", "plasma", " ", "energy", " ", "density", " ", "operator", 
    " ", "from", " ", "MHDSystem"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MHDPlasmaEnergyDensity", "[", "mm_MHDSystem", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "xx", "}"}], ",", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"mm", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"MHDPlasmaEnergyDensityOperator", "\[Rule]", "xx_"}], 
           ")"}], "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
       "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6713194925206084`*^9, 3.6713195365221214`*^9}, {
   3.671378999288777*^9, 3.6713790029447823`*^9}, 3.671760009531562*^9, {
   3.671902947401533*^9, 3.6719029536069517`*^9}, 3.671997430871436*^9, {
   3.6720597879559298`*^9, 
   3.672059814553838*^9}},ExpressionUUID->"df59a9b6-049f-49d0-9094-\
da66833be24c"]
}, Closed]],

Cell[CellGroupData[{

Cell["MHDMetric", "Subsubsection",
 CellChangeTimes->{{3.6712917467837687`*^9, 3.6712917814391313`*^9}, {
  3.671291949032036*^9, 3.67129195723645*^9}, {3.6712968576832933`*^9, 
  3.671296920383006*^9}, {3.6713024921211157`*^9, 
  3.671302495647722*^9}},ExpressionUUID->"86ba7e76-0b9d-41d2-a82b-\
b1c6c7226501"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"extract", " ", "metric", " ", "from", " ", "MHDSystem"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MHDMetric", "[", 
     RowBox[{
      RowBox[{"\[Mu]T_", "/;", 
       RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", 
      RowBox[{"\[Nu]T_", "/;", 
       RowBox[{"TestIndices", "[", "\[Nu]T", "]"}]}], ",", "mm_MHDSystem"}], 
     "]"}], ":=", 
    RowBox[{"Metric", "[", 
     RowBox[{"\[Mu]T", ",", "\[Nu]T", ",", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "xx", "}"}], ",", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"mm", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"MHDMetricTensor", "\[Rule]", "xx_"}], ")"}], 
            "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
         "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}]}], 
     "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6713194925206084`*^9, 3.6713195365221214`*^9}, {
  3.671378999288777*^9, 3.6713790029447823`*^9}, {3.6722580555528636`*^9, 
  3.6722580895568085`*^9}, {3.8955547753984704`*^9, 
  3.895554775400469*^9}},ExpressionUUID->"dba3ad66-c194-4162-bbe2-\
88aa9be0e86d"]
}, Closed]],

Cell[CellGroupData[{

Cell["MHDLagrangian", "Subsubsection",
 CellChangeTimes->{{3.6712917467837687`*^9, 3.6712917814391313`*^9}, {
   3.671291949032036*^9, 3.67129195723645*^9}, {3.6712968576832933`*^9, 
   3.671296920383006*^9}, {3.6713024921211157`*^9, 3.671302495647722*^9}, {
   3.6716553379120765`*^9, 3.67165534204714*^9}, {3.6719161658473687`*^9, 
   3.6719161711799507`*^9}, 
   3.6719974442492013`*^9},ExpressionUUID->"d7ea3f83-6f7c-4a43-b6a3-\
c9bdd5b55d7b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "extract", " ", "Lagrangian", " ", "density", " ", "from", " ", 
    "MHDSystem"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MHDLagrangian", "[", "mm_MHDSystem", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "xx", "}"}], ",", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"mm", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"MHDLagrangianDensity", "\[Rule]", "xx_"}], ")"}], 
          "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
       "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6713194925206084`*^9, 3.6713195365221214`*^9}, {
   3.671378999288777*^9, 3.6713790029447823`*^9}, 3.671760009531562*^9, {
   3.671902947401533*^9, 3.6719029536069517`*^9}, 
   3.671997430871436*^9},ExpressionUUID->"bcb84637-decb-49f1-b131-\
ecc12403ffa5"]
}, Closed]],

Cell["Update History (MHD-related only)", "Subsubsection",
 CellChangeTimes->{{3.6712939383165674`*^9, 3.6712939602890015`*^9}, {
  3.6713264163476667`*^9, 3.671326425672784*^9}, {3.6721489369921913`*^9, 
  3.6721489484272118`*^9}},ExpressionUUID->"fa2a8b50-6d07-47f6-b1be-\
2e88a8613a2e"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Protect", "Section",
 CellChangeTimes->{{3.52035689815625*^9, 
  3.5203569071875*^9}},ExpressionUUID->"d17ead81-6517-42ab-898c-9f79ba651411"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Protect", " ", "these", " ", "symbols", " ", "so", " ", "they", " ", 
    "cannot", " ", "be", " ", "altered"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Protect", "[", 
    RowBox[{
    "Del", ",", "SubMinus", ",", "SuperMinus", ",", "Tensor", ",", 
     "TensorType", ",", "TensorName", ",", "Indices", ",", "Metric", ",", 
     "Riemann", ",", "Weyl", ",", "Ricci", ",", "RicciScalar", ",", 
     "Einstein", ",", "Coordinates", ",", "Coordinates", ",", 
     "TensorComponents", ",", "RiemannComponents", ",", "RicciComponents", 
     ",", "Christoffel", ",", "RicciScalarInvariant", ",", 
     "ChristoffelComponents", ",", "StartIndex", ",", "Determinant", ",", 
     "MetricDeterminant", ",", "TooltipDisplay", ",", "ChristoffelOperator", 
     ",", "RiemannOperator", ",", "RicciOperator", ",", "RicciScalarOperator",
      ",", "EinsteinOperator", ",", "WeylOperator", ",", "CovariantBox", ",", 
     "CoordinateTransformation", ",", "GradientSquared", ",", "CovariantD", 
     ",", "PartialD", ",", "SwapIndices", ",", "UnderBar", ",", "ZeroTensorQ",
      ",", "NonMetricTensor", ",", "MoveIndices", ",", "LeviCivita", ",", 
     "RaiseAllIndices", ",", "LowerAllIndices", ",", "UniqueIndices", ",", 
     "CovariantHodgeDual", ",", "GeodesicSystem", ",", "GeodesicLagrangians", 
     ",", "GeodesicHamiltonianDynamics", ",", "AffineParameter", ",", 
     "NonAffineParameter", ",", "LieD", ",", "MHDSystem", ",", 
     "MHDScalarFunction1", ",", "MHDScalarFunction2", ",", 
     "MHDScalarFunction3", ",", "MHD1FormTensor1", ",", "MHD1FormTensor2", 
     ",", "MHD1FormTensor3", ",", "MHD3Form", ",", "MHDMaxwellTensor", ",", 
     "MHDPlasmaCurrentTensor", ",", "MHDRank2PTensor", ",", 
     "MHDMaxwellCurrent", ",", "MHDEquations", ",", "MHDEquationsList", ",", 
     "MHDMetricTensor", ",", "MHDScalar", ",", "MHD3Form", ",", 
     "MHDPlasmaCurrent", ",", "MHDMaxwell", ",", "MHDMaxwellCurrent", ",", 
     "MHDMaxwellStressTensor", ",", "MHDPlasmaStressTensor", ",", "MHDRank2P",
      ",", "MHDEnergyMomentumShearStress", ",", "MHDMetric", ",", 
     "MHDOperator", ",", "MetricSignature", ",", "MHDTotalStressTensor", ",", 
     "MHDLagrangian", ",", "MHDLagrangianDensity", ",", 
     "MHDPlasmaEnergyDensityOperator", ",", "MHDPlasmaEnergyDensity", ",", 
     "CoordinateTransformationOperator", ",", "SymmetrizeIndices", ",", 
     "AntiSymmetrizeIndices", ",", "SymmetrizeIndicesOperator", ",", 
     "AntiSymmetrizeIndicesOperator", ",", "ExteriorD", ",", "MetricOperator",
      ",", "LieDerivativeOperator", ",", "TensorEquations", ",", 
     "OrthonormalFrameField", ",", "OrthonormalFrameFieldOperator", ",", 
     "InverseOrthonormalFrameField", ",", "FlatMetric", ",", 
     "OrthonormalFrameFieldQ", ",", "OrthonormalFrameFieldIndices", ",", 
     "OrthonormalBasis", ",", "CoordinateBasis", ",", "LieBracket", ",", 
     "LieBracketOperator", ",", "PotentialForm", ",", "ExpressionForm", ",", 
     "OperatorProductRule", ",", "VectorSphericalHarmonic", ",", 
     "SphericalHarmonicYTensor", ",", "TensorAssumption", ",", 
     "ZeroTensorQOperator", ",", "TensorOperator", ",", "TensorDivision", ",",
      "TensorDivisionOperator", ",", "TensorComponentsManipulation", ",", 
     "InteriorProduct", ",", "\[Iota]", ",", "\[Sterling]", ",", 
     "WedgeExpand", ",", "ToTensorComponents", ",", "LT", ",", 
     "TensorsProduct", ",", "ContractTensors", ",", "OperatorNullList", ",", 
     "OperatorDistributeOverPlus", ",", "OperatorExpansion", ",", 
     "OperatorFactorOutScalar", ",", "OperatorRemoveSingleComponentList", ",",
      "OperatorThreadThroughFunction", ",", "OperatorTensorReturnItself", ",",
      "OperatorExpressionFormReturnItself", ",", "OperatorTensorsProduct", 
     ",", "OperatorContractThroughFunction", ",", "OutputBecomesOneTensor", 
     ",", "OperatorThreadThroughTimes", ",", "FullyAntiSymmetricTensorQ", ",",
      "ExtractFunction", ",", "EndowFunction", ",", "OperatorDistribute", ",",
      "StartingPoint", ",", "IntegrationVariable"}], "]"}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.520356911703125*^9, 3.520356939078125*^9}, {
   3.52037580859375*^9, 3.52037581165625*^9}, {3.520376122796875*^9, 
   3.5203761244375*^9}, {3.520699927546875*^9, 3.520699927734375*^9}, 
   3.52081566028125*^9, {3.520899516171875*^9, 3.520899525640625*^9}, 
   3.520957431171875*^9, {3.521140471609375*^9, 3.52114047246875*^9}, {
   3.521146855359375*^9, 3.521146855984375*^9}, {3.521484919640625*^9, 
   3.521484940328125*^9}, {3.52157286365625*^9, 3.521572871984375*^9}, {
   3.52167432159375*^9, 3.521674326078125*^9}, {3.521703057234375*^9, 
   3.521703062015625*^9}, {3.52176542053125*^9, 3.52176542484375*^9}, {
   3.521785377328125*^9, 3.52178537815625*^9}, {3.52191031628125*^9, 
   3.52191034603125*^9}, {3.521953610078125*^9, 3.52195362115625*^9}, {
   3.533879988501708*^9, 3.5338799892817097`*^9}, {3.539461489280633*^9, 
   3.539461490232235*^9}, {3.5395513992984557`*^9, 3.539551399516856*^9}, {
   3.5395519776382713`*^9, 3.539552003893118*^9}, {3.539552268797183*^9, 
   3.539552272322789*^9}, {3.5395532365247307`*^9, 3.539553331809698*^9}, {
   3.5396154436038017`*^9, 3.5396154960042934`*^9}, {3.5402290068331127`*^9, 
   3.5402290102463083`*^9}, {3.5406985277983303`*^9, 
   3.5406985281883307`*^9}, {3.5760907158352337`*^9, 
   3.5760907185184383`*^9}, {3.576687280878089*^9, 3.57668728159569*^9}, {
   3.583790277252267*^9, 3.5837902779843087`*^9}, {3.6064384556351647`*^9, 
   3.6064384881380234`*^9}, {3.6064924309585853`*^9, 3.606492431618623*^9}, {
   3.606497508680014*^9, 3.6064975088930264`*^9}, {3.606513221090252*^9, 
   3.6065132216902857`*^9}, {3.6065760339903374`*^9, 3.606576034193349*^9}, {
   3.629478603100625*^9, 3.629478626380658*^9}, {3.6296663229592495`*^9, 
   3.629666326328855*^9}, {3.629696760563964*^9, 3.6296967675527763`*^9}, {
   3.6296976663093657`*^9, 3.6296976670425673`*^9}, {3.6297631265948153`*^9, 
   3.6297631388202496`*^9}, {3.6297635844679832`*^9, 3.629763585235385*^9}, {
   3.6299090675704484`*^9, 3.6299090680540495`*^9}, {3.6299342624573455`*^9, 
   3.629934268962557*^9}, {3.6299364112776365`*^9, 3.6299364121668377`*^9}, {
   3.6299366310350633`*^9, 3.6299366312116632`*^9}, {3.6302034053695235`*^9, 
   3.6302034062743254`*^9}, {3.669530992945468*^9, 3.6695309939064693`*^9}, {
   3.6695800175107813`*^9, 3.6695800184418344`*^9}, {3.6695940476889696`*^9, 
   3.6695940633728666`*^9}, {3.669838492931531*^9, 3.6698384945715337`*^9}, {
   3.671902272456382*^9, 3.6719022733059864`*^9}, {3.6719860723750825`*^9, 
   3.671986073131384*^9}, {3.6719949713687606`*^9, 3.6719949722788124`*^9}, {
   3.6719973595523567`*^9, 3.671997361245454*^9}, {3.671997550033252*^9, 
   3.671997550610285*^9}, {3.6720581366640635`*^9, 3.6720581374040747`*^9}, {
   3.6720599736112814`*^9, 3.6720599762688217`*^9}, 3.672157546020041*^9, {
   3.6721575964558153`*^9, 3.6721576156536107`*^9}, {3.672260840212137*^9, 
   3.6722608787223396`*^9}, 3.672260910619164*^9, {3.7181780642427597`*^9, 
   3.7181780784909678`*^9}, {3.718874200752311*^9, 3.7188742173283567`*^9}, {
   3.7277848911209745`*^9, 3.727784895767605*^9}, {3.7277921643882694`*^9, 
   3.72779216544811*^9}, {3.7810030413514233`*^9, 3.781003041579853*^9}, {
   3.79624487928796*^9, 3.7962448925002203`*^9}, {3.847243670754033*^9, 
   3.847243727826871*^9}, {3.847244443564865*^9, 3.8472444569099393`*^9}, {
   3.847249828209492*^9, 3.8472498312985916`*^9}, {3.847772671690015*^9, 
   3.8477726721887083`*^9}, {3.8478470585242147`*^9, 
   3.8478470639570103`*^9}, {3.848443340922896*^9, 3.8484433477978897`*^9}, {
   3.854160542414827*^9, 3.854160592264306*^9}, {3.859455378584504*^9, 
   3.8594553787935033`*^9}, {3.8594561661279883`*^9, 3.859456166281991*^9}, {
   3.859462504833667*^9, 3.859462504979822*^9}, {3.859510531307102*^9, 
   3.8595105314680033`*^9}, {3.8596008094352922`*^9, 3.85960080960419*^9}, {
   3.8601115113062525`*^9, 3.860111511431246*^9}, {3.8613321769586673`*^9, 
   3.861332177159543*^9}, {3.861769009402819*^9, 3.861769010402789*^9}, {
   3.8617690539297705`*^9, 3.8617690540860167`*^9}, {3.865120028476678*^9, 
   3.865120034070427*^9}, {3.8667159797900667`*^9, 3.866715979959731*^9}, {
   3.8667179820251565`*^9, 3.866717982228299*^9}, {3.86732818184883*^9, 
   3.8673281865408187`*^9}, {3.8691360186010585`*^9, 
   3.8691360186529503`*^9}, {3.872656577389273*^9, 3.8726565890320826`*^9}, {
   3.884215044808009*^9, 3.8842150449779067`*^9}, {3.8847705336736712`*^9, 
   3.8847705338115892`*^9}, {3.885376785871662*^9, 3.8853767860395594`*^9}, {
   3.8854233879288464`*^9, 3.885423388176694*^9}, {3.886570632623369*^9, 
   3.886570632801259*^9}, 3.886734689048409*^9, {3.886734810889494*^9, 
   3.8867348277858367`*^9}, {3.886738118345416*^9, 3.886738118499323*^9}, {
   3.8871125519368224`*^9, 3.887112555369953*^9}, {3.887116691341601*^9, 
   3.8871166915584683`*^9}, {3.887159828673361*^9, 3.887159828841333*^9}, {
   3.8901933781588116`*^9, 3.8901933787120004`*^9}, {3.8920080790424757`*^9, 
   3.8920080794532223`*^9}, {3.8920093644018335`*^9, 
   3.8920093648665447`*^9}, {3.8947758232574096`*^9, 
   3.8947758391568317`*^9}, {3.8947764224629583`*^9, 
   3.8947764225924454`*^9}, {3.8950717614051323`*^9, 3.8950717621394873`*^9}, 
   3.895073261803241*^9, {3.8950746894229045`*^9, 3.895074689626025*^9}, 
   3.8955429293076878`*^9, 3.8955490521520815`*^9, {3.8955540100484104`*^9, 
   3.8955540442742033`*^9}, {3.898754489212411*^9, 3.898754532448866*^9}, {
   3.899377413899913*^9, 3.8993774263712397`*^9}, 3.956199042660884*^9, 
   3.959934291072364*^9, {3.960454433247295*^9, 3.960454451172078*^9}, {
   3.960456975993146*^9, 3.960456990799554*^9}, {3.960511906571973*^9, 
   3.960511906573244*^9}, {3.96093968938982*^9, 3.960939694737831*^9}, 
   3.9677774528141165`*^9, {3.971087543092537*^9, 3.971087543508638*^9}, 
   3.9710876756677437`*^9, {3.9711461803153048`*^9, 3.9711461804338408`*^9}, {
   3.971229999605974*^9, 3.9712299997724752`*^9}, {3.9712557973073483`*^9, 
   3.971255797468917*^9}, {3.971821626033555*^9, 3.971821628065401*^9}, {
   3.972378066349977*^9, 3.9723780733033447`*^9}, 3.972466463415584*^9, 
   3.973221400492136*^9, {3.973222846864442*^9, 3.973222847027501*^9}, {
   3.973222893005103*^9, 3.9732228949725924`*^9}, {3.973764487168847*^9, 
   3.9737644981547117`*^9}, 3.973765345383815*^9, {3.973765491942573*^9, 
   3.9737655642279873`*^9}, 3.975293093355671*^9, 3.9753017310657096`*^9, 
   3.975301840187524*^9, {3.975314744143017*^9, 
   3.975314774554194*^9}},ExpressionUUID->"58c44fd8-6e68-433c-af38-\
a80fd733c7fa"]
}, Closed]],

Cell[CellGroupData[{

Cell["End", "Section",
 CellChangeTimes->{{3.52030332671875*^9, 
  3.5203033341875*^9}},ExpressionUUID->"f22bca56-27ec-41a4-b3d0-6ec3bb235ca7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.518287025359375*^9, 3.518287083796875*^9}, {
   3.518287204515625*^9, 3.518287246046875*^9}, {3.518288154015625*^9, 
   3.518288179625*^9}, {3.5196834121875*^9, 3.519683417953125*^9}, {
   3.519689356625*^9, 3.519689356921875*^9}, {3.51976580715625*^9, 
   3.519765810671875*^9}, {3.519963432453125*^9, 3.519963433953125*^9}, 
   3.520125837828125*^9, {3.5201289498125*^9, 3.5201289504375*^9}, 
   3.520219859578125*^9, 3.5202268538125*^9, {3.52027377246875*^9, 
   3.520273831296875*^9}, {3.5202738760625*^9, 3.52027388446875*^9}, {
   3.5202739371875*^9, 3.5202741019375*^9}, {3.52027416353125*^9, 
   3.520274167671875*^9}, 3.520274919453125*^9, {3.52027495775*^9, 
   3.52027500990625*^9}, {3.520275109328125*^9, 3.52027513640625*^9}, {
   3.520275352625*^9, 3.520275353015625*^9}, {3.52027552415625*^9, 
   3.5202755711875*^9}, 3.520275790296875*^9, {3.5202759311875*^9, 
   3.520275948625*^9}, {3.520276746125*^9, 3.5202767880625*^9}, {
   3.52027692378125*^9, 3.52027700428125*^9}, {3.520277061046875*^9, 
   3.520277097125*^9}, {3.520277138046875*^9, 3.520277203125*^9}, {
   3.52027851596875*^9, 3.520278524*^9}, {3.52027856384375*^9, 
   3.520278653328125*^9}, 3.5202787563125*^9, {3.520279456296875*^9, 
   3.5202794635625*^9}, {3.520279561640625*^9, 3.520279567359375*^9}, {
   3.52028006315625*^9, 3.520280068671875*^9}, {3.5202804206875*^9, 
   3.520280495234375*^9}, 3.520281272765625*^9, {3.52028149878125*^9, 
   3.5202815018125*^9}, {3.520281674421875*^9, 3.5202816786875*^9}, {
   3.520281727390625*^9, 3.520281730375*^9}, 3.52028190265625*^9, {
   3.52028213190625*^9, 3.520282169640625*^9}, {3.520282364859375*^9, 
   3.520282395859375*^9}, {3.520282483109375*^9, 3.520282499046875*^9}, {
   3.52028567246875*^9, 3.520285695984375*^9}, {3.5202857606875*^9, 
   3.520285762578125*^9}, {3.520285792890625*^9, 3.520285807109375*^9}, {
   3.5202858616875*^9, 3.52028586721875*^9}, {3.520286964859375*^9, 
   3.520286985015625*^9}, {3.52028713909375*^9, 3.520287168453125*^9}, {
   3.52030002590625*^9, 3.520300043171875*^9}, {3.520300760625*^9, 
   3.520300806765625*^9}, {3.52030106778125*^9, 3.520301101625*^9}, {
   3.520301143203125*^9, 3.520301143921875*^9}, {3.520301203140625*^9, 
   3.520301219734375*^9}, {3.520301382671875*^9, 3.520301408375*^9}, {
   3.5203015531875*^9, 3.520301561859375*^9}, {3.52030160309375*^9, 
   3.52030162021875*^9}, {3.520301674546875*^9, 3.520301675078125*^9}, 
   3.520301885265625*^9, {3.52030235646875*^9, 3.5203024485*^9}, {
   3.52030252584375*^9, 3.520302587984375*^9}, {3.520302792015625*^9, 
   3.520302959515625*^9}, {3.520303101875*^9, 3.520303107296875*^9}, {
   3.520303238609375*^9, 3.52030324271875*^9}, {3.520303299859375*^9, 
   3.520303323609375*^9}},ExpressionUUID->"50fbc756-37bb-453f-b324-\
c5e8338f1c6b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Update History", "Section",
 CellChangeTimes->{{3.5391952096336904`*^9, 3.539195218704503*^9}, {
  3.5396343987731066`*^9, 3.539634400089182*^9}, {3.5396612373985376`*^9, 
  3.5396612378197384`*^9}},ExpressionUUID->"a02fac61-8b82-4c6d-8ef1-\
5122ad80d48b"],

Cell[TextData[{
 StyleBox["Feb 2012: \n",
  FontWeight->"Bold"],
 "\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": The function Metric is extended to allow the user to input a Tensor \
object of TensorType \[Rule] \[OpenCurlyDoubleQuote]Metric\
\[CloseCurlyDoubleQuote]. Metric returns the same object with \
TensorComponents \[LongDash] depending on the input indices \[LongDash] \
representing either the metric, inverse metric, or the identity. In other \
words, TensoriaCalc now allow raising and lowering of the indices of Tensor \
objects of TensorType \[Rule] \[OpenCurlyDoubleQuote]Metric\
\[CloseCurlyDoubleQuote].\n\t\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Previously, the metric can only be entered as a List (i.e. a matrix). The \
function Metric is extended to allow the metric to be entered as an \
expression quadratic in the differentials of the coordinates. For example, \
{{1,0},{0,",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["r", "2"], TraditionalForm]],ExpressionUUID->
  "dbac4c17-310d-4391-a645-ee19708ca63d"],
 "}} or ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[DifferentialD]", 
     SuperscriptBox["r", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["r", "2"], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["\[Phi]", "2"]}]}]}], TraditionalForm]],ExpressionUUID->
  "6fc1e950-549e-497a-bb68-21af29ee14f6"],
 ", with Coordinates \[Rule] {",
 Cell[BoxData[
  FormBox["r", TraditionalForm]],ExpressionUUID->
  "d63e3ffe-05a2-4e71-a93f-8ba08dda0c4b"],
 ",\[Phi]}, are both valid ways to enter the metric of the Euclidean 2-space."
}], "Text",
 CellChangeTimes->{{3.5391952254569125`*^9, 3.539195640163097*^9}, {
   3.53955006359291*^9, 3.5395501346978345`*^9}, {3.5395501670990915`*^9, 
   3.539550390631884*^9}, {3.539551751874675*^9, 3.5395517613906918`*^9}, {
   3.539552377154973*^9, 3.539552451910304*^9}, {3.5396155207615376`*^9, 
   3.539615524739544*^9}, {3.5396155883252563`*^9, 3.5396156250342236`*^9}, {
   3.539634404087411*^9, 3.539634467948063*^9}, {3.539658702983876*^9, 
   3.53965871095549*^9}, {3.5396612431081476`*^9, 3.5396615769538345`*^9}, {
   3.5396616172225056`*^9, 3.539661649976963*^9}, {3.5398821994892073`*^9, 
   3.539882248779027*^9}, {3.5402291264969573`*^9, 3.5402291273160043`*^9}, {
   3.5468019316783457`*^9, 3.5468019713180156`*^9}, 3.5468020013948684`*^9, {
   3.576090752245698*^9, 3.5760908187330146`*^9}, {3.5760908545506773`*^9, 
   3.5760910170873632`*^9}, {3.5766872960881157`*^9, 3.576687366272639*^9}, {
   3.5837902958813324`*^9, 3.583790362004114*^9}, {3.585772227618986*^9, 
   3.5857723766460485`*^9}, {3.5857724160361176`*^9, 
   3.5857724217457275`*^9}, {3.585772487733843*^9, 3.585772597526836*^9}, {
   3.594234069677395*^9, 3.5942342865307264`*^9}, {3.594236245769825*^9, 
   3.594236403751252*^9}, {3.594236439967308*^9, 3.594236444402377*^9}, {
   3.5965848885218115`*^9, 3.5965851829879284`*^9}, {3.6064477129242563`*^9, 
   3.6064477170244904`*^9}, {3.6067643878025208`*^9, 
   3.6067645104187365`*^9}, {3.606764548030402*^9, 3.606764590602877*^9}, {
   3.609613720173603*^9, 3.6096137267880154`*^9}, {3.6096137886421237`*^9, 
   3.6096138439442205`*^9}, {3.6096139013367214`*^9, 3.609614191778032*^9}, {
   3.609614236846511*^9, 3.609614244334524*^9}, {3.609614445075677*^9, 
   3.6096144489912834`*^9}, {3.6294786490906897`*^9, 
   3.6294787833808775`*^9}, {3.62947881355092*^9, 3.629478818390927*^9}, {
   3.629479785061555*^9, 3.6294797863715563`*^9}, {3.629562542055464*^9, 
   3.6295625440532675`*^9}, {3.629563179524299*^9, 3.6295632164805703`*^9}, {
   3.6295634770856667`*^9, 3.6295634800078716`*^9}, {3.6295635962982955`*^9, 
   3.6295636268611546`*^9}, {3.6295636988918905`*^9, 
   3.6295637168753257`*^9}, {3.6295643246241803`*^9, 3.629564327174985*^9}, {
   3.6295643802052975`*^9, 3.6295643943321285`*^9}, 3.62956444018983*^9, {
   3.6295645910583153`*^9, 3.629564616309367*^9}, {3.629564793949936*^9, 
   3.6295648281644125`*^9}, {3.6295665105709906`*^9, 3.629566527426426*^9}, {
   3.6295667402196894`*^9, 3.6295667804318533`*^9}, {3.6295668168915315`*^9, 
   3.629566842207182*^9}, {3.629566877352854*^9, 3.6295668923634853`*^9}, {
   3.6295669401405888`*^9, 3.629566958360826*^9}, {3.6295676927117987`*^9, 
   3.6295677768997583`*^9}, {3.6295678947547846`*^9, 3.629567999329583*^9}, {
   3.6295822987213025`*^9, 3.6295823643752356`*^9}, {3.6295824139493294`*^9, 
   3.6295826420773797`*^9}, {3.629603441693468*^9, 3.6296037548778596`*^9}, {
   3.629607699840618*^9, 3.62960775507927*^9}, {3.629609623367103*^9, 
   3.6296096457134447`*^9}, {3.629611118868438*^9, 3.629611222099281*^9}, {
   3.6296966526365733`*^9, 3.629696692941445*^9}, {3.6297636071580486`*^9, 
   3.629763693559885*^9}, {3.629822036569414*^9, 3.6298220397694197`*^9}, {
   3.629822086093307*^9, 3.6298221023857403`*^9}, {3.6298221675296617`*^9, 
   3.6298221905345078`*^9}, {3.6298257059366274`*^9, 
   3.6298257837814646`*^9}, {3.6298259014543715`*^9, 3.629825999218544*^9}, {
   3.6298260411408176`*^9, 3.6298261482132063`*^9}, {3.6298266422494926`*^9, 
   3.6298266581016207`*^9}, {3.6298267861248455`*^9, 3.629826875894903*^9}, {
   3.62982690822066*^9, 3.6298271407473702`*^9}, {3.629827195279466*^9, 
   3.629827206545186*^9}, 3.6298272545121703`*^9, {3.6298273159494786`*^9, 
   3.629827323000691*^9}, {3.629827524644846*^9, 3.629827540043973*^9}, {
   3.629843695864236*^9, 3.629843768112363*^9}, {3.6298438969973907`*^9, 
   3.629843902972201*^9}, {3.6298448016472807`*^9, 3.629844837095543*^9}, {
   3.62985840203149*^9, 3.629858493510722*^9}, {3.6298657414582825`*^9, 
   3.6298657501879444`*^9}, {3.629909079007269*^9, 3.6299091181965375`*^9}, {
   3.6299263757686844`*^9, 3.6299264772814417`*^9}, {3.629929867859521*^9, 
   3.6299298729451303`*^9}, {3.6299342834705825`*^9, 
   3.6299343177282424`*^9}, {3.629938461994429*^9, 3.629938470512044*^9}, {
   3.62999370915497*^9, 3.629993709357771*^9}, 3.6299937861556067`*^9, 
   3.629993859254936*^9, {3.630203492255678*^9, 3.6302036679861917`*^9}, {
   3.630203700803055*^9, 3.6302037242280965`*^9}, {3.6303300486200323`*^9, 
   3.6303300997039537`*^9}, {3.630434289440716*^9, 3.6304344590808215`*^9}, {
   3.63063870239233*^9, 3.6306387057726374`*^9}, {3.6306914969265156`*^9, 
   3.630691522836998*^9}, {3.6306963776461215`*^9, 3.6306965559231014`*^9}, {
   3.630696629480076*^9, 3.630696650329111*^9}, {3.6306967646614947`*^9, 
   3.630696807987544*^9}, {3.6309870350982666`*^9, 3.630987055946305*^9}, {
   3.6326180036776175`*^9, 3.632618041000888*^9}, {3.633650773200718*^9, 
   3.633650875407123*^9}, {3.6695150914329014`*^9, 3.6695151469969916`*^9}, {
   3.6695340689888253`*^9, 3.669534103324486*^9}, {3.6695800385699854`*^9, 
   3.669580068158678*^9}, {3.6695801069818983`*^9, 3.6695801073199177`*^9}, {
   3.6697710716437035`*^9, 3.66977109395998*^9}, {3.669771129469011*^9, 
   3.669771147322032*^9}, {3.669771240047613*^9, 3.669771248967632*^9}, {
   3.6697712917597027`*^9, 3.669771304845722*^9}, {3.6698286373379354`*^9, 
   3.669828712054674*^9}, {3.6698397290864587`*^9, 3.6698397551453114`*^9}, {
   3.6698435572376857`*^9, 3.6698435867013707`*^9}, {3.671900284442581*^9, 
   3.6719003563897057`*^9}, {3.6719006947896194`*^9, 
   3.6719006963716235`*^9}, {3.671902989907487*^9, 3.671903150700734*^9}, {
   3.6719085682754197`*^9, 3.6719085691247215`*^9}, {3.67190902094978*^9, 
   3.671909022967884*^9}, {3.6719090611001635`*^9, 3.671909061869565*^9}, {
   3.6719095357905307`*^9, 3.6719095646735964`*^9}, {3.671909607961093*^9, 
   3.671909640559662*^9}, {3.6719096720568495`*^9, 3.6719096753777604`*^9}, {
   3.67190987991696*^9, 3.671909897029999*^9}, {3.671994989288786*^9, 
   3.671995084358223*^9}, {3.671995566580805*^9, 3.6719955978665943`*^9}, {
   3.672059857739501*^9, 3.6720598617095623`*^9}, {3.6720752906433525`*^9, 
   3.672075293958542*^9}, {3.6720753292375593`*^9, 3.6720753822145896`*^9}, {
   3.6720754410259533`*^9, 3.6720755069357233`*^9}, {3.6720827910149236`*^9, 
   3.6720828354681063`*^9}, {3.6721496951806993`*^9, 3.672149698950706*^9}, 
   3.9677774528215866`*^9},ExpressionUUID->"7a2153af-e443-461d-adf3-\
be30f252d6d1"],

Cell[TextData[{
 StyleBox["March 2012\n",
  FontWeight->"Bold"],
 "\n",
 StyleBox["Bug fix",
  FontSlant->"Italic"],
 ": RaiseLower, the function within TensoriaCalc that plays a key role in \
raising and lowering indices of Tensor objects, now takes into account both \
metrics and inverse metric when reading in a Tensor object of TensorType \
\[Rule] \"Metric\". Previously it had assumed all such objects had \
TensorComponents with lower indices, i.e., all were metrics and not inverse \
metrics."
}], "Text",
 CellChangeTimes->{{3.5391952254569125`*^9, 3.539195640163097*^9}, {
   3.53955006359291*^9, 3.5395501346978345`*^9}, {3.5395501670990915`*^9, 
   3.539550390631884*^9}, {3.539551751874675*^9, 3.5395517613906918`*^9}, {
   3.539552377154973*^9, 3.539552451910304*^9}, {3.5396155207615376`*^9, 
   3.539615524739544*^9}, {3.5396155883252563`*^9, 3.5396156250342236`*^9}, {
   3.539634404087411*^9, 3.539634467948063*^9}, {3.539658702983876*^9, 
   3.53965871095549*^9}, {3.5396612431081476`*^9, 3.5396615769538345`*^9}, {
   3.5396616172225056`*^9, 3.539661649976963*^9}, {3.5398821994892073`*^9, 
   3.539882248779027*^9}, {3.5402291264969573`*^9, 3.5402291273160043`*^9}, {
   3.5468019316783457`*^9, 3.5468019713180156`*^9}, 3.5468020013948684`*^9, {
   3.576090752245698*^9, 3.5760908187330146`*^9}, {3.5760908545506773`*^9, 
   3.5760910170873632`*^9}, {3.5766872960881157`*^9, 3.576687366272639*^9}, {
   3.5837902958813324`*^9, 3.583790362004114*^9}, {3.585772227618986*^9, 
   3.5857723766460485`*^9}, {3.5857724160361176`*^9, 
   3.5857724217457275`*^9}, {3.585772487733843*^9, 3.585772597526836*^9}, {
   3.594234069677395*^9, 3.5942342865307264`*^9}, {3.594236245769825*^9, 
   3.594236403751252*^9}, {3.594236439967308*^9, 3.594236444402377*^9}, {
   3.5965848885218115`*^9, 3.5965851829879284`*^9}, {3.6064477129242563`*^9, 
   3.6064477170244904`*^9}, {3.6067643878025208`*^9, 
   3.6067645104187365`*^9}, {3.606764548030402*^9, 3.606764590602877*^9}, {
   3.609613720173603*^9, 3.6096137267880154`*^9}, {3.6096137886421237`*^9, 
   3.6096138439442205`*^9}, {3.6096139013367214`*^9, 3.609614191778032*^9}, {
   3.609614236846511*^9, 3.609614244334524*^9}, {3.609614445075677*^9, 
   3.6096144489912834`*^9}, {3.6294786490906897`*^9, 
   3.6294787833808775`*^9}, {3.62947881355092*^9, 3.629478818390927*^9}, {
   3.629479785061555*^9, 3.6294797863715563`*^9}, {3.629562542055464*^9, 
   3.6295625440532675`*^9}, {3.629563179524299*^9, 3.6295632164805703`*^9}, {
   3.6295634770856667`*^9, 3.6295634800078716`*^9}, {3.6295635962982955`*^9, 
   3.6295636268611546`*^9}, {3.6295636988918905`*^9, 
   3.6295637168753257`*^9}, {3.6295643246241803`*^9, 3.629564327174985*^9}, {
   3.6295643802052975`*^9, 3.6295643943321285`*^9}, 3.62956444018983*^9, {
   3.6295645910583153`*^9, 3.629564616309367*^9}, {3.629564793949936*^9, 
   3.6295648281644125`*^9}, {3.6295665105709906`*^9, 3.629566527426426*^9}, {
   3.6295667402196894`*^9, 3.6295667804318533`*^9}, {3.6295668168915315`*^9, 
   3.629566842207182*^9}, {3.629566877352854*^9, 3.6295668923634853`*^9}, {
   3.6295669401405888`*^9, 3.629566958360826*^9}, {3.6295676927117987`*^9, 
   3.6295677768997583`*^9}, {3.6295678947547846`*^9, 3.629567999329583*^9}, {
   3.6295822987213025`*^9, 3.6295823643752356`*^9}, {3.6295824139493294`*^9, 
   3.6295826420773797`*^9}, {3.629603441693468*^9, 3.6296037548778596`*^9}, {
   3.629607699840618*^9, 3.62960775507927*^9}, {3.629609623367103*^9, 
   3.6296096457134447`*^9}, {3.629611118868438*^9, 3.629611222099281*^9}, {
   3.6296966526365733`*^9, 3.629696692941445*^9}, {3.6297636071580486`*^9, 
   3.629763693559885*^9}, {3.629822036569414*^9, 3.6298220397694197`*^9}, {
   3.629822086093307*^9, 3.6298221023857403`*^9}, {3.6298221675296617`*^9, 
   3.6298221905345078`*^9}, {3.6298257059366274`*^9, 
   3.6298257837814646`*^9}, {3.6298259014543715`*^9, 3.629825999218544*^9}, {
   3.6298260411408176`*^9, 3.6298261482132063`*^9}, {3.6298266422494926`*^9, 
   3.6298266581016207`*^9}, {3.6298267861248455`*^9, 3.629826875894903*^9}, {
   3.62982690822066*^9, 3.6298271407473702`*^9}, {3.629827195279466*^9, 
   3.629827206545186*^9}, 3.6298272545121703`*^9, {3.6298273159494786`*^9, 
   3.629827323000691*^9}, {3.629827524644846*^9, 3.629827540043973*^9}, {
   3.629843695864236*^9, 3.629843768112363*^9}, {3.6298438969973907`*^9, 
   3.629843902972201*^9}, {3.6298448016472807`*^9, 3.629844837095543*^9}, {
   3.62985840203149*^9, 3.629858493510722*^9}, {3.6298657414582825`*^9, 
   3.6298657501879444`*^9}, {3.629909079007269*^9, 3.6299091181965375`*^9}, {
   3.6299263757686844`*^9, 3.6299264772814417`*^9}, {3.629929867859521*^9, 
   3.6299298729451303`*^9}, {3.6299342834705825`*^9, 
   3.6299343177282424`*^9}, {3.629938461994429*^9, 3.629938470512044*^9}, {
   3.62999370915497*^9, 3.629993709357771*^9}, 3.6299937861556067`*^9, 
   3.629993859254936*^9, {3.630203492255678*^9, 3.6302036679861917`*^9}, {
   3.630203700803055*^9, 3.6302037242280965`*^9}, {3.6303300486200323`*^9, 
   3.6303300997039537`*^9}, {3.630434289440716*^9, 3.6304344590808215`*^9}, {
   3.63063870239233*^9, 3.6306387057726374`*^9}, {3.6306914969265156`*^9, 
   3.630691522836998*^9}, {3.6306963776461215`*^9, 3.6306965559231014`*^9}, {
   3.630696629480076*^9, 3.630696650329111*^9}, {3.6306967646614947`*^9, 
   3.630696807987544*^9}, {3.6309870350982666`*^9, 3.630987055946305*^9}, {
   3.6326180036776175`*^9, 3.632618041000888*^9}, {3.633650773200718*^9, 
   3.633650875407123*^9}, {3.6695150914329014`*^9, 3.6695151469969916`*^9}, {
   3.6695340689888253`*^9, 3.669534103324486*^9}, {3.6695800385699854`*^9, 
   3.669580068158678*^9}, {3.6695801069818983`*^9, 3.6695801073199177`*^9}, {
   3.6697710716437035`*^9, 3.66977109395998*^9}, {3.669771129469011*^9, 
   3.669771147322032*^9}, {3.669771240047613*^9, 3.669771248967632*^9}, {
   3.6697712917597027`*^9, 3.669771304845722*^9}, {3.6698286373379354`*^9, 
   3.669828712054674*^9}, {3.6698397290864587`*^9, 3.6698397551453114`*^9}, {
   3.6698435572376857`*^9, 3.6698435867013707`*^9}, {3.671900284442581*^9, 
   3.6719003563897057`*^9}, {3.6719006947896194`*^9, 
   3.6719006963716235`*^9}, {3.671902989907487*^9, 3.671903150700734*^9}, {
   3.6719085682754197`*^9, 3.6719085691247215`*^9}, {3.67190902094978*^9, 
   3.671909022967884*^9}, {3.6719090611001635`*^9, 3.671909061869565*^9}, {
   3.6719095357905307`*^9, 3.6719095646735964`*^9}, {3.671909607961093*^9, 
   3.671909640559662*^9}, {3.6719096720568495`*^9, 3.6719096753777604`*^9}, {
   3.67190987991696*^9, 3.671909897029999*^9}, {3.671994989288786*^9, 
   3.671995084358223*^9}, {3.671995566580805*^9, 3.6719955978665943`*^9}, {
   3.672059857739501*^9, 3.6720598617095623`*^9}, {3.6720752906433525`*^9, 
   3.672075293958542*^9}, {3.6720753292375593`*^9, 3.6720753822145896`*^9}, {
   3.6720754410259533`*^9, 3.6720755069357233`*^9}, {3.6720827910149236`*^9, 
   3.6720828354681063`*^9}, {3.6721496951806993`*^9, 
   3.672149706753219*^9}},ExpressionUUID->"420ff4cf-d2c1-45e8-9544-\
523fe8e60a7e"],

Cell[TextData[{
 StyleBox["May 2012\n",
  FontWeight->"Bold"],
 "\t\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Added section \"Geometric Objects: Definitions\"."
}], "Text",
 CellChangeTimes->{{3.5391952254569125`*^9, 3.539195640163097*^9}, {
   3.53955006359291*^9, 3.5395501346978345`*^9}, {3.5395501670990915`*^9, 
   3.539550390631884*^9}, {3.539551751874675*^9, 3.5395517613906918`*^9}, {
   3.539552377154973*^9, 3.539552451910304*^9}, {3.5396155207615376`*^9, 
   3.539615524739544*^9}, {3.5396155883252563`*^9, 3.5396156250342236`*^9}, {
   3.539634404087411*^9, 3.539634467948063*^9}, {3.539658702983876*^9, 
   3.53965871095549*^9}, {3.5396612431081476`*^9, 3.5396615769538345`*^9}, {
   3.5396616172225056`*^9, 3.539661649976963*^9}, {3.5398821994892073`*^9, 
   3.539882248779027*^9}, {3.5402291264969573`*^9, 3.5402291273160043`*^9}, {
   3.5468019316783457`*^9, 3.5468019713180156`*^9}, 3.5468020013948684`*^9, {
   3.576090752245698*^9, 3.5760908187330146`*^9}, {3.5760908545506773`*^9, 
   3.5760910170873632`*^9}, {3.5766872960881157`*^9, 3.576687366272639*^9}, {
   3.5837902958813324`*^9, 3.583790362004114*^9}, {3.585772227618986*^9, 
   3.5857723766460485`*^9}, {3.5857724160361176`*^9, 
   3.5857724217457275`*^9}, {3.585772487733843*^9, 3.585772597526836*^9}, {
   3.594234069677395*^9, 3.5942342865307264`*^9}, {3.594236245769825*^9, 
   3.594236403751252*^9}, {3.594236439967308*^9, 3.594236444402377*^9}, {
   3.5965848885218115`*^9, 3.5965851829879284`*^9}, {3.6064477129242563`*^9, 
   3.6064477170244904`*^9}, {3.6067643878025208`*^9, 
   3.6067645104187365`*^9}, {3.606764548030402*^9, 3.606764590602877*^9}, {
   3.609613720173603*^9, 3.6096137267880154`*^9}, {3.6096137886421237`*^9, 
   3.6096138439442205`*^9}, {3.6096139013367214`*^9, 3.609614191778032*^9}, {
   3.609614236846511*^9, 3.609614244334524*^9}, {3.609614445075677*^9, 
   3.6096144489912834`*^9}, {3.6294786490906897`*^9, 
   3.6294787833808775`*^9}, {3.62947881355092*^9, 3.629478818390927*^9}, {
   3.629479785061555*^9, 3.6294797863715563`*^9}, {3.629562542055464*^9, 
   3.6295625440532675`*^9}, {3.629563179524299*^9, 3.6295632164805703`*^9}, {
   3.6295634770856667`*^9, 3.6295634800078716`*^9}, {3.6295635962982955`*^9, 
   3.6295636268611546`*^9}, {3.6295636988918905`*^9, 
   3.6295637168753257`*^9}, {3.6295643246241803`*^9, 3.629564327174985*^9}, {
   3.6295643802052975`*^9, 3.6295643943321285`*^9}, 3.62956444018983*^9, {
   3.6295645910583153`*^9, 3.629564616309367*^9}, {3.629564793949936*^9, 
   3.6295648281644125`*^9}, {3.6295665105709906`*^9, 3.629566527426426*^9}, {
   3.6295667402196894`*^9, 3.6295667804318533`*^9}, {3.6295668168915315`*^9, 
   3.629566842207182*^9}, {3.629566877352854*^9, 3.6295668923634853`*^9}, {
   3.6295669401405888`*^9, 3.629566958360826*^9}, {3.6295676927117987`*^9, 
   3.6295677768997583`*^9}, {3.6295678947547846`*^9, 3.629567999329583*^9}, {
   3.6295822987213025`*^9, 3.6295823643752356`*^9}, {3.6295824139493294`*^9, 
   3.6295826420773797`*^9}, {3.629603441693468*^9, 3.6296037548778596`*^9}, {
   3.629607699840618*^9, 3.62960775507927*^9}, {3.629609623367103*^9, 
   3.6296096457134447`*^9}, {3.629611118868438*^9, 3.629611222099281*^9}, {
   3.6296966526365733`*^9, 3.629696692941445*^9}, {3.6297636071580486`*^9, 
   3.629763693559885*^9}, {3.629822036569414*^9, 3.6298220397694197`*^9}, {
   3.629822086093307*^9, 3.6298221023857403`*^9}, {3.6298221675296617`*^9, 
   3.6298221905345078`*^9}, {3.6298257059366274`*^9, 
   3.6298257837814646`*^9}, {3.6298259014543715`*^9, 3.629825999218544*^9}, {
   3.6298260411408176`*^9, 3.6298261482132063`*^9}, {3.6298266422494926`*^9, 
   3.6298266581016207`*^9}, {3.6298267861248455`*^9, 3.629826875894903*^9}, {
   3.62982690822066*^9, 3.6298271407473702`*^9}, {3.629827195279466*^9, 
   3.629827206545186*^9}, 3.6298272545121703`*^9, {3.6298273159494786`*^9, 
   3.629827323000691*^9}, {3.629827524644846*^9, 3.629827540043973*^9}, {
   3.629843695864236*^9, 3.629843768112363*^9}, {3.6298438969973907`*^9, 
   3.629843902972201*^9}, {3.6298448016472807`*^9, 3.629844837095543*^9}, {
   3.62985840203149*^9, 3.629858493510722*^9}, {3.6298657414582825`*^9, 
   3.6298657501879444`*^9}, {3.629909079007269*^9, 3.6299091181965375`*^9}, {
   3.6299263757686844`*^9, 3.6299264772814417`*^9}, {3.629929867859521*^9, 
   3.6299298729451303`*^9}, {3.6299342834705825`*^9, 
   3.6299343177282424`*^9}, {3.629938461994429*^9, 3.629938470512044*^9}, {
   3.62999370915497*^9, 3.629993709357771*^9}, 3.6299937861556067`*^9, 
   3.629993859254936*^9, {3.630203492255678*^9, 3.6302036679861917`*^9}, {
   3.630203700803055*^9, 3.6302037242280965`*^9}, {3.6303300486200323`*^9, 
   3.6303300997039537`*^9}, {3.630434289440716*^9, 3.6304344590808215`*^9}, {
   3.63063870239233*^9, 3.6306387057726374`*^9}, {3.6306914969265156`*^9, 
   3.630691522836998*^9}, {3.6306963776461215`*^9, 3.6306965559231014`*^9}, {
   3.630696629480076*^9, 3.630696650329111*^9}, {3.6306967646614947`*^9, 
   3.630696807987544*^9}, {3.6309870350982666`*^9, 3.630987055946305*^9}, {
   3.6326180036776175`*^9, 3.632618041000888*^9}, {3.633650773200718*^9, 
   3.633650875407123*^9}, {3.6695150914329014`*^9, 3.6695151469969916`*^9}, {
   3.6695340689888253`*^9, 3.669534103324486*^9}, {3.6695800385699854`*^9, 
   3.669580068158678*^9}, {3.6695801069818983`*^9, 3.6695801073199177`*^9}, {
   3.6697710716437035`*^9, 3.66977109395998*^9}, {3.669771129469011*^9, 
   3.669771147322032*^9}, {3.669771240047613*^9, 3.669771248967632*^9}, {
   3.6697712917597027`*^9, 3.669771304845722*^9}, {3.6698286373379354`*^9, 
   3.669828712054674*^9}, {3.6698397290864587`*^9, 3.6698397551453114`*^9}, {
   3.6698435572376857`*^9, 3.6698435867013707`*^9}, {3.671900284442581*^9, 
   3.6719003563897057`*^9}, {3.6719006947896194`*^9, 
   3.6719006963716235`*^9}, {3.671902989907487*^9, 3.671903150700734*^9}, {
   3.6719085682754197`*^9, 3.6719085691247215`*^9}, {3.67190902094978*^9, 
   3.671909022967884*^9}, {3.6719090611001635`*^9, 3.671909061869565*^9}, {
   3.6719095357905307`*^9, 3.6719095646735964`*^9}, {3.671909607961093*^9, 
   3.671909640559662*^9}, {3.6719096720568495`*^9, 3.6719096753777604`*^9}, {
   3.67190987991696*^9, 3.671909897029999*^9}, {3.671994989288786*^9, 
   3.671995084358223*^9}, {3.671995566580805*^9, 3.6719955978665943`*^9}, {
   3.672059857739501*^9, 3.6720598617095623`*^9}, {3.6720752906433525`*^9, 
   3.672075293958542*^9}, {3.6720753292375593`*^9, 3.6720753822145896`*^9}, {
   3.6720754410259533`*^9, 3.6720755069357233`*^9}, {3.6720827910149236`*^9, 
   3.6720828354681063`*^9}, {3.6721496951806993`*^9, 
   3.672149714980734*^9}},ExpressionUUID->"7c721e48-f508-4526-9b70-\
cf02b9d648a5"],

Cell[TextData[{
 StyleBox["April 2013\n",
  FontWeight->"Bold"],
 "\t\n",
 StyleBox["Update!",
  FontSlant->"Italic"],
 " New TensoriaCalc function CovariantBox added. This is intended to be the \
wave operator acting on any Tensor object. Right now, however, only scalars \
are supported.\n\t\n",
 StyleBox["Update!",
  FontSlant->"Italic"],
 " New TensoriaCalc function CoordinateTransformation added. This computes \
the Jacobian of coordinate transformations."
}], "Text",
 CellChangeTimes->{{3.5391952254569125`*^9, 3.539195640163097*^9}, {
   3.53955006359291*^9, 3.5395501346978345`*^9}, {3.5395501670990915`*^9, 
   3.539550390631884*^9}, {3.539551751874675*^9, 3.5395517613906918`*^9}, {
   3.539552377154973*^9, 3.539552451910304*^9}, {3.5396155207615376`*^9, 
   3.539615524739544*^9}, {3.5396155883252563`*^9, 3.5396156250342236`*^9}, {
   3.539634404087411*^9, 3.539634467948063*^9}, {3.539658702983876*^9, 
   3.53965871095549*^9}, {3.5396612431081476`*^9, 3.5396615769538345`*^9}, {
   3.5396616172225056`*^9, 3.539661649976963*^9}, {3.5398821994892073`*^9, 
   3.539882248779027*^9}, {3.5402291264969573`*^9, 3.5402291273160043`*^9}, {
   3.5468019316783457`*^9, 3.5468019713180156`*^9}, 3.5468020013948684`*^9, {
   3.576090752245698*^9, 3.5760908187330146`*^9}, {3.5760908545506773`*^9, 
   3.5760910170873632`*^9}, {3.5766872960881157`*^9, 3.576687366272639*^9}, {
   3.5837902958813324`*^9, 3.583790362004114*^9}, {3.585772227618986*^9, 
   3.5857723766460485`*^9}, {3.5857724160361176`*^9, 
   3.5857724217457275`*^9}, {3.585772487733843*^9, 3.585772597526836*^9}, {
   3.594234069677395*^9, 3.5942342865307264`*^9}, {3.594236245769825*^9, 
   3.594236403751252*^9}, {3.594236439967308*^9, 3.594236444402377*^9}, {
   3.5965848885218115`*^9, 3.5965851829879284`*^9}, {3.6064477129242563`*^9, 
   3.6064477170244904`*^9}, {3.6067643878025208`*^9, 
   3.6067645104187365`*^9}, {3.606764548030402*^9, 3.606764590602877*^9}, {
   3.609613720173603*^9, 3.6096137267880154`*^9}, {3.6096137886421237`*^9, 
   3.6096138439442205`*^9}, {3.6096139013367214`*^9, 3.609614191778032*^9}, {
   3.609614236846511*^9, 3.609614244334524*^9}, {3.609614445075677*^9, 
   3.6096144489912834`*^9}, {3.6294786490906897`*^9, 
   3.6294787833808775`*^9}, {3.62947881355092*^9, 3.629478818390927*^9}, {
   3.629479785061555*^9, 3.6294797863715563`*^9}, {3.629562542055464*^9, 
   3.6295625440532675`*^9}, {3.629563179524299*^9, 3.6295632164805703`*^9}, {
   3.6295634770856667`*^9, 3.6295634800078716`*^9}, {3.6295635962982955`*^9, 
   3.6295636268611546`*^9}, {3.6295636988918905`*^9, 
   3.6295637168753257`*^9}, {3.6295643246241803`*^9, 3.629564327174985*^9}, {
   3.6295643802052975`*^9, 3.6295643943321285`*^9}, 3.62956444018983*^9, {
   3.6295645910583153`*^9, 3.629564616309367*^9}, {3.629564793949936*^9, 
   3.6295648281644125`*^9}, {3.6295665105709906`*^9, 3.629566527426426*^9}, {
   3.6295667402196894`*^9, 3.6295667804318533`*^9}, {3.6295668168915315`*^9, 
   3.629566842207182*^9}, {3.629566877352854*^9, 3.6295668923634853`*^9}, {
   3.6295669401405888`*^9, 3.629566958360826*^9}, {3.6295676927117987`*^9, 
   3.6295677768997583`*^9}, {3.6295678947547846`*^9, 3.629567999329583*^9}, {
   3.6295822987213025`*^9, 3.6295823643752356`*^9}, {3.6295824139493294`*^9, 
   3.6295826420773797`*^9}, {3.629603441693468*^9, 3.6296037548778596`*^9}, {
   3.629607699840618*^9, 3.62960775507927*^9}, {3.629609623367103*^9, 
   3.6296096457134447`*^9}, {3.629611118868438*^9, 3.629611222099281*^9}, {
   3.6296966526365733`*^9, 3.629696692941445*^9}, {3.6297636071580486`*^9, 
   3.629763693559885*^9}, {3.629822036569414*^9, 3.6298220397694197`*^9}, {
   3.629822086093307*^9, 3.6298221023857403`*^9}, {3.6298221675296617`*^9, 
   3.6298221905345078`*^9}, {3.6298257059366274`*^9, 
   3.6298257837814646`*^9}, {3.6298259014543715`*^9, 3.629825999218544*^9}, {
   3.6298260411408176`*^9, 3.6298261482132063`*^9}, {3.6298266422494926`*^9, 
   3.6298266581016207`*^9}, {3.6298267861248455`*^9, 3.629826875894903*^9}, {
   3.62982690822066*^9, 3.6298271407473702`*^9}, {3.629827195279466*^9, 
   3.629827206545186*^9}, 3.6298272545121703`*^9, {3.6298273159494786`*^9, 
   3.629827323000691*^9}, {3.629827524644846*^9, 3.629827540043973*^9}, {
   3.629843695864236*^9, 3.629843768112363*^9}, {3.6298438969973907`*^9, 
   3.629843902972201*^9}, {3.6298448016472807`*^9, 3.629844837095543*^9}, {
   3.62985840203149*^9, 3.629858493510722*^9}, {3.6298657414582825`*^9, 
   3.6298657501879444`*^9}, {3.629909079007269*^9, 3.6299091181965375`*^9}, {
   3.6299263757686844`*^9, 3.6299264772814417`*^9}, {3.629929867859521*^9, 
   3.6299298729451303`*^9}, {3.6299342834705825`*^9, 
   3.6299343177282424`*^9}, {3.629938461994429*^9, 3.629938470512044*^9}, {
   3.62999370915497*^9, 3.629993709357771*^9}, 3.6299937861556067`*^9, 
   3.629993859254936*^9, {3.630203492255678*^9, 3.6302036679861917`*^9}, {
   3.630203700803055*^9, 3.6302037242280965`*^9}, {3.6303300486200323`*^9, 
   3.6303300997039537`*^9}, {3.630434289440716*^9, 3.6304344590808215`*^9}, {
   3.63063870239233*^9, 3.6306387057726374`*^9}, {3.6306914969265156`*^9, 
   3.630691522836998*^9}, {3.6306963776461215`*^9, 3.6306965559231014`*^9}, {
   3.630696629480076*^9, 3.630696650329111*^9}, {3.6306967646614947`*^9, 
   3.630696807987544*^9}, {3.6309870350982666`*^9, 3.630987055946305*^9}, {
   3.6326180036776175`*^9, 3.632618041000888*^9}, {3.633650773200718*^9, 
   3.633650875407123*^9}, {3.6695150914329014`*^9, 3.6695151469969916`*^9}, {
   3.6695340689888253`*^9, 3.669534103324486*^9}, {3.6695800385699854`*^9, 
   3.669580068158678*^9}, {3.6695801069818983`*^9, 3.6695801073199177`*^9}, {
   3.6697710716437035`*^9, 3.66977109395998*^9}, {3.669771129469011*^9, 
   3.669771147322032*^9}, {3.669771240047613*^9, 3.669771248967632*^9}, {
   3.6697712917597027`*^9, 3.669771304845722*^9}, {3.6698286373379354`*^9, 
   3.669828712054674*^9}, {3.6698397290864587`*^9, 3.6698397551453114`*^9}, {
   3.6698435572376857`*^9, 3.6698435867013707`*^9}, {3.671900284442581*^9, 
   3.6719003563897057`*^9}, {3.6719006947896194`*^9, 
   3.6719006963716235`*^9}, {3.671902989907487*^9, 3.671903150700734*^9}, {
   3.6719085682754197`*^9, 3.6719085691247215`*^9}, {3.67190902094978*^9, 
   3.671909022967884*^9}, {3.6719090611001635`*^9, 3.671909061869565*^9}, {
   3.6719095357905307`*^9, 3.6719095646735964`*^9}, {3.671909607961093*^9, 
   3.671909640559662*^9}, {3.6719096720568495`*^9, 3.6719096753777604`*^9}, {
   3.67190987991696*^9, 3.671909897029999*^9}, {3.671994989288786*^9, 
   3.671995084358223*^9}, {3.671995566580805*^9, 3.6719955978665943`*^9}, {
   3.672059857739501*^9, 3.6720598617095623`*^9}, {3.6720752906433525`*^9, 
   3.672075293958542*^9}, {3.6720753292375593`*^9, 3.6720753822145896`*^9}, {
   3.6720754410259533`*^9, 3.6720755069357233`*^9}, {3.6720827910149236`*^9, 
   3.6720828354681063`*^9}, {3.6721496951806993`*^9, 
   3.6721497334107656`*^9}, {3.8520083064137554`*^9, 
   3.8520083076681795`*^9}},ExpressionUUID->"bca1ac60-c7b5-4241-bf13-\
b3afd3fa07e2"],

Cell[TextData[{
 StyleBox["July 2013\n",
  FontWeight->"Bold"],
 "\n",
 StyleBox["Update!",
  FontSlant->"Italic"],
 " New TensoriaCalc function GradientSquared added. This computes ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"\[Del]", "f"}], ")"}], "2"], TraditionalForm]],ExpressionUUID->
  "30e4c2ed-4cec-4292-834b-de82de395e5d"],
 " for any scalar function ",
 Cell[BoxData[
  FormBox["f", TraditionalForm]],ExpressionUUID->
  "d2d99954-ab7a-4a15-b9f8-b9fa3fc652be"],
 "."
}], "Text",
 CellChangeTimes->{{3.5391952254569125`*^9, 3.539195640163097*^9}, {
   3.53955006359291*^9, 3.5395501346978345`*^9}, {3.5395501670990915`*^9, 
   3.539550390631884*^9}, {3.539551751874675*^9, 3.5395517613906918`*^9}, {
   3.539552377154973*^9, 3.539552451910304*^9}, {3.5396155207615376`*^9, 
   3.539615524739544*^9}, {3.5396155883252563`*^9, 3.5396156250342236`*^9}, {
   3.539634404087411*^9, 3.539634467948063*^9}, {3.539658702983876*^9, 
   3.53965871095549*^9}, {3.5396612431081476`*^9, 3.5396615769538345`*^9}, {
   3.5396616172225056`*^9, 3.539661649976963*^9}, {3.5398821994892073`*^9, 
   3.539882248779027*^9}, {3.5402291264969573`*^9, 3.5402291273160043`*^9}, {
   3.5468019316783457`*^9, 3.5468019713180156`*^9}, 3.5468020013948684`*^9, {
   3.576090752245698*^9, 3.5760908187330146`*^9}, {3.5760908545506773`*^9, 
   3.5760910170873632`*^9}, {3.5766872960881157`*^9, 3.576687366272639*^9}, {
   3.5837902958813324`*^9, 3.583790362004114*^9}, {3.585772227618986*^9, 
   3.5857723766460485`*^9}, {3.5857724160361176`*^9, 
   3.5857724217457275`*^9}, {3.585772487733843*^9, 3.585772597526836*^9}, {
   3.594234069677395*^9, 3.5942342865307264`*^9}, {3.594236245769825*^9, 
   3.594236403751252*^9}, {3.594236439967308*^9, 3.594236444402377*^9}, {
   3.5965848885218115`*^9, 3.5965851829879284`*^9}, {3.6064477129242563`*^9, 
   3.6064477170244904`*^9}, {3.6067643878025208`*^9, 
   3.6067645104187365`*^9}, {3.606764548030402*^9, 3.606764590602877*^9}, {
   3.609613720173603*^9, 3.6096137267880154`*^9}, {3.6096137886421237`*^9, 
   3.6096138439442205`*^9}, {3.6096139013367214`*^9, 3.609614191778032*^9}, {
   3.609614236846511*^9, 3.609614244334524*^9}, {3.609614445075677*^9, 
   3.6096144489912834`*^9}, {3.6294786490906897`*^9, 
   3.6294787833808775`*^9}, {3.62947881355092*^9, 3.629478818390927*^9}, {
   3.629479785061555*^9, 3.6294797863715563`*^9}, {3.629562542055464*^9, 
   3.6295625440532675`*^9}, {3.629563179524299*^9, 3.6295632164805703`*^9}, {
   3.6295634770856667`*^9, 3.6295634800078716`*^9}, {3.6295635962982955`*^9, 
   3.6295636268611546`*^9}, {3.6295636988918905`*^9, 
   3.6295637168753257`*^9}, {3.6295643246241803`*^9, 3.629564327174985*^9}, {
   3.6295643802052975`*^9, 3.6295643943321285`*^9}, 3.62956444018983*^9, {
   3.6295645910583153`*^9, 3.629564616309367*^9}, {3.629564793949936*^9, 
   3.6295648281644125`*^9}, {3.6295665105709906`*^9, 3.629566527426426*^9}, {
   3.6295667402196894`*^9, 3.6295667804318533`*^9}, {3.6295668168915315`*^9, 
   3.629566842207182*^9}, {3.629566877352854*^9, 3.6295668923634853`*^9}, {
   3.6295669401405888`*^9, 3.629566958360826*^9}, {3.6295676927117987`*^9, 
   3.6295677768997583`*^9}, {3.6295678947547846`*^9, 3.629567999329583*^9}, {
   3.6295822987213025`*^9, 3.6295823643752356`*^9}, {3.6295824139493294`*^9, 
   3.6295826420773797`*^9}, {3.629603441693468*^9, 3.6296037548778596`*^9}, {
   3.629607699840618*^9, 3.62960775507927*^9}, {3.629609623367103*^9, 
   3.6296096457134447`*^9}, {3.629611118868438*^9, 3.629611222099281*^9}, {
   3.6296966526365733`*^9, 3.629696692941445*^9}, {3.6297636071580486`*^9, 
   3.629763693559885*^9}, {3.629822036569414*^9, 3.6298220397694197`*^9}, {
   3.629822086093307*^9, 3.6298221023857403`*^9}, {3.6298221675296617`*^9, 
   3.6298221905345078`*^9}, {3.6298257059366274`*^9, 
   3.6298257837814646`*^9}, {3.6298259014543715`*^9, 3.629825999218544*^9}, {
   3.6298260411408176`*^9, 3.6298261482132063`*^9}, {3.6298266422494926`*^9, 
   3.6298266581016207`*^9}, {3.6298267861248455`*^9, 3.629826875894903*^9}, {
   3.62982690822066*^9, 3.6298271407473702`*^9}, {3.629827195279466*^9, 
   3.629827206545186*^9}, 3.6298272545121703`*^9, {3.6298273159494786`*^9, 
   3.629827323000691*^9}, {3.629827524644846*^9, 3.629827540043973*^9}, {
   3.629843695864236*^9, 3.629843768112363*^9}, {3.6298438969973907`*^9, 
   3.629843902972201*^9}, {3.6298448016472807`*^9, 3.629844837095543*^9}, {
   3.62985840203149*^9, 3.629858493510722*^9}, {3.6298657414582825`*^9, 
   3.6298657501879444`*^9}, {3.629909079007269*^9, 3.6299091181965375`*^9}, {
   3.6299263757686844`*^9, 3.6299264772814417`*^9}, {3.629929867859521*^9, 
   3.6299298729451303`*^9}, {3.6299342834705825`*^9, 
   3.6299343177282424`*^9}, {3.629938461994429*^9, 3.629938470512044*^9}, {
   3.62999370915497*^9, 3.629993709357771*^9}, 3.6299937861556067`*^9, 
   3.629993859254936*^9, {3.630203492255678*^9, 3.6302036679861917`*^9}, {
   3.630203700803055*^9, 3.6302037242280965`*^9}, {3.6303300486200323`*^9, 
   3.6303300997039537`*^9}, {3.630434289440716*^9, 3.6304344590808215`*^9}, {
   3.63063870239233*^9, 3.6306387057726374`*^9}, {3.6306914969265156`*^9, 
   3.630691522836998*^9}, {3.6306963776461215`*^9, 3.6306965559231014`*^9}, {
   3.630696629480076*^9, 3.630696650329111*^9}, {3.6306967646614947`*^9, 
   3.630696807987544*^9}, {3.6309870350982666`*^9, 3.630987055946305*^9}, {
   3.6326180036776175`*^9, 3.632618041000888*^9}, {3.633650773200718*^9, 
   3.633650875407123*^9}, {3.6695150914329014`*^9, 3.6695151469969916`*^9}, {
   3.6695340689888253`*^9, 3.669534103324486*^9}, {3.6695800385699854`*^9, 
   3.669580068158678*^9}, {3.6695801069818983`*^9, 3.6695801073199177`*^9}, {
   3.6697710716437035`*^9, 3.66977109395998*^9}, {3.669771129469011*^9, 
   3.669771147322032*^9}, {3.669771240047613*^9, 3.669771248967632*^9}, {
   3.6697712917597027`*^9, 3.669771304845722*^9}, {3.6698286373379354`*^9, 
   3.669828712054674*^9}, {3.6698397290864587`*^9, 3.6698397551453114`*^9}, {
   3.6698435572376857`*^9, 3.6698435867013707`*^9}, {3.671900284442581*^9, 
   3.6719003563897057`*^9}, {3.6719006947896194`*^9, 
   3.6719006963716235`*^9}, {3.671902989907487*^9, 3.671903150700734*^9}, {
   3.6719085682754197`*^9, 3.6719085691247215`*^9}, {3.67190902094978*^9, 
   3.671909022967884*^9}, {3.6719090611001635`*^9, 3.671909061869565*^9}, {
   3.6719095357905307`*^9, 3.6719095646735964`*^9}, {3.671909607961093*^9, 
   3.671909640559662*^9}, {3.6719096720568495`*^9, 3.6719096753777604`*^9}, {
   3.67190987991696*^9, 3.671909897029999*^9}, {3.671994989288786*^9, 
   3.671995084358223*^9}, {3.671995566580805*^9, 3.6719955978665943`*^9}, {
   3.672059857739501*^9, 3.6720598617095623`*^9}, {3.6720752906433525`*^9, 
   3.672075293958542*^9}, {3.6720753292375593`*^9, 3.6720753822145896`*^9}, {
   3.6720754410259533`*^9, 3.6720755069357233`*^9}, {3.6720827910149236`*^9, 
   3.6720828354681063`*^9}, {3.6721496951806993`*^9, 
   3.672149750198295*^9}},ExpressionUUID->"ead71958-ac53-4658-8df1-\
ae41691260d0"],

Cell[TextData[{
 StyleBox["August 2013\n",
  FontWeight->"Bold"],
 "\t\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Series now allows for expansion with respect to multiple parameters. \
Previously, only Series[Tensor[...],{\[Epsilon],\[Epsilon]start,n}] was \
supported.\n\t\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Instead of the Union of the coordinate transformations CT and its \
associated Jacobian JC, CoordinateTransformation now outputs Flatten[{JC, \
CT}] instead."
}], "Text",
 CellChangeTimes->{{3.5391952254569125`*^9, 3.539195640163097*^9}, {
   3.53955006359291*^9, 3.5395501346978345`*^9}, {3.5395501670990915`*^9, 
   3.539550390631884*^9}, {3.539551751874675*^9, 3.5395517613906918`*^9}, {
   3.539552377154973*^9, 3.539552451910304*^9}, {3.5396155207615376`*^9, 
   3.539615524739544*^9}, {3.5396155883252563`*^9, 3.5396156250342236`*^9}, {
   3.539634404087411*^9, 3.539634467948063*^9}, {3.539658702983876*^9, 
   3.53965871095549*^9}, {3.5396612431081476`*^9, 3.5396615769538345`*^9}, {
   3.5396616172225056`*^9, 3.539661649976963*^9}, {3.5398821994892073`*^9, 
   3.539882248779027*^9}, {3.5402291264969573`*^9, 3.5402291273160043`*^9}, {
   3.5468019316783457`*^9, 3.5468019713180156`*^9}, 3.5468020013948684`*^9, {
   3.576090752245698*^9, 3.5760908187330146`*^9}, {3.5760908545506773`*^9, 
   3.5760910170873632`*^9}, {3.5766872960881157`*^9, 3.576687366272639*^9}, {
   3.5837902958813324`*^9, 3.583790362004114*^9}, {3.585772227618986*^9, 
   3.5857723766460485`*^9}, {3.5857724160361176`*^9, 
   3.5857724217457275`*^9}, {3.585772487733843*^9, 3.585772597526836*^9}, {
   3.594234069677395*^9, 3.5942342865307264`*^9}, {3.594236245769825*^9, 
   3.594236403751252*^9}, {3.594236439967308*^9, 3.594236444402377*^9}, {
   3.5965848885218115`*^9, 3.5965851829879284`*^9}, {3.6064477129242563`*^9, 
   3.6064477170244904`*^9}, {3.6067643878025208`*^9, 
   3.6067645104187365`*^9}, {3.606764548030402*^9, 3.606764590602877*^9}, {
   3.609613720173603*^9, 3.6096137267880154`*^9}, {3.6096137886421237`*^9, 
   3.6096138439442205`*^9}, {3.6096139013367214`*^9, 3.609614191778032*^9}, {
   3.609614236846511*^9, 3.609614244334524*^9}, {3.609614445075677*^9, 
   3.6096144489912834`*^9}, {3.6294786490906897`*^9, 
   3.6294787833808775`*^9}, {3.62947881355092*^9, 3.629478818390927*^9}, {
   3.629479785061555*^9, 3.6294797863715563`*^9}, {3.629562542055464*^9, 
   3.6295625440532675`*^9}, {3.629563179524299*^9, 3.6295632164805703`*^9}, {
   3.6295634770856667`*^9, 3.6295634800078716`*^9}, {3.6295635962982955`*^9, 
   3.6295636268611546`*^9}, {3.6295636988918905`*^9, 
   3.6295637168753257`*^9}, {3.6295643246241803`*^9, 3.629564327174985*^9}, {
   3.6295643802052975`*^9, 3.6295643943321285`*^9}, 3.62956444018983*^9, {
   3.6295645910583153`*^9, 3.629564616309367*^9}, {3.629564793949936*^9, 
   3.6295648281644125`*^9}, {3.6295665105709906`*^9, 3.629566527426426*^9}, {
   3.6295667402196894`*^9, 3.6295667804318533`*^9}, {3.6295668168915315`*^9, 
   3.629566842207182*^9}, {3.629566877352854*^9, 3.6295668923634853`*^9}, {
   3.6295669401405888`*^9, 3.629566958360826*^9}, {3.6295676927117987`*^9, 
   3.6295677768997583`*^9}, {3.6295678947547846`*^9, 3.629567999329583*^9}, {
   3.6295822987213025`*^9, 3.6295823643752356`*^9}, {3.6295824139493294`*^9, 
   3.6295826420773797`*^9}, {3.629603441693468*^9, 3.6296037548778596`*^9}, {
   3.629607699840618*^9, 3.62960775507927*^9}, {3.629609623367103*^9, 
   3.6296096457134447`*^9}, {3.629611118868438*^9, 3.629611222099281*^9}, {
   3.6296966526365733`*^9, 3.629696692941445*^9}, {3.6297636071580486`*^9, 
   3.629763693559885*^9}, {3.629822036569414*^9, 3.6298220397694197`*^9}, {
   3.629822086093307*^9, 3.6298221023857403`*^9}, {3.6298221675296617`*^9, 
   3.6298221905345078`*^9}, {3.6298257059366274`*^9, 
   3.6298257837814646`*^9}, {3.6298259014543715`*^9, 3.629825999218544*^9}, {
   3.6298260411408176`*^9, 3.6298261482132063`*^9}, {3.6298266422494926`*^9, 
   3.6298266581016207`*^9}, {3.6298267861248455`*^9, 3.629826875894903*^9}, {
   3.62982690822066*^9, 3.6298271407473702`*^9}, {3.629827195279466*^9, 
   3.629827206545186*^9}, 3.6298272545121703`*^9, {3.6298273159494786`*^9, 
   3.629827323000691*^9}, {3.629827524644846*^9, 3.629827540043973*^9}, {
   3.629843695864236*^9, 3.629843768112363*^9}, {3.6298438969973907`*^9, 
   3.629843902972201*^9}, {3.6298448016472807`*^9, 3.629844837095543*^9}, {
   3.62985840203149*^9, 3.629858493510722*^9}, {3.6298657414582825`*^9, 
   3.6298657501879444`*^9}, {3.629909079007269*^9, 3.6299091181965375`*^9}, {
   3.6299263757686844`*^9, 3.6299264772814417`*^9}, {3.629929867859521*^9, 
   3.6299298729451303`*^9}, {3.6299342834705825`*^9, 
   3.6299343177282424`*^9}, {3.629938461994429*^9, 3.629938470512044*^9}, {
   3.62999370915497*^9, 3.629993709357771*^9}, 3.6299937861556067`*^9, 
   3.629993859254936*^9, {3.630203492255678*^9, 3.6302036679861917`*^9}, {
   3.630203700803055*^9, 3.6302037242280965`*^9}, {3.6303300486200323`*^9, 
   3.6303300997039537`*^9}, {3.630434289440716*^9, 3.6304344590808215`*^9}, {
   3.63063870239233*^9, 3.6306387057726374`*^9}, {3.6306914969265156`*^9, 
   3.630691522836998*^9}, {3.6306963776461215`*^9, 3.6306965559231014`*^9}, {
   3.630696629480076*^9, 3.630696650329111*^9}, {3.6306967646614947`*^9, 
   3.630696807987544*^9}, {3.6309870350982666`*^9, 3.630987055946305*^9}, {
   3.6326180036776175`*^9, 3.632618041000888*^9}, {3.633650773200718*^9, 
   3.633650875407123*^9}, {3.6695150914329014`*^9, 3.6695151469969916`*^9}, {
   3.6695340689888253`*^9, 3.669534103324486*^9}, {3.6695800385699854`*^9, 
   3.669580068158678*^9}, {3.6695801069818983`*^9, 3.6695801073199177`*^9}, {
   3.6697710716437035`*^9, 3.66977109395998*^9}, {3.669771129469011*^9, 
   3.669771147322032*^9}, {3.669771240047613*^9, 3.669771248967632*^9}, {
   3.6697712917597027`*^9, 3.669771304845722*^9}, {3.6698286373379354`*^9, 
   3.669828712054674*^9}, {3.6698397290864587`*^9, 3.6698397551453114`*^9}, {
   3.6698435572376857`*^9, 3.6698435867013707`*^9}, {3.671900284442581*^9, 
   3.6719003563897057`*^9}, {3.6719006947896194`*^9, 
   3.6719006963716235`*^9}, {3.671902989907487*^9, 3.671903150700734*^9}, {
   3.6719085682754197`*^9, 3.6719085691247215`*^9}, {3.67190902094978*^9, 
   3.671909022967884*^9}, {3.6719090611001635`*^9, 3.671909061869565*^9}, {
   3.6719095357905307`*^9, 3.6719095646735964`*^9}, {3.671909607961093*^9, 
   3.671909640559662*^9}, {3.6719096720568495`*^9, 3.6719096753777604`*^9}, {
   3.67190987991696*^9, 3.671909897029999*^9}, {3.671994989288786*^9, 
   3.671995084358223*^9}, {3.671995566580805*^9, 3.6719955978665943`*^9}, {
   3.672059857739501*^9, 3.6720598617095623`*^9}, {3.6720752906433525`*^9, 
   3.672075293958542*^9}, {3.6720753292375593`*^9, 3.6720753822145896`*^9}, {
   3.6720754410259533`*^9, 3.6720755069357233`*^9}, {3.6720827910149236`*^9, 
   3.6720828354681063`*^9}, {3.6721496951806993`*^9, 
   3.6721497554683037`*^9}, {3.852008306494322*^9, 
   3.852008307746319*^9}},ExpressionUUID->"0743ba2d-d02a-4a35-9a48-\
b26222ee90e6"],

Cell[TextData[{
 StyleBox["November 2013\n",
  FontWeight->"Bold"],
 "\t\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Metric[..., M, ...], where M is the matrix representation of the given \
geometry, now checks explicitly whether the Head[M] === List.\n\t\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": CheckMetric, the function that checks whether a given expression is a \
quadratic form of coordinate differentials, now does so by checking that the \
expression scales homogeneously under \[DifferentialD]",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["x", "\[Mu]"], "\[Rule]", 
    RowBox[{"\[Epsilon]", " ", 
     RowBox[{"\[DifferentialD]", 
      FormBox[
       RowBox[{
        SuperscriptBox["x", "\[Mu]"], " "}],
       TraditionalForm]}]}]}], TraditionalForm]],ExpressionUUID->
  "9715ff6a-73e2-42df-b0a8-4568b44accea"],
 "."
}], "Text",
 CellChangeTimes->{{3.5391952254569125`*^9, 3.539195640163097*^9}, {
   3.53955006359291*^9, 3.5395501346978345`*^9}, {3.5395501670990915`*^9, 
   3.539550390631884*^9}, {3.539551751874675*^9, 3.5395517613906918`*^9}, {
   3.539552377154973*^9, 3.539552451910304*^9}, {3.5396155207615376`*^9, 
   3.539615524739544*^9}, {3.5396155883252563`*^9, 3.5396156250342236`*^9}, {
   3.539634404087411*^9, 3.539634467948063*^9}, {3.539658702983876*^9, 
   3.53965871095549*^9}, {3.5396612431081476`*^9, 3.5396615769538345`*^9}, {
   3.5396616172225056`*^9, 3.539661649976963*^9}, {3.5398821994892073`*^9, 
   3.539882248779027*^9}, {3.5402291264969573`*^9, 3.5402291273160043`*^9}, {
   3.5468019316783457`*^9, 3.5468019713180156`*^9}, 3.5468020013948684`*^9, {
   3.576090752245698*^9, 3.5760908187330146`*^9}, {3.5760908545506773`*^9, 
   3.5760910170873632`*^9}, {3.5766872960881157`*^9, 3.576687366272639*^9}, {
   3.5837902958813324`*^9, 3.583790362004114*^9}, {3.585772227618986*^9, 
   3.5857723766460485`*^9}, {3.5857724160361176`*^9, 
   3.5857724217457275`*^9}, {3.585772487733843*^9, 3.585772597526836*^9}, {
   3.594234069677395*^9, 3.5942342865307264`*^9}, {3.594236245769825*^9, 
   3.594236403751252*^9}, {3.594236439967308*^9, 3.594236444402377*^9}, {
   3.5965848885218115`*^9, 3.5965851829879284`*^9}, {3.6064477129242563`*^9, 
   3.6064477170244904`*^9}, {3.6067643878025208`*^9, 
   3.6067645104187365`*^9}, {3.606764548030402*^9, 3.606764590602877*^9}, {
   3.609613720173603*^9, 3.6096137267880154`*^9}, {3.6096137886421237`*^9, 
   3.6096138439442205`*^9}, {3.6096139013367214`*^9, 3.609614191778032*^9}, {
   3.609614236846511*^9, 3.609614244334524*^9}, {3.609614445075677*^9, 
   3.6096144489912834`*^9}, {3.6294786490906897`*^9, 
   3.6294787833808775`*^9}, {3.62947881355092*^9, 3.629478818390927*^9}, {
   3.629479785061555*^9, 3.6294797863715563`*^9}, {3.629562542055464*^9, 
   3.6295625440532675`*^9}, {3.629563179524299*^9, 3.6295632164805703`*^9}, {
   3.6295634770856667`*^9, 3.6295634800078716`*^9}, {3.6295635962982955`*^9, 
   3.6295636268611546`*^9}, {3.6295636988918905`*^9, 
   3.6295637168753257`*^9}, {3.6295643246241803`*^9, 3.629564327174985*^9}, {
   3.6295643802052975`*^9, 3.6295643943321285`*^9}, 3.62956444018983*^9, {
   3.6295645910583153`*^9, 3.629564616309367*^9}, {3.629564793949936*^9, 
   3.6295648281644125`*^9}, {3.6295665105709906`*^9, 3.629566527426426*^9}, {
   3.6295667402196894`*^9, 3.6295667804318533`*^9}, {3.6295668168915315`*^9, 
   3.629566842207182*^9}, {3.629566877352854*^9, 3.6295668923634853`*^9}, {
   3.6295669401405888`*^9, 3.629566958360826*^9}, {3.6295676927117987`*^9, 
   3.6295677768997583`*^9}, {3.6295678947547846`*^9, 3.629567999329583*^9}, {
   3.6295822987213025`*^9, 3.6295823643752356`*^9}, {3.6295824139493294`*^9, 
   3.6295826420773797`*^9}, {3.629603441693468*^9, 3.6296037548778596`*^9}, {
   3.629607699840618*^9, 3.62960775507927*^9}, {3.629609623367103*^9, 
   3.6296096457134447`*^9}, {3.629611118868438*^9, 3.629611222099281*^9}, {
   3.6296966526365733`*^9, 3.629696692941445*^9}, {3.6297636071580486`*^9, 
   3.629763693559885*^9}, {3.629822036569414*^9, 3.6298220397694197`*^9}, {
   3.629822086093307*^9, 3.6298221023857403`*^9}, {3.6298221675296617`*^9, 
   3.6298221905345078`*^9}, {3.6298257059366274`*^9, 
   3.6298257837814646`*^9}, {3.6298259014543715`*^9, 3.629825999218544*^9}, {
   3.6298260411408176`*^9, 3.6298261482132063`*^9}, {3.6298266422494926`*^9, 
   3.6298266581016207`*^9}, {3.6298267861248455`*^9, 3.629826875894903*^9}, {
   3.62982690822066*^9, 3.6298271407473702`*^9}, {3.629827195279466*^9, 
   3.629827206545186*^9}, 3.6298272545121703`*^9, {3.6298273159494786`*^9, 
   3.629827323000691*^9}, {3.629827524644846*^9, 3.629827540043973*^9}, {
   3.629843695864236*^9, 3.629843768112363*^9}, {3.6298438969973907`*^9, 
   3.629843902972201*^9}, {3.6298448016472807`*^9, 3.629844837095543*^9}, {
   3.62985840203149*^9, 3.629858493510722*^9}, {3.6298657414582825`*^9, 
   3.6298657501879444`*^9}, {3.629909079007269*^9, 3.6299091181965375`*^9}, {
   3.6299263757686844`*^9, 3.6299264772814417`*^9}, {3.629929867859521*^9, 
   3.6299298729451303`*^9}, {3.6299342834705825`*^9, 
   3.6299343177282424`*^9}, {3.629938461994429*^9, 3.629938470512044*^9}, {
   3.62999370915497*^9, 3.629993709357771*^9}, 3.6299937861556067`*^9, 
   3.629993859254936*^9, {3.630203492255678*^9, 3.6302036679861917`*^9}, {
   3.630203700803055*^9, 3.6302037242280965`*^9}, {3.6303300486200323`*^9, 
   3.6303300997039537`*^9}, {3.630434289440716*^9, 3.6304344590808215`*^9}, {
   3.63063870239233*^9, 3.6306387057726374`*^9}, {3.6306914969265156`*^9, 
   3.630691522836998*^9}, {3.6306963776461215`*^9, 3.6306965559231014`*^9}, {
   3.630696629480076*^9, 3.630696650329111*^9}, {3.6306967646614947`*^9, 
   3.630696807987544*^9}, {3.6309870350982666`*^9, 3.630987055946305*^9}, {
   3.6326180036776175`*^9, 3.632618041000888*^9}, {3.633650773200718*^9, 
   3.633650875407123*^9}, {3.6695150914329014`*^9, 3.6695151469969916`*^9}, {
   3.6695340689888253`*^9, 3.669534103324486*^9}, {3.6695800385699854`*^9, 
   3.669580068158678*^9}, {3.6695801069818983`*^9, 3.6695801073199177`*^9}, {
   3.6697710716437035`*^9, 3.66977109395998*^9}, {3.669771129469011*^9, 
   3.669771147322032*^9}, {3.669771240047613*^9, 3.669771248967632*^9}, {
   3.6697712917597027`*^9, 3.669771304845722*^9}, {3.6698286373379354`*^9, 
   3.669828712054674*^9}, {3.6698397290864587`*^9, 3.6698397551453114`*^9}, {
   3.6698435572376857`*^9, 3.6698435867013707`*^9}, {3.671900284442581*^9, 
   3.6719003563897057`*^9}, {3.6719006947896194`*^9, 
   3.6719006963716235`*^9}, {3.671902989907487*^9, 3.671903150700734*^9}, {
   3.6719085682754197`*^9, 3.6719085691247215`*^9}, {3.67190902094978*^9, 
   3.671909022967884*^9}, {3.6719090611001635`*^9, 3.671909061869565*^9}, {
   3.6719095357905307`*^9, 3.6719095646735964`*^9}, {3.671909607961093*^9, 
   3.671909640559662*^9}, {3.6719096720568495`*^9, 3.6719096753777604`*^9}, {
   3.67190987991696*^9, 3.671909897029999*^9}, {3.671994989288786*^9, 
   3.671995084358223*^9}, {3.671995566580805*^9, 3.6719955978665943`*^9}, {
   3.672059857739501*^9, 3.6720598617095623`*^9}, {3.6720752906433525`*^9, 
   3.672075293958542*^9}, {3.6720753292375593`*^9, 3.6720753822145896`*^9}, {
   3.6720754410259533`*^9, 3.6720755069357233`*^9}, {3.6720827910149236`*^9, 
   3.6720828354681063`*^9}, {3.6721496951806993`*^9, 
   3.672149762173316*^9}},ExpressionUUID->"105d041f-d11d-472a-b7a6-\
55d5b0c7d4a4"],

Cell[TextData[{
 StyleBox["December 2013\n",
  FontWeight->"Bold"],
 "\t\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Metric now applies FullSimplify[Inverse[#]]& to the matrix representation \
of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["g", "\[Mu]\[Nu]"], TraditionalForm]],ExpressionUUID->
  "c385d81a-6861-4e70-95cb-49b8da50fbba"],
 " to convert it to ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["g", "\[Mu]\[Nu]"], TraditionalForm]],ExpressionUUID->
  "98941dd7-075f-4a97-8bd7-6e9ff2eef842"],
 ", and similarly vice versa. Previously, to convert from ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["g", "\[Mu]\[Nu]"], TraditionalForm]],ExpressionUUID->
  "c1f56a1f-3baa-4b33-bb60-21c23f272a46"],
 " to ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["g", "\[Mu]\[Nu]"], TraditionalForm]],ExpressionUUID->
  "1cceb043-14ee-4cbc-9052-47a497b56d95"],
 ", or vice versa, it would only apply Inverse[#]&."
}], "Text",
 CellChangeTimes->{{3.5391952254569125`*^9, 3.539195640163097*^9}, {
   3.53955006359291*^9, 3.5395501346978345`*^9}, {3.5395501670990915`*^9, 
   3.539550390631884*^9}, {3.539551751874675*^9, 3.5395517613906918`*^9}, {
   3.539552377154973*^9, 3.539552451910304*^9}, {3.5396155207615376`*^9, 
   3.539615524739544*^9}, {3.5396155883252563`*^9, 3.5396156250342236`*^9}, {
   3.539634404087411*^9, 3.539634467948063*^9}, {3.539658702983876*^9, 
   3.53965871095549*^9}, {3.5396612431081476`*^9, 3.5396615769538345`*^9}, {
   3.5396616172225056`*^9, 3.539661649976963*^9}, {3.5398821994892073`*^9, 
   3.539882248779027*^9}, {3.5402291264969573`*^9, 3.5402291273160043`*^9}, {
   3.5468019316783457`*^9, 3.5468019713180156`*^9}, 3.5468020013948684`*^9, {
   3.576090752245698*^9, 3.5760908187330146`*^9}, {3.5760908545506773`*^9, 
   3.5760910170873632`*^9}, {3.5766872960881157`*^9, 3.576687366272639*^9}, {
   3.5837902958813324`*^9, 3.583790362004114*^9}, {3.585772227618986*^9, 
   3.5857723766460485`*^9}, {3.5857724160361176`*^9, 
   3.5857724217457275`*^9}, {3.585772487733843*^9, 3.585772597526836*^9}, {
   3.594234069677395*^9, 3.5942342865307264`*^9}, {3.594236245769825*^9, 
   3.594236403751252*^9}, {3.594236439967308*^9, 3.594236444402377*^9}, {
   3.5965848885218115`*^9, 3.5965851829879284`*^9}, {3.6064477129242563`*^9, 
   3.6064477170244904`*^9}, {3.6067643878025208`*^9, 
   3.6067645104187365`*^9}, {3.606764548030402*^9, 3.606764590602877*^9}, {
   3.609613720173603*^9, 3.6096137267880154`*^9}, {3.6096137886421237`*^9, 
   3.6096138439442205`*^9}, {3.6096139013367214`*^9, 3.609614191778032*^9}, {
   3.609614236846511*^9, 3.609614244334524*^9}, {3.609614445075677*^9, 
   3.6096144489912834`*^9}, {3.6294786490906897`*^9, 
   3.6294787833808775`*^9}, {3.62947881355092*^9, 3.629478818390927*^9}, {
   3.629479785061555*^9, 3.6294797863715563`*^9}, {3.629562542055464*^9, 
   3.6295625440532675`*^9}, {3.629563179524299*^9, 3.6295632164805703`*^9}, {
   3.6295634770856667`*^9, 3.6295634800078716`*^9}, {3.6295635962982955`*^9, 
   3.6295636268611546`*^9}, {3.6295636988918905`*^9, 
   3.6295637168753257`*^9}, {3.6295643246241803`*^9, 3.629564327174985*^9}, {
   3.6295643802052975`*^9, 3.6295643943321285`*^9}, 3.62956444018983*^9, {
   3.6295645910583153`*^9, 3.629564616309367*^9}, {3.629564793949936*^9, 
   3.6295648281644125`*^9}, {3.6295665105709906`*^9, 3.629566527426426*^9}, {
   3.6295667402196894`*^9, 3.6295667804318533`*^9}, {3.6295668168915315`*^9, 
   3.629566842207182*^9}, {3.629566877352854*^9, 3.6295668923634853`*^9}, {
   3.6295669401405888`*^9, 3.629566958360826*^9}, {3.6295676927117987`*^9, 
   3.6295677768997583`*^9}, {3.6295678947547846`*^9, 3.629567999329583*^9}, {
   3.6295822987213025`*^9, 3.6295823643752356`*^9}, {3.6295824139493294`*^9, 
   3.6295826420773797`*^9}, {3.629603441693468*^9, 3.6296037548778596`*^9}, {
   3.629607699840618*^9, 3.62960775507927*^9}, {3.629609623367103*^9, 
   3.6296096457134447`*^9}, {3.629611118868438*^9, 3.629611222099281*^9}, {
   3.6296966526365733`*^9, 3.629696692941445*^9}, {3.6297636071580486`*^9, 
   3.629763693559885*^9}, {3.629822036569414*^9, 3.6298220397694197`*^9}, {
   3.629822086093307*^9, 3.6298221023857403`*^9}, {3.6298221675296617`*^9, 
   3.6298221905345078`*^9}, {3.6298257059366274`*^9, 
   3.6298257837814646`*^9}, {3.6298259014543715`*^9, 3.629825999218544*^9}, {
   3.6298260411408176`*^9, 3.6298261482132063`*^9}, {3.6298266422494926`*^9, 
   3.6298266581016207`*^9}, {3.6298267861248455`*^9, 3.629826875894903*^9}, {
   3.62982690822066*^9, 3.6298271407473702`*^9}, {3.629827195279466*^9, 
   3.629827206545186*^9}, 3.6298272545121703`*^9, {3.6298273159494786`*^9, 
   3.629827323000691*^9}, {3.629827524644846*^9, 3.629827540043973*^9}, {
   3.629843695864236*^9, 3.629843768112363*^9}, {3.6298438969973907`*^9, 
   3.629843902972201*^9}, {3.6298448016472807`*^9, 3.629844837095543*^9}, {
   3.62985840203149*^9, 3.629858493510722*^9}, {3.6298657414582825`*^9, 
   3.6298657501879444`*^9}, {3.629909079007269*^9, 3.6299091181965375`*^9}, {
   3.6299263757686844`*^9, 3.6299264772814417`*^9}, {3.629929867859521*^9, 
   3.6299298729451303`*^9}, {3.6299342834705825`*^9, 
   3.6299343177282424`*^9}, {3.629938461994429*^9, 3.629938470512044*^9}, {
   3.62999370915497*^9, 3.629993709357771*^9}, 3.6299937861556067`*^9, 
   3.629993859254936*^9, {3.630203492255678*^9, 3.6302036679861917`*^9}, {
   3.630203700803055*^9, 3.6302037242280965`*^9}, {3.6303300486200323`*^9, 
   3.6303300997039537`*^9}, {3.630434289440716*^9, 3.6304344590808215`*^9}, {
   3.63063870239233*^9, 3.6306387057726374`*^9}, {3.6306914969265156`*^9, 
   3.630691522836998*^9}, {3.6306963776461215`*^9, 3.6306965559231014`*^9}, {
   3.630696629480076*^9, 3.630696650329111*^9}, {3.6306967646614947`*^9, 
   3.630696807987544*^9}, {3.6309870350982666`*^9, 3.630987055946305*^9}, {
   3.6326180036776175`*^9, 3.632618041000888*^9}, {3.633650773200718*^9, 
   3.633650875407123*^9}, {3.6695150914329014`*^9, 3.6695151469969916`*^9}, {
   3.6695340689888253`*^9, 3.669534103324486*^9}, {3.6695800385699854`*^9, 
   3.669580068158678*^9}, {3.6695801069818983`*^9, 3.6695801073199177`*^9}, {
   3.6697710716437035`*^9, 3.66977109395998*^9}, {3.669771129469011*^9, 
   3.669771147322032*^9}, {3.669771240047613*^9, 3.669771248967632*^9}, {
   3.6697712917597027`*^9, 3.669771304845722*^9}, {3.6698286373379354`*^9, 
   3.669828712054674*^9}, {3.6698397290864587`*^9, 3.6698397551453114`*^9}, {
   3.6698435572376857`*^9, 3.6698435867013707`*^9}, {3.671900284442581*^9, 
   3.6719003563897057`*^9}, {3.6719006947896194`*^9, 
   3.6719006963716235`*^9}, {3.671902989907487*^9, 3.671903150700734*^9}, {
   3.6719085682754197`*^9, 3.6719085691247215`*^9}, {3.67190902094978*^9, 
   3.671909022967884*^9}, {3.6719090611001635`*^9, 3.671909061869565*^9}, {
   3.6719095357905307`*^9, 3.6719095646735964`*^9}, {3.671909607961093*^9, 
   3.671909640559662*^9}, {3.6719096720568495`*^9, 3.6719096753777604`*^9}, {
   3.67190987991696*^9, 3.671909897029999*^9}, {3.671994989288786*^9, 
   3.671995084358223*^9}, {3.671995566580805*^9, 3.6719955978665943`*^9}, {
   3.672059857739501*^9, 3.6720598617095623`*^9}, {3.6720752906433525`*^9, 
   3.672075293958542*^9}, {3.6720753292375593`*^9, 3.6720753822145896`*^9}, {
   3.6720754410259533`*^9, 3.6720755069357233`*^9}, {3.6720827910149236`*^9, 
   3.6720828354681063`*^9}, {3.6721496951806993`*^9, 
   3.672149766183322*^9}},ExpressionUUID->"4225639f-c070-42ef-889d-\
a81e2dc4b44a"],

Cell[TextData[{
 "(",
 StyleBox["April and May) 2014\n",
  FontWeight->"Bold"],
 "\t\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Created subsections Tensor Code and Tensor Arguments. The former contains \
code related to Tensor; the latter is for documentation purposes \[LongDash] \
we need to keep track of the range of arguments that can occur within Tensor.\
\n\t\n",
 StyleBox["Update!",
  FontSlant->"Italic"],
 " New function CovariantD[",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Mu]", "-"], TraditionalForm]],ExpressionUUID->
  "a41ccc2e-f1f3-4bc5-8125-57916bf0dd42"],
 " or ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Mu]", "-"], TraditionalForm]],ExpressionUUID->
  "3d263e2c-3063-4cd9-97ba-710cb9155158"],
 ", S, m_Tensor] applies ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Del]", "\[Mu]"], TraditionalForm]],ExpressionUUID->
  "f319e602-5ad4-416c-a9b3-4efa1f8e6367"],
 " (or ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Del]", "\[Mu]"], TraditionalForm]],ExpressionUUID->
  "61f25531-9869-40d9-a985-acd61341a0a9"],
 ") on S with respect to the metric Tensor m. We assume metric compatibility.\
\n\n",
 StyleBox["Update!",
  FontSlant->"Italic"],
 " New function TensorsProduct[Times[tt__Tensor]] builds a single Tensor \
object from the sequence tt and sums over all repeated indices.\n\n",
 StyleBox["Update!",
  FontSlant->"Italic"],
 " New function SwapIndices takes in a Tensor object and swaps its indices \
and the appropriate portions of its TensorComponents.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Indices now also takes in a Tensor object and returns the RHS of its \
Indices\[Rule]RHS.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": TensorComponents now also takes in a Tensor object and returns the RHS of \
its TensorComponents\[Rule]RHS."
}], "Text",
 CellChangeTimes->{{3.5391952254569125`*^9, 3.539195640163097*^9}, {
   3.53955006359291*^9, 3.5395501346978345`*^9}, {3.5395501670990915`*^9, 
   3.539550390631884*^9}, {3.539551751874675*^9, 3.5395517613906918`*^9}, {
   3.539552377154973*^9, 3.539552451910304*^9}, {3.5396155207615376`*^9, 
   3.539615524739544*^9}, {3.5396155883252563`*^9, 3.5396156250342236`*^9}, {
   3.539634404087411*^9, 3.539634467948063*^9}, {3.539658702983876*^9, 
   3.53965871095549*^9}, {3.5396612431081476`*^9, 3.5396615769538345`*^9}, {
   3.5396616172225056`*^9, 3.539661649976963*^9}, {3.5398821994892073`*^9, 
   3.539882248779027*^9}, {3.5402291264969573`*^9, 3.5402291273160043`*^9}, {
   3.5468019316783457`*^9, 3.5468019713180156`*^9}, 3.5468020013948684`*^9, {
   3.576090752245698*^9, 3.5760908187330146`*^9}, {3.5760908545506773`*^9, 
   3.5760910170873632`*^9}, {3.5766872960881157`*^9, 3.576687366272639*^9}, {
   3.5837902958813324`*^9, 3.583790362004114*^9}, {3.585772227618986*^9, 
   3.5857723766460485`*^9}, {3.5857724160361176`*^9, 
   3.5857724217457275`*^9}, {3.585772487733843*^9, 3.585772597526836*^9}, {
   3.594234069677395*^9, 3.5942342865307264`*^9}, {3.594236245769825*^9, 
   3.594236403751252*^9}, {3.594236439967308*^9, 3.594236444402377*^9}, {
   3.5965848885218115`*^9, 3.5965851829879284`*^9}, {3.6064477129242563`*^9, 
   3.6064477170244904`*^9}, {3.6067643878025208`*^9, 
   3.6067645104187365`*^9}, {3.606764548030402*^9, 3.606764590602877*^9}, {
   3.609613720173603*^9, 3.6096137267880154`*^9}, {3.6096137886421237`*^9, 
   3.6096138439442205`*^9}, {3.6096139013367214`*^9, 3.609614191778032*^9}, {
   3.609614236846511*^9, 3.609614244334524*^9}, {3.609614445075677*^9, 
   3.6096144489912834`*^9}, {3.6294786490906897`*^9, 
   3.6294787833808775`*^9}, {3.62947881355092*^9, 3.629478818390927*^9}, {
   3.629479785061555*^9, 3.6294797863715563`*^9}, {3.629562542055464*^9, 
   3.6295625440532675`*^9}, {3.629563179524299*^9, 3.6295632164805703`*^9}, {
   3.6295634770856667`*^9, 3.6295634800078716`*^9}, {3.6295635962982955`*^9, 
   3.6295636268611546`*^9}, {3.6295636988918905`*^9, 
   3.6295637168753257`*^9}, {3.6295643246241803`*^9, 3.629564327174985*^9}, {
   3.6295643802052975`*^9, 3.6295643943321285`*^9}, 3.62956444018983*^9, {
   3.6295645910583153`*^9, 3.629564616309367*^9}, {3.629564793949936*^9, 
   3.6295648281644125`*^9}, {3.6295665105709906`*^9, 3.629566527426426*^9}, {
   3.6295667402196894`*^9, 3.6295667804318533`*^9}, {3.6295668168915315`*^9, 
   3.629566842207182*^9}, {3.629566877352854*^9, 3.6295668923634853`*^9}, {
   3.6295669401405888`*^9, 3.629566958360826*^9}, {3.6295676927117987`*^9, 
   3.6295677768997583`*^9}, {3.6295678947547846`*^9, 3.629567999329583*^9}, {
   3.6295822987213025`*^9, 3.6295823643752356`*^9}, {3.6295824139493294`*^9, 
   3.6295826420773797`*^9}, {3.629603441693468*^9, 3.6296037548778596`*^9}, {
   3.629607699840618*^9, 3.62960775507927*^9}, {3.629609623367103*^9, 
   3.6296096457134447`*^9}, {3.629611118868438*^9, 3.629611222099281*^9}, {
   3.6296966526365733`*^9, 3.629696692941445*^9}, {3.6297636071580486`*^9, 
   3.629763693559885*^9}, {3.629822036569414*^9, 3.6298220397694197`*^9}, {
   3.629822086093307*^9, 3.6298221023857403`*^9}, {3.6298221675296617`*^9, 
   3.6298221905345078`*^9}, {3.6298257059366274`*^9, 
   3.6298257837814646`*^9}, {3.6298259014543715`*^9, 3.629825999218544*^9}, {
   3.6298260411408176`*^9, 3.6298261482132063`*^9}, {3.6298266422494926`*^9, 
   3.6298266581016207`*^9}, {3.6298267861248455`*^9, 3.629826875894903*^9}, {
   3.62982690822066*^9, 3.6298271407473702`*^9}, {3.629827195279466*^9, 
   3.629827206545186*^9}, 3.6298272545121703`*^9, {3.6298273159494786`*^9, 
   3.629827323000691*^9}, {3.629827524644846*^9, 3.629827540043973*^9}, {
   3.629843695864236*^9, 3.629843768112363*^9}, {3.6298438969973907`*^9, 
   3.629843902972201*^9}, {3.6298448016472807`*^9, 3.629844837095543*^9}, {
   3.62985840203149*^9, 3.629858493510722*^9}, {3.6298657414582825`*^9, 
   3.6298657501879444`*^9}, {3.629909079007269*^9, 3.6299091181965375`*^9}, {
   3.6299263757686844`*^9, 3.6299264772814417`*^9}, {3.629929867859521*^9, 
   3.6299298729451303`*^9}, {3.6299342834705825`*^9, 
   3.6299343177282424`*^9}, {3.629938461994429*^9, 3.629938470512044*^9}, {
   3.62999370915497*^9, 3.629993709357771*^9}, 3.6299937861556067`*^9, 
   3.629993859254936*^9, {3.630203492255678*^9, 3.6302036679861917`*^9}, {
   3.630203700803055*^9, 3.6302037242280965`*^9}, {3.6303300486200323`*^9, 
   3.6303300997039537`*^9}, {3.630434289440716*^9, 3.6304344590808215`*^9}, {
   3.63063870239233*^9, 3.6306387057726374`*^9}, {3.6306914969265156`*^9, 
   3.630691522836998*^9}, {3.6306963776461215`*^9, 3.6306965559231014`*^9}, {
   3.630696629480076*^9, 3.630696650329111*^9}, {3.6306967646614947`*^9, 
   3.630696807987544*^9}, {3.6309870350982666`*^9, 3.630987055946305*^9}, {
   3.6326180036776175`*^9, 3.632618041000888*^9}, {3.633650773200718*^9, 
   3.633650875407123*^9}, {3.6695150914329014`*^9, 3.6695151469969916`*^9}, {
   3.6695340689888253`*^9, 3.669534103324486*^9}, {3.6695800385699854`*^9, 
   3.669580068158678*^9}, {3.6695801069818983`*^9, 3.6695801073199177`*^9}, {
   3.6697710716437035`*^9, 3.66977109395998*^9}, {3.669771129469011*^9, 
   3.669771147322032*^9}, {3.669771240047613*^9, 3.669771248967632*^9}, {
   3.6697712917597027`*^9, 3.669771304845722*^9}, {3.6698286373379354`*^9, 
   3.669828712054674*^9}, {3.6698397290864587`*^9, 3.6698397551453114`*^9}, {
   3.6698435572376857`*^9, 3.6698435867013707`*^9}, {3.671900284442581*^9, 
   3.6719003563897057`*^9}, {3.6719006947896194`*^9, 
   3.6719006963716235`*^9}, {3.671902989907487*^9, 3.671903150700734*^9}, {
   3.6719085682754197`*^9, 3.6719085691247215`*^9}, {3.67190902094978*^9, 
   3.671909022967884*^9}, {3.6719090611001635`*^9, 3.671909061869565*^9}, {
   3.6719095357905307`*^9, 3.6719095646735964`*^9}, {3.671909607961093*^9, 
   3.671909640559662*^9}, {3.6719096720568495`*^9, 3.6719096753777604`*^9}, {
   3.67190987991696*^9, 3.671909897029999*^9}, {3.671994989288786*^9, 
   3.671995084358223*^9}, {3.671995566580805*^9, 3.6719955978665943`*^9}, {
   3.672059857739501*^9, 3.6720598617095623`*^9}, {3.6720752906433525`*^9, 
   3.672075293958542*^9}, {3.6720753292375593`*^9, 3.6720753822145896`*^9}, {
   3.6720754410259533`*^9, 3.6720755069357233`*^9}, {3.6720827910149236`*^9, 
   3.6720828354681063`*^9}, {3.6721496951806993`*^9, 3.672149771265831*^9}, 
   3.895073261943859*^9, 
   3.895549052255018*^9},ExpressionUUID->"e6dffbbf-2f6d-4d0c-b056-\
bd861796db5e"],

Cell[TextData[{
 StyleBox["January 2015\n",
  FontWeight->"Bold"],
 "\n",
 StyleBox["Update!",
  FontSlant->"Italic"],
 " New function Einstein[\[Mu],\[Nu],MetricTensor_Tensor,EinsteinOperator\
\[Rule]",
 StyleBox["op",
  FontSlant->"Italic"],
 "] computes the Einstein tensor of the metric MetricTensor and applies the \
operator ",
 StyleBox["op",
  FontSlant->"Italic"],
 " to it. EinsteinOperator is optional; the default is ",
 StyleBox["op",
  FontSlant->"Italic"],
 " = FullSimplify.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Previously, when and only when all its indices are Integers or all of \
them are Coordinates, does Tensor returns the \tcorresponding component. We \
have now updated this to allow mixed Integer/Coordinate indices, i.e., as \
long as non of the indices are abstract ones, TensoriaCalc will return the \
corresponding component of the Tensor. Also: (1) Duplicate code was deleted. \
(2) The condition that the Integer be \[GreaterEqual] 0 was removed. \n\t\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Previously, when and only when all its indices are Integers or all of \
them are Coordinates, does Tensor returns the \tcorresponding component. Now, \
Tensor is updated such that, as long as one or more of its indices are not \
abstract ones, the TensorComponents would be reduced in rank accordingly, for \
e.g., ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["g", 
    RowBox[{
     RowBox[{"Underbar", "[", "0", "]"}], "\[Nu]"}]], TraditionalForm]],
  ExpressionUUID->"a93bc01c-cf64-4a41-bebc-be074e672702"],
 " (constructed from the Metric) is now a vector. We Apply UnderBar to the \
non-abstract index as a bookkeeping device, so that TensoriaCalc will treat \
it as a scalar.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": (Internal) UpOrDown[\[Mu]_] was previously defined with \
TestIndices[\[Mu]] imposed. This constraint has now been dropped.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": When defining the appearance of non-Metric Tensors, we previously imposed \
the constraint that all indices must be Symbolic ones. This constraint has \
now been dropped.\n\t\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Repeated indices occurring within a single Tensor are now automatically \
summed over. Underbar is then applied to these repeated indices for \
bookkeeping purposes, so that TensoriaCalc will treat them as a scalars.\n\t\n\
",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": CovariantD now allows for the \[Del]-index and one of the input Tensor's \
index to be repeated.\n\t\n",
 StyleBox["Update!",
  FontSlant->"Italic"],
 " New function \
Weyl[\[Alpha],\[Beta],\[Mu],\[Nu],MetricTensor_Tensor,WeylOperator\[Rule]",
 StyleBox["op",
  FontSlant->"Italic"],
 "] computes the Weyl tensor of the metric MetricTensor and applies the \
operator ",
 StyleBox["op",
  FontSlant->"Italic"],
 " to it. WeylOperator is optional; the default is ",
 StyleBox["op",
  FontSlant->"Italic"],
 " = FullSimplify.\n\t\n",
 StyleBox["Update!",
  FontSlant->"Italic"],
 " New function ZeroTensorQ[stuff_Tensor] returns True if every component of \
the Tensor stuff is zero and False otherwise.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": (Internal) NotAbstractIndex[\[Mu]] returns True if \[Mu] is not an \
abstract index (\[Congruent] ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"SuperMinus", " ", "or", " ", "SubMinus"}], ")"}], 
   TraditionalForm]],ExpressionUUID->"485dc74d-a967-4a87-bd6e-1659b9c3a006"],
 "[_Symbol or _Integer]) and False otherwise.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": (Internal) TestScalarTensor[m_Tensor] returns True if the Tensor m is a \
scalar and False otherwise.\n\t\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": (Internal) RemoveUnderBarredIndices[\[Mu]T_List] removes from the list of \
indices \[Mu]T all indices with UnderBar applied to them.\n\t\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": (Internal) RemoveRepeatedUnderBarredIndices[\[Mu]T_List] removes from the \
list of indices \[Mu]T all repeated UnderBarred indices.\n\t\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": (Internal) NestedDel[dd_Del] takes an expression of the form \
Del[...Del[stuff]] and peels off the Del's one by one until the Head of stuff \
is not Del. Returns {# of Del's, stuff}.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": \"Update History\" format changed slightly.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Previously, TensorComponents distinguished between whether the input \
Tensor was a scalar or higher rank tensor. This is not necessary, and the \
code has been simplified.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": SwapIndices updated to account for the presence of UnderBarred indices.\n\
\n",
 StyleBox["Update",
  FontSlant->"Italic",
  FontColor->GrayLevel[0]],
 ": Until further notice we will not use TensorsProduct in internal \
TensoriaCalc code, because TensorsProduct is not properly developed. To this \
end, the CovariantD code has been modified.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Sgn code simplified.\n\n",
 StyleBox["Update!",
  FontSlant->"Italic"],
 " New function PartialD[\[Mu],stuff_,MetricM_Tensor] returns the partial \
derivative of stuff using the Metric Tensor MetricM.\n\n",
 StyleBox["Bug Fix",
  FontSlant->"Italic"],
 ": Raising and lowering of the indices of the Ricci tensor has been \
de-bugged. Previously, the left index was raised/lowered instead of the right \
index, and vice versa. :-/\n\n",
 StyleBox["Update!",
  FontSlant->"Italic"],
 " New function NonMetricTensor returns a user defined Tensor object.\n\n",
 StyleBox["Update!",
  FontSlant->"Italic"],
 " MoveIndices[tt_Tensor,idx_List,m_Tensor] raises/lower indices of tt, as \
specified by the idx, using the Metric Tensor m. Suppose tt has indices {",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Alpha]", "-"], TraditionalForm]],ExpressionUUID->
  "d112a1c3-4029-48d1-91c6-dcd28024f964"],
 ", ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Beta]", "-"], TraditionalForm]],ExpressionUUID->
  "c9383c18-d4d7-4a4b-bb00-840b62900c1f"],
 " ,",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Mu]", "-"], TraditionalForm]],ExpressionUUID->
  "4267b9bf-5146-44a8-8a6e-8a51dac0881d"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Nu]", "-"], TraditionalForm]],ExpressionUUID->
  "558dee5d-f074-4460-92d7-dc734b0098a6"],
 "} and \[Alpha] and \[Mu] needs to be raised and lowered respectively, then \
do MoveIndices[tt_Tensor,{",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[Alpha]", "-"], ",", 
    SubscriptBox["\[Mu]", "-"]}], TraditionalForm]],ExpressionUUID->
  "d236da68-e1a6-40ae-9655-4cd3b68a7274"],
 "},m].\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": All the default settings for RiemannOperator, WeylOperator, etc. have \
been changed from FullSimplify to Simplify to reduce computation time.\n\n",
 StyleBox["Update:",
  FontSlant->"Italic"],
 " All scalar, rank 1 and rank 2 tensors \[LongDash] including Metric Tensors \
\[LongDash] will now be displayed as their TensorNames with appropriate \
indices attached (e.g., ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["g", "\[Mu]\[Nu]"], TraditionalForm]],ExpressionUUID->
  "8f30d566-fa5e-4dca-a25c-0a92fa0913ab"],
 "). (Previously, the Metric Tensor, in particular, was displayed with a \
Tensor Head with the components of the Ricci tensor/scalar, Christoffel \
symbols, Riemann tensor, etc., as its arguments.) Hovering the mouse cursor \
over these scalar, vectors and tensors will display their TensorComponents \
and the coordinates used.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": When Metric Tensor has one up and one down index, the TensorName is \
changed to \[Delta]."
}], "Text",
 CellChangeTimes->{{3.5391952254569125`*^9, 3.539195640163097*^9}, {
   3.53955006359291*^9, 3.5395501346978345`*^9}, {3.5395501670990915`*^9, 
   3.539550390631884*^9}, {3.539551751874675*^9, 3.5395517613906918`*^9}, {
   3.539552377154973*^9, 3.539552451910304*^9}, {3.5396155207615376`*^9, 
   3.539615524739544*^9}, {3.5396155883252563`*^9, 3.5396156250342236`*^9}, {
   3.539634404087411*^9, 3.539634467948063*^9}, {3.539658702983876*^9, 
   3.53965871095549*^9}, {3.5396612431081476`*^9, 3.5396615769538345`*^9}, {
   3.5396616172225056`*^9, 3.539661649976963*^9}, {3.5398821994892073`*^9, 
   3.539882248779027*^9}, {3.5402291264969573`*^9, 3.5402291273160043`*^9}, {
   3.5468019316783457`*^9, 3.5468019713180156`*^9}, 3.5468020013948684`*^9, {
   3.576090752245698*^9, 3.5760908187330146`*^9}, {3.5760908545506773`*^9, 
   3.5760910170873632`*^9}, {3.5766872960881157`*^9, 3.576687366272639*^9}, {
   3.5837902958813324`*^9, 3.583790362004114*^9}, {3.585772227618986*^9, 
   3.5857723766460485`*^9}, {3.5857724160361176`*^9, 
   3.5857724217457275`*^9}, {3.585772487733843*^9, 3.585772597526836*^9}, {
   3.594234069677395*^9, 3.5942342865307264`*^9}, {3.594236245769825*^9, 
   3.594236403751252*^9}, {3.594236439967308*^9, 3.594236444402377*^9}, {
   3.5965848885218115`*^9, 3.5965851829879284`*^9}, {3.6064477129242563`*^9, 
   3.6064477170244904`*^9}, {3.6067643878025208`*^9, 
   3.6067645104187365`*^9}, {3.606764548030402*^9, 3.606764590602877*^9}, {
   3.609613720173603*^9, 3.6096137267880154`*^9}, {3.6096137886421237`*^9, 
   3.6096138439442205`*^9}, {3.6096139013367214`*^9, 3.609614191778032*^9}, {
   3.609614236846511*^9, 3.609614244334524*^9}, {3.609614445075677*^9, 
   3.6096144489912834`*^9}, {3.6294786490906897`*^9, 
   3.6294787833808775`*^9}, {3.62947881355092*^9, 3.629478818390927*^9}, {
   3.629479785061555*^9, 3.6294797863715563`*^9}, {3.629562542055464*^9, 
   3.6295625440532675`*^9}, {3.629563179524299*^9, 3.6295632164805703`*^9}, {
   3.6295634770856667`*^9, 3.6295634800078716`*^9}, {3.6295635962982955`*^9, 
   3.6295636268611546`*^9}, {3.6295636988918905`*^9, 
   3.6295637168753257`*^9}, {3.6295643246241803`*^9, 3.629564327174985*^9}, {
   3.6295643802052975`*^9, 3.6295643943321285`*^9}, 3.62956444018983*^9, {
   3.6295645910583153`*^9, 3.629564616309367*^9}, {3.629564793949936*^9, 
   3.6295648281644125`*^9}, {3.6295665105709906`*^9, 3.629566527426426*^9}, {
   3.6295667402196894`*^9, 3.6295667804318533`*^9}, {3.6295668168915315`*^9, 
   3.629566842207182*^9}, {3.629566877352854*^9, 3.6295668923634853`*^9}, {
   3.6295669401405888`*^9, 3.629566958360826*^9}, {3.6295676927117987`*^9, 
   3.6295677768997583`*^9}, {3.6295678947547846`*^9, 3.629567999329583*^9}, {
   3.6295822987213025`*^9, 3.6295823643752356`*^9}, {3.6295824139493294`*^9, 
   3.6295826420773797`*^9}, {3.629603441693468*^9, 3.6296037548778596`*^9}, {
   3.629607699840618*^9, 3.62960775507927*^9}, {3.629609623367103*^9, 
   3.6296096457134447`*^9}, {3.629611118868438*^9, 3.629611222099281*^9}, {
   3.6296966526365733`*^9, 3.629696692941445*^9}, {3.6297636071580486`*^9, 
   3.629763693559885*^9}, {3.629822036569414*^9, 3.6298220397694197`*^9}, {
   3.629822086093307*^9, 3.6298221023857403`*^9}, {3.6298221675296617`*^9, 
   3.6298221905345078`*^9}, {3.6298257059366274`*^9, 
   3.6298257837814646`*^9}, {3.6298259014543715`*^9, 3.629825999218544*^9}, {
   3.6298260411408176`*^9, 3.6298261482132063`*^9}, {3.6298266422494926`*^9, 
   3.6298266581016207`*^9}, {3.6298267861248455`*^9, 3.629826875894903*^9}, {
   3.62982690822066*^9, 3.6298271407473702`*^9}, {3.629827195279466*^9, 
   3.629827206545186*^9}, 3.6298272545121703`*^9, {3.6298273159494786`*^9, 
   3.629827323000691*^9}, {3.629827524644846*^9, 3.629827540043973*^9}, {
   3.629843695864236*^9, 3.629843768112363*^9}, {3.6298438969973907`*^9, 
   3.629843902972201*^9}, {3.6298448016472807`*^9, 3.629844837095543*^9}, {
   3.62985840203149*^9, 3.629858493510722*^9}, {3.6298657414582825`*^9, 
   3.6298657501879444`*^9}, {3.629909079007269*^9, 3.6299091181965375`*^9}, {
   3.6299263757686844`*^9, 3.6299264772814417`*^9}, {3.629929867859521*^9, 
   3.6299298729451303`*^9}, {3.6299342834705825`*^9, 
   3.6299343177282424`*^9}, {3.629938461994429*^9, 3.629938470512044*^9}, {
   3.62999370915497*^9, 3.629993709357771*^9}, 3.6299937861556067`*^9, 
   3.629993859254936*^9, {3.630203492255678*^9, 3.6302036679861917`*^9}, {
   3.630203700803055*^9, 3.6302037242280965`*^9}, {3.6303300486200323`*^9, 
   3.6303300997039537`*^9}, {3.630434289440716*^9, 3.6304344590808215`*^9}, {
   3.63063870239233*^9, 3.6306387057726374`*^9}, {3.6306914969265156`*^9, 
   3.630691522836998*^9}, {3.6306963776461215`*^9, 3.6306965559231014`*^9}, {
   3.630696629480076*^9, 3.630696650329111*^9}, {3.6306967646614947`*^9, 
   3.630696807987544*^9}, {3.6309870350982666`*^9, 3.630987055946305*^9}, {
   3.6326180036776175`*^9, 3.632618041000888*^9}, {3.633650773200718*^9, 
   3.633650875407123*^9}, {3.6695150914329014`*^9, 3.6695151469969916`*^9}, {
   3.6695340689888253`*^9, 3.669534103324486*^9}, {3.6695800385699854`*^9, 
   3.669580068158678*^9}, {3.6695801069818983`*^9, 3.6695801073199177`*^9}, {
   3.6697710716437035`*^9, 3.66977109395998*^9}, {3.669771129469011*^9, 
   3.669771147322032*^9}, {3.669771240047613*^9, 3.669771248967632*^9}, {
   3.6697712917597027`*^9, 3.669771304845722*^9}, {3.6698286373379354`*^9, 
   3.669828712054674*^9}, {3.6698397290864587`*^9, 3.6698397551453114`*^9}, {
   3.6698435572376857`*^9, 3.6698435867013707`*^9}, {3.671900284442581*^9, 
   3.6719003563897057`*^9}, {3.6719006947896194`*^9, 
   3.6719006963716235`*^9}, {3.671902989907487*^9, 3.671903150700734*^9}, {
   3.6719085682754197`*^9, 3.6719085691247215`*^9}, {3.67190902094978*^9, 
   3.671909022967884*^9}, {3.6719090611001635`*^9, 3.671909061869565*^9}, {
   3.6719095357905307`*^9, 3.6719095646735964`*^9}, {3.671909607961093*^9, 
   3.671909640559662*^9}, {3.6719096720568495`*^9, 3.6719096753777604`*^9}, {
   3.67190987991696*^9, 3.671909897029999*^9}, {3.671994989288786*^9, 
   3.671995084358223*^9}, {3.671995566580805*^9, 3.6719955978665943`*^9}, {
   3.672059857739501*^9, 3.6720598617095623`*^9}, {3.6720752906433525`*^9, 
   3.672075293958542*^9}, {3.6720753292375593`*^9, 3.6720753822145896`*^9}, {
   3.6720754410259533`*^9, 3.6720755069357233`*^9}, {3.6720827910149236`*^9, 
   3.6720828354681063`*^9}, {3.6721496951806993`*^9, 3.672149782513352*^9}, 
   3.893289125024084*^9, {3.8950732621469765`*^9, 3.8950732623032265`*^9}, {
   3.8955490524931164`*^9, 3.8955490526549597`*^9}, 3.895554775581361*^9, 
   3.895555340266024*^9, 
   3.973765546077215*^9},ExpressionUUID->"219c5f04-52cf-4dae-967b-\
47f3912e2bec"],

Cell[TextData[{
 StyleBox["February 2015\n",
  FontWeight->"Bold"],
 "\n",
 StyleBox["Update:",
  FontSlant->"Italic"],
 " Previously ZeroTensorQ does not account for scalars. Now it does.\n\n",
 StyleBox["Update:",
  FontSlant->"Italic"],
 " Previously the description of Metric did not include the optional \
arguments ChristoffelOperator\[Rule]op, RiemannOperator\[Rule]op, \
RicciOperator\[Rule]op, RicciScalarOperator\[Rule]op. Now it does."
}], "Text",
 CellChangeTimes->{{3.5391952254569125`*^9, 3.539195640163097*^9}, {
   3.53955006359291*^9, 3.5395501346978345`*^9}, {3.5395501670990915`*^9, 
   3.539550390631884*^9}, {3.539551751874675*^9, 3.5395517613906918`*^9}, {
   3.539552377154973*^9, 3.539552451910304*^9}, {3.5396155207615376`*^9, 
   3.539615524739544*^9}, {3.5396155883252563`*^9, 3.5396156250342236`*^9}, {
   3.539634404087411*^9, 3.539634467948063*^9}, {3.539658702983876*^9, 
   3.53965871095549*^9}, {3.5396612431081476`*^9, 3.5396615769538345`*^9}, {
   3.5396616172225056`*^9, 3.539661649976963*^9}, {3.5398821994892073`*^9, 
   3.539882248779027*^9}, {3.5402291264969573`*^9, 3.5402291273160043`*^9}, {
   3.5468019316783457`*^9, 3.5468019713180156`*^9}, 3.5468020013948684`*^9, {
   3.576090752245698*^9, 3.5760908187330146`*^9}, {3.5760908545506773`*^9, 
   3.5760910170873632`*^9}, {3.5766872960881157`*^9, 3.576687366272639*^9}, {
   3.5837902958813324`*^9, 3.583790362004114*^9}, {3.585772227618986*^9, 
   3.5857723766460485`*^9}, {3.5857724160361176`*^9, 
   3.5857724217457275`*^9}, {3.585772487733843*^9, 3.585772597526836*^9}, {
   3.594234069677395*^9, 3.5942342865307264`*^9}, {3.594236245769825*^9, 
   3.594236403751252*^9}, {3.594236439967308*^9, 3.594236444402377*^9}, {
   3.5965848885218115`*^9, 3.5965851829879284`*^9}, {3.6064477129242563`*^9, 
   3.6064477170244904`*^9}, {3.6067643878025208`*^9, 
   3.6067645104187365`*^9}, {3.606764548030402*^9, 3.606764590602877*^9}, {
   3.609613720173603*^9, 3.6096137267880154`*^9}, {3.6096137886421237`*^9, 
   3.6096138439442205`*^9}, {3.6096139013367214`*^9, 3.609614191778032*^9}, {
   3.609614236846511*^9, 3.609614244334524*^9}, {3.609614445075677*^9, 
   3.6096144489912834`*^9}, {3.6294786490906897`*^9, 
   3.6294787833808775`*^9}, {3.62947881355092*^9, 3.629478818390927*^9}, {
   3.629479785061555*^9, 3.6294797863715563`*^9}, {3.629562542055464*^9, 
   3.6295625440532675`*^9}, {3.629563179524299*^9, 3.6295632164805703`*^9}, {
   3.6295634770856667`*^9, 3.6295634800078716`*^9}, {3.6295635962982955`*^9, 
   3.6295636268611546`*^9}, {3.6295636988918905`*^9, 
   3.6295637168753257`*^9}, {3.6295643246241803`*^9, 3.629564327174985*^9}, {
   3.6295643802052975`*^9, 3.6295643943321285`*^9}, 3.62956444018983*^9, {
   3.6295645910583153`*^9, 3.629564616309367*^9}, {3.629564793949936*^9, 
   3.6295648281644125`*^9}, {3.6295665105709906`*^9, 3.629566527426426*^9}, {
   3.6295667402196894`*^9, 3.6295667804318533`*^9}, {3.6295668168915315`*^9, 
   3.629566842207182*^9}, {3.629566877352854*^9, 3.6295668923634853`*^9}, {
   3.6295669401405888`*^9, 3.629566958360826*^9}, {3.6295676927117987`*^9, 
   3.6295677768997583`*^9}, {3.6295678947547846`*^9, 3.629567999329583*^9}, {
   3.6295822987213025`*^9, 3.6295823643752356`*^9}, {3.6295824139493294`*^9, 
   3.6295826420773797`*^9}, {3.629603441693468*^9, 3.6296037548778596`*^9}, {
   3.629607699840618*^9, 3.62960775507927*^9}, {3.629609623367103*^9, 
   3.6296096457134447`*^9}, {3.629611118868438*^9, 3.629611222099281*^9}, {
   3.6296966526365733`*^9, 3.629696692941445*^9}, {3.6297636071580486`*^9, 
   3.629763693559885*^9}, {3.629822036569414*^9, 3.6298220397694197`*^9}, {
   3.629822086093307*^9, 3.6298221023857403`*^9}, {3.6298221675296617`*^9, 
   3.6298221905345078`*^9}, {3.6298257059366274`*^9, 
   3.6298257837814646`*^9}, {3.6298259014543715`*^9, 3.629825999218544*^9}, {
   3.6298260411408176`*^9, 3.6298261482132063`*^9}, {3.6298266422494926`*^9, 
   3.6298266581016207`*^9}, {3.6298267861248455`*^9, 3.629826875894903*^9}, {
   3.62982690822066*^9, 3.6298271407473702`*^9}, {3.629827195279466*^9, 
   3.629827206545186*^9}, 3.6298272545121703`*^9, {3.6298273159494786`*^9, 
   3.629827323000691*^9}, {3.629827524644846*^9, 3.629827540043973*^9}, {
   3.629843695864236*^9, 3.629843768112363*^9}, {3.6298438969973907`*^9, 
   3.629843902972201*^9}, {3.6298448016472807`*^9, 3.629844837095543*^9}, {
   3.62985840203149*^9, 3.629858493510722*^9}, {3.6298657414582825`*^9, 
   3.6298657501879444`*^9}, {3.629909079007269*^9, 3.6299091181965375`*^9}, {
   3.6299263757686844`*^9, 3.6299264772814417`*^9}, {3.629929867859521*^9, 
   3.6299298729451303`*^9}, {3.6299342834705825`*^9, 
   3.6299343177282424`*^9}, {3.629938461994429*^9, 3.629938470512044*^9}, {
   3.62999370915497*^9, 3.629993709357771*^9}, 3.6299937861556067`*^9, 
   3.629993859254936*^9, {3.630203492255678*^9, 3.6302036679861917`*^9}, {
   3.630203700803055*^9, 3.6302037242280965`*^9}, {3.6303300486200323`*^9, 
   3.6303300997039537`*^9}, {3.630434289440716*^9, 3.6304344590808215`*^9}, {
   3.63063870239233*^9, 3.6306387057726374`*^9}, {3.6306914969265156`*^9, 
   3.630691522836998*^9}, {3.6306963776461215`*^9, 3.6306965559231014`*^9}, {
   3.630696629480076*^9, 3.630696650329111*^9}, {3.6306967646614947`*^9, 
   3.630696807987544*^9}, {3.6309870350982666`*^9, 3.630987055946305*^9}, {
   3.6326180036776175`*^9, 3.632618041000888*^9}, {3.633650773200718*^9, 
   3.633650875407123*^9}, {3.6695150914329014`*^9, 3.6695151469969916`*^9}, {
   3.6695340689888253`*^9, 3.669534103324486*^9}, {3.6695800385699854`*^9, 
   3.669580068158678*^9}, {3.6695801069818983`*^9, 3.6695801073199177`*^9}, {
   3.6697710716437035`*^9, 3.66977109395998*^9}, {3.669771129469011*^9, 
   3.669771147322032*^9}, {3.669771240047613*^9, 3.669771248967632*^9}, {
   3.6697712917597027`*^9, 3.669771304845722*^9}, {3.6698286373379354`*^9, 
   3.669828712054674*^9}, {3.6698397290864587`*^9, 3.6698397551453114`*^9}, {
   3.6698435572376857`*^9, 3.6698435867013707`*^9}, {3.671900284442581*^9, 
   3.6719003563897057`*^9}, {3.6719006947896194`*^9, 
   3.6719006963716235`*^9}, {3.671902989907487*^9, 3.671903150700734*^9}, {
   3.6719085682754197`*^9, 3.6719085691247215`*^9}, {3.67190902094978*^9, 
   3.671909022967884*^9}, {3.6719090611001635`*^9, 3.671909061869565*^9}, {
   3.6719095357905307`*^9, 3.6719095646735964`*^9}, {3.671909607961093*^9, 
   3.671909640559662*^9}, {3.6719096720568495`*^9, 3.6719096753777604`*^9}, {
   3.67190987991696*^9, 3.671909897029999*^9}, {3.671994989288786*^9, 
   3.671995084358223*^9}, {3.671995566580805*^9, 3.6719955978665943`*^9}, {
   3.672059857739501*^9, 3.6720598617095623`*^9}, {3.6720752906433525`*^9, 
   3.672075293958542*^9}, {3.6720753292375593`*^9, 3.6720753822145896`*^9}, {
   3.6720754410259533`*^9, 3.6720755069357233`*^9}, {3.6720827910149236`*^9, 
   3.6720828354681063`*^9}, {3.6721496951806993`*^9, 3.672149786135858*^9}, 
   3.973765546081574*^9},ExpressionUUID->"dfdae96a-3060-44da-84f7-\
d41e581edf1b"],

Cell[TextData[{
 "(",
 StyleBox["April and May) 2016\n",
  FontWeight->"Bold"],
 "\n",
 StyleBox["Update!",
  FontSlant->"Italic"],
 " New function LeviCivita implements the generally covariant Levi-Civita \
(pseudo-)tensor.\n\n",
 StyleBox["Update!",
  FontSlant->"Italic"],
 " New function CovariantHodgeDual implements the generall covariant Hodge \
dual (aka Hodge star) operation. It checks whether the tensor whose dual is \
being computed is fully antisymmetric.\n\n",
 StyleBox["Update!",
  FontSlant->"Italic"],
 " New function UniqueIndices takes in a Tensor and returns the same Tensor \
but with its indices replaced with Unique ones.\n\n",
 StyleBox["Update!",
  FontSlant->"Italic"],
 " New function RaiseAllIndices[t,m] takes in a tensor t and returns it with \
all indices raised using the Metric Tensor m.\n\n",
 StyleBox["Update!",
  FontSlant->"Italic"],
 " New function LowerAllIndices[t,m] takes in a tensor t and returns it with \
all indices lowered using the Metric Tensor m.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": (Internal) TestMetricTensor[m_Tensor] returns True if m is of type \
\"Metric\" and False otherwise.\n\nUpdate: Previously, Coordinates only reads \
coordinates from a Metric Tensor. Now it reads in any Tensor.\n\nUpdate: The \
portion of code in CovariantD involving Christoffel symbols was re-written to \
exploit TensorProduct, TensorContract and Transpose.\n\n",
 StyleBox["Update!!",
  FontSlant->"Italic"],
 " New functions pre-pended with \"MHD\" implement the PDEs of ideal MHD in \
4D curved spacetimes. Currently, the main functions are:\n\t\tMHDSystem, \
MHDMaxwellCurrent, MHDEquations, MHDMetricTensor, MHDScalar, MHD3Form, \
MHDPlasmaCurrent, MHDMaxwell, \n\t\tMHDMaxwellCurrent, MHDRank2P, \
MHDEnergyMomentumShearStress, MHDMetric, MHDLagrangian, \
MHDPlasmaEnergyDensity\n\tNote: MHDSystem allows either sign conventions for \
the metric to be used.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": TensorComponents now threads over Plus automatically.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Now, TensorComponents[(Non-Tensor stuff) x Tensor1 x Tensor2 ...] = \
(Non-Tensor stuff) TensorComponents[Tensor1 x Tensor2 ...].\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Tensor Code involving Einstein summation has been simplified to use \
TensorContract directly/solely. Previously, an additional contraction \
involving the identity matrix was employed.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": MoveIndices code re-written to employ TensorProduct, Transpose and \
TensorContract.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": TensorsProduct is re-instated. It now perform a TensorProduct of sorts of \
Tensor objects, but \[LongDash] for now \[LongDash] only those Tensors with \
the same Coordinates.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": (Internal) FormatTensorName will be applied to TensorName of a Tensor to \
format it in special cases, for e.g., when Tensor is a TensorProduct.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Now, CovariantD[\[Mu]_,(Non-Tensor stuff) x Tensor1 x Tensor2 ...,m_] = \
(Non-Tensor stuff) CovariantD[\[Mu], Tensor1 x Tensor2 ..., m]; CovariantD \
distributes over Plus; and CovariantD now acts on a product of Tensors ",
 StyleBox["m",
  FontSlant->"Italic"],
 " by first applying TensorsProduct to ",
 StyleBox["m",
  FontSlant->"Italic"],
 ", so that CovariantD can act on it as a single Tensor object. CovariantD \
now also obeys the product rule of differentiation.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": TensorSymmetry[m_Tensor] now does TensorSymmetry[TensorComponents[m]].\n\n\
",
 StyleBox["Spring 2016\n",
  FontWeight->"Bold"],
 "\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Ideal Magneto-hydrodynamics (iMHD) functionality added. Updates to \
iMHD-related functions will appear in its subsection above.\n\n",
 StyleBox["October 2017\n",
  FontWeight->"Bold"],
 "\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": GeodesicSystem takes in as input a Metric Tensor, an affine parameter, \
and a non-affine parameter; and outputs a List: {Geodesic Lagrangian in \
affine parameter form, Geodesic Lagrangian in non-affine parameter form, \
Geodesic equations in affine parameter form, Geodesic equations in non-affine \
parameter form}.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": GeodesicLagrangians takes in as input a Metric Tensor, an affine \
parameter, and a non-affine parameter; and outputs a List: {Geodesic \
Lagrangian in affine parameter form, Geodesic Lagrangian in non-affine \
parameter form}. That is, it does what GeodesicSystem does, but does not \
output the geodesic equations themselves.\n\n",
 StyleBox["February 2018\n",
  FontWeight->"Bold"],
 "\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": ToTensor returns a Tensor.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": LieD returns the Lie derivative of a metric.\n\n",
 StyleBox["May 2019\n",
  FontWeight->"Bold"],
 "\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " function Dimensions now may be applied to Tensor objects. It does \
Dimensions[TensorComponents[Tensor[stuff]]]; i.e., it returns the Dimensions \
of the TensorComponents.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": The Weyl tensor, being the traceless part of Riemann, is zero in two and \
three dimensions. TensoriaCalc now immediately outputs a zero tensor whenever \
the space(time) dimension is 2 or 3; previously, it computes Weyl when d=3 \
(which, of course, will always yield zero) and gives an error when d=2. The \
reason for the error in the latter is due to the generic formula for the Weyl \
tensor breaking down, as it contains factors of 1/(d-2); this in turn is \
related to the fact that the Einstein tensor is zero in 2D.\n\n",
 StyleBox["October 2019",
  FontWeight->"Bold"],
 "\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": NonMetricTensor now has an additional argument; i.e., \
it\[CloseCurlyQuote]s now \
NonMetricTensor[\[Mu]T_List,stuff_List,exp_,Coordinates\[Rule]coords_List,\
opts:OptionsPattern[]], where the new argument exp refers to the TensorName \
\[Rule] exp. The name of the Tensor should not be Optional.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": The function ToTensor was deleted, because it overlaps with \
NonMetricTensor.\n\n",
 StyleBox["February 2020",
  FontWeight->"Bold"],
 "\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": CoordinateTransformation is now able to coordinate-transform Tensors of \
TensorType \[OpenCurlyDoubleQuote]Metric\[CloseCurlyDoubleQuote].\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Section \[OpenCurlyDoubleQuote]Geometry\[CloseCurlyDoubleQuote] is now \
renamed \[OpenCurlyDoubleQuote]Library of Functions\[CloseCurlyDoubleQuote].\n\
\n",
 StyleBox["April 2020",
  FontWeight->"Bold"],
 "\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": New function GeodesicHamiltonianDynamics computes the Hamilton and the \
associated Hamilton\[CloseCurlyQuote]s equations for geodesic motion, given a \
metric, definitions of momenta, and the affine parameter variable.\n\n",
 StyleBox["May 2020",
  FontWeight->"Bold"],
 "\n\n",
 StyleBox["Bug Fix",
  FontSlant->"Italic"],
 ": NonMetricTensor\[CloseCurlyQuote]s usage has now been corrected to \
reflect NonMetricTensor[\[Mu]T_List,stuff_List,exp_,Coordinates\[Rule]coords_\
List,opts:OptionsPattern[]], where the new argument exp refers to the \
TensorName \[Rule] exp. That is, the name of the Tensor is not Optional.\n\n",
 StyleBox["August 2020",
  FontWeight->"Bold"],
 "\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": TensorsProduct is now applied to Tensors with the same Coordinates. For \
example, if t1 and t2 have the same Coordinates; and t3 and t4 have the same \
Coordinates (but different from those in t1 and t2) \[LongDash] then \
TensorsProduct[t1 t3 t2 t4] will return TensorsProduct[t1 t2] \
TensorsProduct[t3 t4]. Previously TensorsProduct[t1 t2 t3 t4] would have \
returned TensorsProduct[t1 t2 t3 t4].\n\n",
 StyleBox["October 2020",
  FontWeight->"Bold"],
 "\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": NonMetricTensor can now create a Tensor object containing a scalar. \
Previously it only allowed creation of tensors with rank higher than zero.\n\n\
",
 StyleBox["Bux Fix",
  FontSlant->"Italic"],
 ": CovariantBox\[CloseCurlyQuote]s usage displayed the wrong formula. It \
used to read ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"|", 
       RowBox[{"det", " ", "g"}], "|"}], ")"}], 
     RowBox[{"1", "/", "2"}]], 
    RowBox[{
     SubscriptBox["\[PartialD]", "\[Mu]"], 
     RowBox[{"(", "...", ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "79793459-b54c-4a43-ba36-53936334b31a"],
 "; now it correctly reads  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"|", 
       RowBox[{"det", " ", "g"}], "|"}], ")"}], 
     RowBox[{
      RowBox[{"-", "1"}], "/", "2"}]], 
    RowBox[{
     SubscriptBox["\[PartialD]", "\[Mu]"], 
     RowBox[{"(", "...", ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "7d1b2f05-6710-4ecf-a9d3-aecac012bc2e"],
 ".\n\n",
 StyleBox["November 2020",
  FontWeight->"Bold"],
 "\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": CoordinateTransformation[mt_Tensor,{....},{newcoords},...] no longer \
checks that the newcoords have the same Length as the old coordinates.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": CoordinateTransformation[mt_Tensor,{....},{newcoords},...] now takes in a \
new Optional Rule StartIndex -> xx. If xx is not Integer, the StartIndex will \
be gotten from mt. Otherwise, it will be xx.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Previously, the usage for PartialD failed to explain that it also acted \
on non-Tensor expressions. Now it does.\n\n",
 StyleBox["January 2021\n",
  FontWeight->"Bold"],
 "\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": CovariantHodgeDual now checks for the antisymmetry of the input tensor \
only when its rank is higher 1. Previously it tries to check for the \
antisymmetry of tensors of any rank.\n\n",
 StyleBox["March 2021",
  FontWeight->"Bold"],
 "\n\n",
 StyleBox["Bug Fix",
  FontSlant->"Italic"],
 ": Usage description for CoordinateTransformation was fixed. In particular, \
in (II), the CoordinateTransformation[mt_Tensor,{x\[Rule]f1[p,q,r,...], y\
\[Rule]f2[p,q,r,...], z\[Rule]f3[p,q,r,...], ...}, {p,q,r, ...}, \
CoordinateTransformationOperator\[Rule]op, StartIndex\[Rule]si] was missing \
the mt_Tensor argument.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": In the Tensor code implementing Einstein summation, TensoriaCalc checks \
that the repeated indices are abstract. This check now uses the function \
NotAbstractIndex; previously there was a standalone code which was likely \
buggy.\n\n",
 StyleBox["April 2021",
  FontWeight->"Bold"],
 "\n\n",
 StyleBox["Bug Fix",
  FontSlant->"Italic"],
 ": Previously, NotAbstractIndex would return False if ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["#", "-"], TraditionalForm]],ExpressionUUID->
  "ddeb3936-1594-4cbf-91b8-0db60b9eb60b"],
 " or ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["#", "-"], TraditionalForm]],ExpressionUUID->
  "dfdd1f4e-48c7-4564-89fc-208318d3c224"],
 " contained a number # that lay out of range (e.g., 20 in a 3D coordinate \
system); now it returns True.\n\n",
 StyleBox["April 2021 through 2025 [check]",
  FontWeight->"Bold"],
 "\n\nFrom Fall of 2021 till [insert end date eventually], Wei-Hao Chen -- \
for his Master\[CloseCurlyQuote]s thesis project -- became the primary \
contributor to the code base of ",
 StyleBox["TensoriaCalc",
  FontSlant->"Italic"],
 ". Here, his contributions are enumerated."
}], "Text",
 CellChangeTimes->{{3.5391952254569125`*^9, 3.539195640163097*^9}, {
   3.53955006359291*^9, 3.5395501346978345`*^9}, {3.5395501670990915`*^9, 
   3.539550390631884*^9}, {3.539551751874675*^9, 3.5395517613906918`*^9}, {
   3.539552377154973*^9, 3.539552451910304*^9}, {3.5396155207615376`*^9, 
   3.539615524739544*^9}, {3.5396155883252563`*^9, 3.5396156250342236`*^9}, {
   3.539634404087411*^9, 3.539634467948063*^9}, {3.539658702983876*^9, 
   3.53965871095549*^9}, {3.5396612431081476`*^9, 3.5396615769538345`*^9}, {
   3.5396616172225056`*^9, 3.539661649976963*^9}, {3.5398821994892073`*^9, 
   3.539882248779027*^9}, {3.5402291264969573`*^9, 3.5402291273160043`*^9}, {
   3.5468019316783457`*^9, 3.5468019713180156`*^9}, 3.5468020013948684`*^9, {
   3.576090752245698*^9, 3.5760908187330146`*^9}, {3.5760908545506773`*^9, 
   3.5760910170873632`*^9}, {3.5766872960881157`*^9, 3.576687366272639*^9}, {
   3.5837902958813324`*^9, 3.583790362004114*^9}, {3.585772227618986*^9, 
   3.5857723766460485`*^9}, {3.5857724160361176`*^9, 
   3.5857724217457275`*^9}, {3.585772487733843*^9, 3.585772597526836*^9}, {
   3.594234069677395*^9, 3.5942342865307264`*^9}, {3.594236245769825*^9, 
   3.594236403751252*^9}, {3.594236439967308*^9, 3.594236444402377*^9}, {
   3.5965848885218115`*^9, 3.5965851829879284`*^9}, {3.6064477129242563`*^9, 
   3.6064477170244904`*^9}, {3.6067643878025208`*^9, 
   3.6067645104187365`*^9}, {3.606764548030402*^9, 3.606764590602877*^9}, {
   3.609613720173603*^9, 3.6096137267880154`*^9}, {3.6096137886421237`*^9, 
   3.6096138439442205`*^9}, {3.6096139013367214`*^9, 3.609614191778032*^9}, {
   3.609614236846511*^9, 3.609614244334524*^9}, {3.609614445075677*^9, 
   3.6096144489912834`*^9}, {3.6294786490906897`*^9, 
   3.6294787833808775`*^9}, {3.62947881355092*^9, 3.629478818390927*^9}, {
   3.629479785061555*^9, 3.6294797863715563`*^9}, {3.629562542055464*^9, 
   3.6295625440532675`*^9}, {3.629563179524299*^9, 3.6295632164805703`*^9}, {
   3.6295634770856667`*^9, 3.6295634800078716`*^9}, {3.6295635962982955`*^9, 
   3.6295636268611546`*^9}, {3.6295636988918905`*^9, 
   3.6295637168753257`*^9}, {3.6295643246241803`*^9, 3.629564327174985*^9}, {
   3.6295643802052975`*^9, 3.6295643943321285`*^9}, 3.62956444018983*^9, {
   3.6295645910583153`*^9, 3.629564616309367*^9}, {3.629564793949936*^9, 
   3.6295648281644125`*^9}, {3.6295665105709906`*^9, 3.629566527426426*^9}, {
   3.6295667402196894`*^9, 3.6295667804318533`*^9}, {3.6295668168915315`*^9, 
   3.629566842207182*^9}, {3.629566877352854*^9, 3.6295668923634853`*^9}, {
   3.6295669401405888`*^9, 3.629566958360826*^9}, {3.6295676927117987`*^9, 
   3.6295677768997583`*^9}, {3.6295678947547846`*^9, 3.629567999329583*^9}, {
   3.6295822987213025`*^9, 3.6295823643752356`*^9}, {3.6295824139493294`*^9, 
   3.6295826420773797`*^9}, {3.629603441693468*^9, 3.6296037548778596`*^9}, {
   3.629607699840618*^9, 3.62960775507927*^9}, {3.629609623367103*^9, 
   3.6296096457134447`*^9}, {3.629611118868438*^9, 3.629611222099281*^9}, {
   3.6296966526365733`*^9, 3.629696692941445*^9}, {3.6297636071580486`*^9, 
   3.629763693559885*^9}, {3.629822036569414*^9, 3.6298220397694197`*^9}, {
   3.629822086093307*^9, 3.6298221023857403`*^9}, {3.6298221675296617`*^9, 
   3.6298221905345078`*^9}, {3.6298257059366274`*^9, 
   3.6298257837814646`*^9}, {3.6298259014543715`*^9, 3.629825999218544*^9}, {
   3.6298260411408176`*^9, 3.6298261482132063`*^9}, {3.6298266422494926`*^9, 
   3.6298266581016207`*^9}, {3.6298267861248455`*^9, 3.629826875894903*^9}, {
   3.62982690822066*^9, 3.6298271407473702`*^9}, {3.629827195279466*^9, 
   3.629827206545186*^9}, 3.6298272545121703`*^9, {3.6298273159494786`*^9, 
   3.629827323000691*^9}, {3.629827524644846*^9, 3.629827540043973*^9}, {
   3.629843695864236*^9, 3.629843768112363*^9}, {3.6298438969973907`*^9, 
   3.629843902972201*^9}, {3.6298448016472807`*^9, 3.629844837095543*^9}, {
   3.62985840203149*^9, 3.629858493510722*^9}, {3.6298657414582825`*^9, 
   3.6298657501879444`*^9}, {3.629909079007269*^9, 3.6299091181965375`*^9}, {
   3.6299263757686844`*^9, 3.6299264772814417`*^9}, {3.629929867859521*^9, 
   3.6299298729451303`*^9}, {3.6299342834705825`*^9, 
   3.6299343177282424`*^9}, {3.629938461994429*^9, 3.629938470512044*^9}, {
   3.62999370915497*^9, 3.629993709357771*^9}, 3.6299937861556067`*^9, 
   3.629993859254936*^9, {3.630203492255678*^9, 3.6302036679861917`*^9}, {
   3.630203700803055*^9, 3.6302037242280965`*^9}, {3.6303300486200323`*^9, 
   3.6303300997039537`*^9}, {3.630434289440716*^9, 3.6304344590808215`*^9}, {
   3.63063870239233*^9, 3.6306387057726374`*^9}, {3.6306914969265156`*^9, 
   3.630691522836998*^9}, {3.6306963776461215`*^9, 3.6306965559231014`*^9}, {
   3.630696629480076*^9, 3.630696650329111*^9}, {3.6306967646614947`*^9, 
   3.630696807987544*^9}, {3.6309870350982666`*^9, 3.630987055946305*^9}, {
   3.6326180036776175`*^9, 3.632618041000888*^9}, {3.633650773200718*^9, 
   3.633650875407123*^9}, {3.6695150914329014`*^9, 3.6695151469969916`*^9}, {
   3.6695340689888253`*^9, 3.669534103324486*^9}, {3.6695800385699854`*^9, 
   3.669580068158678*^9}, {3.6695801069818983`*^9, 3.6695801073199177`*^9}, {
   3.6697710716437035`*^9, 3.66977109395998*^9}, {3.669771129469011*^9, 
   3.669771147322032*^9}, {3.669771240047613*^9, 3.669771248967632*^9}, {
   3.6697712917597027`*^9, 3.669771304845722*^9}, {3.6698286373379354`*^9, 
   3.669828712054674*^9}, {3.6698397290864587`*^9, 3.6698397551453114`*^9}, {
   3.6698435572376857`*^9, 3.6698435867013707`*^9}, {3.671900284442581*^9, 
   3.6719003563897057`*^9}, {3.6719006947896194`*^9, 
   3.6719006963716235`*^9}, {3.671902989907487*^9, 3.671903150700734*^9}, {
   3.6719085682754197`*^9, 3.6719085691247215`*^9}, {3.67190902094978*^9, 
   3.671909022967884*^9}, {3.6719090611001635`*^9, 3.671909061869565*^9}, {
   3.6719095357905307`*^9, 3.6719095646735964`*^9}, {3.671909607961093*^9, 
   3.671909640559662*^9}, {3.6719096720568495`*^9, 3.6719096753777604`*^9}, {
   3.67190987991696*^9, 3.671909897029999*^9}, {3.671994989288786*^9, 
   3.671995084358223*^9}, {3.671995566580805*^9, 3.6719955978665943`*^9}, {
   3.672059857739501*^9, 3.6720598617095623`*^9}, {3.6720752906433525`*^9, 
   3.672075293958542*^9}, {3.6720753292375593`*^9, 3.6720753822145896`*^9}, {
   3.6720754410259533`*^9, 3.6720755069357233`*^9}, {3.6720827910149236`*^9, 
   3.6720828354681063`*^9}, {3.6721496951806993`*^9, 3.67214978745586*^9}, {
   3.672591105573307*^9, 3.6725912566740212`*^9}, {3.672936808465267*^9, 
   3.6729368315771112`*^9}, {3.673375150613358*^9, 3.6733751697738123`*^9}, {
   3.673482874654341*^9, 3.673482943414274*^9}, {3.7037308385464573`*^9, 
   3.703730868738502*^9}, {3.7037310150788503`*^9, 3.703731043713578*^9}, {
   3.7181781096702566`*^9, 3.7181783272362127`*^9}, {3.718874273144792*^9, 
   3.7188743211635275`*^9}, {3.727784922531112*^9, 3.727784970891547*^9}, {
   3.727792192363469*^9, 3.7277922232967973`*^9}, {3.766942314052198*^9, 
   3.7669423994489107`*^9}, {3.7669424318024282`*^9, 
   3.7669424361637697`*^9}, {3.7669424720101447`*^9, 
   3.7669425252977133`*^9}, {3.767003064291844*^9, 3.7670032701808124`*^9}, {
   3.7670039426402426`*^9, 3.7670040208339586`*^9}, {3.7810054481949325`*^9, 
   3.78100558506383*^9}, {3.7913775767884607`*^9, 3.791377674584175*^9}, {
   3.791603332344458*^9, 3.791603365243082*^9}, {3.7962449299087863`*^9, 
   3.7962450332599683`*^9}, {3.7991208217267137`*^9, 
   3.7991208947966423`*^9}, {3.806665185087378*^9, 3.8066652295731654`*^9}, {
   3.8066652706113157`*^9, 3.806665427808397*^9}, {3.806665637498681*^9, 
   3.80666565877029*^9}, {3.8067413672994328`*^9, 3.806741376537784*^9}, {
   3.8105266102894354`*^9, 3.8105266699404073`*^9}, {3.812324765355049*^9, 
   3.812324848483503*^9}, {3.8135318972255297`*^9, 3.813531978743048*^9}, {
   3.813532429709549*^9, 3.8135324878316646`*^9}, {3.815347188652671*^9, 
   3.81534723733668*^9}, {3.820996784408843*^9, 3.8209968536050873`*^9}, {
   3.8209987270093155`*^9, 3.820998776708673*^9}, {3.823815595942007*^9, 
   3.823815635170335*^9}, {3.825220099723398*^9, 3.8252202108887014`*^9}, {
   3.82563175045571*^9, 3.825631873785451*^9}, {3.8262347010480022`*^9, 
   3.826234705328848*^9}, {3.826234744066947*^9, 3.826234844433211*^9}, {
   3.89507326252197*^9, 3.8950732636313133`*^9}, {3.895549052899413*^9, 
   3.895549054088929*^9}, 3.8955551728498077`*^9, {3.964365820151292*^9, 
   3.9643658917262077`*^9}, {3.9643661173351936`*^9, 3.964366136406751*^9}, {
   3.9643671466206703`*^9, 3.964367187083046*^9}, {3.9643677364581337`*^9, 
   3.9643677669581757`*^9}, {3.964367917093665*^9, 3.9643679521343117`*^9}, {
   3.964408506990229*^9, 3.964408511890212*^9}, {3.9644680388795705`*^9, 
   3.9644680482899685`*^9}, {3.9677774528395276`*^9, 3.9677774528647723`*^9}, 
   3.9737653454381437`*^9},ExpressionUUID->"6a328d5f-73fb-4371-810d-\
e49da45a4eff"]
}, Closed]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowToolbars->"EditBar",
WindowSize->{1026., 616.5},
WindowMargins->{{-4.875, Automatic}, {Automatic, -4.875}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
ShowSelection->True,
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"facc0dd8-6681-4907-a5ee-c7a655512efd"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 157, 3, 98, "Title",ExpressionUUID->"709c6e72-b6d5-4da7-834f-6a8e8ec43703"],
Cell[CellGroupData[{
Cell[761, 29, 219, 4, 67, "Section",ExpressionUUID->"72bd2be0-e491-4259-abdd-f5d0d6c720f4"],
Cell[983, 35, 7549, 178, 641, "Input",ExpressionUUID->"4a86c268-2418-4e54-8890-ea254b3bdcf4",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[8569, 218, 230, 4, 53, "Section",ExpressionUUID->"11b59f65-da1a-4f8a-811c-2386e77bf6d4"],
Cell[8802, 224, 1252, 19, 58, "Text",ExpressionUUID->"b5e6e792-1bbe-4285-ac5a-39d229eddab4"],
Cell[10057, 245, 1787, 39, 60, "Text",ExpressionUUID->"52f9b741-3e82-4d6f-a1d4-e25e37d937a2"],
Cell[11847, 286, 2161, 47, 60, "Text",ExpressionUUID->"d40af7e2-9a26-4ca2-9ae2-e53c5384a21b"],
Cell[14011, 335, 1207, 23, 37, "Text",ExpressionUUID->"3845de80-1110-454b-9540-2e8519c9c9ac"],
Cell[15221, 360, 1192, 23, 37, "Text",ExpressionUUID->"3c317f83-94d9-4d7a-886f-7a5d71c56178"],
Cell[16416, 385, 1280, 26, 37, "Text",ExpressionUUID->"aca41777-70a2-483b-a840-5989459e0b69"],
Cell[17699, 413, 4181, 109, 132, "Text",ExpressionUUID->"7946fbdc-2cbb-47bc-99b7-414d0ab90ab3"],
Cell[21883, 524, 3104, 78, 87, "Text",ExpressionUUID->"0031cf5e-9a66-49e2-9ae7-82aa2adb0af9"]
}, Closed]],
Cell[CellGroupData[{
Cell[25024, 607, 151, 3, 53, "Section",ExpressionUUID->"dbe7ad7a-92fe-41a0-9f5c-966a781ff5c3"],
Cell[CellGroupData[{
Cell[25200, 614, 157, 3, 54, "Subsection",ExpressionUUID->"7ed4bb07-bc17-40f3-a1d3-169195392a1b"],
Cell[25360, 619, 11507, 171, 89, "Input",ExpressionUUID->"0dedec9e-166b-4c5a-b98a-9db1ff6a4b12",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[36904, 795, 158, 3, 38, "Subsection",ExpressionUUID->"f76f3345-7733-46f5-8d18-88418300407b"],
Cell[37065, 800, 2641, 40, 236, "Input",ExpressionUUID->"42d0c3d6-83d0-4ed8-b571-eeae7a9aa57a",
 InitializationCell->True],
Cell[39709, 842, 2107, 34, 173, "Input",ExpressionUUID->"b40a0713-3592-4853-9208-6d00d7b73530",
 InitializationCell->True],
Cell[41819, 878, 1698, 28, 215, "Input",ExpressionUUID->"c7014130-e88a-4e8d-a9c5-c807732fe8bf",
 InitializationCell->True],
Cell[43520, 908, 1522, 26, 152, "Input",ExpressionUUID->"b78a933e-6ae1-40ea-aff5-6de096c33f1e",
 InitializationCell->True],
Cell[45045, 936, 1119, 20, 110, "Input",ExpressionUUID->"1c611d97-7d17-4cdc-b131-9a6288d5833a",
 InitializationCell->True],
Cell[46167, 958, 1321, 22, 131, "Input",ExpressionUUID->"e61adb44-b485-482a-85ee-859a06d0d263",
 InitializationCell->True],
Cell[47491, 982, 2454, 43, 320, "Input",ExpressionUUID->"a1630335-eb56-437e-bf77-65a37d63cdb7",
 InitializationCell->True],
Cell[49948, 1027, 2510, 41, 341, "Input",ExpressionUUID->"23d37f33-7829-4197-b68d-f0ed30f5728b",
 InitializationCell->True],
Cell[52461, 1070, 1073, 19, 173, "Input",ExpressionUUID->"61e2e38d-63a0-4d43-9f67-95f7c3e0b293",
 InitializationCell->True],
Cell[53537, 1091, 989, 17, 152, "Input",ExpressionUUID->"f4973c5f-0ced-4b36-80e2-ef43e998cd09",
 InitializationCell->True],
Cell[54529, 1110, 1067, 19, 131, "Input",ExpressionUUID->"99d1e8b4-5f33-4d8f-9633-cf2d83fd2152",
 InitializationCell->True],
Cell[55599, 1131, 5306, 78, 635, "Input",ExpressionUUID->"8f2f2a22-d55b-4c6b-99a3-4096e166fff9",
 InitializationCell->True],
Cell[60908, 1211, 4679, 68, 530, "Input",ExpressionUUID->"067b4ae3-404a-4447-9983-542c7d844370",
 InitializationCell->True],
Cell[65590, 1281, 1421, 22, 131, "Input",ExpressionUUID->"c5e43064-88c2-42be-adc2-ae5569cbd4aa",
 InitializationCell->True],
Cell[67014, 1305, 1432, 24, 110, "Input",ExpressionUUID->"bc81be56-59cb-488c-a22c-0475f41bf8ba",
 InitializationCell->True],
Cell[68449, 1331, 974, 17, 110, "Input",ExpressionUUID->"a43f5be7-603a-4f89-8c90-1cb2c77e1e1e",
 InitializationCell->True],
Cell[69426, 1350, 1391, 23, 194, "Input",ExpressionUUID->"5eca1cb2-376c-48e6-8346-2c85be288df7",
 InitializationCell->True],
Cell[70820, 1375, 1541, 26, 131, "Input",ExpressionUUID->"023ab37d-5207-460b-b05c-1b3b69a8454a",
 InitializationCell->True],
Cell[72364, 1403, 1683, 27, 173, "Input",ExpressionUUID->"34a3a216-9387-453e-bb7f-b4cd67c69c97",
 InitializationCell->True],
Cell[74050, 1432, 1467, 25, 173, "Input",ExpressionUUID->"c06c2222-e069-48d0-bb78-38f1382ecf26",
 InitializationCell->True],
Cell[75520, 1459, 11256, 159, 1607, "Input",ExpressionUUID->"0e8f11ce-62f8-4efa-b4de-340b617ea5dd",
 InitializationCell->True],
Cell[86779, 1620, 806, 14, 131, "Input",ExpressionUUID->"f0a36b46-81e0-43bc-a011-40f49c873ade",
 InitializationCell->True],
Cell[87588, 1636, 1016, 18, 173, "Input",ExpressionUUID->"0840cd01-4067-445d-a265-dc7287d0d89e",
 InitializationCell->True],
Cell[88607, 1656, 689, 13, 110, "Input",ExpressionUUID->"64c2eeb9-e345-439e-b10c-8cf833fae536",
 InitializationCell->True],
Cell[89299, 1671, 687, 13, 110, "Input",ExpressionUUID->"1d6e7d87-02ad-4212-848a-75cc83be4bf9",
 InitializationCell->True],
Cell[89989, 1686, 1042, 18, 147, "Input",ExpressionUUID->"0a2c0e8a-7274-4d91-ad48-95a70181b78e",
 InitializationCell->True],
Cell[91034, 1706, 2557, 40, 256, "Input",ExpressionUUID->"0ec3d3d0-2fd9-421d-89c3-7cfd69f3e8be",
 InitializationCell->True],
Cell[93594, 1748, 2413, 36, 299, "Input",ExpressionUUID->"229a5457-dea8-4823-a61b-55e5d9daf7ef",
 InitializationCell->True],
Cell[96010, 1786, 1343, 22, 152, "Input",ExpressionUUID->"dfb70237-bf73-4b86-b8a3-b2dcac71e9d2",
 InitializationCell->True],
Cell[97356, 1810, 1317, 22, 173, "Input",ExpressionUUID->"507b535c-1a57-44bc-a30b-3616952e27e8",
 InitializationCell->True],
Cell[98676, 1834, 1981, 32, 362, "Input",ExpressionUUID->"68d5cf28-e9dd-48b3-a43a-1105c26c88fb",
 InitializationCell->True],
Cell[100660, 1868, 666, 13, 89, "Input",ExpressionUUID->"b85fe9cb-0096-4514-8d52-7f2b229d9c29",
 InitializationCell->True],
Cell[101329, 1883, 592, 12, 89, "Input",ExpressionUUID->"2380f246-888e-442c-b815-96c97e42aa5b",
 InitializationCell->True],
Cell[101924, 1897, 465, 11, 89, "Input",ExpressionUUID->"bd449ed4-c0e3-4575-947e-332ffa5120a3",
 InitializationCell->True],
Cell[102392, 1910, 1314, 21, 194, "Input",ExpressionUUID->"ba217347-a720-4ea0-abe4-2eb284663546",
 InitializationCell->True],
Cell[103709, 1933, 1150, 19, 215, "Input",ExpressionUUID->"3b489c48-2bc1-48f1-bdbf-e21c47b19721",
 InitializationCell->True],
Cell[104862, 1954, 3504, 52, 302, "Input",ExpressionUUID->"c9640564-d128-4a36-8e86-37f94584b9a1",
 InitializationCell->True],
Cell[108369, 2008, 939, 18, 110, "Input",ExpressionUUID->"646a151a-246a-4a32-9655-2b4db73ce7ef",
 InitializationCell->True],
Cell[109311, 2028, 1089, 18, 131, "Input",ExpressionUUID->"1f143eb3-1932-4858-a024-7f694e0272b8",
 InitializationCell->True],
Cell[110403, 2048, 830, 16, 110, "Input",ExpressionUUID->"0ed6c819-4642-46d1-8bea-23048380868c",
 InitializationCell->True],
Cell[111236, 2066, 2531, 39, 203, "Input",ExpressionUUID->"e8b3e8dc-3aff-4e77-ac82-a4cb6a7fe313",
 InitializationCell->True],
Cell[113770, 2107, 3151, 47, 371, "Input",ExpressionUUID->"0d7fceef-7e87-4daa-b1f6-075e35f63f9b",
 InitializationCell->True],
Cell[116924, 2156, 2540, 40, 423, "Input",ExpressionUUID->"63b9a895-8a41-47b8-825f-0ee81f8cd5f5",
 InitializationCell->True],
Cell[119467, 2198, 676, 12, 131, "Input",ExpressionUUID->"d37cb297-b3fe-479f-a8c2-f2b98819466c",
 InitializationCell->True],
Cell[120146, 2212, 907, 17, 110, "Input",ExpressionUUID->"52bd8780-f5ff-4262-bb88-6f96280bd999",
 InitializationCell->True],
Cell[121056, 2231, 2115, 32, 261, "Input",ExpressionUUID->"224ed80f-ee46-439f-ad03-1a87568d4127",
 InitializationCell->True],
Cell[123174, 2265, 3494, 52, 455, "Input",ExpressionUUID->"455cfd03-014a-47bc-9408-ae8711ad6cd7",
 InitializationCell->True],
Cell[126671, 2319, 665, 13, 152, "Input",ExpressionUUID->"4031b515-9073-4a56-bd96-deed34e9b659",
 InitializationCell->True],
Cell[127339, 2334, 4949, 77, 352, "Input",ExpressionUUID->"448e6bc9-fb5e-4fd1-a813-f14f1058c3da",
 InitializationCell->True],
Cell[132291, 2413, 1259, 22, 194, "Input",ExpressionUUID->"67921f9a-7f06-48b7-9eac-077f438a26a6",
 InitializationCell->True],
Cell[133553, 2437, 422, 10, 89, "Input",ExpressionUUID->"9a1393bd-be22-4d14-a0f1-08fbefe3d9b5",
 InitializationCell->True],
Cell[133978, 2449, 1588, 26, 236, "Input",ExpressionUUID->"b57c0340-aff2-4768-8d21-0d5228b7dcf3",
 InitializationCell->True],
Cell[135569, 2477, 13021, 184, 2378, "Input",ExpressionUUID->"b3712acc-7a6d-40de-8432-710d215bf4d2",
 InitializationCell->True],
Cell[148593, 2663, 675, 14, 131, "Input",ExpressionUUID->"111bfaca-956c-4c90-8e15-1caab075c592",
 InitializationCell->True],
Cell[149271, 2679, 434, 10, 89, "Input",ExpressionUUID->"de50d459-dd78-4233-a785-4ab7ce3f4702",
 InitializationCell->True],
Cell[149708, 2691, 2282, 35, 383, "Input",ExpressionUUID->"7a57b0f5-562f-41b5-bf95-5c3ebd4316ff",
 InitializationCell->True],
Cell[151993, 2728, 1068, 19, 173, "Input",ExpressionUUID->"2937d2e2-e7e4-47be-8020-021a038c8f99",
 InitializationCell->True],
Cell[153064, 2749, 4303, 70, 407, "Input",ExpressionUUID->"957ac35e-2eba-4845-b2b1-8ba2dd541a0e",
 InitializationCell->True],
Cell[157370, 2821, 1676, 27, 173, "Input",ExpressionUUID->"41882db0-52ed-4004-9324-89af7c73a8f0",
 InitializationCell->True],
Cell[159049, 2850, 1413, 23, 194, "Input",ExpressionUUID->"1b58d4ed-f645-4f87-8e1f-9c7629135de1",
 InitializationCell->True],
Cell[160465, 2875, 3489, 53, 383, "Input",ExpressionUUID->"a405104b-c473-4f43-bfa7-591bd1f8388b",
 InitializationCell->True],
Cell[163957, 2930, 2323, 35, 237, "Input",ExpressionUUID->"83f8cf4f-a300-45b9-9830-72367cc67ba2",
 InitializationCell->True],
Cell[166283, 2967, 1273, 31, 278, "Input",ExpressionUUID->"db7578b6-a8c5-485c-b9ab-1907dc1e69f8",
 InitializationCell->True],
Cell[167559, 3000, 329, 10, 68, "Input",ExpressionUUID->"cdb86cd7-1de2-4545-8916-8bb35d9720cb",
 InitializationCell->True],
Cell[167891, 3012, 883, 26, 131, "Input",ExpressionUUID->"09b74f41-63f5-4078-a354-e9df547a82f3",
 InitializationCell->True],
Cell[168777, 3040, 30284, 497, 2693, "Input",ExpressionUUID->"bbc7e8be-9ed8-46b0-a763-805cc6e60749",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[199098, 3542, 237, 4, 38, "Subsection",ExpressionUUID->"ad34d706-e6c9-4ec1-a4a2-11f9f325835b"],
Cell[199338, 3548, 31421, 573, 1139, "Input",ExpressionUUID->"51d6a053-8ea8-4cc2-8ca7-ea9976cc4174",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[230808, 4127, 209, 4, 67, "Section",ExpressionUUID->"72db2963-df8b-47c5-afb6-fc5119094b1d"],
Cell[231020, 4133, 2921, 44, 46, "Input",ExpressionUUID->"918b4003-dc65-445a-bb4c-a29a22fcd1b5",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[233978, 4182, 170, 3, 53, "Section",ExpressionUUID->"a50d09e8-2ca3-4c82-8198-485591f2ec8e"],
Cell[234151, 4187, 126734, 2938, 8351, "Input",ExpressionUUID->"488ddccd-bdb8-411d-9891-a43103f14aba",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[360922, 7130, 216, 4, 53, "Section",ExpressionUUID->"0394dae6-59c8-4959-bedf-167b042a8955"],
Cell[CellGroupData[{
Cell[361163, 7138, 369, 6, 54, "Subsection",ExpressionUUID->"f58072ca-30c6-4a05-b9e6-4325729d624a"],
Cell[CellGroupData[{
Cell[361557, 7148, 402, 6, 45, "Subsubsection",ExpressionUUID->"347f41c0-125f-4615-8eab-91074a82f150"],
Cell[361962, 7156, 2354, 49, 564, "Text",ExpressionUUID->"716b76f7-1c47-4ae9-82fd-d41c62af3adf",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[364353, 7210, 444, 6, 37, "Subsubsection",ExpressionUUID->"aae06da9-a5bf-477a-96de-902d8c8b5643"],
Cell[364800, 7218, 2518, 41, 311, "Text",ExpressionUUID->"fc9f0a89-a684-46e6-a8c0-f326a0c35007",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[367355, 7264, 157, 3, 37, "Subsubsection",ExpressionUUID->"40e9b7b5-f29e-4b42-a7e9-fa207ff66c33"],
Cell[367515, 7269, 54594, 999, 2252, "Input",ExpressionUUID->"55cfa897-81b7-4dd3-958b-b5eff504d035",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[422146, 8273, 164, 3, 37, "Subsubsection",ExpressionUUID->"fd508f6f-e15c-4d3c-8ca6-88cad961051f"],
Cell[422313, 8278, 593, 15, 68, "Input",ExpressionUUID->"ed628348-f31e-4a9b-ba50-421e43ee81c2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[422943, 8298, 176, 3, 37, "Subsubsection",ExpressionUUID->"ee3581fd-c267-4aa2-b53e-618eedbcc19a"],
Cell[423122, 8303, 35955, 836, 2070, "Input",ExpressionUUID->"f1b9dee0-dab0-4772-9362-1e686da3addd",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[459114, 9144, 135, 3, 37, "Subsubsection",ExpressionUUID->"f5ba511d-dc39-4266-9a5d-b47036fe4c37"],
Cell[459252, 9149, 33847, 543, 719, "Input",ExpressionUUID->"52b440c1-9bbf-457b-af8b-55cb007f9e1c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[493136, 9697, 139, 3, 37, "Subsubsection",ExpressionUUID->"5199a88c-d4cf-4f1e-92d6-70c2399599c5"],
Cell[493278, 9702, 966, 24, 89, "Input",ExpressionUUID->"f39524e6-1023-42d5-91d4-26667a17a23e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[494281, 9731, 184, 3, 37, "Subsubsection",ExpressionUUID->"2eb70b72-66c1-4cca-92a3-faebd7ac4aa9"],
Cell[494468, 9736, 843, 20, 68, "Input",ExpressionUUID->"2e9cd62b-3af6-44da-a73d-4f398e9fd199",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[495348, 9761, 162, 3, 37, "Subsubsection",ExpressionUUID->"f7e3c5b7-2c51-41cc-b797-cdaf49449972"],
Cell[495513, 9766, 1394, 36, 110, "Input",ExpressionUUID->"944f0416-dd94-4d25-b197-86aa93bad688",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[496944, 9807, 176, 3, 37, "Subsubsection",ExpressionUUID->"453dc659-8cc9-4a14-b820-7a84bc7c10c1"],
Cell[497123, 9812, 32800, 479, 173, "Input",ExpressionUUID->"136d1ccd-7984-4b1f-9f4e-8346551e4ac6",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[529960, 10296, 159, 3, 37, "Subsubsection",ExpressionUUID->"4c2e7990-bf65-48b1-8ec8-74cf66a257b3"],
Cell[530122, 10301, 1059, 21, 68, "Input",ExpressionUUID->"6e842148-ea8f-4433-b072-9e6630dcb93a",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[531218, 10327, 163, 3, 37, "Subsubsection",ExpressionUUID->"cba288e5-988d-40bd-ae0e-5e166730c5fd"],
Cell[531384, 10332, 876, 19, 68, "Input",ExpressionUUID->"5f34a97a-072a-4f9a-a613-82479f4825e7",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[532297, 10356, 141, 3, 37, "Subsubsection",ExpressionUUID->"14afb864-641f-466b-b691-a1771dfe6365"],
Cell[532441, 10361, 2441, 58, 110, "Input",ExpressionUUID->"37147205-5cb8-4f7a-b766-decc14db435c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[534919, 10424, 243, 5, 37, "Subsubsection",ExpressionUUID->"21452b93-eb66-46fe-8421-ce6f17afd95c"],
Cell[535165, 10431, 37610, 632, 1286, "Input",ExpressionUUID->"338b0823-3ca3-4ff0-ae40-9910b605f2d3",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[572812, 11068, 147, 3, 37, "Subsubsection",ExpressionUUID->"8fd9aec0-45a5-4318-82ee-88053c8585f4"],
Cell[572962, 11073, 37740, 618, 971, "Input",ExpressionUUID->"36cf09fb-177d-4db5-95d5-946628070b0d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[610739, 11696, 133, 3, 37, "Subsubsection",ExpressionUUID->"e40595af-8b16-4e8a-bd7d-29d3504b2037"],
Cell[610875, 11701, 44764, 772, 1433, "Input",ExpressionUUID->"a2d8608e-d483-43a5-abfa-b2ddb2badaa8",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[655676, 12478, 163, 3, 37, "Subsubsection",ExpressionUUID->"4f587374-e443-482e-8a24-a68a8ad56bd9"],
Cell[655842, 12483, 3894, 86, 173, "Input",ExpressionUUID->"79feeefb-52be-427f-9713-1a81e1d0c3a2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[659773, 12574, 169, 3, 37, "Subsubsection",ExpressionUUID->"144b4830-8fee-44b7-8263-a050478e3b14"],
Cell[659945, 12579, 2264, 57, 173, "Input",ExpressionUUID->"adf3d5e7-382b-45db-8489-dc31b7bb2318",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[662246, 12641, 395, 6, 37, "Subsubsection",ExpressionUUID->"703c590b-c2fa-432e-9327-0051b74354d4"],
Cell[662644, 12649, 699, 14, 46, "Input",ExpressionUUID->"f0463e5c-46ae-45fb-9c45-47b88f73699a",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[663380, 12668, 236, 4, 37, "Subsubsection",ExpressionUUID->"afc02d37-1a20-42d1-8887-b5233f42effe"],
Cell[663619, 12674, 3062, 76, 131, "Input",ExpressionUUID->"835e3df6-d88f-4a15-96ec-a1877aacb2a8",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[666718, 12755, 306, 5, 37, "Subsubsection",ExpressionUUID->"4066e9c4-6855-4c5e-b8c7-c1fa83be599e"],
Cell[667027, 12762, 2651, 54, 89, "Input",ExpressionUUID->"b3f00983-0f85-4982-a9d0-43b38e4a62f1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[669715, 12821, 137, 3, 37, "Subsubsection",ExpressionUUID->"b1347b2c-9378-472d-8d1f-d2969626c983"],
Cell[669855, 12826, 2261, 65, 132, "Input",ExpressionUUID->"bb0ea90d-c494-44be-a406-c9e0494f9712",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[672165, 12897, 185, 3, 54, "Subsection",ExpressionUUID->"f3f44c39-e189-4599-a024-fd5d7b9b5c7b"],
Cell[CellGroupData[{
Cell[672375, 12904, 164, 2, 45, "Subsubsection",ExpressionUUID->"23ecd828-5ed8-439a-8735-8f25774e6733"],
Cell[672542, 12908, 1220, 31, 110, "Input",ExpressionUUID->"8df9954d-80ca-4556-9487-8ff41072a942",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[673799, 12944, 202, 3, 37, "Subsubsection",ExpressionUUID->"1aa6c251-39ee-4486-8824-260a86b5abeb"],
Cell[674004, 12949, 2712, 70, 299, "Input",ExpressionUUID->"0ddf66b2-2c4f-46d3-a8b5-2c4366356ce4",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[676753, 13024, 193, 3, 37, "Subsubsection",ExpressionUUID->"7c82a65f-04a3-4068-a8d3-46c810bf713b"],
Cell[676949, 13029, 4440, 115, 362, "Input",ExpressionUUID->"f48a2b94-e898-4e99-8e01-5f1f5164877b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[681426, 13149, 245, 4, 37, "Subsubsection",ExpressionUUID->"0c2730b0-e45f-4feb-b070-5e3823f7f668"],
Cell[681674, 13155, 2150, 54, 173, "Input",ExpressionUUID->"cf5dea5a-7daa-458b-a7cd-311104b85b97",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[683861, 13214, 199, 3, 37, "Subsubsection",ExpressionUUID->"8c83a780-d5bd-4f42-9a88-4a2610da6da9"],
Cell[684063, 13219, 22259, 532, 1139, "Input",ExpressionUUID->"2c93cd0b-eca5-4afe-839b-d6a84edb3bc6",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[706359, 13756, 211, 3, 37, "Subsubsection",ExpressionUUID->"93e1a582-cf2e-4df0-8776-723340952030"],
Cell[706573, 13761, 1538, 39, 152, "Input",ExpressionUUID->"68673e80-1522-444a-8f48-9a4fcb952557",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[708148, 13805, 207, 3, 37, "Subsubsection",ExpressionUUID->"93ad3344-221c-47ed-8021-9301d3e0e3f8"],
Cell[708358, 13810, 3987, 98, 236, "Input",ExpressionUUID->"f4bf9519-da37-4584-8229-68da2fcbca6e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[712382, 13913, 202, 3, 37, "Subsubsection",ExpressionUUID->"10bafcd7-3513-408d-abb3-134089a6cebd"],
Cell[712587, 13918, 948, 25, 89, "Input",ExpressionUUID->"4e371737-231c-4a4c-b82d-436fd001d52c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[713572, 13948, 210, 3, 37, "Subsubsection",ExpressionUUID->"75ca5e59-f155-4b3b-a983-7ded1a3e689c"],
Cell[713785, 13953, 1288, 31, 110, "Input",ExpressionUUID->"f7074981-1802-4521-80a0-1bdf63318722",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[715110, 13989, 226, 4, 37, "Subsubsection",ExpressionUUID->"21366297-de70-431e-bb9a-44742026c5d0"],
Cell[715339, 13995, 4825, 116, 404, "Input",ExpressionUUID->"5ee271bf-6c2a-458e-8e57-9e23e8a922f1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[720201, 14116, 207, 3, 37, "Subsubsection",ExpressionUUID->"bd0e82e6-1ea8-4e4f-a672-f441813d8795"],
Cell[720411, 14121, 3611, 90, 236, "Input",ExpressionUUID->"a9ffbde1-9315-41e5-99ca-9ce6e4cdab7c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[724059, 14216, 198, 3, 37, "Subsubsection",ExpressionUUID->"5abeb7ce-6d51-43f6-a46b-d7054dbb4971"],
Cell[724260, 14221, 11585, 260, 929, "Input",ExpressionUUID->"1f65dda3-6561-49d3-b889-ec8afc65b582",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[735882, 14486, 299, 5, 37, "Subsubsection",ExpressionUUID->"a7f7f10d-763e-4c72-a7ca-7359b6939cd0"],
Cell[736184, 14493, 9506, 202, 425, "Input",ExpressionUUID->"4ce8865e-e8e3-49bd-81b4-905700e9f61e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[745727, 14700, 153, 3, 37, "Subsubsection",ExpressionUUID->"0f0f2248-1ca5-4f9f-85f4-262176613ebb"],
Cell[745883, 14705, 1559, 43, 152, "Input",ExpressionUUID->"216ec684-5d09-4555-9dbd-c9030a7b3685",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[747479, 14753, 200, 3, 37, "Subsubsection",ExpressionUUID->"78c7c497-8b87-442f-a84b-ef140aef0242"],
Cell[747682, 14758, 5644, 141, 362, "Input",ExpressionUUID->"310eb20c-ade5-414b-b867-3c359be75cbc",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[753363, 14904, 303, 5, 37, "Subsubsection",ExpressionUUID->"7dfb31c1-6cd3-4f41-a858-7d9052b29eaa"],
Cell[753669, 14911, 1762, 45, 215, "Input",ExpressionUUID->"390ef9bb-7716-4452-8d5b-ae7722bd9d7f",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[755468, 14961, 317, 5, 37, "Subsubsection",ExpressionUUID->"930e20e8-4d96-4bbf-b75e-5fcb612993eb"],
Cell[755788, 14968, 6122, 107, 257, "Input",ExpressionUUID->"c7126864-ffec-40e5-a7bc-453dde1b6339",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[761947, 15080, 344, 5, 37, "Subsubsection",ExpressionUUID->"8d38ae25-75a4-4e2d-8b10-56fbde23716a"],
Cell[762294, 15087, 6356, 116, 278, "Input",ExpressionUUID->"f3f9531b-10f7-4d70-9d91-9937d429f0d7",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[768687, 15208, 339, 5, 37, "Subsubsection",ExpressionUUID->"281d2c7c-fed4-4e76-a2ed-c2a22a5258d1"],
Cell[769029, 15215, 7486, 141, 362, "Input",ExpressionUUID->"058cdca0-9ce8-4779-87a2-72b9e6ba9520",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[776552, 15361, 388, 6, 37, "Subsubsection",ExpressionUUID->"0d7a336a-7f98-45a1-a897-4082e8f2d0d7"],
Cell[776943, 15369, 15520, 307, 719, "Input",ExpressionUUID->"aff80114-7aa4-47f3-a778-b0ad83b6972e",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[792512, 15682, 388, 6, 54, "Subsection",ExpressionUUID->"a6b6a354-d554-49ba-8092-63da772c0038"],
Cell[792903, 15690, 11141, 265, 719, "Input",ExpressionUUID->"b8663cdd-4807-484a-941a-972af46a9cf8",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[804081, 15960, 142, 3, 38, "Subsection",ExpressionUUID->"f950017d-de23-4b3a-bc36-deac1ceb23c6"],
Cell[804226, 15965, 21261, 547, 1449, "Input",ExpressionUUID->"bea6ffd1-ee56-429a-9016-22680cfeaabc",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[825524, 16517, 206, 4, 38, "Subsection",ExpressionUUID->"311d1f40-968d-4328-b149-24ed785a7f46"],
Cell[825733, 16523, 4590, 126, 320, "Input",ExpressionUUID->"21e201e5-ef62-4f4d-b138-529dc05ee9fc",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[830360, 16654, 293, 5, 38, "Subsection",ExpressionUUID->"b3b5ca54-2a98-41b1-b0bc-4a1ae48419be"],
Cell[830656, 16661, 48092, 1053, 3527, "Input",ExpressionUUID->"4aba9fe4-8dc2-4999-9899-a395918895d5",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[878785, 17719, 240, 4, 38, "Subsection",ExpressionUUID->"c24b1520-13e6-4858-9683-fcd039868295"],
Cell[879028, 17725, 16519, 375, 1118, "Input",ExpressionUUID->"e180f111-643b-4ad9-9190-34b76f2b913a",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[895584, 18105, 152, 3, 38, "Subsection",ExpressionUUID->"3e851b52-9d26-44b4-88b1-d76b3c349201"],
Cell[895739, 18110, 9066, 184, 530, "Input",ExpressionUUID->"88c465ea-0b26-453a-9f87-54d52741b1bd",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[904842, 18299, 178, 3, 38, "Subsection",ExpressionUUID->"a2143a5b-8e99-4039-af31-7b892d4f9ccb"],
Cell[905023, 18304, 14665, 319, 740, "Input",ExpressionUUID->"c9a30d29-04d5-45c8-bb1d-513ed83291b4",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[919725, 18628, 148, 2, 38, "Subsection",ExpressionUUID->"c2def25f-1776-4a82-abe4-e31e6156b5ce"],
Cell[919876, 18632, 9147, 201, 572, "Input",ExpressionUUID->"1d2b45cd-c3da-4db1-94aa-061cf78888fa",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[929060, 18838, 157, 3, 38, "Subsection",ExpressionUUID->"c25be501-361d-4b91-9c14-1d4568313200"],
Cell[929220, 18843, 2174, 50, 131, "Input",ExpressionUUID->"b3fdcfec-523d-4d23-bb28-efc266000646",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[931431, 18898, 229, 4, 38, "Subsection",ExpressionUUID->"39601059-4c8d-4012-9dea-8af07a0a4633"],
Cell[931663, 18904, 13618, 283, 730, "Input",ExpressionUUID->"c9ec7425-5271-46ed-a20b-5b9376c901fe",
 InitializationCell->True],
Cell[945284, 19189, 9881, 185, 509, "Input",ExpressionUUID->"21f8df74-d008-4560-b592-59d81d7698c8",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[955202, 19379, 206, 4, 38, "Subsection",ExpressionUUID->"7cbc090d-7a83-4153-ae68-cc167684801f"],
Cell[955411, 19385, 7927, 161, 593, "Input",ExpressionUUID->"7f1ccae2-3c30-4371-8618-d91a4f17ca91",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[963375, 19551, 181, 3, 38, "Subsection",ExpressionUUID->"31e090b9-dd85-40b9-a7df-ce03fcde407b"],
Cell[963559, 19556, 2280, 53, 131, "Input",ExpressionUUID->"0d49aaa7-8277-4d46-b9c9-435647c290fa",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[965876, 19614, 243, 4, 38, "Subsection",ExpressionUUID->"55230c28-b185-4766-80cb-5916481cf9ef"],
Cell[966122, 19620, 2079, 50, 110, "Input",ExpressionUUID->"a95930d0-217d-4427-a008-12e0a3b0dc8e",
 InitializationCell->True],
Cell[968204, 19672, 8733, 202, 360, "Input",ExpressionUUID->"31fa951b-fa09-4c1b-8761-c958895c180d",
 InitializationCell->True],
Cell[976940, 19876, 22258, 506, 1235, "Input",ExpressionUUID->"34349c22-e864-41cf-ad64-9e5af6463d2e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[999235, 20387, 294, 5, 38, "Subsection",ExpressionUUID->"9f57dc72-9a35-4623-8283-7085f7bd2d73"],
Cell[999532, 20394, 6626, 167, 405, "Input",ExpressionUUID->"d7f23f52-99bd-410b-87a7-e3d80e321473",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1006195, 20566, 667, 10, 38, "Subsection",ExpressionUUID->"4b9962c6-9104-4d0d-bd43-8c6f3876bd96"],
Cell[1006865, 20578, 1439, 36, 110, "Input",ExpressionUUID->"3ab4e30c-78c1-4071-bbae-834e928eba24",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1008341, 20619, 696, 11, 38, "Subsection",ExpressionUUID->"1e02da7f-dadb-4d22-9e40-becc081cf057"],
Cell[1009040, 20632, 10524, 263, 782, "Input",ExpressionUUID->"5473155c-5646-4432-91da-93d131664f44",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1019601, 20900, 357, 6, 38, "Subsection",ExpressionUUID->"05e9fa37-f55f-4e3e-90f1-83b8b508145e"],
Cell[1019961, 20908, 4602, 104, 257, "Input",ExpressionUUID->"8843326f-3452-4b7e-9d9f-ecdc3baed4a3",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1024600, 21017, 405, 6, 38, "Subsection",ExpressionUUID->"62186d2f-6045-4bdd-821b-6e563a764add"],
Cell[1025008, 21025, 68595, 1474, 2885, "Input",ExpressionUUID->"92a3c042-dbe0-47d4-9c1c-a11b13a56496",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1093640, 22504, 463, 7, 38, "Subsection",ExpressionUUID->"3f734fc5-9c3f-4157-ab30-9d3e379fab20"],
Cell[1094106, 22513, 11155, 181, 215, "Input",ExpressionUUID->"0175fc62-84a9-4af5-bd42-c8f70b287fdb",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1105298, 22699, 461, 7, 38, "Subsection",ExpressionUUID->"7ae3a39d-25a1-4c31-ab81-6f0c1e5a8675"],
Cell[1105762, 22708, 11012, 179, 215, "Input",ExpressionUUID->"3d65c77e-074d-4df2-90b5-34a2dc446b2d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1116811, 22892, 567, 9, 38, "Subsection",ExpressionUUID->"3e71db93-4edc-48aa-a385-44c9fa8f6a67"],
Cell[1117381, 22903, 10404, 165, 173, "Input",ExpressionUUID->"5d3c4916-383f-4df9-8f0d-5bc252b8f0ac",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1127822, 23073, 567, 8, 38, "Subsection",ExpressionUUID->"2f9c189e-c61f-4528-b068-5ee78157f7a7"],
Cell[1128392, 23083, 23461, 464, 740, "Input",ExpressionUUID->"681613ce-1289-4aac-a8e3-82a65ac70130",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1151890, 23552, 547, 8, 38, "Subsection",ExpressionUUID->"0e319148-22dc-463b-b4f2-1996df21df7b"],
Cell[1152440, 23562, 32938, 598, 761, "Input",ExpressionUUID->"f5045f13-e32e-4ccc-936b-6d56dd261ef9",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1185415, 24165, 388, 6, 38, "Subsection",ExpressionUUID->"50ec6023-e205-4e05-b069-65396b86e78d"],
Cell[1185806, 24173, 59861, 1260, 2567, "Input",ExpressionUUID->"60c56988-1c9a-4dd3-bdf9-66b8da5c2652",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1245704, 25438, 336, 5, 38, "Subsection",ExpressionUUID->"068f7a26-195b-4784-ab30-cc18cb7a08c8"],
Cell[1246043, 25445, 31772, 604, 1664, "Input",ExpressionUUID->"c62c2130-ec1c-4ac0-8992-b3ffe500d352",
 InitializationCell->True],
Cell[1277818, 26051, 36493, 706, 1370, "Input",ExpressionUUID->"7307a0e2-ee1d-4d18-b16b-642b8bd73765",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1314348, 26762, 288, 5, 38, "Subsection",ExpressionUUID->"0e73ee14-ddc6-4094-897f-e020160790d0"],
Cell[1314639, 26769, 14226, 322, 677, "Input",ExpressionUUID->"2530e695-ff6a-4bf8-a014-8709536a94b3",
 InitializationCell->True],
Cell[1328868, 27093, 81, 0, 30, "Input",ExpressionUUID->"74ccdc3f-0172-4103-b65e-b4fc62e0d23f"]
}, Closed]],
Cell[CellGroupData[{
Cell[1328986, 27098, 387, 6, 38, "Subsection",ExpressionUUID->"c6e974b4-db8f-43a6-b870-4241d0d1698a"],
Cell[1329376, 27106, 4877, 111, 383, "Input",ExpressionUUID->"c167f52d-6b5f-45f9-88cc-e47f81b96e71",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1334290, 27222, 167, 3, 38, "Subsection",ExpressionUUID->"64fc49b5-8c00-4eb5-9ab2-6332caaddfbb"],
Cell[1334460, 27227, 12139, 260, 1013, "Input",ExpressionUUID->"5a646ee0-bb50-4ec4-a619-8d4711fa672e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1346636, 27492, 439, 7, 38, "Subsection",ExpressionUUID->"7503329c-2ee4-4851-b1a9-d38c3a66c1d1"],
Cell[1347078, 27501, 45327, 935, 1324, "Input",ExpressionUUID->"4ea885f3-5b3b-40e6-892f-1255f61a94e7",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1392442, 28441, 161, 3, 38, "Subsection",ExpressionUUID->"ee5698d3-2006-4985-94f3-ce90c4ed802b"],
Cell[1392606, 28446, 14971, 340, 628, "Input",ExpressionUUID->"227748a2-679c-45f6-b405-0147348e80ed",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1407614, 28791, 252, 4, 38, "Subsection",ExpressionUUID->"131904c6-bd11-4ab3-96db-cf9c959fa90e"],
Cell[1407869, 28797, 9331, 181, 541, "Input",ExpressionUUID->"0ca44d64-f283-412b-b161-9661e40c02ea",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1417237, 28983, 258, 4, 38, "Subsection",ExpressionUUID->"b2354afd-9df5-4147-9021-cf009b24b203"],
Cell[1417498, 28989, 27426, 576, 1112, "Input",ExpressionUUID->"77ee29de-9d0f-4973-bc71-a9732e80b77a",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1444961, 29570, 339, 5, 38, "Subsection",ExpressionUUID->"c498283f-999c-4cb6-8be0-22e56dba746b"],
Cell[1445303, 29577, 12834, 215, 110, "Input",ExpressionUUID->"1167dfc8-e366-42d0-a062-056d2a5d8da3",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1458174, 29797, 478, 7, 38, "Subsection",ExpressionUUID->"516e681d-1beb-42c7-806f-b844a71db486"],
Cell[1458655, 29806, 1161, 23, 61, "Text",ExpressionUUID->"393f2f94-1803-4e23-b0dd-9cd1deb87029"],
Cell[1459819, 29831, 46819, 986, 1953, "Input",ExpressionUUID->"58101c3d-e202-45e2-8fee-0723b2d713ba",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1506675, 30822, 134, 3, 38, "Subsection",ExpressionUUID->"5a6f0069-2e6b-4d53-b6f4-b774d3db0b81"],
Cell[1506812, 30827, 18786, 319, 278, "Input",ExpressionUUID->"d180cf2c-a79b-4f69-aea8-e633c963da59",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1525635, 31151, 150, 3, 38, "Subsection",ExpressionUUID->"6b8fdb4f-3e2d-4c25-9e87-ef1a7343b3cf"],
Cell[1525788, 31156, 6526, 149, 383, "Input",ExpressionUUID->"d82d687a-8264-4ab2-8e90-126ea1a0db20",
 InitializationCell->True],
Cell[1532317, 31307, 102644, 2313, 5087, "Input",ExpressionUUID->"b3e7bd08-1c18-4283-aced-4e7fd0095136",
 InitializationCell->True],
Cell[1634964, 33622, 169585, 3917, 9715, "Input",ExpressionUUID->"af284ae8-289c-4c91-bc16-2f323eb155c6",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1804586, 37544, 156, 3, 38, "Subsection",ExpressionUUID->"e3140512-8040-4b78-a8b2-e77f9199e91d"],
Cell[1804745, 37549, 4914, 81, 131, "Input",ExpressionUUID->"3d994c47-c5b5-42e9-ba7b-35164662c5b3",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1809696, 37635, 455, 7, 38, "Subsection",ExpressionUUID->"a00f9896-4f06-4a88-8e52-0ee43a61bd0b"],
Cell[1810154, 37644, 11361, 239, 824, "Input",ExpressionUUID->"2f5af4b6-2f92-465b-ae16-6ac60fd229f1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1821552, 37888, 464, 7, 38, "Subsection",ExpressionUUID->"bbfd1ab0-1e50-42bd-8f51-869014502f0a"],
Cell[1822019, 37897, 25825, 506, 950, "Input",ExpressionUUID->"6bd51a80-bab0-48e3-b098-59a9caf39d3f",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1847881, 38408, 164, 3, 38, "Subsection",ExpressionUUID->"8a45d202-28be-4482-b50b-e26fefc3992b"],
Cell[1848048, 38413, 12585, 290, 796, "Input",ExpressionUUID->"c48cf425-f1a2-4462-9c2a-870af9587f71",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1860670, 38708, 418, 8, 38, "Subsection",ExpressionUUID->"3dc93e88-18fc-4b08-a0f2-3b0ced8ffdbc"],
Cell[1861091, 38718, 746, 15, 173, "Text",ExpressionUUID->"e2214c72-9e0d-4f3b-a15d-6117c612dd78"],
Cell[1861840, 38735, 31748, 676, 1700, "Input",ExpressionUUID->"774edf3d-4b55-4145-849b-051d46c6a79d",
 InitializationCell->True],
Cell[1893591, 39413, 795, 16, 150, "Text",ExpressionUUID->"1b74c357-bac8-4f82-b251-cefd17cf0c45"],
Cell[1894389, 39431, 14725, 295, 600, "Input",ExpressionUUID->"5d23b930-244c-4440-9bb2-85e665a9cfe2",
 InitializationCell->True],
Cell[1909117, 39728, 1020, 17, 127, "Text",ExpressionUUID->"a487075c-68f8-446d-88be-4ec5655f4d49"],
Cell[1910140, 39747, 15586, 313, 516, "Input",ExpressionUUID->"2326bf4b-94b0-4d6a-94dc-818f699c4d72",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1925763, 40065, 199, 3, 38, "Subsection",ExpressionUUID->"7281337e-90c7-4b6f-8c1b-99b585cc5ebe"],
Cell[1925965, 40070, 11271, 244, 501, "Input",ExpressionUUID->"9f06ca08-8f2d-4be0-a5fd-c759237e39e4",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1937273, 40319, 173, 3, 38, "Subsection",ExpressionUUID->"4375b8ad-6ca0-4d8e-a4f4-b57cc6e2c0cf"],
Cell[1937449, 40324, 35295, 784, 1698, "Input",ExpressionUUID->"50c6e264-7529-47c9-b7ad-c8dfe917b77a",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1972781, 41113, 159, 3, 38, "Subsection",ExpressionUUID->"a55d1c18-3c45-4e1f-9386-d993b2e4baea"],
Cell[1972943, 41118, 4260, 103, 275, "Input",ExpressionUUID->"e76f6b7f-8058-4fc4-8e18-32647377a312",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1977240, 41226, 342, 5, 38, "Subsection",ExpressionUUID->"9aeb1f18-2f1d-4f6e-b2d8-2c04ed42fe68"],
Cell[CellGroupData[{
Cell[1977607, 41235, 243, 4, 45, "Subsubsection",ExpressionUUID->"5db8945c-3ed2-4319-93e6-ef131d7ea38b"],
Cell[1977853, 41241, 932, 17, 75, "Text",ExpressionUUID->"550153cc-829c-4cab-b436-a3dffadefa9f"],
Cell[1978788, 41260, 1593, 35, 100, "Text",ExpressionUUID->"06625af5-e892-4986-a9e0-3fcb55cd4351"],
Cell[1980384, 41297, 906, 21, 52, "Text",ExpressionUUID->"4fe5a98c-8d34-40fb-a0f9-d95ece083cf3"],
Cell[1981293, 41320, 2404, 66, 80, "Text",ExpressionUUID->"484f6c56-4b94-4e41-89a3-11bbf52411f1"],
Cell[1983700, 41388, 2441, 64, 100, "Text",ExpressionUUID->"9a4d30a7-e9b1-49e7-ad9a-e04e4ad3649c"],
Cell[1986144, 41454, 3816, 104, 151, "Text",ExpressionUUID->"737bb917-bcee-448c-8c61-0e630eff150f"],
Cell[1989963, 41560, 2413, 52, 143, "Text",ExpressionUUID->"cda8c66d-f29b-4fb2-8ec7-df06179942fe"],
Cell[1992379, 41614, 3600, 94, 167, "Text",ExpressionUUID->"7365e31d-053a-4341-847b-9d20c90a79a6"],
Cell[1995982, 41710, 2482, 58, 120, "Text",ExpressionUUID->"2910b6b4-dd90-4a69-8a52-32d0f911eefa"],
Cell[1998467, 41770, 782, 16, 100, "Text",ExpressionUUID->"0b80b6e4-d06c-4784-8abe-4917f26d885e"]
}, Closed]],
Cell[CellGroupData[{
Cell[1999286, 41791, 162, 3, 37, "Subsubsection",ExpressionUUID->"865bec23-b795-4f79-abb2-692dba52b506"],
Cell[1999451, 41796, 55377, 1175, 3437, "Input",ExpressionUUID->"be69bc0c-f23e-42f8-b5d2-e67fb1a31db0",
 InitializationCell->True],
Cell[2054831, 42973, 18069, 301, 501, "Input",ExpressionUUID->"e7aa6d7e-597e-4268-9cea-38b386020295",
 InitializationCell->True],
Cell[2072903, 43276, 15174, 255, 467, "Input",ExpressionUUID->"8d79a8a5-7ec4-4e96-b4c8-b15d70013b23",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2088114, 43536, 316, 5, 37, "Subsubsection",ExpressionUUID->"6b883a84-a833-4032-b90f-01b764466ccc"],
Cell[2088433, 43543, 5991, 157, 403, "Input",ExpressionUUID->"bd12b7be-8b0d-43d8-912f-7a4b2aecd725",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2094461, 43705, 160, 3, 37, "Subsubsection",ExpressionUUID->"e87a704e-ca4f-4e56-bc1a-70782c9b0a2c"],
Cell[2094624, 43710, 1968, 46, 120, "Input",ExpressionUUID->"2cea03de-e41a-4d25-89fa-b6ed5552e8a1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2096629, 43761, 166, 3, 37, "Subsubsection",ExpressionUUID->"0b6fed30-3634-43ee-80c8-2ecafdd0e265"],
Cell[2096798, 43766, 1626, 39, 100, "Input",ExpressionUUID->"27725eec-53c5-41b7-850c-df20b3c08fa2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2098461, 43810, 211, 4, 37, "Subsubsection",ExpressionUUID->"293f512d-0167-44ba-99c9-f7fe9e66e44b"],
Cell[2098675, 43816, 1766, 43, 100, "Input",ExpressionUUID->"1a414918-ee66-4e6f-ad5a-be0b8c63c99c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2100478, 43864, 271, 4, 37, "Subsubsection",ExpressionUUID->"b9a4af75-3a33-450a-9c0f-4ce1c0791806"],
Cell[2100752, 43870, 1680, 40, 100, "Input",ExpressionUUID->"f80df394-c6f8-48b0-bd29-6b0999066c15",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2102469, 43915, 312, 5, 37, "Subsubsection",ExpressionUUID->"b0b8d692-4957-467d-ae1e-aa214d3370e1"],
Cell[2102784, 43922, 1840, 44, 80, "Input",ExpressionUUID->"cca260ae-8eb8-43cf-b070-73050e196e5f",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2104661, 43971, 261, 4, 37, "Subsubsection",ExpressionUUID->"1de083d4-2870-4c02-8d71-5d6c7c6e7e6d"],
Cell[2104925, 43977, 1505, 37, 120, "Input",ExpressionUUID->"d5943ebb-12da-48aa-ba02-3d505a60df87",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2106467, 44019, 461, 7, 37, "Subsubsection",ExpressionUUID->"34826003-b078-4f6c-9e5e-6c618ecc57de"],
Cell[2106931, 44028, 4928, 118, 367, "Input",ExpressionUUID->"ca54feb2-d00e-4f7e-b100-a65454a219b4",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2111896, 44151, 504, 7, 37, "Subsubsection",ExpressionUUID->"9fe1b10e-8538-43de-b21f-03b7c5eb1687"],
Cell[2112403, 44160, 1103, 27, 100, "Input",ExpressionUUID->"df59a9b6-049f-49d0-9094-da66833be24c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2113543, 44192, 311, 5, 37, "Subsubsection",ExpressionUUID->"86ba7e76-0b9d-41d2-a82b-b1c6c7226501"],
Cell[2113857, 44199, 1283, 33, 100, "Input",ExpressionUUID->"dba3ad66-c194-4162-bbe2-88aa9be0e86d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2115177, 44237, 447, 7, 37, "Subsubsection",ExpressionUUID->"d7ea3f83-6f7c-4a43-b6a3-c9bdd5b55d7b"],
Cell[2115627, 44246, 1003, 26, 80, "Input",ExpressionUUID->"bcb84637-decb-49f1-b131-ecc12403ffa5",
 InitializationCell->True]
}, Closed]],
Cell[2116645, 44275, 289, 4, 37, "Subsubsection",ExpressionUUID->"fa2a8b50-6d07-47f6-b1be-2e88a8613a2e"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[2116983, 44285, 147, 2, 67, "Section",ExpressionUUID->"d17ead81-6517-42ab-898c-9f79ba651411"],
Cell[2117133, 44289, 10654, 152, 467, "Input",ExpressionUUID->"58c44fd8-6e68-433c-af38-a80fd733c7fa",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2127824, 44446, 143, 2, 53, "Section",ExpressionUUID->"f22bca56-27ec-41a4-b3d0-6ec3bb235ca7"],
Cell[2127970, 44450, 2961, 46, 68, "Input",ExpressionUUID->"50fbc756-37bb-453f-b324-c5e8338f1c6b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2130968, 44501, 262, 4, 53, "Section",ExpressionUUID->"a02fac61-8b82-4c6d-8ef1-5122ad80d48b"],
Cell[2131233, 44507, 8137, 129, 196, "Text",ExpressionUUID->"7a2153af-e443-461d-adf3-be30f252d6d1"],
Cell[2139373, 44638, 7021, 101, 104, "Text",ExpressionUUID->"420ff4cf-d2c1-45e8-9544-523fe8e60a7e"],
Cell[2146397, 44741, 6689, 96, 81, "Text",ExpressionUUID->"7c721e48-f508-4526-9b70-cf02b9d648a5"],
Cell[2153089, 44839, 7039, 103, 127, "Text",ExpressionUUID->"bca1ac60-c7b5-4241-bf13-b3afd3fa07e2"],
Cell[2160131, 44944, 7030, 107, 81, "Text",ExpressionUUID->"ead71958-ac53-4658-8df1-ae41691260d0"],
Cell[2167164, 45053, 7064, 104, 127, "Text",ExpressionUUID->"0743ba2d-d02a-4a35-9a48-b26222ee90e6"],
Cell[2174231, 45159, 7382, 114, 150, "Text",ExpressionUUID->"105d041f-d11d-472a-b7a6-55d5b0c7d4a4"],
Cell[2181616, 45275, 7435, 117, 106, "Text",ExpressionUUID->"4225639f-c070-42ef-889d-a81e2dc4b44a"],
Cell[2189054, 45394, 8381, 141, 336, "Text",ExpressionUUID->"e6dffbbf-2f6d-4d0c-b056-bd861796db5e"],
Cell[2197438, 45537, 14505, 285, 1488, "Text",ExpressionUUID->"219c5f04-52cf-4dae-967b-47f3912e2bec"],
Cell[2211946, 45824, 6987, 101, 150, "Text",ExpressionUUID->"dfdae96a-3060-44da-84f7-d41e581edf1b"],
Cell[2218936, 45927, 20765, 415, 3096, "Text",ExpressionUUID->"6a328d5f-73fb-4371-810d-e49da45a4eff"]
}, Closed]]
}, Open  ]]
}
]
*)

